<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>doc/NOTE-REPORTING | geopf-extensions-openlayers</title><meta name="description" content="Documentation for geopf-extensions-openlayers"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">geopf-extensions-openlayers</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">geopf-extensions-openlayers</a></li><li><a href="doc_NOTE-REPORTING.html">doc/NOTE-REPORTING</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="fonctionnement-de-la-personnalisation-du-widget-de-signalement-danomalie" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Fonctionnement de la personnalisation du widget de signalement d’anomalie<a href="#fonctionnement-de-la-personnalisation-du-widget-de-signalement-danomalie" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="liste-de-ioc-du-widget" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Liste de Ioc du widget<a href="#liste-de-ioc-du-widget" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Voici une explication du fonctionnement des IoC (Inversion of Control) de type Input, Form, Drawing et Service dans la classe Reporting :</p>
<a id="ioc-de-type-input" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IoC de type Input<a href="#ioc-de-type-input" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>L’IoC de type Input (ex : InputActionByDefaut) permet de gérer la saisie d’informations directement sur la carte, comme la sélection d’un point géographique par un clic.
Il encapsule la logique d’interaction avec la carte (écoute des événements, récupération des coordonnées, affichage d’un marqueur) et expose des méthodes pour activer/désactiver cette saisie, récupérer ou réinitialiser les données.</p>
<p>Dans Reporting, il est instancié et branché à la carte via setMap() et utilisé lors de la première étape du processus de signalement.</p>
<a id="implementation-générique" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Implementation générique<a href="#implementation-générique" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Voici un exemple d’implémentation personnalisée d’un IoC de type Input pour la classe Reporting.</p>
<p>Vous pouvez créer votre propre classe héritant de InputActionByDefaut (ou sans heritage avec toutes les fonctions de base) et l’injecter dans le composant Reporting :</p>
<pre><code class="js"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">InputActionByDefaut</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./Reporting.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-17">CustomInputAction</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-17">InputActionByDefaut</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">constructor</span><span class="hl-1">(</span><span class="hl-4">map</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">super</span><span class="hl-1">(</span><span class="hl-4">map</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-9">// Redéfinir la méthode _handler pour personnaliser la saisie sur la carte</span><br/><span class="hl-1">    </span><span class="hl-0">_handler</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">super</span><span class="hl-1">.</span><span class="hl-0">_handler</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-9">// Ajoutez ici votre logique personnalisée, par exemple :</span><br/><span class="hl-1">        </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Coordonnée saisie :&quot;</span><span class="hl-1">, </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-4">coordinate</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-9">// Vous pouvez aussi stocker des infos supplémentaires dans this.data</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-6">default</span><span class="hl-1"> </span><span class="hl-4">CustomInputAction</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<a id="utilisation-dans-reporting" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Utilisation dans Reporting<a href="#utilisation-dans-reporting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="js"><span class="hl-9">// ...existing code...</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">CustomInputAction</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./CustomInputAction&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// ...après avoir instancié Reporting...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">reporting</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Reporting</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">customInput</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CustomInputAction</span><span class="hl-1">();</span><br/><span class="hl-4">reporting</span><span class="hl-1">.</span><span class="hl-0">setComponentInput</span><span class="hl-1">(</span><span class="hl-4">customInput</span><span class="hl-1">);</span><br/><span class="hl-9">// ...puis ajoutez le contrôle à la carte...</span><br/><span class="hl-4">map</span><span class="hl-1">.</span><span class="hl-0">addControl</span><span class="hl-1">(</span><span class="hl-4">reporting</span><span class="hl-1">);</span><br/><span class="hl-9">// ...existing code...</span>
</code><button type="button">Copy</button></pre>

<p>Explication :</p>
<blockquote>
<p>Vous pouvez ainsi remplacer dynamiquement la logique de saisie sur la carte (IoC Input) sans modifier le cœur de la classe Reporting.
Cela permet d’adapter le comportement à vos besoins spécifiques (ex : gestion d’un clic droit, ajout de popups, etc.).</p>
</blockquote>
<a id="exemple-concret" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Exemple concret<a href="#exemple-concret" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>(code JS directement intégrable sur une page HTML)</p>
<blockquote>
<p>Le deplacement sur la carte enregistre la saisie du centre de la carte</p>
</blockquote>
<p>cf. <a href="../media/iocInput.js">Exemple fonctionnel</a></p>
<a id="api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">API<a href="#api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>le principe d’IoC (Inversion of Control) permet à la classe Reporting d’utiliser des composants externes (Input, Form, Drawing, Service) qui implémentent une API précise.</p>
<p>Chaque IoC (par exemple InputActionByDefaut) expose des méthodes standardisées comme active(), disable(), clear(), getData(), et des méthodes de configuration (setMap(), setForm(), etc.).</p>
<p>La classe Reporting utilise uniquement cette API commune pour piloter chaque étape du workflow, sans dépendre de l’implémentation interne de chaque action.
Cela permet de remplacer facilement un composant IoC par un autre (par exemple, un Input personnalisé) tant qu’il respecte l’API attendue.</p>
<p>Exemple d’API attendue pour un IoC Input :</p>
<ul>
<li>setMap(map)</li>
<li>setIcon(icon)</li>
<li>active()</li>
<li>disable()</li>
<li>clear()</li>
<li>getData()</li>
</ul>
<p>Avantage :</p>
<blockquote>
<p>La classe Reporting reste générique, modulaire et facilement extensible, car elle interagit avec ses IoC uniquement via leur API publique, sans connaître leur fonctionnement interne.</p>
</blockquote>
<a id="limites" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Limites<a href="#limites" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>L’utilisation du IoC Input permet de personnaliser la logique de saisie sur la carte sans modifier le cœur de la classe Reporting. Cependant, certaines limites existent :</p>
<ul>
<li>
<p>API contractuelle : Le composant injecté doit impérativement respecter l’API attendue (méthodes comme setMap, active, getData, etc.). Si une méthode manque ou ne respecte pas la signature, l’intégration peut échouer ou provoquer des erreurs.</p>
</li>
<li>
<p>Intégration avec le workflow : Le IoC Input ne peut agir que sur la partie du workflow qui lui est déléguée (ex : saisie de coordonnées). Les autres étapes (formulaire, dessin, service) restent indépendantes et ne peuvent pas être modifiées via ce composant.</p>
</li>
<li>
<p>Dépendances internes : Certaines interactions ou dépendances internes à Reporting (par exemple, la gestion de l’état global ou des transitions entre étapes) ne sont pas accessibles ou modifiables via le IoC Input.</p>
</li>
<li>
<p>nteropérabilité : Si le IoC Input personnalisé introduit des comportements très spécifiques, il peut devenir difficile à réutiliser ou à maintenir dans d’autres contextes ou avec d’autres IoC.</p>
</li>
<li>
<p>Sécurité et validation : Toute la logique de validation ou de filtrage des données saisies doit être gérée dans le IoC Input lui-même. Le cœur de Reporting ne fait pas de vérification supplémentaire.</p>
</li>
</ul>
<p>En résumé :</p>
<blockquote>
<p>Le IoC Input offre une grande souplesse pour la saisie sur la carte, mais il doit respecter l’API définie et ne peut pas modifier le fonctionnement global du widget au-delà de son périmètre d’action.</p>
</blockquote>
<a id="ioc-de-type-form" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IoC de type Form<a href="#ioc-de-type-form" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>L’IoC de type Form (ex : FormActionByDefaut) gère la logique du formulaire HTML de signalement (récupération des champs, validation, gestion des erreurs, etc.).
Il encapsule l’écoute de la soumission du formulaire, la transformation des données en objet JS, et la gestion de l’état du formulaire (erreur, succès, reset).</p>
<p>Dans Reporting, il est instancié et branché au formulaire DOM via setForm() et utilisé lors de la deuxième étape du processus.</p>
<a id="utilisation-dans-reporting-1" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Utilisation dans Reporting<a href="#utilisation-dans-reporting-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="js"><span class="hl-9">// ...existing code...</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">CustomFormAction</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./CustomFormAction&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// ...après avoir instancié Reporting...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">reporting</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Reporting</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">customForm</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CustomFormAction</span><span class="hl-1">();</span><br/><span class="hl-4">reporting</span><span class="hl-1">.</span><span class="hl-0">setComponentForm</span><span class="hl-1">(</span><span class="hl-4">customForm</span><span class="hl-1">);</span><br/><span class="hl-9">// ...puis ajoutez le contrôle à la carte...</span><br/><span class="hl-4">map</span><span class="hl-1">.</span><span class="hl-0">addControl</span><span class="hl-1">(</span><span class="hl-4">reporting</span><span class="hl-1">);</span><br/><span class="hl-9">// ...existing code...</span>
</code><button type="button">Copy</button></pre>

<a id="exemple-concret-1" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Exemple concret<a href="#exemple-concret-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>(code JS directement intégrable sur une page HTML)</p>
<blockquote>
<p>Modification des champs du formulaire</p>
</blockquote>
<p>cf. <a href="../media/iocForm.js">Exemple fonctionnel</a></p>
<a id="ioc-de-type-drawing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IoC de type Drawing<a href="#ioc-de-type-drawing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>L’IoC de type Drawing (ex : DrawingActionByDefaut) gère l’outil de dessin sur la carte (polygones, lignes, etc.).
Il encapsule l’initialisation du widget de dessin, la gestion de son affichage, l’export des dessins au format souhaité, et la réinitialisation des données.</p>
<p>Dans Reporting, il est instancié et branché à la carte et au DOM via setMap() et setTarget(), et utilisé lors de l’étape de dessin.</p>
<a id="utilisation-dans-reporting-2" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Utilisation dans Reporting<a href="#utilisation-dans-reporting-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="js"><span class="hl-9">// ...existing code...</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">CustomDrawingAction</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./CustomDrawingAction&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// ...après avoir instancié Reporting...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">reporting</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Reporting</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">customDrawing</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CustomDrawingAction</span><span class="hl-1">();</span><br/><span class="hl-4">reporting</span><span class="hl-1">.</span><span class="hl-0">setComponentDrawing</span><span class="hl-1">(</span><span class="hl-4">customDrawing</span><span class="hl-1">);</span><br/><span class="hl-9">// ...puis ajoutez le contrôle à la carte...</span><br/><span class="hl-4">map</span><span class="hl-1">.</span><span class="hl-0">addControl</span><span class="hl-1">(</span><span class="hl-4">reporting</span><span class="hl-1">);</span><br/><span class="hl-9">// ...existing code...</span>
</code><button type="button">Copy</button></pre>

<a id="ioc-de-type-service" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IoC de type Service<a href="#ioc-de-type-service" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>L’IoC de type Service (ex : ServiceActionByDefaut) gère l’envoi des données de signalement vers un service externe (API, serveur, etc.).
Il encapsule la logique d’appel réseau (méthode send()), la gestion des erreurs et le nettoyage des données après envoi.</p>
<p>Dans Reporting, il est instancié et utilisé lors de l’étape d’envoi du signalement.</p>
<a id="les-étapes-pour-mettre-en-place-une-classe-ioc-de-type-service" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Les étapes pour mettre en place une classe IoC de type Service<a href="#les-étapes-pour-mettre-en-place-une-classe-ioc-de-type-service" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Ceci afin de personnaliser l’envoi des signalements dans le widget Reporting.</p>
<ol>
<li>Créer une classe Service personnalisée</li>
</ol>
<p>Créez un nouveau fichier, par exemple CustomServiceAction.js, et implémentez une classe qui respecte l’API attendue (au minimum : send(data), clear(), etc.).</p>
<pre><code class="js"><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-17">CustomServiceAction</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-9">// Initialisation éventuelle</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-9">// Méthode appelée par Reporting pour envoyer les données</span><br/><span class="hl-1">    </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-9">// Exemple d’appel à une API REST</span><br/><span class="hl-1">        </span><span class="hl-6">try</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-0">fetch</span><span class="hl-1">(</span><span class="hl-2">&quot;https://mon-api/endpoint&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">                </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;POST&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">                </span><span class="hl-4">headers:</span><span class="hl-1"> { </span><span class="hl-2">&quot;Content-Type&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-2">&quot;application/json&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">                </span><span class="hl-4">body:</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">)</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">            </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-4">response</span><span class="hl-1">.</span><span class="hl-4">ok</span><span class="hl-1">) </span><span class="hl-6">throw</span><span class="hl-1"> </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Erreur lors de l’envoi&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-4">response</span><span class="hl-1">.</span><span class="hl-0">json</span><span class="hl-1">();</span><br/><span class="hl-1">        } </span><span class="hl-6">catch</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-9">// Gestion des erreurs</span><br/><span class="hl-1">            </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;Erreur ServiceAction :&quot;</span><span class="hl-1">, </span><span class="hl-4">err</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-6">throw</span><span class="hl-1"> </span><span class="hl-4">err</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-9">// Méthode pour réinitialiser l’état si besoin</span><br/><span class="hl-1">    </span><span class="hl-0">clear</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-9">// Réinitialisation éventuelle</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-6">default</span><span class="hl-1"> </span><span class="hl-4">CustomServiceAction</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<ol start="2">
<li>Injecter la classe Service dans Reporting</li>
</ol>
<p>Dans votre code principal, importez votre classe et injectez-la dans le widget Reporting :</p>
<pre><code class="js"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">Reporting</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;chemin/vers/Reporting&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">CustomServiceAction</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;chemin/vers/CustomServiceAction&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">reporting</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Reporting</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">customService</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CustomServiceAction</span><span class="hl-1">();</span><br/><span class="hl-4">reporting</span><span class="hl-1">.</span><span class="hl-0">setComponentService</span><span class="hl-1">(</span><span class="hl-4">customService</span><span class="hl-1">);</span><br/><span class="hl-4">map</span><span class="hl-1">.</span><span class="hl-0">addControl</span><span class="hl-1">(</span><span class="hl-4">reporting</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<ol start="3">
<li>Respecter l’API attendue</li>
</ol>
<p>Assurez-vous que votre classe Service implémente bien toutes les méthodes attendues par Reporting (ex : send(data), clear()).
Vous pouvez vous inspirer de la classe ServiceActionByDefaut fournie dans le framework.</p>
<ol start="4">
<li>Tester l’intégratio</li>
</ol>
<p>Déclenchez un signalement depuis l’interface pour vérifier que votre service personnalisé est bien appelé et que les données sont transmises à votre API.</p>
<p>Voir aussi l’exemple fonctionnel pour un cas concret ci-dessous.</p>
<a id="exemple-concret-2" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Exemple concret<a href="#exemple-concret-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>(code JS directement intégrable sur une page HTML)</p>
<blockquote>
<p>Branchement au service d'anomalie du Geoportail</p>
</blockquote>
<p>cf. <a href="../media/iocService.js">Exemple fonctionnel</a></p>
<a id="résumé" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Résumé<a href="#résumé" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Chaque IoC est une brique indépendante, injectée dans le workflow du composant Reporting pour gérer une étape précise (saisie sur carte, formulaire, dessin, envoi). Cela permet de remplacer ou personnaliser facilement chaque étape sans modifier la logique globale du composant.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#fonctionnement-de-la-personnalisation-du-widget-de-signalement-danomalie"><span>Fonctionnement de la personnalisation du widget de signalement d’anomalie</span></a><ul><li><a href="#liste-de-ioc-du-widget"><span>Liste de <wbr/>Ioc du widget</span></a></li><li><ul><li><a href="#ioc-de-type-input"><span>Io<wbr/>C de type <wbr/>Input</span></a></li><li><ul><li><a href="#implementation-générique"><span>Implementation générique</span></a></li><li><a href="#utilisation-dans-reporting"><span>Utilisation dans <wbr/>Reporting</span></a></li><li><a href="#exemple-concret"><span>Exemple concret</span></a></li><li><a href="#api"><span>API</span></a></li><li><a href="#limites"><span>Limites</span></a></li></ul></li><li><a href="#ioc-de-type-form"><span>Io<wbr/>C de type <wbr/>Form</span></a></li><li><ul><li><a href="#utilisation-dans-reporting-1"><span>Utilisation dans <wbr/>Reporting</span></a></li><li><a href="#exemple-concret-1"><span>Exemple concret</span></a></li></ul></li><li><a href="#ioc-de-type-drawing"><span>Io<wbr/>C de type <wbr/>Drawing</span></a></li><li><ul><li><a href="#utilisation-dans-reporting-2"><span>Utilisation dans <wbr/>Reporting</span></a></li></ul></li><li><a href="#ioc-de-type-service"><span>Io<wbr/>C de type <wbr/>Service</span></a></li><li><ul><li><a href="#les-étapes-pour-mettre-en-place-une-classe-ioc-de-type-service"><span>Les étapes pour mettre en place une classe <wbr/>Io<wbr/>C de type <wbr/>Service</span></a></li><li><a href="#exemple-concret-2"><span>Exemple concret</span></a></li></ul></li></ul></li><li><a href="#résumé"><span>Résumé</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://cartes.gouv.fr/cartes">cartes.gouv.fr</a><a href="https://geoportail.gouv.fr/">geoportail</a><a href="https://github.com/IGNF/geopf-extensions-openlayers">github</a></nav><nav class="tsd-navigation"><a href="../modules.html">geopf-extensions-openlayers</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
