/*!
 * @brief geopf-extensions-openlayers
 *
 * This software is released under the licence AGPL-3.0
 * @see https://www.gnu.org/licenses/agpl-3.0.html#license-text
 * @see https://www.gnu.org/licenses/agpl-3.0.en.html#license-text
 *
 * @copyright copyright (c) IGN 
 * @license AGPL-3.0
 * @author IGN
 * @version 1.0.0-beta.3-373
 * @date 14/03/2025
 *
 */(()=>{var e={2536:(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}i.d(t,{A:()=>o});const o={detectSupport:function(){var e=!0,t=window.navigator.userAgent.toLowerCase();return-1===t.indexOf("iphone")&&-1===t.indexOf("ipod")&&-1===t.indexOf("ipad")&&-1===t.indexOf("android")&&-1===t.indexOf("mobile")&&-1===t.indexOf("blackberry")&&-1===t.indexOf("tablet")&&-1===t.indexOf("phone")&&-1===t.indexOf("touch")||(e=!1),-1===t.indexOf("msie")&&-1===t.indexOf("trident")||(e=!0),e},assign:function(e,t){for(var i in e=e||{},t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},mergeParams:function(e,t,i){if(void 0!==e&&void 0!==t)for(var o in void 0===i&&(i=!0),t)t.hasOwnProperty(o)&&("object"===n(t[o])?e.hasOwnProperty(o)?this.mergeParams(e[o],t[o],i):e[o]=t[o]:e.hasOwnProperty(o)?i&&(e[o]=t[o]):e[o]=t[o])}}},3065:function(e,t,i){var n,o;!function(){"use strict";n=function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],o={},a=null;function r(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&i?s:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}function c(){for(var i=this.getLevel(),o=0;o<n.length;o++){var a=n[o];this[a]=o<i?e:this.methodFactory(a,i,this.name)}if(this.log=this.debug,typeof console===t&&i<this.levels.SILENT)return"No console available for logging"}function d(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function p(e,t,i){return l(e)||d.apply(this,arguments)}function u(e,i){var r,s,l,d=this,u="loglevel";function h(e){var i=(n[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=i)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+i+";"}catch(e){}}}function m(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var i=window.document.cookie,n=encodeURIComponent(u),o=i.indexOf(n+"=");-1!==o&&(e=/^([^;]+)/.exec(i.slice(o+n.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function y(){if(typeof window!==t&&u){try{window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function g(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=i||p,d.getLevel=function(){return null!=l?l:null!=s?s:r},d.setLevel=function(e,t){return l=g(e),!1!==t&&h(l),c.call(d)},d.setDefaultLevel=function(e){s=g(e),m()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,y(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(a!==d&&(r=g(a.getLevel())),c.call(d),a===d)for(var e in o)o[e].rebuild()},r=g(a?a.getLevel():"WARN");var f=m();null!=f&&(l=g(f)),c.call(d)}(a=new u).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new u(e,a.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=h),a},a.getLoggers=function(){return o},a.default=a,a},void 0===(o="function"==typeof n?n.call(t,i,t,e):n)||(e.exports=o)}()},3110:function(e){var t;e.exports=(t={},(t=function(){this.listeners={}}).prototype={addEventListener:function(e,t,i){for(var n=[],o=arguments.length,a=0;a<o;a++)n.push(arguments[a]);n=n.length>3?n.splice(3,n.length-1):[],void 0!==this.listeners[e]?this.listeners[e].push({scope:i,callback:t,args:n}):this.listeners[e]=[{scope:i,callback:t,args:n}]},removeEventListener:function(e,t,i){if(void 0!==this.listeners[e]){for(var n=this.listeners[e].length,o=[],a=0;a<n;a++){var r=this.listeners[e][a];r.scope==i&&r.callback==t||o.push(r)}this.listeners[e]=o}},hasEventListener:function(e,t,i){if(void 0!==this.listeners[e]){var n=this.listeners[e].length;if(void 0===t&&void 0===i)return n>0;for(var o=0;o<n;o++){var a=this.listeners[e][o];if((!i||a.scope==i)&&a.callback==t)return!0}}return!1},dispatch:function(e,t){for(var i={type:e,target:t},n=[],o=arguments.length,a=0;a<o;a++)n.push(arguments[a]);if(n=n.length>2?n.splice(2,n.length-1):[],n=[i].concat(n),void 0!==this.listeners[e]){var r=this.listeners[e].slice(),s=r.length;for(a=0;a<s;a++){var l=r[a];if(l&&l.callback){var c=n.concat(l.args);l.callback.apply(l.scope,c)}}}},getEvents:function(){var e="";for(var t in this.listeners)for(var i=this.listeners[t].length,n=0;n<i;n++){var o=this.listeners[t][n];e+=o.scope&&o.scope.className?o.scope.className:"anonymous",e+=" listen for '"+t+"'\n"}return e}},new t)},3920:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});const n={hex:function(e){if(e>255)throw new Error("'"+e+"'' is greater than 255(0xff);");return("0"+Number(e).toString(16)).slice(-2)},num:function(e){return parseInt(e,16)},arrayToRgba:function(e){if(!Array.isArray(e))throw new Error("Not an array !");var t=e[0],i=e[1],n=e[2],o=e[3]||1;return"rgba("+t+", "+i+", "+n+", "+parseFloat(o)+")"},arrayToHex:function(e){if(!Array.isArray(e))throw new Error("Not an array !");var t=e[0],i=e[1],n=e[2],o=e[3],a=[this.hex(t),this.hex(i),this.hex(n)],r={};return r.hex="#"+a.join(""),o&&(r.opacity=parseFloat(o)),r},rgbaToHex:function(e){var t=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/.exec(e);if(!t)throw new Error("Invalid format: "+e);var i=t[1],n=t[2],o=t[3],a=t[4],r=[this.hex(i),this.hex(n),this.hex(o)],s={};return s.hex="#"+r.join(""),a&&(s.opacity=parseFloat(a)),s},hexToRgba:function(e,t){if(!e)throw new Error("Invalid format");e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,i,n){return t+t+i+i+n+n}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return(i=i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null)?"rgba("+i.r+", "+i.g+", "+i.b+", "+t+")":null},isHex:function(e){if(!e)return!1;if("#"!==e.charAt(0))return!1;return!!/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e)},isRGB:function(e){if(!e)return!1;return!!/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/.exec(e)}}},5844:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(3065),o={getLogger:function(e){if(void 0===t)var t={env:{VERBOSE:!1}};t.env.VERBOSE?n.enableAll():n.disableAll();var i=e||"default";return n.getLogger(i)},disableAll:function(){var e=n.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=n.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}};const a=o;window.Gp&&(window.Gp.Logger=o)},6736:(e,t,i)=>{"use strict";var n;i.d(t,{A:()=>o});const o={generate:(n=Math.floor(Date.now()),function(){return n++}),name:function(e){var t=null,i=e.lastIndexOf("-");return t=-1===i?e:e.substring(0,i),t},index:function(e){var t=null,i=this.name(e),n=i.lastIndexOf("_");return-1!==n&&(t=i.substring(n+1)),t},uuid:function(e){var t=null,i=e.lastIndexOf("-");return-1!==i&&(t=parseInt(e.substring(i+1),10)),t}}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{"use strict";i.d(n,{default:()=>te});var e=i(3110),t=i.n(e),o=i(2536),a=i(6736),r=i(5844);const s={onloaded:"editor:onloaded",layer:{onclickvisibility:"editor:layer:onclickvisibility",onclickclone:"editor:layer:onclickclone",onclickremove:"editor:layer:onclickremove"},legend:{onclickedition:"editor:legend:onclickedition",onchangevalue:"editor:legend:onchangevalue"},group:{oncollapse:"editor:group:oncollapse"},style:{oneditjson:"editor:style:oneditjson",scale:{onchangemin:"editor:style:scale:onchangemin",onchangemax:"editor:style:scale:onchangemax"}},filter:{oneditjson:"editor:filter:oneditjson"},themes:{onclickimage:"editor:themes:onclickimage",onclicktitle:"editor:themes:onclicktitle"},search:{onsubmit:"editor:search:onsubmit",onautocomplete:"editor:search:onautocomplete"}};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}var p=r.A.getLogger("editor-style"),u=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p.trace("[constructor] Style",t),this.options=t||{target:null,position:0,tools:null,title:null,obj:null},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={scale:!0,edition:!1};this.options.tools||(this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={paint:{},layout:{}}),this.options.title||(this.options.title="JSON Styles :"),this.container=null,this.name={target:"GPEditorMapBoxStyleTarget",container:"GPEditorMapBoxStyleContainer",containerjson:"GPEditorMapBoxStyleJsonContainer",jsonlabel:"GPEditorMapBoxStyleJsonTitle",jsondisplay:"GPEditorMapBoxStyleJsonDisplay",containertoolsscale:"GPEditorMapBoxStyleToolsScaleContainer",scaletitle:"GPEditorMapBoxStyleScaleTitle",containertoolsminscale:"GPEditorMapBoxStyleToolsScaleMinContainer",scalelabelmin:"GPEditorMapBoxStyleScaleLabelMin",scaleinputmin:"GPEditorMapBoxStyleScaleInputMin",containertoolsmaxscale:"GPEditorMapBoxStyleToolsScaleMaxContainer",scalelabelmax:"GPEditorMapBoxStyleScaleLabelMax",scaleinputmax:"GPEditorMapBoxStyleScaleInputMax",containertoolsedit:"GPEditorMapBoxStyleToolsEditionContainer"}}},{key:"_initContainer",value:function(){var e=this,t=!1,i=JSON.parse(JSON.stringify(this.options.obj)),n={};i.paint&&(t=!0,n.paint=i.paint,0===Object.keys(i.paint).length&&p.info("tag 'paint' is empty !")),i.layout&&(t=!0,n.layout=i.layout,i.layout.visibility&&delete n.visibility,0===Object.keys(i.layout).length&&p.info("tag 'layout' is empty !"));var o=document.createElement("div");o.className=this.name.container;var a=null;if(t){var r=JSON.stringify(n,null,4);a=this._syntaxHighlight(r)}var s=document.createElement("div");s.className=this.name.containerjson;var l=document.createElement("label");l.className=this.name.jsonlabel,l.innerHTML=this.options.title,s.appendChild(l);var c=document.createElement("pre");c.className=this.name.jsondisplay,c.innerHTML=a,c.addEventListener?c.addEventListener("click",(function(t){e.options.tools.edition&&e.onEditJsonStyleMapBox(t)})):c.attachEvent&&c.attachEvent("onclick",(function(t){e.options.tools.edition&&e.onEditJsonStyleMapBox(t)})),s.appendChild(c),o.appendChild(s),this.options.tools.scale&&o.appendChild(this._createElementToolsScale({min:n.layout?n.layout.minzoom:0,max:n.layout?n.layout.maxzoom:21})),this.options.tools.edition&&o.appendChild(this._createElementToolsEdition()),this.container=o}},{key:"_createElementToolsScale",value:function(e){p.trace("_createElementToolsScale");var t=this,i=this.options.obj,n=document.createElement("div");n.className=this.name.containertoolsscale;var o=document.createElement("div");o.className=this.name.containertoolsminscale;var a=document.createElement("label");a.className=this.name.scalelabelmin,a.innerHTML="min :",o.appendChild(a);var r=document.createElement("input");r.className=this.name.scaleinputmin,r.type="range",r.value=e.min||0,r.title=e.min||0,r.disabled=!1,r.min=0,r.max=21,r.data=i,r.addEventListener?r.addEventListener("change",(function(e){t.onChangeStyleScaleMinMapBox(e)})):r.appendChild&&r.appendChild("onchange",(function(e){t.onChangeStyleScaleMinMapBox(e)})),o.appendChild(r),n.appendChild(o);var s=document.createElement("div");s.className=this.name.containertoolsmaxscale;var l=document.createElement("label");l.className=this.name.scalelabelmax,l.innerHTML="max :",s.appendChild(l);var c=document.createElement("input");return c.className=this.name.scaleinputmin,c.type="range",c.value=e.max||21,c.title=e.max||21,c.disabled=!1,c.min=0,c.max=21,c.data=i,c.addEventListener?c.addEventListener("change",(function(e){t.onChangeStyleScaleMaxMapBox(e)})):c.appendChild&&c.appendChild("onchange",(function(e){t.onChangeStyleScaleMaxMapBox(e)})),s.appendChild(c),n.appendChild(s),n}},{key:"_createElementToolsEdition",value:function(){p.warn("_createElementToolsEdition, it's not yet implemented !");var e=document.createElement("div");return e.className=this.name.containertoolsedit,e}},{key:"_syntaxHighlight",value:function(e){return(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,(function(e){var t="gp-json-number";return/^"/.test(e)?t=/:$/.test(e)?"gp-json-key":"gp-json-string":/true|false/.test(e)?t="gp-json-boolean":/null/.test(e)&&(t="gp-json-null"),"<span class='"+t+"'>"+e+"</span>"}))}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"display",value:function(e){return p.trace("display()",e),void 0!==e&&(this.container.style.display=e?"flex":"none"),"flex"===this.container.style.display}},{key:"getContainer",value:function(){return this.container}},{key:"onEditJsonStyleMapBox",value:function(e){p.trace("onEditJsonStyleMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.style.oneditjson,e)}},{key:"onChangeStyleScaleMinMapBox",value:function(e){p.trace("onChangeStyleScaleMinMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.style.scale.onchangemin,e)}},{key:"onChangeStyleScaleMaxMapBox",value:function(e){p.trace("onChangeStyleScaleMaxMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.style.scale.onchangemax,e)}}],i&&c(e.prototype,i),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();const h=u;function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Style=u);var f=r.A.getLogger("editor-themes"),v=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f.trace("[constructor] Themes",t),this.options=t||{},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target;var e={thumbnails:!0,button:{visible:!0,type:"radio"}};this.options.tools&&0!==Object.keys(this.options.tools).length||(this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1),void 0!==this.options.obj&&null!==this.options.obj&&this.options.obj||(this.options.obj={themesSummary:"",themes:[]}),this.container=null,this.name={target:"GPEditorMapBoxThemeTarget",container:"GPEditorMapBoxThemesContainer",containertheme:"GPEditorMapBoxThemeContainer",containerthemeID:"GPEditorMapBoxThemeContainer_ID_",input:"GPEditorMapBoxThemeInput",inputID:"GPEditorMapBoxThemeInput_ID_",label:"GPEditorMapBoxThemeTitle",labelID:"GPEditorMapBoxThemeTitle_ID_",image:"GPEditorMapBoxThemeImage",imageID:"GPEditorMapBoxThemeImage_ID_",message:"GPEditorMapBoxThemeMessage"}}},{key:"_initContainer",value:function(){var e=this,t=this.options.obj,i=this.id||a.A.generate(),n=document.createElement("div");n.className=this.name.container,n.title=t.themesSummary||"";var o=t.themes;if(o)for(var r=0;r<o.length;r++){var s=o[r],l=document.createElement("div");l.id=this.name.containerthemeID+r+"_"+i,l.className=this.name.containertheme,l.tabIndex=r;var c=s.url,d=s.selected||!1;if(c){var p=this.options.tools.button;if(p.visible){var u="checkbox"===p.type?"checkbox":"radio",h=document.createElement("input");h.type=u,h.id=this.name.inputID+r+"_"+i,h.className=this.name.input,h.name=i,h.checked=d,h.data=c,h.addEventListener?h.addEventListener("click",(function(t){e.onClickThemeTitleMapBox(t)})):h.attachEvent&&h.attachEvent("onclick",(function(t){e.onClickThemeTitleMapBox(t)})),l.appendChild(h)}if(this.options.tools.thumbnails&&s.thumbnail){var m=document.createElement("img");m.id=this.name.imageID+r+"_"+i,m.className=this.name.image,m.src=s.thumbnail,m.alt=s.thumbnail,m.title=s.description||"",m.data=c,m.addEventListener?m.addEventListener("click",(function(t){e.onClickThemeImageMapBox(t);var i=t.target.parentElement.childNodes;if(i){var n=i[0];"input"===n.tagName.toLowerCase()&&(n.checked=!n.checked)}})):m.attachEvent&&m.attachEvent("onclick",(function(t){e.onClickThemeImageMapBox(t);var i=t.target.parentElement.childNodes;if(i){var n=i[0];"input"===n.tagName.toLowerCase()&&(n.checked=!n.checked)}})),l.appendChild(m)}if(s.name){var y=document.createElement("label");y.id=this.name.labelID+r+"_"+i,this.options.tools.button.visible&&(y.htmlFor=h.id),y.className=this.name.label,y.innerHTML=s.name,y.title=s.description||"",y.data=c,this.options.tools.button.visible||(y.addEventListener?y.addEventListener("click",(function(t){e.onClickThemeTitleMapBox(t)})):y.attachEvent&&y.attachEvent("onclick",(function(t){e.onClickThemeTitleMapBox(t)}))),l.appendChild(y)}}else{var g=document.createElement("label");g.className=this.name.message,g.innerHTML="Thème non disponible...",l.appendChild(g)}n.appendChild(l)}this.container=n}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"display",value:function(e){return f.trace("display()",e),void 0!==e&&(this.container.style.display=e?"flex":"none"),"flex"===this.container.style.display}},{key:"getContainer",value:function(){return this.container}},{key:"onClickThemeImageMapBox",value:function(e){if(f.trace("onClickThemeImageMapBox",e),e.editorID=this.id,e.data=this.options,"checkbox"===this.options.tools.button.type)for(var i=e.target.previousSibling.id.substring(e.target.previousSibling.id.lastIndexOf("_")+1),n=document.getElementsByClassName(this.name.input),o=0;o<n.length;o++){var a=n[o];a.id!==e.target.previousSibling.id&&a.id.substring(a.id.lastIndexOf("_")+1)===i&&(a.checked=!1)}t().dispatch(s.themes.onclickimage,e)}},{key:"onClickThemeTitleMapBox",value:function(e){if(f.trace("onClickThemeTitleMapBox",e),e.editorID=this.id,e.data=this.options,"checkbox"===this.options.tools.button.type)for(var i=e.target.id.substring(e.target.id.lastIndexOf("_")+1),n=document.getElementsByClassName(this.name.input),o=0;o<n.length;o++){var a=n[o];a.id!==e.target.id&&a.id.substring(a.id.lastIndexOf("_")+1)===i&&(a.checked=!1)}t().dispatch(s.themes.onclicktitle,e)}}],i&&y(e.prototype,i),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();const b=v;function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function w(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E(t)?t:t+""}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Themes=v);var k=r.A.getLogger("editor-filter"),C=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k.trace("[constructor] Filter",t),this.options=t||{target:null,position:0,tools:null,title:null,obj:null},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={edition:!1};this.options.tools||(this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={filter:[]}),this.options.title||(this.options.title="JSON Filtres :"),this.container=null,this.name={target:"GPEditorMapBoxFilterTarget",container:"GPEditorMapBoxFilterContainer",containerjson:"GPEditorMapBoxFilterJsonContainer",jsonlabel:"GPEditorMapBoxFilterTitleJson",jsondisplay:"GPEditorMapBoxFilterDisplayJson",containertoolsedit:"GPEditorMapBoxFilterToolsEditionContainer"}}},{key:"_initContainer",value:function(){var e=this,t=!1,i=JSON.parse(JSON.stringify(this.options.obj));i.filter&&(t=!0,0===i.filter.length&&k.info("tag 'filter' is empty !"));var n=document.createElement("div");n.className=this.name.container;var o=null;t&&(o=JSON.stringify(i.filter,null,4));var a=document.createElement("div");a.className=this.name.containerjson;var r=document.createElement("label");r.className=this.name.jsonlabel,r.innerHTML=this.options.title,a.appendChild(r);var s=document.createElement("pre");if(s.className=this.name.jsondisplay,s.innerHTML=o,s.addEventListener?s.addEventListener("click",(function(t){e.options.tools.edition&&e.onEditJsonFilterMapBox(t)})):s.attachEvent&&s.attachEvent("onclick",(function(t){e.options.tools.edition&&e.onEditJsonFilterMapBox(t)})),a.appendChild(s),n.appendChild(a),this.options.tools.edition){var l=document.createElement("div");l.className=this.name.containertoolsedit,n.appendChild(l)}this.container=n}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"display",value:function(e){return k.trace("display()",e),void 0!==e&&(this.container.style.display=e?"flex":"none"),"flex"===this.container.style.display}},{key:"getContainer",value:function(){return this.container}},{key:"onEditJsonFilterMapBox",value:function(e){k.trace("onEditJsonFilterMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.filter.oneditjson,e)}}],i&&x(e.prototype,i),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();const L=C;window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Filter=C);var T=i(3920);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function B(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M(n.key),n)}}function M(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:t+""}var j=r.A.getLogger("editor-legend"),N=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),j.trace("[constructor] Legend",t),this.options=t||{target:null,position:0,sprites:null,obj:null},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()}return i=e,n=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0),this.options.obj||(this.options.obj={title:"vide...",editable:!0,paint:{"fill-color":"#FFFFFF"}});var e=this.options.obj.editable;this.editable=void 0!==e&&e,this.legendRender={type:"fill",values:{width:1,stroke:"#FFFFFF",color:"#000000",opacity:1}},this.container=null,this.rendercontainer=null,this.toolscontainer=null,this.name={target:"GPEditorMapBoxLegendTarget",container:"GPEditorMapBoxLegendContainer",containerlegendrender:"GPEditorMapBoxLegendRenderContainer",legendrender:"GPEditorMapBoxLegendRender",legendeditable:"GPEditorMapBoxLegendEditable",legendtitle:"GPEditorMapBoxLegendTitle",containerlegendtools:"GPEditorMapBoxLegendToolsContainer"},this.labels={"line-color":"Couleur du trait","line-width":"Epaisseur du trait","line-opacity":"Opacité du trait","fill-color":"Couleur de remplissage","fill-opacity":"Opacité du remplissage"}}},{key:"_initContainer",value:function(){var e=this.options.obj,t=document.createElement("div");t.className=this.name.container;var i=Object.assign({},e.paint,e.layout),n=Object.keys(i);if(0!==n.length){for(var o={},a=!1,r=0;r<n.length;r++){var s=n[r];if(/fill-/.test(s)||/line-/.test(s)||/circle-/.test(s)||/background-/.test(s)||/text-/.test(s)||/icon-/.test(s)){a=!0;var l=e.title||"",c=s.split("-")[0];"text"!==c&&"icon"!==c||(c="symbol"),this.legendRender=this._getProperties(c,i),o={edit:this.editable,title:l,type:this.legendRender.type,values:this.legendRender.values},t.appendChild(this._createElementIconLegend(o));break}}a||(o={edit:this.editable,title:"",type:this.legendRender.type,values:this.legendRender.values},t.appendChild(this._createElementIconLegend(o)),j.warn("legend type unknown, default legend used...")),this.toolscontainer=this._createElementEditionLegend(o),t.appendChild(this.toolscontainer),this.container=t}else j.info("tag 'paint' or 'layout' is empty !")}},{key:"_getProperties",value:function(t,i){if("symbol"===t){var n=i["text-field"],o=i["icon-image"];if("unknow"==(t=n&&o?"icon":n?"text":o?"icon":"unknow"))return void j.warn("type unknow !?")}var a={};for(var r in i)if(Object.hasOwnProperty.call(i,r)){var s=i[r];if(e.PROPERTIES[t].includes(r)){var l=r.replace(t,"").slice(1),c=this._getValue(s);if(c){if(!("pattern"!==l&&"image"!==l||this.options.sprites&&this.options.sprites.json&&this.options.sprites.json[c])){var d=t+":"+l;j.warn("sprites mandatory for key ",d);break}a[l]=c}}else j.warn("property not supported : ",r)}return{type:t,values:a}}},{key:"_renderThumbnail",value:function(e,t){var i=this.rendercontainer;if(!i)return!1;var n=null;switch(t.color||(t.color="#FFFFFF"),e){case"text":n="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>\")",i.style.background=n.replace("%color%",0===t.color.indexOf("rgb")?t.color:T.A.hexToRgba(t.color,1)).replace("%opacity%",t.opacity||1).replace("%style%","font-size: 5em;font-weight: bold;");break;case"icon":t.image?(n="<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>".replace("%x%",this.options.sprites.json[t.image].x).replace("%y%",this.options.sprites.json[t.image].y).replace(/%w%/g,this.options.sprites.json[t.image].width).replace(/%h%/g,this.options.sprites.json[t.image].height).replace("%W%",this.options.sprites.size.w).replace("%H%",this.options.sprites.size.h).replace("%URL%",this.options.sprites.url),i.innerHTML=n):(n="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>\")",i.style.background=n.replace("%color%",0===t.color.indexOf("rgb")?t.color:T.A.hexToRgba(t.color,1)).replace("%style%","fill: transparent;stroke-width: 10;"));break;case"line":var o=Array.isArray(t.dasharray)?t.dasharray.join(" "):0;n="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>\")",i.style.background=n.replace("%color%",0===t.color.indexOf("rgb")?t.color:T.A.hexToRgba(t.color,1)).replace("%stroke-opacity%",t.opacity||1).replace("%stroke-dasharray%",o).replace("%stroke-width%",3*(t.width||0));break;case"circle":var a=t["stroke-color"]||"#FFFFFF";n="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>\")",i.style.background=n.replace("%color%",0===t.color.indexOf("rgb")?t.color:T.A.hexToRgba(t.color,1)).replace("%opacity%",t.opacity||1).replace("%stroke-color%",0===a.indexOf("rgb")?a:T.A.hexToRgba(a,1)).replace("%stroke-opacity%",t["stroke-opacity"]||1).replace("%stroke-width%",3*(t["stroke-width"]||0));break;case"background":case"fill":if(t.pattern)n="<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>".replace("%x%",this.options.sprites.json[t.pattern].x).replace("%y%",this.options.sprites.json[t.pattern].y).replace(/%w%/g,this.options.sprites.json[t.pattern].width).replace(/%h%/g,this.options.sprites.json[t.pattern].height).replace("%W%",this.options.sprites.size.w).replace("%H%",this.options.sprites.size.h).replace("%URL%",this.options.sprites.url),i.innerHTML=n;else{var r=t["outline-color"]||"#FFFFFF";n="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>\")",i.style.background=n.replace("%color%",0===t.color.indexOf("rgb")?t.color:T.A.hexToRgba(t.color,1)).replace("%opacity%",t.opacity||1).replace("%stroke-color%",0===r.indexOf("rgb")?r:T.A.hexToRgba(r,1))}break;default:return j.warn("type not found, no thumbnail..."),!1}return!0}},{key:"_getValue",value:function(e){var t=null;if("string"==typeof e)t=e;else if("number"==typeof e)t=e;else if(Array.isArray(e)){var i=!0;e.forEach((function(e){"number"!=typeof e&&(i=!1)})),i&&(t=e)}else"object"===S(e)?(t=null,"stops"in e&&(e.stops.sort((function(e,t){var i=e[0],n=t[0];return i>n?-1:i<n?1:0})),t=e.stops.slice(-1)[0][1])):j.warn("value not supported !");return t}},{key:"_createElementIconLegend",value:function(e){var t=this,i=document.createElement("div");i.className=this.name.containerlegendrender;var n=this.rendercontainer=document.createElement("div");n.className=this.name.legendrender,e.edit&&(n.className+=" ",n.className+=this.name.legendeditable,n.addEventListener?n.addEventListener("click",(function(e){t.onEditionLegendMapBox(e)})):n.attachEvent&&n.attachEvent("onclick",(function(e){t.onEditionLegendMapBox(e)})));var o=e.type;this._renderThumbnail(o,e.values)?n.className+=e.edit?" legend-"+o:" legend-"+o+"-not-editable":n.className+=" legend-unknow",i.appendChild(n);var a=document.createElement("span");return a.className=this.name.legendtitle,a.innerHTML=e.title||"",i.appendChild(a),i}},{key:"_createElementEditionLegend",value:function(e){var t=this,i=document.createElement("div");if(i.className=this.name.containerlegendtools,!e.edit)return i;switch(e.type){case"line":(function(){var n=document.createElement("div");n.className="legend-styling-div";var o=document.createElement("label");o.className="legend-line",o.htmlFor=this.id?"line-color-"+this.id:"line-color",o.innerHTML=this.labels["line-color"];var a=document.createElement("input");a.className="legend-styling",a.id=this.id?"line-color-"+this.id:"line-color",a.title="Selectionner une couleur de trait",a.type="color",a.value=e.values.color,a.setAttribute("data-id","line-color"),a.addEventListener?a.addEventListener("change",(function(i){t._renderThumbnail(e.type,Object.assign(e.values,{color:i.target.value})),t.onChangeValueLegendMapBox(i)})):a.attachEvent&&a.attachEvent("onchange",(function(i){t._renderThumbnail(e.type,Object.assign(e.values,{color:i.target.value})),t.onChangeValueLegendMapBox(i)})),n.appendChild(o),n.appendChild(a),i.appendChild(n)}).call(t),function(){var n=document.createElement("div");n.className="legend-styling-div";var o=document.createElement("label");o.className="legend-line",o.htmlFor=this.id?"line-width-"+this.id:"line-width",o.innerHTML=this.labels["line-width"];var a=document.createElement("input");a.className="legend-styling",a.id=this.id?"line-width-"+this.id:"line-width",a.title=e.values.width,a.type="range",a.min="0",a.max="10",a.step="1",a.defaultValue=e.values.width,a.setAttribute("data-id","line-width"),a.addEventListener?a.addEventListener("change",(function(i){j.trace(i),i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{width:i.target.value})),t.onChangeValueLegendMapBox(i)})):a.attachEvent&&a.attachEvent("onchange",(function(i){j.trace(i),i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{width:i.target.value})),t.onChangeValueLegendMapBox(i)})),n.appendChild(o),n.appendChild(a),i.appendChild(n)}.call(t),function(){var n=document.createElement("div");n.className="legend-styling-div";var o=document.createElement("label");o.className="legend-line",o.htmlFor=this.id?"line-opacity-"+this.id:"line-opacity",o.innerHTML=this.labels["line-opacity"];var a=document.createElement("input");a.className="legend-styling",a.id=this.id?"line-opacity-"+this.id:"line-opacity",a.title=e.values.opacity,a.type="range",a.min="0",a.max="1",a.step="0.1",a.defaultValue=e.values.opacity,a.setAttribute("data-id","line-opacity"),a.addEventListener?a.addEventListener("change",(function(i){j.trace(i),i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{opacity:i.target.value})),t.onChangeValueLegendMapBox(i)})):a.attachEvent&&a.attachEvent("onchange",(function(i){j.trace(i),i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{opacity:i.target.value})),t.onChangeValueLegendMapBox(i)})),n.appendChild(o),n.appendChild(a),i.appendChild(n)}.call(t);break;case"background":case"fill":(function(){var n=document.createElement("div");n.className="legend-styling-div";var o=document.createElement("label");o.className="legend-fill",o.htmlFor=this.id?"fill-color-"+this.id:"fill-color",o.innerHTML=this.labels["fill-color"];var a=document.createElement("input");a.className="legend-styling",a.id=this.id?"fill-color-"+this.id:"fill-color",a.title="Selectionner une couleur de remplissage",a.type="color",a.value=e.values.color,a.setAttribute("data-id","fill-color"),a.addEventListener?a.addEventListener("change",(function(i){t._renderThumbnail(e.type,Object.assign(e.values,{color:i.target.value})),t.onChangeValueLegendMapBox(i)})):a.attachEvent&&a.attachEvent("onchange",(function(i){t._renderThumbnail(e.type,Object.assign(e.values,{color:i.target.value})),t.onChangeValueLegendMapBox(i)})),n.appendChild(o),n.appendChild(a),i.appendChild(n)}).call(t),function(){var n=document.createElement("div");n.className="legend-styling-div";var o=document.createElement("label");o.className="legend-fill",o.htmlFor=this.id?"fill-opacity-"+this.id:"fill-opacity",o.innerHTML=this.labels["fill-opacity"];var a=document.createElement("input");a.className="legend-styling",a.id=this.id?"fill-opacity-"+this.id:"fill-opacity",a.title=e.values.opacity,a.type="range",a.min="0",a.max="1",a.step="0.1",a.defaultValue=e.values.opacity,a.setAttribute("data-id","fill-opacity"),a.addEventListener?a.addEventListener("change",(function(i){i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{opacity:i.target.value})),t.onChangeValueLegendMapBox(i)})):a.attachEvent&&a.attachEvent("onchange",(function(i){i.target.title=i.target.value,t._renderThumbnail(e.type,Object.assign(e.values,{opacity:i.target.value})),t.onChangeValueLegendMapBox(i)})),n.appendChild(o),n.appendChild(a),i.appendChild(n)}.call(t)}return i}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"display",value:function(e){return j.trace("display()",e),void 0!==e&&(this.container.style.display=e?"flex":"none"),"flex"===this.container.style.display}},{key:"isEditable",value:function(){return this.editable}},{key:"getRenderContainer",value:function(){return this.rendercontainer}},{key:"getToolsContainer",value:function(){return this.toolscontainer}},{key:"getContainer",value:function(){return this.container}},{key:"onEditionLegendMapBox",value:function(e){j.trace("onEditionLegendMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.legend.onclickedition,e)}},{key:"onChangeValueLegendMapBox",value:function(e){j.trace("onChangeValueLegendMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.legend.onchangevalue,e)}}],n&&B(i.prototype,n),o&&B(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,n,o}();N.PROPERTIES={line:["line-color","line-dasharray","line-opacity","line-width"],fill:["fill-color","fill-opacity","fill-outline-color","fill-pattern"],background:["background-color","background-opacity","background-pattern"],circle:["circle-color","circle-opacity","circle-stroke-color","circle-stroke-opacity","circle-stroke-width"],icon:["icon-color","icon-image","icon-opacity","__icon-size"],text:["__text-anchor","text-color","text-field","__text-font","__text-opacity","__text-size"]};const P=N;function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:t+""}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Legend=N);var R=r.A.getLogger("editor-layer"),F=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R.trace("[constructor] Layer",t),this.options=t||{},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target,this.options.position||(this.options.position=0);var e={visibility:!0,icon:{image:!0,anchor:"end"},type:!0,pin:!0,remove:!1,clone:!1};this.options.tools||(this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1);var t={id:"",type:"",source:"","source-layer":""};this.options.obj||(this.options.obj=t),o.A.mergeParams(this.options.obj,t,!1),this.bSlotLegend=!1,this.oFilter=null,this.oStyle=null,this.oLegend=null,this.container=null,this.DomVisibility=null,this.DomToggle=null,this.name={target:"GPEditorMapBoxLayerTarget",container:"GPEditorMapBoxLayerContainer",containerlegend:"GPEditorMapBoxLayerLegendContainer",containertitle:"GPEditorMapBoxLayerTitleContainer",imagelabelinput:"GPEditorMapBoxLayerImageInput",imagelabel:"GPEditorMapBoxLayerImageLabel",typeimg:"GPEditorMapBoxLayerTypeImage",titleinput:"GPEditorMapBoxLayerTitleInput",titlelabel:"GPEditorMapBoxLayerTitleLabel",containertools:"GPEditorMapBoxToolsContainer",visibilityinput:"GPEditorMapBoxToolsVisibilityInput",visibilitylabel:"GPEditorMapBoxToolsVisibilityLabel",visibilityinputdisable:"GPEditorMapBoxToolsVisibilityInputDisable",visibilitylabeldisable:"GPEditorMapBoxToolsVisibilityLabelDisable"}}},{key:"_initContainer",value:function(){var e=this,t=this.options.obj,i=document.createElement("div");i.className=this.name.container;var n=document.createElement("div");if(n.id=this.name.containertitle+"-"+this.options.position,n.className=this.name.containertitle,this.options.tools.pin){var o=document.createElement("input");o.id=this.name.imagelabelinput+"-"+this.options.position,o.className=this.name.imagelabelinput,o.type="checkbox",n.appendChild(o);var a=document.createElement("label");a.className=this.name.imagelabel,a.htmlFor=o.id,a.addEventListener?a.addEventListener("click",(function(t){e.onClickLayerMapBox(t)})):a.attachEvent&&a.attachEvent("onclick",(function(t){e.onClickLayerMapBox(t)})),n.appendChild(a)}var r=function(){var t=document.createElement("div");if(t.id=this.name.containertools+"-"+this.options.position,t.className=this.name.containertools,this.options.tools.visibility){var n=document.createElement("input");n.id=this.name.visibilityinput+"-"+this.options.position,n.className=this.options.tools.icon.image?this.name.visibilityinput:this.name.visibilityinputdisable,n.type="checkbox",n.checked="checked",n.addEventListener?n.addEventListener("click",(function(t){e.onVisibilityLayerMapBox(t)})):n.attachEvent&&n.attachEvent("onclick",(function(t){e.onVisibilityLayerMapBox(t)})),t.appendChild(n),this.DomVisibility=n;var o=document.createElement("label");o.htmlFor=this.name.visibilityinput+"-"+this.options.position,o.id=this.name.visibilitylabel+"-"+this.options.position,o.className=this.options.tools.icon.image?this.name.visibilitylabel:this.name.visibilitylabeldisable,o.title="Afficher/masquer la couche",t.appendChild(o),i.appendChild(t)}this.options.tools.clone&&R.warn("Dom for tools clone, it's not yet implemented !"),this.options.tools.remove&&R.warn("Dom for tools remove, it's not yet implemented !")};if("start"===this.options.tools.icon.anchor&&r.apply(this),this.options.tools.type&&t.type){var s=document.createElement("img");switch(s.className=this.name.typeimg,t.type.toUpperCase()){case"SYMBOL-ICON":s.style["background-position"]="0px 0";break;case"SYMBOL-TEXT":s.style["background-position"]="-194px 0";break;case"SYMBOL":s.style["background-position"]="-84px 0";break;case"LINE":s.style["background-position"]="-28px 0";break;case"FILL":s.style["background-position"]="-56px 0";break;case"BACKGROUND":s.style["background-position"]="-140px 0";break;case"CIRCLE":s.style["background-position"]="-168px 0";break;default:s.style["background-position"]="-112px 0"}n.appendChild(s)}var l=document.createElement("div");l.id=this.name.containerlegend+"-"+this.options.position,l.className=this.name.containerlegend,n.appendChild(l);var c=document.createElement("input");c.id=this.name.titleinput+"-"+this.options.position,c.className=this.name.titleinput,c.type="checkbox",n.appendChild(c);var d=document.createElement("label");d.className=this.name.titlelabel,d.htmlFor=c.id,d.innerHTML=t.id||t["source-layer"]||t.source,d.title=t["source-layer"]||t.source||t.id,d.addEventListener?d.addEventListener("click",(function(t){e.onClickLayerMapBox(t)})):d.attachEvent&&d.attachEvent("onclick",(function(t){e.onClickLayerMapBox(t)})),n.appendChild(d),this.DomToggle=d,i.appendChild(n),"end"===this.options.tools.icon.anchor&&r.apply(this),this.container=i}},{key:"add",value:function(){if(R.trace("add()"),!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"addStyle",value:function(e){R.trace("addStyle()",e),e&&"object"===O(e)&&e instanceof h&&(this.oStyle=e,this.oStyle.display(!1))}},{key:"addFilter",value:function(e){R.trace("addFilter()",e),e&&"object"===O(e)&&e instanceof L&&(this.oFilter=e,this.oFilter.display(!1))}},{key:"addLegend",value:function(e){R.trace("addLegend()",e),e&&"object"===O(e)&&e instanceof P&&(this.oLegend=e,this.oLegend.display(!1))}},{key:"slotLegend",value:function(){var e=this.oLegend;if(e){var t=null,i=this.container.childNodes;if(i.length)for(var n=i["start"===this.options.tools.icon.anchor?1:0].childNodes,o=0;o<n.length;o++){var a=n[o];-1!==a.id.indexOf(this.name.containerlegend)&&(t=a)}if(t){var r=e.getRenderContainer();r&&(t.appendChild(r),this.bSlotLegend=!0)}}}},{key:"visibility",value:function(e){if(R.trace("visibility()",e),this.options.tools.visibility)return void 0!==e&&(this.DomVisibility.checked=e?"checked":""),this.DomVisibility.checked}},{key:"collapse",value:function(){R.trace("collapse()"),this.DomToggle.click()}},{key:"visible",value:function(){R.trace("visible()"),this.options.tools.visibility&&this.DomVisibility.click()}},{key:"display",value:function(e){R.trace("display()",e);var t=document.getElementById(this.DomToggle.htmlFor).checked;return void 0!==e&&(this.container.style.display=e?"inline-flex":"none",this.oStyle&&this.oStyle.display(e&&t),this.oFilter&&this.oFilter.display(e&&t),this.oLegend&&this.oLegend.display(e&&t)),t}},{key:"active",value:function(e){return R.trace("active()",e),void 0!==e&&(this.container.className=e?this.name.container:this.name.container+" disabled"),this.container.className===this.name.container}},{key:"getContainer",value:function(){return this.container}},{key:"onClickLayerMapBox",value:function(e){R.trace("onClickLayerMapBox",e);var t=e.target.htmlFor.substring(e.target.htmlFor.indexOf("-")),i=document.getElementById(e.target.htmlFor).checked;e.target.htmlFor===this.name.imagelabelinput+t&&(document.getElementById(this.name.titleinput+t).checked=!i),e.target.htmlFor===this.name.titleinput+t&&document.getElementById(this.name.imagelabelinput+t)&&(document.getElementById(this.name.imagelabelinput+t).checked=!i),this.oStyle&&this.oStyle.display(!i),this.oFilter&&this.oFilter.display(!i),this.oLegend&&this.oLegend.isEditable()&&this.oLegend.display(!i)}},{key:"onVisibilityLayerMapBox",value:function(e){R.trace("onVisibilityLayerMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.layer.onclickvisibility,e)}},{key:"onCloneLayerMapBox",value:function(e){R.trace("onCloneLayerMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.layer.onclickclone,e)}},{key:"onRemoveLayerMapBox",value:function(e){R.trace("onRemoveLayerMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.layer.onclickremove,e)}}],i&&_(e.prototype,i),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();const G=F;function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function D(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:t+""}window.ol&&window.ol.style&&(window.ol.style.editor||(window.ol.style.editor={}),window.ol.style.editor.Layer=F);var V=r.A.getLogger("editor-group");const z=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V.trace("[constructor] Group",t),this.options=t||{},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target,this.options.title||(this.options.title="Détails du groupe..."),void 0===this.options.collapse&&(this.options.collapse=!0),this.container=null,this.name={target:"GPEditorMapBoxGroupTarget",container:"GPEditorMapBoxGroupContainer",details:"GPEditorMapBoxGroupDetails",summary:"GPEditorMapBoxGroupSummary"}}},{key:"_initContainer",value:function(){var e=document.createElement("div");e.className=this.name.container;var t=document.createElement("details");t.className=this.name.details,t.open=!this.options.collapse,e.appendChild(t);var i=document.createElement("summary");i.className=this.name.summary,i.innerHTML=this.options.title,t.appendChild(i),this.container=e}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}this.container&&this.options.target.appendChild(this.container)}},{key:"display",value:function(e){this.container.style.display=e?"flex":"none"}},{key:"getContainer",value:function(){var e=this.container.childNodes;return e.length?e[0]:this.container}},{key:"onCollapseGroupMapBox",value:function(e){V.trace("onCollapseGroupMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.group.oncollapse,e)}}],i&&D(e.prototype,i),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W(n.key),n)}}function W(e){var t=function(e,t){if("object"!=J(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==J(t)?t:t+""}var Y=r.A.getLogger("editor-search");const $=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Y.trace("[constructor] Search",t),this.options=t||{target:null,tools:null,title:null,obj:null},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize(),this._initContainer()},i=[{key:"_initialize",value:function(){this.id=this.options.id||null,this.options.target;var e={};this.options.tools||(this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1),this.options.obj||(this.options.obj={}),this.options.title||(this.options.title="Recherche de couches :"),this.container=null,this.name={target:"GPEditorMapBoxSearchTarget",container:"GPEditorMapBoxSearchContainer"}}},{key:"_initContainer",value:function(){var e=JSON.parse(JSON.stringify(this.options.obj));e.layers&&0===e.layers.length&&Y.info("tag 'layers' is empty !");var t=document.createElement("div");t.className=this.name.container,this.container=t}},{key:"add",value:function(){if(!this.options.target){if(!document.getElementById(this.name.target)){var e=document.createElement("div");e.id=this.name.target,(document.documentElement||document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]).appendChild(e)}this.options.target=document.getElementById(this.name.target)}return this.container&&this.options.target.appendChild(this.container),this}},{key:"display",value:function(e){return Y.trace("display()",e),void 0!==e&&(this.container.style.display=e?"flex":"none"),"flex"===this.container.style.display}},{key:"getContainer",value:function(){return this.container}},{key:"onSubmitSearchLayersMapBox",value:function(e){Y.trace("onSubmitSearchLayersMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.search.onsubmit,e)}},{key:"onAutocompleteSearchLayersMapBox",value:function(e){Y.trace("onAutocompleteSearchLayersMapBox",e),e.editorID=this.id,e.data=this.options,t().dispatch(s.search.onautocomplete,e)}}],i&&U(e.prototype,i),n&&U(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();const q={_addUID:function(e){return this._uid?e+"-"+this._uid:e}};function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function X(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z(n.key),n)}}function Z(e){var t=function(e,t){if("object"!=K(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==K(t)?t:t+""}var Q=r.A.getLogger("editor"),ee=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Q.trace("[constructor] Editor",t),this.options=t||{},!(this instanceof e))throw new TypeError("ERROR CLASS_CONSTRUCTOR");this._initialize()},(i=[{key:"_initialize",value:function(){if(this.options.target||Q.info("La 'target' n'est pas renseignée (options.target)."),this.options.style){this.options.events?this._initEvents():Q.warn("Les 'handlers' ne sont pas renseignés (options.events) !"),this.options.themes||Q.info("Les 'themes' MapBox ne sont pas renseignés (options.themes).");var e={themes:!1,layers:!0,search:!1,style:!1,filter:!1,legend:!1,group:!1,groupAuto:!1,sort:!0,sortBy:"id",sortOrder:"asc",title:!0,collapse:void 0,type:!0,pin:!0,visibility:!0,icon:{image:!0,anchor:"end"},editable:!0};this.options.tools||(Q.trace("Utilisation des outils MapBox par défaut (options.tools)."),this.options.tools=e),o.A.mergeParams(this.options.tools,e,!1),this.id=this.options.id||a.A.generate(),this.context={},this.layers=[],this.container=null,this.name={target:"GPEditorMapBoxTarget",container:"GPEditorMapBoxContainer",containerID:"GPEditorMapBoxContainer_ID_",containerLayers:"GPEditorMapBoxLayersContainer",titleLayers:"GPEditorMapBoxLayersTitle",titleLayersID:"GPEditorMapBoxLayersTitle_ID_",titleThemes:"GPEditorMapBoxThemesTitle",titleThemesID:"GPEditorMapBoxThemesTitle_ID_",sep:"GPEditorMapBoxSep"},this.mapbox={},this.sprites={}}else Q.error("Le 'style' MapBox n'est pas renseigné (options.style) !")}},{key:"_initEvents",value:function(){var e=this.options.scope||this,i=this.options.events;if(i)for(var n in i)if(i.hasOwnProperty(n)){var o=i[n];o&&(t().hasEventListener(n,o,e)||t().addEventListener(n,o,e))}}},{key:"_initContainer",value:function(){Q.trace(this.mapbox);var e=document.createElement("div");e.id=this.name.containerID+this.id,e.className=this.name.container;var i=this.options.tools.themes;if(i&&this.options.themes){if(this.options.tools.title){var n=document.createElement("div");n.id=this.name.titleThemesID+this.id,n.className=this.name.titleThemes,n.innerHTML="Liste des 'thèmes'",e.appendChild(n)}new b({id:this.id,target:e,tools:"object"===K(i)?i:{},obj:this.options.themes}).add()}for(var o in this.options.tools.search&&new $({id:this.id,target:e,tools:{},obj:this.mapbox.layers}).add(),this.mapbox.sources)if(this.mapbox.sources.hasOwnProperty(o)){if(this.options.tools.layers){var a=Object.keys(this.mapbox.sources).length>1?1:0;if(a){var r=document.createElement("hr");r.className=this.name.sep,e.appendChild(r)}if(this.options.tools.title){var l=document.createElement("div");l.id=this.name.titleLayersID+this.id,l.className=this.name.titleLayers,l.innerHTML=a?"Liste des 'couches' ("+o+")":"Liste des 'couches'",e.appendChild(l)}}var c=this.mapbox.layers.slice();if(c.forEach((function(e,t){var i=e.metadata;i?i["geoportail:order"]=t:e.metadata={"geoportail:order":t}})),this.options.tools.sort){var d=this.options.tools.sortBy,p=this.options.tools.sortOrder;c.sort((function(e,t){var i=0;if(e.metadata&&e.metadata["geoportail:group"]&&t.metadata&&t.metadata["geoportail:group"]){var n,o=null;o=e.metadata["geoportail:group"],n=t.metadata["geoportail:group"],i=o.localeCompare(n)}else switch(d){case"geom":i="asc"===p?e.type.localeCompare(t.type)||e.id.localeCompare(t.id):t.type.localeCompare(e.type)||t.id.localeCompare(e.id);break;case"class":i="asc"===p?e["source-layer"].localeCompare(t["source-layer"])||e.id.localeCompare(t.id):t["source-layer"].localeCompare(e["source-layer"])||t.id.localeCompare(e.id);break;default:i="asc"===p?e.id.localeCompare(t.id):t.id.localeCompare(e.id)}return i}))}Q.trace("Layers : ",c);var u=this.options.tools.sortBy,m=this.options.tools.groupAuto,y={};c.forEach((function(e){var t=e.metadata;if(t&&t["geoportail:group"]){var i=t["geoportail:group"];y[i]=y[i]?y[i]+1:1}else{var n=null;switch(u){case"class":n=e["source-layer"];break;case"geom":n=e.type;break;default:n=e.id}var o=n;if(m){var a=n.search(/_|-|:|=/);o=-1!==a?n.substring(0,a).trim():n}y[o]=y[o]?y[o]+1:1,t?t["geoportail:group"]=o:e.metadata={"geoportail:group":o}}})),Q.trace("Groups : ",y);var g,f=document.createElement("div");if(f.className=this.name.containerLayers,e.appendChild(f),void 0!==this.options.tools.collapse){(g=document.createElement("details")).className="",g.open=!this.options.tools.collapse,f.appendChild(g);var v=document.createElement("summary");v.className="",v.innerHTML="",g.appendChild(v)}for(var E=void 0!==this.options.tools.collapse?g:f,x=-1,w=0;w<c.length;w++){var k=c[w];if(x++,k.source===o){if(this.options.tools.group&&this.options.tools.sort)if(k.metadata){var C=k.metadata["geoportail:group"];if(C)if(y[C]>1){y[C]=-1;var T=new z({id:this.id,target:void 0!==this.options.tools.collapse?g:f,title:C,collapse:!0});T.add(),E=T.getContainer()}else 1===y[C]&&(E=void 0!==this.options.tools.collapse?g:f);else E=void 0!==this.options.tools.collapse?g:f}else E=void 0!==this.options.tools.collapse?g:f;if(this.options.tools.layers){var S=new G({id:this.id,target:E,position:x+"_"+this.id,tools:{visibility:this.options.tools.visibility,icon:this.options.tools.icon,type:this.options.tools.type,pin:this.options.tools.pin},obj:{id:k.id,type:k.type,source:k.source,"source-layer":k["source-layer"]}});S.add(),k.layout&&k.layout.visibility&&"none"===k.layout.visibility&&S.visibility(!1),this.layers.push(S)}if(this.options.tools.legend){var B=this.options.tools.editable;void 0===B&&(B=k.editable);var M=new P({id:this.id,target:E,sprites:this.sprites,obj:{id:k.id,source:k.source,title:k.id,editable:void 0!==B&&B,paint:k.paint,layout:k.layout}});M.add(),M.display(!1),S&&(S.addLegend(M),S.slotLegend())}if(this.options.tools.style){var j=new h({id:this.id,target:E,position:x+"_"+this.id,obj:{id:k.id,source:k.source,layout:k.layout,paint:k.paint}});j.add(),j.display(!1),S&&S.addStyle(j),k.layout&&k.layout.visibility&&"none"===k.layout.visibility&&S.visibility(!1)}if(this.options.tools.filter){var N=new L({id:this.id,target:E,position:x+"_"+this.id,obj:{id:k.id,source:k.source,filter:k.Filter}});N.add(),N.display(!1),S&&S.addFilter(N)}}else x>=0&&x--}}if(this.container=e,!this.options.target){if(!document.getElementById(this.name.target)){var O=document.createElement("div");O.id=this.name.target,(document.getElementsByTagName("body")[0]||document.getElementsByTagName("head")[0]||document.documentElement).appendChild(O)}this.options.target=document.getElementById(this.name.target)}this.container&&this.options.target.appendChild(this.container),t().dispatch(s.onloaded,this)}},{key:"_getSprites",value:function(e){var t,i=this;return e&&e.startsWith("mapbox://")?new Promise((function(e,t){Q.error("Protocole mapbox:// non géré !"),e(i)})):e?Promise.all([(t=e+".png",fetch(t,{credentials:"same-origin"}).then((function(e){if(e.ok)return e.blob().then((function(e){i.sprites.url=t;var n=new Image;return n.src=t,n.decode().then((function(){i.sprites.size={},i.sprites.size.h=n.height,i.sprites.size.w=n.width}))})).catch((function(e){Q.warn("fetch image sprites exception :",e)}));throw new Error("HTTP status code: "+e.status)})).catch((function(e){return new Promise((function(t,i){Q.error("fetch image sprites exception :",e),i(e)}))}))),fetch(e+".json",{credentials:"same-origin"}).then((function(e){if(e.ok)return e.json().then((function(e){i.sprites.json=e})).catch((function(e){Q.warn("fetch json sprites exception :",e)}));throw new Error("HTTP status code: "+e.status)})).catch((function(e){return new Promise((function(t,i){Q.error("fetch json sprites exception :",e),i(e)}))}))]):new Promise((function(e,t){Q.error("Auncun sprites disponibles !"),e(i)}))}},{key:"createElement",value:function(){var e=this;return"object"===K(this.options.style)?(this.mapbox=this.options.style,this.options.tools.legend?this._getSprites(this.mapbox.sprite).then((function(){return e._initContainer(),e})).catch((function(e){Q.warn("fetch sprites exception :",e)})):new Promise((function(t,i){e._initContainer(),t(e)}))):"string"==typeof this.options.style?fetch(this.options.style,{credentials:"same-origin"}).then((function(t){return t.json().then((function(t){e.mapbox=t})).then((function(){return e.options.tools.legend?e._getSprites(e.mapbox.sprite).then((function(){return e._initContainer(),e})).catch((function(e){Q.warn("fetch sprites exception :",e)})):new Promise((function(t,i){e._initContainer(),t(e)}))})).catch((function(e){Q.error("json exception :",e)}))})).catch((function(e){Q.error("fetch exception :",e)})):void 0}},{key:"display",value:function(e){this.container.style.display=e?"block":"none"}},{key:"setContext",value:function(e,t){this.context[e]=t}},{key:"getContext",value:function(e){return this.context[e]}},{key:"getID",value:function(){return this.id}},{key:"getContainer",value:function(){return this.container}},{key:"getStyle",value:function(){return this.mapbox}},{key:"getStyleLayer",value:function(e){for(var t=null,i=this.getLayer(e).options.obj.id,n=0;n<this.mapbox.layers.length;n++){var o=this.mapbox.layers[n];if(o.id===i){t=o;break}}return t}},{key:"getLayerFromStyle",value:function(e){for(var t=null,i=this.mapbox.layers[e],n=0;n<this.getLayers().length;n++){var o=this.getLayer(n);if(i.id===o.options.obj.id){t=o;break}}return t}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(e){return this.layers[e]}}])&&X(e.prototype,i),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}();o.A.assign(ee.prototype,q);const te=ee;window.ol&&window.ol.style&&(window.ol.style.Editor=ee)})(),GpfExtOlEditor=n.default})();
//# sourceMappingURL=GpfExtOlEditor.js.map