{"version":3,"file":"GpfExtOlLayerImport.js","mappings":";;;;;;;;;;;;;oCAAAA,EAAOC,QAAUC,GAAGC,MAAMC,I,yFCka1B,QA/YU,CAoBNC,KAAO,SAAUC,GAEb,IAAIC,EAAS,IAAOC,UAAU,OAQ9B,GAPAD,EAAOE,MAAM,iBAIb,gBAGKH,EAASI,IACV,MAAM,IAAIC,MAAM,4CAGpB,IAAKL,EAASM,OACV,MAAM,IAAID,MAAM,+CAGfL,EAASO,SACVP,EAASO,OAAS,QAGtB,IAAIC,EAAU,CAAC,EAaf,OAZAA,EAAQJ,IAAMJ,EAASI,IACvBI,EAAQC,KAAOT,EAASS,KAAOT,EAASS,KAAO,KAC/CD,EAAQF,OAASN,EAASM,OAC1BE,EAAQE,QAAUV,EAASU,SAAW,EACtCF,EAAQG,MAAQX,EAASW,OAASC,KAClCJ,EAAQK,MAAQb,EAASa,OAAS,KAClCL,EAAQM,QAAUd,EAASc,SAAW,KACtCN,EAAQO,QAAUf,EAASe,SAAW,CAClCC,QAAU,oBAINhB,EAASM,QACb,IAAK,SACL,IAAK,MACD,MACJ,IAAK,MACL,IAAK,OAEDE,EAAQM,QAAUd,EAASc,QAAUd,EAASc,QAAU,oCACxDN,EAAQO,QAAUf,EAASe,QAAUf,EAASe,QAAU,CAAEC,QAAU,oBACpE,MACJ,IAAK,OACL,IAAK,UACD,MAAM,IAAIX,MAAM,mCACpB,QACI,MAAM,IAAIA,MAAM,yBAIxB,OAAQL,EAASO,QACb,IAAK,OACDK,KAAKK,OAAOT,GACPU,MAAK,SAAUC,GACZlB,EAAOE,MAAMgB,GACbnB,EAASoB,WAAWrB,KAAKa,KAAMO,EACnC,IACCE,OAAM,SAAUC,GACbtB,EAASuB,UAAUxB,KAAKa,KAAMU,EAClC,IACJ,MACJ,IAAK,OACDV,KAAKY,WAAWhB,GACXU,MAAK,SAAUC,GACZlB,EAAOE,MAAMgB,GACbnB,EAASoB,WAAWrB,KAAKa,KAAMO,EACnC,IACCE,OAAM,SAAUC,GACbtB,EAASuB,UAAUxB,KAAKa,KAAMU,EAClC,IACJ,MACJ,IAAK,MACDV,KAAKa,UAAUjB,GACVU,MAAK,SAAUC,GACZlB,EAAOE,MAAMgB,GACbnB,EAASoB,WAAWrB,KAAKa,KAAMO,EACnC,IACCE,OAAM,SAAUC,GACbtB,EAASuB,UAAUxB,KAAKa,KAAMU,EAClC,IACJ,MACJ,QACI,MAAM,IAAIjB,MAAM,6CAE5B,EAUAY,OAAS,SAAUT,GACf,IAAIP,EAAS,IAAOC,UAAU,OA6N9B,OA5NAD,EAAOE,MAAM,mBAEC,IAAIuB,SACd,SAAUC,EAASC,GAEf,IAAIC,EAA4B,SAAnBrB,EAAQF,QAAwC,QAAnBE,EAAQF,OAAoB,EAAI,EAGtEE,EAAQC,OAAkC,iBAAjBD,EAAQC,MAAqBqB,OAAOC,KAAKvB,EAAQC,MAAMuB,QAAoC,iBAAjBxB,EAAQC,MAAqBD,EAAQC,KAAKuB,UAAaH,IAC1JrB,EAAQJ,IAAM,IAAO6B,aAAazB,EAAQJ,IAAKI,EAAQC,OAG3DR,EAAOE,MAAM,SAAUK,EAAQJ,KAE/B,IAAI8B,EAAO,KAGX,GAAsB,oBAAXC,OAAwB,CAC/B,IAAIC,EAAY,EAAQ,MAEpBC,EAAO,CACPtB,QAAU,CACNuB,QAAU,sBAelB,OAXI9B,EAAQC,MAAgC,iBAAjBD,EAAQC,MAAqBoB,IACpDQ,EAAO,CACH/B,OAASE,EAAQF,OACjBiC,KAAO/B,EAAQC,KACfM,QAAU,CACN,eAAiBP,EAAQM,QACzBwB,QAAU,uBAKfF,EAAU5B,EAAQJ,IAAKiC,GACzBnB,MAAK,SAAUC,GACZ,GAAIA,EAASqB,GACTb,EAAQR,EAASsB,YACd,CACH,IAAIC,EAAU,6CAA+CvB,EAASwB,WAAa,cAAgBxB,EAASf,IAAM,KAC9GwC,EAASzB,EAASyB,OACtBhB,EAAO,CACHc,QAAUA,EACVE,OAASA,GAEjB,CACJ,IACCvB,OAAM,SAAUwB,GACbjB,EAAO,CACHc,QAAUG,EACVD,QAAU,GAElB,GACR,CACI,GAAIT,OAAOW,eAAgB,CACvB7C,EAAOE,MAAM,mBAEb+B,EAAO,IAAIY,gBACNC,KAAKvC,EAAQF,OAAQE,EAAQJ,KAAK,GACvC8B,EAAKc,iBAAmBxC,EAAQM,QAGhC,IAAImC,EAAmB,KACnBzC,EAAQE,QAAU,IAGlBT,EAAOE,MAAM,yBAOb8C,EAAmBd,OAAOe,YACtB,WAEItB,EAAO,CACHc,QAFU,wDAGVE,QAAU,GAElB,GAAGpC,EAAQE,UAGfmB,IAGA5B,EAAOE,MAAM,UAAWK,EAAQC,MAChCyB,EAAKiB,iBAAiB,eAAgB3C,EAAQM,UAclDoB,EAAKkB,QAAU,SAAUP,GACrBQ,QAAQC,IAAIT,GACZjB,EAAO,IAAIvB,MAAM,wDACrB,EAUA6B,EAAKqB,UAAY,SAAUV,GACvBQ,QAAQC,IAAIT,GACZjB,EAAO,IAAIvB,MAAM,yDACrB,EAQA6B,EAAKsB,mBAAqB,SAAUX,GAChC,GAAwB,IAApBX,EAAKuB,WACL,GAAoB,MAAhBvB,EAAKU,OACLT,OAAOuB,aAAaT,GACpBtB,EAAQO,EAAKf,cACV,CACH,IAAIuB,EAAU,6CAA+CG,EAAEc,OAAOhB,WAAa,cAAgBE,EAAEc,OAAOC,YAAc,mBAAqBf,EAAEc,OAAOxC,SAAW,KAC/JyB,EAASC,EAAEc,OAAOf,OACtBhB,EAAO,CACHc,QAAUA,EACVE,OAASA,GAEjB,CAER,EAGA,IAAIiB,EAAYrD,EAAQC,MAAQoB,EAASrB,EAAQC,KAAO,KAExDyB,EAAK4B,KAAKD,EACd,KAAO,KAAI1B,OAAO4B,eAkEd,MAAM,IAAI1D,MAAM,sBAhEhBJ,EAAOE,MAAM,mBAEb+B,EAAO,IAAI6B,gBACNhB,KAAKvC,EAAQF,OAAQE,EAAQJ,KAElC8B,EAAKc,iBAAmBxC,EAAQM,QAE5BN,EAAQE,QAAU,IAClBwB,EAAK8B,QAAUxD,EAAQwD,QACvB/D,EAAOE,MAAM,0BAGb0B,GAGAK,EAAKiB,iBAAiB,eAAgB3C,EAAQM,SAYlDoB,EAAKkB,QAAU,WACXxB,EAAO,IAAIvB,MAAM,wDACrB,EAQA6B,EAAKqB,UAAY,WACb3B,EAAO,IAAIvB,MAAM,yDACrB,EAQA6B,EAAK+B,OAAS,SAAUpB,GACpB,GAAoB,MAAhBX,EAAKU,OACLjB,EAAQO,EAAKgC,kBACV,CACH,IAAIxB,EAAU,6CAA+CG,EAAEc,OAAOhB,WAAa,cAAgBE,EAAEc,OAAOC,YAAc,KACtHhB,EAASC,EAAEc,OAAOf,OACtBhB,EAAO,CACHc,QAAUA,EACVE,OAASA,GAEjB,CACJ,EAEA,IAAIuB,EAAY3D,EAAQC,MAAQoB,EAASrB,EAAQC,KAAO,KAExDyB,EAAK4B,KAAKK,EAGd,CAER,GAIR,EAUA3C,WAAa,SAAUhB,GACnB,OAAOI,KAAKK,OAAOT,GACdU,KAAKkD,KAAKC,OACVhD,OAAM,SAAUC,GACb+B,QAAQC,IAAI,yBAA0B9C,EAAQJ,IAAKkB,EAGvD,GACR,EAUAG,UAAY,SAAUjB,GAClB,OAAOI,KAAKK,OAAOT,GACdU,MAAK,SAAUC,GACZ,IAAImD,EAGkB,oBAAXnC,OAEPmC,GAAS,IAAIC,EADG,aACSC,gBAAgBrD,EAAU,YAE/CgB,OAAOoC,UAEPD,GADa,IAAInC,OAAOoC,WACRC,gBAAgBrD,EAAU,cAE1CmD,EAAS,IAAInC,OAAOsC,cAAc,qBAC3BC,OAAQ,EACfJ,EAAOK,QAAQxD,IAIvB,OAAOmD,CACX,IACCjD,OAAM,SAAUC,GACb+B,QAAQC,IAAI,yBAA0B9C,EAAQJ,IAAKkB,EAGvD,GACR,E,4DC/YJ,SAASsD,EAAsBpE,GAC3B,KAAMI,gBAAgBgE,GAClB,MAAM,IAAIC,UAAU,oEAGxBjE,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,0CAKlBS,KAAKJ,QAAUA,GAAW,CAAC,EAK3BI,KAAKkE,GAAKlE,KAAKJ,QAAQsE,GAGvBlE,KAAKmE,SAAWnE,KAAKJ,QAAQuE,SAG7BnE,KAAKoE,MAAQpE,KAAKJ,QAAQyE,SAG1BrE,KAAKsE,IAAMtE,KAAKJ,QAAQ2E,IAMxBvE,KAAKwE,QAAUxE,KAAKJ,QAAQ6E,MAG5BzE,KAAK0E,YAAc1E,KAAKJ,QAAQ8E,YAEhC1E,KAAK2E,QAAU3E,KAAKJ,QAAQ+E,QAE5B3E,KAAK4E,SAAW5E,KAAKJ,QAAQgF,SAE7B5E,KAAK6E,aAAe7E,KAAKJ,QAAQiF,aAML,aAAxB7E,KAAKJ,QAAQF,QACbM,KAAK8E,SAAW,WAChB9E,KAAK+E,UAAY/E,KAAKJ,QAAQoF,SACJ,MAAtBhF,KAAK6E,cAAwB7E,KAAK+E,WAAa,MAC/C/E,KAAK6E,aAAe,KACpB7E,KAAK+E,WAAa,OAGtB/E,KAAK8E,SAAW,OAChB9E,KAAK+E,UAAY/E,KAAKJ,QAAQqF,KAEtC,CAKAjB,EAAqBkB,UAAY,uBAEjClB,EAAqBmB,UAAY,CAS7BC,YAAcpB,EAMdqB,YAAc,WACV,OAAOrF,KAAKoE,MAAMkB,EAAI,IAAMtF,KAAKoE,MAAMmB,CAC3C,EAMAC,gBAAkB,WACd,MAA0B,MAAtBxF,KAAK6E,aACE,QAEe,OAAtB7E,KAAK6E,aACE,YAEJ,EACX,EAMAY,eAAiB,WACb,IAAIC,EAAkB,GAEtB,GAAgC,IAA5B1F,KAAK0E,YAAYtD,OACjB,IAAK,IAAIuE,EAAI,EAAGA,EAAI3F,KAAK0E,YAAYtD,OAAQuE,IACzCD,EAAgBE,KAAKpC,KAAKqC,UAAU7F,KAAK0E,YAAYiB,KAG7D,OAAOD,EAAgBI,KAAK,IAChC,EAMAC,aAAe,WACX,OAAI/F,KAAK2E,QACE,UAEA,WAEf,GAQJX,EAAqBmB,UAAUa,UAAY,WACvC,IAAIC,EAAM,GAwDV,OAtDAA,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAKmE,WAGb8B,EAAIL,KAAK,CACLD,EAAI,QACJO,EAAIlG,KAAKqF,gBAGbY,EAAIL,KAAK,CACLD,EAAI,YACJO,EAAIlG,KAAK+F,iBAGbE,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAK8E,WAGbmB,EAAIL,KAAK,CACLD,EAAI,YACJO,EAAIlG,KAAK+E,YAGbkB,EAAIL,KAAK,CACLD,EAAI,UACJO,EAAIlG,KAAKwE,UAGbyB,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAK4E,WAGbqB,EAAIL,KAAK,CACLD,EAAI,eACJO,EAAIlG,KAAKwF,oBAGTxF,KAAKsE,KACL2B,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsE,MAIbtE,KAAK0E,aACLuB,EAAIL,KAAK,CACLD,EAAI,cACJO,EAAIlG,KAAKyF,mBAIVQ,CACX,EAEA,S,siECnKA,QAvCmB,SAAAE,GAEf,SAAAC,EAAaxG,GAAS,IAAAyG,EAkBjB,OAlBiBC,EAAA,KAAAF,GAElBC,EAAAE,EAAA,KAAAH,EAAA,CAAM,CACFI,SAFJ5G,EAAUA,GAAW,CAAC,GAEA4G,QAClBzD,OAASnD,EAAQmD,OACjB0D,OAAS7G,EAAQ6G,UAGjB7G,GAAWA,EAAQ8G,SACnBL,EAAKK,UAAW,EAEhBL,EAAKK,UAAW,EAGhB9G,GAAWA,EAAQ+G,YACnBN,EAAKM,YAAc/G,EAAQ+G,YAE3BN,EAAKM,YAAc,GACtBN,CACL,CAAC,O,qRAAAO,CAAAR,EAAAD,GAAAU,EAAAT,EAAA,EAAAU,IAAA,cAAAC,MAED,SAAaC,GACLhH,KAAKiH,UACU,IAAIC,EAAgBlH,MAC1BmH,IAAIH,EAErB,GAAC,CAAAF,IAAA,iBAAAC,MAED,SAAgBC,GACRhH,KAAKiH,UACU,IAAIC,EAAgBlH,MAC1BoH,OAAOJ,EAExB,IAAC,CAnCc,CAAiCK,KA4CpD,IAAMC,EAAU,CACZ,WACA,YACA,cACA,gBAGJC,EAAA,IAAAC,QAIMN,EAAe,WAgBhB,OAAAL,GAVD,SAAAK,EAAaO,GAST,OATiBnB,EAAA,KAAAY,GAYrBQ,EAAA,KAAAH,GAXIvH,KAAKyH,OAASA,EACdzH,KAAK2H,UAAY,KAEjBC,EAAAL,EAAAvH,KAAK6H,GAAgB1I,KAArBa,KAAsB,YACtB4H,EAAAL,EAAAvH,KAAK6H,GAAgB1I,KAArBa,KAAsB,aACtB4H,EAAAL,EAAAvH,KAAK6H,GAAgB1I,KAArBa,KAAsB,eACtB4H,EAAAL,EAAAvH,KAAK6H,GAAgB1I,KAArBa,KAAsB,gBAEfA,IACX,GAAC,EAAA8G,IAAA,MAAAC,MAqJD,SAAKC,GACIM,EAAQQ,SAASd,EAAIe,iBAI1BH,EAAAL,EAAAvH,KAAKgI,GAAU7I,KAAfa,KAAgBgH,GAAK,GAEjBA,EAAIc,SAAS,UACb9H,KAAK2H,UAAUM,SAAS,sBAAwBjB,GAAKkB,QAAQlI,KAAKyH,OAAOjB,SAEzExG,KAAK2H,UAAUM,SAAS,sBAAwBjB,GAAKmB,YAAYnI,KAAKyH,OAAOjB,SAErF,GAEA,CAAAM,IAAA,SAAAC,MAKA,SAAQC,GACCM,EAAQQ,SAASd,EAAIe,gBAK1BH,EAAAL,EAAAvH,KAAKgI,GAAU7I,KAAfa,KAAgBgH,GAAK,EACzB,IAAC,CA/LgB,GA+LhB,SAAAoB,EAxKgBC,GAEb,QADUrI,KAAK2H,UAAUM,SAAS,sBAAwBI,EAK9D,CAEA,SAAAR,EAKkBQ,GAGd,GAFArI,KAAK2H,UAAY3H,KAAKyH,OAAOR,SAASqB,gCAElCV,EAAAL,EAAAvH,KAAKoI,GAAejJ,KAApBa,KAAqBqI,GAAzB,CAMA,IAAIE,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAK,sBAAwBmE,EACjCE,EAAIG,UAAY,+BAAiCL,EAEjDrI,KAAK2H,UAAUQ,YAAYI,EAR3B,CASJ,CAEA,SAAAP,EAMYhB,EAAKI,GACb,IAAIuB,EAAO3I,KACLqE,EAAW,SAAC2C,GAEd,OADc2B,EAAKhB,UAAUM,SAAS,sBAAwBjB,GAC/CiB,SAAS7G,MAC5B,EACMwH,EAAQ,SAAC5B,GAGX,OAFc2B,EAAKhB,UAAUM,SAAS,sBAAwBjB,GAC1C6B,WAExB,EACMC,EAAQ,SAAC9B,GACX,IAAIR,EAAUmC,EAAKhB,UAAUM,SAAS,sBAAwBjB,GAC1D+B,EAASvC,EAAQwC,aACrB,GAAI5B,EAAQ,CACJJ,EAAIc,SAAS,SACbiB,EAAS,GAGb,IAAK,IAAIE,EAAQ,EAAGA,EAAQzC,EAAQyB,SAAS7G,OAAQ6H,IAAS,CAE1D,GADWzC,EAAQyB,SAASgB,GAAO/E,KACxByE,EAAKlB,OAAOjB,QAAQtC,GAAI,CAC/B6E,EAAU/B,EAAIc,SAAS,UAAaiB,EAASJ,EAAKlB,OAAOjB,QAAQwC,cAA0B,EAAXD,EAChF,KACJ,CACAA,GAAUvC,EAAQyB,SAASgB,GAAOD,YACtC,CACJ,CACA,OAAOD,CACX,EACMG,EAAQ,SAAC1C,GACXA,EAAQvH,MAAMkK,IAAM,QACpB3C,EAAQvH,MAAMmK,OAAS,QACvB5C,EAAQvH,MAAMoK,KAAO,QACrB7C,EAAQvH,MAAMqK,MAAQ,OAC1B,EAIAJ,EAAMlJ,KAAKyH,OAAOjB,SAClBxG,KAAKyH,OAAOjB,QAAQvH,MAAMoF,SAAW,QAKrC,IAAIkF,EAASC,MAAMC,KAAKzJ,KAAKyH,OAAOjB,QAAQkD,uBAAuB,YACnE,GAAsB,IAAlBH,EAAOnI,OAAX,CAGA,IAAIuI,EAAS,EACbJ,EAAOK,SAAQ,SAACC,GAKZ,GAAqC,WAAjCA,EAAMC,SAAS/B,cAAnB,CAOA,OAJAmB,EAAMW,GAIE7C,EAAIe,eACR,IAAK,YACGgC,EAAAA,EAAAA,KACAF,EAAM5K,MAAMkK,IAAM,MAElBU,EAAM5K,MAAMkK,IAAM9E,EAAS2C,GAAO8B,EAAM9B,GAAO,KAAO,MAE1D6C,EAAM5K,MAAMoK,KAAOT,EAAM5B,GAAO2C,EAAS,KACzC,MACJ,IAAK,eACGI,EAAAA,EAAAA,KACAF,EAAM5K,MAAMkK,IAAM,MAElBU,EAAM5K,MAAMmK,OAAS/E,EAAS2C,GAAO8B,EAAM9B,GAAO,KAAO,MAE7D6C,EAAM5K,MAAMoK,KAAOT,EAAM5B,GAAO2C,EAAS,KACzC,MACJ,IAAK,aACGI,EAAAA,EAAAA,KACAF,EAAM5K,MAAMkK,IAAM,MAElBU,EAAM5K,MAAMkK,IAAM9E,EAAS2C,GAAO8B,EAAM9B,GAAO,KAAO,MAE1D6C,EAAM5K,MAAMqK,MAAQV,EAAM5B,GAAO2C,EAAS,KAC1C,MACJ,IAAK,gBACGI,EAAAA,EAAAA,KACAF,EAAM5K,MAAMkK,IAAM,MAElBU,EAAM5K,MAAMmK,OAAS/E,EAAS2C,GAAO8B,EAAM9B,GAAO,KAAO,MAE7D6C,EAAM5K,MAAMqK,MAAQV,EAAM5B,GAAO2C,EAAS,KAKlDA,GAAUE,EAAMhB,WAzChB,CA0CJ,GAnDA,CAoDJ,C,8GChIJ,SAASmB,EAAepK,GACpB,KAAMI,gBAAgBgK,GAClB,MAAM,IAAI/F,UAAU,IAAEgG,WAAW,sBAgDrC,IAAK,IAAIC,KA7CTlK,KAAKX,OAAS,IAAOC,UAAU,iBAC/BU,KAAKX,OAAOE,MAAM,0CAUlBS,KAAKJ,QAAU,CAEXuK,SAAW,MACXC,KAAM,EACNC,SAAW,GAEXC,eAAiB,KACjBC,WAAa,MACbzK,QAAU,EACV0K,aAAc,EACdzK,MAAQC,KAMRyK,UAAY,SAAUlK,GAClBkC,QAAQC,IAAI,4CAA6CnC,EAC7D,EAMAI,UAAY,SAAUD,GACG,MAAjBA,EAAMsB,QAAmBtB,EAAMsB,OAG/BS,QAAQC,IAAI,uBAAwBhC,EAAMsB,OAAQ,OAAQtB,EAAMoB,SAFhEW,QAAQC,IAAI,eAAgBhC,EAAMoB,QAI1C,GAIYlC,EACRA,EAAQ8K,eAAeR,KACvBlK,KAAKJ,QAAQsK,GAAOtK,EAAQsK,IAsBpC,GAbIlK,KAAKJ,QAAQ4K,cAAgBxK,KAAKJ,QAAQ6K,YAM1CzK,KAAKJ,QAAQ6K,UAAY,SAAUlK,GAC/BkC,QAAQC,IAAI,6DAA8DnC,EAC9E,MAI2C,OAA3BP,KAAKJ,QAAQ6K,WAAwD,mBAA3BzK,KAAKJ,QAAQ6K,WAEvE,MAAM,IAAIhL,MAAM,IAAEwK,WAAW,gBAAiB,gBAMlD,OAFAjK,KAAKJ,QAAQ2K,WAA4C,iBAAvB3K,EAAQ2K,WAA2B3K,EAAQ2K,WAAWI,cAAgB,MAEhG3K,KAAKJ,QAAQ2K,YACjB,IAAK,OACL,IAAK,MACD,MACJ,IAAK,MACL,IAAK,SACL,IAAK,OACL,IAAK,UACD,MAAM,IAAI9K,MAAM,IAAEwK,WAAW,oBAAqB,eACtD,QACI,MAAM,IAAIxK,MAAM,IAAEwK,WAAW,gBAAiB,eAOtD,OAFAjK,KAAKJ,QAAQuK,SAAwC,iBAArBvK,EAAQuK,SAAyBvK,EAAQuK,SAASQ,cAAgB,MAE1F3K,KAAKJ,QAAQuK,UACjB,IAAK,QACL,IAAK,MACD,MACJ,QACI,MAAM,IAAI1K,MAAM,IAAEwK,WAAW,gBAAiB,aAKtD,GAAsB,oBAAX1I,QAAoD,UAA1BvB,KAAKJ,QAAQuK,SAC9C,MAAM,IAAI1K,MAAM,IAAEwK,WAAW,2BAA4B,qCAI/B,UAA1BjK,KAAKJ,QAAQuK,WACbnK,KAAKJ,QAAQ2K,WAAa,OAI9BvK,KAAKJ,QAAQgL,QAAUhL,EAAQgL,UAAW,EAS1C5K,KAAKJ,QAAQiL,aAAe,KAI5B7K,KAAK8K,QAAU,KAIf9K,KAAKO,SAAW,IACpB,CAKAyJ,EAAc7E,UAAY,CAKtBC,YAAc4E,EAKd7K,KAAO,WAEHa,KAAKX,OAAOE,MAAM,0BAElB,IAAIwL,EAAU/K,KAUd,SAASgL,EAAgBC,GACrBjL,KAAKX,OAAOE,MAAM,mCAAoC0L,GACtDjL,KAAKkL,YAAY/L,KAAK4L,EAASI,EAASC,EAC5C,CAGA,SAASA,EAAeH,GACpBjL,KAAKX,OAAOE,MAAM,kCAAmC0L,GACrDjL,KAAKqL,gBAAgBlM,KAAK4L,EAASI,EAASG,EAChD,CAGA,SAASA,EAAmBL,GAExB,GADAjL,KAAKX,OAAOE,MAAM,sCAAuC0L,IACrDA,EAGA,OAAOE,EAAQhM,KAAKa,KAAM,IAAI,IAAa,sCAF3CA,KAAKJ,QAAQ6K,UAAUtL,KAAKa,KAAMiL,EAI1C,CAGA,SAASE,EAASzK,GACdV,KAAKX,OAAOE,MAAM,4BAElB,IAAI0C,EAAIvB,EACFuB,aAAa,MACfA,EAAI,IAAI,IAAavB,EAAMoB,UAE/B9B,KAAKJ,QAAQe,UAAUxB,KAAKa,KAAMiC,EACtC,EAtCA,WACIjC,KAAKX,OAAOE,MAAM,yBAClBS,KAAKuL,aAAapM,KAAK4L,EAASI,EAASH,EAC7C,GAEI7L,KAAK4L,EAkCb,EAOAQ,aAAe,SAAU7K,EAAO8K,GAE5BxL,KAAKX,OAAOqB,MAAM,wBAEdA,GACAA,EAAMvB,KAAKa,KAAM,qCAErBwL,EAAQrM,KAAKa,KAAM,oCACvB,EAOAkL,YAAc,SAAUxK,EAAO8K,GAgB3B,IAAIC,EAAkB,KAClBC,EAAU1L,KAAK8K,QAIfa,KAAmB3L,KAAKJ,QAAQyK,UAAsC,QAA1BrK,KAAKJ,QAAQuK,UAIzDyB,EAAqB,CACrB,gBAAkB,MAGlB5L,KAAKJ,QAAQiM,SACbD,EAAmBC,OAAS7L,KAAKJ,QAAQiM,QAG7C7L,KAAKJ,QAAQkM,UAAY,IAAOzK,aAAarB,KAAKJ,QAAQkM,UAAWF,GAAoB,GAGrFD,IACgC,QAA5B3L,KAAKJ,QAAQ2K,aACbkB,EAAkBzL,KAAKJ,QAAQyK,SAAW,IAAOhJ,aAAarB,KAAKJ,QAAQkM,UAAW9L,KAAK8K,SAAS,GACpGY,EAAU,MAGkB,SAA5B1L,KAAKJ,QAAQ2K,aACbkB,EAAkBzL,KAAKJ,QAAQyK,SAAW,IAAOhJ,aAAarB,KAAKJ,QAAQkM,UAAW,MAAM,GAC5FJ,EAAU1L,KAAK8K,UAKvB,IAAInC,EAAO3I,KAEPJ,EAAU,CACVJ,IAAMiM,GAAmBzL,KAAKJ,QAAQkM,UACtCpM,OAASM,KAAKJ,QAAQ2K,WACtBJ,SAAWnK,KAAKJ,QAAQuK,SACxBrK,QAAUE,KAAKJ,QAAQE,SAAW,EAClCH,OAASK,KAAKJ,QAAQiL,aACtBD,QAAU5K,KAAKJ,QAAQgL,UAAW,EAClCmB,KAAiC,QAA1B/L,KAAKJ,QAAQuK,SACpBG,eAAiBtK,KAAKJ,QAAQ0K,eAE9BzK,KAAO6L,EACPvL,QAAU,KACVD,QAAUF,KAAKJ,QAAQoM,aAAe,kBACtCjM,MAAQC,KAAKJ,QAAQG,OAASC,KAE9BQ,WAAa,SAAUD,GACnBoI,EAAKtJ,OAAOE,MAAM,6BAGlB,IAAIW,EAAU,KAWd,GAP8B,QAA1ByI,EAAK/I,QAAQuK,WACbxB,EAAKtJ,OAAOE,MAAM,eAAgBgB,GAClCL,EAAUK,GAKgB,UAA1BoI,EAAK/I,QAAQuK,SAAsB,CAEnC,GADAxB,EAAKtJ,OAAOE,MAAM,gBAAiBgB,IAC/BA,EAyBA,YADAG,EAAMvB,KAAKwJ,EAAM,IAAI,IAAa,yCAvBlC,GAAIpI,EAAS0L,KAAM,CAIf,GAA6B,MAAzB1L,EAAS0L,KAAKjK,OAMd,YALAtB,EAAMvB,KAAKwJ,EAAM,IAAI,IAAa,CAC9B3G,OAASzB,EAAS0L,KAAKjK,OACvBF,QAAUvB,EAAS0L,KAAKvL,MACxBwL,KAAO,IAAaC,eAIxBjM,EAAUK,EAAS6L,IACfzD,EAAK/I,QAAQ4K,cACbtK,EAAUK,EAGtB,MAGIL,EAAUK,CAMtB,CAGA,GAA0C,mBAA/BoI,EAAK/I,QAAQyM,cAA8B,CAClD,IAAIC,EAAc3D,EAAK/I,QAAQyM,cAAcnM,GAClB,iBAAhBoM,IAGPpM,EAAUoM,EAElB,CAEA3D,EAAKpI,SAAWL,EAEhBsL,EAAQrM,KAAKwJ,EAAMzI,EACvB,EAEAS,UAAY,SAAUsB,GAClB0G,EAAKtJ,OAAOE,MAAM,4BAElB0C,EAAEiK,KAAO,IAAaC,YACtBzL,EAAMvB,KAAKwJ,EAAM,IAAI,IAAa1G,GACtC,EAEAsK,UAAY,WACR5D,EAAKtJ,OAAOE,MAAM,4BAClBmB,EAAMvB,KAAKwJ,EAAM,IAAI,IAAa,YACtC,GAGJ,IAASzF,KAAKtD,EAClB,EAOAyL,gBAAkB,SAAU3K,EAAO8K,GAE/BxL,KAAKX,OAAOqB,MAAM,wBAEdA,GACAA,EAAMvB,KAAKa,KAAM,qCAErBwL,EAAQrM,KAAKa,KAAM,oCACvB,GAIJ,S,uBCldAlB,EAAOC,QAAUC,GAAGwN,MAAMC,M,+CC6E1B,QAlEwB,CAGpBC,cAAgB,+BAChBC,YAAc,6BACdC,WAAa,yCACbC,aAAe,+CACfC,kBAAoB,kDACpBC,yBAA2B,4DAC3BC,cAAgB,4CAIhBC,sBAAwB,+DACxBC,sBAAwB,2CAGxBC,2BAA6B,8CAC7BC,6BAA+B,oCAC/BC,yBAA2B,sEAC3BC,2BAA6B,uDAC7BC,uBAAyB,uCACzBC,yBAA2B,kEAC3BC,wBAA0B,oFAC1BC,0BAA4B,sDAC5BC,0BAA4B,oCAG5BC,kBAAoB,sDAUpB3D,WAAa,SAAU4D,EAAMC,GAGzB,GAAsC,IAAlC5M,OAAOC,KAAK4M,WAAW3M,OACvB,MAAO,sBAGX,IAAI4M,EAASxE,MAAMrE,UAAU8I,MAAM9O,KAAK4O,WACpCjH,EAAMkH,EAAOE,QACbC,EAAOH,EAEPlM,EAAU9B,KAAK8G,GAEnB,IAEQhF,EADA0H,MAAM4E,QAAQD,IAASA,EAAK/M,OAAS,EAC3BU,EAAQuM,QAAQ,QAASF,EAAKrI,KAAK,QAEnChE,EAAQuM,QAAQ,QAAS,wBAE3C,CAAE,MAAOpM,GAGT,CAEA,OAAOH,CACX,E,8BCjEJ,SAASwM,IACL,KAAMtO,gBAAgBsO,GAClB,MAAM,IAAIrK,UAAU,+DAGxBjE,KAAKuO,UAAY,EACrB,C,iBAEAD,EAAgBnJ,UAAY,CAExBC,YAAckJ,GAIlB,S,wBCvBAxP,EAAOC,QAAUC,GAAGwP,U,8BCgBpB,SAASC,IACL,KAAMzO,gBAAgByO,GAClB,MAAM,IAAIxK,UAAU,uEAGxBjE,KAAK8B,QAAU,KAEf9B,KAAKkE,GAAK,KAEVlE,KAAK0O,SAAW,CAAC,EACjB1O,KAAK0O,SAASpJ,EAAI,KAClBtF,KAAK0O,SAASnJ,EAAI,KAElBvF,KAAKuE,IAAM,KAEXvE,KAAK2O,SAAW,KAEhB3O,KAAKiF,KAAO,KAEZjF,KAAKgF,SAAW,IACpB,C,iBAEAyJ,EAAwBtJ,UAAY,CAEhCC,YAAcqJ,GAIlB,S,2GCsCA,QApDkB,CAEdG,SAAW,kBACXpC,MAAQ,CAEJqC,kBAAoB,iCAGpBC,aAAe,4BAGfC,cAAgB,8BAEpBC,OAAS,CAELC,eAAiB,+BAEjBC,cAAgB,+BAEpBC,MAAQ,CAGJC,WAAa,2BAEjBnQ,MAAQ,CAGJoQ,WAAa,0BAEbC,MAAQ,CACJC,YAAc,iCACdC,YAAc,mCAGtBC,OAAS,CAGLJ,WAAa,4BAEjBK,OAAS,CAELC,aAAe,6BAEfC,aAAe,8BAEnBC,OAAS,CAELC,SAAW,yBACXC,eAAiB,iC,ssBCzEzB,IAAI1Q,EAAS2Q,EAAAA,EAAO1Q,UAAU,gBA4BxB2Q,EAAK,WAwBP,O,EAtBA,SAAAA,EAAarQ,GAaT,G,4FAbkB0G,CAAA,KAAA2J,GAClB5Q,EAAOE,MAAM,sBAAuBK,GAGpCI,KAAKJ,QAAUA,GAAW,CAEtBmD,OAAS,KACTsB,SAAW,EACX6L,MAAQ,KACRC,MAAQ,KACRC,IAAM,QAGJpQ,gBAAgBiQ,GAClB,MAAM,IAAIhM,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAEA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIb/C,KAAKJ,QAAQyE,WACdrE,KAAKJ,QAAQyE,SAAW,GAG5B,IAAIkM,EAAgB,CAChBjB,OAAQ,EACRkB,SAAU,GAGTxQ,KAAKJ,QAAQsQ,QACdlQ,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,GAEhDvQ,KAAKJ,QAAQwQ,MAEdpQ,KAAKJ,QAAQwQ,IAAM,CACfO,MAAQ,CAAC,EACTC,OAAS,CAAC,IAIb5Q,KAAKJ,QAAQuQ,QACdnQ,KAAKJ,QAAQuQ,MAAQ,iBAGzBnQ,KAAK2H,UAAY,KAGjB3H,KAAKqI,KAAO,CACRtF,OAAS,4BACT4E,UAAY,+BACZkJ,cAAgB,mCAChBC,UAAY,+BACZC,YAAc,iCACdC,oBAAsB,yCACtBC,WAAa,gCACbC,uBAAyB,4CACzBC,cAAgB,mCAChBC,cAAgB,mCAChBC,uBAAyB,4CACzBC,cAAgB,mCAChBC,cAAgB,mCAChBC,mBAAqB,2CAE7B,GAEA,CAAA1K,IAAA,iBAAAC,MAgBA,WAEI,IAAI4B,EAAO3I,KAEPyR,GAAS,EACTC,EAAOlO,KAAKC,MAAMD,KAAKqC,UAAU7F,KAAKJ,QAAQwQ,MAC9CuB,EAAS,CAAC,EAGVD,EAAKf,QACLc,GAAS,EACTE,EAAOhB,MAAQe,EAAKf,MACmB,IAAnCzP,OAAOC,KAAKuQ,EAAKf,OAAOvP,QACxB/B,EAAOuS,KAAK,2BAKhBF,EAAKd,SACLa,GAAS,EACTE,EAAOf,OAASc,EAAKd,OAEjBc,EAAKd,OAAOiB,mBACLF,EAAOE,WAEsB,IAApC3Q,OAAOC,KAAKuQ,EAAKd,QAAQxP,QACzB/B,EAAOuS,KAAK,4BAIpB,IAAIrJ,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAE1B,IAAImK,EAAO,KACX,GAAIL,EAAQ,CACR,IAAIM,EAAUvO,KAAKqC,UAAU8L,EAAQ,KAAM,GAC3CG,EAAO9R,KAAKgS,iBAAiBD,EACjC,CAEA,IAAIE,EAAUzJ,SAASC,cAAc,OACrCwJ,EAAQvJ,UAAY1I,KAAKqI,KAAKwI,cAE9B,IAAIqB,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY1I,KAAKqI,KAAKyI,UAC5BoB,EAAMC,UAAYnS,KAAKJ,QAAQuQ,MAC/B8B,EAAQ9J,YAAY+J,GAEpB,IAAIE,EAAM5J,SAASC,cAAc,OACjC2J,EAAI1J,UAAY1I,KAAKqI,KAAK0I,YAC1BqB,EAAID,UAAYL,EACZM,EAAIC,iBACJD,EAAIC,iBAAiB,SAAS,SAAUpQ,GAChC0G,EAAK/I,QAAQsQ,MAAMM,SACnB7H,EAAK2J,sBAAsBrQ,EAEnC,IACOmQ,EAAIG,aACXH,EAAIG,YAAY,WAAW,SAAUtQ,GAC7B0G,EAAK/I,QAAQsQ,MAAMM,SACnB7H,EAAK2J,sBAAsBrQ,EAEnC,IAEJgQ,EAAQ9J,YAAYiK,GACpB7J,EAAIJ,YAAY8J,GAGZjS,KAAKJ,QAAQsQ,MAAMZ,OACnB/G,EAAIJ,YAAYnI,KAAKwS,yBAAyB,CAC1CC,IAAOd,EAAOf,OAAUe,EAAOf,OAAO8B,QAAU,EAChDC,IAAOhB,EAAOf,OAAUe,EAAOf,OAAOgC,QAAU,MAKpD5S,KAAKJ,QAAQsQ,MAAMM,SACnBjI,EAAIJ,YAAYnI,KAAK6S,8BAIzB7S,KAAK2H,UAAYY,CACrB,GAEA,CAAAzB,IAAA,2BAAAC,MAUA,SAA0BuI,GACtBjQ,EAAOE,MAAM,4BAEb,IAAIoJ,EAAO3I,KAEPoQ,EAAMpQ,KAAKJ,QAAQwQ,IAEnB0C,EAAgBtK,SAASC,cAAc,OAC3CqK,EAAcpK,UAAY1I,KAAKqI,KAAK2I,oBAOpC,IAAI+B,EAASvK,SAASC,cAAc,OACpCsK,EAAOrK,UAAY1I,KAAKqI,KAAK6I,uBAE7B,IAAI8B,EAAWxK,SAASC,cAAc,SACtCuK,EAAStK,UAAY1I,KAAKqI,KAAK8I,cAC/B6B,EAASb,UAAY,QACrBY,EAAO5K,YAAY6K,GAEnB,IAAIC,EAAWzK,SAASC,cAAc,SACtCwK,EAASvK,UAAY1I,KAAKqI,KAAK+I,cAC/B6B,EAAS/G,KAAO,QAChB+G,EAASlM,MAAQuI,EAAMmD,KAAO,EAC9BQ,EAAS9C,MAAQb,EAAMmD,KAAO,EAC9BQ,EAASC,UAAW,EACpBD,EAASR,IAAM,EACfQ,EAASN,IAAM,GACfM,EAASpT,KAAOuQ,EACZ6C,EAASZ,iBACTY,EAASZ,iBAAiB,UAAU,SAAUpQ,GAC1C0G,EAAKwK,4BAA4BlR,EACrC,IACOgR,EAAS9K,aAChB8K,EAAS9K,YAAY,YAAY,SAAUlG,GACvC0G,EAAKwK,4BAA4BlR,EACrC,IAEJ8Q,EAAO5K,YAAY8K,GAEnBH,EAAc3K,YAAY4K,GAE1B,IAAIK,EAAS5K,SAASC,cAAc,OACpC2K,EAAO1K,UAAY1I,KAAKqI,KAAKgJ,uBAE7B,IAAIgC,EAAW7K,SAASC,cAAc,SACtC4K,EAAS3K,UAAY1I,KAAKqI,KAAKiJ,cAC/B+B,EAASlB,UAAY,QACrBiB,EAAOjL,YAAYkL,GAEnB,IAAIC,EAAW9K,SAASC,cAAc,SAsBtC,OArBA6K,EAAS5K,UAAY1I,KAAKqI,KAAK+I,cAC/BkC,EAASpH,KAAO,QAChBoH,EAASvM,MAAQuI,EAAMqD,KAAO,GAC9BW,EAASnD,MAAQb,EAAMqD,KAAO,GAC9BW,EAASJ,UAAW,EACpBI,EAASb,IAAM,EACfa,EAASX,IAAM,GACfW,EAASzT,KAAOuQ,EACZkD,EAASjB,iBACTiB,EAASjB,iBAAiB,UAAU,SAAUpQ,GAC1C0G,EAAK4K,4BAA4BtR,EACrC,IACOqR,EAASnL,aAChBmL,EAASnL,YAAY,YAAY,SAAUlG,GACvC0G,EAAK4K,4BAA4BtR,EACrC,IAEJmR,EAAOjL,YAAYmL,GAEnBR,EAAc3K,YAAYiL,GAEnBN,CACX,GAEA,CAAAhM,IAAA,6BAAAC,MASA,WACI1H,EAAOmU,KAAK,0DAEZ,IAAIC,EAAejL,SAASC,cAAc,OAG1C,OAFAgL,EAAa/K,UAAY1I,KAAKqI,KAAKmJ,mBAE5BiC,CACX,GAKA,CAAA3M,IAAA,mBAAAC,MAOA,SAAkB+K,GAEd,OADAA,EAAOA,EAAKzD,QAAQ,KAAM,SAASA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,SAC3DA,QAAQ,yGAAyG,SAAUqF,GACnI,IAAIC,EAAM,iBAYV,MAXI,KAAKC,KAAKF,GAENC,EADA,KAAKC,KAAKF,GACJ,cAEA,iBAEH,aAAaE,KAAKF,GACzBC,EAAM,kBACC,OAAOC,KAAKF,KACnBC,EAAM,gBAEH,gBAAkBA,EAAM,KAAOD,EAAQ,SAClD,GACJ,GAKA,CAAA5M,IAAA,MAAAC,MAIA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,UAAAC,MAMA,SAASiN,GAKL,OAJA3U,EAAOE,MAAM,YAAayU,QACH,IAAZA,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,QAEf,SAAjChU,KAAK2H,UAAU1I,MAAM+U,OACjC,GAEA,CAAAlN,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,wBAAAC,MAUA,SAAuB9E,GACnB5C,EAAOE,MAAM,wBAAyB0C,GACtCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYlV,MAAMoQ,WAAYpN,EACpD,GAEA,CAAA6E,IAAA,8BAAAC,MAUA,SAA6B9E,GACzB5C,EAAOE,MAAM,8BAA+B0C,GAC5CA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYlV,MAAMqQ,MAAMC,YAAatN,EAC3D,GAEA,CAAA6E,IAAA,8BAAAC,MAUA,SAA6B9E,GACzB5C,EAAOE,MAAM,8BAA+B0C,GAC5CA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYlV,MAAMqQ,MAAME,YAAavN,EAC3D,I,4FAAC,CApaM,GAwaX,U,ssBAGIV,OAAOvC,IAAMuC,OAAOvC,GAAGC,QAClBsC,OAAOvC,GAAGC,MAAMmV,SACjB7S,OAAOvC,GAAGC,MAAMmV,OAAS,CAAC,GAE9B7S,OAAOvC,GAAGC,MAAMmV,OAAOnE,MAAQA,GC1cnC,IAAI5Q,EAAS2Q,EAAAA,EAAO1Q,UAAU,iBAwCxB+U,EAAM,WAmBR,O,EAjBA,SAAAA,EAAazU,GAQT,G,4FARkB0G,CAAA,KAAA+N,GAClBhV,EAAOE,MAAM,uBAAwBK,GAGrCI,KAAKJ,QAAUA,GAAW,CACtB,IAGEI,gBAAgBqU,GAClB,MAAM,IAAIpQ,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAEA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIlB,IAAIwN,EAAgB,CAChB+D,YAAa,EACbC,OAAS,CACLC,SAAU,EACVtI,KAAO,UAIVlM,KAAKJ,QAAQsQ,OAAoD,IAA3ChP,OAAOC,KAAKnB,KAAKJ,QAAQsQ,OAAO9O,SACvDpB,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,QAErB,IAArBvQ,KAAKJ,QAAQwQ,KACC,OAArBpQ,KAAKJ,QAAQwQ,KACZpQ,KAAKJ,QAAQwQ,MAEdpQ,KAAKJ,QAAQwQ,IAAM,CACfqE,cAAgB,GAChB/E,OAAS,KAIjB1P,KAAK2H,UAAY,KAGjB3H,KAAKqI,KAAO,CACRtF,OAAS,4BACT4E,UAAY,gCACZ+M,eAAiB,+BACjBC,iBAAmB,mCACnBC,MAAQ,2BACRC,QAAU,+BACV3C,MAAQ,2BACR4C,QAAU,+BACVC,MAAQ,2BACRC,QAAU,+BACVlT,QAAU,6BAElB,GAEA,CAAAgF,IAAA,iBAAAC,MAmBA,WAEI,IAAI4B,EAAO3I,KAEPoQ,EAAMpQ,KAAKJ,QAAQwQ,IAEnBlM,EAAKlE,KAAKkE,IAAM+Q,EAAAA,EAAGC,WAGnB3M,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAC1BY,EAAI4H,MAAQC,EAAIqE,eAAiB,GAEjC,IAAIU,EAAa/E,EAAIV,OACrB,GAAIyF,EACA,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAW/T,OAAQgU,IAAK,CACxC,IAAIC,EAASF,EAAWC,GAGpBE,EAAW9M,SAASC,cAAc,OACtC6M,EAASpR,GAAKlE,KAAKqI,KAAKsM,iBAAmBS,EAAI,IAAMlR,EACrDoR,EAAS5M,UAAY1I,KAAKqI,KAAKqM,eAC/BY,EAASC,SAAWH,EAGpB,IAAII,EAAOH,EAAO7V,IAEdiW,EAAYJ,EAAOK,WAAY,EACnC,GAAIF,EAAM,CAEN,IAAIjB,EAASvU,KAAKJ,QAAQsQ,MAAMqE,OAChC,GAAIA,EAAOC,QAAS,CAChB,IAAImB,EAAyB,aAAhBpB,EAAOrI,KAAuB,WAAa,QACpD0J,EAAUpN,SAASC,cAAc,SACrCmN,EAAQ1J,KAAOyJ,EACfC,EAAQ1R,GAAKlE,KAAKqI,KAAKwM,QAAUO,EAAI,IAAMlR,EAC3C0R,EAAQlN,UAAY1I,KAAKqI,KAAKuM,MAC9BgB,EAAQvN,KAAOnE,EACf0R,EAAQC,QAAUJ,EAClBG,EAAQ/V,KAAO2V,EACXI,EAAQvD,iBACRuD,EAAQvD,iBAAiB,SAAS,SAAUpQ,GACxC0G,EAAKmN,wBAAwB7T,EACjC,IACO2T,EAAQrD,aACfqD,EAAQrD,YAAY,WAAW,SAAUtQ,GACrC0G,EAAKmN,wBAAwB7T,EACjC,IAEJqT,EAASnN,YAAYyN,EACzB,CAEA,GAAI5V,KAAKJ,QAAQsQ,MAAMoE,YACfe,EAAOU,UAAW,CAClB,IAAIC,EAAOxN,SAASC,cAAc,OAClCuN,EAAK9R,GAAKlE,KAAKqI,KAAK2M,QAAUI,EAAI,IAAMlR,EACxC8R,EAAKtN,UAAY1I,KAAKqI,KAAK0M,MAC3BiB,EAAKC,IAAMZ,EAAOU,UAClBC,EAAKE,IAAMb,EAAOU,UAClBC,EAAK7F,MAAQkF,EAAO1O,aAAe,GACnCqP,EAAKnW,KAAO2V,EACRQ,EAAK3D,iBACL2D,EAAK3D,iBAAiB,SAAS,SAAUpQ,GACrC0G,EAAKwN,wBAAwBlU,GAE7B,IAAImU,EAAQnU,EAAEc,OAAOsT,cAAcC,WACnC,GAAIF,EAAO,CACP,IAAIG,EAAOH,EAAM,GACkB,UAA/BG,EAAKC,QAAQzO,gBACbwO,EAAKV,SAAWU,EAAKV,QAE7B,CACJ,IACOG,EAAKzD,aACZyD,EAAKzD,YAAY,WAAW,SAAUtQ,GAClC0G,EAAKwN,wBAAwBlU,GAC7B,IAAImU,EAAQnU,EAAEc,OAAOsT,cAAcC,WACnC,GAAIF,EAAO,CACP,IAAIG,EAAOH,EAAM,GACkB,UAA/BG,EAAKC,QAAQzO,gBACbwO,EAAKV,SAAWU,EAAKV,QAE7B,CACJ,IAEJP,EAASnN,YAAY6N,EACzB,CAGJ,GAAIX,EAAOhN,KAAM,CACb,IAAIoO,EAASjO,SAASC,cAAc,SACpCgO,EAAOvS,GAAKlE,KAAKqI,KAAKyM,QAAUM,EAAI,IAAMlR,EACtClE,KAAKJ,QAAQsQ,MAAMqE,OAAOC,UAC1BiC,EAAOC,QAAUd,EAAQ1R,IAE7BuS,EAAO/N,UAAY1I,KAAKqI,KAAK6J,MAC7BuE,EAAOtE,UAAYkD,EAAOhN,KAC1BoO,EAAOtG,MAAQkF,EAAO1O,aAAe,GACrC8P,EAAO5W,KAAO2V,EACTxV,KAAKJ,QAAQsQ,MAAMqE,OAAOC,UACvBiC,EAAOpE,iBACPoE,EAAOpE,iBAAiB,SAAS,SAAUpQ,GACvC0G,EAAKmN,wBAAwB7T,EACjC,IACOwU,EAAOlE,aACdkE,EAAOlE,YAAY,WAAW,SAAUtQ,GACpC0G,EAAKmN,wBAAwB7T,EACjC,KAGRqT,EAASnN,YAAYsO,EACzB,CACJ,KAAO,CACH,IAAIE,EAAOnO,SAASC,cAAc,SAClCkO,EAAKjO,UAAY1I,KAAKqI,KAAKvG,QAC3B6U,EAAKxE,UAAY,0BACjBmD,EAASnN,YAAYwO,EACzB,CAEApO,EAAIJ,YAAYmN,EACpB,CAGJtV,KAAK2H,UAAYY,CACrB,GAKA,CAAAzB,IAAA,MAAAC,MAIA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,UAAAC,MAMA,SAASiN,GAKL,OAJA3U,EAAOE,MAAM,YAAayU,QACH,IAAZA,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,QAEf,SAAjChU,KAAK2H,UAAU1I,MAAM+U,OACjC,GAEA,CAAAlN,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,0BAAAC,MAOA,SAAyB9E,GAIrB,GAHA5C,EAAOE,MAAM,0BAA2B0C,GACxCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACyB,aAAnCI,KAAKJ,QAAQsQ,MAAMqE,OAAOrI,KAM1B,IAJA,IAAI0K,EAAY3U,EAAEc,OAAO8T,gBAAgB3S,GAAG4S,UACxC7U,EAAEc,OAAO8T,gBAAgB3S,GAAG6S,YAAY,KAAO,GAE/CC,EAAUxO,SAASkB,uBAAuB1J,KAAKqI,KAAKuM,OAC/CQ,EAAI,EAAGA,EAAI4B,EAAQ5V,OAAQgU,IAAK,CACrC,IAAI6B,EAAKD,EAAQ5B,GACb6B,EAAG/S,KAAOjC,EAAEc,OAAO8T,gBAAgB3S,IAG3B+S,EAAG/S,GAAG4S,UAAUG,EAAG/S,GAAG6S,YAAY,KAAO,KACvCH,IAGdK,EAAGpB,SAAU,EACjB,CAEJ3B,IAAAA,SAAkBC,EAAYzE,OAAOC,aAAc1N,EACvD,GAEA,CAAA6E,IAAA,0BAAAC,MAOA,SAAyB9E,GAIrB,GAHA5C,EAAOE,MAAM,0BAA2B0C,GACxCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACyB,aAAnCI,KAAKJ,QAAQsQ,MAAMqE,OAAOrI,KAI1B,IAFA,IAAI0K,EAAY3U,EAAEc,OAAOmB,GAAG4S,UAAU7U,EAAEc,OAAOmB,GAAG6S,YAAY,KAAO,GACjEC,EAAUxO,SAASkB,uBAAuB1J,KAAKqI,KAAKuM,OAC/CQ,EAAI,EAAGA,EAAI4B,EAAQ5V,OAAQgU,IAAK,CACrC,IAAI6B,EAAKD,EAAQ5B,GACb6B,EAAG/S,KAAOjC,EAAEc,OAAOmB,IAGX+S,EAAG/S,GAAG4S,UAAUG,EAAG/S,GAAG6S,YAAY,KAAO,KACvCH,IAGdK,EAAGpB,SAAU,EACjB,CAEJ3B,IAAAA,SAAkBC,EAAYzE,OAAOE,aAAc3N,EACvD,I,4FAAC,CA3UO,GA+UZ,U,ssBAGIV,OAAOvC,IAAMuC,OAAOvC,GAAGC,QAClBsC,OAAOvC,GAAGC,MAAMmV,SACjB7S,OAAOvC,GAAGC,MAAMmV,OAAS,CAAC,GAE9B7S,OAAOvC,GAAGC,MAAMmV,OAAOC,OAASA,GC/XpC,IAAIhV,EAAS2Q,EAAAA,EAAO1Q,UAAU,iBA0BxB4X,EAAM,WAwBR,O,EAtBA,SAAAA,EAAatX,GAaT,G,4FAbkB0G,CAAA,KAAA4Q,GAClB7X,EAAOE,MAAM,uBAAwBK,GAGrCI,KAAKJ,QAAUA,GAAW,CAEtBmD,OAAS,KACTsB,SAAW,EACX6L,MAAQ,KACRC,MAAQ,KACRC,IAAM,QAGJpQ,gBAAgBkX,GAClB,MAAM,IAAIjT,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAEA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIb/C,KAAKJ,QAAQyE,WACdrE,KAAKJ,QAAQyE,SAAW,GAG5B,IAAIkM,EAAgB,CAChBC,SAAU,GAGTxQ,KAAKJ,QAAQsQ,QACdlQ,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,GAEhDvQ,KAAKJ,QAAQwQ,MAEdpQ,KAAKJ,QAAQwQ,IAAM,CACfX,OAAS,KAIZzP,KAAKJ,QAAQuQ,QACdnQ,KAAKJ,QAAQuQ,MAAQ,kBAEzBnQ,KAAK2H,UAAY,KAGjB3H,KAAKqI,KAAO,CACRtF,OAAS,6BACT4E,UAAY,gCACZkJ,cAAgB,oCAChBC,UAAY,gCACZC,YAAc,kCACdS,mBAAqB,4CAE7B,GAEA,CAAA1K,IAAA,iBAAAC,MAcA,WAEI,IAAI4B,EAAO3I,KAEPyR,GAAS,EACT0F,EAAU3T,KAAKC,MAAMD,KAAKqC,UAAU7F,KAAKJ,QAAQwQ,MAIjD+G,EAAQ1H,SACRgC,GAAS,EACqB,IAA1B0F,EAAQ1H,OAAOrO,QACf/B,EAAOuS,KAAK,4BAIpB,IAAIrJ,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAE1B,IAAImK,EAAO,KACPL,IACAK,EAAOtO,KAAKqC,UAAUsR,EAAQ1H,OAAQ,KAAM,IAGhD,IAAIwC,EAAUzJ,SAASC,cAAc,OACrCwJ,EAAQvJ,UAAY1I,KAAKqI,KAAKwI,cAE9B,IAAIuG,EAAY5O,SAASC,cAAc,SACvC2O,EAAU1O,UAAY1I,KAAKqI,KAAKyI,UAChCsG,EAAUjF,UAAYnS,KAAKJ,QAAQuQ,MACnC8B,EAAQ9J,YAAYiP,GAEpB,IAAIC,EAAU7O,SAASC,cAAc,OAmBrC,GAlBA4O,EAAQ3O,UAAY1I,KAAKqI,KAAK0I,YAC9BsG,EAAQlF,UAAYL,EAChBuF,EAAQhF,iBACRgF,EAAQhF,iBAAiB,SAAS,SAAUpQ,GACpC0G,EAAK/I,QAAQsQ,MAAMM,SACnB7H,EAAK2O,uBAAuBrV,EAEpC,IACOoV,EAAQ9E,aACf8E,EAAQ9E,YAAY,WAAW,SAAUtQ,GACjC0G,EAAK/I,QAAQsQ,MAAMM,SACnB7H,EAAK2O,uBAAuBrV,EAEpC,IAEJgQ,EAAQ9J,YAAYkP,GACpB9O,EAAIJ,YAAY8J,GAEZjS,KAAKJ,QAAQsQ,MAAMM,QAAS,CAC5B,IAAI+G,EAAU/O,SAASC,cAAc,OACrC8O,EAAQ7O,UAAY1I,KAAKqI,KAAKmJ,mBAC9BjJ,EAAIJ,YAAYoP,EACpB,CAGAvX,KAAK2H,UAAYY,CACrB,GAKA,CAAAzB,IAAA,MAAAC,MAIA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,UAAAC,MAMA,SAASiN,GAKL,OAJA3U,EAAOE,MAAM,YAAayU,QACH,IAAZA,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,QAEf,SAAjChU,KAAK2H,UAAU1I,MAAM+U,OACjC,GAEA,CAAAlN,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,yBAAAC,MAUA,SAAwB9E,GACpB5C,EAAOE,MAAM,yBAA0B0C,GACvCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAY1E,OAAOJ,WAAYpN,EACrD,I,4FAAC,CAxNO,GA4NZ,UAGIV,OAAOvC,IAAMuC,OAAOvC,GAAGC,QAClBsC,OAAOvC,GAAGC,MAAMmV,SACjB7S,OAAOvC,GAAGC,MAAMmV,OAAS,CAAC,GAE9B7S,OAAOvC,GAAGC,MAAMmV,OAAO8C,OAASA,G,otBC7PpC,IAAI7X,EAAS2Q,EAAAA,EAAO1Q,UAAU,iBAgDxBkY,EAAM,WAER,SAAAA,EAAa5X,GAYT,G,4FAZkB0G,CAAA,KAAAkR,GAClBnY,EAAOE,MAAM,uBAAwBK,GAGrCI,KAAKJ,QAAUA,GAAW,CAEtBmD,OAAS,KACTsB,SAAW,EACXoT,QAAU,KACVrH,IAAM,QAGJpQ,gBAAgBwX,GAClB,MAAM,IAAIvT,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,CAKA,O,EAAAkH,E,EAAA,EAAA1Q,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAKb/C,KAAKJ,QAAQyE,WACdrE,KAAKJ,QAAQyE,SAAW,GAGvBrE,KAAKJ,QAAQwQ,MAEdpQ,KAAKJ,QAAQwQ,IAAM,CACfD,MAAQ,UACRuH,UAAW,EACX/G,MAAQ,CACJ,aAAe,aAO3B,IAAIgH,EAAY3X,KAAKJ,QAAQwQ,IAAIsH,SACjC1X,KAAK0X,cAAiC,IAAdC,GAA6BA,EAGrD3X,KAAK4X,aAAe,CAChB1L,KAAO,OACP2L,OAAS,CACLC,MAAQ,EACRC,OAAS,UACTC,MAAQ,UACRC,QAAU,IAKlBjY,KAAK2H,UAAY,KACjB3H,KAAKkY,gBAAkB,KACvBlY,KAAKmY,eAAiB,KAGtBnY,KAAKqI,KAAO,CACRtF,OAAS,6BACT4E,UAAY,gCACZyQ,sBAAwB,sCACxBC,aAAe,6BACfC,eAAiB,+BACjBC,YAAc,4BACdC,qBAAuB,sCAI3BxY,KAAKyY,OAAS,CACV,aAAe,mBACf,aAAe,qBACf,eAAiB,mBACjB,aAAe,yBACf,eAAiB,yBAEzB,GAEA,CAAA3R,IAAA,iBAAAC,MAcA,WACI,IAAI2K,EAAO1R,KAAKJ,QAAQwQ,IAEpB7H,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAM1B,IAAI1I,EAAQiC,OAAOwX,OAAO,CAAC,EAAGhH,EAAKf,MAAOe,EAAKd,QAI3CzP,EAAOD,OAAOC,KAAKlC,GACvB,GAAoB,IAAhBkC,EAAKC,OAAT,CAUA,IAFA,IAAI4M,EAAS,CAAC,EACV2K,GAAS,EACJvD,EAAI,EAAGA,EAAIjU,EAAKC,OAAQgU,IAAK,CAClC,IAAItO,EAAM3F,EAAKiU,GAGf,GAAI,QAAQxB,KAAK9M,IACb,QAAQ8M,KAAK9M,IACb,UAAU8M,KAAK9M,IACf,cAAc8M,KAAK9M,IACnB,QAAQ8M,KAAK9M,IACb,QAAQ8M,KAAK9M,GAAM,CAEnB6R,GAAS,EAET,IAAIxI,EAAQuB,EAAKvB,OAAS,GAKtBjE,EAAOpF,EAAI8R,MAAM,KAAK,GACb,SAAT1M,GAA4B,SAATA,IACnBA,EAAO,UAGXlM,KAAK4X,aAAe5X,KAAK6Y,eAAe3M,EAAMjN,GAC9C+O,EAAS,CACL8K,KAAO9Y,KAAK0X,SACZvH,MAAQA,EACRjE,KAAOlM,KAAK4X,aAAa1L,KACzB2L,OAAS7X,KAAK4X,aAAaC,QAE/BtP,EAAIJ,YAAYnI,KAAK+Y,yBAAyB/K,IAG9C,KACJ,CACJ,CAGK2K,IAED3K,EAAS,CACL8K,KAAO9Y,KAAK0X,SACZvH,MAAQ,GACRjE,KAAOlM,KAAK4X,aAAa1L,KACzB2L,OAAS7X,KAAK4X,aAAaC,QAE/BtP,EAAIJ,YAAYnI,KAAK+Y,yBAAyB/K,IAC9C3O,EAAOmU,KAAK,gDAIhBxT,KAAKmY,eAAiBnY,KAAKgZ,4BAA4BhL,GACvDzF,EAAIJ,YAAYnI,KAAKmY,gBAGrBnY,KAAK2H,UAAYY,CA9DjB,MAFIlJ,EAAOuS,KAAK,qCAiEpB,GAKA,CAAA9K,IAAA,iBAAAC,MAoCA,SAAgBmF,EAAM2L,GAMlB,GAAa,WAAT3L,EAAmB,CACnB,IAAI+M,EAAcpB,EAAO,cACrBqB,EAAcrB,EAAO,cAEzB,GAAa,WADb3L,EAAQ+M,GAAeC,EAAe,OAAUD,EAAe,OAAUC,EAAe,OAAS,UAG7F,YADA7Z,EAAOmU,KAAK,iBAGpB,CAEA,IAAI2F,EAAkB,CAAC,EACvB,IAAK,IAAMrS,KAAO+Q,EACd,GAAI3W,OAAOwJ,eAAevL,KAAK0Y,EAAQ/Q,GAAM,CACzC,IAAMsS,EAAMvB,EAAO/Q,GACnB,GAAI0Q,EAAO6B,WAAWnN,GAAMpE,SAAShB,GAAM,CACvC,IAAIwS,EAAOxS,EAAIuH,QAAQnC,EAAM,IAAI+B,MAAM,GACnClH,EAAQ/G,KAAKuZ,UAAUH,GAC3B,GAAIrS,EAAO,CAEP,KAAa,YAATuS,GAA+B,UAATA,GACjBtZ,KAAKJ,QAAQ6X,SACbzX,KAAKJ,QAAQ6X,QAAQ3F,MACrB9R,KAAKJ,QAAQ6X,QAAQ3F,KAAK/K,IAAQ,CACnC,IAAIpB,EAAIuG,EAAO,IAAMoN,EACrBja,EAAOmU,KAAK,6BAA8B7N,GAC1C,KACJ,CAEJwT,EAAgBG,GAAQvS,CAC5B,CACJ,MACI1H,EAAOmU,KAAK,4BAA6B1M,EAEjD,CAGJ,MAAO,CACHoF,KAAOA,EACP2L,OAASsB,EAEjB,GAEA,CAAArS,IAAA,mBAAAC,MAWA,SAAkBmF,EAAM2L,GAEpB,IAAItP,EAAMvI,KAAKkY,gBAEf,IAAK3P,EACD,OAAO,EAIX,IAAIiR,EAAM,KASV,OAJK3B,EAAOG,QACRH,EAAOG,MAAQ,WAGX9L,GACJ,IAAK,OAEDsN,EAAM,yRACNjR,EAAItJ,MAAkB,WAAIua,EACrBnL,QAAQ,UAA4C,IAAhCwJ,EAAOG,MAAMyB,QAAQ,OAAgB5B,EAAOG,MAAQ0B,EAAAA,EAAMC,UAAU9B,EAAOG,MAAO,IACtG3J,QAAQ,YAAawJ,EAAOI,SAAW,GACvC5J,QAAQ,UALG,qCAMhB,MACJ,IAAK,OACGwJ,EAAO9C,OAGPyE,EAAM,6MACDnL,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAO9C,OAAOzP,GACvD+I,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAO9C,OAAOxP,GACvD8I,QAAQ,OAAQrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAO9C,OAAO+C,OACxDzJ,QAAQ,OAAQrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAO9C,OAAOhM,QACxDsF,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQmC,KAAKC,GACzCxL,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQmC,KAAKE,GACzCzL,QAAQ,QAASrO,KAAKJ,QAAQ6X,QAAQjY,KAC3C+I,EAAI4J,UAAYqH,IAGhBA,EAAM,uNACNjR,EAAItJ,MAAkB,WAAIua,EACrBnL,QAAQ,UAA4C,IAAhCwJ,EAAOG,MAAMyB,QAAQ,OAAgB5B,EAAOG,MAAQ0B,EAAAA,EAAMC,UAAU9B,EAAOG,MAAO,IACtG3J,QAAQ,UAJO,wCAMxB,MACJ,IAAK,OACD,IAAI0L,EAAqBvQ,MAAM4E,QAAQyJ,EAAkB,WAAMA,EAAkB,UAAE/R,KAAK,KAAO,EAC/F0T,EAAM,gTAENjR,EAAItJ,MAAkB,WAAIua,EACrBnL,QAAQ,UAA4C,IAAhCwJ,EAAOG,MAAMyB,QAAQ,OAAgB5B,EAAOG,MAAQ0B,EAAAA,EAAMC,UAAU9B,EAAOG,MAAO,IACtG3J,QAAQ,mBAAoBwJ,EAAOI,SAAW,GAC9C5J,QAAQ,qBAAsB0L,GAC9B1L,QAAQ,iBA7CR,GA6C2BwJ,EAAOC,OAAS,IAChD,MACJ,IAAK,SACD,IAAIkC,EAAenC,EAAO,iBAAmB,UAC7C2B,EAAM,kTACNjR,EAAItJ,MAAkB,WAAIua,EACrBnL,QAAQ,UAA4C,IAAhCwJ,EAAOG,MAAMyB,QAAQ,OAAgB5B,EAAOG,MAAQ0B,EAAAA,EAAMC,UAAU9B,EAAOG,MAAO,IACtG3J,QAAQ,YAAawJ,EAAOI,SAAW,GACvC5J,QAAQ,iBAAmD,IAAhC2L,EAAaP,QAAQ,OAAgBO,EAAeN,EAAAA,EAAMC,UAAUK,EAAc,IAC7G3L,QAAQ,mBAAoBwJ,EAAO,mBAAqB,GACxDxJ,QAAQ,iBAvDR,GAuD2BwJ,EAAO,iBAAmB,IAC1D,MACJ,IAAK,aACL,IAAK,OACD,GAAIA,EAAOoC,QACPT,EAAM,6MACDnL,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAOoC,SAAS3U,GACzD+I,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAOoC,SAAS1U,GACzD8I,QAAQ,OAAQrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAOoC,SAASnC,OAC1DzJ,QAAQ,OAAQrO,KAAKJ,QAAQ6X,QAAQ3F,KAAK+F,EAAOoC,SAASlR,QAC1DsF,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQmC,KAAKC,GACzCxL,QAAQ,MAAOrO,KAAKJ,QAAQ6X,QAAQmC,KAAKE,GACzCzL,QAAQ,QAASrO,KAAKJ,QAAQ6X,QAAQjY,KAC3C+I,EAAI4J,UAAYqH,MACb,CACH,IAAIU,EAAerC,EAAO,kBAAoB,UAC9C2B,EAAM,6RACNjR,EAAItJ,MAAkB,WAAIua,EACrBnL,QAAQ,UAA4C,IAAhCwJ,EAAOG,MAAMyB,QAAQ,OAAgB5B,EAAOG,MAAQ0B,EAAAA,EAAMC,UAAU9B,EAAOG,MAAO,IACtG3J,QAAQ,YAAawJ,EAAOI,SAAW,GACvC5J,QAAQ,iBAAmD,IAAhC6L,EAAaT,QAAQ,OAAgBS,EAAeR,EAAAA,EAAMC,UAAUO,EAAc,GACtH,CACA,MACJ,QAEI,OADA7a,EAAOmU,KAAK,oCACL,EAGf,OAAO,CACX,GAEA,CAAA1M,IAAA,YAAAC,MA8CA,SAAWA,GACP,IAAIkE,EAAS,KACb,GAAqB,iBAAVlE,EACPkE,EAASlE,OACN,GAAqB,iBAAVA,EACdkE,EAASlE,OACN,GAAIyC,MAAM4E,QAAQrH,GAAQ,CAE7B,IAAIoT,GAAW,EACfpT,EAAM6C,SAAQ,SAAA1D,GACO,iBAANA,IACPiU,GAAW,EAEnB,IACIA,IACAlP,EAASlE,EAEjB,KAA4B,WAAjBqT,EAAOrT,IACdkE,EAAS,KACL,UAAWlE,IAEXA,EAAMsT,MAAMC,MAAK,SAACC,EAAGC,GACjB,IAAIC,EAAOF,EAAE,GACTG,EAAOF,EAAE,GACb,OAAIC,EAAOC,GACC,EAERD,EAAOC,EACA,EAEJ,CACX,IAGAzP,EADqBlE,EAAMsT,MAAMpM,OAAO,GAChB,GAAG,KAG/B5O,EAAOmU,KAAK,yBAEhB,OAAOvI,CACX,GAKA,CAAAnE,IAAA,2BAAAC,MAmBA,SAA0BiH,GAEtB,IAAIrF,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OACvCd,EAAUe,UAAY1I,KAAKqI,KAAK+P,sBAEhC,IAAI7P,EAAMvI,KAAKkY,gBAAkB1P,SAASC,cAAc,OACxDF,EAAIG,UAAY1I,KAAKqI,KAAKgQ,aACtBrK,EAAO8K,OACPvQ,EAAIG,WAAa,IACjBH,EAAIG,WAAa1I,KAAKqI,KAAKiQ,eACvB/P,EAAI8J,iBACJ9J,EAAI8J,iBAAiB,SAAS,SAAUpQ,GACpC0G,EAAKgS,sBAAsB1Y,EAC/B,IACOsG,EAAIgK,aACXhK,EAAIgK,YAAY,WAAW,SAAUtQ,GACjC0G,EAAKgS,sBAAsB1Y,EAC/B,KAKR,IAAIiK,EAAO8B,EAAO9B,KAKdlM,KAAK4a,iBAAiB1O,EAAM8B,EAAO6J,QAWnCtP,EAAIG,WAAcsF,EAAO8K,KAAQ,WAAa5M,EAAO,WAAaA,EAAO,gBAEzE3D,EAAIG,WAAa,iBAGrBf,EAAUQ,YAAYI,GAEtB,IAAIsS,EAAOrS,SAASC,cAAc,QAKlC,OAJAoS,EAAKnS,UAAY1I,KAAKqI,KAAKkQ,YAC3BsC,EAAK1I,UAAYnE,EAAOmC,OAAS,GACjCxI,EAAUQ,YAAY0S,GAEflT,CACX,GAEA,CAAAb,IAAA,8BAAAC,MAkCA,SAA6BiH,GAEzB,IAAIrF,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OAIvC,GAHAd,EAAUe,UAAY1I,KAAKqI,KAAKmQ,sBAG3BxK,EAAO8K,KACR,OAAOnR,EAKX,OAAQqG,EAAO9B,MACX,IAAK,QAeT,WACI,IAAI4O,EAAYtS,SAASC,cAAc,OACvCqS,EAAUpS,UAAY,qBACtB,IAAIqS,EAAavS,SAASC,cAAc,SACxCsS,EAAWrS,UAAY,cACvBqS,EAAWrE,QAAU1W,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACzD6W,EAAW5I,UAAYnS,KAAKyY,OAAO,cACnC,IAAIuC,EAAiBxS,SAASC,cAAc,SAC5CuS,EAAetS,UAAY,iBAC3BsS,EAAe9W,GAAKlE,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACxD8W,EAAe7K,MAAQ,oCACvB6K,EAAe9O,KAAO,QACtB8O,EAAejU,MAAQiH,EAAO6J,OAAOG,MACrCgD,EAAeC,aAAa,UAAW,cACnCD,EAAe3I,iBACf2I,EAAe3I,iBAAiB,UAAU,SAAUpQ,GAChD0G,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DG,MAAQ/V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IACO+Y,EAAezI,aACtByI,EAAezI,YAAY,YAAY,SAAUtQ,GAC7C0G,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DG,MAAQ/V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IAEJ6Y,EAAU3S,YAAY4S,GACtBD,EAAU3S,YAAY6S,GACtBrT,EAAUQ,YAAY2S,EAC1B,GA9CwB3b,KAAKwJ,GAiD7B,WACI,IAAIwS,EAAY3S,SAASC,cAAc,OACvC0S,EAAUzS,UAAY,qBACtB,IAAI0S,EAAa5S,SAASC,cAAc,SACxC2S,EAAW1S,UAAY,cACvB0S,EAAW1E,QAAU1W,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACzDkX,EAAWjJ,UAAYnS,KAAKyY,OAAO,cACnC,IAAI4C,EAAiB7S,SAASC,cAAc,SAC5C4S,EAAe3S,UAAY,iBAC3B2S,EAAenX,GAAKlE,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACxDmX,EAAelL,MAAQnC,EAAO6J,OAAOC,MACrCuD,EAAenP,KAAO,QACtBmP,EAAe5I,IAAM,IACrB4I,EAAe1I,IAAM,KACrB0I,EAAeC,KAAO,IACtBD,EAAeE,aAAevN,EAAO6J,OAAOC,MAC5CuD,EAAeJ,aAAa,UAAW,cACnCI,EAAehJ,iBACfgJ,EAAehJ,iBAAiB,UAAU,SAAUpQ,GAChD5C,EAAOE,MAAM0C,GACbA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DC,MAAQ7V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IACOoZ,EAAe9I,aACtB8I,EAAe9I,YAAY,YAAY,SAAUtQ,GAC7C5C,EAAOE,MAAM0C,GACbA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DC,MAAQ7V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IAEJkZ,EAAUhT,YAAYiT,GACtBD,EAAUhT,YAAYkT,GACtB1T,EAAUQ,YAAYgT,EAC1B,EAvFwBhc,KAAKwJ,GA0F7B,WACI,IAAI6S,EAAchT,SAASC,cAAc,OACzC+S,EAAY9S,UAAY,qBACxB,IAAI+S,EAAejT,SAASC,cAAc,SAC1CgT,EAAa/S,UAAY,cACzB+S,EAAa/E,QAAU1W,KAAKkE,GAAK,gBAAkBlE,KAAKkE,GAAK,eAC7DuX,EAAatJ,UAAYnS,KAAKyY,OAAO,gBACrC,IAAIiD,EAAmBlT,SAASC,cAAc,SAC9CiT,EAAiBhT,UAAY,iBAC7BgT,EAAiBxX,GAAKlE,KAAKkE,GAAK,gBAAkBlE,KAAKkE,GAAK,eAC5DwX,EAAiBvL,MAAQnC,EAAO6J,OAAOI,QACvCyD,EAAiBxP,KAAO,QACxBwP,EAAiBjJ,IAAM,IACvBiJ,EAAiB/I,IAAM,IACvB+I,EAAiBJ,KAAO,MACxBI,EAAiBH,aAAevN,EAAO6J,OAAOI,QAC9CyD,EAAiBT,aAAa,UAAW,gBACrCS,EAAiBrJ,iBACjBqJ,EAAiBrJ,iBAAiB,UAAU,SAAUpQ,GAClD5C,EAAOE,MAAM0C,GACbA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DI,QAAUhW,EAAEc,OAAOgE,SAEvB4B,EAAKuS,0BAA0BjZ,EACnC,IACOyZ,EAAiBnJ,aACxBmJ,EAAiBnJ,YAAY,YAAY,SAAUtQ,GAC/C5C,EAAOE,MAAM0C,GACbA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DI,QAAUhW,EAAEc,OAAOgE,SAEvB4B,EAAKuS,0BAA0BjZ,EACnC,IAEJuZ,EAAYrT,YAAYsT,GACxBD,EAAYrT,YAAYuT,GACxB/T,EAAUQ,YAAYqT,EAC1B,EAhI0Brc,KAAKwJ,GACvB,MACJ,IAAK,aACL,IAAK,QAgIT,WACI,IAAIgT,EAAYnT,SAASC,cAAc,OACvCkT,EAAUjT,UAAY,qBACtB,IAAIkT,EAAapT,SAASC,cAAc,SACxCmT,EAAWlT,UAAY,cACvBkT,EAAWlF,QAAU1W,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACzD0X,EAAWzJ,UAAYnS,KAAKyY,OAAO,cACnC,IAAIoD,EAAiBrT,SAASC,cAAc,SAC5CoT,EAAenT,UAAY,iBAC3BmT,EAAe3X,GAAKlE,KAAKkE,GAAK,cAAgBlE,KAAKkE,GAAK,aACxD2X,EAAe1L,MAAQ,0CACvB0L,EAAe3P,KAAO,QACtB2P,EAAe9U,MAAQiH,EAAO6J,OAAOG,MACrC6D,EAAeZ,aAAa,UAAW,cACnCY,EAAexJ,iBACfwJ,EAAexJ,iBAAiB,UAAU,SAAUpQ,GAChD0G,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DG,MAAQ/V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IACO4Z,EAAetJ,aACtBsJ,EAAetJ,YAAY,YAAY,SAAUtQ,GAC7C0G,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DG,MAAQ/V,EAAEc,OAAOgE,SAErB4B,EAAKuS,0BAA0BjZ,EACnC,IAEJ0Z,EAAUxT,YAAYyT,GACtBD,EAAUxT,YAAY0T,GACtBlU,EAAUQ,YAAYwT,EAC1B,GA/JwBxc,KAAKwJ,GAkK7B,WACI,IAAImT,EAActT,SAASC,cAAc,OACzCqT,EAAYpT,UAAY,qBACxB,IAAIqT,EAAevT,SAASC,cAAc,SAC1CsT,EAAarT,UAAY,cACzBqT,EAAarF,QAAU1W,KAAKkE,GAAK,gBAAkBlE,KAAKkE,GAAK,eAC7D6X,EAAa5J,UAAYnS,KAAKyY,OAAO,gBACrC,IAAIuD,EAAmBxT,SAASC,cAAc,SAC9CuT,EAAiBtT,UAAY,iBAC7BsT,EAAiB9X,GAAKlE,KAAKkE,GAAK,gBAAkBlE,KAAKkE,GAAK,eAC5D8X,EAAiB7L,MAAQnC,EAAO6J,OAAOI,QACvC+D,EAAiB9P,KAAO,QACxB8P,EAAiBvJ,IAAM,IACvBuJ,EAAiBrJ,IAAM,IACvBqJ,EAAiBV,KAAO,MACxBU,EAAiBT,aAAevN,EAAO6J,OAAOI,QAC9C+D,EAAiBf,aAAa,UAAW,gBACrCe,EAAiB3J,iBACjB2J,EAAiB3J,iBAAiB,UAAU,SAAUpQ,GAClDA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DI,QAAUhW,EAAEc,OAAOgE,SAEvB4B,EAAKuS,0BAA0BjZ,EACnC,IACO+Z,EAAiBzJ,aACxByJ,EAAiBzJ,YAAY,YAAY,SAAUtQ,GAC/CA,EAAEc,OAAOoN,MAAQlO,EAAEc,OAAOgE,MAC1B4B,EAAKiS,iBAAiB5M,EAAO9B,KAAMhL,OAAOwX,OAAO1K,EAAO6J,OAAQ,CAC5DI,QAAUhW,EAAEc,OAAOgE,SAEvB4B,EAAKuS,0BAA0BjZ,EACnC,IAEJ6Z,EAAY3T,YAAY4T,GACxBD,EAAY3T,YAAY6T,GACxBrU,EAAUQ,YAAY2T,EAC1B,EAtM0B3c,KAAKwJ,GAwM/B,OAAOhB,CACX,GAKA,CAAAb,IAAA,MAAAC,MAKA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,UAAAC,MAMA,SAASiN,GAKL,OAJA3U,EAAOE,MAAM,YAAayU,QACH,IAAZA,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,QAEf,SAAjChU,KAAK2H,UAAU1I,MAAM+U,OACjC,GAEA,CAAAlN,IAAA,aAAAC,MAKA,WACI,OAAO/G,KAAK0X,QAChB,GAEA,CAAA5Q,IAAA,qBAAAC,MAQA,WACI,OAAO/G,KAAKkY,eAChB,GAEA,CAAApR,IAAA,oBAAAC,MAQA,WACI,OAAO/G,KAAKmY,cAChB,GAEA,CAAArR,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,wBAAAC,MAUA,SAAuB9E,GACnB5C,EAAOE,MAAM,wBAAyB0C,GACtCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYnF,OAAOC,eAAgBhN,EACzD,GAEA,CAAA6E,IAAA,4BAAAC,MAUA,SAA2B9E,GACvB5C,EAAOE,MAAM,4BAA6B0C,GAC1CA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYnF,OAAOE,cAAejN,EACxD,I,4FAAC,CAp6BO,GA+6BZuV,EAAO6B,WAAa,CAChB4C,KAAO,CACH,aACA,iBACA,eACA,cAEJC,KAAO,CACH,aACA,eACA,qBACA,gBAEJC,WAAa,CACT,mBACA,qBACA,sBAEJC,OAAS,CACL,eACA,iBACA,sBACA,wBACA,uBAEJC,KAAO,CACH,aACA,aACA,eACA,eAEJxa,KAAO,CACH,gBACA,aACA,aACA,cACA,iBACA,gBAIR,U,ssBAGIN,OAAOvC,IAAMuC,OAAOvC,GAAGC,QAClBsC,OAAOvC,GAAGC,MAAMmV,SACjB7S,OAAOvC,GAAGC,MAAMmV,OAAS,CAAC,GAE9B7S,OAAOvC,GAAGC,MAAMmV,OAAOoD,OAASA,GC5gCpC,IAAInY,EAAS2Q,EAAAA,EAAO1Q,UAAU,gBA8CxBgd,EAAK,WAoBP,O,EAlBA,SAAAA,EAAa1c,GAMT,G,4FANkB0G,CAAA,KAAAgW,GAClBjd,EAAOE,MAAM,sBAAuBK,GAGpCI,KAAKJ,QAAUA,GAAW,CAAC,IAErBI,gBAAgBsc,GAClB,MAAM,IAAIrY,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAKA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIb/C,KAAKJ,QAAQyE,WACdrE,KAAKJ,QAAQyE,SAAW,GAG5B,IAAIkM,EAAgB,CAChBsB,YAAa,EACbwK,KAAO,CACHtH,OAAQ,EACRwH,OAAS,OAEbrQ,MAAO,EACPsQ,KAAM,EACNC,QAAS,EACTC,OAAQ,GAGP1c,KAAKJ,QAAQsQ,QACdlQ,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,GAErD,IAAIoM,EAAc,CACdzY,GAAK,GACLgI,KAAO,GACP0Q,OAAS,GACT,eAAiB,IAGhB5c,KAAKJ,QAAQwQ,MACdpQ,KAAKJ,QAAQwQ,IAAMuM,GAGvBlM,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQwQ,IAAKuM,GAAa,GAGjD3c,KAAK6c,aAAc,EAGnB7c,KAAK8c,QAAU,KACf9c,KAAK+c,OAAS,KACd/c,KAAKgd,QAAU,KAGfhd,KAAK2H,UAAY,KACjB3H,KAAKid,cAAgB,KACrBjd,KAAKkd,UAAY,KAGjBld,KAAKqI,KAAO,CACRtF,OAAS,4BACT4E,UAAY,+BACZwV,gBAAkB,qCAClBC,eAAiB,oCACjBC,gBAAkB,gCAClBC,WAAa,gCACbC,QAAU,+BACVC,WAAa,gCACbC,WAAa,gCACbC,eAAiB,+BACjBC,gBAAkB,qCAClBC,gBAAkB,qCAClBC,uBAAyB,4CACzBC,uBAAyB,4CAEjC,GAEA,CAAAhX,IAAA,iBAAAC,MAwBA,WAEI,IAAI4B,EAAO3I,KAEPoQ,EAAMpQ,KAAKJ,QAAQwQ,IAEnB7H,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAG1B,IAAIoW,EAAWvV,SAASC,cAAc,OAKtC,GAJAsV,EAAS7Z,GAAKlE,KAAKqI,KAAK+U,eAAiB,IAAMpd,KAAKJ,QAAQyE,SAC5D0Z,EAASrV,UAAY1I,KAAKqI,KAAK+U,eAG3Bpd,KAAKJ,QAAQsQ,MAAMsM,IAAK,CAExB,IAAIwB,EAAaxV,SAASC,cAAc,SACxCuV,EAAW9Z,GAAKlE,KAAKqI,KAAKgV,gBAAkB,IAAMrd,KAAKJ,QAAQyE,SAC/D2Z,EAAWtV,UAAY1I,KAAKqI,KAAKgV,gBACjCW,EAAW9R,KAAO,WAClB6R,EAAS5V,YAAY6V,GAErB,IAAIC,EAAazV,SAASC,cAAc,SACxCwV,EAAWvV,UAAY1I,KAAKqI,KAAKiV,WACjCW,EAAWvH,QAAUsH,EAAW9Z,GAC5B+Z,EAAW5L,iBACX4L,EAAW5L,iBAAiB,SAAS,SAAUpQ,GAC3C0G,EAAKuV,mBAAmBjc,EAC5B,IACOgc,EAAW1L,aAClB0L,EAAW1L,YAAY,WAAW,SAAUtQ,GACxC0G,EAAKuV,mBAAmBjc,EAC5B,IAEJ8b,EAAS5V,YAAY8V,EACzB,CAIA,IAAIE,EAAY,WACZ,IAAIC,EAAW5V,SAASC,cAAc,OAKtC,GAJA2V,EAASla,GAAKlE,KAAKqI,KAAKqV,eAAiB,IAAM1d,KAAKJ,QAAQyE,SAC5D+Z,EAAS1V,UAAY1I,KAAKqI,KAAKqV,eAG3B1d,KAAKJ,QAAQsQ,MAAM2B,WAAY,CAC/B,IAAIwM,EAAa7V,SAASC,cAAc,SACxC4V,EAAWna,GAAKlE,KAAKqI,KAAKsV,gBAAkB,IAAM3d,KAAKJ,QAAQyE,SAC/Dga,EAAW3V,UAAa1I,KAAKJ,QAAQsQ,MAAMmM,KAAKtH,MAAS/U,KAAKqI,KAAKsV,gBAAkB3d,KAAKqI,KAAKwV,uBAC/FQ,EAAWnS,KAAO,WAClBmS,EAAWxI,QAAU,UAGjBwI,EAAWhM,iBACXgM,EAAWhM,iBAAiB,SAAS,SAAUpQ,GAC3C0G,EAAK2V,wBAAwBrc,EACjC,IACOoc,EAAW9L,aAElB8L,EAAW9L,YAAY,WAAW,SAAUtQ,GACxC0G,EAAK2V,wBAAwBrc,EACjC,IAEJmc,EAASjW,YAAYkW,GAErBre,KAAKid,cAAgBoB,EAErB,IAAIE,EAAa/V,SAASC,cAAc,SACxC8V,EAAW7H,QAAU1W,KAAKqI,KAAKsV,gBAAkB,IAAM3d,KAAKJ,QAAQyE,SACpEka,EAAWra,GAAKlE,KAAKqI,KAAKuV,gBAAkB,IAAM5d,KAAKJ,QAAQyE,SAC/Dka,EAAW7V,UAAa1I,KAAKJ,QAAQsQ,MAAMmM,KAAKtH,MAAS/U,KAAKqI,KAAKuV,gBAAkB5d,KAAKqI,KAAKyV,uBAC/FS,EAAWpO,MAAQ,6BACnBiO,EAASjW,YAAYoW,GAErBhW,EAAIJ,YAAYiW,EACpB,CAGIpe,KAAKJ,QAAQsQ,MAAMwM,OAEnBrd,EAAOmU,KAAK,mDAIZxT,KAAKJ,QAAQsQ,MAAMuM,QAEnBpd,EAAOmU,KAAK,mDAEpB,EAQA,GALuC,UAAnCxT,KAAKJ,QAAQsQ,MAAMmM,KAAKE,QACxB4B,EAAUK,MAAMxe,MAIhBA,KAAKJ,QAAQsQ,MAAMhE,MAAQkE,EAAIlE,KAAM,CACrC,IAAIuS,EAAUjW,SAASC,cAAc,OAQrC,OAPAgW,EAAQ/V,UAAY1I,KAAKqI,KAAKkV,QAOtBnN,EAAIlE,KAAKvB,eACb,IAAK,cACD8T,EAAQxf,MAAM,uBAAyB,QACvC,MACJ,IAAK,cACDwf,EAAQxf,MAAM,uBAAyB,WACvC,MACJ,IAAK,SACDwf,EAAQxf,MAAM,uBAAyB,UACvC,MACJ,IAAK,OACDwf,EAAQxf,MAAM,uBAAyB,UACvC,MACJ,IAAK,OACDwf,EAAQxf,MAAM,uBAAyB,UACvC,MACJ,IAAK,aACDwf,EAAQxf,MAAM,uBAAyB,WACvC,MACJ,IAAK,SACDwf,EAAQxf,MAAM,uBAAyB,WACvC,MACJ,QAEIwf,EAAQxf,MAAM,uBAAyB,WAE/C8e,EAAS5V,YAAYsW,EACzB,CAGA,IAAIC,EAAYlW,SAASC,cAAc,OACvCiW,EAAUxa,GAAKlE,KAAKqI,KAAK8U,gBAAkB,IAAMnd,KAAKJ,QAAQyE,SAC9Dqa,EAAUhW,UAAY1I,KAAKqI,KAAK8U,gBAChCY,EAAS5V,YAAYuW,GAGrB,IAAIC,EAAanW,SAASC,cAAc,SACxCkW,EAAWza,GAAKlE,KAAKqI,KAAKmV,WAAa,IAAMxd,KAAKJ,QAAQyE,SAC1Dsa,EAAWjW,UAAY1I,KAAKqI,KAAKmV,WACjCmB,EAAWzS,KAAO,WAClB6R,EAAS5V,YAAYwW,GAGrB,IAAIC,EAAapW,SAASC,cAAc,SACxCmW,EAAWlW,UAAY1I,KAAKqI,KAAKoV,WACjCmB,EAAWlI,QAAUiI,EAAWza,GAChC0a,EAAWzM,UAAY/B,EAAQ,IAAKA,EAAI,iBAAmBA,EAAY,OACvEwO,EAAWzO,MAAQC,EAAI,iBAAmBA,EAAY,QAAKA,EAAQ,GAC/DwO,EAAWvM,iBACXuM,EAAWvM,iBAAiB,SAAS,SAAUpQ,GAC3C0G,EAAKuV,mBAAmBjc,EAC5B,IACO2c,EAAWrM,aAClBqM,EAAWrM,YAAY,WAAW,SAAUtQ,GACxC0G,EAAKuV,mBAAmBjc,EAC5B,IAEJ8b,EAAS5V,YAAYyW,GAErB5e,KAAKkd,UAAY0B,EAEjBrW,EAAIJ,YAAY4V,GAGuB,QAAnC/d,KAAKJ,QAAQsQ,MAAMmM,KAAKE,QACxB4B,EAAUK,MAAMxe,MAIpBA,KAAK2H,UAAYY,CACrB,GAKA,CAAAzB,IAAA,MAAAC,MAIA,WAEI,GADA1H,EAAOE,MAAM,UACRS,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,WAAAC,MAKA,SAAU9H,GACNI,EAAOE,MAAM,aAAcN,GACvBA,GAA0B,WAAjBmb,EAAOnb,IAAsBA,aAAiBgR,IACvDjQ,KAAK+c,OAAS9d,EACde,KAAK+c,OAAO/I,SAAQ,GAE5B,GAEA,CAAAlN,IAAA,YAAAC,MAKA,SAAW0I,GACPpQ,EAAOE,MAAM,cAAekQ,GACxBA,GAA4B,WAAlB2K,EAAO3K,IAAuBA,aAAkByH,IAC1DlX,KAAK8c,QAAUrN,EACfzP,KAAK8c,QAAQ9I,SAAQ,GAE7B,GAEA,CAAAlN,IAAA,YAAAC,MAKA,SAAWiI,GACP3P,EAAOE,MAAM,cAAeyP,GACxBA,GAA4B,WAAlBoL,EAAOpL,IAAuBA,aAAkBwI,IAC1DxX,KAAKgd,QAAUhO,EACfhP,KAAKgd,QAAQhJ,SAAQ,GAE7B,GAEA,CAAAlN,IAAA,aAAAC,MAGA,WAGI,IAAIiI,EAAShP,KAAKgd,QAClB,GAAIhO,EAAQ,CAER,IAAIuH,EAAO,KACPsI,EAAY7e,KAAK2H,UAAU2O,WAC/B,GAAIuI,EAAUzd,OAKV,IAHA,IACI0d,EAAYD,EAD8B,UAAnC7e,KAAKJ,QAAQsQ,MAAMmM,KAAKE,OAAsB,EAAI,GAC9BjG,WAEtBlB,EAAI,EAAGA,EAAI0J,EAAU1d,OAAQgU,IAAK,CACvC,IAAI2J,EAAUD,EAAU1J,IAC+B,IAAnD2J,EAAQ7a,GAAGuV,QAAQzZ,KAAKqI,KAAK8U,mBAC7B5G,EAAOwI,EAEf,CAEJ,GAAIxI,EAAM,CACN,IAAI9P,EAASuI,EAAOgQ,qBAChBvY,IACA8P,EAAKpO,YAAY1B,GAEjBzG,KAAK6c,aAAc,EAE3B,CACJ,CACJ,GAKA,CAAA/V,IAAA,aAAAC,MAMA,SAAYiN,GAER,GADA3U,EAAOE,MAAM,eAAgByU,GACxBhU,KAAKJ,QAAQsQ,MAAM2B,WAMxB,YAHuB,IAAZmC,IACPhU,KAAKid,cAAcpH,QAAW7B,EAAW,UAAY,IAElDhU,KAAKid,cAAcpH,OAC9B,GAEA,CAAA/O,IAAA,WAAAC,MAGA,WACI1H,EAAOE,MAAM,cACbS,KAAKkd,UAAU+B,OACnB,GAEA,CAAAnY,IAAA,UAAAC,MAGA,WACI1H,EAAOE,MAAM,aACRS,KAAKJ,QAAQsQ,MAAM2B,YAGxB7R,KAAKid,cAAcgC,OACvB,GAEA,CAAAnY,IAAA,UAAAC,MAMA,SAASiN,GACL3U,EAAOE,MAAM,YAAayU,GAC1B,IAAI6B,EAAUrN,SAASqL,eAAe7T,KAAKkd,UAAUxG,SAASb,QAa9D,YAZuB,IAAZ7B,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,cAAgB,OACvDhU,KAAK+c,QACL/c,KAAK+c,OAAO/I,QAAQA,GAAW6B,GAE/B7V,KAAK8c,SACL9c,KAAK8c,QAAQ9I,QAAQA,GAAW6B,GAEhC7V,KAAKgd,SACLhd,KAAKgd,QAAQhJ,QAAQA,GAAW6B,IAGjCA,CACX,GAEA,CAAA/O,IAAA,SAAAC,MAMA,SAAQmY,GAOJ,OANA7f,EAAOE,MAAM,WAAY2f,QACH,IAAXA,IACPlf,KAAK2H,UAAUe,UAAawW,EACtBlf,KAAKqI,KAAKV,UACV3H,KAAKqI,KAAKV,UAAY,aAExB3H,KAAK2H,UAAUe,YAAc1I,KAAKqI,KAAKV,SACnD,GAEA,CAAAb,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,qBAAAC,MAMA,SAAoB9E,GAChB5C,EAAOE,MAAM,qBAAsB0C,GAEnC,IAAIiC,EAAKjC,EAAEc,OAAO2T,QAAQI,UAAU7U,EAAEc,OAAO2T,QAAQ+C,QAAQ,MACzD5D,EAAUrN,SAASqL,eAAe5R,EAAEc,OAAO2T,SAASb,QAGpD5T,EAAEc,OAAO2T,UAAY1W,KAAKqI,KAAKgV,gBAAkBnZ,IACjDsE,SAASqL,eAAe7T,KAAKqI,KAAKmV,WAAatZ,GAAI2R,SAAWA,GAE9D5T,EAAEc,OAAO2T,UAAY1W,KAAKqI,KAAKmV,WAAatZ,GAExCsE,SAASqL,eAAe7T,KAAKqI,KAAKgV,gBAAkBnZ,KACpDsE,SAASqL,eAAe7T,KAAKqI,KAAKgV,gBAAkBnZ,GAAI2R,SAAWA,GAKvE7V,KAAK+c,QACL/c,KAAK+c,OAAO/I,SAAS6B,GAErB7V,KAAK8c,SACL9c,KAAK8c,QAAQ9I,SAAS6B,GAItB7V,KAAKgd,SAAWhd,KAAKgd,QAAQmC,cAC7Bnf,KAAKgd,QAAQhJ,SAAS6B,EAE9B,GAEA,CAAA/O,IAAA,0BAAAC,MAUA,SAAyB9E,GACrB5C,EAAOE,MAAM,0BAA2B0C,GACxCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAY3H,MAAMqC,kBAAmB5M,EAC3D,GAEA,CAAA6E,IAAA,qBAAAC,MAUA,SAAoB9E,GAChB5C,EAAOE,MAAM,qBAAsB0C,GACnCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAY3H,MAAMsC,aAAc7M,EACtD,GAEA,CAAA6E,IAAA,sBAAAC,MAUA,SAAqB9E,GACjB5C,EAAOE,MAAM,sBAAuB0C,GACpCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAY3H,MAAMuC,cAAe9M,EACvD,I,4FAAC,CAnkBM,GAukBX,U,ssBAGIV,OAAOvC,IAAMuC,OAAOvC,GAAGC,QAClBsC,OAAOvC,GAAGC,MAAMmV,SACjB7S,OAAOvC,GAAGC,MAAMmV,OAAS,CAAC,GAE9B7S,OAAOvC,GAAGC,MAAMmV,OAAOkI,MAAQA,GChoBnC,IAAIjd,EAAS2Q,EAAAA,EAAO1Q,UAAU,gBAyK9B,QAtJW,WAmBP,O,EAjBA,SAAA8f,EAAaxf,GAQT,G,4FARkB0G,CAAA,KAAA8Y,GAClB/f,EAAOE,MAAM,sBAAuBK,GAGpCI,KAAKJ,QAAUA,GAAW,CACtB,IAGEI,gBAAgBof,GAClB,MAAM,IAAInb,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAEA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIb/C,KAAKJ,QAAQuQ,QAEdnQ,KAAKJ,QAAQuQ,MAAQ,6BAIY,IAA1BnQ,KAAKJ,QAAQyf,WACpBrf,KAAKJ,QAAQyf,UAAW,GAG5Brf,KAAK2H,UAAY,KAGjB3H,KAAKqI,KAAO,CACRtF,OAAS,4BACT4E,UAAY,+BACZ2X,QAAU,6BACVC,QAAU,6BAElB,GAEA,CAAAzY,IAAA,iBAAAC,MAQA,WACI,IAAIwB,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAK1B,IAAI2X,EAAU9W,SAASC,cAAc,WACrC6W,EAAQ5W,UAAY1I,KAAKqI,KAAKiX,QAC9BA,EAAQnd,MAAQnC,KAAKJ,QAAQyf,SAC7B9W,EAAIJ,YAAYmX,GAEhB,IAAIC,EAAU/W,SAASC,cAAc,WACrC8W,EAAQ7W,UAAY1I,KAAKqI,KAAKkX,QAC9BA,EAAQpN,UAAYnS,KAAKJ,QAAQuQ,MACjCmP,EAAQnX,YAAYoX,GAGpBvf,KAAK2H,UAAYY,CACrB,GAKA,CAAAzB,IAAA,MAAAC,MAGA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CACI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,UAE7C,GAEA,CAAAb,IAAA,UAAAC,MAKA,SAASiN,GACLhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,MACxD,GAEA,CAAAlN,IAAA,eAAAC,MAKA,WACI,IAAIqP,EAAQpW,KAAK2H,UAAU2O,WAC3B,OAAIF,EAAMhV,OAECgV,EAAM,GAGVpW,KAAK2H,SAChB,GAKA,CAAAb,IAAA,wBAAAC,MAQA,SAAuB9E,GACnB5C,EAAOE,MAAM,wBAAyB0C,GACtCA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYhF,MAAMC,WAAYnN,EACpD,I,4FAAC,CAlJM,G,ssBClBX,IAAI5C,EAAS2Q,EAAAA,EAAO1Q,UAAU,iBAmN9B,QA3LY,WAuBR,O,EArBA,SAAAkgB,EAAa5f,GAYT,G,4FAZkB0G,CAAA,KAAAkZ,GAClBngB,EAAOE,MAAM,uBAAwBK,GAGrCI,KAAKJ,QAAUA,GAAW,CAEtBmD,OAAS,KACTmN,MAAQ,KACRC,MAAQ,KACRC,IAAM,QAGJpQ,gBAAgBwf,GAClB,MAAM,IAAIvb,UAAU,2BAGxBjE,KAAKqQ,cAELrQ,KAAKsQ,gBACT,E,EAEA,EAAAxJ,IAAA,cAAAC,MAMA,WAEI/G,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM,KAExBlE,KAAKJ,QAAQmD,OAIlB,IAAIwN,EAAgB,CAAC,EAEhBvQ,KAAKJ,QAAQsQ,QACdlQ,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,GAEhDvQ,KAAKJ,QAAQwQ,MAEdpQ,KAAKJ,QAAQwQ,IAAM,CAAC,GAGnBpQ,KAAKJ,QAAQuQ,QACdnQ,KAAKJ,QAAQuQ,MAAQ,0BAEzBnQ,KAAK2H,UAAY,KAGjB3H,KAAKqI,KAAO,CACRtF,OAAS,6BACT4E,UAAY,gCAGpB,GAEA,CAAAb,IAAA,iBAAAC,MAUA,WAGI,IAAI0Y,EAAUjc,KAAKC,MAAMD,KAAKqC,UAAU7F,KAAKJ,QAAQwQ,MAEjDqP,EAAQC,QACsB,IAA1BD,EAAQC,OAAOte,QACf/B,EAAOuS,KAAK,2BAIpB,IAAIrJ,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY1I,KAAKqI,KAAKV,UAY1B3H,KAAK2H,UAAYY,CACrB,GAKA,CAAAzB,IAAA,MAAAC,MAIA,WACI,IAAK/G,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAIwF,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAKtF,QACRyF,SAASsL,iBAChBtL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASuL,qBAAqB,QAAQ,IACrC5L,YAAYI,EACrB,CACAvI,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CAIA,OAHI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAElC3H,IACX,GAEA,CAAA8G,IAAA,UAAAC,MAMA,SAASiN,GAKL,OAJA3U,EAAOE,MAAM,YAAayU,QACH,IAAZA,IACPhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,OAAS,QAEf,SAAjChU,KAAK2H,UAAU1I,MAAM+U,OACjC,GAEA,CAAAlN,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAKA,CAAAb,IAAA,6BAAAC,MAUA,SAA4B9E,GACxB5C,EAAOE,MAAM,6BAA8B0C,GAC3CA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYtE,OAAOC,SAAU7N,EACnD,GAEA,CAAA6E,IAAA,mCAAAC,MAUA,SAAkC9E,GAC9B5C,EAAOE,MAAM,mCAAoC0C,GACjDA,EAAEgS,SAAWjU,KAAKkE,GAClBjC,EAAEpC,KAAOG,KAAKJ,QACdsU,IAAAA,SAAkBC,EAAYtE,OAAOE,eAAgB9N,EACzD,I,4FAAC,CAvLO,GChBZ,QAbgB,CAOZ0d,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,G,ssBCWJ,IAAI7E,GAAS2Q,EAAAA,EAAO1Q,UAAU,UA2HxBugB,GAAM,WAiBR,O,EAfA,SAAAA,EAAajgB,GAQT,G,4FARkB0G,CAAA,KAAAuZ,GAClBxgB,GAAOE,MAAM,uBAAwBK,GAGrCI,KAAKJ,QAAUA,GAAW,CACtB,IAGEI,gBAAgB6f,GAClB,MAAM,IAAI5b,UAAU,2BAGxBjE,KAAKqQ,aACT,G,EAEA,EAAAvJ,IAAA,cAAAC,MAMA,WAMI,GAJK/G,KAAKJ,QAAQmD,QACd1D,GAAOuS,KAAK,sDAGX5R,KAAKJ,QAAQX,MAAlB,CAKIe,KAAKJ,QAAQkgB,OACb9f,KAAK+f,cAEL1gB,GAAOmU,KAAK,4DAGXxT,KAAKJ,QAAQ8P,QACdrQ,GAAOuS,KAAK,gEAIhB,IAAIrB,EAAgB,CAChBb,QAAS,EACTgQ,QAAS,EACT7P,QAAS,EACT5Q,OAAQ,EACRwQ,QAAS,EACTT,QAAS,EACTG,OAAQ,EACR6Q,WAAY,EACZ1F,MAAO,EACP2F,OAAS,KACTC,UAAY,MACZ/P,OAAQ,EACRkP,cAAWc,EACXjU,MAAO,EACPsQ,KAAM,EACN3K,YAAa,EACbwK,KAAO,CACHtH,OAAQ,EACRwH,OAAS,OAEb7E,UAAW,GAGV1X,KAAKJ,QAAQsQ,QACd7Q,GAAOE,MAAM,6DACbS,KAAKJ,QAAQsQ,MAAQK,GAGzBE,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAAQsQ,MAAOK,GAAe,GAGrDvQ,KAAKkE,GAAKlE,KAAKJ,QAAQsE,IAAM+Q,EAAAA,EAAGC,WAGhClV,KAAK+K,QAAU,CAAC,EAEhB/K,KAAK0f,OAAS,GAEd1f,KAAK2H,UAAY,KAEjB3H,KAAKqI,KAAO,CACRtF,OAAS,uBACT4E,UAAY,0BACZyY,YAAc,8BACdC,gBAAkB,gCAClBC,YAAc,4BACdC,cAAgB,gCAChBC,YAAc,4BACdC,cAAgB,gCAChBC,IAAM,qBAGV1gB,KAAK2gB,OAAS,CAAC,EAWf3gB,KAAKyX,QAAU,CAAC,CA7EhB,MAFIpY,GAAOqB,MAAM,0DAgFrB,GAEA,CAAAoG,IAAA,cAAAC,MAgBA,WACI,IAAI6Z,EAAM5gB,KAAKJ,QAAQG,OAASC,KAC5B8f,EAAS9f,KAAKJ,QAAQkgB,OAC1B,GAAIA,EACA,IAAK,IAAIe,KAASf,EACd,GAAIA,EAAOpV,eAAemW,GAAQ,CAC9B,IAAIC,EAAUhB,EAAOe,GAEjBC,IACK5M,IAAAA,iBAA0B2M,EAAOC,EAASF,IAC3C1M,IAAAA,iBAA0B2M,EAAOC,EAASF,GAGtD,CAGZ,GAEA,CAAA9Z,IAAA,iBAAAC,MAyBA,WACI1H,GAAOE,MAAMS,KAAK2gB,QAgBlB,IAAIpY,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAKqI,KAAK+X,YAAcpgB,KAAKkE,GACtCqE,EAAIG,UAAY1I,KAAKqI,KAAKV,UAG1B,IAAIoZ,EAAe/gB,KAAKJ,QAAQsQ,MAAMR,OACtC,GAAIqR,GAAgB/gB,KAAKJ,QAAQ8P,OAAQ,CAErC,GAAI1P,KAAKJ,QAAQsQ,MAAMC,MAAO,CAC1B,IAAIqQ,EAAchY,SAASC,cAAc,OACzC+X,EAAYtc,GAAKlE,KAAKqI,KAAKoY,cAAgBzgB,KAAKkE,GAChDsc,EAAY9X,UAAY1I,KAAKqI,KAAKmY,YAClCA,EAAYrO,UAAY,qBACxB5J,EAAIJ,YAAYqY,EACpB,CAGa,IAAInM,EAAO,CACpBnQ,GAAKlE,KAAKkE,GACVnB,OAASwF,EACT2H,MAAiC,WAAxBkK,EAAO2G,GAA6BA,EAAe,CAAC,EAC7D3Q,IAAMpQ,KAAKJ,QAAQ8P,SAEhBsR,KACX,CAaA,IAAK,IAAIpE,KAVL5c,KAAKJ,QAAQsQ,MAAML,QACN,IAAI2P,EAAO,CACpBtb,GAAKlE,KAAKkE,GACVnB,OAASwF,EACT2H,MAAQ,CAAC,EACTE,IAAMpQ,KAAK2gB,OAAOjB,SAEfsB,MAGQhhB,KAAK2gB,OAAOM,QAC3B,GAAIjhB,KAAK2gB,OAAOM,QAAQvW,eAAekS,GAAS,CAC5C,GAAI5c,KAAKJ,QAAQsQ,MAAMwP,OAAQ,CAE3B,IAAIwB,EAAgBhgB,OAAOC,KAAKnB,KAAK2gB,OAAOM,SAAS7f,OAAS,EAAK,EAAI,EACvE,GAAI8f,EAAc,CACd,IAAIC,EAAK3Y,SAASC,cAAc,MAChC0Y,EAAGzY,UAAY1I,KAAKqI,KAAKqY,IACzBnY,EAAIJ,YAAYgZ,EACpB,CAEA,GAAInhB,KAAKJ,QAAQsQ,MAAMC,MAAO,CAC1B,IAAImQ,EAAc9X,SAASC,cAAc,OACzC6X,EAAYpc,GAAKlE,KAAKqI,KAAKkY,cAAgBvgB,KAAKkE,GAChDoc,EAAY5X,UAAY1I,KAAKqI,KAAKiY,YAClCA,EAAYnO,UAAa+O,EAAgB,wBAA0BtE,EAAS,IAAM,sBAClFrU,EAAIJ,YAAYmY,EACpB,CACJ,CAGA,IAAIc,EAAUphB,KAAK2gB,OAAOjB,OAAOzR,QAoBjC,GAhBAmT,EAAQxX,SAAQ,SAAU4C,EAAO6U,GAM7B,IAAIC,EAAY9U,EAAgB,SAC5B8U,EACAA,EAAU,oBAAsBD,EAEhC7U,EAAgB,SAAI,CAChB,mBAAqB6U,EAGjC,IAEIrhB,KAAKJ,QAAQsQ,MAAMoK,KAAM,CACzB,IAAI2F,EAASjgB,KAAKJ,QAAQsQ,MAAM+P,OAC5BC,EAAYlgB,KAAKJ,QAAQsQ,MAAMgQ,UAkCnCkB,EAAQ9G,MAjCM,SAAUC,EAAGC,GAGvB,IAAIvP,EAAS,EACb,GAAIsP,EAAY,UACZA,EAAY,SAAE,qBACdC,EAAY,UACZA,EAAY,SAAE,oBAAqB,CACnC,IACI+G,EADAC,EAAO,KAEXA,EAAOjH,EAAY,SAAE,oBACrBgH,EAAO/G,EAAY,SAAE,oBACrBvP,EAASuW,EAAKC,cAAcF,EAChC,MACI,OAAQtB,GACJ,IAAK,OACDhV,EAAuB,QAAdiV,EAAsB3F,EAAErO,KAAKuV,cAAcjH,EAAEtO,OAASqO,EAAErW,GAAGud,cAAcjH,EAAEtW,IAC9EsW,EAAEtO,KAAKuV,cAAclH,EAAErO,OAASsO,EAAEtW,GAAGud,cAAclH,EAAErW,IAC3D,MACJ,IAAK,QACD+G,EAAuB,QAAdiV,EAAsB3F,EAAE,gBAAgBkH,cAAcjH,EAAE,kBAAoBD,EAAErW,GAAGud,cAAcjH,EAAEtW,IACpGsW,EAAE,gBAAgBiH,cAAclH,EAAE,kBAAoBC,EAAEtW,GAAGud,cAAclH,EAAErW,IACjF,MAEJ,QAEI+G,EAAuB,QAAdiV,EAAsB3F,EAAErW,GAAGud,cAAcjH,EAAEtW,IAAMsW,EAAEtW,GAAGud,cAAclH,EAAErW,IAI3F,OAAO+G,CACX,GAGJ,CAEA5L,GAAOE,MAAM,YAAa6hB,GAG1B,IAAIM,EAAU1hB,KAAKJ,QAAQsQ,MAAM+P,OAC7BD,EAAYhgB,KAAKJ,QAAQsQ,MAAM8P,UAC/B2B,EAAU,CAAC,EACfP,EAAQxX,SAAQ,SAAU4C,GAMtB,IAAI8U,EAAY9U,EAAgB,SAGhC,GAAI8U,GAAaA,EAAU,oBAAqB,CAC5C,IAAIM,EAAaN,EAAU,oBAC3BK,EAAQC,GAAeD,EAAQC,GACzBD,EAAQC,GAAc,EAAI,CACpC,KAAO,CACH,IAAIC,EAAS,KACb,OAAQH,GACJ,IAAK,QACDG,EAASrV,EAAM,gBACf,MACJ,IAAK,OACDqV,EAASrV,EAAMN,KACf,MAEJ,QACI2V,EAASrV,EAAMtI,GAGvB,IAAI4d,EAAgBD,EACpB,GAAI7B,EAAW,CAEX,IAGI+B,EAAOF,EAAOhS,OAHL,WAKbiS,GAA2B,IAAVC,EAAeF,EAAO/K,UAAU,EAAGiL,GAAMC,OAASH,CACvE,CAEAF,EAAQG,GAAkBH,EAAQG,GAC5BH,EAAQG,GAAiB,EAAI,EAG/BR,EACAA,EAAU,oBAAsBQ,EAEhCtV,EAAgB,SAAI,CAChB,mBAAqBsV,EAGjC,CACJ,IAEAziB,GAAOE,MAAM,YAAaoiB,GAG1B,IAIIrC,EAJA2C,EAAYzZ,SAASC,cAAc,OAKvC,GAJAwZ,EAAUvZ,UAAY1I,KAAKqI,KAAKgY,gBAChC9X,EAAIJ,YAAY8Z,QAGoB9B,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAAwB,EAC3CC,EAAU9W,SAASC,cAAc,YACzBC,UAAY,GACpB4W,EAAQnd,MAAQnC,KAAKJ,QAAQsQ,MAAMmP,SACnC4C,EAAU9Z,YAAYmX,GAEtB,IAAIC,EAAU/W,SAASC,cAAc,WACrC8W,EAAQ7W,UAAY,GACpB6W,EAAQpN,UAAY,GACpBmN,EAAQnX,YAAYoX,EACxB,CAyBA,IAtBA,IAAIxc,OAA0Cod,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAA0BC,EAAU2C,EAqBjEhZ,GAAS,EACJiZ,EAAK,EAAGA,EAAKd,EAAQhgB,OAAQ8gB,IAAM,CACxC,IAAIriB,EAAOuhB,EAAQc,GAInB,GAHAjZ,IAGIpJ,EAAK+c,SAAWA,EAAQ,CAKxB,GAAI5c,KAAKJ,QAAQsQ,MAAMf,OAASnP,KAAKJ,QAAQsQ,MAAMoK,KAI/C,GAHUza,EAAKsiB,SAGN,CACL,IAAIC,EAAMviB,EAAKsiB,SAAS,oBACxB,GAAIC,EAEA,GAAIT,EAAQS,GAAO,EAAG,CAElBT,EAAQS,IAAQ,EAEhB,IAAIC,EAAS,IAAIjD,EAAM,CACnBlb,GAAKlE,KAAKkE,GACVnB,YAA0Cod,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAA0BC,EAAU2C,EACjE9R,MAAQiS,EACR/C,UAAW,IAEfgD,EAAOrB,MAEPje,EAASsf,EAAOC,cACpB,MAA4B,IAAjBX,EAAQS,KAGfrf,OAA0Cod,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAA0BC,EAAU2C,QAKrElf,OAA0Cod,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAA0BC,EAAU2C,CAEzE,MACIlf,OAA0Cod,IAAhCngB,KAAKJ,QAAQsQ,MAAMmP,SAA0BC,EAAU2C,EAIzE,GAAIjiB,KAAKJ,QAAQsQ,MAAMwP,OAAQ,CAC3B,IAAI6C,EAAS,IAAIjG,EAAM,CACnBpY,GAAKlE,KAAKkE,GACVnB,OAASA,EACTsB,SAAW4E,EAAQ,IAAMjJ,KAAKkE,GAC9BgM,MAAQ,CACJ2B,WAAa7R,KAAKJ,QAAQsQ,MAAM2B,WAChCwK,KAAOrc,KAAKJ,QAAQsQ,MAAMmM,KAC1BnQ,KAAOlM,KAAKJ,QAAQsQ,MAAMhE,KAC1BsQ,IAAMxc,KAAKJ,QAAQsQ,MAAMsM,KAE7BpM,IAAM,CACFlM,GAAKrE,EAAKqE,GACVgI,KAAOrM,EAAKqM,KACZ0Q,OAAS/c,EAAK+c,OACd,eAAiB/c,EAAK,mBAG9B0iB,EAAOvB,MAEHnhB,EAAK+Q,QAAU/Q,EAAK+Q,OAAOiB,YAAyC,SAA3BhS,EAAK+Q,OAAOiB,YACrD0Q,EAAO1Q,YAAW,GAGtB7R,KAAK0f,OAAO9Z,KAAK2c,EACrB,CAEA,GAAIviB,KAAKJ,QAAQsQ,MAAMlB,OAAQ,CAG3B,IAAImQ,EAAanf,KAAKJ,QAAQsQ,MAAMwH,cACV,IAAfyH,IACPA,EAAatf,EAAK6X,UAEtB,IAAIsF,EAAU,IAAIxF,EAAO,CACrBtT,GAAKlE,KAAKkE,GACVnB,OAASA,EACT0U,QAAUzX,KAAKyX,QACfrH,IAAM,CACFlM,GAAKrE,EAAKqE,GACV0Y,OAAS/c,EAAK+c,OACdzM,MAAQtQ,EAAKqE,GACbwT,cAAkC,IAAfyH,GAA8BA,EACjDxO,MAAQ9Q,EAAK8Q,MACbC,OAAS/Q,EAAK+Q,UAGtBoM,EAAQgE,MACRhE,EAAQhJ,SAAQ,GACZuO,IACAA,EAAOC,UAAUxF,GACjBuF,EAAOE,aAEf,CAEA,GAAIziB,KAAKJ,QAAQsQ,MAAMjR,MAAO,CAC1B,IAAI8d,EAAS,IAAI9M,EAAM,CACnB/L,GAAKlE,KAAKkE,GACVnB,OAASA,EACTsB,SAAW4E,EAAQ,IAAMjJ,KAAKkE,GAC9BkM,IAAM,CACFlM,GAAKrE,EAAKqE,GACV0Y,OAAS/c,EAAK+c,OACdhM,OAAS/Q,EAAK+Q,OACdD,MAAQ9Q,EAAK8Q,SAGrBoM,EAAOiE,MACPjE,EAAO/I,SAAQ,GACXuO,GACAA,EAAOG,SAAS3F,GAGhBld,EAAK+Q,QAAU/Q,EAAK+Q,OAAOiB,YAAyC,SAA3BhS,EAAK+Q,OAAOiB,YACrD0Q,EAAO1Q,YAAW,EAE1B,CAEA,GAAI7R,KAAKJ,QAAQsQ,MAAMT,OAAQ,CAC3B,IAAIqN,EAAU,IAAI5F,EAAO,CACrBhT,GAAKlE,KAAKkE,GACVnB,OAASA,EACTsB,SAAW4E,EAAQ,IAAMjJ,KAAKkE,GAC9BkM,IAAM,CACFlM,GAAKrE,EAAKqE,GACV0Y,OAAS/c,EAAK+c,OACdnN,OAAS5P,EAAKqX,UAGtB4F,EAAQkE,MACRlE,EAAQ9I,SAAQ,GACZuO,GACAA,EAAOI,UAAU7F,EAEzB,CACJ,MAGQ7T,GAAS,GACTA,GAGZ,CACJ,CAOJ,GAHAjJ,KAAK2H,UAAYY,GAGZvI,KAAKJ,QAAQmD,OAAQ,CACtB,IAAKyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,QAAS,CAC5C,IAAI6f,EAAUpa,SAASC,cAAc,OACrCma,EAAQ1e,GAAKlE,KAAKqI,KAAKtF,QACZyF,SAASuL,qBAAqB,QAAQ,IAC7CvL,SAASuL,qBAAqB,QAAQ,IACtCvL,SAASsL,iBACR3L,YAAYya,EACrB,CACA5iB,KAAKJ,QAAQmD,OAASyF,SAASqL,eAAe7T,KAAKqI,KAAKtF,OAC5D,CACI/C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,WAGzCuM,IAAAA,SAAkB2O,EAAMjU,SAAU5O,KACtC,GAEA,CAAA8G,IAAA,cAAAC,MAQA,SAAa0Q,GACT,IAoBQqL,EApBJna,EAAO3I,KAKX,OAAIyX,GAAWA,EAAQsL,WAAW,aACvB,IAAIjiB,SAAQ,SAACC,EAASC,GACzB3B,GAAOqB,MAAM,kCACbK,EAAQ4H,EACZ,IAGC8O,EAsEE3W,QAAQkiB,IAAI,EA9DXF,EAAerL,EAAU,OACtBwL,MAAMH,EAAc,CACvBI,YAAc,gBAEb5iB,MAAK,SAAUC,GACZ,GAAIA,EAASqB,GACT,OAAOrB,EAAS4iB,OACX7iB,MAAK,SAAU6iB,GACZxa,EAAK8O,QAAQjY,IAAMsjB,EAEnB,IAAIM,EAAW,IAAIC,MAEnB,OADAD,EAASnN,IAAM6M,EACRM,EAASE,SACXhjB,MAAK,WACFqI,EAAK8O,QAAQmC,KAAO,CAAC,EACrBjR,EAAK8O,QAAQmC,KAAKE,EAAIsJ,EAASra,OAC/BJ,EAAK8O,QAAQmC,KAAKC,EAAIuJ,EAAStL,KACnC,GACR,IAAE,OACK,SAAApX,GACHrB,GAAOmU,KAAK,kCAAmC9S,EACnD,IAGJ,MADU,IAAIjB,MAAM,qBAAuBc,EAASyB,OAG5D,IAAE,OACK,SAAAtB,GACH,OAAO,IAAII,SAAQ,SAACC,EAASC,GACzB3B,GAAOqB,MAAM,kCAAmCA,GAChDM,EAAON,EACX,GACJ,KAIGuiB,MADWxL,EAAU,QACF,CACtByL,YAAc,gBAEb5iB,MAAK,SAAUC,GACZ,GAAIA,EAASqB,GACT,OAAOrB,EAASuR,OACXxR,MAAK,SAAUwR,GACZnJ,EAAK8O,QAAQ3F,KAAOA,CACxB,IAAE,OACK,SAAApR,GACHrB,GAAOmU,KAAK,iCAAkC9S,EAClD,IAGJ,MADU,IAAIjB,MAAM,qBAAuBc,EAASyB,OAG5D,IAAE,OACK,SAAAtB,GACH,OAAO,IAAII,SAAQ,SAACC,EAASC,GACzB3B,GAAOqB,MAAM,iCAAkCA,GAC/CM,EAAON,EACX,GACJ,MAjEG,IAAII,SAAQ,SAACC,EAASC,GACzB3B,GAAOqB,MAAM,gCACbK,EAAQ4H,EACZ,GAsER,GAKA,CAAA7B,IAAA,gBAAAC,MAKA,WACI,IAAI4B,EAAO3I,KAEX,MAAkC,WAA9Boa,EAAOpa,KAAKJ,QAAQX,QACpBe,KAAK2gB,OAAS3gB,KAAKJ,QAAQX,MAEvBe,KAAKJ,QAAQsQ,MAAMlB,OACZhP,KAAKujB,YAAYvjB,KAAK2gB,OAAO6C,QAC/BljB,MAAK,WAGF,OADAqI,EAAK2H,iBACE3H,CACX,IAAE,OACK,SAAAjI,GACHrB,GAAOmU,KAAK,4BAA6B9S,EAC7C,IAEG,IAAII,SAAQ,SAACC,EAASC,GACzB2H,EAAK2H,iBACLvP,EAAQ4H,EACZ,KAK0B,iBAAvB3I,KAAKJ,QAAQX,MACbgkB,MAAMjjB,KAAKJ,QAAQX,MAAO,CAC7BikB,YAAc,gBAEb5iB,MAAK,SAAAC,GAEF,OAAOA,EAASuR,OACXxR,MAAK,SAAArB,GACF0J,EAAKgY,OAAS1hB,CAClB,IACCqB,MAAK,WAEF,OAAIqI,EAAK/I,QAAQsQ,MAAMlB,OACZrG,EAAK4a,YAAY5a,EAAKgY,OAAO6C,QAC/BljB,MAAK,WAGF,OADAqI,EAAK2H,iBACE3H,CACX,IAAE,OACK,SAAAjI,GACHrB,GAAOmU,KAAK,4BAA6B9S,EAC7C,IAEG,IAAII,SAAQ,SAACC,EAASC,GACzB2H,EAAK2H,iBACLvP,EAAQ4H,EACZ,GAER,IAAE,OACK,SAAAjI,GACHrB,GAAOqB,MAAM,mBAAoBA,EACrC,GACR,IAAE,OACK,SAAAA,GACHrB,GAAOqB,MAAM,oBAAqBA,EACtC,SAnCR,CAqCJ,GAEA,CAAAoG,IAAA,UAAAC,MAKA,SAASiN,GACLhU,KAAK2H,UAAU1I,MAAM+U,QAAWA,EAAW,QAAU,MACzD,GAAC,CAAAlN,IAAA,aAAAC,MAED,SAAYD,EAAKC,GACb/G,KAAK+K,QAAQjE,GAAOC,CACxB,GAAC,CAAAD,IAAA,aAAAC,MAED,SAAYD,GACR,OAAO9G,KAAK+K,QAAQjE,EACxB,GAKA,CAAAA,IAAA,QAAAC,MAIA,WACI,OAAO/G,KAAKkE,EAChB,GAEA,CAAA4C,IAAA,eAAAC,MAIA,WACI,OAAO/G,KAAK2H,SAChB,GAEA,CAAAb,IAAA,WAAAC,MAIA,WACI,OAAO/G,KAAK2gB,MAChB,GAEA,CAAA7Z,IAAA,gBAAAC,MAKA,SAAeqO,GAIX,IAHA,IAAI5I,EAAQ,KAERtI,EADIlE,KAAKyjB,SAASrO,GACXxV,QAAQwQ,IAAIlM,GACdyB,EAAI,EAAGA,EAAI3F,KAAK2gB,OAAOjB,OAAOte,OAAQuE,IAAK,CAChD,IAAI+d,EAAI1jB,KAAK2gB,OAAOjB,OAAO/Z,GAC3B,GAAI+d,EAAExf,KAAOA,EAAI,CACbsI,EAAQkX,EACR,KACJ,CACJ,CACA,OAAOlX,CACX,GAEA,CAAA1F,IAAA,oBAAAC,MAKA,SAAmBqO,GAGf,IAFA,IAAI5I,EAAQ,KACRkX,EAAI1jB,KAAK2gB,OAAOjB,OAAOtK,GAClBzP,EAAI,EAAGA,EAAI3F,KAAK2jB,YAAYviB,OAAQuE,IAAK,CAC9C,IAAIie,EAAI5jB,KAAKyjB,SAAS9d,GACtB,GAAI+d,EAAExf,KAAO0f,EAAEhkB,QAAQwQ,IAAIlM,GAAI,CAC3BsI,EAAQoX,EACR,KACJ,CACJ,CACA,OAAOpX,CACX,GAEA,CAAA1F,IAAA,YAAAC,MAKA,WACI,OAAO/G,KAAK0f,MAChB,GAEA,CAAA5Y,IAAA,WAAAC,MAMA,SAAUqO,GACN,OAAOpV,KAAK0f,OAAOtK,EACvB,M,yFAAC,CA/0BO,GAo1BZ3E,EAAAA,EAAMiI,OAAOmH,GAAO1a,UAAW0e,GAM/B,YAGItiB,OAAOvC,IAAMuC,OAAOvC,GAAGC,QACvBsC,OAAOvC,GAAGC,MAAM4gB,OAASA,G,wHCx6B7B,SAASiE,EAASC,GACd,KAAM/jB,gBAAgB8jB,GAClB,MAAM,IAAI7f,UAAU,IAAEgG,WAAW,oBAAqB,YAO1DjK,KAAKkF,UAAY,UAEjBlF,KAAKX,OAAS,IAAOC,UAAU,uBAC/BU,KAAKX,OAAOE,MAAM,oCAElB,IAAIK,EAAUI,KAAKgkB,qBAAqBD,GAQxC,GAPKnkB,EAAQkM,YACTlM,EAAQkM,UAAY,IAAkBgY,QAAQG,UAIlD,IAAczF,MAAMxe,KAAM,CAACJ,KAEtBA,EAAQ8K,eAAe,SACxB,MAAM,IAAIjL,MAAM,IAAEwK,WAAW,gBAAiB,UAWlD,GAPAjK,KAAKJ,QAAQskB,MAAQtkB,EAAQskB,MAGxBtkB,EAAQqJ,QACTjJ,KAAKJ,QAAQqJ,MAAQrJ,EAAQqJ,MAAQ,iBAGrCrJ,EAAQukB,QAER,IADA,IAAI1U,EAASvO,OAAOC,KAAKvB,EAAQukB,SACxB/O,EAAI,EAAGA,EAAI3F,EAAOrO,OAAQgU,IAAK,CACpC,IAAItO,EAAM2I,EAAO2F,SAEmB,IAAzBxV,EAAQukB,QAAQrd,IACU,iBAAzBlH,EAAQukB,QAAQrd,IAAkE,IAA7C5F,OAAOC,KAAKvB,EAAQukB,QAAQrd,IAAM1F,QAC9C,iBAAzBxB,EAAQukB,QAAQrd,IAAqD,IAAhClH,EAAQukB,QAAQrd,GAAK1F,QACjEoI,MAAM4E,QAAQxO,EAAQukB,QAAQrd,KAAyC,IAAhClH,EAAQukB,QAAQrd,GAAK1F,gBAEtDpB,KAAKJ,QAAQukB,QAAQrd,EAEpC,CAGJ9G,KAAKJ,QAAQqJ,MAAQrJ,EAAQqJ,OAAS,gBACtCjJ,KAAKJ,QAAQwkB,iBAAmBxkB,EAAQwkB,kBAAoB,EAChE,CAKAN,EAAQ3e,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAG3D,GAKA2e,EAAQ3e,UAAUC,YAAc0e,EAQhCA,EAAQ3e,UAAU6e,qBAAuB,SAAUD,GAC/C,MAAMnkB,EAAUmkB,EAmEhB,OAjEInkB,EAAQ8K,eAAe,cACvB1K,KAAKX,OAAOmU,KAAK,0CAEZ5T,EAAQskB,QACTtkB,EAAQskB,MAAQtkB,EAAQ8O,iBAErB9O,EAAQ8O,UAGf9O,EAAQ0kB,gBACRtkB,KAAKX,OAAOmU,KAAK,+CAEZ5T,EAAQukB,UACTvkB,EAAQukB,QAAUvkB,EAAQ0kB,cAEtB1kB,EAAQukB,QAAQjY,OAChBlM,KAAKX,OAAOmU,KAAK,oDACZ5T,EAAQqJ,QACLO,MAAM4E,QAAQxO,EAAQukB,QAAQjY,OAAStM,EAAQukB,QAAQjY,KAAK9K,OAAS,EACrExB,EAAQqJ,MAAQrJ,EAAQukB,QAAQjY,KAAK,GAErCtM,EAAQqJ,MAAQrJ,EAAQukB,QAAQjY,aAGjCtM,EAAQukB,QAAQjY,MAGvBtM,EAAQukB,QAAQI,OAChBvkB,KAAKX,OAAOmU,KAAK,2DACV5T,EAAQukB,QAAQI,cAGxB3kB,EAAQ0kB,eAGf1kB,EAAQyE,WACJzE,EAAQyE,SAASiB,IACjBtF,KAAKX,OAAOmU,KAAK,4CAEZ5T,EAAQyE,SAASmgB,MAClB5kB,EAAQyE,SAASmgB,IAAM5kB,EAAQyE,SAASiB,UAErC1F,EAAQyE,SAASiB,GAGxB1F,EAAQyE,SAASkB,IACjBvF,KAAKX,OAAOmU,KAAK,4CAEZ5T,EAAQyE,SAASogB,MAClB7kB,EAAQyE,SAASogB,IAAM7kB,EAAQyE,SAASkB,UAErC3F,EAAQyE,SAASkB,IAI5B3F,EAAQ8kB,iBACR1kB,KAAKX,OAAOmU,KAAK,uDACV5T,EAAQ8kB,gBAGf9kB,EAAQ2E,MACRvE,KAAKX,OAAOmU,KAAK,4CACV5T,EAAQ2E,KAGZ3E,CACX,EAQAkkB,EAAQ3e,UAAUoG,aAAe,SAAU7K,EAAO8K,GAC9C,IAAI5L,EAAU,CACV2K,WAAavK,KAAKJ,QAAQ2K,WAE1Boa,cAAgB,SAChBT,MAAQlkB,KAAKJ,QAAQskB,MACrBjb,MAAQjJ,KAAKJ,QAAQqJ,MACrB2b,mBAAqB5kB,KAAKJ,QAAQglB,mBAClCvgB,SAAWrE,KAAKJ,QAAQyE,SACxBwgB,QAAU7kB,KAAKJ,QAAQwkB,iBACvBD,QAAUnkB,KAAKJ,QAAQukB,SAG3BnkB,KAAK8K,QAAU,IAAsBga,MAAMllB,GAGzCI,KAAK8K,QAEDU,EAAQrM,KAAKa,KAAMA,KAAK8K,SADxBpK,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,0BAEzD,EAQA6Z,EAAQ3e,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GAgBjD,GAAIxL,KAAKO,SAAU,CACf,IAAIX,EAAU,CACVW,SAAWP,KAAKO,SAChBiK,YAAcxK,KAAKJ,QAAQ4K,YAC3BW,QAAUzK,EACV+J,UAAYe,EACZzL,MAAQC,MAGZ,IAAuB8kB,MAAMllB,EACjC,MACIc,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,2BAEvD,EAEA,S,wHC3MA,SAAS8a,EAAMnlB,GACX,KAAMI,gBAAgB+kB,GAClB,MAAM,IAAI9gB,UAAU,IAAEgG,WAAW,oBAAqB,SAmB1D,GAZAjK,KAAKkF,UAAY,OAGjB,IAAcsZ,MAAMxe,KAAM+N,WAE1B/N,KAAKX,OAAS,IAAOC,UAAU,oBAC/BU,KAAKX,OAAOE,MAAM,kCAMbK,EAAQolB,UACT,MAAM,IAAIvlB,MAAM,IAAEwK,WAAW,gBAAiB,cAGlD,GAAiC,IAA7BrK,EAAQolB,UAAU5jB,OAClB,MAAM,IAAI3B,MAAM,IAAEwK,WAAW,cAAe,cAiChD,GA7BAjK,KAAKJ,QAAQolB,UAAYplB,EAAQolB,UAGjChlB,KAAKJ,QAAQiL,aAAgD,iBAAzBjL,EAAQiL,aAA6BjL,EAAQiL,aAAa9C,cAAgB,MAG9G/H,KAAKJ,QAAQuE,SAAWvE,EAAQuE,UAAY,mBAG5CnE,KAAKJ,QAAQqlB,SAAWrlB,EAAQqlB,UAAY,KAG5CjlB,KAAKJ,QAAQslB,IAA8B,iBAAhBtlB,EAAQslB,IAAoBtlB,EAAQslB,IAAIva,cAAgB,OAG1D,SAArB3K,KAAKJ,QAAQslB,MACbllB,KAAKJ,QAAQ2K,WAAa,OAI9BvK,KAAKJ,QAAQulB,MAAQvlB,EAAQulB,QAAS,EAGtCnlB,KAAKJ,QAAQwlB,SAAWxlB,EAAQwlB,WAAY,GAMvCplB,KAAKJ,QAAQkM,UAAW,CACzB,IAAIuZ,EAAkB,IAAkBN,KAAKd,SACzCqB,EAAW,KACf,OAAQtlB,KAAKJ,QAAQslB,KACjB,IAAK,MACDI,EAAWD,EAAgBE,IAC3B,MACJ,IAAK,OAEDD,EAAWD,GADAzlB,EAAQqlB,SAAW,SAAW,aAAe,IAAMjlB,KAAKJ,QAAQiL,cAE3E,MACJ,QACI,MAAM,IAAIpL,MAAM,IAAEwK,WAAW,gBAAiB,QAGtD,IAAKqb,EACD,MAAM,IAAI7lB,MAAM,8BAEpBO,KAAKJ,QAAQkM,UAAYwZ,EACzBtlB,KAAKX,OAAOE,MAAM,2BAA6BS,KAAKJ,QAAQkM,UAChE,CAIA,IAAI0Z,EAAMxlB,KAAKJ,QAAQkM,UAAUiL,YAAY,KAC7C,IAAa,IAATyO,EAAY,CACZ,IAAIC,EAAYzlB,KAAKJ,QAAQkM,UAAUgL,UAAU0O,EAAM,GACvD,GAAIC,GAAaA,EAAUrkB,OAAS,EAEhC,OADApB,KAAKX,OAAOE,MAAM,0BAA4BkmB,GACtCA,EAAU1d,eACd,IAAK,OACL,IAAK,MACD/H,KAAKJ,QAAQiL,aAAe4a,EAAU1d,cACtC,MACJ,QACI,MAAM,IAAItI,MAAM,4DAGhC,CACJ,CAKAslB,EAAK5f,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAGxD,GAKA4f,EAAK5f,UAAUC,YAAc2f,EAQ7BA,EAAK5f,UAAUoG,aAAe,SAAU7K,EAAO8K,GAE3C,IAAI5L,EAAU,CACV2K,WAAavK,KAAKJ,QAAQ2K,WAE1BE,UAAY,SAAUQ,GAElBjL,KAAK8K,QAAUG,EACfO,EAAQrM,KAAKa,KAAMA,KAAK8K,QAC5B,EACAK,QAAUzK,EACVX,MAAQC,KAERmE,SAAWnE,KAAKJ,QAAQuE,SACxB6gB,UAAYhlB,KAAKJ,QAAQolB,UACzBna,aAAe7K,KAAKJ,QAAQiL,aAC5Boa,SAAWjlB,KAAKJ,QAAQqlB,SACxBC,IAAMllB,KAAKJ,QAAQslB,IACnBC,MAAQnlB,KAAKJ,QAAQulB,MACrBC,SAAWplB,KAAKJ,QAAQwlB,UAG5B,EAAAM,EAAmBZ,MAAMllB,EAC7B,EAQAmlB,EAAK5f,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GAM9C,GAAIxL,KAAKO,SAAU,CACf,IAAIX,EAAU,CACVW,SAAWP,KAAKO,SAChBsK,aAAe7K,KAAKJ,QAAQiL,aAC5BL,YAAcxK,KAAKJ,QAAQ4K,YAC3BW,QAAUzK,EACV+J,UAAYe,EACZzL,MAAQC,MAGZ,EAAA0lB,EAAoBZ,MAAMllB,EAC9B,MACIc,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,2BAEvD,EAEA,S,wBCtPAnL,EAAOC,QAAUC,GAAGC,MAAM0mB,M,qRCwG1B,QAzFa,CAUTC,cAAgB,WACZ,IAAIC,GAAY,EACZC,EAAYvkB,OAAOwkB,UAAUD,UAAU/d,cAmB3C,OAjBqC,IAAjC+d,EAAUrM,QAAQ,YACa,IAA/BqM,EAAUrM,QAAQ,UACa,IAA/BqM,EAAUrM,QAAQ,UACgB,IAAlCqM,EAAUrM,QAAQ,aACe,IAAjCqM,EAAUrM,QAAQ,YACmB,IAArCqM,EAAUrM,QAAQ,gBACe,IAAjCqM,EAAUrM,QAAQ,YACc,IAAhCqM,EAAUrM,QAAQ,WACc,IAAhCqM,EAAUrM,QAAQ,WAClBoM,GAAY,IAGmB,IAA/BC,EAAUrM,QAAQ,UACgB,IAAlCqM,EAAUrM,QAAQ,aAClBoM,GAAY,GAGTA,CACX,EAUAnN,OAAS,SAAUsN,EAAMpJ,GAErB,IAAK,IAAItD,KADT0M,EAAOA,GAAQ,CAAC,EACCpJ,EACTA,EAAOlS,eAAe4O,KACtB0M,EAAK1M,GAAQsD,EAAOtD,IAG5B,OAAO0M,CACX,EAUAtV,YAAc,SAAUsV,EAAMpJ,EAAQvO,GAClC,QAAoB,IAAT2X,QAA0C,IAAXpJ,EAM1C,IAAK,IAAIqJ,UAHc,IAAZ5X,IACPA,GAAU,GAEIuO,EACVA,EAAOlS,eAAeub,KACO,WAAzB7L,EAAOwC,EAAOqJ,IACVD,EAAKtb,eAAeub,GACpBjmB,KAAK0Q,YAAYsV,EAAKC,GAAQrJ,EAAOqJ,GAAQ5X,GAE7C2X,EAAKC,GAASrJ,EAAOqJ,GAGrBD,EAAKtb,eAAeub,GAChB5X,IACA2X,EAAKC,GAASrJ,EAAOqJ,IAGzBD,EAAKC,GAASrJ,EAAOqJ,GAKzC,E,6DC1EJ,QAzBsB,CAQlB3mB,UAAY,SAAU+I,GAKlB,QAAuB,IAAZ6d,EACP,IAAIA,EAAU,CACdA,IAAc,CACVC,SAAU,IAGjBD,EAAQE,IAAW,QAAI,cAAkB,eAC1C,IAAIC,EAAUhe,GAAQ,UACtB,OAAO,YAAcge,EACzB,E,yLCnBAhnB,EAAS2Q,EAAAA,EAAO1Q,UAAU,uBAogB9B,QAlgB0B,CAOtBqgB,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAMAoiB,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUe,UAAY1I,KAAK2f,QAAQ,mBACnChY,EAAUe,WAAa,wBAChBf,CACX,EAUA4e,4BAA8B,SAAUriB,EAAI8P,GACxC,IAAIzL,EAAMC,SAASC,cAAc,OAKjC,OAJAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,mBAAqBzb,GAC3CqE,EAAIG,UAAasL,EAAW,gDAAkD,kDAC9EzL,EAAItJ,MAAMunB,QAAU,GAEbje,CACX,EAUAke,iCAAmC,SAAUviB,EAAIrC,GAE7C,IAAI8G,EAAO3I,KAEP0mB,EAAele,SAASC,cAAc,UA6B1C,OA5BAie,EAAaxiB,GAAKlE,KAAK2f,QAAQ,yBAA2Bzb,GAC1DwiB,EAAavU,UAAYtQ,EACzB6kB,EAAahe,UAAY,+FACzBge,EAAazL,aAAa,OAAQ,UAClCyL,EAAarU,iBAAiB,SAAS,SAAUpQ,GAG7C,IAFA,IAAImT,EAAIH,EAAAA,EAAGhM,MAAMjJ,KAAKkE,IAClByiB,EAASne,SAASkB,uBAAuBf,EAAKgX,QAAQ,oBACjDiH,EAAI,EAAGA,EAAID,EAAOvlB,OAAQwlB,IAAK,CACpC,IAAIC,EAAMF,EAAOC,GAAGtQ,WAAW,GAAGpS,GAC9BA,EAAK+Q,EAAAA,EAAGhM,MAAM4d,GAClBre,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,IAAKjF,MAAMunB,QAAU,EACnF,CACAhe,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAIrO,MAAQ,GAC7EyB,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAIrO,MAAQ,GACvEyB,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBvK,IAAInW,MAAMunB,QAAU,GAC9Ehe,SAASqL,eAAelL,EAAKgX,QAAQ,2BAA6BvK,IAAIS,SAAU,EAChFrN,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAI1M,UAAY,6CAC3EF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAI1M,UAAY,6BAC7EF,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,MAChE5M,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,IAAI1M,UAAY,qGAEhFF,SAASqL,eAAelL,EAAKgX,QAAQ,yBACrCnX,SAASqL,eAAelL,EAAKgX,QAAQ,uBAAuBjX,UAAY,wGAG5EC,EAAKme,0BAA0B7kB,EACnC,IAEOykB,CACX,EAQAK,0CAA4C,SAAU7iB,GAElD,IAAIyE,EAAO3I,KAEPgnB,EAAcxe,SAASC,cAAc,SA6FzC,OA5FAue,EAAY9iB,GAAKlE,KAAK2f,QAAQ,oBAAsBzb,GACpD8iB,EAAYte,UAAY,4CACxBse,EAAY9a,KAAO,OACnB8a,EAAYC,YAAc,iCAC1BD,EAAYE,aAAe,MAC3BF,EAAY3U,iBAAiB,SAAS,SAAUpQ,GAC5C,IAAIklB,EAAWllB,EAAEmlB,OAASnlB,EAAEolB,QAC5B,GAAiB,KAAbF,GAAgC,KAAbA,GAAgC,KAAbA,GAAgC,KAAbA,EAA7D,CAIA,IAAI/R,EAAIH,EAAAA,EAAGhM,MAAMjJ,KAAKkE,IAClBsE,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAIrO,MAAM3F,OAAS,GAC9EoH,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCvK,IAAIkS,UAAUjZ,QAAQ,kBAAmB,oBAC9G7F,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCvK,IAAIkS,UAAUjZ,QAAQ,aAAc,iBAEzG7F,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCvK,IAAIkS,UAAUjZ,QAAQ,mBAAoB,mBAC/G7F,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCvK,IAAIkS,UAAUjZ,QAAQ,cAAe,eAK9G1F,EAAK4e,yBAAyBtlB,EAb9B,CAcJ,IAEA+kB,EAAY3U,iBAAiB,WAAW,SAAUpQ,GAC9C,IAAIklB,EAAWllB,EAAEmlB,OAASnlB,EAAEolB,QAExB1f,EAAYa,SAASqL,eAAelL,EAAKgX,QAAQ,gCAAkCzb,IAGvF,GAAKyD,EAAL,CAIA,IAAI6f,EAAO7f,EAAU+B,uBAAuB,kCACxC+d,EAAO9f,EAAU+B,uBAAuB,0BAGxCtI,EAASqmB,EAAKrmB,OAClB,GAAKA,EAAL,CAIA,IAAIsmB,EAAU,KAGd,IAAKF,EAAKpmB,OAKN,OAJAsmB,EAAUD,EAAK,IACP/e,UAAY,iCACpBgf,EAAQzoB,MAAM+Y,MAAQ,eACtB0P,EAAQzoB,MAAM,oBAAsB,WAGpCyoB,EAAUF,EAAK,GAGnB,IAAIve,EAAQ0e,SAAS1S,EAAAA,EAAGhM,MAAMye,EAAQxjB,IAAK,IACvC0jB,EAAQ3e,IAAU7H,EAAS,EAAKqmB,EAAK,GAAKA,EAAKxe,EAAQ,GACvD4e,EAAkB,IAAV5e,EAAewe,EAAKrmB,EAAS,GAAKqmB,EAAKxe,EAAQ,GAS3D,OAPAye,EAAQzoB,MAAM,oBAAsB,GACpCyoB,EAAQzoB,MAAM+Y,MAAQ,GACtB6P,EAAK5oB,MAAM,oBAAsB,GACjC4oB,EAAK5oB,MAAM+Y,MAAQ,GACnB4P,EAAK3oB,MAAM,oBAAsB,GACjC2oB,EAAK3oB,MAAM+Y,MAAQ,GAEXmP,GACJ,KAAK,GACD9nB,EAAOqD,IAAI,YACXglB,EAAQhf,UAAY,yBACpBmf,EAAKnf,UAAY,iCACjBmf,EAAK5oB,MAAM+Y,MAAQ,UACnB6P,EAAK5oB,MAAM,oBAAsB,UACjC,MACJ,KAAK,GACDI,EAAOqD,IAAI,cACXglB,EAAQhf,UAAY,yBACpBkf,EAAKlf,UAAY,iCACjBkf,EAAK3oB,MAAM+Y,MAAQ,UACnB4P,EAAK3oB,MAAM,oBAAsB,UACjC,MACJ,KAAK,GACDI,EAAOqD,IAAI,SACXglB,EAAQzI,MAAMhd,GAItBylB,EAAQI,OA/CR,CATA,CAyDJ,IAEOd,CACX,EAQAe,sCAAwC,SAAU7jB,GAE9C,IAAIyE,EAAO3I,KAEPgoB,EAAmBxf,SAASC,cAAc,SAS9C,OARAuf,EAAiB9jB,GAAKlE,KAAK2f,QAAQ,0BAA4Bzb,GAC/D8jB,EAAiBtf,UAAY,gDAC7Bsf,EAAiB9b,KAAO,OACxB8b,EAAiB9U,UAAW,EAC5B8U,EAAiB3V,iBAAiB,SAAS,WACvC,IAAI+C,EAAIH,EAAAA,EAAGhM,MAAMjJ,KAAKkE,IACtBsE,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,IAAI6J,OACxE,IACO+I,CACX,EAQAC,uCAAyC,SAAU/jB,GAC/C,IAAIgkB,EAAqB1f,SAASC,cAAc,SAKhD,OAJAyf,EAAmBhkB,GAAKlE,KAAK2f,QAAQ,2BAA6Bzb,GAClEgkB,EAAmBxf,UAAY,6BAC/Bwf,EAAmBhc,KAAO,WAEnBgc,CACX,EAQAC,mCAAqC,SAAUjkB,GAE3C,IAAIyE,EAAO3I,KAEPooB,EAAsB5f,SAASC,cAAc,UAqEjD,OApEA2f,EAAoBlkB,GAAKlE,KAAK2f,QAAQ,8BAAgCzb,GACtEkkB,EAAoB1R,QAAU1W,KAAK2f,QAAQ,2BAA6Bzb,GACxEkkB,EAAoB1f,UAAY,iEAChC0f,EAAoBjY,MAAQ,+BAC5BiY,EAAoBnN,aAAa,OAAQ,UACzCmN,EAAoB/V,iBAAiB,SAAS,SAAUpQ,GACpDA,EAAEomB,iBACFpmB,EAAEqmB,kBACF,IAEI1B,EACAC,EACA3iB,EAJAkR,EAAIH,EAAAA,EAAGhM,MAAMjJ,KAAKkE,IAClByiB,EAASne,SAASkB,uBAAuBf,EAAKgX,QAAQ,oBAI1D,IAAKiH,EAAI,EAAGA,EAAID,EAAOvlB,OAAQwlB,IAC3BC,EAAMF,EAAOC,GAAGtQ,WAAW,GAAGpS,GAE1BkR,KADJlR,EAAK+Q,EAAAA,EAAGhM,MAAM4d,MAEVre,SAASqL,eAAelL,EAAKgX,QAAQ,2BAA6Bzb,IAAK2R,SAAU,EACG,iCAAhFrN,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4Bzb,IAAK6C,QACtEyB,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4Bzb,IAAK6C,MAAQ,GAC9EyB,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBzb,IAAKwE,UAAY,6CAC5EF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4Bzb,IAAKwE,UAAY,+BAI9F,GAAIF,SAASqL,eAAelL,EAAKgX,QAAQ,2BAA6BvK,IAAIS,QAAS,CAE/E,IADArN,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAIrO,MAAQ,GACxE6f,EAAI,EAAGA,EAAID,EAAOvlB,OAAQwlB,IAC3BC,EAAMF,EAAOC,GAAGtQ,WAAW,GAAGpS,GAC9BA,EAAK+Q,EAAAA,EAAGhM,MAAM4d,GACdre,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,IAAKjF,MAAMunB,QAAU,GAE/Ehe,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,MAChE5M,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,IAAI1M,UAAY,sGAEhFF,SAASqL,eAAelL,EAAKgX,QAAQ,yBACrCnX,SAASqL,eAAelL,EAAKgX,QAAQ,uBAAuBjX,UAAY,wGAE5EF,SAASqL,eAAelL,EAAKgX,QAAQ,2BAA6BvK,IAAIS,SAAU,EAChFrN,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAI1M,UAAY,6CAC3EF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAI1M,UAAY,4BACrF,KAAO,CAEH,IADAF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAIrO,MAAQ,+BACxE6f,EAAI,EAAGA,EAAID,EAAOvlB,OAAQwlB,IAC3BC,EAAMF,EAAOC,GAAGtQ,WAAW,GAAGpS,GAE1BkR,KADJlR,EAAK+Q,EAAAA,EAAGhM,MAAM4d,IAEVre,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,IAAKjF,MAAMunB,QAAU,GAE/Ehe,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,IAAKjF,MAAM+U,QAAU,OAGnFxL,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,MAChE5M,SAASqL,eAAelL,EAAKgX,QAAQ,yBAA2BvK,IAAI1M,UAAY,8BAEhFF,SAASqL,eAAelL,EAAKgX,QAAQ,yBACrCnX,SAASqL,eAAelL,EAAKgX,QAAQ,uBAAuBjX,UAAY,8BAE5EF,SAASqL,eAAelL,EAAKgX,QAAQ,2BAA6BvK,IAAIS,SAAU,EAChFrN,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAI1M,UAAY,6BAC3EF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAI1M,UAAY,4CACjFF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAIlC,UAAW,CACpF,CAGAvK,EAAK4f,wBAAwBtmB,EACjC,IAEOmmB,CACX,EASAI,kCAAoC,SAAUtkB,GAE1C,IAAIyE,EAAO3I,KAEPyoB,EAAWjgB,SAASC,cAAc,UAqCtC,OApCAggB,EAASvkB,GAAKlE,KAAK2f,QAAQ,yBAA2Bzb,GACtDukB,EAAS/f,UAAY,mHACrB+f,EAAStY,MAAQ,oBACjBsY,EAASxN,aAAa,WAAY,KAClCwN,EAASxN,aAAa,gBAAgB,GACtCwN,EAASxN,aAAa,OAAQ,UAC9BwN,EAASpW,iBAAiB,SAAS,SAAUpQ,GACzC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC,IAAI2kB,EAASne,SAASkB,uBAAuBf,EAAKgX,QAAQ,oBACtDgJ,EAAOhC,EAAOvlB,OAAS,EACvBwnB,EAAQjC,EAAO,GAAGrQ,WAAW,GAAGpS,GAChC2kB,EAAMlC,EAAOgC,GAAMrS,WAAW,GAAGpS,GAEjC4kB,EAAU7T,EAAAA,EAAGhM,MAAM2f,GACnBG,EAAQ9T,EAAAA,EAAGhM,MAAM4f,GAErB,GAAI3kB,IAAO4kB,GAAW5kB,IAAO6kB,EAAO,CAChC,IAAI3T,EAAIH,EAAAA,EAAGhM,MAAMjJ,KAAKkE,IACtBsE,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBvK,IAAI1M,UAAY,kDAC1EF,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAIrO,MAAQ,GACvEyB,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBvK,IAAI1M,UAAY,4CAC3EF,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAIrO,MAAQ,GAC7EyB,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BvK,IAAI1M,UAAY,6BACjFF,SAASqL,eAAelL,EAAKgX,QAAQ,uBAAuB1gB,MAAM+U,QAAU,GAC5ExL,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBvK,IAAIiB,cAAcQ,gBAAgByQ,UAAUtG,IAAI,kBAAmB,cAO7HrY,EAAKqgB,2BAA2B/mB,EACpC,CACJ,IAEOwmB,CACX,EAQAQ,+BAAiC,WAE7B,IAAItgB,EAAO3I,KAEPkpB,EAAY1gB,SAASC,cAAc,UA6CvC,OA5CAygB,EAAUhlB,GAAKlE,KAAK2f,QAAQ,sBAC5BuJ,EAAUxgB,UAAY,sHACtBwgB,EAAU/Y,MAAQ,qBACdpG,EAAAA,EAAAA,OACAmf,EAAUC,UAAY,qBAE1BD,EAAUjO,aAAa,WAAY,KACnCiO,EAAUjO,aAAa,gBAAgB,GACvCiO,EAAUjO,aAAa,OAAQ,UAC/BiO,EAAU7W,iBAAiB,SAAS,SAAUpQ,GAI1C,IAHA,IAAImnB,EAAY,EACZC,EAAW,EACX1C,EAASne,SAASkB,uBAAuBf,EAAKgX,QAAQ,oBACjDvK,EAAI,EAAGA,EAAIuR,EAAOvlB,OAAS,EAAGgU,IAAK,CACxC,IAAIyR,EAAMF,EAAOvR,GAAGkB,WAAW,GAAGpS,GAC9BA,EAAK+Q,EAAAA,EAAGhM,MAAM4d,GACdre,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,MACuB,oDAA7EsE,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqBzb,IAAKwE,UAC7C,IAAd0gB,IACAA,EAAYllB,GAGhBmlB,IAGZ,CAEID,EAAYzC,EAAOvlB,SACnBoH,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqByJ,IAAY1gB,UAAY,gDAClFF,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAqByJ,IAAY/S,cAAcQ,gBAAgByQ,UAAU7K,OAAO,kBAAmB,eAK3H,IAAb4M,IACA7gB,SAASqL,eAAelL,EAAKgX,QAAQ,uBAAuB1gB,MAAM+U,QAAU,QAIhF,IAAIhS,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAK2gB,wBAAwBrnB,EACjC,IAEOinB,CACX,EAEAK,mCAAqC,SAAUrlB,GAC3C,IAAIqE,EAAMC,SAASC,cAAc,OAQjC,OAPAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,8BAAgCzb,GACtDqE,EAAIG,UAAY,2EAMTH,CACX,EASAihB,yCAA2C,SAAUtlB,GAEjD,IAAIyE,EAAO3I,KAEPuI,EAAMC,SAASC,cAAc,OAkBjC,OAjBAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,gCAAkCzb,GACxDqE,EAAIG,UAAY,+CAEZH,EAAI8J,iBACJ9J,EAAI8J,iBAAiB,SAAS,SAAUpQ,GACpC0G,EAAK8gB,gCAAgCxnB,GACrCuG,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCzb,IAAKojB,UAAUjZ,QAAQ,kBAAmB,oBAC/G7F,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCzb,IAAKojB,UAAUjZ,QAAQ,aAAc,cAC9G,IAAG,GACI9F,EAAIgK,aACXhK,EAAIgK,YAAY,WAAW,SAAUtQ,GACjC0G,EAAK8gB,gCAAgCxnB,GACrCuG,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCzb,IAAKojB,UAAUjZ,QAAQ,kBAAmB,oBAC/G7F,SAASqL,eAAelL,EAAKgX,QAAQ,8BAAgCzb,IAAKojB,UAAUjZ,QAAQ,aAAc,cAC9G,IAGG9F,CACX,EAYAmhB,4CAA8C,SAAUxlB,EAAIwK,EAAUib,GAClE,IAAIhiB,EAAYa,SAASqL,eAAe7T,KAAK2f,QAAQ,gCAAkCzb,IAEnFqE,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,yBAA2BgK,GACjDphB,EAAIG,UAAY,0CAChBH,EAAI4H,MAAQyZ,EAAAA,EAAaC,6BAA6Bnb,GACtDnG,EAAI4J,UAAYyX,EAAAA,EAAaC,6BAA6Bnb,GAE1D/G,EAAUQ,YAAYI,EAC1B,EAMAuhB,oBAAsB,SAAU/iB,GAE5B,IADA,IAAI4f,EAASne,SAASkB,uBAAuB1J,KAAK2f,QAAQ,oBACjDvK,EAAI,EAAGA,EAAIuR,EAAOvlB,OAAQgU,IAAK,CACpC,IAAIyR,EAAMF,EAAOvR,GAAGkB,WAAW,GAAGpS,GAC9B6lB,EAAM9U,EAAAA,EAAGhM,MAAM4d,GACnB,GAAIre,SAASqL,eAAe7T,KAAK2f,QAAQ,2BAA6BoK,IAAMlU,QAAS,CACjFrN,SAASqL,eAAe7T,KAAK2f,QAAQ,0BAA4BoK,IAAMhjB,MAAQA,EAC/EyB,SAASqL,eAAe7T,KAAK2f,QAAQ,0BAA4BoK,IAAM7W,UAAW,EAClF,IAAK,IAAI0T,EAAI,EAAGA,EAAID,EAAOvlB,OAAQwlB,IAAK,CACpCC,EAAMF,EAAOC,GAAGtQ,WAAW,GAAGpS,GAC9B,IAAI8lB,EAAM/U,EAAAA,EAAGhM,MAAM4d,GACnBre,SAASqL,eAAe7T,KAAK2f,QAAQ,mBAAqBqK,IAAM/qB,MAAMunB,QAAU,GAC5Ehe,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAA2BqK,MAChExhB,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAA2BqK,IAAMthB,UAAY,oGAE1F,CAKA,OAJAF,SAASqL,eAAe7T,KAAK2f,QAAQ,2BAA6BoK,IAAMlU,SAAU,OAC9ErN,SAASqL,eAAe7T,KAAK2f,QAAQ,yBACrCnX,SAASqL,eAAe7T,KAAK2f,QAAQ,uBAAuBjX,UAAY,0DAGhF,CACJ,CACJ,G,i4CCnfJ,IAAIrJ,EAAS2Q,EAAAA,EAAO1Q,UAAU,oBAyC1B2qB,EAAgB,SAAA9jB,GAYhB,SAAA8jB,EAAarqB,GAAS,IAAAyG,E,MASlB,G,4FATkBC,CAAA,KAAA2jB,G,EAGlB,K,EAAAA,E,EAAA,CAAM,CACFzjB,SAHJ5G,EAAUA,GAAW,CAAC,GAGA4G,SAAWgC,SAASC,cAAc,OACpDhC,OAAS7G,EAAQ6G,OACjB1D,OAASnD,EAAQmD,S,UAHrBsD,E,6EAMsB4jB,GAClB,MAAM,IAAIhmB,UAAU,2BAgBxB,OAVAoC,EAAKnB,UAAY,mBAEjBmB,EAAK6jB,WAAWtqB,GAGhByG,EAAK8jB,WAAa9jB,EAAKiK,iBAGtBjK,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAK8jB,YAAc9jB,EAAKG,QAAUH,EAAK8jB,WAEjFC,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAAqjB,EAAA9jB,G,EAAA8jB,E,EAAA,EAAAnjB,IAAA,aAAAC,MAKA,SAAYnH,GAERI,KAAKJ,QAAU,CACXinB,IAAM,CACF3iB,GAAK,EACLmmB,QAAU,KACVnY,MAAQ,IACR8B,SAAU,EACVsW,WAAY,EACZC,cAAe,GAEnBC,aAAc,EACdC,oBAAsB,CAAC,GAI3Bha,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAASA,GAGhCI,KAAK4f,KAAO5f,KAAKJ,QAAQinB,IAAIwD,SAAWK,EAAAA,EAAWxV,WAMnDlV,KAAK2qB,KAAO,KAGZ3qB,KAAK4qB,iBAAmB,KAGxB5qB,KAAK6qB,aAAe,KAGpB7qB,KAAK8qB,mBAAqB,KAG1B9qB,KAAK+qB,2BAA6B,KAGlC/qB,KAAKgrB,kBAAoB,KAGzBhrB,KAAKirB,0BAA4B,KAGjCjrB,KAAKkrB,iBAAmB,KACxBlrB,KAAKmrB,oBAAsB,KAG3BnrB,KAAKorB,YAAc,KAGnBprB,KAAKqrB,oBAAsB,KAC3BrrB,KAAKsrB,eAAiB,KAGtBtrB,KAAKurB,oBAAsB,GAG3BvrB,KAAKwrB,iBAAmB,KAGxBxrB,KAAKyrB,cAGLzrB,KAAK0rB,WAAa,CAAC,EAGnB1rB,KAAK2rB,YAAc,IACvB,GAEA,CAAA7kB,IAAA,cAAAC,MAKA,WAMI,GAJA/G,KAAK4rB,QAAU,KACf5rB,KAAK6rB,WAAa,GAClB7rB,KAAK8rB,cAAgB,CAAC,EAAG,GAErB9rB,KAAKJ,QAAQinB,IAAIkF,YAAc/rB,KAAKJ,QAAQinB,IAAIkF,WAAWvsB,IAAK,CAEhEQ,KAAK6rB,WAAa7rB,KAAKJ,QAAQinB,IAAIkF,WAAWvsB,IAG9C,IAAImK,EAAS3J,KAAKJ,QAAQinB,IAAIkF,WAAWpiB,OACrCA,IACIH,MAAM4E,QAAQzE,IAA6B,IAAlBA,EAAOvI,OAChCpB,KAAK8rB,cAAgBniB,EAErBtK,EAAOqD,IAAI,sDAGvB,MAEI1C,KAAK6rB,WAAaG,EAAAA,EAAqB,YACvChsB,KAAK8rB,cAAgBE,EAAAA,EAAQC,aAErC,GAMA,CAAAnlB,IAAA,gBAAAC,MAKA,WACI,OAAO/G,KAAKorB,WAChB,GAEA,CAAAtkB,IAAA,gBAAAC,MAKA,SAAemlB,EAAY5nB,GACvB,IACI6nB,EADMnsB,KAAKiH,SACAmlB,UAAUC,gBAAgBC,UAEpChoB,IACDA,EAAM6nB,GAGVnsB,KAAKusB,eAAeL,EAAY5nB,GAGhC4nB,GAAaM,EAAAA,EAAAA,WAAgBN,EAAY5nB,EAAK6nB,GAC9CnsB,KAAKysB,WAAW,CACZP,EAAW,GACXA,EAAW,IACZ,MAAM,EACb,GAEA,CAAAplB,IAAA,QAAAC,MAGA,WACI/G,KAAK0sB,eACL1sB,KAAK6qB,aAAa5L,OACtB,GAEA,CAAAnY,IAAA,eAAAC,MAGA,WACI/G,KAAKwrB,iBAAmB,KACxBxrB,KAAKorB,YAAc,KACnBprB,KAAK2sB,yBACL3sB,KAAK4sB,0BACL5sB,KAAKysB,cAELI,EAAAA,EAAAA,SAAoB7sB,KAAK2rB,YAC7B,GAMA,CAAA7kB,IAAA,iBAAAC,MAKA,WAAkB,IAAA+lB,EAAA,KACV5oB,EAAKlE,KAAKJ,QAAQinB,IAAI3iB,GAGtByD,EAAY3H,KAAKsmB,8BAEjByG,EAAS/sB,KAAK4qB,iBAAmB5qB,KAAKumB,4BAA4BriB,EAAIlE,KAAKJ,QAAQinB,IAAI7S,SAC3FrM,EAAUQ,YAAY4kB,GAEtB,IAAIlC,EAAe7qB,KAAK6qB,aAAe7qB,KAAKymB,iCAAiCviB,EAAIlE,KAAKJ,QAAQinB,IAAI3U,OAClG6a,EAAO5kB,YAAY0iB,GACnB,IAAIC,EAAqB9qB,KAAK8qB,mBAAqB9qB,KAAK+mB,0CAA0C7iB,GAC9F4mB,EAAmBzY,iBACnByY,EAAmBzY,iBAAiB,SAAS,kBAAMya,EAAKE,0BAA0B,IAC3ElC,EAAmBvY,aAC1BuY,EAAmBvY,YAAY,WAAW,kBAAMua,EAAKE,0BAA0B,IAEnFD,EAAO5kB,YAAY2iB,GACnB,IAAImC,EAAmBjtB,KAAKirB,0BAA4BjrB,KAAK+nB,sCAAsC7jB,GACnG6oB,EAAO5kB,YAAY8kB,GACnB,IAAIjC,EAAoBhrB,KAAK+qB,2BAA6B/qB,KAAKioB,uCAAuC/jB,GACtG6oB,EAAO5kB,YAAY6iB,GACnB,IAAIkC,EAAgBltB,KAAKgrB,kBAAoBhrB,KAAKmoB,mCAAmCjkB,GAGrF,GAFA6oB,EAAO5kB,YAAY+kB,GAEfltB,KAAKJ,QAAQinB,IAAIyD,UAAW,CAC5B,IAAI6C,EAAiBntB,KAAKkrB,iBAAmBlrB,KAAKipB,iCAClD8D,EAAO5kB,YAAYglB,EACvB,CAEA,GAAIntB,KAAKJ,QAAQinB,IAAI0D,aAAc,CAC/B,IAAI6C,EAAoBptB,KAAKmrB,oBAAsBnrB,KAAKwoB,kCAAkCtkB,GAC1F6oB,EAAO5kB,YAAYilB,EACvB,CAEA,IAAIC,EAAertB,KAAKqrB,oBAAsBrrB,KAAKupB,mCAAmCrlB,GAClFopB,EAAUttB,KAAKsrB,eAAiBtrB,KAAKwpB,yCAAyCtlB,GAIlF,OAHAmpB,EAAallB,YAAYmlB,GACzB3lB,EAAUQ,YAAYklB,GAEf1lB,CACX,GAMA,CAAAb,IAAA,2BAAAC,MAKA,WACQ/G,KAAK8qB,oBAAsB9qB,KAAK8qB,mBAAmB/jB,MAAM3F,OAAS,GAClEpB,KAAKutB,2BAEb,GAEA,CAAAzmB,IAAA,2BAAAC,MAUA,SAA0B9E,GAAG,IAAAurB,EAAA,KACrBzmB,EAAQ9E,EAAEc,OAAOgE,MACrB,GAAKA,EAAL,CAKA,IAAI0mB,EAAiBztB,KAAKJ,QAAQ6qB,qBAAuB,CAAC,EACtDiD,EAAmBD,EAAehjB,WAAa,KAC/CkjB,EAAmBF,EAAe9sB,WAAa,KAMnD,GAHAX,KAAKwrB,iBAAmBzkB,EAGpBA,EAAM3F,OAAS,EACfpB,KAAK4sB,8BADT,CAWA,IAAI7hB,EAAU/K,KACdA,KAAK4tB,qBAAqB,CACtB/rB,KAAOkF,EACPqd,iBAAmB,EAEnB3Z,UAAY,SAAU6iB,GAClB,GAAIA,EAAS,CACT,IAAI/e,EAAY+e,EAAQO,mBACxB9iB,EAAQ+iB,wCAAwCvf,GAC5Cmf,GACAA,EAAiBvuB,KAAKa,KAAMstB,EAEpC,CACJ,EAEA3sB,UAAY,SAAUD,GAIlBqK,EAAQ6hB,0BACRvtB,EAAOqD,IAAIhC,EAAMoB,SACb6rB,GACAA,EAAiBxuB,KAAKa,KAAMU,EAEpC,IAGJ,IAAIuF,EAAMjG,KAAKiH,SACfhB,EAAI8nB,GACA,SACA,kBAAMP,EAAKb,wBAAwB,IAEvC1mB,EAAI8nB,GACA,eACA,kBAAMP,EAAKb,wBAAwB,GA1CvC,CAdA,CA0DJ,GAEA,CAAA7lB,IAAA,kCAAAC,MASA,SAAiC9E,GAC7B,IAAIujB,EAAMkF,EAAAA,EAAWzhB,MAAMhH,EAAEc,OAAOmB,IAEpC,GAAKshB,EAAL,CAQA,IAAInhB,EAAW,CACXrE,KAAKurB,oBAAoB/F,GAAKnhB,SAASiB,EACvCtF,KAAKurB,oBAAoB/F,GAAKnhB,SAASkB,GAG3CvF,KAAKorB,YAAc/mB,EAEnB,IAAIuN,EAAO,CACP1F,KAAOlM,KAAKurB,oBAAoB/F,GAAKtZ,KACrC8hB,OAAShuB,KAAKurB,oBAAoB/F,IAIlCtT,EAAQ0X,EAAAA,EAAaC,6BAA6B7pB,KAAKurB,oBAAoB/F,IAC/ExlB,KAAKiuB,UAAU/b,GAGf,IACIgc,EADOluB,KAAKiH,SAASmlB,UACNC,gBAAgBC,UACnB,cAAZ4B,IAEA7pB,GAAWmoB,EAAAA,EAAAA,WAAgBnoB,EAAU,YAAa6pB,IAGtDluB,KAAKmuB,aAAa9pB,GAClBrE,KAAKysB,WAAWpoB,EAAUuN,EAAM5R,KAAKJ,QAAQ4qB,YA/B7C,CAgCJ,GAEA,CAAA1jB,IAAA,0BAAAC,MAMA,WAA2B,IAAAqnB,EAAA,KACnBnoB,EAAMjG,KAAKiH,SAEXjH,KAAK+qB,2BAA2BlV,SAEhC7V,KAAK0sB,eACL1sB,KAAK2rB,YAAc1lB,EAAI8nB,GACnB,SACA,SAAC9rB,GAAC,OAAKmsB,EAAKC,gBAAgBpsB,EAAE,IAElCjC,KAAKsuB,WAAW,gBAGhBzB,EAAAA,EAAAA,SAAoB7sB,KAAK2rB,aACzB3rB,KAAKsuB,aAEb,GAEA,CAAAxnB,IAAA,4BAAAC,MAOA,WACI/G,KAAKsuB,aACLtuB,KAAK0sB,cACT,GAEA,CAAA5lB,IAAA,6BAAAC,MAOA,WACI/G,KAAKsuB,aACLtuB,KAAK0sB,cACT,GAEA,CAAA5lB,IAAA,0BAAAC,MAOA,SAAyB9E,GACrB5C,EAAOqD,IAAI,uBAAwBT,EACvC,GAMA,CAAA6E,IAAA,kBAAAC,MAQA,SAAiB9E,GACb,IAAIiqB,EAAajqB,EAAEiqB,WACnB,GAAKjqB,EAAEgE,KAAQhE,EAAEgE,IAAImmB,UAArB,CAGA,IAAI9nB,EAAMrC,EAAEgE,IAAImmB,UAAUC,gBAE1BrsB,KAAKusB,eAAeL,EAAY5nB,GAEhCtE,KAAKysB,WAAW,CACZP,EAAW,GACXA,EAAW,IACZ,MAAM,GAGTlsB,KAAKuoB,wBAAwBtmB,EAX7B,CAYJ,GAMA,CAAA6E,IAAA,YAAAC,MAMA,SAAWmL,GACPlS,KAAK8qB,mBAAmB/jB,MAAQmL,CACpC,GAEA,CAAApL,IAAA,aAAAC,MAMA,SAAYwnB,GACR,IACIhmB,EADMvI,KAAKiH,SACDunB,mBAGVjmB,EAAItJ,MAAMsvB,OADVA,GAGmB,IAE3B,GAEA,CAAAznB,IAAA,iBAAAC,MAQA,SAAgB0nB,EAAcnqB,GAS1BtE,KAAKorB,aAAcoB,EAAAA,EAAAA,WAAgBiC,EAAcnqB,EAAK,aAStD,IAAImgB,EAAMzkB,KAAKorB,YAAY,GAAGsD,QAAQ,GAGlC3nB,EAFM/G,KAAKorB,YAAY,GAAGsD,QAAQ,GAEpB,MAAQjK,EAC1BzkB,KAAK8pB,oBAAoB/iB,EAC7B,GAEA,CAAAD,IAAA,eAAAC,MAOA,SAAc1C,GACCrE,KAAKiH,SAASmlB,UACpBuC,UAAUtqB,EACnB,GAEA,CAAAyC,IAAA,aAAAC,MAUA,SAAY1C,EAAUuqB,EAAa5a,GAC/B,IAAI/N,EAAMjG,KAAKiH,SAOf,GALoB,MAAhBjH,KAAK4rB,UACL3lB,EAAI4oB,cAAc7uB,KAAK4rB,SACvB5rB,KAAK4rB,QAAU,MAGfvnB,EAAU,CACV,IAAIyqB,EAAYtmB,SAASC,cAAc,OACvCqmB,EAAU7Y,IAAMjW,KAAK6rB,WACrB7rB,KAAK4rB,QAAU,IAAImD,IAAJ,CAAY,CACvB1qB,SAAWA,EACXsF,OAAS3J,KAAK8rB,cACdtlB,QAAUsoB,EACVE,WAAY,IAEhB/oB,EAAIgpB,WAAWjvB,KAAK4rB,SAEhB5X,GACA3U,EAAOqD,IAAI,wBAAyBksB,EA0B5C,CACJ,GAEA,CAAA9nB,IAAA,0BAAAC,MAMA,WAGI,GADA/G,KAAKurB,oBAAsB,GACvBvrB,KAAKsrB,eACL,KAAOtrB,KAAKsrB,eAAe4D,YACvBlvB,KAAKsrB,eAAe6D,YAAYnvB,KAAKsrB,eAAe4D,WAGhE,GAEA,CAAApoB,IAAA,yBAAAC,MAMA,WACQ/G,KAAKqrB,sBACLrrB,KAAKqrB,oBAAoB/D,UAAUjZ,QAAQ,mBAAoB,mBAC/DrO,KAAKqrB,oBAAoB/D,UAAUjZ,QAAQ,cAAe,cAElE,GAEA,CAAAvH,IAAA,4BAAAC,MAMA,WACQ/G,KAAKqrB,sBACLrrB,KAAKqrB,oBAAoB/D,UAAUjZ,QAAQ,kBAAmB,oBAC9DrO,KAAKqrB,oBAAoB/D,UAAUjZ,QAAQ,aAAc,eAEjE,GAEA,CAAAvH,IAAA,uBAAAC,MAUA,SAAsB3H,GAIlB,GAHAC,EAAOqD,IAAI,yBAA0BtD,GAGhCA,GAA6C,IAAjC8B,OAAOC,KAAK/B,GAAUgC,QAKlChC,EAASyC,KAAd,CAIAxC,EAAOqD,IAAItD,GAEX,IAAIQ,EAAU,CAAC,EAEf6Q,EAAAA,EAAMiI,OAAO9Y,EAASI,KAAKJ,QAAQ6qB,qBAEnCha,EAAAA,EAAMiI,OAAO9Y,EAASR,GAGtB,IAAIgwB,EAAYpvB,KAAK0rB,WAA2B,gBAAK,KACjD0D,GAAa5lB,MAAM4E,QAAQghB,KACtBxvB,EAAQ0kB,gBACT1kB,EAAQ0kB,cAAgB,CAAC,GAE7B1kB,EAAQ0kB,cAAcpY,KAAOkjB,GAKjCxvB,EAAQiM,OAASjM,EAAQiM,QAAU7L,KAAKJ,QAAQiM,OAIrB,kBAAhBjM,EAAQwK,MACiB,kBAArBpK,KAAKJ,QAAQwK,IACpBxK,EAAQwK,IAAMpK,KAAKJ,QAAQwK,IAE3BxK,EAAQwK,KAAM,GAItB/K,EAAOqD,IAAI9C,GAEXyvB,EAAAA,GAAGC,SAASC,aAAa3vB,EAnCzB,CAoCJ,GAEA,CAAAkH,IAAA,0CAAAC,MAUA,SAAyCwH,GACrC,GAAKA,GAAkC,IAArBA,EAAUnN,OAA5B,CAKA,IAAIoF,EAAUxG,KAAKsrB,eACnB,GAAI9kB,EAAQgpB,kBACR,KAAOhpB,EAAQ0oB,YACX1oB,EAAQ2oB,YAAY3oB,EAAQ0oB,YAIpC,IAAK,IAAI9Z,EAAI,EAAGA,EAAI7G,EAAUnN,OAAQgU,IAElCpV,KAAK0pB,4CAA4C1pB,KAAKJ,QAAQinB,IAAI3iB,GAAIqK,EAAU6G,GAAIA,GAIxFpV,KAAKurB,oBAAsBhd,CAhB3B,CAiBJ,I,4FAAC,CA9uBe,CAAkClH,KAmvBtDnG,OAAOwX,OAAOuR,EAAiB9kB,UAAWsqB,GAE1C,UAGIluB,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQzF,iBAAmBA,E,4BCzyBzC,SAAS0F,EAAqBC,GAC7B,IAC2B,mBAAfA,IACVA,EAAaC,QAGd,IAAInc,EAAQ,IAAIkc,EAAW,KAAa,KAAKE,KAAK,MAClD,QAASpc,GAA6B,IAApBA,EAAM,GAAGtS,MAC5B,CAAE,MAAOV,GAAQ,CACjB,OAAO,CACR,CACA,IAAIqvB,EAAkBJ,IAOtB,SAASK,EAAMC,GACd,GAAyB,MAArBA,EAAOrT,OAAO,GACjB,MAAM,IAAInd,MAAMwwB,EAAS,+BAE1B,OAAOA,EAAOrT,OAAO3O,MAAM,EAAGgiB,EAAOrT,OAAO7F,YAAY,KACzD,CAWA,SAASmZ,EAAcD,EAAQpgB,GAC9B,GAAyB,MAArBogB,EAAOrT,OAAO,GACjB,MAAM,IAAInd,MAAM,IAAMwwB,EAAOrT,OAAS,wCAEvC,IAAK/M,GAA4B,iBAAXA,EACrB,MAAM,IAAIpQ,MAAM+D,KAAKqC,UAAUgK,GAAU,0BAE1C,IAAuC,IAAnCogB,EAAOrT,OAAOnD,QAAQ5J,GACzB,MAAM,IAAIpQ,MAAM,IAAMoQ,EAAS,gBAAkBogB,EAAOrT,OAAS,KAElE,GAAe,MAAX/M,GAAoD,IAAlCogB,EAAOrT,OAAOnD,QAAQ5J,GAC3C,MAAM,IAAIpQ,MAAM,IAAMoQ,EAAS,qCAAuCogB,EAAOrT,OAAS,KAEvF,OAAO,IAAIiT,OAAOI,EAAOrT,OAAOvO,QAAQwB,EAAQ,IAAKkgB,EAAkB,IAAM,GAC9E,CAQA,SAASI,EAAIhiB,GACZ,IAAIxF,EAAO3I,KACX,OAAO,IAAI6vB,OACVrmB,MAAMrE,UAAU8I,MACd9O,KAAK4O,WACL9H,KAAI,SAAUmqB,GACd,IAAIC,EAAwB,iBAATD,EACnB,GAAIC,QAAkBlQ,IAATxX,GAA+B,MAATynB,EAClC,MAAM,IAAI3wB,MAAM,yDAEjB,OAAO4wB,EAAQD,EAAOA,EAAKxT,MAC5B,IACC9W,KAAK,IACPiqB,EAAkB,KAAO,IAE3B,CAQA,SAASO,EAAKniB,GACb,GAAyB,IAArBJ,UAAU3M,OACb,MAAM,IAAI3B,MAAM,0BAEjB,OAAO0wB,EAAI3R,MAAM8R,EAAM,CAAC,OAAOC,OAAO/mB,MAAMrE,UAAU8I,MAAM9O,KAAK4O,WAAY,CAAC,MAC/E,CA4BA,IASIyiB,EAAO,mDACPT,IAEHS,EAAOL,EAAI,IAAKH,EAAMQ,GAAO,yBAA0B,MAGxD,IAAIC,EAAS,qBACTC,EAAUV,EAAMS,GAGhBE,EAAIR,EAAIM,EAAQ,KAIhBG,EAAQT,EAAIM,EAAQ,KAIpBI,EACH,qIACGd,IAEHc,EAAgBV,EAAI,IAAKH,EAAMa,GAAgB,yBAA0B,MAE1E,IAIIC,EAAWX,EAAI,IAJGH,EAAMa,GAIab,EAAM,eAAgBA,EAAM,gCAAiC,KAGlGe,EAAOZ,EAAIU,EAAeC,EAAU,KAQpCE,EAAUb,EAAIW,EAAU,KASxBG,EAAYd,EAAI,IAAKY,EAAM,KAG3BG,EAAUZ,EAAK,8BAQfa,EAAYb,EAAKW,EAAW,IAAKC,GAKjCE,EAAcjB,EAAI,IAAKY,EAAM,KAI7BM,EAAcf,EACjBH,EAAI,IAAKG,EAAK,SAAU,IAAKc,EAAa,IAAKD,GAAY,IAAK,KAChE,IACAhB,EAAI,IAAKG,EAAK,SAAU,IAAKc,EAAa,IAAKD,GAAY,IAAK,MAK7DG,EAAWhB,EAAK,IAAKA,EAAK,SAAU,IAAKa,GAAY,IAAK,IAAK,IAAK,IAAKb,EAAK,SAAU,IAAKa,GAAY,IAAK,KAa9GI,EAASpB,EARSD,EAAcW,EAAe,KAIlCX,EAAcY,EAAU,KAIK,KAiB1CU,EAAQrB,EAAIoB,EAAQjB,EAAK,IAAKiB,GAAS,KACvCE,EAActB,EAAI,IAAKqB,EAAO,KAC9BE,EAAcvB,EAAI,IAAKqB,EAAO,KAI9BG,EAAgBrB,EAAK,mBAUrBsB,EAAKzB,EAAI,OAAQ,IAAKY,EAAM,IAAKT,EAAKK,EAAG,IAAKH,EAAM,OAAQ,IAAK,OAIjEqB,EAAY,6CAIZC,EAAexB,EAAK,IAAKuB,EAAW,KAAM,IAAK,IAAK3B,EAAc2B,EAAW,KAAM,MAKnFE,EAAgB,UAIhBC,EAAU7B,EAAI4B,EAAezB,EAAKJ,EAAcM,EAAM,KAAM,IAAKL,EAAI,IAAKD,EAAcM,EAAM,OAAQ,IAHxF,UAKdyB,EAAS,UAMTC,EAAQ5B,EACXH,EAAI,KAAMS,EAAOqB,EAAQ3B,EAAKM,EAAO,KAAMA,EAAOY,GAAQ,IAAKZ,EAAO,QACtE,IACAT,EAAI,KAAMS,EAAOqB,EAAQrB,EAAO,OAoC7BuB,EAAc7B,EAAK,QAAS,IAAK,MAAO,IAAK4B,EAAO,IAJzC/B,EAAI,YA7BM,WA2CrBiC,EAAcjC,EARM,YAQiBQ,EAAGL,EAAKkB,EAAO,IAAKJ,GAAcT,EAAGL,EAAK6B,EAAa,IAAKf,GAAcR,EAAO,KAKtHyB,EAAelC,EAAI,WAAYQ,EAAG,KAAMC,EAAOG,EAAMT,EAAKM,EAAO,KAAMA,EAAOG,GAAO,IAAKH,EAAO,MAIjG0B,EAAcnC,EAAI,KAAMS,EAAOI,EAASV,EAAKM,EAAO,KAAMA,EAAOI,GAAU,IAAKJ,EAAO,MAIvF2B,EAAiBjC,EAAK+B,EAAc,IAAKC,GAczCE,EAAUlC,EAAK,yDAA0D,IAAKiC,GAK9EE,EAAcnC,EAAK,qBAAsB,IAAKA,EAAKA,EAAK,SAAUK,GAAI,IAAKW,IAoB3EoB,EAAcvC,EANO,YAMiBQ,EAAGI,EARhCT,EAAKK,EAAGI,EAAMJ,EAAG6B,EAAS7B,EAAG8B,GAQiB,IAAK7B,EAAO,KAGnE+B,EAAsB,sBACtBC,EAAoCtC,EAAK,IAAMqC,EAAsB,IAAK,IAAK,IAAMA,EAAsB,KAC3GE,EAAS,SACTC,EAAS,SAGTC,EAAazC,EAAKA,EAAKuC,EAAQlC,EAAGgB,GAAgB,IAAKrB,EAAKwC,EAAQnC,EAAGmB,EAAcnB,EAAGgB,IACxFqB,EAAmB7C,EACtB,IACAG,EACCA,EAAKuC,EAAQlC,EAAG,wBAAyBgB,EAAe,KACxD,IACArB,EAAKwC,EAAQnC,EAAG,mBAAoBmB,EAAc,IAAKnB,EAAG,oBAAqBgB,EAAe,OAM5FsB,EAAY3C,EAAKK,EAAG,QAASA,EAAGI,GAMhCmC,EAAoB,WAGpBC,EAAShD,EAAI+C,EAAmBvC,EAAGI,EAAMJ,EAL7BL,EAAKe,EAAa,IAAKf,EAAKyC,EAAYE,EAAW,MAKRrC,EAAO,KAG9DwC,EAAQ9C,EAAKe,EAAa,IAAK0B,GAM/BM,EAAa/C,EAAK6C,EAAQ,IAHjBhD,EAAI+C,EAAmBvC,EAAG,IAAKA,EAAGI,EAAMJ,EAAGyC,EAAOxC,EAAO,MAOlE0C,GAAWnD,EAAI2C,EAAQnC,EAAGmB,GAG1ByB,GAAepD,EAAI,aAAcQ,EAAGI,EAAMJ,EAAGL,EAAKyC,EAAY,IAAKO,IAAW1C,EAAO,KAIrF4C,GAAKrD,EAAIS,EAAO,IAAKA,GAKrB6C,GAAa,UAGbC,GAAcvD,EAAIQ,EAAG,UAAW6C,GAAIlD,EAAK,IAAKmD,GAAY,IAAK,IAAK,IAAKA,GAAY,MAGrFE,GAAU,0BASVC,GAAUzD,EAAI,UAAWuD,GANVpD,EAAKK,EAAG,WAAY6C,GAAIlD,EAAK,IAAKqD,GAAS,IAAK,IAAK,IAAKA,GAAS,MAM9B,IAH3CrD,EAAKK,EAAG,aAAc6C,GAAIlD,EAAK,IAAKA,EAAK,MAAO,IAAK,MAAO,IAAK,IAAK,IAAKA,EAAK,MAAO,IAAK,MAAO,MAG3C,IAAKM,EAAO,OAgC7EiD,GAAQ1D,EAAIK,EAAM,KADV,SASRsD,GAAS3D,EAVC,cAUY0D,IAG1B90B,EAAQixB,MAAQA,EAChBjxB,EAAQmxB,cAAgBA,EACxBnxB,EAAQ4wB,qBAAuBA,EAC/B5wB,EAAQoxB,IAAMA,EACdpxB,EAAQuxB,KAAOA,EACfvxB,EAAQ4zB,oBAAsBA,EAC9B5zB,EAAQ6zB,kCAAoCA,EAC5C7zB,EAAQ2zB,YAAcA,EACtB3zB,EAAQg1B,YAvBU,YAwBlBh1B,EAAQi1B,UAvBQ,MAwBhBj1B,EAAQ+0B,OAASA,GACjB/0B,EAAQyxB,KAAOA,EACfzxB,EAAQizB,QAAUA,EAClBjzB,EAAQgzB,cAAgBA,EACxBhzB,EAAQk1B,YA/OU,SAgPlBl1B,EAAQm1B,mBAvCiB,YAwCzBn1B,EAAQqzB,YAAcA,EACtBrzB,EAAQs0B,WAAaA,EACrBt0B,EAAQsyB,YAAcA,EACtBtyB,EAAQg0B,WAAaA,EACrBh0B,EAAQi0B,iBAAmBA,EAC3Bj0B,EAAQgyB,KAAOA,EACfhyB,EAAQw0B,aAAeA,GACvBx0B,EAAQoyB,UAAYA,EACpBpyB,EAAQqyB,YAAcA,EACtBryB,EAAQ6yB,GAAKA,EACb7yB,EAAQ+zB,OAASA,EACjB/zB,EAAQ+yB,aAAeA,EACvB/yB,EAAQyyB,MAAQA,EAChBzyB,EAAQ0yB,YAAcA,EACtB1yB,EAAQ2yB,YAAcA,EACtB3yB,EAAQ4xB,EAAIA,EACZ5xB,EAAQ2xB,QAAUA,EAClB3xB,EAAQ6xB,MAAQA,EAChB7xB,EAAQ8zB,OAASA,EACjB9zB,EAAQ4yB,cAAgBA,EACxB5yB,EAAQo1B,8BAtZ4B,IAuZpCp1B,EAAQgxB,gBAAkBA,EAC1BhxB,EAAQ60B,QAAUA,E,6DCvgBlB,SAASQ,EAAgBx0B,GACrB,KAAMI,gBAAgBo0B,GAClB,MAAM,IAAInwB,UAAU,8DAGxBjE,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,oCAIlBS,KAAKJ,QAAUA,GAAW,CAAC,EAK3BI,KAAKmE,SAAWnE,KAAKJ,QAAQuE,SAG7BnE,KAAK4oB,MAAQ5oB,KAAKJ,QAAQy0B,WAAW/uB,EAAI,IAAMtF,KAAKJ,QAAQy0B,WAAW9uB,EAGvEvF,KAAK6oB,IAAM7oB,KAAKJ,QAAQ00B,SAAShvB,EAAI,IAAMtF,KAAKJ,QAAQ00B,SAAS/uB,EAGjEvF,KAAKu0B,cAAgBv0B,KAAKJ,QAAQ40B,UAGlCx0B,KAAKwE,QAAUxE,KAAKJ,QAAQ6E,MAG5BzE,KAAKsE,IAAMtE,KAAKJ,QAAQ2E,IAGxBvE,KAAK0E,YAAc1E,KAAKJ,QAAQ8E,YAGhC1E,KAAKy0B,aAAez0B,KAAKJ,QAAQ80B,gBAGjC10B,KAAK20B,SAAY30B,KAAKJ,QAA8B,uBAAI,OAAS,QAGjEI,KAAK6E,aAAe7E,KAAKJ,QAAQiF,aAGjC7E,KAAK4E,SAAW5E,KAAKJ,QAAQgF,SAG7B5E,KAAK40B,eAAiB50B,KAAKJ,QAAQg1B,cACvC,CAKAR,EAAelvB,UAAY,iBAE3BkvB,EAAejvB,UAAY,CASvBC,YAAcgvB,EAMdS,iBAAmB,WACf,IAAIC,EAAQ,GACZ,GAAkC,IAA9B90B,KAAKu0B,cAAcnzB,OACnB,IAAK,IAAIgU,EAAI,EAAGA,EAAIpV,KAAKu0B,cAAcnzB,OAAQgU,IAAK,CAChD,IAAIhF,EAAMpQ,KAAKu0B,cAAcnf,GAC7B0f,EAAMlvB,KAAKwK,EAAI9K,EAAI,IAAM8K,EAAI7K,EACjC,CAGJ,OAAOuvB,EAAMhvB,KAAK,IACtB,EAMAivB,kBAAoB,WAChB,OAAO/0B,KAAK40B,eAAe9uB,KAAK,IACpC,EAMAkvB,WAAa,WACT,OAAOh1B,KAAKwE,OAChB,EAMAgB,gBAAkB,WACd,MAA0B,MAAtBxF,KAAK6E,aACE,QAEe,OAAtB7E,KAAK6E,aACE,YAEJ,EACX,EAMAowB,gBAAkB,WACd,OAAIj1B,KAAKy0B,aACEz0B,KAAKy0B,aAEL,EAEf,EAMAhvB,eAAiB,WACb,IAAIC,EAAkB,GAEtB,GAAgC,IAA5B1F,KAAK0E,YAAYtD,OACjB,IAAK,IAAIuE,EAAI,EAAGA,EAAI3F,KAAK0E,YAAYtD,OAAQuE,IACzCD,EAAgBE,KAAKpC,KAAKqC,UAAU7F,KAAK0E,YAAYiB,KAG7D,OAAOD,EAAgBI,KAAK,IAChC,GAQJsuB,EAAejvB,UAAUa,UAAY,WACjC,IAAIC,EAAM,GA8EV,OA5EAA,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAKmE,WAGb8B,EAAIL,KAAK,CACLD,EAAI,QACJO,EAAIlG,KAAK4oB,QAGb3iB,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAK6oB,MAGb5iB,EAAIL,KAAK,CACLD,EAAI,iBACJO,EAAI,YAGJlG,KAAKy0B,cACLxuB,EAAIL,KAAK,CACLD,EAAI,eACJO,EAAIlG,KAAKi1B,oBAIbj1B,KAAKu0B,eACLtuB,EAAIL,KAAK,CACLD,EAAI,gBACJO,EAAIlG,KAAK60B,qBAIb70B,KAAKwE,SACLyB,EAAIL,KAAK,CACLD,EAAI,UACJO,EAAIlG,KAAKg1B,eAIbh1B,KAAK0E,aACLuB,EAAIL,KAAK,CACLD,EAAI,cACJO,EAAIlG,KAAKyF,mBAIbzF,KAAKsE,KACL2B,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsE,MAIbtE,KAAK6E,cACLoB,EAAIL,KAAK,CACLD,EAAI,eACJO,EAAIlG,KAAKwF,oBAIbxF,KAAK4E,UACLqB,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAK4E,WAIb5E,KAAK40B,gBACL3uB,EAAIL,KAAK,CACLD,EAAI,iBACJO,EAAIlG,KAAK+0B,sBAIV9uB,CACX,EAEA,S,oNCjPA,MAAM,EAA+BjH,GAAGk2B,KAAKC,Q,aCA7C,MAAM,EAA+Bn2B,GAAGk2B,KAAKE,a,aCgBzC/1B,EAAS2Q,EAAAA,EAAO1Q,UAAU,WAE9B+1B,IAAAA,UAAkBC,gBAAkB,WAChC,IAAIr2B,EAAQe,KAAKu1B,WACjB,GAAKt2B,KAGDuK,MAAM4E,QAAQnP,IAA2B,IAAjBA,EAAMmC,QAAlC,CAGA,IAAI8a,EAAOjd,EAAMu2B,UACjB,GAAItZ,EAAM,CACN,IAAIuZ,EAAYvZ,EAAKwZ,WAErB,GAAIlsB,MAAM4E,QAAQqnB,GAAY,CAC1B,IAAIE,EAAK,QACTA,GAAMF,EAAU,GAAK,IACrBE,GAAMF,EAAU,GAAK,IACrBE,GAAMF,EAAU,GAAK,IAErBA,EADAE,GAAMF,EAAU,GAAK,GAEzB,CACA,GAAI/b,EAAAA,EAAMkc,MAAMH,GAAY,CACxB,IAAII,EAAanc,EAAAA,EAAMoc,UAAUL,GACjCz1B,KAAKmH,IAAI,OAAQ0uB,EAAWE,KAC5B/1B,KAAKmH,IAAI,eAAgB0uB,EAAW5d,QACxC,MACIjY,KAAKmH,IAAI,OAAQsuB,GACjBz1B,KAAKmH,IAAI,eAAgB,EAEjC,CArBA,CAsBJ,EAEAkuB,IAAAA,UAAkBW,kBAAoB,WAClC,IAAI/2B,EAAQe,KAAKu1B,WACjB,GAAKt2B,KAGDuK,MAAM4E,QAAQnP,IAA2B,IAAjBA,EAAMmC,QAAlC,CAGA,IAAI2W,EAAS9Y,EAAMg3B,YACnB,GAAIle,EAAQ,CACR,IAAIme,EAAcne,EAAO2d,WAEzB,GAAIlsB,MAAM4E,QAAQ8nB,GAAc,CAC5B,IAAIC,EAAK,QACTA,GAAMD,EAAY,GAAK,IACvBC,GAAMD,EAAY,GAAK,IACvBC,GAAMD,EAAY,GAAK,IAEvBA,EADAC,GAAMD,EAAY,GAAK,GAE3B,CACA,GAAIxc,EAAAA,EAAMkc,MAAMM,GAAc,CAC1B,IAAIE,EAAe1c,EAAAA,EAAMoc,UAAUI,GACnCl2B,KAAKmH,IAAI,SAAUivB,EAAaL,KAChC/1B,KAAKmH,IAAI,iBAAkBivB,EAAane,QAC5C,MACIjY,KAAKmH,IAAI,SAAU+uB,GACnBl2B,KAAKmH,IAAI,iBAAkB,GAE/BnH,KAAKmH,IAAI,eAAgB4Q,EAAOse,WACpC,CAtBA,CAuBJ,EAEAhB,IAAAA,UAAkBiB,iBAAmB,WACjC,IAAIr3B,EAAQe,KAAKu1B,WACjB,GAAKt2B,KAGDuK,MAAM4E,QAAQnP,IAA2B,IAAjBA,EAAMmC,QAAlC,CAGA,IAAIm1B,OAA8BpW,IAArBngB,KAAKw2B,IAAI,QAEtB,GADYv3B,EAAMw3B,WACLF,EAAQ,CACjB,IAAIra,EAAOjd,EAAMw3B,UAAUjB,UAC3B,GAAItZ,EAAM,CACN,IAAIuZ,EAAYvZ,EAAKwZ,WAErB,GAAIlsB,MAAM4E,QAAQqnB,GAAY,CAC1B,IAAIE,EAAK,QACTA,GAAMF,EAAU,GAAK,IACrBE,GAAMF,EAAU,GAAK,IACrBE,GAAMF,EAAU,GAAK,IAErBA,EADAE,GAAMF,EAAU,GAAK,GAEzB,CACA,GAAI/b,EAAAA,EAAMkc,MAAMH,GAAY,CACxB,IAAII,EAAanc,EAAAA,EAAMoc,UAAUL,GACjCz1B,KAAKmH,IAAI,aAAc0uB,EAAWE,KAClC/1B,KAAKmH,IAAI,qBAAsB0uB,EAAW5d,QAC9C,MACIjY,KAAKmH,IAAI,aAAcsuB,GACvBz1B,KAAKmH,IAAI,qBAAsB,EAEvC,CACA,IAAI4Q,EAAS9Y,EAAMw3B,UAAUR,YAC7B,GAAIle,EAAQ,CACR,IAAIme,EAAcne,EAAO2d,WAEzB,GAAIlsB,MAAM4E,QAAQ8nB,GAAc,CAC5B,IAAIC,EAAK,QACTA,GAAMD,EAAY,GAAK,IACvBC,GAAMD,EAAY,GAAK,IACvBC,GAAMD,EAAY,GAAK,IAEvBA,EADAC,GAAMD,EAAY,GAAK,GAE3B,CACA,GAAIxc,EAAAA,EAAMkc,MAAMM,GAAc,CAC1B,IAAIE,EAAe1c,EAAAA,EAAMoc,UAAUI,GACnCl2B,KAAKmH,IAAI,eAAgBivB,EAAaL,KACtC/1B,KAAKmH,IAAI,uBAAwBivB,EAAane,QAClD,MACIjY,KAAKmH,IAAI,eAAgB+uB,GACzBl2B,KAAKmH,IAAI,uBAAwB,GAErCnH,KAAKmH,IAAI,qBAAsB4Q,EAAOse,WAC1C,CACAr2B,KAAKmH,IAAI,aAAclI,EAAMw3B,UAAUC,WAAaC,EAAQC,aAAaC,MACzE72B,KAAKmH,IAAI,kBAAmBlI,EAAMw3B,UAAUK,gBAAkBH,EAAQC,aAAaG,UACvF,CAjDA,CAkDJ,EAEA1B,IAAAA,UAAkB2B,kBAAoB,WAClC,IAAI/3B,EAAQe,KAAKu1B,WACjB,GAAKt2B,KAGDuK,MAAM4E,QAAQnP,IAA2B,IAAjBA,EAAMmC,QAAlC,CAGA,IAAI2T,EAAQ9V,EAAMg4B,WAClB,GAAIliB,EAGA,GAAIA,aAAiBmiB,IAAW,CAC5B,IAAIlf,EAAQjD,EAAM2gB,WAElB,GAAIlsB,MAAM4E,QAAQ4J,GAAQ,CACtB,IAAImf,EAAI,QACRA,GAAKnf,EAAM,GAAK,IAChBmf,GAAKnf,EAAM,GAAK,IAChBmf,GAAKnf,EAAM,GAAK,IAEhBA,EADAmf,GAAKnf,EAAM,GAAK,GAEpB,CAEA,GAAIA,EAAO,CACP,IAAIof,EAAY1d,EAAAA,EAAMoc,UAAU9d,GAChChY,KAAKmH,IAAI,eAAgBiwB,EAAUrB,IACvC,CACA,IAAIsB,EAAYtiB,EAAMuiB,WACtB,OAAQC,KAAKC,MAAkB,EAAZH,GAAiB,GAChC,KAAK,EACL,IAAK,GACDr3B,KAAKmH,IAAI,cAAe,SACxB,MACJ,KAAK,EACDnH,KAAKmH,IAAI,cAAe,UACxB,MACJ,KAAK,IACL,KAAK,EACDnH,KAAKmH,IAAI,cAAe,SAOhC,IAAIswB,EAAW1iB,EAAM2iB,SACjBD,GACAz3B,KAAKmH,IAAI,gBAAiBswB,GAM9Bz3B,KAAK23B,MAAM,eACX33B,KAAK23B,MAAM,uBACX33B,KAAK23B,MAAM,iBACX33B,KAAK23B,MAAM,uBACX33B,KAAK23B,MAAM,yBACX33B,KAAK23B,MAAM,gBACf,KAAO,CACH,IAAIC,EAAU7iB,EAAMygB,UACpB,GAAIoC,EAAS,CACT,IAAIC,EAAeD,EAAQlC,WAE3B,GAAIlsB,MAAM4E,QAAQypB,GAAe,CAC7B,IAAIC,EAAM,QACVA,GAAOD,EAAa,GAAK,IACzBC,GAAOD,EAAa,GAAK,IACzBC,GAAOD,EAAa,GAAK,IAEzBA,EADAC,GAAOD,EAAa,GAAK,GAE7B,CACA,GAAIne,EAAAA,EAAMkc,MAAMiC,GAAe,CAC3B,IAAIE,EAAgBre,EAAAA,EAAMoc,UAAU+B,GACpC73B,KAAKmH,IAAI,cAAe4wB,EAAchC,KACtC/1B,KAAKmH,IAAI,sBAAuB4wB,EAAc9f,QAClD,MACIjY,KAAKmH,IAAI,cAAe0wB,GACxB73B,KAAKmH,IAAI,sBAAuB,EAExC,CACA,IAAI6wB,EAAYjjB,EAAMkhB,YACtB,GAAI+B,EAAW,CACX,IAAIC,EAAiBD,EAAUtC,WAE/B,GAAIlsB,MAAM4E,QAAQ6pB,GAAiB,CAC/B,IAAIC,EAAM,QACVA,GAAOD,EAAe,GAAK,IAC3BC,GAAOD,EAAe,GAAK,IAC3BC,GAAOD,EAAe,GAAK,IAE3BA,EADAC,GAAOD,EAAe,GAAK,GAE/B,CACA,GAAIve,EAAAA,EAAMkc,MAAMqC,GAAiB,CAC7B,IAAIE,EAAkBze,EAAAA,EAAMoc,UAAUmC,GACtCj4B,KAAKmH,IAAI,gBAAiBgxB,EAAgBpC,KAC1C/1B,KAAKmH,IAAI,wBAAyBgxB,EAAgBlgB,QACtD,MACIjY,KAAKmH,IAAI,gBAAiB8wB,GAC1Bj4B,KAAKmH,IAAI,wBAAyB,GAEtCnH,KAAKmH,IAAI,sBAAuB6wB,EAAU3B,WAC9C,CACA,IAAI+B,EAASrjB,EAAMsjB,YACnBr4B,KAAKmH,IAAI,gBAAiBixB,EAC9B,CAnGJ,CAqGJ,EAoCA,IAAIzB,EAAU,CAKV2B,wBAAyB,EAKzBC,aAAe,CACXtiB,IAAM+V,EAAAA,EAAqB,YAC3BzP,OAAS,CAAC,GAAK,GACfjN,MAAQ,GAMZkpB,eAAiB,CACbJ,OAAS,GACTlc,KAAO,CACHjE,QAAU,EACVD,MAAQ,CAAC,EAAG,EAAG,EAAG,IAEtBD,OAAS,CACLD,MAAQ,EACRG,QAAU,EACVD,MAAQ,CAAC,EAAG,EAAG,EAAG,KAO1BygB,eAAiB,CACb3gB,MAAQ,EACRG,QAAU,EACVD,MAAQ,CAAC,IAAK,IAAK,IAAK,IAM5B0gB,aAAe,CACXzgB,QAAU,EACVD,MAAQ,CAAC,EAAG,EAAG,EAAG,IAOtB4e,aAAe,CACXC,KAAO,YACPE,UAAY,OACZhf,OAAS,CACLC,MAAQ,CAAC,IAAK,IAAK,IAAK,GACxBF,MAAQ,EACR6gB,SAAW,GAEfzc,KAAO,CACHjE,QAAU,EACVD,MAAQ,CAAC,EAAG,EAAG,EAAG,KAgC1B4gB,YAAc,WACV,MAAO,CACH,OACA,OACA,eACA,SACA,iBACA,eACA,cACA,sBACA,gBACA,wBACA,sBACA,gBACA,gBACA,eACA,cACA,aACA,qBACA,eACA,qBACA,uBACA,aACA,kBAER,EA2CAC,0BAA4B,SAAUC,GAElC,IAAI75B,EAAQ,KAGRW,EAAU,CAAC,EAMXm5B,EAAS,KACb,GAAID,EAAQtC,IAAI,iBACZsC,EAAQtC,IAAI,gBACZsC,EAAQtC,IAAI,iBAAkB,EAC9BuC,EAAS,CAAC,GAEE,IAAI/4B,KAAKu4B,aAAatiB,IAClC8iB,EAAe,OAAI/4B,KAAKu4B,aAAahc,OACrC,IAAIyc,EAAeF,EAAQtC,IAAI,iBAC3BwC,IACsD,IAAlDA,EAAanpB,OAAO,2BAEpBkpB,EAAY,IAAIC,GAOxB,IAAIC,EAAcH,EAAQtC,IAAI,gBAC1B9c,EAAAA,EAAMwf,MAAMD,KACZF,EAAc,MAAIrf,EAAAA,EAAMC,UAAUsf,EAAa,IAEnD,IAAIrf,EAAOkf,EAAQtC,IAAI,eACvB,GAAI5c,EACA,OAAQA,GACJ,IAAK,QACDmf,EAAc,MAAI,GAClB,MACJ,IAAK,SACDA,EAAc,MAAI,EAClB,MACJ,IAAK,QACDA,EAAc,MAAI,IAClB,MACJ,QACIA,EAAc,MAAI/4B,KAAKu4B,aAAajpB,MAIpD,CAMA,IAAIyI,EAAS,MACT+gB,EAAQtC,IAAI,WACZsC,EAAQtC,IAAI,mBACZsC,EAAQtC,IAAI,oBACZze,EAAS,CAAC,GACI,MAAI2B,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,WAAYsC,EAAQtC,IAAI,mBAAqBx2B,KAAKy4B,eAAexgB,SAC/GF,EAAc,OAAK+gB,EAAQtC,IAAI,iBAAmBx2B,KAAKy4B,eAAe3gB,OAM1E,IAAIoE,EAAO,MACP4c,EAAQtC,IAAI,SACZsC,EAAQtC,IAAI,oBACZta,EAAO,CAAC,GACI,MAAIxC,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,SAAUsC,EAAQtC,IAAI,iBAAmBx2B,KAAK04B,aAAazgB,UAY3G,IAAIkhB,EAAc,KACdC,EAAY,KACZC,EAAkC,KAAxBP,EAAQtC,IAAI,QACtB6C,KACIP,EAAQtC,IAAI,eACZsC,EAAQtC,IAAI,0BACZ4C,EAAY,CAAC,GACI,MAAI1f,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,eAAgBsC,EAAQtC,IAAI,uBAAyBx2B,KAAK42B,aAAa1a,KAAKjE,WAE7H6gB,EAAQtC,IAAI,iBACZsC,EAAQtC,IAAI,yBACZsC,EAAQtC,IAAI,0BACZ2C,EAAc,CAAC,GACI,MAAIzf,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,iBAAkBsC,EAAQtC,IAAI,yBAA2Bx2B,KAAK42B,aAAa7e,OAAOE,SACrIkhB,EAAmB,OAAKL,EAAQtC,IAAI,uBAAyBx2B,KAAK42B,aAAa7e,OAAOD,QAS9F,IAAIwhB,EAAeR,EAAQtC,IAAI,kBAAoBx2B,KAAKw4B,eAAeJ,OACnEmB,EAAe,MACfT,EAAQtC,IAAI,kBACZsC,EAAQtC,IAAI,0BACZsC,EAAQtC,IAAI,2BACZ+C,EAAe,CAAC,GACI,MAAI7f,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,kBAAmBsC,EAAQtC,IAAI,0BAA4Bx2B,KAAKw4B,eAAezgB,OAAOE,SAC1IshB,EAAoB,OAAKT,EAAQtC,IAAI,wBAA0Bx2B,KAAKw4B,eAAezgB,OAAOD,OAE9F,IAAI0hB,EAAa,KAQjB,IAPIV,EAAQtC,IAAI,gBACZsC,EAAQtC,IAAI,2BACZgD,EAAa,CAAC,GACI,MAAI9f,EAAAA,EAAMC,UAAUmf,EAAQtC,IAAI,gBAAiBsC,EAAQtC,IAAI,wBAA0Bx2B,KAAKw4B,eAAetc,KAAKjE,UAIlI6gB,EAAQW,cAAe,CACvB,IAAIvtB,EAAO4sB,EAAQW,cAAcC,UACjC,OAAQxtB,GACJ,IAAK,SACL,IAAK,QACL,IAAK,aAED,IAAIytB,GAAW,EACXC,EAAgB,CAAC,EAiBrB,GAhBIL,IACAK,EAAsB,OAAI,IAAIC,IAAJ,CAAgBN,IAE1CC,IACAI,EAAoB,KAAI,IAAIE,IAAJ,CAAcN,IAEA,IAAtCt4B,OAAOC,KAAKy4B,GAAex4B,SAC3Bu4B,GAAW,EACXC,EAAsB,QAAKN,EAC3B15B,EAAe,MAAI,IAAIm6B,IAAJ,CAAgBH,IAGnCb,IACAn5B,EAAe,MAAI,IAAIs3B,IAAJ,CAAc6B,IAGjCM,EAAS,CACT,IAAIW,EAAc,CAAC,EAQnB,GANIb,IACAa,EAAoB,OAAI,IAAIH,IAAJ,CAAgBV,IAExCC,IACAY,EAAkB,KAAI,IAAIF,IAAJ,CAAcV,IAEA,IAApCl4B,OAAOC,KAAK64B,GAAa54B,OACzB44B,EAAkB,KAAIlB,EAAQtC,IAAI,QAClCwD,EAAuB,UAAIlB,EAAQtC,IAAI,oBAAsBx2B,KAAK42B,aAAaG,UAC/EiD,EAAkB,KAAIlB,EAAQtC,IAAI,eAAiBx2B,KAAK42B,aAAaC,KACrEj3B,EAAc,KAAI,IAAIq6B,IAAJ,CACd/4B,OAAOwX,OAAO,CAAC,EACX1Y,KAAK42B,aACLoD,SAKR,GAAIjB,GAAUY,EAAU,CACpB,IAAIO,EAAY,IAAID,IAAJ,CACZ/4B,OAAOwX,OAAO,CAAC,EACX1Y,KAAK42B,aAAc,CACf1a,KAAO,IAAI4d,IAAJ,CAAc95B,KAAK42B,aAAa1a,MACvCnE,OAAS,IAAI8hB,IAAJ,CAAgB75B,KAAK42B,aAAa7e,WAIvD,GAAImiB,EAAW,CACX,IAAIC,EAAiBD,EAAUxd,QAC/Byd,EAAeC,QAAQtB,EAAQtC,IAAI,SACnC52B,EAAc,KAAIu6B,CACtB,CACJ,CAER,CACA,MAEJ,IAAK,UACL,IAAK,eACGpiB,IACAnY,EAAgB,OAAI,IAAIi6B,IAAJ,CAAgB9hB,IAEpCmE,IACAtc,EAAc,KAAI,IAAIk6B,IAAJ,CAAc5d,IAEpC,MAEJ,IAAK,aACL,IAAK,kBAID,GAHInE,IACAnY,EAAgB,OAAI,IAAIi6B,IAAJ,CAAgB9hB,IAEpC/X,KAAKs4B,wBAA0Bpc,EAAM,CAMrC,IAAIme,EAAWvB,EAAQtC,IAAI,QAC3B,GAAI6D,IAA0B,YAAbA,GAAuC,iBAAbA,GAA8B,CACrEz6B,EAAc,KAAI,IAAIk6B,IAAJ,CAAc5d,GAChC,IAAIoe,EAAIxB,EAAQpc,QACZ6d,EAAsB,eAATruB,EAAyBipB,IAAUC,IACpD0D,EAAQ0B,YAAY,IAAID,EAAU,CAACD,EAAEb,cAAcgB,mBACvD,CACJ,EAMZ,CAQA,OAJoC,IAAhCv5B,OAAOC,KAAKvB,GAASwB,SACrBnC,EAAQ,IAAIgR,IAAJ,CAAUrQ,IAGfX,CACX,EAaAy7B,6BAA+B,SAAUC,GACrC,IAAKA,EACD,MAAO,GAGX,GAAyC,IAArCz5B,OAAOC,KAAKw5B,GAAcv5B,OAC1B,MAAO,GAyEX,OArEoB,SAAC03B,EAAS8B,GAC1B,GAAI9B,EAAQW,cAAe,CACvB,IAAIx6B,EAAQ,KAEZ,OADW65B,EAAQW,cAAcC,WAE7B,IAAK,QACL,IAAK,aAMD,IAAIj4B,EAAO,CAAC,EAIZ,GAHIk5B,EAAa1D,aACbx1B,EAAY,MAAIk5B,EAAa1D,YAE7B0D,EAAalE,WAAaqC,EAAQtC,IAAI,QAAS,CAC/C,IAAI0D,EAAYS,EAAalE,UAAU/Z,QACvCwd,EAAUE,QAAQtB,EAAQtC,IAAI,SAC9B/0B,EAAW,KAAIy4B,CACnB,CACAj7B,EAAQ,IAAIgR,IAAJ,CAAUxO,GAClB,MACJ,IAAK,SACD,IAAIo5B,EAAQ,CAAC,EAETC,EAAa,CAAC,EAOlB,GANIH,EAAanF,YACbsF,EAAW5e,KAAOye,EAAanF,WAE/BmF,EAAa1E,cACb6E,EAAW/iB,OAAS4iB,EAAa1E,aAEjC0E,EAAalE,WAAaqC,EAAQtC,IAAI,QAAS,CAC/C,IAAIuE,EAAkBJ,EAAalE,UAAU/Z,QAC7Cqe,EAAgBX,QAAQtB,EAAQtC,IAAI,SACpCqE,EAAMh5B,KAAOk5B,CACjB,CACuC,IAAnC75B,OAAOC,KAAK25B,GAAY15B,SAExB05B,EAAW1C,OAAS,EACpByC,EAAM9lB,MAAQ,IAAIglB,IAAJ,CAAgBe,IAElC77B,EAAQ,IAAIgR,IAAJ,CAAU4qB,GAClB,MACJ,IAAK,UACL,IAAK,eACD,IAAIG,EAAQ,CAAC,EACTL,EAAanF,YACbwF,EAAM9e,KAAOye,EAAanF,WAE1BmF,EAAa1E,cACb+E,EAAMjjB,OAAS4iB,EAAa1E,aAEhCh3B,EAAQ,IAAIgR,IAAJ,CAAU+qB,GAClB,MACJ,IAAK,aACL,IAAK,aACL,IAAK,kBACD,IAAIC,EAAQ,CAAC,EACTN,EAAa1E,cACbgF,EAAMljB,OAAS4iB,EAAa1E,aAEhCh3B,EAAQ,IAAIgR,IAAJ,CAAUgrB,GAG1B,MAAO,CAACh8B,EACZ,CACJ,CAEJ,EAQAi8B,gCAAkC,SAAUpC,GACxC,GAAIA,EAAQW,cAER,OADeX,EAAQW,cAAcC,WAEjC,IAAK,QACL,IAAK,aACDZ,EAAQ9B,oBACR8B,EAAQxC,mBACR,MACJ,IAAK,aACL,IAAK,kBACDwC,EAAQ9C,oBACR,MACJ,IAAK,UACL,IAAK,eACD8C,EAAQ9C,oBACR8C,EAAQxD,kBAMxB,EAyCA6F,0BAA4B,SAAUrC,GAClC,IAAI75B,EAAQ65B,EAAQvD,YAAcuD,EAAQsC,mBAC1C,GAAIn8B,EAAO,CAEP,GAAqB,mBAAVA,EAAsB,CAC7B,IAAIo8B,EAASp8B,EAAME,KAAKa,KAAM84B,EAAS,GACvC,IAAIuC,GAA4B,IAAlBA,EAAOj6B,OAKjB,OAJAnC,EAASuK,MAAM4E,QAAQitB,GAAWA,EAAO,GAAKA,EAC9CvC,EAAQwC,SAASr8B,EAKzB,CACAe,KAAKk7B,gCAAgCpC,EACzC,CACJ,EAkBAyC,mBAAqB,SAAUt8B,EAAOU,GAElC,OADAN,EAAOE,MAAM,WACN,IACX,GAGJ,S,wBCp3BAT,EAAOC,QAAUC,GAAGw8B,M,+CCUpB,QAVgB,WAIZ,MAAc,KAFFC,iBAAiBjzB,SAASsL,iBACpB4nB,iBAAiB,4BAKvC,C,8BCJA,SAASC,EAAYv2B,EAAaw2B,GACjCx2B,EAAYD,UAAYjE,OAAOmjB,OAAO5kB,MAAM0F,UAAW,CACtDC,YAAa,CAAE2B,MAAO3B,GACtBiD,KAAM,CAAEtB,MAAO3B,EAAYiD,KAAMwzB,YAAY,EAAMC,SAAUF,IAE/D,CAEA,IAAIG,EATc,EAAQ,MASSC,OAAO,CAIzCv8B,MAAO,QAKPw8B,eAAgB,iBAKhBC,mBAAoB,qBACpBC,sBAAuB,wBACvBC,mBAAoB,qBACpBC,sBAAuB,wBAKvBC,mBAAoB,qBACpBC,2BAA4B,6BAC5BC,cAAe,gBACfC,kBAAmB,oBACnBC,oBAAqB,sBACrBC,kBAAmB,oBACnBC,YAAa,cACbC,yBAA0B,2BAC1BC,eAAgB,iBAOhBC,mBAAoB,qBAKpBC,gBAAiB,kBAKjBC,kBAAmB,oBACnBC,cAAe,gBACfC,aAAc,eACdC,WAAY,aAKZC,iBAAkB,mBAClBC,mBAAoB,qBACpBC,aAAc,eACdC,qBAAsB,uBACtBC,eAAgB,iBAChBC,cAAe,gBACfC,iBAAkB,mBAClBC,aAAc,eACdC,gBAAiB,kBACjBC,UAAW,YACXC,yBAA0B,2BAC1BC,cAAe,gBACfC,aAAc,eACdC,eAAgB,iBAChBC,gBAAiB,kBACjBC,YAAa,gBAEVC,EAAoBn9B,OAAOC,KAAK46B,GAEpC,SAASuC,EAAwBv3B,GAChC,MAAwB,iBAAVA,GAAsBA,GAAS,GAAKA,GAAS,EAC5D,CAwCA,SAASw3B,EAAaC,EAAeC,GAvCrC,IAAuB13B,EAyClBu3B,EAAwBE,IAC3Bx+B,KAAKqI,KAAOg2B,EAAkBG,GAC9Bx+B,KAAK8B,QAAU28B,GAAiB,KAEhCz+B,KAAK8B,QAAU08B,EACfx+B,KAAKqI,KA7CkB,iBADFtB,EA8CK03B,IA7CS13B,EAAM+P,UAAU/P,EAAM3F,OAAS26B,EAAiBt8B,MAAM2B,UAAY26B,EAAiBt8B,MA6C3Eg/B,EAAgB1C,EAAiBt8B,OAEzEA,MAAMi/B,mBAAmBj/B,MAAMi/B,kBAAkB1+B,KAAMu+B,EAC5D,CACA5C,EAAY4C,GAAc,GAC1Br9B,OAAOy9B,iBAAiBJ,EAAap5B,UAAW,CAC/Cy5B,KAAM,CACL/C,YAAY,EACZrF,IAAK,WACJ,IAAIoI,EAAOP,EAAkB5kB,QAAQzZ,KAAKqI,MAC1C,OAAIi2B,EAAwBM,GAAcA,EACnC,CACR,KAiCF,IA7BA,IAAIC,EAAgB,CACnBC,eAAgB,EAChBC,mBAAoB,EACpBC,sBAAuB,EACvBC,mBAAoB,EACpBC,sBAAuB,EACvBC,oBAAqB,EACrBC,4BAA6B,EAC7BC,cAAe,EACfC,kBAAmB,EACnBC,oBAAqB,GACrBC,kBAAmB,GACnBC,WAAY,GACZC,yBAA0B,GAC1BC,cAAe,GACfC,mBAAoB,GACpBC,eAAgB,GAChBC,kBAAmB,GACnBC,aAAc,GACdC,YAAa,GACbC,UAAW,GACXC,iBAAkB,GAClBC,mBAAoB,GACpBC,YAAa,GACbC,sBAAuB,GACvBC,eAAgB,IAGbC,EAAUr/B,OAAOq/B,QAAQ1B,GACpBzpB,EAAI,EAAGA,EAAImrB,EAAQn/B,OAAQgU,IAAK,CAExCmpB,EADUgC,EAAQnrB,GAAG,IACDmrB,EAAQnrB,GAAG,EAChC,CASA,SAASorB,EAAW1+B,EAAS2+B,GAC5BzgC,KAAK8B,QAAUA,EACf9B,KAAKygC,QAAUA,EACXhhC,MAAMi/B,mBAAmBj/B,MAAMi/B,kBAAkB1+B,KAAMwgC,EAC5D,CACA7E,EAAY6E,GAEZzhC,EAAQw/B,aAAeA,EACvBx/B,EAAQg9B,iBAAmBA,EAC3Bh9B,EAAQ8/B,cAAgBA,EACxB9/B,EAAQyhC,WAAaA,C,+LClId,MAAME,EAAkB,KAElBC,EAAe,KAG5B,IAAItR,EAAK,CAAC,EAEVA,EAAGqR,gBAAkBA,EACrBrR,EAAGsR,aAAeA,EAGlBtR,EAAGuR,UAAY,CAAC,EAChBvR,EAAGuR,UAAUC,IAAM,IAEnBxR,EAAGC,SAAW,IAEdD,EAAGC,SAASwR,WAAa,IAEzBzR,EAAGC,SAASyR,aAAe,EAAArb,EAC3B2J,EAAGC,SAASvK,KAAO,CAAC,EACpBsK,EAAGC,SAASvK,KAAKic,UAAY,IAE7B3R,EAAGC,SAAS2R,qBAAuB,EAAAvb,EACnC2J,EAAGC,SAAS4R,aAAe,CAAC,EAC5B7R,EAAGC,SAAS4R,aAAaC,kBAAoB,IAE7C9R,EAAGC,SAAS8R,OAAS,IAErB/R,EAAGC,SAAS+R,iBAAmB,IAE/BhS,EAAGC,SAASgS,cAAgB,IAC5BjS,EAAGC,SAASiS,MAAQ,CAAC,EACrBlS,EAAGC,SAASiS,MAAMC,iBAAmB,IAErCnS,EAAG5vB,MAAQ,IACX4vB,EAAGoS,OAAS,IAEZ,S,8BChGA,SAASH,IACL,KAAMthC,gBAAgBshC,GAClB,MAAM,IAAIr9B,UAAU,6DAGxBjE,KAAK0hC,UAAY,KAEjB1hC,KAAK2hC,cAAgB,KAErB3hC,KAAKukB,KAAO,CACRlb,KAAO,KACPC,MAAQ,KACRH,IAAM,KACNC,OAAS,MAGbpJ,KAAK4hC,cAAgB,KAErB5hC,KAAK6hC,kBAAoB,EAC7B,C,iBAEAP,EAAcn8B,UAAY,CAEtBC,YAAck8B,GAIlB,S,wBCvCAxiC,EAAOC,QAAUC,GAAGC,K,8BCYpB,SAAS+hC,IACL,KAAMhhC,gBAAgBghC,GAClB,MAAM,IAAI/8B,UAAU,yDAGxBjE,KAAK8hC,EAAI,IACb,C,iBAEAd,EAAU77B,UAAY,CAElBC,YAAc47B,GAIlB,S,uBC1BA,SAMC,WACG,aAEI,EAMA,WAIJ,IAAIe,EAAO,WAAY,EACnBC,EAAgB,YAChBC,SAAe1gC,SAAWygC,UAA0BzgC,OAAOwkB,YAAcic,GACzE,kBAAkBpuB,KAAKrS,OAAOwkB,UAAUD,WAGxCoc,EAAa,CACb,QACA,QACA,OACA,OACA,SAGAC,EAAiB,CAAC,EAClBC,EAAgB,KAGpB,SAASC,EAAWjyB,EAAKkyB,GACrB,IAAI5iC,EAAS0Q,EAAIkyB,GACjB,GAA2B,mBAAhB5iC,EAAO6iC,KACd,OAAO7iC,EAAO6iC,KAAKnyB,GAEnB,IACI,OAAOoyB,SAASr9B,UAAUo9B,KAAKpjC,KAAKO,EAAQ0Q,EAChD,CAAE,MAAOnO,GAEL,OAAO,WACH,OAAOugC,SAASr9B,UAAUqZ,MAAMA,MAAM9e,EAAQ,CAAC0Q,EAAKrC,WACxD,CACJ,CAER,CAGA,SAAS00B,IACDhgC,QAAQC,MACJD,QAAQC,IAAI8b,MACZ/b,QAAQC,IAAI8b,MAAM/b,QAASsL,WAG3By0B,SAASr9B,UAAUqZ,MAAMA,MAAM/b,QAAQC,IAAK,CAACD,QAASsL,aAG1DtL,QAAQlD,OAAOkD,QAAQlD,OAC/B,CAIA,SAASmjC,EAAWJ,GAKhB,MAJmB,UAAfA,IACAA,EAAa,cAGN7/B,UAAYu/B,IAEG,UAAfM,GAA0BL,EAC1BQ,OACwBtiB,IAAxB1d,QAAQ6/B,GACRD,EAAW5/B,QAAS6/B,QACJniB,IAAhB1d,QAAQC,IACR2/B,EAAW5/B,QAAS,OAEpBs/B,EAEf,CAIA,SAASY,IAKL,IAHA,IAAIC,EAAQ5iC,KAAK6iC,WAGRztB,EAAI,EAAGA,EAAI8sB,EAAW9gC,OAAQgU,IAAK,CACxC,IAAIktB,EAAaJ,EAAW9sB,GAC5BpV,KAAKsiC,GAAeltB,EAAIwtB,EACpBb,EACA/hC,KAAK8iC,cAAcR,EAAYM,EAAO5iC,KAAKqI,KACnD,CAMA,GAHArI,KAAK0C,IAAM1C,KAAK+iC,aAGLtgC,UAAYu/B,GAAiBY,EAAQ5iC,KAAKgjC,OAAOC,OACxD,MAAO,kCAEf,CAIA,SAASC,EAAgCZ,GACrC,OAAO,kBACQ7/B,UAAYu/B,IACnBW,EAAsBxjC,KAAKa,MAC3BA,KAAKsiC,GAAY9jB,MAAMxe,KAAM+N,WAErC,CACJ,CAIA,SAASo1B,EAAqBb,EAAYc,EAAQC,GAE9C,OAAOX,EAAWJ,IACXY,EAAgC1kB,MAAMxe,KAAM+N,UACvD,CAEA,SAASiC,EAAO3H,EAAMi7B,GAEpB,IASIC,EAMAC,EAMAC,EArBA96B,EAAO3I,KAuBP0jC,EAAa,WAOjB,SAASC,EAAuBC,GAC5B,IAAIC,GAAa3B,EAAW0B,IAAa,UAAUj5B,cAEnD,UAAWpJ,SAAWygC,GAAkB0B,EAAxC,CAGA,IAEI,YADAniC,OAAOuiC,aAAaJ,GAAcG,EAEtC,CAAE,MAAOE,GAAS,CAGlB,IACIxiC,OAAOiH,SAASw7B,OACdC,mBAAmBP,GAAc,IAAMG,EAAY,GACzD,CAAE,MAAOE,GAAS,CAZwC,CAa9D,CAEA,SAASG,IACL,IAAIC,EAEJ,UAAW5iC,SAAWygC,GAAkB0B,EAAxC,CAEA,IACIS,EAAc5iC,OAAOuiC,aAAaJ,EACtC,CAAE,MAAOK,GAAS,CAGlB,UAAWI,IAAgBnC,EACvB,IACI,IAAIgC,EAASziC,OAAOiH,SAASw7B,OACzBI,EAAaH,mBAAmBP,GAChCh1B,EAAWs1B,EAAOvqB,QAAQ2qB,EAAa,MACzB,IAAd11B,IACAy1B,EAAc,WAAWrU,KACrBkU,EAAO/1B,MAAMS,EAAW01B,EAAWhjC,OAAS,IAC9C,GAEV,CAAE,MAAO2iC,GAAS,CAQtB,YAJiC5jB,IAA7BxX,EAAKq6B,OAAOmB,KACZA,OAAchkB,GAGXgkB,CAzBmD,CA0B9D,CAEA,SAASE,IACL,UAAW9iC,SAAWygC,GAAkB0B,EAAxC,CAGA,IACIniC,OAAOuiC,aAAaQ,WAAWZ,EACnC,CAAE,MAAOK,GAAS,CAGlB,IACIxiC,OAAOiH,SAASw7B,OACdC,mBAAmBP,GAAc,0CACvC,CAAE,MAAOK,GAAS,CAXwC,CAY9D,CAEA,SAASQ,EAAe3vB,GACpB,IAAIguB,EAAQhuB,EAIZ,GAHqB,iBAAVguB,QAA2DziB,IAArCxX,EAAKq6B,OAAOJ,EAAMj4B,iBAC/Ci4B,EAAQj6B,EAAKq6B,OAAOJ,EAAMj4B,gBAET,iBAAVi4B,GAAsBA,GAAS,GAAKA,GAASj6B,EAAKq6B,OAAOC,OAChE,OAAOL,EAEP,MAAM,IAAI3+B,UAAU,6CAA+C2Q,EAE3E,CAhFoB,iBAATvM,EACTq7B,GAAc,IAAMr7B,EACK,iBAATA,IAChBq7B,OAAavjB,GAqFfxX,EAAKN,KAAOA,EAEZM,EAAKq6B,OAAS,CAAE,MAAS,EAAG,MAAS,EAAG,KAAQ,EAAG,KAAQ,EACvD,MAAS,EAAG,OAAU,GAE1Br6B,EAAKm6B,cAAgBQ,GAAWH,EAEhCx6B,EAAKk6B,SAAW,WACZ,OAAiB,MAAbY,EACKA,EACkB,MAAhBD,EACFA,EAEAD,CAEb,EAEA56B,EAAK67B,SAAW,SAAU5B,EAAO6B,GAO7B,OANAhB,EAAYc,EAAe3B,IACX,IAAZ6B,GACAd,EAAuBF,GAIpBd,EAAsBxjC,KAAKwJ,EACtC,EAEAA,EAAK+7B,gBAAkB,SAAU9B,GAC7BY,EAAee,EAAe3B,GACzBsB,KACDv7B,EAAK67B,SAAS5B,GAAO,EAE7B,EAEAj6B,EAAKg8B,WAAa,WACdlB,EAAY,KACZY,IACA1B,EAAsBxjC,KAAKwJ,EAC/B,EAEAA,EAAKi8B,UAAY,SAASH,GACtB97B,EAAK67B,SAAS77B,EAAKq6B,OAAO6B,MAAOJ,EACrC,EAEA97B,EAAKm8B,WAAa,SAASL,GACvB97B,EAAK67B,SAAS77B,EAAKq6B,OAAOC,OAAQwB,EACtC,EAEA97B,EAAKo8B,QAAU,WAMX,GALI3C,IAAkBz5B,IAClB46B,EAAiBgB,EAAenC,EAAcS,aAElDF,EAAsBxjC,KAAKwJ,GAEvBy5B,IAAkBz5B,EAClB,IAAK,IAAIq8B,KAAa7C,EACpBA,EAAe6C,GAAWD,SAGpC,EAGAxB,EAAiBgB,EACbnC,EAAgBA,EAAcS,WAAa,QAE/C,IAAIoC,EAAef,IACC,MAAhBe,IACAxB,EAAYc,EAAeU,IAE/BtC,EAAsBxjC,KAAKwJ,EAC7B,EAQAy5B,EAAgB,IAAIpyB,GAEN1Q,UAAY,SAAmB+I,GACzC,GAAqB,iBAATA,GAAqC,iBAATA,GAA+B,KAATA,EAC1D,MAAM,IAAIpE,UAAU,kDAGxB,IAAI5E,EAAS8iC,EAAe95B,GAO5B,OANKhJ,IACDA,EAAS8iC,EAAe95B,GAAQ,IAAI2H,EAChC3H,EACA+5B,EAAcU,gBAGfzjC,CACX,EAGA,IAAI6lC,SAAe3jC,SAAWygC,EAAiBzgC,OAAOmB,SAAMyd,EAiB5D,OAhBAiiB,EAAc+C,WAAa,WAMvB,cALW5jC,SAAWygC,GACfzgC,OAAOmB,MAAQ0/B,IAClB7gC,OAAOmB,IAAMwiC,GAGV9C,CACX,EAEAA,EAAcgD,WAAa,WACvB,OAAOjD,CACX,EAGAC,EAAuB,QAAIA,EAEpBA,CACX,OA3VyB,6DAMzB,CATA,E,8BCHA,IAUIiD,EAVY,WAIf,GAAoB,oBAAT18B,KAAwB,OAAOA,KAC1C,GAAsB,oBAAXpH,OAA0B,OAAOA,OAC5C,QAAsB,IAAX,EAAA+jC,EAA0B,OAAO,EAAAA,EAC5C,MAAM,IAAI7lC,MAAM,iCACjB,CAEmB8lC,GAEnBzmC,EAAOC,QAAUA,EAAUsmC,EAAapiB,MAGpCoiB,EAAapiB,QAChBlkB,EAAA,QAAkBsmC,EAAapiB,MAAMsf,KAAK8C,IAG3CtmC,EAAQymC,QAAUH,EAAaG,QAC/BzmC,EAAQ0mC,QAAUJ,EAAaI,QAC/B1mC,EAAQ2mC,SAAWL,EAAaK,Q,mBCxBhC,IAA2SC,EAA5N7mC,EAAOC,SAAqN4mC,EAAc,CAAC,GAAEA,EAAc,WAAW3lC,KAAK4lC,UAAU,CAAC,CAAC,GAAgBzgC,UAAU,CAACkN,iBAAiB,SAASnG,EAAK25B,EAAS9lC,GAAkD,IAA3C,IAAIoO,EAAK,GAAO23B,EAAU/3B,UAAU3M,OAAegU,EAAE,EAAEA,EAAE0wB,EAAU1wB,IAAKjH,EAAKvI,KAAKmI,UAAUqH,IAAIjH,EAAKA,EAAK/M,OAAO,EAAE+M,EAAK43B,OAAO,EAAE53B,EAAK/M,OAAO,GAAG,QAAmC,IAAtBpB,KAAK4lC,UAAU15B,GAAoBlM,KAAK4lC,UAAU15B,GAAMtG,KAAK,CAAC7F,MAAMA,EAAM8lC,SAASA,EAAS13B,KAAKA,IAAYnO,KAAK4lC,UAAU15B,GAAM,CAAC,CAACnM,MAAMA,EAAM8lC,SAASA,EAAS13B,KAAKA,GAAO,EAAE63B,oBAAoB,SAAS95B,EAAK25B,EAAS9lC,GAAO,QAAgC,IAAtBC,KAAK4lC,UAAU15B,GAAmB,CAAgE,IAA/D,IAAI+5B,EAAejmC,KAAK4lC,UAAU15B,GAAM9K,OAAW8kC,EAAS,GAAW9wB,EAAE,EAAEA,EAAE6wB,EAAe7wB,IAAI,CAAC,IAAI+wB,EAASnmC,KAAK4lC,UAAU15B,GAAMkJ,GAAM+wB,EAASpmC,OAAOA,GAAOomC,EAASN,UAAUA,GAAgBK,EAAStgC,KAAKugC,EAAU,CAACnmC,KAAK4lC,UAAU15B,GAAMg6B,CAAQ,CAAC,EAAEE,iBAAiB,SAASl6B,EAAK25B,EAAS9lC,GAAO,QAAgC,IAAtBC,KAAK4lC,UAAU15B,GAAmB,CAAC,IAAI+5B,EAAejmC,KAAK4lC,UAAU15B,GAAM9K,OAAO,QAAc+e,IAAX0lB,QAA8B1lB,IAARpgB,EAAmB,OAAOkmC,EAAe,EAAE,IAAI,IAAI7wB,EAAE,EAAEA,EAAE6wB,EAAe7wB,IAAI,CAAC,IAAI+wB,EAASnmC,KAAK4lC,UAAU15B,GAAMkJ,GAAG,KAAIrV,GAAMomC,EAASpmC,OAAOA,IAAaomC,EAASN,UAAUA,EAAU,OAAO,CAAK,CAAC,CAAC,OAAO,CAAK,EAAEQ,SAAS,SAASn6B,EAAKnJ,GAAuF,IAA/E,IAAI8d,EAAM,CAAC3U,KAAKA,EAAKnJ,OAAOA,GAAYoL,EAAK,GAAO23B,EAAU/3B,UAAU3M,OAAegU,EAAE,EAAEA,EAAE0wB,EAAU1wB,IAAKjH,EAAKvI,KAAKmI,UAAUqH,IAAiF,GAA7EjH,EAAKA,EAAK/M,OAAO,EAAE+M,EAAK43B,OAAO,EAAE53B,EAAK/M,OAAO,GAAG,GAAG+M,EAAK,CAAC0S,GAAO0P,OAAOpiB,QAAsC,IAAtBnO,KAAK4lC,UAAU15B,GAAoB,KAAI05B,EAAU5lC,KAAK4lC,UAAU15B,GAAM+B,QAAYg4B,EAAeL,EAAUxkC,OAAO,IAAQgU,EAAE,EAAEA,EAAE6wB,EAAe7wB,IAAI,CAAC,IAAI+wB,EAASP,EAAUxwB,GAAG,GAAG+wB,GAAUA,EAASN,SAAS,CAAC,IAAIS,EAAWn4B,EAAKoiB,OAAO4V,EAASh4B,MAAMg4B,EAASN,SAASrnB,MAAM2nB,EAASpmC,MAAMumC,EAAW,CAAC,CAA9N,CAAgO,EAAEC,UAAU,WAAW,IAAIC,EAAI,GAAG,IAAI,IAAIt6B,KAAQlM,KAAK4lC,UAA0D,IAA/C,IAAIK,EAAejmC,KAAK4lC,UAAU15B,GAAM9K,OAAegU,EAAE,EAAEA,EAAE6wB,EAAe7wB,IAAI,CAAC,IAAI+wB,EAASnmC,KAAK4lC,UAAU15B,GAAMkJ,GAAGoxB,GAAKL,EAASpmC,OAAOomC,EAASpmC,MAAM2I,UAAUy9B,EAASpmC,MAAM2I,UAAU,YAAY89B,GAAK,gBAAgBt6B,EAAK,KAAK,CAAE,OAAOs6B,CAAG,GAAgB,IAAIb,E,yHCiS/zE,QAjRe,CAYXc,UAAY,SAAU7mC,GACE,IAAI,IAAOA,GACjBT,MAClB,EA6BAunC,YAAc,SAAU9mC,GACF,IAAI,EAAA8lB,EAAK9lB,GACfT,MAChB,EA2CAwnC,QAAU,SAAU/mC,GACK,IAAI,IAAQA,GAClBT,MACnB,EAqCAynC,eAAiB,SAAUhnC,GACK,IAAI,IAAeA,GACzBT,MAC1B,EAwBAowB,aAAe,SAAU3vB,GACK,IAAI,EAAA8lB,EAAa9lB,GACvBT,MACxB,EAkCA0nC,MAAQ,SAAUjnC,GACK,IAAI,IAAMA,GAChBT,MACjB,EAkCA2nC,SAAW,SAAUlnC,GACY,IAAI,IAAgBA,GAC1BT,MAC3B,E,+CCpLJ,QA3DmB,CAOf4nC,4BAA8B,SAAUC,GACpC,IAAIC,EAAaD,EAAiBE,gBAClC,GAAID,EAAW/0B,MACX,OAAO+0B,EAAW/0B,MACf,GAA8B,uBAA1B80B,EAAiB96B,KAA+B,CACvD,IAAIi7B,EAAiBF,EAAWG,QAahC,OAZIH,EAAWI,UAAY79B,MAAM4E,QAAQ64B,EAAWI,WAAaJ,EAAWI,SAASjmC,QAAU,GAAgC,kBAA3B6lC,EAAWI,SAAS,GAEpHF,EAAiBA,EAAiB,KAAOF,EAAWI,SAAS,GAGzDJ,EAAWK,WACXH,EAAiBA,EAAiB,KAAOF,EAAWK,SAAS,GACzDL,EAAWM,OACXJ,EAAiBA,EAAiB,IAAMF,EAAWM,KAAK,KAI7DJ,CACX,CAAO,MAA8B,kBAA1BH,EAAiB96B,MAChB+6B,EAAWO,YAAcP,EAAWO,YAAc,IAAM,IAAMP,EAAWQ,OAAS,KAAOR,EAAWK,SAAWL,EAAWK,SAAW,KAAO,IAAML,EAAWM,KACpI,oBAA1BP,EAAiB96B,KACjB+6B,EAAW/iC,GAEX,KAEf,EAQA2lB,6BAA+B,SAAU6d,GACrC,GAAIA,EAAkBC,SAClB,OAAOD,EAAkBC,SAEzB,IAAI9vB,EAAS,GASb,OARAA,EAAOjS,KAAK8hC,EAAkBD,QAAU,IACxC5vB,EAAOjS,KAAK8hC,EAAkBE,YAAc,IAC5C/vB,EAAOjS,KAAK8hC,EAAkBG,SAAW,IAEV,uBAA3BH,EAAkBx7B,OAClB2L,EAAOjS,KAAK8hC,EAAkBI,KAAO,IACrCjwB,EAAOjS,KAAK8hC,EAAkBK,MAAQ,KAEnClwB,EAAO/R,KAAK,MAE3B,E,6DCnDJ,QAXa,CAKTkiC,YAAc,YAEVC,EAAAA,EAAAA,GAAajoC,KAAKJ,QAAQyE,SAAUrE,KAAKwG,QAAQtC,GAAGwP,MAAM,gBAAgB,GAC9E,E,uECEJ,SAASw0B,EAAmBtoC,GACxB,KAAMI,gBAAgBkoC,GAClB,MAAM,IAAIjkC,UAAU,iEAMxBjE,KAAKkF,UAAY,oBAGjB,EAAAwgB,EAAYlH,MAAMxe,KAAM+N,WAExB/N,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,uCAMlBS,KAAKilB,SAAWjlB,KAAKJ,QAAQqlB,UAAY,CAC7C,CAMAijB,EAAkB/iC,UAAYjE,OAAOmjB,OAAO,EAAAqB,EAAYvgB,UAAW,CAK/D8f,SAAW,CAEPuR,IAAM,WACF,OAAOx2B,KAAKmoC,SAChB,EAEAhhC,IAAM,SAAUJ,GACZ/G,KAAKmoC,UAAYphC,CACrB,KAORmhC,EAAkB/iC,UAAUC,YAAc8iC,EAO1CA,EAAkB/iC,UAAUijC,QAAU,WAElC,IAAIniC,EAAM,GA+BV,OA9BAA,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKqoC,WAEbpiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsoC,WAGbriC,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKuoC,SAEbtiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsE,MAEb2B,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAKilB,WAEbhf,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKL,SAEbsG,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAKmE,WAGN8B,CACX,EAEA,S,+CCkBA,QArHa,CAmBTuiC,oBAAsB,SAAUx6B,GAC5B,IAAIy6B,EAAW,KAEf,GAAIz6B,EAAQ,CACR,IAAI06B,EAAY,GAChB,IAAK,IAAI5hC,KAAOkH,EACZ,GAAIA,EAAOtD,eAAe5D,GAAM,CAC5B,IAAIC,EAAQiH,EAAOlH,GACdC,IACDA,EAAQ,IAEZ2hC,EAAU9iC,KAAKkB,EAAM,IAAMC,EAC/B,CAGJ0hC,EAAWC,EAAU5iC,KAAK,IAC9B,CAEA,OAAO2iC,CACX,EAqBApnC,aAAe,SAAU7B,EAAKwO,EAAQ26B,GAClC,IAAIC,EAAQppC,EAEZ,GAAIA,EAAK,CACL,GAAIA,EAAIoZ,MAAM,KAAKxX,OAAS,GAAK,EAAG,CAEhC,IAAIynC,EAAsBrpC,EAAIqQ,OAAO,MAAQ,EAC7C+4B,EAAQppC,EAAIsX,UAAU,EAAG+xB,GAAuBrpC,EAAIyO,MAAM46B,GAAqBx6B,QAAQ,MAAO,IAClG,CAEA,IAAI1I,EAAInG,EAAIia,QAAQ,MACT,IAAP9T,IACAijC,GAAS,MAGF,IAAPjjC,GAAYA,IAAMnG,EAAI4B,OAAS,IAC/BwnC,GAAS,IAEjB,CAgBA,OAdI56B,IAGI46B,GAFkB,iBAAX56B,EACPA,EAASA,EAAOK,QAAQ,IAAK,IAGpBrO,KAAKwoC,oBAAoBx6B,IAItC26B,IAEAC,EAAQ3E,mBAAmB2E,IAGxBA,CACX,EAiBAL,OAAS,SAAU5e,EAAGmf,GAElB,OAAO,IAAIt/B,OADDmgB,GAAK,GACQ,GAAG7jB,KAAK,MAAQgjC,CAC3C,E,mDCvGQ5kC,E,UAqOZ,QA5OY,CAMR6kC,MACQ7kC,EAAKqzB,KAAKyR,MAAMC,KAAKC,OAClB,WACH,OAAOhlC,GACX,GA0CJ/E,KAAO,SAAUS,GAEb,IAAIP,EAAS,IAAOC,UAAU,SAK9B,GAJAD,EAAOE,MAAM,qBAIRK,EAED,MADAP,EAAOqB,MAAM,iCACP,IAAIjB,MAAM,iCAGpB,IAAKG,EAAQJ,IAET,MADAH,EAAOqB,MAAM,qCACP,IAAIjB,MAAM,qCAUpB,GAPKG,EAAQE,UACTT,EAAOuS,KAAK,2CACZhS,EAAQE,QAAU,IAKjBF,EAAQY,WAET,MADAnB,EAAOqB,MAAM,4CACP,IAAIjB,MAAM,4CAUpB,IAAI0pC,EAAgD,iBAA3BvpC,EAAQ0K,eAA+B1K,EAAQ0K,eAAiBtK,KAAK+oC,OAG1FK,GAAoB,EACpBC,GAAqB,EAErB7jB,EAAM5lB,EAAQJ,IAAIia,QAAQ,aAE9B,IAAa,IAAT+L,EAAY,CACZ4jB,GAAoB,EAEpB,IAAIxiB,EAAIhnB,EAAQJ,IAAIia,QAAQ,IAAK+L,IACtB,IAAPoB,IACAA,EAAIhnB,EAAQJ,IAAI4B,QAIpB,IAAIkoC,EAAe1pC,EAAQJ,IAAIsX,UAAU0O,EAAM,EAAGoB,GAE9C0iB,IACAD,GAAqB,EACrBzpC,EAAQ0pC,aAAeA,EACvBjqC,EAAOuS,KAAK,yCAA2ChS,EAAQ0pC,aAAe,kCAEtF,CAGA,IAAKF,EAAmB,CAEpB,IAAIzjC,EAAI/F,EAAQJ,IAAIia,QAAQ,MACjB,IAAP9T,EAEA/F,EAAQJ,IAAMI,EAAQJ,IAARI,aACP+F,IAAM/F,EAAQJ,IAAI4B,OAEzBxB,EAAQJ,IAAMI,EAAQJ,IAAM,YAG5BI,EAAQJ,IAAMI,EAAQJ,IAARI,aAElBP,EAAOuS,KAAK,mDAAqDhS,EAAQJ,IAC7E,CAGA,IAAI+pC,IAAkB3pC,EAAQ0pC,cAAsBD,EA2BpD,GAxBKA,IAEIzpC,EAAQ0pC,eACTjqC,EAAOuS,KAAK,gDACZhS,EAAQ0pC,aAAe,YAGnBH,GAA6B,KAAfA,KACdvpC,EAAQ0pC,cAAgBH,IAGhCvpC,EAAQJ,IAAMI,EAAQJ,IAAI6O,QAAQ,YAAa,YAAczO,EAAQ0pC,cACrEjqC,EAAOuS,KAAK,qDAAuDhS,EAAQJ,MAI1EI,EAAQ2M,YACTlN,EAAOuS,KAAK,6CAEZhS,EAAQ2M,UAAY,WAChB9J,QAAQC,IAAI,gCAAkC9C,EAAQJ,IAC1D,IAGC+pC,EAAiB,CAClB,IAAI5gC,EAAO3I,KAGPqC,EAAmB,KAGnBzC,EAAQE,QAAU,IAClBuC,EAAmBd,OAAOe,YACtB,WAEIf,OAAO3B,EAAQ0pC,cAAgB,WAAa,EAC5C1pC,EAAQ2M,YACR5D,EAAK6gC,cAAcL,EACvB,GAAGvpC,EAAQE,UAUnByB,OAAO3B,EAAQ0pC,cAAgB,SAAUzpC,GACrC0B,OAAOuB,aAAaT,GACpBzC,EAAQY,WAAWX,GACnB8I,EAAK6gC,cAAcL,EACvB,CACJ,CAEAnpC,KAAKypC,cAAcN,EAAYvpC,EAAQJ,IAC3C,EAQAiqC,cAAgB,SAAUN,EAAY3pC,GAClC,IAAIkqC,EACAC,EAAUnhC,SAASqL,eAAe,UAAYs1B,IAElDO,EAAUlhC,SAASC,cAAc,WACzBwS,aAAa,OAAQ,mBAC7ByuB,EAAQzuB,aAAa,MAAOzb,GAC5BkqC,EAAQzuB,aAAa,UAAW,SAChCyuB,EAAQzuB,aAAa,KAAM,UAAYkuB,GACvCO,EAAQzuB,aAAa,QAAS,QAE9B,IAAI1E,EAAO/N,SAASsL,iBAAmBtL,SAASuL,qBAAqB,QAAQ,GAC7D,OAAZ41B,EACApzB,EAAKpO,YAAYuhC,GAGjBnzB,EAAKqzB,aAAaF,EAASC,EAEnC,EAOAH,cAAgB,SAAUL,GACtB,IAAIU,EAASrhC,SAASqL,eAAe,UAAYs1B,GACjD,GAAIU,EAAQ,CACR,IAAItzB,EAAOszB,EAAOC,YAActhC,SAASsL,gBACzC,IAAKyC,EACD,OAEJA,EAAK4Y,YAAY0a,EACrB,CACJ,E,8BC3OJ,SAAS9I,IACL,KAAM/gC,gBAAgB+gC,GAClB,MAAM,IAAI98B,UAAU,4DAGxBjE,KAAK+pC,WAAa,EACtB,C,iBAEAhJ,EAAa57B,UAAY,CAErBC,YAAc27B,GAIlB,S,oGCXI1hC,EAAS2Q,EAAAA,EAAO1Q,UAAU,gBA+G9B,QAjFmB,CAKf0qC,YAAc,CACV,WACA,gBACA,WAcJC,SAAW,CACPviB,QAAU,KACVwiB,MAAQ,MAYZvS,MAAQ,SAAU1xB,EAAKrG,GACnBP,EAAOE,MAAM,WAEb,IAAIkC,EAAO,CAAC,EACZgP,EAAAA,EAAMC,YAAYjP,EAAMzB,KAAKiqC,UAC7Bx5B,EAAAA,EAAMC,YAAYjP,EAAM7B,GAGxB,IADA,IAAIuqC,EAAelkC,EAAImkC,kBAAkBC,WAChCj1B,EAAI,EAAGA,EAAI+0B,EAAa/oC,OAAQgU,IACrC,GAAI+0B,EAAa/0B,GAAGk1B,cACfH,EAAa/0B,aAAcm1B,EAAAA,MACxBJ,EAAa/0B,aAAco1B,EAAAA,QAC3BL,EAAa/0B,aAAcq1B,EAAAA,QAAoB,CACnD,IAAInxB,EAAO6wB,EAAa/0B,GAAGs1B,gBACvBriC,EAAOiR,EAAKjR,KAChB,QAAoB,IAATA,GAAwBrI,KAAKgqC,YAAYvwB,QAAQpR,IAAS,EAAG,CAEpE,GAAI5G,EAAKimB,SAAWjmB,EAAKimB,UAAYrf,EACjC,SAEJ8hC,EAAa/0B,GAAGu1B,WAAU,GAE1B,IAAI/tB,EAAStD,EAAKsD,OAClB,QAAsB,IAAXA,GAA0BA,aAAkBvV,IAEnD,IAAK,IAAIujC,KAAUnpC,EACf,GAAIA,EAAKiJ,eAAekgC,GAAS,CAC7B,GAAe,YAAXA,EACA,SAEJ,GAA8B,mBAAnBhuB,EAAOguB,GAAwB,CACtC,IAAIz8B,EAAO3E,MAAM4E,QAAQ3M,EAAKmpC,IAAWnpC,EAAKmpC,GAAU,CAACnpC,EAAKmpC,IAC9DhuB,EAAOguB,GAAQpsB,MAAM5B,EAAQzO,EACjC,CACJ,CAGZ,MACIg8B,EAAa/0B,GAAGu1B,WAAU,EAElC,CAER,E,iFCrDAE,EAAqB,CAAC,EAE1BA,EAAmBC,QAAU,CAWzBf,WAAa,SAAUgB,GAEnB,IAAIC,EAAe,IAAI,EAAAtlB,EAEvB,GAAIqlB,EAAKE,gBAKL,IAJA,IACIC,EACAC,EAFAljC,EAAW8iC,EAAKz0B,WAIXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IACjC81B,EAAQjjC,EAASmN,GAEby1B,EAAmBC,QAAQI,EAAMphC,YACjCqhC,EAAYN,EAAmBC,QAAQI,EAAMphC,UAAUohC,GACvDF,EAAajB,WAAWnkC,KAAKulC,IAKzC,OAAOH,CACX,EAWAG,UAAY,SAAU50B,GAClB,IAAI40B,EAAY,IAAI,IAEpB,GAAI50B,EAAK00B,gBAGL,IAFA,IACIC,EADAjjC,EAAWsO,EAAKD,WAEXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IACjC81B,EAAQjjC,EAASmN,GACby1B,EAAmBC,QAAQI,EAAMphC,WAEjC+gC,EAAmBC,QAAQI,EAAMphC,UAAUohC,EAAOC,GAI9D,OAAOA,CACX,EAWA1mB,IAAM,SAAUlO,EAAM40B,GAClB,IAAIC,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SAGrB,MAAM,IAAI5rC,MAAM,oFAFhB0rC,EAAU1mB,IAAM6mB,WAAWF,EAASG,UAI5C,EAWA/mB,IAAM,SAAUjO,EAAM40B,GAClB,IAAIC,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SAGrB,MAAM,IAAI5rC,MAAM,qFAFhB0rC,EAAU3mB,IAAM8mB,WAAWF,EAASG,UAI5C,EAWAzJ,EAAI,SAAUvrB,EAAMi1B,GAChB,IAAIJ,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SASrB,MAAM,IAAI5rC,MAAM,oFARhB,IAAI+rC,EAKA,OAFAA,EAAkB,IAAI,KACN1J,EAAIwJ,WAAWF,EAASG,WACjCC,EAJPA,EAAgB1J,EAAIwJ,WAAWF,EAASG,UASpD,EAWAE,IAAM,SAAUl1B,EAAMi1B,GAClB,IAAIJ,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SAGrB,MAAM,IAAI5rC,MAAM,2FAFhB+rC,EAAgBC,IAAMH,WAAWF,EAASG,UAIlD,EAWAG,YAAc,SAAUn1B,EAAMo1B,GAC1B,IAAIP,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SAGrB,MAAM,IAAI5rC,MAAM,uFAFhBksC,EAAQD,YAAcN,EAASG,SAIvC,EAWAK,eAAiB,SAAUr1B,EAAMo1B,GAC7B,IAAIP,EAAW70B,EAAK2Y,WACpB,IAAIkc,GAAkC,IAAtBA,EAASC,SAGrB,MAAM,IAAI5rC,MAAM,0FAFhBksC,EAAQC,eAAiBR,EAASG,SAI1C,EAWAnmB,SAAW,SAAU7O,EAAM40B,GAEvB,IAAIQ,EACJ,GAFAR,EAAU/lB,SAAW,GAEjB7O,EAAK00B,gBAIL,IAHA,IAEIY,EAFA5jC,EAAWsO,EAAKD,WAGXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IAAK,CACtCu2B,EAAU,IAAI,IAEdE,EADc5jC,EAASmN,GACOkB,WAC9B,IAAK,IAAIsQ,EAAI,EAAGA,EAAIilB,EAAgBzqC,OAAQwlB,IAAK,CAC7C,IAAIikB,EAAmBC,QAAQe,EAAgBjlB,GAAG9c,UAI9C,MAAM,IAAIrK,MAAM,sFAFhBorC,EAAmBC,QAAQe,EAAgBjlB,GAAG9c,UAAU+hC,EAAgBjlB,GAAI+kB,EAIpF,CACAR,EAAU/lB,SAASxf,KAAK+lC,EAC5B,CAER,EAUAG,gBAAkB,SAAUv1B,GACxB,IAAIhW,EAAW,CAAC,EAEhB,GAAIgW,EAAK00B,gBAGL,IAFA,IACIC,EADAjjC,EAAWsO,EAAKD,WAEXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IAEV,eADvB81B,EAAQjjC,EAASmN,IACPtL,WACNvJ,EAASwrC,gBAAkBlB,EAAmBC,QAAQkB,UAAUd,IAK5E,OAAO3qC,CACX,EAYAyrC,UAAY,SAAUz1B,GAClB,IAAIw1B,EAAkB,CAAC,EAGnBE,EAAgB11B,EAAK21B,aAAa,iBAClCD,IACAF,EAAgBE,cAAgBA,GAIpC,IAAIb,EAAW70B,EAAK2Y,WAKpB,OAJIkc,GAAkC,IAAtBA,EAASC,WACrBU,EAAgBC,UAAYZ,EAASG,WAGlCQ,CACX,EASArrC,MAAQ,SAAU6V,GACd,IAAIhW,EAAW,CACXG,MAAQ,CAAC,GAGb,GAAI6V,EAAK00B,gBAGL,IAFA,IACIC,EADAjjC,EAAWsO,EAAKD,WAEXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IAAK,CAEtC,IAAIg2B,EAEmB,KAHvBF,EAAQjjC,EAASmN,IAGPi2B,UAAqC,SAAnBH,EAAMphC,WAC9BshC,EAAWF,EAAMhc,aACqB,IAAtBkc,EAASC,WACrB9qC,EAASG,MAAMk+B,KAAOwM,EAASG,WAIhB,IAAnBL,EAAMG,UAAqC,gBAAnBH,EAAMphC,WAC9BshC,EAAWF,EAAMhc,aACqB,IAAtBkc,EAASC,WACrB9qC,EAASG,MAAMiG,YAAcykC,EAASG,UAGlD,CAEJ,OAAOhrC,CACX,GAaJsqC,EAAmBsB,KAAO,SAAUpB,GAChC,GAAsB,eAAlBA,EAAKjhC,SAEL,OADmB+gC,EAAmBC,QAAQf,WAAWgB,GAEtD,GAAsB,oBAAlBA,EAAKjhC,SAEZ,OADsB+gC,EAAmBC,QAAQgB,gBAAgBf,GAE9D,GAAsB,UAAlBA,EAAKjhC,SAEZ,OADY+gC,EAAmBC,QAAQpqC,MAAMqqC,GAG7C,MAAM,IAAItrC,MAAM,8EAExB,EAEA,S,wBCtYAX,EAAOC,QAAUC,GAAG4d,OAAOnQ,M,qGCsP3B,QAxO2B,CAoBvBqY,MAAQ,SAAUllB,GAEd,IAAIP,EAAS,IAAOC,UAAU,wBAC9BD,EAAOE,MAAM,iCAEb,IAAIM,EAAO,KAEX,GAAID,EAAQW,SAAZ,CACI,GAAIX,EAAQ4K,YACRnL,EAAOE,MAAM,0BACbM,EAAOD,EAAQW,aACZ,CAGH,IAAI6rC,EAQJ,GAVA/sC,EAAOE,MAAM,2BAIT6sC,EAD4B,iBAArBxsC,EAAQW,SACAiD,KAAKC,MAAM7D,EAAQW,UAEnBX,EAAQW,SAIT,CAEd,GAAI6rC,EAAatqC,QAGb,YADAlC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,6BAA8BmiC,EAAatqC,WAGpH,IAAIuqC,EAAO,GACPC,EAAW,GACXC,EAAQ,GAsBZ,IApBA1sC,EAAO,IAAI,KAEF6K,eAAe,eACpB7K,EAAK6hC,UAAY4J,WAAWc,EAAaI,WAEzC3sC,EAAK6K,eAAe,mBACpB7K,EAAK8hC,cAAgB2J,WAAWc,EAAapnC,WAG7CnF,EAAK6K,eAAe,UACpB7K,EAAK0kB,KAAKlb,KAAOiiC,WAAWc,EAAa7nB,KAAK,IAC9C1kB,EAAK0kB,KAAKnb,OAASkiC,WAAWc,EAAa7nB,KAAK,IAChD1kB,EAAK0kB,KAAKjb,MAAQgiC,WAAWc,EAAa7nB,KAAK,IAC/C1kB,EAAK0kB,KAAKpb,IAAMmiC,WAAWc,EAAa7nB,KAAK,KAG7C1kB,EAAK6K,eAAe,mBAAqB9K,EAAQ6sC,yBACjD5sC,EAAK+hC,cAAgBwK,EAAaz9B,UAGlC9O,EAAK6K,eAAe,sBAAwB9K,EAAQ6sC,uBAAwB,CAC5E,IACIr3B,EADAs3B,EAAUN,EAAaO,SAE3B,GAAInjC,MAAM4E,QAAQs+B,IAAYA,EAAQtrC,OAClC,IAAKgU,EAAI,EAAGA,EAAIs3B,EAAQtrC,OAAQgU,IAC5Bi3B,EAAKzmC,KAAK8mC,EAAQt3B,IAG1B,GAAIi3B,EAAKjrC,OACL,IAAKgU,EAAI,EAAGA,EAAIi3B,EAAKjrC,OAAQgU,IACzBk3B,EAAS1mC,KAAKymC,EAAKj3B,GAAGm3B,OAG9B,GAAID,EAASlrC,OACT,IAAKgU,EAAI,EAAGA,EAAIk3B,EAASlrC,OAAQgU,IAC7Bm3B,EAAQA,EAAMhc,OAAO+b,EAASl3B,IAItCm3B,EAAM3iC,SAAQ,SAAU0R,GAapB,OAZAzb,EAAKgiC,kBAAkBj8B,KAAK,IAAI,KAChC/F,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGorC,SAAWlxB,EAAKkxB,SAC1E3sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAG4D,SAAWsW,EAAKtW,SAC1EnF,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGw9B,KAAO,GACjE/+B,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,YAAc,GACxE/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGuN,SAAW2M,EAAK3M,SAGxD,0BAAd2M,EAAKjT,OACLiT,EAAKjT,KAAO,IAGRiT,EAAKsxB,YAAY1gC,MACrB,IAAK,OACDrM,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,UACzE,MACJ,IAAK,WACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,uBACzE,MACJ,IAAK,SACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,SACzE,MACJ,IAAK,SACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,UACzE,MACJ,IAAK,QACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,YACzE,MACJ,IAAK,OAGL,IAAK,UACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,sBACzE,MACJ,IAAK,WACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,oBACzE,MACJ,IAAK,OACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,8BACzE,MACJ,IAAK,cACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,gCACzE,MACJ,IAAK,WACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,mBACzE,MACJ,IAAK,WACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,YACzE,MACJ,IAAK,aAGL,IAAK,SACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,gBACzE,MACJ,IAAK,kBACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,yBACzE,MACJ,IAAK,eACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,GACzE,MACJ,QACI/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,IAAMtxB,EAAKsxB,YAAY1gC,KAAO,IAI/G,GAAIoP,EAAKsxB,YAAYC,SACjB,OAAQvxB,EAAKsxB,YAAYC,UACrB,IAAK,QACDhtC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,YAAc,kBACxE,MACJ,IAAK,cACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,yBACzE,MACJ,IAAK,QACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,YACzE,MACJ,IAAK,eACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,uBACzE,MACJ,IAAK,WACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,YAAc,uBACxE,MACJ,IAAK,cACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,uBACzE,MACJ,IAAK,OACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,YACzE,MACJ,IAAK,aACD/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,yBACzE,MACJ,QACI/sC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,KAAOtxB,EAAKsxB,YAAYC,SAAW,IAKpHvxB,EAAKsxB,YAAYE,OACjBjtC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,GAAGtxB,EAAKsxB,YAAYE,gBAG7FxxB,EAAK2rB,WAAW5+B,QACZiT,EAAK2rB,WAAW5+B,KAAK0kC,cAAgBzxB,EAAK2rB,WAAW5+B,KAAK2kC,YAC1DntC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,QAGzEtxB,EAAK2rB,WAAW5+B,KAAK0kC,eACrBltC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,IAAItxB,EAAK2rB,WAAW5+B,KAAK0kC,gBAGlGzxB,EAAK2rB,WAAW5+B,KAAK2kC,WACrBntC,EAAKgiC,kBAAkBhiC,EAAKgiC,kBAAkBzgC,OAAS,GAAGwrC,aAAe,IAAItxB,EAAK2rB,WAAW5+B,KAAK2kC,YAG9G,GACJ,CACJ,CAEA,IAAKntC,EAED,YADAD,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAA4B,UAKrG,GAAIpK,EAAKksC,gBAEL,YADAnsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,iCAG7E,CAMJrK,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAOF,EAFtC,MAFID,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAK7E,E,6DCtOJ,SAASgjC,EAAkBrtC,GACvB,KAAMI,gBAAgBitC,GAClB,MAAM,IAAIhpC,UAAU,gEAYxB,GATAjE,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,sCAKlBS,KAAKJ,QAAUA,GAAW,CAAC,GAGtBI,KAAKJ,QAAQ+kB,eAAiD,WAA/B3kB,KAAKJ,QAAQ+kB,eAA6D,YAA/B3kB,KAAKJ,QAAQ+kB,cACxF,MAAM,IAAIllB,MAAM,iCAEpBO,KAAK2kB,cAAgB3kB,KAAKJ,QAAQ+kB,cAGlC3kB,KAAKkkB,WAAiC,IAAjBlkB,KAAKJ,QAA2BI,KAAKJ,QAAQskB,MAAQ,KAE1ElkB,KAAKktC,eAAiBltC,KAAKJ,QAAQstC,gBAAkB,KAErDltC,KAAKiJ,MAAQjJ,KAAKJ,QAAQqJ,OAAS,KAEnCjJ,KAAKwkB,IAAMxkB,KAAKJ,QAAQyE,UAAYrE,KAAKJ,QAAQyE,SAASmgB,IAAMxkB,KAAKJ,QAAQyE,SAASmgB,IAAM,KAE5FxkB,KAAKykB,IAAMzkB,KAAKJ,QAAQyE,UAAYrE,KAAKJ,QAAQyE,SAASogB,IAAMzkB,KAAKJ,QAAQyE,SAASogB,IAAM,KAE5FzkB,KAAK6kB,QAAU7kB,KAAKJ,QAAQilB,SAAW,KAEvC7kB,KAAK4kB,mBAAqB5kB,KAAKJ,QAAQglB,oBAAsB,KAE7D5kB,KAAKmkB,QAAUnkB,KAAKJ,QAAQukB,SAAW,CAAC,CAC5C,CAKA8oB,EAAiB/nC,UAAY,mBAE7B+nC,EAAiB9nC,UAAY,CASzBC,YAAc6nC,EAMdE,WAAa,WACT,IAAIhpB,EAAU,CAAC,EACf,IAAK,IAAI7K,KAAQtZ,KAAKmkB,QACdnkB,KAAKmkB,QAAQzZ,eAAe4O,KAC5B6K,EAAQ7K,GAAQtZ,KAAKmkB,QAAQ7K,IAGrC,OAAO6K,CACX,EAMAipB,SAAW,WACP,YAAmBjtB,IAAfngB,KAAKiJ,MACE,KAEQ,kBAAfjJ,KAAKiJ,MACE,UACe,oBAAfjJ,KAAKiJ,MACL,SACe,uBAAfjJ,KAAKiJ,MACL,MACe,aAAfjJ,KAAKiJ,MACL,WAEJjJ,KAAKiJ,KAChB,EAMAokC,kBAAoB,WAChB,OAAO7pC,KAAKqC,UAAU7F,KAAKktC,eAC/B,GAQJD,EAAiB9nC,UAAUa,UAAY,WACnC,IAAIC,EAAM,GAEiB,WAAvBjG,KAAK2kB,eACL1e,EAAIL,KAAK,CACLD,EAAI,IACJO,EAAIlG,KAAKkkB,QAIblkB,KAAKiJ,OACLhD,EAAIL,KAAK,CACLD,EAAI,QACJO,EAAIlG,KAAKotC,aAIU,YAAvBptC,KAAK2kB,eAA+B3kB,KAAKktC,gBACzCjnC,EAAIL,KAAK,CACLD,EAAI,aACJO,EAAIlG,KAAKqtC,sBAIbrtC,KAAKwkB,KAAOxkB,KAAKykB,MACjBxe,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKwkB,MAEbve,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKykB,OAIbzkB,KAAK6kB,SACL5e,EAAIL,KAAK,CACLD,EAAI,QACJO,EAAIlG,KAAK6kB,UAIb7kB,KAAK4kB,oBACL3e,EAAIL,KAAK,CACLD,EAAI,qBACJO,EAAIlG,KAAK4kB,qBAIjB,MAAMT,EAAUnkB,KAAKmtC,aACrB,IAAK,IAAIrmC,KAAOqd,EACZle,EAAIL,KAAK,CACLD,EAAImB,EACJZ,EAAIie,EAAQrd,KAIpB,OAAOb,CACX,EAEA,S,+CCWA,QArKiB,CAQb8vB,IAAM,SAAUuX,GACZ,GAAIA,EAAS,IACT,MAAM,IAAI7tC,MAAM,IAAM6tC,EAAS,iCAGnC,OAAQ,IADEC,OAAOD,GAAQE,SAAS,KACfv/B,OAAO,EAC9B,EAQAw/B,IAAM,SAAUC,GACZ,OAAO/lB,SAAS+lB,EAAM,GAC1B,EASAC,YAAc,SAAU91B,GACpB,IAAKrO,MAAM4E,QAAQyJ,GACf,MAAM,IAAIpY,MAAM,kBAEpB,IAAImuC,EAAM/1B,EAAO,GACbg2B,EAAQh2B,EAAO,GACfi2B,EAAOj2B,EAAO,GACdk2B,EAAQl2B,EAAO,IAAM,EAEzB,MADa,QAAU+1B,EAAM,KAAOC,EAAQ,KAAOC,EAAO,KAAOxC,WAAWyC,GAAS,GAEzF,EASAC,WAAa,SAAUn2B,GACnB,IAAKrO,MAAM4E,QAAQyJ,GACf,MAAM,IAAIpY,MAAM,kBAEpB,IAAImuC,EAAM/1B,EAAO,GACbg2B,EAAQh2B,EAAO,GACfi2B,EAAOj2B,EAAO,GACdk2B,EAAQl2B,EAAO,GACfo2B,EAAQ,CAACjuC,KAAK+1B,IAAI6X,GAAM5tC,KAAK+1B,IAAI8X,GAAQ7tC,KAAK+1B,IAAI+X,IAClD7iC,EAAS,CAAC,EAMd,OALAA,EAAO8qB,IAAM,IAAMkY,EAAMnoC,KAAK,IAC1BioC,IAEA9iC,EAAOgN,QAAUqzB,WAAWyC,IAEzB9iC,CACX,EAUA6qB,UAAY,SAAUoY,GAClB,IACIC,EADQ,oEACOre,KAAKoe,GACxB,IAAKC,EACD,MAAM,IAAI1uC,MAAM,mBAAqByuC,GAEzC,IAAIN,EAAMO,EAAO,GACbN,EAAQM,EAAO,GACfL,EAAOK,EAAO,GACdJ,EAAQI,EAAO,GACfF,EAAQ,CAACjuC,KAAK+1B,IAAI6X,GAAM5tC,KAAK+1B,IAAI8X,GAAQ7tC,KAAK+1B,IAAI+X,IAClD7iC,EAAS,CAAC,EAMd,OALAA,EAAO8qB,IAAM,IAAMkY,EAAMnoC,KAAK,IAC1BioC,IAEA9iC,EAAOgN,QAAUqzB,WAAWyC,IAEzB9iC,CACX,EAWA0O,UAAY,SAAUoc,EAAK9d,GAGvB,IAAK8d,EACD,MAAM,IAAIt2B,MAAM,kBAEpBs2B,EAAMA,EAAI1nB,QAJW,oCAIa,SAAU+/B,EAAGC,EAAG/I,EAAG9qB,GACjD,OAAO6zB,EAAIA,EAAI/I,EAAIA,EAAI9qB,EAAIA,CAC/B,IAEA,IAAI8zB,EAAM,4CAA4Cxe,KAAKiG,GAO3D,OANAuY,EAAMA,EAAM,CACRD,EAAI1mB,SAAS2mB,EAAI,GAAI,IACrBhJ,EAAI3d,SAAS2mB,EAAI,GAAI,IACrB9zB,EAAImN,SAAS2mB,EAAI,GAAI,KACrB,MACe,QAAUA,EAAID,EAAI,KAAOC,EAAIhJ,EAAI,KAAOgJ,EAAI9zB,EAAI,KAAOvC,EAAU,IAAM,IAE9F,EAOAihB,MAAQ,SAAUnyB,GACd,IAAKA,EACD,OAAO,EAEX,GAAwB,MAApBA,EAAMwnC,OAAO,GACb,OAAO,EAIX,QAFY,4CACOze,KAAK/oB,EAK5B,EAOA6uB,MAAQ,SAAU7uB,GACd,IAAKA,EACD,OAAO,EAIX,QAFY,oEACO+oB,KAAK/oB,EAK5B,E,iFCjKJ,SAASynC,EAAoB5uC,GAIzB,GAHAI,KAAKX,OAAS,IAAOC,UAAU,sBAC/BU,KAAKX,OAAOE,MAAM,0CAEZS,gBAAgBwuC,GAClB,MAAM,IAAIvqC,UAAU,kEAIxB,IAAKrE,EACD,MAAM,IAAIH,MAAM,IAAEwK,WAAW,cAAe,YAIhDjK,KAAKZ,SAAWQ,CACpB,CAEA4uC,EAAmBrpC,UAAY,CAU3BspC,cAAgB,KAKhBrpC,YAAcopC,EAOdE,qBAAuB,WACnB,IAAI5jC,EAAU,GAGd,MAEMkD,EAFU,IAAI,IAAiBhO,KAAKZ,UAEnB4G,YACvB,IAAK,IAAIoP,EAAI,EAAGA,EAAIpH,EAAO5M,OAAQgU,IAAK,CACpC,IAAIwO,EAAI5V,EAAOoH,GACXtK,IACAA,GAAW,KAEfA,GAAW8Y,EAAEje,EAAI,IAAMie,EAAE1d,CAC7B,CAEA,IAAKlG,KAAKZ,SAASulB,eAAkD,WAAhC3kB,KAAKZ,SAASulB,eAA8D,YAAhC3kB,KAAKZ,SAASulB,cAC3F,MAAM,IAAIllB,MAAM,iCAMpB,OAHAO,KAAKyuC,cAAgB,IAAM3jC,EAC3B9K,KAAKX,OAAOE,MAAMS,KAAKyuC,eAEhBzuC,KAAKyuC,aAChB,GAGJ,S,+CCxEA,IAAIE,EAAY,CASZC,OAAS,SAAUr0B,EAAGC,GAClB,IAAI6zB,EAAI9zB,EAAIC,EACZ,OAAO6zB,EAAI7zB,EAAI,EAAI6zB,EAAI7zB,EAAI6zB,CAC/B,EAYAQ,aAAe,SAAUC,EAASC,EAAaC,GAC3C,IAAIC,EAAoBjvC,KAAK4uC,OAAOE,EAAU,IAAK,KAAO,IACtDxpC,EAAIiyB,KAAK2X,IAAI,KAAOD,GACpBE,EAAeH,GAAa,EAC5BI,EAAY7X,KAAK8X,IAAI,GAAIF,GAEzBG,EAAM/X,KAAKyR,MAAM1jC,EAAI,MACrBmN,EAAM8kB,KAAKyR,OAAO1jC,EAAU,KAANgqC,GAAc,IACpCC,EAAMjqC,EAAW,KAANgqC,EAAqB,GAAN78B,EAc9B,OAbA88B,EAAMhY,KAAKiY,KAAKD,EAAMH,GAAaA,IAExB,KACPG,EAAM,EACN98B,GAAO,GAGPA,GAAO,KACPA,EAAM,EACN68B,GAAO,GAIJ,CACHG,EAAIH,EACJlB,EAAI37B,EACJi9B,EAAIH,EACJI,UALYZ,EAAYR,OAAOU,EAAoB,EAAI,EAAI,GAOnE,EAYAW,aAAY,SAAEd,EAASe,EAASC,EAASf,GACrC,IAAIgB,EAAKjB,EAAUe,EAAQ,GAAKC,EAAO,KAKvC,MAHmB,KAAff,GAAqC,KAAfA,IACtBgB,IAAW,GAERA,CACX,EAQAC,oBAAmB,SAAEvhB,GACjB,IAAIvC,EAAa,CAAC,EAIlB,OAHAA,EAAWzH,IAAMgK,EAAa,GAAGC,QAAQ,GACzCxC,EAAW+jB,IAAMxhB,EAAa,GAAGC,QAAQ,GACzCxC,EAAWgkB,KAAO,IACXhkB,CACX,EASAikB,gBAAe,SAAE1hB,GACb,MAAO,CACHwhB,IAAMtB,EAAUE,aAAapgB,EAAa,GAAI,KAAM,GACpDhK,IAAMkqB,EAAUE,aAAapgB,EAAa,GAAI,KAAM,GACpDyhB,KAAO,MAEf,EASAE,gBAAe,SAAE3hB,GACb,IAAIvC,EAAa,CAAC,EACdujB,EAAI,oBAMR,OALAvjB,EAAW+jB,IAAMxhB,EAAa,GAAKghB,EACnCvjB,EAAW+jB,IAAM/jB,EAAW+jB,IAAIvhB,QAAQ,GACxCxC,EAAWzH,IAAMgK,EAAa,GAAKghB,EACnCvjB,EAAWzH,IAAMyH,EAAWzH,IAAIiK,QAAQ,GACxCxC,EAAWgkB,KAAO,MACXhkB,CACX,EASAmkB,gBAAe,SAAE5hB,GACb,IAAIvC,EAAa,CAAC,EACdujB,EAAI,mBAMR,OALAvjB,EAAW+jB,IAAMxhB,EAAa,GAAKghB,EACnCvjB,EAAW+jB,IAAM/jB,EAAW+jB,IAAIvhB,QAAQ,GACxCxC,EAAWzH,IAAMgK,EAAa,GAAKghB,EACnCvjB,EAAWzH,IAAMyH,EAAWzH,IAAIiK,QAAQ,GACxCxC,EAAWgkB,KAAO,MACXhkB,CACX,EASAokB,kBAAiB,SAAE7hB,GAEf,IAAIvC,EAAa,CAAC,EAIlB,OAHAA,EAAW5mB,EAAImpB,EAAa,GAAGC,QAAQ,GACvCxC,EAAW3mB,EAAIkpB,EAAa,GAAGC,QAAQ,GACvCxC,EAAWgkB,KAAO,IACXhkB,CACX,EASAqkB,mBAAkB,SAAE9hB,GAEhB,IAAIvC,EAAa,CAAC,EAIlB,OAHAA,EAAW5mB,GAAKmpB,EAAa,GAAK,KAAMC,QAAQ,GAChDxC,EAAW3mB,GAAKkpB,EAAa,GAAK,KAAMC,QAAQ,GAChDxC,EAAWgkB,KAAO,KACXhkB,CACX,EAUAskB,UAAY,SAAUd,EAAGe,GACrB,IACI9mB,EAAIhC,SAAS+nB,EADLe,GAAQ,IAEpB,OAAKC,MAAM/mB,IAAMgnB,SAAShnB,GACfA,EAEJ,IACX,EASAinB,UAAY,SAAUlB,GAClB,GAAIgB,MAAMhB,GACN,OAAO,EAGX,IAAIxpC,EAAIolC,WAAWoE,GACnB,OAAa,EAAJxpC,KAAWA,CACxB,EASA2qC,QAAU,SAAUnB,GAChB,IAAI/lB,EAAI2hB,WAAWoE,GACnB,OAAKgB,MAAM/mB,IAAMgnB,SAAShnB,GACfA,EAEJ,IACX,EASAmnB,qBAAuB,SAAUtE,GAC7B,IAAIvnC,EAAO,GAEXunC,EAAWjV,KAAKC,MAAMgV,GACtB,IAAIuE,EAAQxZ,KAAKyR,MAAMwD,EAAW,MAE9BwE,EAAkBxE,EAAW,KAOjC,OAJIuE,IACA9rC,EAAO8rC,EAAQ,MAEnB9rC,GALcsyB,KAAKyR,MAAMgI,EAAkB,IAKzB,MAEtB,EASAC,gBAAkB,SAAUjsC,GACxB,IAEIksC,EAAavpB,SAAS3iB,EAAW,IAAM,IAO3C,OANKksC,EAGGA,EAAa,MAFbvpB,SAAS3iB,EAAU,IAAM,IAMrC,GAGJ,S,6ECpRqChG,GAAG4d,OAAOu0B,S,2ICwC/C,QA9Ba,CAQTC,cAAgB,CAAC,EAOjBC,eAAiB,WAEb,GAAIrxC,KAAKoxC,eAA4D,IAA3ClwC,OAAOC,KAAKnB,KAAKoxC,eAAehwC,OACtD,OAAO,EAEX,IAAIrB,EAA0B,oBAAXwB,OAAyBA,OAAyB,oBAAToH,KAAuBA,UAAyB,IAAX2oC,EAAAA,EAAyBA,EAAAA,EAAS,CAAC,EACpI,SAAIvxC,EAAMsvB,IAAMtvB,EAAMsvB,GAAG+R,QAAUrhC,EAAMsvB,GAAG+R,OAAO1hB,QAAyD,IAA/Cxe,OAAOC,KAAKpB,EAAMsvB,GAAG+R,OAAO1hB,QAAQte,UAC3EpB,KAAKoxC,cAAiBrxC,EAAMsvB,GAAG+R,QAC1C,EAGf;;;;;;;AC9BJ,SAASmQ,EAAQC,EAAQC,GACvB,IAAItwC,EAAOD,OAAOC,KAAKqwC,GACvB,GAAItwC,OAAOwwC,sBAAuB,CAChC,IAAIC,EAAUzwC,OAAOwwC,sBAAsBF,GACvCC,IACFE,EAAUA,EAAQliC,QAAO,SAAUmiC,GACjC,OAAO1wC,OAAO2wC,yBAAyBL,EAAQI,GAAK/V,UACtD,KAEF16B,EAAKyE,KAAK4Y,MAAMrd,EAAMwwC,EACxB,CACA,OAAOxwC,CACT,CACA,SAAS2wC,EAAe/uC,GACtB,IAAK,IAAIqS,EAAI,EAAGA,EAAIrH,UAAU3M,OAAQgU,IAAK,CACzC,IAAIwH,EAAyB,MAAhB7O,UAAUqH,GAAarH,UAAUqH,GAAK,CAAC,EAChDA,EAAI,EACNm8B,EAAQrwC,OAAO0b,IAAS,GAAMhT,SAAQ,SAAU9C,GAC9CirC,EAAgBhvC,EAAQ+D,EAAK8V,EAAO9V,GACtC,IACS5F,OAAO8wC,0BAChB9wC,OAAOy9B,iBAAiB57B,EAAQ7B,OAAO8wC,0BAA0Bp1B,IAEjE20B,EAAQrwC,OAAO0b,IAAShT,SAAQ,SAAU9C,GACxC5F,OAAO+wC,eAAelvC,EAAQ+D,EAAK5F,OAAO2wC,yBAAyBj1B,EAAQ9V,GAC7E,GAEJ,CACA,OAAO/D,CACT,CACA,SAASqX,EAAQhK,GAYf,OAREgK,EADoB,mBAAX83B,QAAoD,iBAApBA,OAAOC,SACtC,SAAU/hC,GAClB,cAAcA,CAChB,EAEU,SAAUA,GAClB,OAAOA,GAAyB,mBAAX8hC,QAAyB9hC,EAAIhL,cAAgB8sC,QAAU9hC,IAAQ8hC,OAAO/sC,UAAY,gBAAkBiL,CAC3H,EAEKgK,EAAQhK,EACjB,CACA,SAAS2hC,EAAgB3hC,EAAKtJ,EAAKC,GAWjC,OAVID,KAAOsJ,EACTlP,OAAO+wC,eAAe7hC,EAAKtJ,EAAK,CAC9BC,MAAOA,EACP80B,YAAY,EACZuW,cAAc,EACdtW,UAAU,IAGZ1rB,EAAItJ,GAAOC,EAENqJ,CACT,CACA,SAASiiC,IAYP,OAXAA,EAAWnxC,OAAOwX,QAAU,SAAU3V,GACpC,IAAK,IAAIqS,EAAI,EAAGA,EAAIrH,UAAU3M,OAAQgU,IAAK,CACzC,IAAIwH,EAAS7O,UAAUqH,GACvB,IAAK,IAAItO,KAAO8V,EACV1b,OAAOiE,UAAUuF,eAAevL,KAAKyd,EAAQ9V,KAC/C/D,EAAO+D,GAAO8V,EAAO9V,GAG3B,CACA,OAAO/D,CACT,EACOsvC,EAAS7zB,MAAMxe,KAAM+N,UAC9B,CAaA,SAASukC,EAAyB11B,EAAQ21B,GACxC,GAAc,MAAV31B,EAAgB,MAAO,CAAC,EAC5B,IACI9V,EAAKsO,EADLrS,EAdN,SAAuC6Z,EAAQ21B,GAC7C,GAAc,MAAV31B,EAAgB,MAAO,CAAC,EAC5B,IAEI9V,EAAKsO,EAFLrS,EAAS,CAAC,EACVyvC,EAAatxC,OAAOC,KAAKyb,GAE7B,IAAKxH,EAAI,EAAGA,EAAIo9B,EAAWpxC,OAAQgU,IACjCtO,EAAM0rC,EAAWp9B,GACbm9B,EAAS94B,QAAQ3S,IAAQ,IAC7B/D,EAAO+D,GAAO8V,EAAO9V,IAEvB,OAAO/D,CACT,CAGe0vC,CAA8B71B,EAAQ21B,GAEnD,GAAIrxC,OAAOwwC,sBAAuB,CAChC,IAAIgB,EAAmBxxC,OAAOwwC,sBAAsB90B,GACpD,IAAKxH,EAAI,EAAGA,EAAIs9B,EAAiBtxC,OAAQgU,IACvCtO,EAAM4rC,EAAiBt9B,GACnBm9B,EAAS94B,QAAQ3S,IAAQ,GACxB5F,OAAOiE,UAAUwtC,qBAAqBxzC,KAAKyd,EAAQ9V,KACxD/D,EAAO+D,GAAO8V,EAAO9V,GAEzB,CACA,OAAO/D,CACT,CA6BA,SAAS+iB,EAAU7L,GACjB,GAAsB,oBAAX1Y,QAA0BA,OAAOwkB,UAC1C,QAAuBA,UAAUD,UAAUpS,MAAMuG,EAErD,CACA,IAAI24B,EAAa9sB,EAAU,yDACvB+sB,EAAO/sB,EAAU,SACjBgtB,EAAUhtB,EAAU,YACpBitB,EAASjtB,EAAU,aAAeA,EAAU,aAAeA,EAAU,YACrEktB,EAAMltB,EAAU,mBAChBmtB,EAAmBntB,EAAU,YAAcA,EAAU,YAErDotB,EAAc,CAChBC,SAAS,EACTC,SAAS,GAEX,SAASrlB,EAAG9W,EAAI4J,EAAOwyB,GACrBp8B,EAAG5E,iBAAiBwO,EAAOwyB,GAAKT,GAAcM,EAChD,CACA,SAASI,EAAIr8B,EAAI4J,EAAOwyB,GACtBp8B,EAAG+uB,oBAAoBnlB,EAAOwyB,GAAKT,GAAcM,EACnD,CACA,SAASK,EAAyBt8B,EAAeu8B,GAC/C,GAAKA,EAAL,CAEA,GADgB,MAAhBA,EAAS,KAAeA,EAAWA,EAAS18B,UAAU,IAClDG,EACF,IACE,GAAIA,EAAGs8B,QACL,OAAOt8B,EAAGs8B,QAAQC,GACb,GAAIv8B,EAAGw8B,kBACZ,OAAOx8B,EAAGw8B,kBAAkBD,GACvB,GAAIv8B,EAAGy8B,sBACZ,OAAOz8B,EAAGy8B,sBAAsBF,EAEpC,CAAE,MAAOG,GACP,OAAO,CACT,CAEF,OAAO,CAfc,CAgBvB,CACA,SAASC,EAAgB38B,GACvB,OAAOA,EAAG48B,MAAQ58B,IAAOzO,UAAYyO,EAAG48B,KAAKxI,SAAWp0B,EAAG48B,KAAO58B,EAAG6yB,UACvE,CACA,SAASgK,EAAyB78B,EAAeu8B,EAA0B5yB,EAAKmzB,GAC9E,GAAI98B,EAAI,CACN2J,EAAMA,GAAOpY,SACb,EAAG,CACD,GAAgB,MAAZgrC,IAAqC,MAAhBA,EAAS,GAAav8B,EAAG6yB,aAAelpB,GAAO2yB,EAAQt8B,EAAIu8B,GAAYD,EAAQt8B,EAAIu8B,KAAcO,GAAc98B,IAAO2J,EAC7I,OAAO3J,EAET,GAAIA,IAAO2J,EAAK,KAElB,OAAS3J,EAAK28B,EAAgB38B,GAChC,CACA,OAAO,IACT,CACA,IA2SI+8B,EA3SAC,EAAU,OACd,SAASC,EAAYj9B,EAAI5O,EAAM8rC,GAC7B,GAAIl9B,GAAM5O,EACR,GAAI4O,EAAGqQ,UACLrQ,EAAGqQ,UAAU6sB,EAAQ,MAAQ,UAAU9rC,OAClC,CACL,IAAIK,GAAa,IAAMuO,EAAGvO,UAAY,KAAK2F,QAAQ4lC,EAAS,KAAK5lC,QAAQ,IAAMhG,EAAO,IAAK,KAC3F4O,EAAGvO,WAAaA,GAAayrC,EAAQ,IAAM9rC,EAAO,KAAKgG,QAAQ4lC,EAAS,IAC1E,CAEJ,CACA,SAASG,EAAIn9B,EAAIqC,EAAMF,GACrB,IAAIna,EAAQgY,GAAMA,EAAGhY,MACrB,GAAIA,EAAO,CACT,QAAY,IAARma,EAMF,OALI5Q,SAAS6rC,aAAe7rC,SAAS6rC,YAAY5Y,iBAC/CriB,EAAM5Q,SAAS6rC,YAAY5Y,iBAAiBxkB,EAAI,IACvCA,EAAGq9B,eACZl7B,EAAMnC,EAAGq9B,mBAEK,IAATh7B,EAAkBF,EAAMA,EAAIE,GAE7BA,KAAQra,IAAsC,IAA5Bqa,EAAKG,QAAQ,YACnCH,EAAO,WAAaA,GAEtBra,EAAMqa,GAAQF,GAAsB,iBAARA,EAAmB,GAAK,KAExD,CACF,CACA,SAASm7B,EAAOt9B,EAAIu9B,GAClB,IAAIC,EAAoB,GACxB,GAAkB,iBAAPx9B,EACTw9B,EAAoBx9B,OAEpB,EAAG,CACD,IAAIy9B,EAAYN,EAAIn9B,EAAI,aACpBy9B,GAA2B,SAAdA,IACfD,EAAoBC,EAAY,IAAMD,EAG1C,QAAUD,IAAav9B,EAAKA,EAAG6yB,aAEjC,IAAI6K,EAAWpzC,OAAOqzC,WAAarzC,OAAOszC,iBAAmBtzC,OAAOuzC,WAAavzC,OAAOwzC,YAExF,OAAOJ,GAAY,IAAIA,EAASF,EAClC,CACA,SAASO,EAAKp0B,EAAKpK,EAAS27B,GAC1B,GAAIvxB,EAAK,CACP,IAAI6G,EAAO7G,EAAI7M,qBAAqByC,GAClCpB,EAAI,EACJuU,EAAIlC,EAAKrmB,OACX,GAAI+wC,EACF,KAAO/8B,EAAIuU,EAAGvU,IACZ+8B,EAAS1qB,EAAKrS,GAAIA,GAGtB,OAAOqS,CACT,CACA,MAAO,EACT,CACA,SAASwtB,IACP,IAAIC,EAAmB1sC,SAAS0sC,iBAChC,OAAIA,GAGK1sC,SAASsL,eAEpB,CAWA,SAASqhC,EAAQl+B,EAAIm+B,EAA2BC,EAA2BC,EAAW3tC,GACpF,GAAKsP,EAAGs+B,uBAAyBt+B,IAAO1V,OAAxC,CACA,IAAIi0C,EAAQrsC,EAAKE,EAAMD,EAAQE,EAAOP,EAAQ+O,EAiB9C,GAhBIb,IAAO1V,QAAU0V,EAAG6yB,YAAc7yB,IAAOg+B,KAE3C9rC,GADAqsC,EAASv+B,EAAGs+B,yBACCpsC,IACbE,EAAOmsC,EAAOnsC,KACdD,EAASosC,EAAOpsC,OAChBE,EAAQksC,EAAOlsC,MACfP,EAASysC,EAAOzsC,OAChB+O,EAAQ09B,EAAO19B,QAEf3O,EAAM,EACNE,EAAO,EACPD,EAAS7H,OAAOk0C,YAChBnsC,EAAQ/H,OAAOm0C,WACf3sC,EAASxH,OAAOk0C,YAChB39B,EAAQvW,OAAOm0C,aAEZN,GAA6BC,IAA8Bp+B,IAAO1V,SAErEoG,EAAYA,GAAasP,EAAG6yB,YAIvB8I,GACH,GACE,GAAIjrC,GAAaA,EAAU4tC,wBAA0D,SAAhCnB,EAAIzsC,EAAW,cAA2B0tC,GAA4D,WAA/BjB,EAAIzsC,EAAW,aAA2B,CACpK,IAAIguC,EAAgBhuC,EAAU4tC,wBAG9BpsC,GAAOwsC,EAAcxsC,IAAMwe,SAASysB,EAAIzsC,EAAW,qBACnD0B,GAAQssC,EAActsC,KAAOse,SAASysB,EAAIzsC,EAAW,sBACrDyB,EAASD,EAAMqsC,EAAOzsC,OACtBO,EAAQD,EAAOmsC,EAAO19B,MACtB,KACF,QAEOnQ,EAAYA,EAAUmiC,YAGnC,GAAIwL,GAAar+B,IAAO1V,OAAQ,CAE9B,IAAIq0C,EAAWrB,EAAO5sC,GAAasP,GACjC4+B,EAASD,GAAYA,EAASr7B,EAC9Bu7B,EAASF,GAAYA,EAASnG,EAC5BmG,IAKFxsC,GAJAD,GAAO2sC,IAGP/sC,GAAU+sC,GAEVxsC,GAJAD,GAAQwsC,IACR/9B,GAAS+9B,GAKb,CACA,MAAO,CACL1sC,IAAKA,EACLE,KAAMA,EACND,OAAQA,EACRE,MAAOA,EACPwO,MAAOA,EACP/O,OAAQA,EA5D4C,CA8DxD,CASA,SAASgtC,EAAe9+B,EAAI++B,EAAQC,GAKlC,IAJA,IAAIC,EAASC,EAA2Bl/B,GAAI,GAC1Cm/B,EAAYjB,EAAQl+B,GAAI++B,GAGnBE,GAAQ,CACb,IAAIG,EAAgBlB,EAAQe,GAAQD,GAOpC,KALmB,QAAfA,GAAuC,SAAfA,EAChBG,GAAaC,EAEbD,GAAaC,GAEX,OAAOH,EACrB,GAAIA,IAAWjB,IAA6B,MAC5CiB,EAASC,EAA2BD,GAAQ,EAC9C,CACA,OAAO,CACT,CAUA,SAASI,EAASr/B,EAAIs/B,EAAU32C,EAAS42C,GAIvC,IAHA,IAAIC,EAAe,EACjBrhC,EAAI,EACJnN,EAAWgP,EAAGhP,SACTmN,EAAInN,EAAS7G,QAAQ,CAC1B,GAAkC,SAA9B6G,EAASmN,GAAGnW,MAAM+U,SAAsB/L,EAASmN,KAAOshC,GAASC,QAAUH,GAAiBvuC,EAASmN,KAAOshC,GAASE,UAAY9C,EAAQ7rC,EAASmN,GAAIxV,EAAQi3C,UAAW5/B,GAAI,GAAQ,CACvL,GAAIw/B,IAAiBF,EACnB,OAAOtuC,EAASmN,GAElBqhC,GACF,CACArhC,GACF,CACA,OAAO,IACT,CAQA,SAAS0hC,EAAU7/B,EAAIu8B,GAErB,IADA,IAAI7qB,EAAO1R,EAAG8/B,iBACPpuB,IAASA,IAAS+tB,GAASC,OAAkC,SAAzBvC,EAAIzrB,EAAM,YAAyB6qB,IAAaD,EAAQ5qB,EAAM6qB,KACvG7qB,EAAOA,EAAKquB,uBAEd,OAAOruB,GAAQ,IACjB,CASA,SAAS1f,EAAMgO,EAAIu8B,GACjB,IAAIvqC,EAAQ,EACZ,IAAKgO,IAAOA,EAAG6yB,WACb,OAAQ,EAIV,KAAO7yB,EAAKA,EAAG+/B,wBACqB,aAA9B//B,EAAGnN,SAASa,eAAgCsM,IAAOy/B,GAASh6B,OAAW82B,IAAYD,EAAQt8B,EAAIu8B,IACjGvqC,IAGJ,OAAOA,CACT,CAQA,SAASguC,EAAwBhgC,GAC/B,IAAIigC,EAAa,EACfC,EAAY,EACZC,EAAcnC,IAChB,GAAIh+B,EACF,EAAG,CACD,IAAI2+B,EAAWrB,EAAOt9B,GACpB4+B,EAASD,EAASr7B,EAClBu7B,EAASF,EAASnG,EACpByH,GAAcjgC,EAAGogC,WAAaxB,EAC9BsB,GAAalgC,EAAGqgC,UAAYxB,CAC9B,OAAS7+B,IAAOmgC,IAAgBngC,EAAKA,EAAG6yB,aAE1C,MAAO,CAACoN,EAAYC,EACtB,CAiBA,SAAShB,EAA2Bl/B,EAAIsgC,GAEtC,IAAKtgC,IAAOA,EAAGs+B,sBAAuB,OAAON,IAC7C,IAAIuC,EAAOvgC,EACPwgC,GAAU,EACd,GAEE,GAAID,EAAKE,YAAcF,EAAKG,aAAeH,EAAKI,aAAeJ,EAAKK,aAAc,CAChF,IAAIC,EAAU1D,EAAIoD,GAClB,GAAIA,EAAKE,YAAcF,EAAKG,cAAqC,QAArBG,EAAQC,WAA4C,UAArBD,EAAQC,YAA0BP,EAAKI,aAAeJ,EAAKK,eAAsC,QAArBC,EAAQE,WAA4C,UAArBF,EAAQE,WAAwB,CACpN,IAAKR,EAAKjC,uBAAyBiC,IAAShvC,SAAS7G,KAAM,OAAOszC,IAClE,GAAIwC,GAAWF,EAAa,OAAOC,EACnCC,GAAU,CACZ,CACF,QAEOD,EAAOA,EAAK1N,YACrB,OAAOmL,GACT,CAWA,SAASgD,EAAYC,EAAOC,GAC1B,OAAO5gB,KAAKC,MAAM0gB,EAAM/uC,OAASouB,KAAKC,MAAM2gB,EAAMhvC,MAAQouB,KAAKC,MAAM0gB,EAAM7uC,QAAUkuB,KAAKC,MAAM2gB,EAAM9uC,OAASkuB,KAAKC,MAAM0gB,EAAMnvC,UAAYwuB,KAAKC,MAAM2gB,EAAMpvC,SAAWwuB,KAAKC,MAAM0gB,EAAMpgC,SAAWyf,KAAKC,MAAM2gB,EAAMrgC,MACvN,CAEA,SAASsgC,GAASvS,EAAUwS,GAC1B,OAAO,WACL,IAAKrE,EAAkB,CACrB,IAAI7lC,EAAOJ,UAES,IAAhBI,EAAK/M,OACPykC,EAAS1mC,KAFDa,KAEamO,EAAK,IAE1B03B,EAASrnB,MAJDxe,KAIcmO,GAExB6lC,EAAmB1xC,YAAW,WAC5B0xC,OAAmB,CACrB,GAAGqE,EACL,CACF,CACF,CAKA,SAASC,GAASrhC,EAAI3R,EAAGC,GACvB0R,EAAGogC,YAAc/xC,EACjB2R,EAAGqgC,WAAa/xC,CAClB,CACA,SAASmX,GAAMzF,GACb,IAAIshC,EAAUh3C,OAAOg3C,QACjBC,EAAIj3C,OAAOk3C,QAAUl3C,OAAOm3C,MAChC,OAAIH,GAAWA,EAAQI,IACdJ,EAAQI,IAAI1hC,GAAI2hC,WAAU,GACxBJ,EACFA,EAAEvhC,GAAIyF,OAAM,GAAM,GAElBzF,EAAG2hC,WAAU,EAExB,CAeA,SAASC,GAAkClxC,EAAW/H,EAASk5C,GAC7D,IAAIC,EAAO,CAAC,EAcZ,OAbAvvC,MAAMC,KAAK9B,EAAUM,UAAU2B,SAAQ,SAAUshC,GAC/C,IAAI8N,EAAYC,EAAWC,EAAaC,EACxC,GAAKrF,EAAQ5I,EAAOtrC,EAAQi3C,UAAWlvC,GAAW,KAAUujC,EAAMkO,UAAYlO,IAAU4N,EAAxF,CACA,IAAIO,EAAYlE,EAAQjK,GACxB6N,EAAK1vC,KAAOkuB,KAAK9kB,IAAiC,QAA5BumC,EAAaD,EAAK1vC,YAAiC,IAAf2vC,EAAwBA,EAAaM,IAAUD,EAAUhwC,MACnH0vC,EAAK5vC,IAAMouB,KAAK9kB,IAA+B,QAA1BwmC,EAAYF,EAAK5vC,WAA+B,IAAd8vC,EAAuBA,EAAYK,IAAUD,EAAUlwC,KAC9G4vC,EAAKzvC,MAAQiuB,KAAK5kB,IAAmC,QAA9BumC,EAAcH,EAAKzvC,aAAmC,IAAhB4vC,EAAyBA,GAAeI,IAAUD,EAAU/vC,OACzHyvC,EAAK3vC,OAASmuB,KAAK5kB,IAAqC,QAAhCwmC,EAAeJ,EAAK3vC,cAAqC,IAAjB+vC,EAA0BA,GAAgBG,IAAUD,EAAUjwC,OALvB,CAMzG,IACA2vC,EAAKjhC,MAAQihC,EAAKzvC,MAAQyvC,EAAK1vC,KAC/B0vC,EAAKhwC,OAASgwC,EAAK3vC,OAAS2vC,EAAK5vC,IACjC4vC,EAAKzzC,EAAIyzC,EAAK1vC,KACd0vC,EAAKxzC,EAAIwzC,EAAK5vC,IACP4vC,CACT,CACA,IAAIQ,GAAU,YAAa,IAAItQ,MAAOuQ,UAEtC,SAASC,KACP,IACEC,EADEC,EAAkB,GAEtB,MAAO,CACLC,sBAAuB,YACrBD,EAAkB,GACb35C,KAAKJ,QAAQi6C,YACH,GAAG5rC,MAAM9O,KAAKa,KAAKiX,GAAGhP,UAC5B2B,SAAQ,SAAUshC,GACzB,GAA8B,SAA1BkJ,EAAIlJ,EAAO,YAAyBA,IAAUwL,GAASC,MAA3D,CACAgD,EAAgB/zC,KAAK,CACnB7C,OAAQmoC,EACR6N,KAAM5D,EAAQjK,KAEhB,IAAI4O,EAAWhI,EAAe,CAAC,EAAG6H,EAAgBA,EAAgBv4C,OAAS,GAAG23C,MAG9E,GAAI7N,EAAM6O,sBAAuB,CAC/B,IAAIC,EAAczF,EAAOrJ,GAAO,GAC5B8O,IACFF,EAAS3wC,KAAO6wC,EAAY1f,EAC5Bwf,EAASzwC,MAAQ2wC,EAAY/3C,EAEjC,CACAipC,EAAM4O,SAAWA,CAfuD,CAgB1E,GACF,EACAG,kBAAmB,SAA2B9F,GAC5CwF,EAAgB/zC,KAAKuuC,EACvB,EACA+F,qBAAsB,SAA8Bn3C,GAClD42C,EAAgB5T,OA7ItB,SAAuBoU,EAAK/pC,GAC1B,IAAK,IAAIgF,KAAK+kC,EACZ,GAAKA,EAAIzvC,eAAe0K,GACxB,IAAK,IAAItO,KAAOsJ,EACd,GAAIA,EAAI1F,eAAe5D,IAAQsJ,EAAItJ,KAASqzC,EAAI/kC,GAAGtO,GAAM,OAAOymC,OAAOn4B,GAG3E,OAAQ,CACV,CAqI6BglC,CAAcT,EAAiB,CACpD52C,OAAQA,IACN,EACN,EACAs3C,WAAY,SAAoBxU,GAC9B,IAAIx/B,EAAQrG,KACZ,IAAKA,KAAKJ,QAAQi6C,UAGhB,OAFA/2C,aAAa42C,QACW,mBAAb7T,GAAyBA,KAGtC,IAAIyU,GAAY,EACdC,EAAgB,EAClBZ,EAAgB/vC,SAAQ,SAAUuqC,GAChC,IAAIlvC,EAAO,EACTlC,EAASoxC,EAAMpxC,OACf+2C,EAAW/2C,EAAO+2C,SAClBU,EAASrF,EAAQpyC,GACjB03C,EAAe13C,EAAO03C,aACtBC,EAAa33C,EAAO23C,WACpBC,EAAgBxG,EAAM4E,KACtB6B,EAAerG,EAAOxxC,GAAQ,GAC5B63C,IAEFJ,EAAOrxC,KAAOyxC,EAAatgB,EAC3BkgB,EAAOnxC,MAAQuxC,EAAa34C,GAE9Bc,EAAOy3C,OAASA,EACZz3C,EAAOg3C,uBAEL9B,EAAYwC,EAAcD,KAAYvC,EAAY6B,EAAUU,KAE/DG,EAAcxxC,IAAMqxC,EAAOrxC,MAAQwxC,EAActxC,KAAOmxC,EAAOnxC,QAAWywC,EAAS3wC,IAAMqxC,EAAOrxC,MAAQ2wC,EAASzwC,KAAOmxC,EAAOnxC,QAE9HpE,EAoEZ,SAA2B01C,EAAeb,EAAUU,EAAQ56C,GAC1D,OAAO23B,KAAKsjB,KAAKtjB,KAAK8X,IAAIyK,EAAS3wC,IAAMwxC,EAAcxxC,IAAK,GAAKouB,KAAK8X,IAAIyK,EAASzwC,KAAOsxC,EAActxC,KAAM,IAAMkuB,KAAKsjB,KAAKtjB,KAAK8X,IAAIyK,EAAS3wC,IAAMqxC,EAAOrxC,IAAK,GAAKouB,KAAK8X,IAAIyK,EAASzwC,KAAOmxC,EAAOnxC,KAAM,IAAMzJ,EAAQi6C,SAC7N,CAtEmBiB,CAAkBH,EAAeF,EAAcC,EAAYr0C,EAAMzG,UAKvEq4C,EAAYuC,EAAQV,KACvB/2C,EAAO03C,aAAeX,EACtB/2C,EAAO23C,WAAaF,EACfv1C,IACHA,EAAOoB,EAAMzG,QAAQi6C,WAEvBxzC,EAAM00C,QAAQh4C,EAAQ43C,EAAeH,EAAQv1C,IAE3CA,IACFq1C,GAAY,EACZC,EAAgBhjB,KAAK5kB,IAAI4nC,EAAet1C,GACxCnC,aAAaC,EAAOi4C,qBACpBj4C,EAAOi4C,oBAAsB14C,YAAW,WACtCS,EAAOw3C,cAAgB,EACvBx3C,EAAO03C,aAAe,KACtB13C,EAAO+2C,SAAW,KAClB/2C,EAAO23C,WAAa,KACpB33C,EAAOg3C,sBAAwB,IACjC,GAAG90C,GACHlC,EAAOg3C,sBAAwB90C,EAEnC,IACAnC,aAAa42C,GACRY,EAGHZ,EAAsBp3C,YAAW,WACP,mBAAbujC,GAAyBA,GACtC,GAAG0U,GAJqB,mBAAb1U,GAAyBA,IAMtC8T,EAAkB,EACpB,EACAoB,QAAS,SAAiBh4C,EAAQk4C,EAAaT,EAAQhO,GACrD,GAAIA,EAAU,CACZ4H,EAAIrxC,EAAQ,aAAc,IAC1BqxC,EAAIrxC,EAAQ,YAAa,IACzB,IAAI6yC,EAAWrB,EAAOv0C,KAAKiX,IACzB4+B,EAASD,GAAYA,EAASr7B,EAC9Bu7B,EAASF,GAAYA,EAASnG,EAC9ByL,GAAcD,EAAY5xC,KAAOmxC,EAAOnxC,OAASwsC,GAAU,GAC3DsF,GAAcF,EAAY9xC,IAAMqxC,EAAOrxC,MAAQ2sC,GAAU,GAC3D/yC,EAAOq4C,aAAeF,EACtBn4C,EAAOs4C,aAAeF,EACtB/G,EAAIrxC,EAAQ,YAAa,eAAiBm4C,EAAa,MAAQC,EAAa,SAC5En7C,KAAKs7C,gBAgBb,SAAiBv4C,GACf,OAAOA,EAAO8F,WAChB,CAlB+B0yC,CAAQx4C,GAE/BqxC,EAAIrxC,EAAQ,aAAc,aAAeypC,EAAW,MAAQxsC,KAAKJ,QAAQ47C,OAAS,IAAMx7C,KAAKJ,QAAQ47C,OAAS,KAC9GpH,EAAIrxC,EAAQ,YAAa,sBACE,iBAApBA,EAAOq2C,UAAyBt2C,aAAaC,EAAOq2C,UAC3Dr2C,EAAOq2C,SAAW92C,YAAW,WAC3B8xC,EAAIrxC,EAAQ,aAAc,IAC1BqxC,EAAIrxC,EAAQ,YAAa,IACzBA,EAAOq2C,UAAW,EAClBr2C,EAAOq4C,YAAa,EACpBr4C,EAAOs4C,YAAa,CACtB,GAAG7O,EACL,CACF,EAEJ,CAQA,IAAIiP,GAAU,GACVC,GAAW,CACbC,qBAAqB,GAEnBC,GAAgB,CAClBC,MAAO,SAAeC,GAEpB,IAAK,IAAIC,KAAUL,GACbA,GAAShxC,eAAeqxC,MAAaA,KAAUD,KACjDA,EAAOC,GAAUL,GAASK,IAG9BN,GAAQ7xC,SAAQ,SAAUoyC,GACxB,GAAIA,EAAEC,aAAeH,EAAOG,WAC1B,KAAM,iCAAiC1rB,OAAOurB,EAAOG,WAAY,kBAErE,IACAR,GAAQ71C,KAAKk2C,EACf,EACAI,YAAa,SAAqBC,EAAWC,EAAUC,GACrD,IAAIh2C,EAAQrG,KACZA,KAAKs8C,eAAgB,EACrBD,EAAIE,OAAS,WACXl2C,EAAMi2C,eAAgB,CACxB,EACA,IAAIE,EAAkBL,EAAY,SAClCV,GAAQ7xC,SAAQ,SAAUkyC,GACnBM,EAASN,EAAOG,cAEjBG,EAASN,EAAOG,YAAYO,IAC9BJ,EAASN,EAAOG,YAAYO,GAAiB1K,EAAe,CAC1DsK,SAAUA,GACTC,IAKDD,EAASx8C,QAAQk8C,EAAOG,aAAeG,EAASN,EAAOG,YAAYE,IACrEC,EAASN,EAAOG,YAAYE,GAAWrK,EAAe,CACpDsK,SAAUA,GACTC,IAEP,GACF,EACAI,kBAAmB,SAA2BL,EAAUnlC,EAAIykC,EAAU97C,GAYpE,IAAK,IAAIm8C,KAXTN,GAAQ7xC,SAAQ,SAAUkyC,GACxB,IAAIG,EAAaH,EAAOG,WACxB,GAAKG,EAASx8C,QAAQq8C,IAAgBH,EAAOH,oBAA7C,CACA,IAAIe,EAAc,IAAIZ,EAAOM,EAAUnlC,EAAImlC,EAASx8C,SACpD88C,EAAYN,SAAWA,EACvBM,EAAY98C,QAAUw8C,EAASx8C,QAC/Bw8C,EAASH,GAAcS,EAGvBrK,EAASqJ,EAAUgB,EAAYhB,SAPyC,CAQ1E,IACmBU,EAASx8C,QAC1B,GAAKw8C,EAASx8C,QAAQ8K,eAAeqxC,GAArC,CACA,IAAIY,EAAW38C,KAAK48C,aAAaR,EAAUL,EAAQK,EAASx8C,QAAQm8C,SAC5C,IAAbY,IACTP,EAASx8C,QAAQm8C,GAAUY,EAHyB,CAM1D,EACAE,mBAAoB,SAA4Bx0C,EAAM+zC,GACpD,IAAIU,EAAkB,CAAC,EAKvB,OAJArB,GAAQ7xC,SAAQ,SAAUkyC,GACc,mBAA3BA,EAAOgB,iBAClBzK,EAASyK,EAAiBhB,EAAOgB,gBAAgB39C,KAAKi9C,EAASN,EAAOG,YAAa5zC,GACrF,IACOy0C,CACT,EACAF,aAAc,SAAsBR,EAAU/zC,EAAMtB,GAClD,IAAIg2C,EAUJ,OATAtB,GAAQ7xC,SAAQ,SAAUkyC,GAEnBM,EAASN,EAAOG,aAGjBH,EAAOkB,iBAA2D,mBAAjClB,EAAOkB,gBAAgB30C,KAC1D00C,EAAgBjB,EAAOkB,gBAAgB30C,GAAMlJ,KAAKi9C,EAASN,EAAOG,YAAal1C,GAEnF,IACOg2C,CACT,GAGF,SAASE,GAAcC,GACrB,IAAId,EAAWc,EAAKd,SAClBe,EAASD,EAAKC,OACd90C,EAAO60C,EAAK70C,KACZ+0C,EAAWF,EAAKE,SAChBC,EAAUH,EAAKG,QACfC,EAAOJ,EAAKI,KACZC,EAASL,EAAKK,OACdC,EAAWN,EAAKM,SAChBC,EAAWP,EAAKO,SAChBC,EAAoBR,EAAKQ,kBACzBC,EAAoBT,EAAKS,kBACzBC,EAAgBV,EAAKU,cACrBC,EAAcX,EAAKW,YACnBC,EAAuBZ,EAAKY,qBAE9B,GADA1B,EAAWA,GAAYe,GAAUA,EAAO5D,IACxC,CACA,IAAI8C,EACFz8C,EAAUw8C,EAASx8C,QACnBm+C,EAAS,KAAO11C,EAAKkmC,OAAO,GAAG5jC,cAAgBtC,EAAK21C,OAAO,IAEzDz8C,OAAO08C,aAAgBrL,GAAeC,GAMxCwJ,EAAM7zC,SAAS01C,YAAY,UACvBC,UAAU91C,GAAM,GAAM,GAN1Bg0C,EAAM,IAAI4B,YAAY51C,EAAM,CAC1B+1C,SAAS,EACTC,YAAY,IAMhBhC,EAAIiC,GAAKhB,GAAQH,EACjBd,EAAI5yC,KAAO8zC,GAAUJ,EACrBd,EAAIkC,KAAOnB,GAAYD,EACvBd,EAAI3/B,MAAQ2gC,EACZhB,EAAImB,SAAWA,EACfnB,EAAIoB,SAAWA,EACfpB,EAAIqB,kBAAoBA,EACxBrB,EAAIsB,kBAAoBA,EACxBtB,EAAIuB,cAAgBA,EACpBvB,EAAImC,SAAWX,EAAcA,EAAYY,iBAAct+B,EACvD,IAAIu+B,EAAqB5M,EAAeA,EAAe,CAAC,EAAGgM,GAAuBlC,GAAciB,mBAAmBx0C,EAAM+zC,IACzH,IAAK,IAAIL,KAAU2C,EACjBrC,EAAIN,GAAU2C,EAAmB3C,GAE/BoB,GACFA,EAAOF,cAAcZ,GAEnBz8C,EAAQm+C,IACVn+C,EAAQm+C,GAAQ5+C,KAAKi9C,EAAUC,EAhCZ,CAkCvB,CAEA,IAAIsC,GAAY,CAAC,OACbzC,GAAc,SAAqBC,EAAWC,GAChD,IAAIc,EAAOnvC,UAAU3M,OAAS,QAAsB+e,IAAjBpS,UAAU,GAAmBA,UAAU,GAAK,CAAC,EAC9E6vC,EAAgBV,EAAKb,IACrBx8C,EAAOyyC,EAAyB4K,EAAMyB,IACxC/C,GAAcM,YAAY3Z,KAAKmU,GAA/BkF,CAAyCO,EAAWC,EAAUtK,EAAe,CAC3E8M,OAAQA,GACRC,SAAUA,GACV/F,QAASA,GACTqE,OAAQA,GACR2B,OAAQA,GACRC,WAAYA,GACZ1B,QAASA,GACT2B,YAAaA,GACbC,YAAaC,GACbrB,YAAaA,GACbsB,eAAgBzI,GAASx3B,OACzB0+B,cAAeA,EACfJ,SAAUA,GACVE,kBAAmBA,GACnBD,SAAUA,GACVE,kBAAmBA,GACnByB,mBAAoBC,GACpBC,qBAAsBC,GACtBC,eAAgB,WACdR,IAAc,CAChB,EACAS,cAAe,WACbT,IAAc,CAChB,EACAU,sBAAuB,SAA+Br3C,GACpDs3C,GAAe,CACbvD,SAAUA,EACV/zC,KAAMA,EACNu1C,cAAeA,GAEnB,GACC/9C,GACL,EACA,SAAS8/C,GAAe/tC,GACtBqrC,GAAcnL,EAAe,CAC3B+L,YAAaA,GACbR,QAASA,GACTD,SAAUwB,GACVzB,OAAQA,GACRK,SAAUA,GACVE,kBAAmBA,GACnBD,SAAUA,GACVE,kBAAmBA,IAClB/rC,GACL,CACA,IAAIgtC,GACFC,GACA/F,GACAqE,GACA2B,GACAC,GACA1B,GACA2B,GACAxB,GACAC,GACAC,GACAC,GACAiC,GACA/B,GAIAgC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAhB,GACAiB,GACAC,GAGAC,GAEAC,GAhBAC,IAAsB,EACtBC,IAAkB,EAClBC,GAAY,GAUZC,IAAwB,EACxBC,IAAyB,EAIzBC,GAAmC,GAGnCC,IAAU,EACVC,GAAoB,GAGlBC,GAAqC,oBAAbv4C,SAC1Bw4C,GAA0BhO,EAC1BiO,GAAmBpO,GAAQD,EAAa,WAAa,QAErDsO,GAAmBH,KAAmB9N,IAAqBD,GAAO,cAAexqC,SAASC,cAAc,OACxG04C,GAA0B,WACxB,GAAKJ,GAAL,CAEA,GAAInO,EACF,OAAO,EAET,IAAI37B,EAAKzO,SAASC,cAAc,KAEhC,OADAwO,EAAGhY,MAAMunB,QAAU,sBACe,SAA3BvP,EAAGhY,MAAMmiD,aAPW,CAQ7B,CAT0B,GAU1BC,GAAmB,SAA0BpqC,EAAIrX,GAC/C,IAAI0hD,EAAQlN,EAAIn9B,GACdsqC,EAAU55B,SAAS25B,EAAMxpC,OAAS6P,SAAS25B,EAAME,aAAe75B,SAAS25B,EAAMG,cAAgB95B,SAAS25B,EAAMI,iBAAmB/5B,SAAS25B,EAAMK,kBAChJC,EAAStL,EAASr/B,EAAI,EAAGrX,GACzBiiD,EAASvL,EAASr/B,EAAI,EAAGrX,GACzBkiD,EAAgBF,GAAUxN,EAAIwN,GAC9BG,EAAiBF,GAAUzN,EAAIyN,GAC/BG,EAAkBF,GAAiBn6B,SAASm6B,EAAcG,YAAct6B,SAASm6B,EAAcI,aAAe/M,EAAQyM,GAAQ9pC,MAC9HqqC,EAAmBJ,GAAkBp6B,SAASo6B,EAAeE,YAAct6B,SAASo6B,EAAeG,aAAe/M,EAAQ0M,GAAQ/pC,MACpI,GAAsB,SAAlBwpC,EAAMttC,QACR,MAA+B,WAAxBstC,EAAMc,eAAsD,mBAAxBd,EAAMc,cAAqC,WAAa,aAErG,GAAsB,SAAlBd,EAAMttC,QACR,OAAOstC,EAAMe,oBAAoBzpC,MAAM,KAAKxX,QAAU,EAAI,WAAa,aAEzE,GAAIwgD,GAAUE,EAAqB,OAAgC,SAA3BA,EAAqB,MAAc,CACzE,IAAIQ,EAAgD,SAA3BR,EAAqB,MAAe,OAAS,QACtE,OAAOD,GAAoC,SAAzBE,EAAe74C,OAAoB64C,EAAe74C,QAAUo5C,EAAmC,aAAb,UACtG,CACA,OAAOV,IAAqC,UAA1BE,EAAc9tC,SAAiD,SAA1B8tC,EAAc9tC,SAAgD,UAA1B8tC,EAAc9tC,SAAiD,SAA1B8tC,EAAc9tC,SAAsBguC,GAAmBT,GAAuC,SAA5BD,EAAML,KAAgCY,GAAsC,SAA5BP,EAAML,KAAgCe,EAAkBG,EAAmBZ,GAAW,WAAa,YACvV,EA8BAgB,GAAgB,SAAuB3iD,GACrC,SAAS4iD,EAAKz7C,EAAO07C,GACnB,OAAO,SAAUnE,EAAI70C,EAAMm1C,EAAQvC,GACjC,IAAIqG,EAAYpE,EAAG1+C,QAAQuP,MAAM9G,MAAQoB,EAAK7J,QAAQuP,MAAM9G,MAAQi2C,EAAG1+C,QAAQuP,MAAM9G,OAASoB,EAAK7J,QAAQuP,MAAM9G,KACjH,GAAa,MAATtB,IAAkB07C,GAAQC,GAG5B,OAAO,EACF,GAAa,MAAT37C,IAA2B,IAAVA,EAC1B,OAAO,EACF,GAAI07C,GAAkB,UAAV17C,EACjB,OAAOA,EACF,GAAqB,mBAAVA,EAChB,OAAOy7C,EAAKz7C,EAAMu3C,EAAI70C,EAAMm1C,EAAQvC,GAAMoG,EAAnCD,CAAyClE,EAAI70C,EAAMm1C,EAAQvC,GAElE,IAAIsG,GAAcF,EAAOnE,EAAK70C,GAAM7J,QAAQuP,MAAM9G,KAClD,OAAiB,IAAVtB,GAAmC,iBAAVA,GAAsBA,IAAU47C,GAAc57C,EAAMjB,MAAQiB,EAAM0S,QAAQkpC,IAAe,CAE7H,CACF,CACA,IAAIxzC,EAAQ,CAAC,EACTyzC,EAAgBhjD,EAAQuP,MACvByzC,GAA2C,UAA1BxoC,EAAQwoC,KAC5BA,EAAgB,CACdv6C,KAAMu6C,IAGVzzC,EAAM9G,KAAOu6C,EAAcv6C,KAC3B8G,EAAM0zC,UAAYL,EAAKI,EAAcH,MAAM,GAC3CtzC,EAAM2zC,SAAWN,EAAKI,EAAcG,KACpC5zC,EAAM6zC,YAAcJ,EAAcI,YAClCpjD,EAAQuP,MAAQA,CAClB,EACAkwC,GAAsB,YACf8B,IAA2BrI,IAC9B1E,EAAI0E,GAAS,UAAW,OAE5B,EACAyG,GAAwB,YACjB4B,IAA2BrI,IAC9B1E,EAAI0E,GAAS,UAAW,GAE5B,EAGEiI,KAAmB9N,GACrBzqC,SAAS6J,iBAAiB,SAAS,SAAUgqC,GAC3C,GAAImE,GAKF,OAJAnE,EAAIh0B,iBACJg0B,EAAI/zB,iBAAmB+zB,EAAI/zB,kBAC3B+zB,EAAI4G,0BAA4B5G,EAAI4G,2BACpCzC,IAAkB,GACX,CAEX,IAAG,GAEL,IAAI0C,GAAgC,SAAuC7G,GACzE,GAAIuC,GAAQ,CACVvC,EAAMA,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,EACrC,IAAI+G,GAzE6D99C,EAyEvB+2C,EAAIgH,QAzEsB99C,EAyEb82C,EAAIiH,QAvE3D7C,GAAU8C,MAAK,SAAUnH,GACvB,IAAIoH,EAAYpH,EAAS7C,IAAS35C,QAAQ6jD,qBAC1C,GAAKD,IAAa1M,EAAUsF,GAA5B,CACA,IAAIrD,EAAO5D,EAAQiH,GACjBsH,EAAqBp+C,GAAKyzC,EAAK1vC,KAAOm6C,GAAal+C,GAAKyzC,EAAKzvC,MAAQk6C,EACrEG,EAAmBp+C,GAAKwzC,EAAK5vC,IAAMq6C,GAAaj+C,GAAKwzC,EAAK3vC,OAASo6C,EACrE,OAAIE,GAAsBC,EACjBC,EAAMxH,OADf,CAJ6C,CAO/C,IACOwH,GA8DP,GAAIR,EAAS,CAEX,IAAIviC,EAAQ,CAAC,EACb,IAAK,IAAIzL,KAAKinC,EACRA,EAAI3xC,eAAe0K,KACrByL,EAAMzL,GAAKinC,EAAIjnC,IAGnByL,EAAM9d,OAAS8d,EAAMs8B,OAASiG,EAC9BviC,EAAMwH,oBAAiB,EACvBxH,EAAMyH,qBAAkB,EACxB86B,EAAQ7J,IAASsK,YAAYhjC,EAC/B,CACF,CAvF8B,IAAqCvb,EAAGC,EAChEq+C,CAuFR,EACIE,GAAwB,SAA+BzH,GACrDuC,IACFA,GAAO9U,WAAWyP,IAASwK,iBAAiB1H,EAAIt5C,OAEpD,EAOA,SAAS2zC,GAASz/B,EAAIrX,GACpB,IAAMqX,IAAMA,EAAGo0B,UAA4B,IAAhBp0B,EAAGo0B,SAC5B,KAAM,8CAA8C9a,OAAO,CAAC,EAAEid,SAASruC,KAAK8X,IAE9EjX,KAAKiX,GAAKA,EACVjX,KAAKJ,QAAUA,EAAUyyC,EAAS,CAAC,EAAGzyC,GAGtCqX,EAAGsiC,IAAWv5C,KACd,IAAI07C,EAAW,CACbvsC,MAAO,KACPmL,MAAM,EACNpH,UAAU,EACV8wC,MAAO,KACPC,OAAQ,KACRpN,UAAW,WAAWjjC,KAAKqD,EAAGnN,UAAY,MAAQ,KAClDo6C,cAAe,EAEfC,YAAY,EAEZC,sBAAuB,KAEvBC,mBAAmB,EACnB1U,UAAW,WACT,OAAO0R,GAAiBpqC,EAAIjX,KAAKJ,QACnC,EACA0kD,WAAY,iBACZC,YAAa,kBACbC,UAAW,gBACXzgB,OAAQ,SACRt0B,OAAQ,KACRg1C,iBAAiB,EACjB5K,UAAW,EACX2B,OAAQ,KACRkJ,QAAS,SAAiBC,EAAc/F,GACtC+F,EAAaD,QAAQ,OAAQ9F,EAAOgG,YACtC,EACAC,YAAY,EACZC,gBAAgB,EAChBC,WAAY,UACZC,MAAO,EACPC,kBAAkB,EAClBC,qBAAsB3X,OAAO5lB,SAAW4lB,OAAShsC,QAAQomB,SAASpmB,OAAO4jD,iBAAkB,KAAO,EAClGC,eAAe,EACfC,cAAe,oBACfC,gBAAgB,EAChBC,kBAAmB,EACnBC,eAAgB,CACdlgD,EAAG,EACHC,EAAG,GAELkgD,gBAA4C,IAA5B/O,GAAS+O,gBAA4B,iBAAkBlkD,SAAWwxC,EAClF0Q,qBAAsB,GAKxB,IAAK,IAAIp7C,KAHTuzC,GAAca,kBAAkBz8C,KAAMiX,EAAIykC,GAGzBA,IACbrzC,KAAQzI,KAAaA,EAAQyI,GAAQqzC,EAASrzC,IAKlD,IAAK,IAAIgrC,KAHTkP,GAAc3iD,GAGCI,KACQ,MAAjBqzC,EAAG9E,OAAO,IAAkC,mBAAbvuC,KAAKqzC,KACtCrzC,KAAKqzC,GAAMrzC,KAAKqzC,GAAI9Q,KAAKviC,OAK7BA,KAAK0lD,iBAAkB9lD,EAAQwlD,eAAwBlE,GACnDlhD,KAAK0lD,kBAEP1lD,KAAKJ,QAAQslD,oBAAsB,GAIjCtlD,EAAQ6lD,eACV13B,EAAG9W,EAAI,cAAejX,KAAK2lD,cAE3B53B,EAAG9W,EAAI,YAAajX,KAAK2lD,aACzB53B,EAAG9W,EAAI,aAAcjX,KAAK2lD,cAExB3lD,KAAK0lD,kBACP33B,EAAG9W,EAAI,WAAYjX,MACnB+tB,EAAG9W,EAAI,YAAajX,OAEtBygD,GAAU76C,KAAK5F,KAAKiX,IAGpBrX,EAAQokD,OAASpkD,EAAQokD,MAAMxtB,KAAOx2B,KAAKsa,KAAK1a,EAAQokD,MAAMxtB,IAAIx2B,OAAS,IAG3EqyC,EAASryC,KAAMy5C,KACjB,CAmhCA,SAASmM,GAAQrI,EAAQD,EAAMsB,EAAQiH,EAAUzI,EAAU0I,EAAYlI,EAAemI,GACpF,IAAI1J,EAGF2J,EAFA5J,EAAWmB,EAAOhE,IAClB0M,EAAW7J,EAASx8C,QAAQsmD,OAwB9B,OArBI3kD,OAAO08C,aAAgBrL,GAAeC,GAMxCwJ,EAAM7zC,SAAS01C,YAAY,UACvBC,UAAU,QAAQ,GAAM,GAN5B9B,EAAM,IAAI4B,YAAY,OAAQ,CAC5BG,SAAS,EACTC,YAAY,IAMhBhC,EAAIiC,GAAKhB,EACTjB,EAAI5yC,KAAO8zC,EACXlB,EAAIzF,QAAUgI,EACdvC,EAAI8J,YAAcN,EAClBxJ,EAAI+J,QAAUhJ,GAAYE,EAC1BjB,EAAIgK,YAAcP,GAAc3Q,EAAQmI,GACxCjB,EAAI0J,gBAAkBA,EACtB1J,EAAIuB,cAAgBA,EACpBL,EAAON,cAAcZ,GACjB4J,IACFD,EAASC,EAAS9mD,KAAKi9C,EAAUC,EAAKuB,IAEjCoI,CACT,CACA,SAASM,GAAkBrvC,GACzBA,EAAG4/B,WAAY,CACjB,CACA,SAAS0P,KACP1F,IAAU,CACZ,CA0EA,SAAS2F,GAAYvvC,GAInB,IAHA,IAAIuvB,EAAMvvB,EAAGT,QAAUS,EAAGvO,UAAYuO,EAAGhB,IAAMgB,EAAGwvC,KAAOxvC,EAAG2tC,YAC1DxvC,EAAIoxB,EAAIplC,OACRslD,EAAM,EACDtxC,KACLsxC,GAAOlgB,EAAImgB,WAAWvxC,GAExB,OAAOsxC,EAAIlZ,SAAS,GACtB,CAUA,SAASoZ,GAAUvT,GACjB,OAAO/wC,WAAW+wC,EAAI,EACxB,CACA,SAASwT,GAAgB3iD,GACvB,OAAOpB,aAAaoB,EACtB,CArpCAwyC,GAASvxC,UAA4C,CACnDC,YAAasxC,GACbqN,iBAAkB,SAA0BhhD,GACrC/C,KAAKiX,GAAG6vC,SAAS/jD,IAAWA,IAAW/C,KAAKiX,KAC/CkpC,GAAa,KAEjB,EACA4G,cAAe,SAAuB1K,EAAKt5C,GACzC,MAAyC,mBAA3B/C,KAAKJ,QAAQ+vC,UAA2B3vC,KAAKJ,QAAQ+vC,UAAUxwC,KAAKa,KAAMq8C,EAAKt5C,EAAQ67C,IAAU5+C,KAAKJ,QAAQ+vC,SAC9H,EACAgW,YAAa,SAA6CtJ,GACxD,GAAKA,EAAIgC,WAAT,CACA,IAAIh4C,EAAQrG,KACViX,EAAKjX,KAAKiX,GACVrX,EAAUI,KAAKJ,QACf6kD,EAAkB7kD,EAAQ6kD,gBAC1Bv4C,EAAOmwC,EAAInwC,KACX86C,EAAQ3K,EAAI8G,SAAW9G,EAAI8G,QAAQ,IAAM9G,EAAI4K,aAAmC,UAApB5K,EAAI4K,aAA2B5K,EAC3Ft5C,GAAUikD,GAAS3K,GAAKt5C,OACxBmkD,EAAiB7K,EAAIt5C,OAAOokD,aAAe9K,EAAI+K,MAAQ/K,EAAI+K,KAAK,IAAM/K,EAAIgL,cAAgBhL,EAAIgL,eAAe,KAAOtkD,EACpH0M,EAAS7P,EAAQ6P,OAInB,GA+mCJ,SAAgCs7B,GAC9B+V,GAAkB1/C,OAAS,EAC3B,IAAI2rB,EAASge,EAAKh3B,qBAAqB,SACnCyR,EAAMuH,EAAO3rB,OACjB,KAAOokB,KAAO,CACZ,IAAIvO,EAAK8V,EAAOvH,GAChBvO,EAAGpB,SAAWirC,GAAkBl7C,KAAKqR,EACvC,CACF,CA1nCIqwC,CAAuBrwC,IAGnB2nC,MAGA,wBAAwBhrC,KAAK1H,IAAwB,IAAfmwC,EAAI9nC,QAAgB3U,EAAQsT,YAKlEg0C,EAAeK,oBAKdvnD,KAAK0lD,kBAAmB3S,IAAUhwC,GAA2C,WAAjCA,EAAOyT,QAAQ7L,mBAGhE5H,EAAS+wC,EAAQ/wC,EAAQnD,EAAQi3C,UAAW5/B,GAAI,KAClClU,EAAOq2C,UAGjB2F,KAAeh8C,GAAnB,CAUA,GAJAy6C,GAAWv0C,EAAMlG,GACjB26C,GAAoBz0C,EAAMlG,EAAQnD,EAAQi3C,WAGpB,mBAAXpnC,GACT,GAAIA,EAAOtQ,KAAKa,KAAMq8C,EAAKt5C,EAAQ/C,MAajC,OAZA2/C,GAAe,CACbvD,SAAU/1C,EACV82C,OAAQ+J,EACR7+C,KAAM,SACN+0C,SAAUr6C,EACVu6C,KAAMrmC,EACNsmC,OAAQtmC,IAEVilC,GAAY,SAAU71C,EAAO,CAC3Bg2C,IAAKA,SAEPoI,GAAmBpI,EAAIgC,YAAchC,EAAIh0B,uBAGtC,GAAI5Y,IACTA,EAASA,EAAOmJ,MAAM,KAAK2qC,MAAK,SAAUiE,GAExC,GADAA,EAAW1T,EAAQoT,EAAgBM,EAASxlC,OAAQ/K,GAAI,GAatD,OAXA0oC,GAAe,CACbvD,SAAU/1C,EACV82C,OAAQqK,EACRn/C,KAAM,SACN+0C,SAAUr6C,EACVw6C,OAAQtmC,EACRqmC,KAAMrmC,IAERilC,GAAY,SAAU71C,EAAO,CAC3Bg2C,IAAKA,KAEA,CAEX,KAGE,YADAoI,GAAmBpI,EAAIgC,YAAchC,EAAIh0B,kBAIzCzoB,EAAQqkD,SAAWnQ,EAAQoT,EAAgBtnD,EAAQqkD,OAAQhtC,GAAI,IAKnEjX,KAAKynD,kBAAkBpL,EAAK2K,EAAOjkD,EAnDnC,CApC2B,CAwF7B,EACA0kD,kBAAmB,SAAwCpL,EAAiB2K,EAAyBjkD,GACnG,IAIE2kD,EAJErhD,EAAQrG,KACViX,EAAK5Q,EAAM4Q,GACXrX,EAAUyG,EAAMzG,QAChB+nD,EAAgB1wC,EAAG0wC,cAErB,GAAI5kD,IAAW67C,IAAU77C,EAAO+mC,aAAe7yB,EAAI,CACjD,IAAI4uC,EAAW1Q,EAAQpyC,GAoEvB,GAnEAo6C,GAASlmC,EAET4nC,IADAD,GAAS77C,GACS+mC,WAClBgV,GAASF,GAAOgJ,YAChB7I,GAAah8C,EACb68C,GAAchgD,EAAQuP,MACtBunC,GAASE,QAAUgI,GACnBiB,GAAS,CACP98C,OAAQ67C,GACRyE,SAAU2D,GAAS3K,GAAKgH,QACxBC,SAAU0D,GAAS3K,GAAKiH,SAE1BrD,GAAkBJ,GAAOwD,QAAUwC,EAASx8C,KAC5C62C,GAAiBL,GAAOyD,QAAUuC,EAAS18C,IAC3CnJ,KAAK6nD,QAAUb,GAAS3K,GAAKgH,QAC7BrjD,KAAK8nD,QAAUd,GAAS3K,GAAKiH,QAC7B1E,GAAO3/C,MAAM,eAAiB,MAC9ByoD,EAAc,WACZxL,GAAY,aAAc71C,EAAO,CAC/Bg2C,IAAKA,IAEH3F,GAAS4F,cACXj2C,EAAM0hD,WAKR1hD,EAAM2hD,6BACDlV,GAAWzsC,EAAMq/C,kBACpB9G,GAAO/H,WAAY,GAIrBxwC,EAAM4hD,kBAAkB5L,EAAK2K,GAG7BrH,GAAe,CACbvD,SAAU/1C,EACVgC,KAAM,SACNu1C,cAAevB,IAIjBnI,EAAY0K,GAAQh/C,EAAQ2kD,aAAa,GAC3C,EAGA3kD,EAAQmkC,OAAOnrB,MAAM,KAAKhP,SAAQ,SAAU49C,GAC1CxS,EAAK4J,GAAQ4I,EAASxlC,OAAQskC,GAChC,IACAv4B,EAAG45B,EAAe,WAAYzE,IAC9Bn1B,EAAG45B,EAAe,YAAazE,IAC/Bn1B,EAAG45B,EAAe,YAAazE,IAC/Bn1B,EAAG45B,EAAe,UAAWthD,EAAM0hD,SACnCh6B,EAAG45B,EAAe,WAAYthD,EAAM0hD,SACpCh6B,EAAG45B,EAAe,cAAethD,EAAM0hD,SAGnCjV,GAAW9yC,KAAK0lD,kBAClB1lD,KAAKJ,QAAQslD,oBAAsB,EACnCtG,GAAO/H,WAAY,GAErBqF,GAAY,aAAcl8C,KAAM,CAC9Bq8C,IAAKA,KAIHz8C,EAAQolD,OAAWplD,EAAQqlD,mBAAoB+B,GAAYhnD,KAAK0lD,kBAAqB7S,GAAQD,GAgB/F8U,QAhB6G,CAC7G,GAAIhR,GAAS4F,cAEX,YADAt8C,KAAK+nD,UAMPh6B,EAAG45B,EAAe,UAAWthD,EAAM6hD,qBACnCn6B,EAAG45B,EAAe,WAAYthD,EAAM6hD,qBACpCn6B,EAAG45B,EAAe,cAAethD,EAAM6hD,qBACvCn6B,EAAG45B,EAAe,YAAathD,EAAM8hD,8BACrCp6B,EAAG45B,EAAe,YAAathD,EAAM8hD,8BACrCvoD,EAAQ6lD,gBAAkB13B,EAAG45B,EAAe,cAAethD,EAAM8hD,8BACjE9hD,EAAM+hD,gBAAkB9lD,WAAWolD,EAAa9nD,EAAQolD,MAC1D,CAGF,CACF,EACAmD,6BAA8B,SAAsElmD,GAClG,IAAI+kD,EAAQ/kD,EAAEkhD,QAAUlhD,EAAEkhD,QAAQ,GAAKlhD,EACnCs1B,KAAK5kB,IAAI4kB,KAAK2X,IAAI8X,EAAM3D,QAAUrjD,KAAK6nD,QAAStwB,KAAK2X,IAAI8X,EAAM1D,QAAUtjD,KAAK8nD,UAAYvwB,KAAKyR,MAAMhpC,KAAKJ,QAAQslD,qBAAuBllD,KAAK0lD,iBAAmBnkD,OAAO4jD,kBAAoB,KAC9LnlD,KAAKkoD,qBAET,EACAA,oBAAqB,WACnBtJ,IAAU0H,GAAkB1H,IAC5B97C,aAAa9C,KAAKooD,iBAClBpoD,KAAKgoD,2BACP,EACAA,0BAA2B,WACzB,IAAIL,EAAgB3nD,KAAKiX,GAAG0wC,cAC5BrU,EAAIqU,EAAe,UAAW3nD,KAAKkoD,qBACnC5U,EAAIqU,EAAe,WAAY3nD,KAAKkoD,qBACpC5U,EAAIqU,EAAe,cAAe3nD,KAAKkoD,qBACvC5U,EAAIqU,EAAe,YAAa3nD,KAAKmoD,8BACrC7U,EAAIqU,EAAe,YAAa3nD,KAAKmoD,8BACrC7U,EAAIqU,EAAe,cAAe3nD,KAAKmoD,6BACzC,EACAF,kBAAmB,SAAwC5L,EAAiB2K,GAC1EA,EAAQA,GAA4B,SAAnB3K,EAAI4K,aAA0B5K,GAC1Cr8C,KAAK0lD,iBAAmBsB,EACvBhnD,KAAKJ,QAAQ6lD,eACf13B,EAAGvlB,SAAU,cAAexI,KAAKqoD,cAEjCt6B,EAAGvlB,SADMw+C,EACI,YAEA,YAFahnD,KAAKqoD,eAKjCt6B,EAAG6wB,GAAQ,UAAW5+C,MACtB+tB,EAAGovB,GAAQ,YAAan9C,KAAKsoD,eAE/B,IACM9/C,SAAS+/C,UAEX3B,IAAU,WACRp+C,SAAS+/C,UAAUC,OACrB,IAEAjnD,OAAOknD,eAAeC,iBAE1B,CAAE,MAAOC,GAAM,CACjB,EACAC,aAAc,SAAsBC,EAAUxM,GAE5C,GADAkE,IAAsB,EAClBpD,IAAUyB,GAAQ,CACpB1C,GAAY,cAAel8C,KAAM,CAC/Bq8C,IAAKA,IAEHr8C,KAAK0lD,iBACP33B,EAAGvlB,SAAU,WAAYs7C,IAE3B,IAAIlkD,EAAUI,KAAKJ,SAGlBipD,GAAY3U,EAAY0K,GAAQh/C,EAAQ4kD,WAAW,GACpDtQ,EAAY0K,GAAQh/C,EAAQ0kD,YAAY,GACxC5N,GAASx3B,OAASlf,KAClB6oD,GAAY7oD,KAAK8oD,eAGjBnJ,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,QACNu1C,cAAevB,GAEnB,MACEr8C,KAAK+oD,UAET,EACAC,iBAAkB,WAChB,GAAIlJ,GAAU,CACZ9/C,KAAK6nD,OAAS/H,GAASuD,QACvBrjD,KAAK8nD,OAAShI,GAASwD,QACvBjE,KAGA,IAFA,IAAIt8C,EAASyF,SAASygD,iBAAiBnJ,GAASuD,QAASvD,GAASwD,SAC9DpN,EAASnzC,EACNA,GAAUA,EAAOokD,aACtBpkD,EAASA,EAAOokD,WAAW8B,iBAAiBnJ,GAASuD,QAASvD,GAASwD,YACxDpN,GACfA,EAASnzC,EAGX,GADA67C,GAAO9U,WAAWyP,IAASwK,iBAAiBhhD,GACxCmzC,EACF,EAAG,CACD,GAAIA,EAAOqD,IAAU,CAQnB,GANWrD,EAAOqD,IAASsK,YAAY,CACrCR,QAASvD,GAASuD,QAClBC,QAASxD,GAASwD,QAClBvgD,OAAQA,EACRo6C,OAAQjH,MAEOl2C,KAAKJ,QAAQklD,eAC5B,KAEJ,CACA/hD,EAASmzC,CACX,OAC8BA,EAAStC,EAAgBsC,IAEzDqJ,IACF,CACF,EACA8I,aAAc,SAAsChM,GAClD,GAAIwD,GAAQ,CACV,IAAIjgD,EAAUI,KAAKJ,QACjB2lD,EAAoB3lD,EAAQ2lD,kBAC5BC,EAAiB5lD,EAAQ4lD,eACzBwB,EAAQ3K,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,EACvC6M,EAAcpQ,IAAWvE,EAAOuE,IAAS,GACzCjD,EAASiD,IAAWoQ,GAAeA,EAAY3uC,EAC/Cu7B,EAASgD,IAAWoQ,GAAeA,EAAYzZ,EAC/C0Z,EAAuBnI,IAA2BV,IAAuBrJ,EAAwBqJ,IACjG8I,GAAMpC,EAAM3D,QAAUxD,GAAOwD,QAAUmC,EAAelgD,IAAMuwC,GAAU,IAAMsT,EAAuBA,EAAqB,GAAKvI,GAAiC,GAAK,IAAM/K,GAAU,GACnLwT,GAAMrC,EAAM1D,QAAUzD,GAAOyD,QAAUkC,EAAejgD,IAAMuwC,GAAU,IAAMqT,EAAuBA,EAAqB,GAAKvI,GAAiC,GAAK,IAAM9K,GAAU,GAGrL,IAAKY,GAASx3B,SAAWqhC,GAAqB,CAC5C,GAAIgF,GAAqBhuB,KAAK5kB,IAAI4kB,KAAK2X,IAAI8X,EAAM3D,QAAUrjD,KAAK6nD,QAAStwB,KAAK2X,IAAI8X,EAAM1D,QAAUtjD,KAAK8nD,SAAWvC,EAChH,OAEFvlD,KAAKsoD,aAAajM,GAAK,EACzB,CACA,GAAIvD,GAAS,CACPoQ,GACFA,EAAYjnD,GAAKmnD,GAAMrJ,IAAU,GACjCmJ,EAAY5uB,GAAK+uB,GAAMrJ,IAAU,IAEjCkJ,EAAc,CACZ3uC,EAAG,EACHC,EAAG,EACH2c,EAAG,EACHsY,EAAG,EACHxtC,EAAGmnD,EACH9uB,EAAG+uB,GAGP,IAAIC,EAAY,UAAU/4B,OAAO24B,EAAY3uC,EAAG,KAAKgW,OAAO24B,EAAY1uC,EAAG,KAAK+V,OAAO24B,EAAY/xB,EAAG,KAAK5G,OAAO24B,EAAYzZ,EAAG,KAAKlf,OAAO24B,EAAYjnD,EAAG,KAAKsuB,OAAO24B,EAAY5uB,EAAG,KACvL8Z,EAAI0E,GAAS,kBAAmBwQ,GAChClV,EAAI0E,GAAS,eAAgBwQ,GAC7BlV,EAAI0E,GAAS,cAAewQ,GAC5BlV,EAAI0E,GAAS,YAAawQ,GAC1BvJ,GAASqJ,EACTpJ,GAASqJ,EACTvJ,GAAWkH,CACb,CACA3K,EAAIgC,YAAchC,EAAIh0B,gBACxB,CACF,EACAygC,aAAc,WAGZ,IAAKhQ,GAAS,CACZ,IAAInxC,EAAY3H,KAAKJ,QAAQ0lD,eAAiB98C,SAAS7G,KAAOw7C,GAC5DpE,EAAO5D,EAAQyJ,IAAQ,EAAMoC,IAAyB,EAAMr5C,GAC5D/H,EAAUI,KAAKJ,QAGjB,GAAIohD,GAAyB,CAG3B,IADAV,GAAsB34C,EAC0B,WAAzCysC,EAAIkM,GAAqB,aAAsE,SAA1ClM,EAAIkM,GAAqB,cAA2BA,KAAwB93C,UACtI83C,GAAsBA,GAAoBxW,WAExCwW,KAAwB93C,SAAS7G,MAAQ2+C,KAAwB93C,SAASsL,iBACxEwsC,KAAwB93C,WAAU83C,GAAsBrL,KAC5D8D,EAAK5vC,KAAOm3C,GAAoBhJ,UAChCyB,EAAK1vC,MAAQi3C,GAAoBjJ,YAEjCiJ,GAAsBrL,IAExB2L,GAAmC3J,EAAwBqJ,GAC7D,CAEApM,EADA4E,GAAU8F,GAAOhG,WAAU,GACNh5C,EAAQ0kD,YAAY,GACzCpQ,EAAY4E,GAASl5C,EAAQylD,eAAe,GAC5CnR,EAAY4E,GAASl5C,EAAQ4kD,WAAW,GACxCpQ,EAAI0E,GAAS,aAAc,IAC3B1E,EAAI0E,GAAS,YAAa,IAC1B1E,EAAI0E,GAAS,aAAc,cAC3B1E,EAAI0E,GAAS,SAAU,GACvB1E,EAAI0E,GAAS,MAAOC,EAAK5vC,KACzBirC,EAAI0E,GAAS,OAAQC,EAAK1vC,MAC1B+qC,EAAI0E,GAAS,QAASC,EAAKjhC,OAC3Bs8B,EAAI0E,GAAS,SAAUC,EAAKhwC,QAC5BqrC,EAAI0E,GAAS,UAAW,OACxB1E,EAAI0E,GAAS,WAAYkI,GAA0B,WAAa,SAChE5M,EAAI0E,GAAS,SAAU,UACvB1E,EAAI0E,GAAS,gBAAiB,QAC9BpC,GAASC,MAAQmC,GACjBnxC,EAAUQ,YAAY2wC,IAGtB1E,EAAI0E,GAAS,mBAAoBmH,GAAkBt4B,SAASmxB,GAAQ75C,MAAM6Y,OAAS,IAAM,KAAOooC,GAAiBv4B,SAASmxB,GAAQ75C,MAAM8J,QAAU,IAAM,IAC1J,CACF,EACAu/C,aAAc,SAAiCjM,EAAiBwM,GAC9D,IAAIxiD,EAAQrG,KACR2kD,EAAetI,EAAIsI,aACnB/kD,EAAUyG,EAAMzG,QACpBs8C,GAAY,YAAal8C,KAAM,CAC7Bq8C,IAAKA,IAEH3F,GAAS4F,cACXt8C,KAAK+nD,WAGP7L,GAAY,aAAcl8C,MACrB02C,GAAS4F,iBACZe,GAAU3gC,GAAMkiC,KACR2K,gBAAgB,MACxBlM,GAAQxG,WAAY,EACpBwG,GAAQp+C,MAAM,eAAiB,GAC/Be,KAAKwpD,aACLtV,EAAYmJ,GAASr9C,KAAKJ,QAAQ2kD,aAAa,GAC/C7N,GAASh6B,MAAQ2gC,IAInBh3C,EAAMojD,QAAU7C,IAAU,WACxB1K,GAAY,QAAS71C,GACjBqwC,GAAS4F,gBACRj2C,EAAMzG,QAAQykD,mBACjBlH,GAAOuM,aAAarM,GAASuB,IAE/Bv4C,EAAMmjD,aACN7J,GAAe,CACbvD,SAAU/1C,EACVgC,KAAM,UAEV,KACCwgD,GAAY3U,EAAY0K,GAAQh/C,EAAQ4kD,WAAW,GAGhDqE,GACFrI,IAAkB,EAClBn6C,EAAMsjD,QAAUC,YAAYvjD,EAAM2iD,iBAAkB,MAGpD1V,EAAI9qC,SAAU,UAAWnC,EAAM0hD,SAC/BzU,EAAI9qC,SAAU,WAAYnC,EAAM0hD,SAChCzU,EAAI9qC,SAAU,cAAenC,EAAM0hD,SAC/BpD,IACFA,EAAakF,cAAgB,OAC7BjqD,EAAQ8kD,SAAW9kD,EAAQ8kD,QAAQvlD,KAAKkH,EAAOs+C,EAAc/F,KAE/D7wB,EAAGvlB,SAAU,OAAQnC,GAGrB+tC,EAAIwK,GAAQ,YAAa,kBAE3B2B,IAAsB,EACtBl6C,EAAMyjD,aAAelD,GAAUvgD,EAAMuiD,aAAarmB,KAAKl8B,EAAOwiD,EAAUxM,IACxEtuB,EAAGvlB,SAAU,cAAenC,GAC5B64C,IAAQ,EACJnM,GACFqB,EAAI5rC,SAAS7G,KAAM,cAAe,QAEtC,EAEAkiD,YAAa,SAAgCxH,GAC3C,IAEEwJ,EACAC,EACAiE,EAOAC,EAXE/yC,EAAKjX,KAAKiX,GACZlU,EAASs5C,EAAIt5C,OAIbnD,EAAUI,KAAKJ,QACfuP,EAAQvP,EAAQuP,MAChBgwC,EAAiBzI,GAASx3B,OAC1B+qC,EAAUrK,KAAgBzwC,EAC1B+6C,EAAUtqD,EAAQ0a,KAClB6vC,EAAetM,IAAesB,EAE9B94C,EAAQrG,KACRoqD,GAAiB,EACnB,IAAIvJ,GAAJ,CAoGA,QAL2B,IAAvBxE,EAAIh0B,gBACNg0B,EAAIgC,YAAchC,EAAIh0B,iBAExBtlB,EAAS+wC,EAAQ/wC,EAAQnD,EAAQi3C,UAAW5/B,GAAI,GAChDozC,EAAc,YACV3T,GAAS4F,cAAe,OAAO8N,EACnC,GAAIxL,GAAOkI,SAASzK,EAAIt5C,SAAWA,EAAOq2C,UAAYr2C,EAAOq4C,YAAcr4C,EAAOs4C,YAAch1C,EAAMikD,wBAA0BvnD,EAC9H,OAAOwnD,GAAU,GAGnB,GADA/J,IAAkB,EACdrB,IAAmBv/C,EAAQsT,WAAa+2C,EAAUC,IAAYH,EAASlL,KAAa1B,IACtFU,KAAgB79C,OAASA,KAAKy+C,YAAcmB,GAAYiD,UAAU7iD,KAAMm/C,EAAgBP,GAAQvC,KAASltC,EAAM2zC,SAAS9iD,KAAMm/C,EAAgBP,GAAQvC,IAAO,CAI7J,GAHA2N,EAA+C,aAApChqD,KAAK+mD,cAAc1K,EAAKt5C,GACnC8iD,EAAW1Q,EAAQyJ,IACnByL,EAAc,iBACV3T,GAAS4F,cAAe,OAAO8N,EACnC,GAAIL,EAYF,OAXAlL,GAAW1B,GACXhK,IACAnzC,KAAKwpD,aACLa,EAAc,UACT3T,GAAS4F,gBACRwC,GACF3B,GAAOuM,aAAa9K,GAAQE,IAE5B3B,GAAOh1C,YAAYy2C,KAGhB2L,GAAU,GAEnB,IAAIC,EAAc1T,EAAU7/B,EAAIrX,EAAQi3C,WACxC,IAAK2T,GAoeX,SAAsBnO,EAAK2N,EAAU5N,GACnC,IAAIqO,EAAatV,EAAQ2B,EAAUsF,EAASnlC,GAAImlC,EAASx8C,QAAQi3C,YAC7D6T,EAAsB7R,GAAkCuD,EAASnlC,GAAImlC,EAASx8C,QAASk5C,IACvF6R,EAAS,GACb,OAAOX,EAAW3N,EAAIgH,QAAUqH,EAAoBphD,MAAQqhD,GAAUtO,EAAIiH,QAAUmH,EAAWrhD,QAAUizC,EAAIgH,QAAUoH,EAAWphD,KAAOgzC,EAAIiH,QAAUoH,EAAoBthD,OAASuhD,GAAUtO,EAAIgH,QAAUoH,EAAWnhD,OAAS+yC,EAAIiH,QAAUmH,EAAWthD,GAC3P,CAze0ByhD,CAAavO,EAAK2N,EAAUhqD,QAAUwqD,EAAYpR,SAAU,CAI9E,GAAIoR,IAAgB5L,GAClB,OAAO2L,GAAU,GAUnB,GANIC,GAAevzC,IAAOolC,EAAIt5C,SAC5BA,EAASynD,GAEPznD,IACF+iD,EAAa3Q,EAAQpyC,KAE0D,IAA7E6iD,GAAQzI,GAAQlmC,EAAI2nC,GAAQiH,EAAU9iD,EAAQ+iD,EAAYzJ,IAAOt5C,GAWnE,OAVAowC,IACIqX,GAAeA,EAAY5C,YAE7B3wC,EAAGyyC,aAAa9K,GAAQ4L,EAAY5C,aAEpC3wC,EAAG9O,YAAYy2C,IAEjBC,GAAW5nC,EAEX4zC,IACON,GAAU,EAErB,MAAO,GAAIC,GAkcjB,SAAuBnO,EAAK2N,EAAU5N,GACpC,IAAI0O,EAAc3V,EAAQmB,EAAS8F,EAASnlC,GAAI,EAAGmlC,EAASx8C,SAAS,IACjE8qD,EAAsB7R,GAAkCuD,EAASnlC,GAAImlC,EAASx8C,QAASk5C,IACvF6R,EAAS,GACb,OAAOX,EAAW3N,EAAIgH,QAAUqH,EAAoBrhD,KAAOshD,GAAUtO,EAAIiH,QAAUwH,EAAY3hD,KAAOkzC,EAAIgH,QAAUyH,EAAYxhD,MAAQ+yC,EAAIiH,QAAUoH,EAAoBvhD,IAAMwhD,GAAUtO,EAAIiH,QAAUwH,EAAY1hD,QAAUizC,EAAIgH,QAAUyH,EAAYzhD,IAC1P,CAvcgC0hD,CAAc1O,EAAK2N,EAAUhqD,MAAO,CAE5D,IAAIkvB,EAAaonB,EAASr/B,EAAI,EAAGrX,GAAS,GAC1C,GAAIsvB,IAAe0vB,GACjB,OAAO2L,GAAU,GAInB,GADAzE,EAAa3Q,EADbpyC,EAASmsB,IAEqE,IAA1E02B,GAAQzI,GAAQlmC,EAAI2nC,GAAQiH,EAAU9iD,EAAQ+iD,EAAYzJ,GAAK,GAMjE,OALAlJ,IACAl8B,EAAGyyC,aAAa9K,GAAQ1vB,GACxB2vB,GAAW5nC,EAEX4zC,IACON,GAAU,EAErB,MAAO,GAAIxnD,EAAO+mC,aAAe7yB,EAAI,CACnC6uC,EAAa3Q,EAAQpyC,GACrB,IAAI4sC,EACFqb,EAYEC,EAXFC,EAAiBtM,GAAO9U,aAAe7yB,EACvCk0C,GA11Ba,SAA4BtF,EAAUC,EAAYkE,GACrE,IAAIoB,EAAcpB,EAAWnE,EAASx8C,KAAOw8C,EAAS18C,IACpDkiD,EAAcrB,EAAWnE,EAASv8C,MAAQu8C,EAASz8C,OACnDkiD,EAAkBtB,EAAWnE,EAAS/tC,MAAQ+tC,EAAS98C,OACvDwiD,EAAcvB,EAAWlE,EAAWz8C,KAAOy8C,EAAW38C,IACtDqiD,EAAcxB,EAAWlE,EAAWx8C,MAAQw8C,EAAW18C,OACvDqiD,EAAkBzB,EAAWlE,EAAWhuC,MAAQguC,EAAW/8C,OAC7D,OAAOqiD,IAAgBG,GAAeF,IAAgBG,GAAeJ,EAAcE,EAAkB,IAAMC,EAAcE,EAAkB,CAC7I,CAk1B2BC,CAAmB9M,GAAOxF,UAAYwF,GAAOpE,QAAUqL,EAAU9iD,EAAOq2C,UAAYr2C,EAAOy3C,QAAUsL,EAAYkE,GACpI2B,EAAQ3B,EAAW,MAAQ,OAC3B4B,EAAkB7V,EAAehzC,EAAQ,MAAO,QAAUgzC,EAAe6I,GAAQ,MAAO,OACxFiN,EAAeD,EAAkBA,EAAgBtU,eAAY,EAQ/D,GAPI6I,KAAep9C,IACjBioD,EAAwBlF,EAAW6F,GACnCjL,IAAwB,EACxBC,IAA0BwK,GAAmBvrD,EAAQukD,YAAc+G,GAErEvb,EAgbR,SAA2B0M,EAAKt5C,EAAQ+iD,EAAYkE,EAAU9F,EAAeE,EAAuBD,EAAY2H,GAC9G,IAAIC,EAAc/B,EAAW3N,EAAIiH,QAAUjH,EAAIgH,QAC7C2I,EAAehC,EAAWlE,EAAW/8C,OAAS+8C,EAAWhuC,MACzDm0C,EAAWjC,EAAWlE,EAAW38C,IAAM28C,EAAWz8C,KAClD6iD,EAAWlC,EAAWlE,EAAW18C,OAAS08C,EAAWx8C,MACrD6iD,GAAS,EACX,IAAKhI,EAEH,GAAI2H,GAAgBzL,GAAqB2L,EAAe9H,GAOtD,IAJKxD,KAA4C,IAAlBN,GAAsB2L,EAAcE,EAAWD,EAAe5H,EAAwB,EAAI2H,EAAcG,EAAWF,EAAe5H,EAAwB,KAEvL1D,IAAwB,GAErBA,GAOHyL,GAAS,OALT,GAAsB,IAAlB/L,GAAsB2L,EAAcE,EAAW5L,GACjD0L,EAAcG,EAAW7L,GACzB,OAAQD,QAOZ,GAAI2L,EAAcE,EAAWD,GAAgB,EAAI9H,GAAiB,GAAK6H,EAAcG,EAAWF,GAAgB,EAAI9H,GAAiB,EACnI,OAoBR,SAA6BnhD,GAC3B,OAAIkG,EAAM21C,IAAU31C,EAAMlG,GACjB,GAEC,CAEZ,CA1BeqpD,CAAoBrpD,GAKjC,IADAopD,EAASA,GAAUhI,KAGb4H,EAAcE,EAAWD,EAAe5H,EAAwB,GAAK2H,EAAcG,EAAWF,EAAe5H,EAAwB,GACvI,OAAO2H,EAAcE,EAAWD,EAAe,EAAI,GAAK,EAG5D,OAAO,CACT,CAvdoBK,CAAkBhQ,EAAKt5C,EAAQ+iD,EAAYkE,EAAUmB,EAAkB,EAAIvrD,EAAQskD,cAAgD,MAAjCtkD,EAAQwkD,sBAAgCxkD,EAAQskD,cAAgBtkD,EAAQwkD,sBAAuBzD,GAAwBR,KAAep9C,GAElO,IAAd4sC,EAAiB,CAEnB,IAAI2c,EAAYrjD,EAAM21C,IACtB,GACE0N,GAAa3c,EACbsb,EAAUpM,GAAS52C,SAASqkD,SACrBrB,IAAwC,SAA5B7W,EAAI6W,EAAS,YAAyBA,IAAYnS,IACzE,CAEA,GAAkB,IAAdnJ,GAAmBsb,IAAYloD,EACjC,OAAOwnD,GAAU,GAEnBpK,GAAap9C,EACbq9C,GAAgBzQ,EAChB,IAAIiY,EAAc7kD,EAAOwpD,mBACvBC,GAAQ,EAENC,EAAa7G,GAAQzI,GAAQlmC,EAAI2nC,GAAQiH,EAAU9iD,EAAQ+iD,EAAYzJ,EAD3EmQ,EAAsB,IAAd7c,GAER,IAAmB,IAAf8c,EAwBF,OAvBmB,IAAfA,IAAoC,IAAhBA,IACtBD,EAAuB,IAAfC,GAEV5L,IAAU,EACVv+C,WAAWikD,GAAW,IACtBpT,IACIqZ,IAAU5E,EACZ3wC,EAAG9O,YAAYy2C,IAEf77C,EAAO+mC,WAAW4f,aAAa9K,GAAQ4N,EAAQ5E,EAAc7kD,GAI3D6oD,GACFtT,GAASsT,EAAiB,EAAGC,EAAeD,EAAgBtU,WAE9DuH,GAAWD,GAAO9U,gBAGY3pB,IAA1B6qC,GAAwCrK,KAC1CN,GAAqB9oB,KAAK2X,IAAI8b,EAAwB7V,EAAQpyC,GAAQ4oD,KAExEd,IACON,GAAU,EAErB,CACA,GAAItzC,EAAG6vC,SAASlI,IACd,OAAO2L,GAAU,EAErB,CACA,OAAO,CA3OY,CACnB,SAASF,EAAchiD,EAAMqkD,GAC3BxQ,GAAY7zC,EAAMhC,EAAOyrC,EAAe,CACtCuK,IAAKA,EACL4N,QAASA,EACT0C,KAAM3C,EAAW,WAAa,aAC9BD,OAAQA,EACRlE,SAAUA,EACVC,WAAYA,EACZoE,QAASA,EACTC,aAAcA,EACdpnD,OAAQA,EACRwnD,UAAWA,EACXrE,OAAQ,SAAgBnjD,EAAQypD,GAC9B,OAAO5G,GAAQzI,GAAQlmC,EAAI2nC,GAAQiH,EAAU9iD,EAAQoyC,EAAQpyC,GAASs5C,EAAKmQ,EAC7E,EACA3B,QAASA,GACR6B,GACL,CAGA,SAASvZ,IACPkX,EAAc,4BACdhkD,EAAMuzC,wBACFvzC,IAAU8jD,GACZA,EAAavQ,uBAEjB,CAGA,SAAS2Q,EAAUqC,GAiDjB,OAhDAvC,EAAc,oBAAqB,CACjCuC,UAAWA,IAETA,IAEE3C,EACF9K,EAAeqK,aAEfrK,EAAe0N,WAAWxmD,GAExBA,IAAU8jD,IAEZjW,EAAY0K,GAAQf,GAAcA,GAAYj+C,QAAQ0kD,WAAanF,EAAev/C,QAAQ0kD,YAAY,GACtGpQ,EAAY0K,GAAQh/C,EAAQ0kD,YAAY,IAEtCzG,KAAgBx3C,GAASA,IAAUqwC,GAASx3B,OAC9C2+B,GAAcx3C,EACLA,IAAUqwC,GAASx3B,QAAU2+B,KACtCA,GAAc,MAIZsM,IAAiB9jD,IACnBA,EAAMikD,sBAAwBvnD,GAEhCsD,EAAMg0C,YAAW,WACfgQ,EAAc,6BACdhkD,EAAMikD,sBAAwB,IAChC,IACIjkD,IAAU8jD,IACZA,EAAa9P,aACb8P,EAAaG,sBAAwB,QAKrCvnD,IAAW67C,KAAWA,GAAOxF,UAAYr2C,IAAWkU,IAAOlU,EAAOq2C,YACpE+G,GAAa,MAIVvgD,EAAQklD,gBAAmBzI,EAAIc,QAAUp6C,IAAWyF,WACvDo2C,GAAO9U,WAAWyP,IAASwK,iBAAiB1H,EAAIt5C,SAG/C6pD,GAAa1J,GAA8B7G,KAE7Cz8C,EAAQklD,gBAAkBzI,EAAI/zB,iBAAmB+zB,EAAI/zB,kBAC/C8hC,GAAiB,CAC1B,CAGA,SAASS,IACPpN,GAAWx0C,EAAM21C,IACjBjB,GAAoB10C,EAAM21C,GAAQh/C,EAAQi3C,WAC1C8I,GAAe,CACbvD,SAAU/1C,EACVgC,KAAM,SACNi1C,KAAMrmC,EACNwmC,SAAUA,GACVE,kBAAmBA,GACnBC,cAAevB,GAEnB,CA8IF,EACAiO,sBAAuB,KACvBwC,eAAgB,WACdxZ,EAAI9qC,SAAU,YAAaxI,KAAKqoD,cAChC/U,EAAI9qC,SAAU,YAAaxI,KAAKqoD,cAChC/U,EAAI9qC,SAAU,cAAexI,KAAKqoD,cAClC/U,EAAI9qC,SAAU,WAAY06C,IAC1B5P,EAAI9qC,SAAU,YAAa06C,IAC3B5P,EAAI9qC,SAAU,YAAa06C,GAC7B,EACA6J,aAAc,WACZ,IAAIpF,EAAgB3nD,KAAKiX,GAAG0wC,cAC5BrU,EAAIqU,EAAe,UAAW3nD,KAAK+nD,SACnCzU,EAAIqU,EAAe,WAAY3nD,KAAK+nD,SACpCzU,EAAIqU,EAAe,YAAa3nD,KAAK+nD,SACrCzU,EAAIqU,EAAe,cAAe3nD,KAAK+nD,SACvCzU,EAAI9qC,SAAU,cAAexI,KAC/B,EACA+nD,QAAS,SAA4B1L,GACnC,IAAIplC,EAAKjX,KAAKiX,GACZrX,EAAUI,KAAKJ,QAGjB69C,GAAWx0C,EAAM21C,IACjBjB,GAAoB10C,EAAM21C,GAAQh/C,EAAQi3C,WAC1CqF,GAAY,OAAQl8C,KAAM,CACxBq8C,IAAKA,IAEPwC,GAAWD,IAAUA,GAAO9U,WAG5B2T,GAAWx0C,EAAM21C,IACjBjB,GAAoB10C,EAAM21C,GAAQh/C,EAAQi3C,WACtCH,GAAS4F,gBAIbiE,IAAsB,EACtBI,IAAyB,EACzBD,IAAwB,EACxBsM,cAAchtD,KAAK2pD,SACnB7mD,aAAa9C,KAAKooD,iBAClBvB,GAAgB7mD,KAAKypD,SACrB5C,GAAgB7mD,KAAK8pD,cAGjB9pD,KAAK0lD,kBACPpS,EAAI9qC,SAAU,OAAQxI,MACtBszC,EAAIr8B,EAAI,YAAajX,KAAKsoD,eAE5BtoD,KAAK8sD,iBACL9sD,KAAK+sD,eACDha,GACFqB,EAAI5rC,SAAS7G,KAAM,cAAe,IAEpCyyC,EAAIwK,GAAQ,YAAa,IACrBvC,IACE6C,KACF7C,EAAIgC,YAAchC,EAAIh0B,kBACrBzoB,EAAQilD,YAAcxI,EAAI/zB,mBAE7BwwB,IAAWA,GAAQhP,YAAcgP,GAAQhP,WAAW3a,YAAY2pB,KAC5DqE,KAAW0B,IAAYhB,IAA2C,UAA5BA,GAAYY,cAEpDpB,IAAWA,GAAQvT,YAAcuT,GAAQvT,WAAW3a,YAAYkuB,IAE9DuB,KACE5+C,KAAK0lD,iBACPpS,EAAIsL,GAAQ,UAAW5+C,MAEzBsmD,GAAkB1H,IAClBA,GAAO3/C,MAAM,eAAiB,GAI1BigD,KAAUqB,IACZrM,EAAY0K,GAAQf,GAAcA,GAAYj+C,QAAQ0kD,WAAatkD,KAAKJ,QAAQ0kD,YAAY,GAE9FpQ,EAAY0K,GAAQ5+C,KAAKJ,QAAQ2kD,aAAa,GAG9C5E,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,WACNi1C,KAAMuB,GACNpB,SAAU,KACVE,kBAAmB,KACnBC,cAAevB,IAEbc,KAAW0B,IACTpB,IAAY,IAEdkC,GAAe,CACbxC,OAAQ0B,GACRx2C,KAAM,MACNi1C,KAAMuB,GACNtB,OAAQJ,GACRS,cAAevB,IAIjBsD,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,SACNi1C,KAAMuB,GACNjB,cAAevB,IAIjBsD,GAAe,CACbxC,OAAQ0B,GACRx2C,KAAM,OACNi1C,KAAMuB,GACNtB,OAAQJ,GACRS,cAAevB,IAEjBsD,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,OACNi1C,KAAMuB,GACNjB,cAAevB,KAGnBwB,IAAeA,GAAYoP,QAEvBxP,KAAaD,IACXC,IAAY,IAEdkC,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,SACNi1C,KAAMuB,GACNjB,cAAevB,IAEjBsD,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,OACNi1C,KAAMuB,GACNjB,cAAevB,KAKnB3F,GAASx3B,SAEK,MAAZu+B,KAAkC,IAAdA,KACtBA,GAAWD,GACXG,GAAoBD,IAEtBiC,GAAe,CACbvD,SAAUp8C,KACVqI,KAAM,MACNi1C,KAAMuB,GACNjB,cAAevB,IAIjBr8C,KAAKitD,WA3HTjtD,KAAK+oD,UAgIT,EACAA,SAAU,WACR7M,GAAY,UAAWl8C,MACvBm9C,GAASyB,GAASC,GAAW/F,GAAUgG,GAASzB,GAAU0B,GAAaC,GAAca,GAASC,GAAWZ,GAAQzB,GAAWE,GAAoBH,GAAWE,GAAoByC,GAAaC,GAAgBvC,GAAc+B,GAAclJ,GAASE,QAAUF,GAASC,MAAQD,GAASh6B,MAAQg6B,GAASx3B,OAAS,KAC/S4hC,GAAkBl3C,SAAQ,SAAUqN,GAClCA,EAAGpB,SAAU,CACf,IACAirC,GAAkB1/C,OAAS2+C,GAASC,GAAS,CAC/C,EACAkN,YAAa,SAAgC7Q,GAC3C,OAAQA,EAAInwC,MACV,IAAK,OACL,IAAK,UACHlM,KAAK+nD,QAAQ1L,GACb,MACF,IAAK,YACL,IAAK,WACCuC,KACF5+C,KAAK6jD,YAAYxH,GAmJ3B,SAAoCA,GAC9BA,EAAIsI,eACNtI,EAAIsI,aAAawI,WAAa,QAEhC9Q,EAAIgC,YAAchC,EAAIh0B,gBACxB,CAvJU+kC,CAAgB/Q,IAElB,MACF,IAAK,cACHA,EAAIh0B,iBAGV,EAKAglC,QAAS,WAOP,IANA,IACEp2C,EADEoK,EAAQ,GAEVpZ,EAAWjI,KAAKiX,GAAGhP,SACnBmN,EAAI,EACJuU,EAAI1hB,EAAS7G,OACbxB,EAAUI,KAAKJ,QACVwV,EAAIuU,EAAGvU,IAER0+B,EADJ78B,EAAKhP,EAASmN,GACExV,EAAQi3C,UAAW72C,KAAKiX,IAAI,IAC1CoK,EAAMzb,KAAKqR,EAAGi1B,aAAatsC,EAAQmlD,aAAeyB,GAAYvvC,IAGlE,OAAOoK,CACT,EAKA/G,KAAM,SAAc+G,EAAOisC,GACzB,IAAIC,EAAQ,CAAC,EACXpQ,EAASn9C,KAAKiX,GAChBjX,KAAKqtD,UAAUzjD,SAAQ,SAAU1F,EAAIkR,GACnC,IAAI6B,EAAKkmC,EAAOl1C,SAASmN,GACrB0+B,EAAQ78B,EAAIjX,KAAKJ,QAAQi3C,UAAWsG,GAAQ,KAC9CoQ,EAAMrpD,GAAM+S,EAEhB,GAAGjX,MACHstD,GAAgBttD,KAAK45C,wBACrBv4B,EAAMzX,SAAQ,SAAU1F,GAClBqpD,EAAMrpD,KACRi5C,EAAOhuB,YAAYo+B,EAAMrpD,IACzBi5C,EAAOh1C,YAAYolD,EAAMrpD,IAE7B,IACAopD,GAAgBttD,KAAKq6C,YACvB,EAIA4S,KAAM,WACJ,IAAIjJ,EAAQhkD,KAAKJ,QAAQokD,MACzBA,GAASA,EAAM78C,KAAO68C,EAAM78C,IAAInH,KAClC,EAOA8zC,QAAS,SAAmB78B,EAAIu8B,GAC9B,OAAOM,EAAQ78B,EAAIu8B,GAAYxzC,KAAKJ,QAAQi3C,UAAW72C,KAAKiX,IAAI,EAClE,EAOA8kC,OAAQ,SAAgB1zC,EAAMtB,GAC5B,IAAInH,EAAUI,KAAKJ,QACnB,QAAc,IAAVmH,EACF,OAAOnH,EAAQyI,GAEf,IAAI00C,EAAgBnB,GAAcgB,aAAa58C,KAAMqI,EAAMtB,GAEzDnH,EAAQyI,QADmB,IAAlB00C,EACOA,EAEAh2C,EAEL,UAATsB,GACFk6C,GAAc3iD,EAGpB,EAIA4tD,QAAS,WACPtR,GAAY,UAAWl8C,MACvB,IAAIiX,EAAKjX,KAAKiX,GACdA,EAAGsiC,IAAW,KACdjG,EAAIr8B,EAAI,YAAajX,KAAK2lD,aAC1BrS,EAAIr8B,EAAI,aAAcjX,KAAK2lD,aAC3BrS,EAAIr8B,EAAI,cAAejX,KAAK2lD,aACxB3lD,KAAK0lD,kBACPpS,EAAIr8B,EAAI,WAAYjX,MACpBszC,EAAIr8B,EAAI,YAAajX,OAGvBwJ,MAAMrE,UAAUyE,QAAQzK,KAAK8X,EAAGw2C,iBAAiB,gBAAgB,SAAUx2C,GACzEA,EAAGsyC,gBAAgB,YACrB,IACAvpD,KAAK+nD,UACL/nD,KAAKgoD,4BACLvH,GAAU1a,OAAO0a,GAAUhnC,QAAQzZ,KAAKiX,IAAK,GAC7CjX,KAAKiX,GAAKA,EAAK,IACjB,EACAuyC,WAAY,WACV,IAAKxK,GAAa,CAEhB,GADA9C,GAAY,YAAal8C,MACrB02C,GAAS4F,cAAe,OAC5BlI,EAAIiJ,GAAS,UAAW,QACpBr9C,KAAKJ,QAAQykD,mBAAqBhH,GAAQvT,YAC5CuT,GAAQvT,WAAW3a,YAAYkuB,IAEjC2B,IAAc,CAChB,CACF,EACA6N,WAAY,SAAoBhP,GAC9B,GAAgC,UAA5BA,EAAYY,aAIhB,GAAIO,GAAa,CAEf,GADA9C,GAAY,YAAal8C,MACrB02C,GAAS4F,cAAe,OAGxBsC,GAAO9U,YAAcqT,IAAWn9C,KAAKJ,QAAQuP,MAAM6zC,YAE5ClE,GACT3B,GAAOuM,aAAarM,GAASyB,IAE7B3B,GAAOh1C,YAAYk1C,IAJnBF,GAAOuM,aAAarM,GAASuB,IAM3B5+C,KAAKJ,QAAQuP,MAAM6zC,aACrBhjD,KAAK+6C,QAAQ6D,GAAQvB,IAEvBjJ,EAAIiJ,GAAS,UAAW,IACxB2B,IAAc,CAChB,OApBEh/C,KAAKwpD,YAqBT,GA8IEzI,IACFhzB,EAAGvlB,SAAU,aAAa,SAAU6zC,IAC7B3F,GAASx3B,QAAUqhC,KAAwBlE,EAAIgC,YAClDhC,EAAIh0B,gBAER,IAIFquB,GAASgX,MAAQ,CACf3/B,GAAIA,EACJulB,IAAKA,EACLc,IAAKA,EACLY,KAAMA,EACN2Y,GAAI,SAAY12C,EAAIu8B,GAClB,QAASM,EAAQ78B,EAAIu8B,EAAUv8B,GAAI,EACrC,EACA22C,OA91DF,SAAgBC,EAAK53C,GACnB,GAAI43C,GAAO53C,EACT,IAAK,IAAInP,KAAOmP,EACVA,EAAIvL,eAAe5D,KACrB+mD,EAAI/mD,GAAOmP,EAAInP,IAIrB,OAAO+mD,CACT,EAs1DEzV,SAAUA,GACVtE,QAASA,EACTI,YAAaA,EACbx3B,MAAOA,GACPzT,MAAOA,EACP6kD,SAAUlH,GACVmH,eAAgBlH,GAChBmH,gBAAiB3M,GACjB/K,SAAUA,EACViD,QAASA,IAQX7C,GAASlgB,IAAM,SAAUhwB,GACvB,OAAOA,EAAQ+yC,GACjB,EAMA7C,GAASmF,MAAQ,WACf,IAAK,IAAIoS,EAAOlgD,UAAU3M,OAAQq6C,EAAU,IAAIjyC,MAAMykD,GAAOC,EAAO,EAAGA,EAAOD,EAAMC,IAClFzS,EAAQyS,GAAQngD,UAAUmgD,GAExBzS,EAAQ,GAAGr2C,cAAgBoE,QAAOiyC,EAAUA,EAAQ,IACxDA,EAAQ7xC,SAAQ,SAAUkyC,GACxB,IAAKA,EAAO32C,YAAc22C,EAAO32C,UAAUC,YACzC,KAAM,gEAAgEmrB,OAAO,CAAC,EAAEid,SAASruC,KAAK28C,IAE5FA,EAAO4R,QAAOhX,GAASgX,MAAQ5b,EAAeA,EAAe,CAAC,EAAG4E,GAASgX,OAAQ5R,EAAO4R,QAC7F9R,GAAcC,MAAMC,EACtB,GACF,EAOApF,GAASryB,OAAS,SAAUpN,EAAIrX,GAC9B,OAAO,IAAI82C,GAASz/B,EAAIrX,EAC1B,EAGA82C,GAASyX,QAxuEK,SA0uEd,IACEC,GACAC,GAEAC,GACAC,GACAC,GACAC,GAPEC,GAAc,GAGhBC,IAAY,EA4Gd,SAASC,KACPF,GAAY9kD,SAAQ,SAAUilD,GAC5B7B,cAAc6B,EAAWC,IAC3B,IACAJ,GAAc,EAChB,CACA,SAASK,KACP/B,cAAcyB,GAChB,CACA,IAAII,GAAazW,IAAS,SAAUiE,EAAKz8C,EAASu9C,EAAQ6R,GAExD,GAAKpvD,EAAQqvD,OAAb,CACA,IAMEC,EANE5pD,GAAK+2C,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,GAAKgH,QAC3C99C,GAAK82C,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,GAAKiH,QACzC6L,EAAOvvD,EAAQwvD,kBACfC,EAAQzvD,EAAQ0vD,YAChBlY,EAAcnC,IACZsa,GAAqB,EAIrBlB,KAAiBlR,IACnBkR,GAAelR,EACfyR,KACAR,GAAWxuD,EAAQqvD,OACnBC,EAAiBtvD,EAAQ4vD,UACR,IAAbpB,KACFA,GAAWjY,EAA2BgH,GAAQ,KAGlD,IAAIsS,EAAY,EACZC,EAAgBtB,GACpB,EAAG,CACD,IAAIn3C,EAAKy4C,EACP3W,EAAO5D,EAAQl+B,GACf9N,EAAM4vC,EAAK5vC,IACXC,EAAS2vC,EAAK3vC,OACdC,EAAO0vC,EAAK1vC,KACZC,EAAQyvC,EAAKzvC,MACbwO,EAAQihC,EAAKjhC,MACb/O,EAASgwC,EAAKhwC,OACd4mD,OAAa,EACbC,OAAa,EACbjY,EAAc1gC,EAAG0gC,YACjBE,EAAe5gC,EAAG4gC,aAClByJ,EAAQlN,EAAIn9B,GACZ44C,EAAa54C,EAAGogC,WAChByY,EAAa74C,EAAGqgC,UACdrgC,IAAOmgC,GACTuY,EAAa73C,EAAQ6/B,IAAoC,SAApB2J,EAAMvJ,WAA4C,WAApBuJ,EAAMvJ,WAA8C,YAApBuJ,EAAMvJ,WACzG6X,EAAa7mD,EAAS8uC,IAAqC,SAApByJ,EAAMtJ,WAA4C,WAApBsJ,EAAMtJ,WAA8C,YAApBsJ,EAAMtJ,aAE3G2X,EAAa73C,EAAQ6/B,IAAoC,SAApB2J,EAAMvJ,WAA4C,WAApBuJ,EAAMvJ,WACzE6X,EAAa7mD,EAAS8uC,IAAqC,SAApByJ,EAAMtJ,WAA4C,WAApBsJ,EAAMtJ,YAE7E,IAAI+X,EAAKJ,IAAep4B,KAAK2X,IAAI5lC,EAAQhE,IAAM6pD,GAAQU,EAAa/3C,EAAQ6/B,IAAgBpgB,KAAK2X,IAAI7lC,EAAO/D,IAAM6pD,KAAUU,GACxHG,EAAKJ,IAAer4B,KAAK2X,IAAI9lC,EAAS7D,IAAM4pD,GAAQW,EAAa/mD,EAAS8uC,IAAiBtgB,KAAK2X,IAAI/lC,EAAM5D,IAAM4pD,KAAUW,GAC9H,IAAKpB,GAAYe,GACf,IAAK,IAAIr6C,EAAI,EAAGA,GAAKq6C,EAAWr6C,IACzBs5C,GAAYt5C,KACfs5C,GAAYt5C,GAAK,CAAC,GAIpBs5C,GAAYe,GAAWM,IAAMA,GAAMrB,GAAYe,GAAWO,IAAMA,GAAMtB,GAAYe,GAAWx4C,KAAOA,IACtGy3C,GAAYe,GAAWx4C,GAAKA,EAC5By3C,GAAYe,GAAWM,GAAKA,EAC5BrB,GAAYe,GAAWO,GAAKA,EAC5BhD,cAAc0B,GAAYe,GAAWX,KAC3B,GAANiB,GAAiB,GAANC,IACbT,GAAqB,EAErBb,GAAYe,GAAWX,IAAMlF,YAAY,WAEnCoF,GAA6B,IAAfhvD,KAAKwM,OACrBkqC,GAASx3B,OAAOmpC,aAAamG,IAE/B,IAAIyB,EAAgBvB,GAAY1uD,KAAKwM,OAAOwjD,GAAKtB,GAAY1uD,KAAKwM,OAAOwjD,GAAKX,EAAQ,EAClFa,EAAgBxB,GAAY1uD,KAAKwM,OAAOujD,GAAKrB,GAAY1uD,KAAKwM,OAAOujD,GAAKV,EAAQ,EACxD,mBAAnBH,GACoI,aAAzIA,EAAe/vD,KAAKu3C,GAASE,QAAQ9M,WAAWyP,IAAU2W,EAAeD,EAAe5T,EAAKmS,GAAYE,GAAY1uD,KAAKwM,OAAOyK,KAIvIqhC,GAASoW,GAAY1uD,KAAKwM,OAAOyK,GAAIi5C,EAAeD,EACtD,EAAE1tB,KAAK,CACL/1B,MAAOijD,IACL,MAGRA,GACF,OAAS7vD,EAAQuwD,cAAgBT,IAAkBtY,IAAgBsY,EAAgBvZ,EAA2BuZ,GAAe,KAC7Hf,GAAYY,CAjFe,CAkF7B,GAAG,IAECa,GAAO,SAAclT,GACvB,IAAIU,EAAgBV,EAAKU,cACvBC,EAAcX,EAAKW,YACnBe,EAAS1B,EAAK0B,OACdO,EAAiBjC,EAAKiC,eACtBO,EAAwBxC,EAAKwC,sBAC7BN,EAAqBlC,EAAKkC,mBAC1BE,EAAuBpC,EAAKoC,qBAC9B,GAAK1B,EAAL,CACA,IAAIyS,EAAaxS,GAAesB,EAChCC,IACA,IAAI4H,EAAQpJ,EAAc0S,gBAAkB1S,EAAc0S,eAAelvD,OAASw8C,EAAc0S,eAAe,GAAK1S,EAChH76C,EAASyF,SAASygD,iBAAiBjC,EAAM3D,QAAS2D,EAAM1D,SAC5DhE,IACI+Q,IAAeA,EAAWp5C,GAAG6vC,SAAS/jD,KACxC28C,EAAsB,SACtB1/C,KAAKuwD,QAAQ,CACX3R,OAAQA,EACRf,YAAaA,IAVS,CAa5B,EACA,SAAS2S,KAAU,CA8BnB,SAASC,KAAU,CA7BnBD,GAAOrrD,UAAY,CACjBurD,WAAY,KACZC,UAAW,SAAmBC,GAC5B,IAAIlT,EAAoBkT,EAAMlT,kBAC9B19C,KAAK0wD,WAAahT,CACpB,EACA6S,QAAS,SAAiBM,GACxB,IAAIjS,EAASiS,EAAMjS,OACjBf,EAAcgT,EAAMhT,YACtB79C,KAAKo8C,SAASxC,wBACViE,GACFA,EAAYjE,wBAEd,IAAIgO,EAActR,EAASt2C,KAAKo8C,SAASnlC,GAAIjX,KAAK0wD,WAAY1wD,KAAKJ,SAC/DgoD,EACF5nD,KAAKo8C,SAASnlC,GAAGyyC,aAAa9K,EAAQgJ,GAEtC5nD,KAAKo8C,SAASnlC,GAAG9O,YAAYy2C,GAE/B5+C,KAAKo8C,SAAS/B,aACVwD,GACFA,EAAYxD,YAEhB,EACA+V,KAAMA,IAER/d,EAASme,GAAQ,CACfvU,WAAY,kBAGdwU,GAAOtrD,UAAY,CACjBorD,QAAS,SAAiBO,GACxB,IAAIlS,EAASkS,EAAMlS,OAEfmS,EADYD,EAAMjT,aACc79C,KAAKo8C,SACzC2U,EAAenX,wBACfgF,EAAO9U,YAAc8U,EAAO9U,WAAW3a,YAAYyvB,GACnDmS,EAAe1W,YACjB,EACA+V,KAAMA,IAER/d,EAASoe,GAAQ,CACfxU,WAAY,kBAypBdvF,GAASmF,MAAM,IAh6Bf,WACE,SAASmV,IAUP,IAAK,IAAI3d,KATTrzC,KAAK07C,SAAW,CACduT,QAAQ,EACRgC,yBAAyB,EACzB7B,kBAAmB,GACnBE,YAAa,GACba,cAAc,GAIDnwD,KACQ,MAAjBqzC,EAAG9E,OAAO,IAAkC,mBAAbvuC,KAAKqzC,KACtCrzC,KAAKqzC,GAAMrzC,KAAKqzC,GAAI9Q,KAAKviC,MAG/B,CAkFA,OAjFAgxD,EAAW7rD,UAAY,CACrB85C,YAAa,SAAqB/B,GAChC,IAAIU,EAAgBV,EAAKU,cACrB59C,KAAKo8C,SAASsJ,gBAChB33B,EAAGvlB,SAAU,WAAYxI,KAAKkxD,mBAE1BlxD,KAAKJ,QAAQ6lD,eACf13B,EAAGvlB,SAAU,cAAexI,KAAKmxD,2BACxBvT,EAAcuF,QACvBp1B,EAAGvlB,SAAU,YAAaxI,KAAKmxD,2BAE/BpjC,EAAGvlB,SAAU,YAAaxI,KAAKmxD,0BAGrC,EACAC,kBAAmB,SAA2BR,GAC5C,IAAIhT,EAAgBgT,EAAMhT,cAErB59C,KAAKJ,QAAQyxD,gBAAmBzT,EAAcT,QACjDn9C,KAAKkxD,kBAAkBtT,EAE3B,EACAwS,KAAM,WACApwD,KAAKo8C,SAASsJ,gBAChBpS,EAAI9qC,SAAU,WAAYxI,KAAKkxD,oBAE/B5d,EAAI9qC,SAAU,cAAexI,KAAKmxD,2BAClC7d,EAAI9qC,SAAU,YAAaxI,KAAKmxD,2BAChC7d,EAAI9qC,SAAU,YAAaxI,KAAKmxD,4BAElCpC,KACAH,KA36DJ9rD,aAAakxC,GACbA,OAAmB,CA46DjB,EACAsd,QAAS,WACP9C,GAAaH,GAAeD,GAAWO,GAAYF,GAA6BH,GAAkBC,GAAkB,KACpHG,GAAYttD,OAAS,CACvB,EACA+vD,0BAA2B,SAAmC9U,GAC5Dr8C,KAAKkxD,kBAAkB7U,GAAK,EAC9B,EACA6U,kBAAmB,SAA2B7U,EAAKwM,GACjD,IAAIxiD,EAAQrG,KACRsF,GAAK+2C,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,GAAKgH,QAC3C99C,GAAK82C,EAAI8G,QAAU9G,EAAI8G,QAAQ,GAAK9G,GAAKiH,QACzC9L,EAAOhvC,SAASygD,iBAAiB3jD,EAAGC,GAOtC,GANAipD,GAAanS,EAMTwM,GAAY7oD,KAAKJ,QAAQqxD,yBAA2Bpe,GAAQD,GAAcG,EAAQ,CACpF8b,GAAWxS,EAAKr8C,KAAKJ,QAAS43C,EAAMqR,GAGpC,IAAI0I,EAAiBpb,EAA2BqB,GAAM,IAClDmX,IAAeF,IAA8BnpD,IAAMgpD,IAAmB/oD,IAAMgpD,KAC9EE,IAA8BM,KAE9BN,GAA6B7E,aAAY,WACvC,IAAI4H,EAAUrb,EAA2B3tC,SAASygD,iBAAiB3jD,EAAGC,IAAI,GACtEisD,IAAYD,IACdA,EAAiBC,EACjB5C,MAEFC,GAAWxS,EAAKh2C,EAAMzG,QAAS4xD,EAAS3I,EAC1C,GAAG,IACHyF,GAAkBhpD,EAClBipD,GAAkBhpD,EAEtB,KAAO,CAEL,IAAKvF,KAAKJ,QAAQuwD,cAAgBha,EAA2BqB,GAAM,KAAUvC,IAE3E,YADA2Z,KAGFC,GAAWxS,EAAKr8C,KAAKJ,QAASu2C,EAA2BqB,GAAM,IAAQ,EACzE,CACF,GAEKnF,EAAS2e,EAAY,CAC1B/U,WAAY,SACZN,qBAAqB,GAEzB,GA2zBAjF,GAASmF,MAAM4U,GAAQD,IAEvB,Y,eCr0EA,SA/8BuB,CAQnBiB,wBAA0B,SAAUC,EAAkB3mD,GAIlD,IAAI4mD,EAAc,gBACd5nD,EAAAA,GAAAA,OACA4nD,EAAc,qBAEd5rC,UAAUD,UAAUpS,MAAM,0BAC1BgjC,GAASryB,OAAOqtC,EAAkB,CAC9BzN,OAAS0N,EACT9a,UAAY,mBACZyN,WAAa,eACbzK,UAAY,IACZuL,eAAgB,EAEhBwM,MAAQ,SAAU3vD,GAEd8I,EAAQ8mD,4BAA4B5vD,EACxC,IAGJy0C,GAASryB,OAAOqtC,EAAkB,CAC9BzN,OAAS0N,EACT9a,UAAY,mBACZyN,WAAa,eACbzK,UAAY,IAEZ+X,MAAQ,SAAU3vD,GAEd8I,EAAQ8mD,4BAA4B5vD,EACxC,GAGZ,EAWA0d,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAOAoiB,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,mBAC5BhY,EAAUe,UAAY,8DACff,CACX,EAOAmqD,6BAA+B,WAE3B,IAAIl9C,EAAQpM,SAASC,cAAc,SAGnC,OAFAmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,oBACxB/K,EAAM1I,KAAO,WACN0I,CACX,EAOAm9C,yBAA2B,WAKvB,IAAIC,EAASxpD,SAASC,cAAc,UAGpC,OAFAupD,EAAO9tD,GAAKlE,KAAK2f,QAAQ,gBACzBqyC,EAAOtpD,UAAY,6BACZspD,CACX,EAEAC,4BAA8B,WAC1B,IAAI1pD,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,gDACTH,CACX,EAOA2pD,wBAA0B,WACtB,IAAIvpD,EAAO3I,KAEPuU,EAAS/L,SAASC,cAAc,UAEhCoS,EAAOrS,SAASC,cAAc,QAiClC,OAhCA8L,EAAOpM,YAAY0S,GACnBtG,EAAOrQ,GAAKlE,KAAK2f,QAAQ,yBACzBpL,EAAO7L,UAAY,qJACnB6L,EAAOmC,QAAU1W,KAAK2f,QAAQ,oBAC9BpL,EAAO0G,aAAa,aAAc,+CAClC1G,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAExB1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvCwG,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB9J,QAAU7T,EAChEwG,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB9J,UAC1DrN,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAU7K,OAAO,yBAA0B,eACrGjU,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,eAEtGrY,EAAKwpD,yBAAyBlwD,EAClC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACnCwG,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB9J,UAC1DrN,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAU7K,OAAO,yBAA0B,eACrGjU,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,eAEtGrY,EAAKwpD,yBAAyBlwD,EAClC,IAGGsS,CACX,EAEA69C,gCAAkC,WAC9B,IAAIv3C,EAAOrS,SAASC,cAAc,QAIlC,OAHAoS,EAAK3W,GAAKlE,KAAK2f,QAAQ,kBACvB9E,EAAKnS,UAAY,iBACjBmS,EAAK1I,UAAY,IACV0I,CACX,EAOAw3C,uBAAyB,WAGrB,IAAIC,EAAO9pD,SAASC,cAAc,UAGlC,OAFA6pD,EAAKpuD,GAAKlE,KAAK2f,QAAQ,oBACvB2yC,EAAK5pD,UAAY,oDACV4pD,CACX,EAEAC,0BAA4B,WACxB,IAAIhqD,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,iCACTH,CACX,EAMAiqD,gCAAkC,WAC9B,IAAI7qD,EAAYa,SAASC,cAAc,OAIvC,OADAd,EAAUe,UAAY,qCACff,CACX,EACA8qD,8BAAgC,WAC5B,IAAIvgD,EAAQ1J,SAASC,cAAc,SAGnC,OAFAyJ,EAAMxJ,UAAY,iDAClBwJ,EAAM/B,MAAQ,qBACP+B,CACX,EACAwgD,+BAAiC,WAC7B,IAAInqD,EAAMC,SAASC,cAAc,OAIjC,OAHAF,EAAIG,UAAY,mCAChBH,EAAIrE,GAAKlE,KAAK2f,QAAQ,uBACtBpX,EAAI4J,UAAY,qBACT5J,CACX,EACAoqD,+BAAiC,WAE7B,IAAIhqD,EAAO3I,KAEP4yD,EAAWpqD,SAASC,cAAc,UACtCmqD,EAAS1uD,GAAKlE,KAAK2f,QAAQ,sBAC3BizC,EAASlqD,UAAY,sHACrBkqD,EAASziD,MAAQ,oBAEjB,IAAI0K,EAAOrS,SAASC,cAAc,QAiBlC,OAhBAoS,EAAKnS,UAAY,uCACjBmS,EAAKsO,UAAY,SAEjBypC,EAASzqD,YAAY0S,GAGjB+3C,EAASvgD,iBACTugD,EAASvgD,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA0BV,OACnE,IAAG,GACI2zC,EAASrgD,aAChBqgD,EAASrgD,YAAY,WAAW,WAC5B/J,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA0BV,OACnE,IAGG2zC,CACX,EAgBAC,6BAA+B,SAAUziD,GAqBrC,IAAIzI,EAAYa,SAASC,cAAc,OAavC,OAZAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,sBAAwBvP,EAAIlM,IACxDyD,EAAUe,UAAY,6EAGtBf,EAAUQ,YAAYnI,KAAK8yD,wBAAwB1iD,IAGnDzI,EAAUQ,YAAYnI,KAAK+yD,+BAA+B3iD,IAG1DzI,EAAUQ,YAAYnI,KAAKgzD,2BAA2B5iD,IAE/CzI,CACX,EAaAmrD,wBAA0B,SAAU1iD,GAOhC,IAAI7H,EAAMC,SAASC,cAAc,OAQjC,OAPAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,mBAAqBvP,EAAIlM,IAC/CqE,EAAIG,UAAY,oBAEhBH,EAAIJ,YAAYnI,KAAKizD,4BAA4B7iD,IACjD7H,EAAIJ,YAAYnI,KAAKkzD,kCAAkC9iD,IACvD7H,EAAIJ,YAAYnI,KAAKmzD,iCAAiC/iD,IAE/C7H,CACX,EAEA4qD,iCAAmC,SAAU/iD,GAEzC,IAAImE,EAAS/L,SAASC,cAAc,OACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,uBAAyBvP,EAAIlM,IACtDqQ,EAAO7L,UAAY,+IACnB6L,EAAOpE,MAAQ,qBACfoE,EAAO0G,aAAa,WAAY,KAEhC,IAAItS,EAAO3I,KAWX,OAVIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC0G,EAAKyqD,8BAA8BnxD,EACvC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC0G,EAAKyqD,8BAA8BnxD,EACvC,IAGGsS,CACX,EASA0+C,4BAA8B,SAAU7iD,GAGpC,IAAI8B,EAAQ1J,SAASC,cAAc,SAMnC,OALAyJ,EAAMhO,GAAKlE,KAAK2f,QAAQ,aAAevP,EAAIlM,IAC3CgO,EAAMxJ,UAAY,gDAClBwJ,EAAM/B,MAAQC,EAAIzJ,aAAeyJ,EAAID,MACrC+B,EAAMC,UAAY/B,EAAID,MAEf+B,CACX,EASAghD,kCAAoC,SAAU9iD,GAC1C,IAAIoE,OAAqC,IAAnBpE,EAAIyB,YAA8BzB,EAAIyB,WAExD0C,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,wBAA0BvP,EAAIlM,IACvDqQ,EAAO7L,UAAY,8GACnB6L,EAAOpE,MAAQ,6BACfoE,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,eAAgBzG,GACpCD,EAAO0G,aAAa,OAAO,UAE3B,IAAIlQ,EAAU/K,KAed,OAdIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQsoD,wBAAwBpxD,EACpC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQsoD,wBAAwBpxD,EACpC,IAGGsS,CACX,EASAw+C,+BAAiC,SAAU3iD,GACvC,IAAImE,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,0BAA4BvP,EAAIlM,IAEzDqQ,EAAO7L,UAAY,wLACnB6L,EAAOpE,MAAQ,gBACfoE,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAO,UAE3B,IAAItS,EAAO3I,KAuBX,OAtBIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC,IAAIwE,EAAUgC,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAwBvP,EAAIlM,KAC3ElC,GACAwE,EAAQ8gB,UAAUjZ,QAAQ,mBAAoB,mBAC9C7H,EAAQ8gB,UAAUjZ,QAAQ,cAAe,gBAEzC7H,EAAQ8gB,UAAUjZ,QAAQ,kBAAmB,oBAC7C7H,EAAQ8gB,UAAUjZ,QAAQ,aAAc,eAEhD,IACOkG,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvCwE,QAAQ8gB,UAAUjZ,QAAQ,mBAAoB,mBAC9C7H,QAAQ8gB,UAAUjZ,QAAQ,cAAe,aAC7C,IAGGkG,CACX,EASAy+C,2BAA6B,SAAU5iD,GAQnC,IAAIzI,EAAYa,SAASC,cAAc,OACvCd,EAAUzD,GAAKlE,KAAK2f,QAAQ,sBAAwBvP,EAAIlM,IACxDyD,EAAUe,UAAY,kDAEtBf,EAAUQ,YAAYnI,KAAKszD,iCAAiCljD,KACxDrG,EAAAA,GAAAA,MACApC,EAAUQ,YAAYnI,KAAKuzD,kCAAkCnjD,IAEjEzI,EAAUQ,YAAYnI,KAAKwzD,sCAAsCpjD,IAGjE,IADA,IAAI0kB,EAAQ90B,KAAKyzD,kCAAkCrjD,GAC1CgF,EAAI,EAAGA,EAAI0f,EAAM1zB,OAAQgU,IAC9BzN,EAAUQ,YAAY2sB,EAAM1f,IAMhC,GAHAzN,EAAUQ,YAAYnI,KAAK0zD,iCAAiCtjD,IAC5DzI,EAAUQ,YAAYnI,KAAK2zD,oCAAoCvjD,KAE3DrG,EAAAA,GAAAA,KAAa,CACb,IAAI6pD,EAAMprD,SAASC,cAAc,UACjCmrD,EAAIlrD,UAAY,8FAChBkrD,EAAI34C,aAAa,gBAAgB,GAC7B24C,EAAIvhD,iBACJuhD,EAAIvhD,iBAAiB,SAAS,SAAUpQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,EAC3C,IACO4xD,EAAIrhD,aACXqhD,EAAIrhD,YAAY,WAAW,SAAUtQ,GACjC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,EAC3C,IAGJ,IAAI6xD,EAAarrD,SAASC,cAAc,OACxCorD,EAAW1rD,YAAYnI,KAAKszD,iCAAiCljD,GAAK,IAClEyjD,EAAW1rD,YAAYnI,KAAKwzD,sCAAsCpjD,GAAK,IACvEyjD,EAAW1rD,YAAYnI,KAAK0zD,iCAAiCtjD,GAAK,IAClEyjD,EAAW1rD,YAAYnI,KAAK2zD,oCAAoCvjD,GAAK,IAErEzI,EAAUQ,YAAYyrD,GACtBjsD,EAAUQ,YAAY0rD,EAC1B,CACA,OAAOlsD,CACX,EAUA2rD,iCAAmC,SAAUljD,GAAyB,IAApByjD,EAAU9lD,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,IAAAA,UAAA,GACpDwG,EAAS/L,SAASC,cAAc,UAIhC8L,EAAOrQ,GAHN2vD,EAGW7zD,KAAK2f,QAAQ,yBAA2BvP,EAAIlM,IAF5ClE,KAAK2f,QAAQ,eAAiBvP,EAAIlM,IAIlDqQ,EAAO7L,UAAY,sGACnB6L,EAAOpE,MAAQ,sBACfoE,EAAOu/C,QAAU1jD,EAAIlM,GACjB2vD,IACAt/C,EAAO4U,UAAY,aAEvB5U,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,OAAQ,UAE5B,IAAIlQ,EAAU/K,KAWd,OAVIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC8I,EAAQgpD,kBAAkB9xD,EAC9B,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC8I,EAAQgpD,kBAAkB9xD,EAC9B,IAGGsS,CACX,EAQAg/C,kCAAoC,SAAUnjD,GAC1C,IAAImE,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,aAAevP,EAAIlM,IAC5CqQ,EAAO7L,UAAY,kGACnB6L,EAAOpE,MAAQ,mBACfoE,EAAOu/C,QAAU1jD,EAAIlM,GACrBqQ,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,OAAQ,UAGX,YAAb7K,EAAIlE,OACJqI,EAAOtV,MAAMgZ,QAAU,IACvB1D,EAAOtV,MAAM4S,WAAa,UAG9B,IAAI9G,EAAU/K,KAWd,OAVIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC8I,EAAQipD,kBAAkB/xD,EAC9B,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC8I,EAAQipD,kBAAkB/xD,EAC9B,IAGGsS,CACX,EAUAi/C,sCAAwC,SAAUpjD,GAAyB,IAApByjD,EAAU9lD,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,IAAAA,UAAA,GAIzDkmD,EAAUzrD,SAASC,cAAc,UAIjCwrD,EAAQ/vD,GAHP2vD,EAGY7zD,KAAK2f,QAAQ,uBAAyBvP,EAAIlM,IAF1ClE,KAAK2f,QAAQ,aAAevP,EAAIlM,IAIjD+vD,EAAQvrD,UAAY,oHAEf0H,EAAID,OAAUC,EAAIzJ,cACnBstD,EAAQh1D,MAAMgZ,QAAU,IACxBg8C,EAAQh1D,MAAM4S,WAAa,SACvBgiD,IACAI,EAAQh1D,MAAM+U,QAAU,SAGhCigD,EAAQ9jD,MAAQ,uBAChB8jD,EAAQH,QAAU1jD,EAAIlM,GAClB2vD,IACAI,EAAQ9qC,UAAY,gBAExB8qC,EAAQh5C,aAAa,WAAY,KACjCg5C,EAAQh5C,aAAa,OAAQ,UAG7B,IAAIlQ,EAAU/K,KAkBd,OAjBIi0D,EAAQ5hD,iBACR4hD,EAAQ5hD,iBACJ,SACA,SAAUpQ,GACN8I,EAAQmpD,sBAAsBjyD,EAClC,IAEGgyD,EAAQ1hD,aAEf0hD,EAAQ1hD,YACJ,WACA,SAAUtQ,GACN8I,EAAQmpD,sBAAsBjyD,EAClC,IAIDgyD,CACX,EAUAN,oCAAsC,SAAUvjD,GAAyB,IAApByjD,EAAU9lD,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,IAAAA,UAAA,GAIvDomD,EAAe3rD,SAASC,cAAc,UAItC0rD,EAAajwD,GAHZ2vD,EAGiB7zD,KAAK2f,QAAQ,4BAA8BvP,EAAIlM,IAF/ClE,KAAK2f,QAAQ,kBAAoBvP,EAAIlM,IAI3DiwD,EAAazrD,UAAY,gJACzByrD,EAAahkD,MAAQ,gBACrBgkD,EAAaL,QAAU1jD,EAAIlM,GACvB2vD,IACAM,EAAahrC,UAAY,OAE7BgrC,EAAal5C,aAAa,WAAY,KACtCk5C,EAAal5C,aAAa,OAAQ,UAGlC,IAAIlQ,EAAU/K,KAkBd,OAjBIm0D,EAAa9hD,iBACb8hD,EAAa9hD,iBACT,SACA,SAAUpQ,GACN8I,EAAQqpD,6BAA6BnyD,EACzC,IAEGkyD,EAAa5hD,aAEpB4hD,EAAa5hD,YACT,WACA,SAAUtQ,GACN8I,EAAQqpD,6BAA6BnyD,EACzC,IAIDkyD,CACX,EASAV,kCAAoC,SAAUrjD,GAU1C,IAAIqX,EAAO,GAGP4sC,EAAO7rD,SAASC,cAAc,OAClC4rD,EAAKnwD,GAAKlE,KAAK2f,QAAQ,gBAAkBvP,EAAIlM,IAC7CmwD,EAAK3rD,UAAY,uCAEjB2rD,EAAKC,QAAQC,UAAY,OACzBF,EAAKlkD,MAAQ,UAEb,IAAI8H,OAAkC,IAAhB7H,EAAI6H,QAA2B7H,EAAI6H,QAAU,EACnEA,EAAUsf,KAAKC,MAAgB,IAAVvf,GACrBo8C,EAAKp1D,MAAMu1D,YAAY,mBAAoBv8C,EAAU,KAErD,IAAIrD,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,wBAA0BvP,EAAIlM,IACtD0Q,EAAM1I,KAAO,QACb0I,EAAM7N,MAAQkR,EACdrD,EAAM6/C,UAAY,UAGlB,IAAI1pD,EAAU/K,KACV4U,EAAMvC,iBACNuC,EAAMvC,iBACF,UACA,SAAUpQ,GACN8I,EAAQ2pD,sBAAsBzyD,EAClC,IAEG2S,EAAMrC,aAEbqC,EAAMrC,YACF,YACA,SAAUtQ,GACN8I,EAAQ2pD,sBAAsBzyD,EAClC,IAIJ2S,EAAMvC,iBACNuC,EAAMvC,iBACF,SACA,SAAUpQ,GACN8I,EAAQ2pD,sBAAsBzyD,EAClC,IAEG2S,EAAMrC,aAEbqC,EAAMrC,YACF,WACA,SAAUtQ,GACN8I,EAAQ2pD,sBAAsBzyD,EAClC,IAIRoyD,EAAKlsD,YAAYyM,GAGjB,IAAI+/C,EAAOnsD,SAASC,cAAc,OAClCksD,EAAKzwD,GAAKlE,KAAK2f,QAAQ,wBAA0BvP,EAAIlM,IACrDywD,EAAKjsD,UAAY,sBAEjB,IAAImS,EAAOrS,SAASC,cAAc,QAUlC,OATAoS,EAAK3W,GAAKlE,KAAK2f,QAAQ,qBAAuBvP,EAAIlM,IAClD2W,EAAKnS,UAAY,iDACjBmS,EAAK1I,UAAY8F,EAAU,IAE3B08C,EAAKxsD,YAAY0S,GAEjB4M,EAAK7hB,KAAKyuD,GACV5sC,EAAK7hB,KAAK+uD,GAEHltC,CACX,EAUAisC,iCAAmC,SAAUtjD,GAAyB,IAApByjD,EAAU9lD,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,IAAAA,UAAA,GAEpDwG,EAAS/L,SAASC,cAAc,UAIhC8L,EAAOrQ,GAHN2vD,EAGW7zD,KAAK2f,QAAQ,yBAA2BvP,EAAIlM,IAF5ClE,KAAK2f,QAAQ,eAAiBvP,EAAIlM,IAIlDqQ,EAAO7L,UAAY,sHACnB6L,EAAOpE,MAAQ,wBACfoE,EAAOu/C,QAAU1jD,EAAIlM,GACjB2vD,IACAt/C,EAAO4U,UAAY,UAEvB5U,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAE5B,IAAIlQ,EAAU/K,KAed,OAdIuU,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ6pD,qBAAqB3yD,EACjC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ6pD,qBAAqB3yD,EACjC,IAGGsS,CACX,EAgBAsgD,iCAAmC,SAAUzkD,GACzC,IAAIzI,EAAYa,SAASC,cAAc,OAEnCqsD,EAAStsD,SAASC,cAAc,OAGpCqsD,EAAOpsD,UAAY,uBACnBf,EAAUQ,YAAY2sD,GAEtB,IAAI5iD,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,kDAClBwJ,EAAM/B,MAAQ,eACd2kD,EAAO3sD,YAAY+J,GAEnB,IAAI/B,EAAQ3H,SAASC,cAAc,OACnC0H,EAAMjM,GAAKlE,KAAK2f,QAAQ,oBACxBxP,EAAMgC,UAAY/B,EAAID,MACtBA,EAAMzH,UAAY,sBAClBosD,EAAO3sD,YAAYgI,GAEnB,IAAIyiD,EAAWpqD,SAASC,cAAc,UACtCmqD,EAAS1uD,GAAKlE,KAAK2f,QAAQ,oBAC3BizC,EAASlqD,UAAY,sHACrBkqD,EAASziD,MAAQ,oBAEjB,IAAIxH,EAAO3I,KAEP+0D,EAAe,WACfvsD,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,cAClGxY,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAU7K,OAAO,yBAA0B,eACrGjU,SAASqL,eAAezD,EAAIlM,IAAIojB,UAAUtG,IAAI,qBAC9CxY,SAASqL,eAAezD,EAAIlM,IAAIojB,UAAU7K,OAAO,oBACrD,EACIm2C,EAASvgD,iBACTugD,EAASvgD,iBAAiB,QAAS0iD,GAC5BnC,EAASrgD,aAEhBqgD,EAASrgD,YAAY,UAAWwiD,GAEpC/0D,KAAKqS,iBAAiB,wBAAwB,SAACpQ,GACvC0lB,SAASvX,EAAIlM,GAAG0U,MAAM,KAAK,GAAGA,MAAM,cAAc,MAAQ3W,EAAEuK,MAAMtI,KAClEsE,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,cAClGxY,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB2H,UAAU7K,OAAO,yBAA0B,eAE7G,IACAq4C,EAAO3sD,YAAYyqD,GACnBjrD,EAAUQ,YAAY2sD,GAEtB,IAAI50D,EAAUsI,SAASC,cAAc,OAKrC,GAJAvI,EAAQgE,GAAKlE,KAAK2f,QAAQ,sBAC1Bzf,EAAQwI,UAAY,uCACpBf,EAAUQ,YAAYjI,GAElBkQ,EAAI4kD,aAAc,CAClB,IAAIC,EAAQzsD,SAASC,cAAc,OACnCwsD,EAAM/wD,GAAKlE,KAAK2f,QAAQ,wBACxBs1C,EAAM9kD,MAAQ,kCACd,IAAI+kD,EAAW1sD,SAASC,cAAc,KACtCysD,EAASzO,KAAOr2C,EAAI4kD,aACpBE,EAAS/sD,YAAY8sD,GACrB/0D,EAAQiI,YAAY+sD,EACxB,CAEA,IAAIC,EAAO3sD,SAASC,cAAc,OAKlC,GAJA0sD,EAAKjxD,GAAKlE,KAAK2f,QAAQ,0BACvBw1C,EAAKhjD,UAAY/B,EAAIzJ,YACrBzG,EAAQiI,YAAYgtD,GAEhB/kD,EAAI+R,SAAU,CACd,IAAIizC,EAAM5sD,SAASC,cAAc,OACjC2sD,EAAIlxD,GAAKlE,KAAK2f,QAAQ,uBAEtB,IAAI01C,EAAW7sD,SAASC,cAAc,OACtC4sD,EAAS3sD,UAAY,sBACrB2sD,EAASljD,UAAY,cACrBijD,EAAIjtD,YAAYktD,GAEhB,IAAK,IAAIjgD,EAAI,EAAGA,EAAIhF,EAAI+R,SAAS/gB,OAAQgU,IAAK,CAC1C,IAAIkgD,EAASllD,EAAI+R,SAAS/M,GAAG5V,IAEzB+1D,EAAU/sD,SAASC,cAAc,OACrC8sD,EAAQ7sD,UAAY,kBAEpB,IAAI8sD,EAAShtD,SAASC,cAAc,KACpC+sD,EAAO/O,KAAO6O,EACdE,EAAOrjD,UAAYmjD,EACnBC,EAAQptD,YAAYqtD,GACpBJ,EAAIjtD,YAAYotD,EACpB,CAE4B,IAAxBnlD,EAAI+R,SAAS/gB,QACblB,EAAQiI,YAAYitD,EAE5B,CAEA,GAAIhlD,EAAIqlD,QAAS,CACb,IAAIC,EAAMltD,SAASC,cAAc,OACjCitD,EAAIxxD,GAAKlE,KAAK2f,QAAQ,qBAEtB,IAAIg2C,EAAWntD,SAASC,cAAc,OACtCktD,EAASjtD,UAAY,sBACrBitD,EAASxjD,UAAY,UACrBujD,EAAIvtD,YAAYwtD,GAMhB,IAJA,IAAIF,EAAU,CAAC,EACXG,EAAWxlD,EAAIylD,qBAAuB,KAGjClwD,EAAI,EAAGA,EAAIyK,EAAIqlD,QAAQr0D,OAAQuE,IAAK,CACzC,IAAImwD,EAAW1lD,EAAIqlD,QAAQ9vD,GAAGowD,oBAC9B,GAAID,EAAU,CACV,IAAIpmB,EAAIomB,EAAStoB,WACjBsoB,EAAWv+B,KAAKC,MAAM7P,SAAS+nB,EAAE54B,UAAU,EAAG,GAAI,IAAM,IAAMygB,KAAK8X,IAAI,GAAIK,EAAEtuC,OAAS,EAC1F,MACI00D,EAAW,IAEfL,EAAQK,GAAY1lD,EAAIqlD,QAAQ9vD,EACpC,CAEA,IAAK,IAAI2J,KAASmmD,EACd,GAAIA,EAAQ/qD,eAAe4E,GAAQ,CAC/B,IAAI0mD,EAASP,EAAQnmD,GAAO9P,IAE5B,GAAsB,iBAAXw2D,IAAyE,IAAlDA,EAAOjuD,cAAc0R,QAAQ,gBAAwB,CAEnF,IAAIw8C,EAAUztD,SAASC,cAAc,OACrCwtD,EAAQvtD,UAAY,kBAEpBktD,EAAWH,EAAQnmD,GAAOumD,qBAAuBD,EAEjD,IAAIM,EAAS1tD,SAASC,cAAc,KACpCytD,EAAOxtD,UAAY,UACnBwtD,EAAOzP,KAAOuP,EACdE,EAAOnzD,OAAS,SAChBmzD,EAAO/jD,UAAY,QAAU7C,EAAQ,SAAWsmD,EAChDK,EAAQ9tD,YAAY+tD,GACpBR,EAAIvtD,YAAY8tD,EACpB,aACWR,EAAQnmD,EAEvB,CAGgC,IAAhCpO,OAAOC,KAAKs0D,GAASr0D,QACrBlB,EAAQiI,YAAYutD,EAE5B,CAEA,OAAO/tD,CACX,G,qtDCt7BJ,IAAItI,GAAS2Q,EAAAA,EAAO1Q,UAAU,iBA6E1B62D,GAAa,SAAAhwD,GAYb,SAAAgwD,EAAav2D,GAAS,IAAAyG,G,4FAAAC,CAAA,KAAA6vD,GAElB,I,MAAIlsB,GADJrqC,EAAUA,GAAW,CAAC,GACCA,SAAW,CAAC,EAC/BwhB,EAAUxhB,EAAQ8f,QAAU,GAKhC,G,EAFA,K,EAAA,CAAMuqB,G,OAANksB,MAAA9vD,E,gFAEsB8vD,GAClB,MAAM,IAAIlyD,UAAU,2BAGxB,IAAKuF,MAAM4E,QAAQgT,GACf,MAAM,IAAI3hB,MAAM,gDAGpB,GAAwB,WAApB2a,GAAO6vB,GACP,MAAM,IAAIxqC,MAAM,kDAgBpB,OATA4G,EAAKnB,UAAY,gBAEjBmB,EAAKgK,YAAY45B,EAAU7oB,GAE3B/a,EAAKsB,UAAYtB,EAAKiK,eAAe25B,GAGpC5jC,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAKsB,WAAatB,EAAKG,QAAUH,EAAKsB,UAEhFyiB,GAAA/jB,EAAAA,EACJ,CAMA,O,sRAAAO,CAAAuvD,EAAAhwD,G,EAAAgwD,E,EAAA,EAAArvD,IAAA,SAAAC,MAKA,SAAQd,GAAK,I,UAAA6mB,EAAA,KAGT,GAAI7mB,EAEAjG,KAAKo2D,cAAcnwD,GAGdjG,KAAKq2D,WACNr2D,KAAKs2D,yBAAyBr7C,aAAa,gBAAgB,GAK/Djb,KAAKu2D,WAAWC,eAAiBvwD,EAAI8nB,GACjC,WACA,kBAAMjB,EAAK2pC,cAAcxwD,EAAI,IAIjCjG,KAAKu2D,WAAWG,cAAgBzwD,EAAI0d,YAAYoK,GAC5C,OACA,SAACsuB,GACG,IACIn4C,EADAsI,EAAQ6vC,EAAI71C,QAIXgG,EAAM9B,eAAe,aAKtBxG,EAAKsI,EAAMmqD,WAJXzyD,EAAK4oB,EAAK8pC,SACVpqD,EAAMmqD,UAAYzyD,EAClB4oB,EAAK8pC,YAIJ9pC,EAAK1L,QAAQld,IACd4oB,EAAK+pC,SAASrqD,EAEtB,IAIJxM,KAAKu2D,WAAWO,iBAAmB7wD,EAAI0d,YAAYoK,GAC/C,UACA,SAACsuB,GACG,IAAI7vC,EAAQ6vC,EAAI71C,QACZtC,EAAKsI,EAAMmqD,UACX7pC,EAAK1L,QAAQld,IACb4oB,EAAKiqC,YAAYvqD,EAEzB,QAED,EAGHqgB,EAAAA,EAAAA,SAAoB7sB,KAAKu2D,WAAWC,iBACpC3pC,EAAAA,EAAAA,SAAoB7sB,KAAKu2D,WAAWG,gBACpC7pC,EAAAA,EAAAA,SAAoB7sB,KAAKu2D,WAAWO,kBAIpC,IAAK,IAAI1hD,EAAIpV,KAAKg3D,aAAa51D,OAAS,EAAGgU,GAAK,EAAGA,KAGvD,E,EAGA+gD,E,EAAA,S,EAAA,K,aAAA,G,kFAAA,CAAalwD,IAGTjG,KAAKJ,QAAQyE,UACbrE,KAAKi3D,YAAYj3D,KAAKJ,QAAQyE,WAIN,IAAxBrE,KAAKJ,QAAQs3D,QACbl3D,KAAKsiB,eAAegF,UAAUtG,IAAI,uBAE1C,GAEA,CAAAla,IAAA,WAAAC,MAqBA,SAAUyF,EAAO2qD,GAAQ,IAAA3pC,EAAA,KACjBvnB,EAAMjG,KAAKiH,SAGf,GAFAkwD,EAASA,GAAU,CAAC,EAEf3qD,EAAL,CAKA,IAAItI,EAAKsI,EAAMmqD,UACf,QAAkB,IAAPzyD,EAAX,CAMA,IAAIkzD,GAAe,EAQnB,GAPAnxD,EAAI0d,YAAY/Z,SACZ,SAACytD,GACOA,EAAIV,YAAczyD,IAClBkzD,GAAe,EAEvB,IAECA,EAAL,CAMA,GAAKp3D,KAAKohB,QAAQld,GAiEX,CAEH,IAAK,IAAIoV,KAAQ69C,EACTA,EAAOzsD,eAAe4O,KACtBtZ,KAAKohB,QAAQld,GAAIoV,GAAQ69C,EAAO79C,IAIxC,GAAI69C,EAAOhnD,MAAO,CACd,IAAImnD,EAAU9uD,SAASqL,eAAe7T,KAAK2f,QAAQ,aAAezb,IAC9DozD,IACAA,EAAQnlD,UAAYglD,EAAOhnD,MAC3BmnD,EAAQnnD,MAAQgnD,EAAOxwD,aAAewwD,EAAOhnD,MAErD,CAEA,IAAIonD,EAAU/uD,SAASqL,eAAe7T,KAAK2f,QAAQ,aAAezb,IAClE,IAAKsE,SAASqL,eAAe7T,KAAK2f,QAAQ,aAAezb,KAAQizD,EAAOxwD,YAAa,CACjF,IAAI6wD,EAAgBhvD,SAASqL,eAAe7T,KAAK2f,QAAQ,sBAAwBzb,IAC7EszD,GACAA,EAAcrvD,YACVnI,KAAKwzD,sCAAsC,CACvCtvD,GAAKA,IAIrB,CAEIqzD,GAAiC,sBAAtBA,EAAQ7uD,WACnBF,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,aAG1G,KAjGuB,CAEnB,IAAIy2C,EAAaz3D,KAAK03D,aAAalrD,IAAU,CAAC,EAC1CyL,EAAUzL,EAAMmrD,aAChB9lD,EAAarF,EAAMorD,aACnBC,EAAY73D,KAAK63D,UAAUrrD,EAAOvG,GAClC6xD,EAAe,CACftrD,MAAQA,EACRtI,GAAKA,EACLmE,KAAOmE,EAAMnE,KACb0vD,QAAUvrD,EAAMurD,QAChB7rD,KAAO,GACP+L,QAAqB,MAAXA,EAAkBA,EAAU,EACtCpG,WAA2B,MAAdA,GAAqBA,EAClCmmD,QAAuB,MAAbH,GAAoBA,EAC9B1nD,MAAwB,MAAhBgnD,EAAOhnD,MAAgBgnD,EAAOhnD,MAASsnD,EAAWQ,QAAU/zD,EACpEyC,YAAcwwD,EAAOxwD,aAAe8wD,EAAWS,cAAgB,KAC/DzC,QAAU0B,EAAO1B,SAAWgC,EAAWU,UAAY,GACnDh2C,SAAWg1C,EAAOh1C,UAAYs1C,EAAWn2C,WAAa,GACtD0zC,aAAemC,EAAOnC,cAAgByC,EAAWW,eAAiB,MAEtEp4D,KAAKohB,QAAQld,GAAM4zD,EAInB,IAAIO,EAAWr4D,KAAKs4D,gBAAgBR,GAEpC93D,KAAKohB,QAAQld,GAAIqE,IAAM8vD,EAMlB7rD,EAAM+rD,WAAmC,IAAtB/rD,EAAM+rD,kBAAkD,IAAtB/rD,EAAM+rD,aAAgC/rD,EAAMgsD,iBAElGx4D,KAAKy4D,sBAGLz4D,KAAKg3D,aAAa0B,QAAQZ,GAC1B93D,KAAK24D,cACLnsD,EAAMosD,UAAU54D,KAAK24D,aACrB34D,KAAK64D,oBAAoBnP,aAAa2O,EAAUr4D,KAAK64D,oBAAoB3pC,aAO7ElvB,KAAKu2D,WAAWuC,mBAAqBtsD,EAAMuhB,GACvC,kBACA,SAAC9rB,GAAC,OAAKurB,EAAKurC,oBAAoB92D,EAAE,IAEtCjC,KAAKu2D,WAAWyC,sBAAwBxsD,EAAMuhB,GAC1C,kBACA,SAAC9rB,GAAC,OAAKurB,EAAKyrC,uBAAuBh3D,EAAE,IAGG,MAAxCjC,KAAKohB,QAAQld,GAAIg1D,sBACjBl5D,KAAKohB,QAAQld,GAAIg1D,oBAAsB1sD,EAAMuhB,GACzC,iBACA,kBAAMP,EAAKirC,oBAAoB,IAK3C,CAkCAz4D,KAAKm5D,sBAaLn5D,KAAKi9C,cAAc,CACf/wC,KAAO,oBACPM,MAAQxM,KAAKohB,QAAQld,IArHzB,MAFI7E,GAAOqD,IAAI,oEAAqE8J,EAAO,4CAZ3F,MAFInN,GAAOE,MAAM,kGAAmGiN,EAJpH,MAFInN,GAAOqD,IAAI,2DA6InB,GAAC,CAAAoE,IAAA,cAAAC,MASD,SAAayF,GACT,GAAKA,EAAL,EAIAqgB,EAAAA,EAAAA,SAAoB7sB,KAAKu2D,WAAWuC,qBACpCjsC,EAAAA,EAAAA,SAAoB7sB,KAAKu2D,WAAWyC,uBAGpC35D,GAAOE,MAAMiN,GAEb,IAAI4sD,EAAU5sD,EAAMmqD,UAGhBY,EAAU/uD,SAASqL,eAAe7T,KAAK2f,QAAQ,aAAey5C,IAC9D7B,GAAiC,sBAAtBA,EAAQ7uD,WACnBF,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,cAItG,IAAIq3C,EAAW7vD,SAASqL,eAAe7T,KAAK2f,QAAQ,sBAAwBy5C,IACxEf,GACAr4D,KAAK64D,oBAAoB1pC,YAAYkpC,GAGzC,IAAIgB,EAAa9hC,KAAK2X,IAAI1iC,EAAM+rD,YAAcv4D,KAAK24D,aAEnD34D,KAAKg3D,aAAajxB,OAAOszB,EAAY,GACrCr5D,KAAK24D,cAGL,IADA,IAAIW,EAAiBt5D,KAAKg3D,aACjB5hD,EAAI,EAAGA,EAAIkkD,EAAel4D,OAAQgU,IACvCkkD,EAAelkD,GAAG5I,MAAMosD,UAAU54D,KAAK24D,YAAcvjD,GAezDpV,KAAKi9C,cAAc,CACf/wC,KAAO,uBACPM,MAAQxM,KAAKohB,QAAQg4C,YAIlBp5D,KAAKohB,QAAQg4C,GAGpBp5D,KAAKm5D,qBArDL,CAsDJ,GAEA,CAAAryD,IAAA,eAAAC,MAKA,SAAcsvD,GACV,QAAkBl2C,IAAdk2C,EAAJ,CAIA,IAAIkD,GAAe/wD,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAqB9J,QACxEwgD,GAAakD,IAAkBlD,IAAckD,IAI7CA,GAKD/wD,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAqB2H,UAAUtG,IAAI,yBAA0B,cAEtGxY,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAqB9J,SAAWwgD,EAbrE,MAFIh3D,GAAOqD,IAAI,mEAgBnB,GAEA,CAAAoE,IAAA,eAAAC,MAIA,WACI,OAAO/G,KAAKq2D,SAChB,GAEA,CAAAvvD,IAAA,eAAAC,MAMA,SAAcyF,EAAOgtD,GACjB,GAAKhtD,EAAL,CAGA,IAAI4sD,EAAU5sD,EAAMmqD,UACpB,GAAe,MAAXyC,EAAJ,CAIA,IAAIK,EAAajxD,SAASqL,eAAe7T,KAAK2f,QAAQ,eAAiBy5C,IACnEK,KACkB,IAAdD,EACAC,EAAWx6D,MAAM+U,QAAU,QACN,IAAdwlD,IACPC,EAAWx6D,MAAM+U,QAAU,SANnC,MAFI3U,GAAOqD,IAAI,+FAHf,CAgBJ,GAEA,CAAAoE,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAMA,CAAAb,IAAA,cAAAC,MAOA,SAAanH,EAAS8f,GAElB1f,KAAKJ,QAAU,CACXsE,GAAK,GACLmyD,WAAY,EACZxf,WAAY,EACZ6iB,SAAU,EACV7vD,OAAQ,EACRqtD,QAAS,EACTyC,WAAY,GAIhBlpD,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAASA,GAE3BI,KAAKJ,QAAQ8f,OAASA,EAGtB1f,KAAK4f,KAAO5f,KAAKJ,QAAQsE,IAAMwmB,EAAAA,EAAWxV,WAE1ClV,KAAKohB,QAAU,CAAC,EAEhBphB,KAAKg3D,aAAe,GAEpBh3D,KAAK45D,aAAe,CAAC,EAErB55D,KAAK24D,YAAc,EAEnB34D,KAAK42D,SAAW,EAEhB52D,KAAKq2D,eAAwCl2C,IAA3BngB,KAAKJ,QAAQy2D,WAA2Br2D,KAAKJ,QAAQy2D,UAEvEr2D,KAAK64D,oBAAsB,KAE3B74D,KAAKu2D,WAAa,CAAC,EAKnB,IAAK,IAAInhD,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAAK,CAEpC,IAAI5I,EAAQkT,EAAOtK,GAAG5I,MACtB,GAAIA,EAAO,CACP,IAAItI,EAECsI,EAAM9B,eAAe,aAKtBxG,EAAKsI,EAAMmqD,WAJXzyD,EAAKlE,KAAK42D,SACVpqD,EAAMmqD,UAAYzyD,EAClBlE,KAAK42D,YAMT,IAAIiD,EAAOn6C,EAAOtK,GAAG+hD,QAAU,CAAC,EAC5Bl/C,EAAUzL,EAAMmrD,aAChB9lD,EAAarF,EAAMorD,aACnBE,EAAe,CACftrD,MAAQA,EACRtI,GAAKA,EACLmE,KAAOmE,EAAMnE,KACb0vD,QAAUvrD,EAAMurD,QAChB9/C,QAAqB,MAAXA,EAAkBA,EAAU,EACtCpG,WAA2B,MAAdA,GAAqBA,EAClC1B,MAAsB,MAAd0pD,EAAK1pD,MAAgB0pD,EAAK1pD,MAAQ0pD,EAAK31D,GAAK21D,EAAK31D,GAAKA,EAC9DyC,YAAckzD,EAAKlzD,aAAe,KAClC8uD,QAAUoE,EAAKpE,SAAW,GAC1BtzC,SAAW03C,EAAK13C,UAAY,GAC5B6yC,aAAe6E,EAAK7E,cAAgB,MAExCh1D,KAAKohB,QAAQld,GAAM4zD,CACvB,CACJ,CACJ,GAEA,CAAAhxD,IAAA,iBAAAC,MAMA,WAEI,IAAIY,EAAY3H,KAAKsmB,8BAGjB1R,EAAQ5U,KAAK8xD,+BACjBnqD,EAAUQ,YAAYyM,GAGjB5U,KAAKq2D,UAINr2D,KAAKq2D,WAAY,GAHjBzhD,EAAMiB,QAAU,UAChB7V,KAAKq2D,WAAY,GAOrB,IAAItrD,EAAU/K,KAEV85D,EAAkB,SAAU73D,GAC5BjC,KAAKq2D,WAAap0D,EAAEc,OAAO8S,QAG3B7V,KAAKi9C,cAAc,mBACvB,EACAroC,EAAMvC,iBACF,SACA,SAAUpQ,GACN63D,EAAgB36D,KAAK4L,EAAS9I,EAClC,IAIJ,IAAI83D,EAAQ/5D,KAAKs2D,yBAA2Bt2D,KAAKkyD,0BAKjD,GAJAvqD,EAAUQ,YAAY4xD,GAGtBpyD,EAAU2f,UAAUtG,IAAI,kCACpBhhB,KAAKJ,QAAQ85D,QAAS,CACtB/xD,EAAU2f,UAAU7K,OAAO,kCAC3B9U,EAAU2f,UAAUtG,IAAI,gCACxB,IAAI04C,EAAU15D,KAAKg6D,sBAAyBh6D,KAAKoyD,kCACjD2H,EAAM5xD,YAAYuxD,EACtB,CAGA,IAAIO,EAAOj6D,KAAK+xD,2BAIhB,GAHApqD,EAAUQ,YAAY8xD,GAGlBj6D,KAAKJ,QAAQiK,MAAO,CAEpB,IAAIqwD,EAAcl6D,KAAKwyD,kCACvByH,EAAK9xD,YAAY+xD,GAEjB,IAAIC,EAAYn6D,KAAKyyD,gCACrByH,EAAY/xD,YAAYgyD,GAExB,IAAIC,EAAap6D,KAAK0yD,iCACtBwH,EAAY/xD,YAAYiyD,GAExB,IAAIC,EAAar6D,KAAK2yD,iCACtBuH,EAAY/xD,YAAYkyD,EAC5B,CAEA,IAAI9xD,EAAMvI,KAAK64D,oBAAsB74D,KAAKiyD,8BAC1CgI,EAAK9xD,YAAYI,GAGjBvI,KAAKyxD,wBAAwBlpD,EAAKvI,MAGlC,IAAIs6D,EAAOt6D,KAAKqyD,yBACZkI,EAAOv6D,KAAKuyD,4BAIhB,OAHA+H,EAAKnyD,YAAYoyD,GACjB5yD,EAAUQ,YAAYmyD,GAEf3yD,CACX,GAEA,CAAAb,IAAA,gBAAAC,MAMA,SAAed,GAAK,IAAAmoB,EAAA,KAoEhB,IAAK,IAAIosC,KAnETx6D,KAAK45D,aAAe,CAAC,EAIrB3zD,EAAI0d,YAAY/Z,SAAQ,SAAC4C,GAErB,IAAItI,EAAK,KAEJsI,EAAM9B,eAAe,aAKtBxG,EAAKsI,EAAMmqD,WAJXzyD,EAAKkqB,EAAKwoC,SACVpqD,EAAMmqD,UAAYzyD,EAClBkqB,EAAKwoC,YAKT,IAAIa,EAAarpC,EAAKspC,aAAalrD,IAAU,CAAC,EAC9C,GAAK4hB,EAAKhN,QAAQld,GAsBdkqB,EAAKhN,QAAQld,GAAI+T,QAAUzL,EAAMmrD,aACjCvpC,EAAKhN,QAAQld,GAAI2N,WAAarF,EAAMorD,aACpCxpC,EAAKhN,QAAQld,GAAI8zD,QAAU5pC,EAAKypC,UAAUrrD,EAAOvG,OAxB9B,CAEnB,IAAIgS,EAAUzL,EAAMmrD,aAChB9lD,EAAarF,EAAMorD,aACnBC,EAAYzpC,EAAKypC,UAAUrrD,EAAOvG,GAClC6xD,EAAe,CACftrD,MAAQA,EACRtI,GAAKA,EACLmE,KAAOmE,EAAMnE,KACb0vD,QAAUvrD,EAAMurD,QAChB9/C,QAAqB,MAAXA,EAAkBA,EAAU,EACtCpG,WAA2B,MAAdA,GAAqBA,EAClCmmD,QAAuB,MAAbH,GAAoBA,EAC9B1nD,MAAQsnD,EAAWQ,QAAU/zD,EAC7ByC,YAAc8wD,EAAWS,cAAgB,KACzCzC,QAAUgC,EAAWU,UAAY,GACjCh2C,SAAWs1C,EAAWn2C,WAAa,GACnC0zC,aAAeyC,EAAWW,eAAiB,MAE/ChqC,EAAKhN,QAAQld,GAAM4zD,CACvB,CAoBA,GAbA1pC,EAAK+qC,sBAGL/qC,EAAKmoC,WAAWuC,mBAAqBtsD,EAAMuhB,GACvC,kBACA,SAAC9rB,GAAC,OAAKmsB,EAAK2qC,oBAAoB92D,EAAE,IAEtCmsB,EAAKmoC,WAAW0C,uBAAyBzsD,EAAMuhB,GAC3C,kBACA,SAAC9rB,GAAC,OAAKmsB,EAAK6qC,uBAAuBh3D,EAAE,SAIjBke,IAApB3T,EAAM+rD,UAAyB,CAC/B,IAAIc,EAAa7sD,EAAM+rD,aAAe,EACjCnqC,EAAKwrC,aAAaP,IAAgB7vD,MAAM4E,QAAQggB,EAAKwrC,aAAaP,MACnEjrC,EAAKwrC,aAAaP,GAAc,IAEpCjrC,EAAKwrC,aAAaP,GAAYzzD,KAAKwoB,EAAKhN,QAAQld,GACpD,CACJ,IAGmBlE,KAAK45D,aACpB,GAAI55D,KAAK45D,aAAalvD,eAAe8vD,GAEjC,IADA,IAAI96C,EAAS1f,KAAK45D,aAAaY,GACtB92C,EAAI,EAAGA,EAAIhE,EAAOte,OAAQsiB,IAE/B1jB,KAAKg3D,aAAa0B,QAAQh5C,EAAOgE,IAEjC1jB,KAAK24D,cACLj5C,EAAOgE,GAAGlX,MAAMosD,UAAU54D,KAAK24D,aACoC,MAA/D34D,KAAKohB,QAAQ1B,EAAOgE,GAAGlX,MAAMmqD,WAAWuC,sBACxCl5D,KAAKohB,QAAQ1B,EAAOgE,GAAGlX,MAAMmqD,WAAWuC,oBAAsBx5C,EAAOgE,GAAGlX,MAAMuhB,GAC1E,iBACA,kBAAMK,EAAKqqC,oBAAoB,KAQnD,IAAK,IAAI7xC,EAAI,EAAGA,EAAI5mB,KAAKg3D,aAAa51D,OAAQwlB,IAAK,CAC/C,IAAIkxC,EAAe93D,KAAKg3D,aAAapwC,GACjCyxC,EAAWr4D,KAAKs4D,gBAAgBR,GAC/B93D,KAAK64D,oBAAoB4B,cAAc,IAAMpC,EAASn0D,KACvDlE,KAAK64D,oBAAoB1wD,YAAYkwD,GAGzCr4D,KAAKohB,QAAQ02C,EAAa5zD,IAAIqE,IAAM8vD,CACxC,CACJ,GAEA,CAAAvxD,IAAA,kBAAAC,MASA,SAAiB+wD,GACb,IAAI4C,EAAY5C,EAAarC,SAA2C,IAAhCqC,EAAarC,QAAQr0D,OACzDu5D,EAAa7C,EAAa31C,UAA6C,IAAjC21C,EAAa31C,SAAS/gB,OAC5Dw5D,EAAiB9C,EAAa9C,cAG9B0F,GAAaC,GAAcC,KAC3B9C,EAAa+C,2BAA4B,GAG7C/C,EAAa5rD,KAAO,GAChBlM,KAAKJ,QAAQ+5D,YAET7B,EAAatrD,iBAAiBsuD,KAAehD,EAAatrD,iBAAiBuuD,OAC3EjD,EAAa5rD,KAAO,WAI5B,IAAImsD,EAAWr4D,KAAK6yD,6BAA6BiF,GAMjD,OAJKA,EAAaE,SACdK,EAAS/wC,UAAUtG,IAAI,cAGpBq3C,CACX,GAMA,CAAAvxD,IAAA,2BAAAC,MAOA,SAA0B9E,GACO,SAAzBA,EAAEc,OAAO2lB,aACT1oB,KAAKgoC,cAET,IAAIgzB,EAASh7D,KAAKs2D,yBAAyB5tC,YAC3C1oB,KAAKq2D,YAAyB,SAAX2E,GAEnBh7D,KAAKi9C,cAAc,oBAEfj9C,KAAKJ,QAAQyE,WAAarE,KAAKq2D,WAC/Br2D,KAAKi7D,eAAej7D,KAAKJ,QAAQyE,SAEzC,GAEA,CAAAyC,IAAA,sBAAAC,MAGA,WACQ/G,KAAKg6D,wBACLh6D,KAAKg6D,sBAAsB7nD,UAAYjR,OAAOC,KAAKnB,KAAKohB,SAAShgB,OAEzE,GAEA,CAAA0F,IAAA,wBAAAC,MAMA,SAAuB9E,GACnBA,EAAEc,OAAO+mC,WAAW7qC,MAAMu1D,YAAY,mBAAoBvyD,EAAEc,OAAOgE,MAAQ,KAC3E,IAAIm0D,EAAQj5D,EAAEc,OAAOmB,GACjBk1D,EAAU1uC,EAAAA,EAAWzhB,MAAMiyD,GAC3B1uD,EAAQxM,KAAKohB,QAAQg4C,GAAS5sD,MAE9B2uD,EAAel5D,EAAEc,OAAOgE,MACZyB,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAuBy5C,IAClEjnD,UAAYgpD,EAAe,IAErC3uD,EAAM4uD,WAAWD,EAAe,IACpC,GAEA,CAAAr0D,IAAA,sBAAAC,MAOA,SAAqB9E,GACjB,IAAIgW,EAAUhW,EAAEc,OAAO40D,aACnB1/C,EAAU,IACVA,EAAU,GAEVA,EAAU,IACVA,EAAU,GAEd,IAAI/T,EAAKjC,EAAEc,OAAO4zD,UAEd0E,EAAoB7yD,SAASqL,eAAe7T,KAAK2f,QAAQ,wBAA0Bzb,IACnFm3D,IACAA,EAAkBt0D,MAAQwwB,KAAKC,MAAgB,IAAVvf,IAGzC,IAAIqjD,EAAmB9yD,SAASqL,eAAe7T,KAAK2f,QAAQ,qBAAuBzb,IAC/Eo3D,IACAA,EAAiBnpD,UAAYolB,KAAKC,MAAgB,IAAVvf,GAAiB,KAgB7DjY,KAAKi9C,cAAc,CACf/wC,KAAO,+BACP+L,QAAUA,EACVzL,MAAQxM,KAAKohB,QAAQld,IAE7B,GAEA,CAAA4C,IAAA,0BAAAC,MAMA,SAAyB9E,GACrB,IAAIi5D,EAAQj5D,EAAEc,OAAOmB,GACjBk1D,EAAU1uC,EAAAA,EAAWzhB,MAAMiyD,GACnBl7D,KAAKohB,QAAQg4C,GAAS5sD,MAC5B+uD,WAAqC,SAAzBt5D,EAAEc,OAAO2lB,YAC/B,GAEA,CAAA5hB,IAAA,yBAAAC,MAOA,SAAwB9E,GACpB,IAAIuS,EAAUvS,EAAEc,OAAO60D,aACnB1zD,EAAKjC,EAAEc,OAAO4zD,UACd6E,EAAkBhzD,SAASqL,eAAe7T,KAAK2f,QAAQ,wBAA0Bzb,IACjFs3D,IACAA,EAAgB9yC,YAAclU,GAgBlCxU,KAAKi9C,cAAc,CACf/wC,KAAO,kCACP2F,WAAa2C,EACbhI,MAAQxM,KAAKohB,QAAQld,IAE7B,GAEA,CAAA4C,IAAA,qBAAAC,MAKA,WAAsB,IAAA00D,EAAA,KAMdx1D,EAAMjG,KAAKiH,SACf,GAAKhB,EAAL,CAIA,IAAIozD,EACAn1D,EA2BJ,IAAK,IAAIs2D,KA7BTx6D,KAAK45D,aAAe,CAAC,EAMrB3zD,EAAI0d,YAAY/Z,SACZ,SAAC4C,GACGtI,EAAKsI,EAAMmqD,WAGX9pC,EAAAA,EAAAA,SAAoB4uC,EAAKr6C,QAAQld,GAAIg1D,qBACrCuC,EAAKr6C,QAAQld,GAAIg1D,oBAAsB,KAGvCG,EAAa,UACWl5C,IAApB3T,EAAM+rD,YACNc,EAAa7sD,EAAM+rD,YACdkD,EAAK7B,aAAaP,IAAgB7vD,MAAM4E,QAAQqtD,EAAK7B,aAAaP,MACnEoC,EAAK7B,aAAaP,GAAc,IAEpCoC,EAAK7B,aAAaP,GAAYzzD,KAAK61D,EAAKr6C,QAAQld,IAExD,IAIJlE,KAAK24D,YAAc,EACnB34D,KAAKg3D,aAAe,GACDh3D,KAAK45D,aACpB,GAAI55D,KAAK45D,aAAalvD,eAAe8vD,GAEjC,IADA,IAAI96C,EAAS1f,KAAK45D,aAAaY,GACtB92C,EAAI,EAAGA,EAAIhE,EAAOte,OAAQsiB,IAE/B1jB,KAAKg3D,aAAa0B,QAAQh5C,EAAOgE,IAEjC1jB,KAAK24D,cAG8D,MAA/D34D,KAAKohB,QAAQ1B,EAAOgE,GAAGlX,MAAMmqD,WAAWuC,sBACxCl5D,KAAKohB,QAAQ1B,EAAOgE,GAAGlX,MAAMmqD,WAAWuC,oBAAsBx5C,EAAOgE,GAAGlX,MAAMuhB,GAC1E,iBACA,kBAAM0tC,EAAKhD,oBAAoB,KAOnD,GAAIz4D,KAAK64D,oBAAqB,CAE1B,IAAK,IAAI5vD,EAAQ,EAAGA,EAAQjJ,KAAK64D,oBAAoBviD,WAAWlV,OAAQ6H,IAAS,CAC7E,IAAMzC,EAAUxG,KAAK64D,oBAAoBviD,WAAWrN,GACjC,KAAfzC,EAAQtC,IAGZsC,EAAQiW,QACZ,CAEA,IAAK,IAAImK,EAAI,EAAGA,EAAI5mB,KAAKg3D,aAAa51D,OAAQwlB,IAAK,CAC/C,IAAIkxC,EAAe93D,KAAKg3D,aAAapwC,GACrC5mB,KAAK64D,oBAAoB1wD,YAAY2vD,EAAavvD,IACtD,CACJ,MACIlJ,GAAOqD,IAAI,2GAjEf,CAmEJ,GAEA,CAAAoE,IAAA,wBAAAC,MAMA,SAAuB9E,GACnB,IAII4H,EACA+H,EALA1N,EAAKjC,EAAEc,OAAOmB,GACdk1D,EAAU1uC,EAAAA,EAAWzhB,MAAM/E,GAC3B4zD,EAAe93D,KAAKohB,QAAQg4C,GAM5B8B,EAAQ1yD,SAASqL,eAAe5R,EAAEc,OAAOmB,IAC7C,GAAIg3D,EAAM5zC,UAAUw/B,SAAS,qBAYzB,OAXAoU,EAAM5zC,UAAU7K,OAAO,qBACvBy+C,EAAM5zC,UAAUtG,IAAI,sBAEpBnX,EAAQrB,SAASqL,eAAe7T,KAAK2f,QAAQ,sBACvC2H,UAAU7K,OAAO,yBAA0B,eACjD5S,EAAMyd,UAAUtG,IAAI,yBAA0B,oBAE9CpP,EAAOpJ,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAExC/N,EAAKk4B,WAAWrtB,UAMpBy+C,EAAM5zC,UAAUw/B,SAAS,uBACzBoU,EAAM5zC,UAAU7K,OAAO,qBACvBy+C,EAAM5zC,UAAUtG,IAAI,uBAGxBnX,EAAQrB,SAASqL,eAAe7T,KAAK2f,QAAQ,sBACvC2H,UAAU7K,OAAO,yBAA0B,cACjD5S,EAAMyd,UAAUtG,IAAI,yBAA0B,gBAE9CpP,EAAOpJ,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAExC/N,EAAKk4B,WAAWrtB,SAIpB,IAAIrM,EAAM,CACNlM,GAAKA,EACLiM,MAAQ2nD,EAAa3nD,MACrBxJ,YAAcmxD,EAAanxD,YAC3BquD,aAAe8C,EAAa9C,aAC5B7yC,SAAW21C,EAAa31C,SACxBszC,QAAUqC,EAAarC,SAGvBiG,EAAgB5D,EAAatrD,MAAMmvD,mBAEnCvrD,EAAIwrD,qBADJF,IAAkBpiB,IACS,KAEA/hB,KAAKC,MAAMkkC,EAAgB,OAE1D,IAAIG,EAAY77D,KAAK60D,iCAAiCzkD,GACtDvG,EAAMqlB,WAAW/mB,YAAY0zD,EACjC,GAEA,CAAA/0D,IAAA,oBAAAC,MAMA,SAAmB9E,GACf,IAAIi5D,EAAQj5D,EAAEc,OAAOmB,GACjBk1D,EAAU1uC,EAAAA,EAAWzhB,MAAMiyD,GAC3B1uD,EAAQxM,KAAKohB,QAAQg4C,GAAS5sD,MAIlCxM,KAAKiH,SAAS0c,YAAYlH,OAAOjQ,EACrC,GAEA,CAAA1F,IAAA,oBAAAC,MAMA,SAAmB9E,GACf,IAAIi5D,EAAQj5D,EAAEc,OAAOmB,GACjBk1D,EAAU1uC,EAAAA,EAAWzhB,MAAMiyD,GAE3Bt7D,EAAUI,KAAKohB,QAAQg4C,GACvB5sD,EAAQxM,KAAKohB,QAAQg4C,GAAS5sD,MAelCxM,KAAKi9C,cAAc,CACf/wC,KAAO,qBACPM,MAAQA,EACR5M,QAAUA,GAElB,GAEA,CAAAkH,IAAA,8BAAAC,MAMA,SAA6B9E,GAAG,IAAA65D,EAAA,KAC5Bz8D,GAAOE,MAAM0C,GAEb,IAAIgE,EAAMjG,KAAKiH,SAGX80D,EAAgBvzD,SAASilD,iBAAiB,6BAC1CuO,EAAYD,EAAc36D,OAE9BpB,KAAKg3D,aAAe,GACpB,IAAK,IAAI5hD,EAAI,EAAGA,EAAI2mD,EAAc36D,OAAQgU,IAAK,CAC3C,IAAIyR,EAAMk1C,EAAc3mD,GAAGlR,GACvBA,EAAKwmB,EAAAA,EAAWzhB,MAAM4d,GACtBra,EAAQxM,KAAKohB,QAAQld,GAAIsI,OAG7BqgB,EAAAA,EAAAA,SAAoB7sB,KAAKohB,QAAQld,GAAIg1D,qBACrCl5D,KAAKohB,QAAQld,GAAIg1D,oBAAsB,KAEnC1sD,EAAMosD,YAENpsD,EAAMosD,UAAUoD,GAChBh8D,KAAKg3D,aAAapxD,KAAK5F,KAAKohB,QAAQld,IACpC83D,KAIwC,MAAxCh8D,KAAKohB,QAAQld,GAAIg1D,sBACjBl5D,KAAKohB,QAAQld,GAAIg1D,oBAAsB1sD,EAAMuhB,GACzC,iBACA,kBAAM+tC,EAAKrD,oBAAoB,IAG3C,CAGAxyD,EAAIg2D,aAgBJj8D,KAAKi9C,cAAc,CACf/wC,KAAO,gCACP7H,SAAWpC,EAAEw7C,SACbjxC,MAAQxM,KAAKg3D,aAAa/0D,EAAEw7C,UAC5B/9B,OAAS1f,KAAKg3D,cAEtB,GAEA,CAAAlwD,IAAA,gCAAAC,MAMA,SAA+B9E,GAC3B5C,GAAO0jC,MAAM9gC,EACjB,GAEA,CAAA6E,IAAA,+BAAAC,MAKA,SAA8B9E,GAmC1B,SAASi6D,EAAyBnnD,EAAOhK,GAErC,IAAIoxD,EAnCR,SAA+BC,GAI3BA,EAAIC,YAAc,YAElB,IAAIC,EAAS9zD,SAASC,cAAc,UAChCmY,EAAM07C,EAAOC,WAAW,MAI5BH,EAAItkD,MAAQskD,EAAItkD,OAAS,IACzBskD,EAAIrzD,OAASqzD,EAAIrzD,QAAU,IAE3BuzD,EAAOxkD,MAAQskD,EAAItkD,MACnBwkD,EAAOvzD,OAASqzD,EAAIrzD,OACpB6X,EAAI47C,UAAUJ,EAAK,EAAG,GAKtB,IAHA,IAAIK,EAAY77C,EAAI87C,aAAa,EAAG,EAAGN,EAAItkD,MAAOskD,EAAIrzD,QAClDlJ,EAAO48D,EAAU58D,KAEZuV,EAAI,EAAGA,EAAIvV,EAAKuB,OAAQgU,GAAK,EAAG,CACrC,IAAIunD,GAAO98D,EAAKuV,GAAKvV,EAAKuV,EAAI,GAAKvV,EAAKuV,EAAI,IAAM,EAClDvV,EAAKuV,GAAKunD,EACV98D,EAAKuV,EAAI,GAAKunD,EACd98D,EAAKuV,EAAI,GAAKunD,CAClB,CAGA,OADA/7C,EAAIg8C,aAAaH,EAAW,EAAG,GACxBH,EAAOO,WAClB,CAKkBC,CAAqB/nD,GAMnCA,EAAMkB,IAAM,GACZlB,EAAMkB,IAAMkmD,CAChB,CAuBA,IAAIjB,EAAQj5D,EAAEc,OAAOmB,GACjBk1D,EAAU1uC,EAAAA,EAAWzhB,MAAMiyD,GAG3Bt+C,EADQ5c,KAAKohB,QAAQg4C,GAAS5sD,MACfuwD,YAEnB,GAAMngD,aAAkBogD,KAAiBpgD,aAAkBqgD,IAA3D,CAIA,IAAIC,GAAc,EACdj7D,EAAEc,OAAOukB,UAAUw/B,SAAS,wBAC5B7kD,EAAEc,OAAOukB,UAAU7K,OAAO,uBAC1Bxa,EAAEc,OAAOukB,UAAUtG,IAAI,wBAEvB/e,EAAEc,OAAOukB,UAAUtG,IAAI,uBACvB/e,EAAEc,OAAOukB,UAAU7K,OAAO,sBAC1BygD,GAAc,GAGdA,EACItgD,aAAkBogD,KAClBpgD,EAAOugD,qBAAuBvgD,EAAOmR,GAAG,kBA1ChD,SAAgCsuB,GAC5BA,EAAItnC,MAAMkiB,WAAWolC,YAAc,WACvC,IAyCQz/C,EAAOwgD,mBAAqBxgD,EAAOmR,GAAG,gBAjC9C,SAA8BsuB,GAC1B6f,EAAwB7f,EAAItnC,MAAMkiB,WAAYolB,EAAIt5C,OACtD,MAiCQ6Z,EAAOugD,qBAAuBvgD,EAAOmR,GAAG,iBAxChD,SAA+BsuB,GAC3BA,EAAIghB,KAAKpmC,WAAWolC,YAAc,WACtC,IAuCQz/C,EAAOwgD,mBAAqBxgD,EAAOmR,GAAG,eA/B9C,SAA6BsuB,GACzB6f,EAAwB7f,EAAIghB,KAAKpmC,WAAYolB,EAAIt5C,OACrD,OAgCI8pB,EAAAA,EAAAA,SAAoBjQ,EAAOugD,uBAC3BtwC,EAAAA,EAAAA,SAAoBjQ,EAAOwgD,oBAC3BxgD,EAAOugD,qBAAuB,KAC9BvgD,EAAOwgD,mBAAqB,MAIhCxgD,EAAO0gD,SA3BP,MAFI76D,QAAQ+Q,KAAK,sDA8BrB,GAEA,CAAA1M,IAAA,uBAAAC,MAKA,SAAsB9E,GAClB5C,GAAO0jC,MAAM9gC,GASb,IAAIs7D,EAAat7D,EAAEc,OAAOmB,GACtBs5D,EAAY9yC,EAAAA,EAAWzhB,MAAMs0D,GAC7B19D,EAAOG,KAAKohB,QAAQo8C,GAEpBhiC,EAAS,KACT96B,EAAQ,KAERuF,EAAMjG,KAAKiH,SAMf,IAAIpH,EAAK2M,MAAM9B,eAAe,oBACoB,gBAA7C7K,EAAK2M,MAAMixD,gBAAgB7kD,MAAM,KAAK,IACM,YAA7C/Y,EAAK2M,MAAMixD,gBAAgB7kD,MAAM,KAAK,IACO,YAA7C/Y,EAAK2M,MAAMixD,gBAAgB7kD,MAAM,KAAK,IACO,aAA7C/Y,EAAK2M,MAAMixD,gBAAgB7kD,MAAM,KAAK,GAmBtC,IAEI,IAAKwoB,EAAOiQ,iBACR,KAAM,gFAGV,IAAIqsB,EAAY79D,EAAK2M,MAAMnE,MAAQxI,EAAK2M,MAAMuwD,YAAY10D,KACtDs1D,EAAe99D,EAAK2M,MAAMurD,SAAWl4D,EAAK2M,MAAMuwD,YAAYhF,QAC5DjE,EAAU1yB,EAAOgQ,cAAcwsB,WAAWF,EAAWC,GACzD,IAAK7J,EACD,KAAM,mDAGV,IAAI+J,EAAoBz8B,EAAOgQ,cAAc0sB,qBAAqBhK,GAClE,GAAI+J,EAAmB,CACnB,IAAK53D,IAAQA,EAAImmB,UACb,OAEJ,IAAI2xC,EAAO93D,EAAImmB,UACX4xC,EAAYD,EAAK1xC,gBAIjB9H,EAAO,CACPs5C,EAAkBriC,OAAOnyB,KACzBw0D,EAAkBriC,OAAOpyB,OACzBy0D,EAAkBriC,OAAOlyB,MACzBu0D,EAAkBriC,OAAOryB,KAEzB80D,EAAYJ,EAAkBv5D,IAE7B25D,IACDA,EAAY,cAGhBziC,GAAS0iC,EAAAA,EAAAA,iBAAsB35C,EAAM05C,EAAWD,KAE5CD,EAAKI,IAAI3iC,EAEjB,CACJ,CAAE,MAAOv5B,GACLvB,EAAQuB,CACZ,MAzDA,GAAIgE,EAAImmB,WAAanmB,EAAIm4D,UAAW,CAChC,IAAIC,EAAex+D,EAAK2M,MAAM8xD,YAC9B,IAAKD,EAAc,CACf,IAAIzhD,EAAS/c,EAAK2M,MAAMuwD,YAEpBsB,EADAzhD,GAAUA,EAAO0hD,UACF1hD,EAAO0hD,YAEP1hD,EAAO2hD,cAAcD,WAE5C,CACID,GAAgBA,EAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,EAAcp4D,EAAIm4D,UAE5C,CA6DJp+D,KAAKi9C,cAAc,CACf/wC,KAAO,uBACPsvB,OAASA,EACThvB,MAAQ3M,EACRa,MAAQA,GAEhB,GAEA,CAAAoG,IAAA,gBAAAC,MAMA,SAAed,GAAK,IAAAu4D,EAAA,KAEhBv4D,EAAI0d,YAAY/Z,SACZ,SAAC4C,GACG,IAAItI,EAAKsI,EAAMmqD,UACf,GAAI6H,EAAKp9C,QAAQld,GAAK,CAClB,IAAI4zD,EAAe0G,EAAKp9C,QAAQld,GAI5Bs6D,EAAK3G,UAAUrrD,EAAOvG,KAAS6xD,EAAaE,SAC5CF,EAAaE,SAAU,EACZxvD,SAASqL,eAAe2qD,EAAK7+C,QAAQ,sBAAwBzb,IAC/DojB,UAAU7K,OAAO,gBAClB+hD,EAAK3G,UAAUrrD,EAAOvG,IAAQ6xD,EAAaE,UACnDF,EAAaE,SAAU,EACZxvD,SAASqL,eAAe2qD,EAAK7+C,QAAQ,sBAAwBzb,IAC/DojB,UAAUtG,IAAI,cAE/B,CACJ,GAER,GAMA,CAAAla,IAAA,gBAAAC,MAMA,SAAe03D,GACX,IAAIC,EAAU,KASd,OAPA1+D,KAAKiH,SAAS0c,YAAY/Z,SAAQ,SAAC4C,GAC3BA,IAAUiyD,IACVC,EAAUlyD,EAAM9B,eAAe,aAAe8B,EAAMmqD,UAAY,KAExE,IAGmB,OAAZ+H,EAAmB1+D,KAAK2f,QAAQ,sBAAwB++C,GAAW,IAC9E,GAEA,CAAA53D,IAAA,YAAAC,MAOA,SAAWyF,EAAOvG,GACd,GAAKA,EAAL,CAIA,IAAI04D,EAAgB14D,EAAImmB,UAAUwyC,gBAClC,GAAID,EAAgBnyD,EAAMmvD,oBAAsBgD,EAAgBnyD,EAAMqyD,mBAClE,OAAO,EAIX,IAAIC,EAAY74D,EAAImmB,UAAU2yC,gBAAgB94D,EAAIm4D,WAC9CY,EAAcxyD,EAAM8xD,YACxB,QAAIU,KAAgBC,EAAAA,EAAAA,YAAaH,EAAWE,GAV5C,CAeJ,GAEA,CAAAl4D,IAAA,eAAAC,MAMA,SAAcyF,GACV,IAAI0yD,EAAY,CAAC,EACjB,QAA4B/+C,IAAxB3T,EAAMk+B,oBAAmDvqB,IAApB3T,EAAMuwD,UAAyB,CACpE,IAAIoC,EAAkB3yD,EAAMk+B,gBACxBz0B,EAAMkpD,EAAgBviD,OACtB3G,IACAipD,EAAUjH,OAAShiD,EAAIgiD,QAAUkH,EAAgBhvD,OAASgvD,EAAgBj7D,IAAM,GAChFg7D,EAAUhH,aAAejiD,EAAIiiD,cAAgBiH,EAAgBx4D,aAAe,GAC5Eu4D,EAAU9G,cAAgBniD,EAAImiD,eAAiB+G,EAAgBnK,cAAgB,GAC/EkK,EAAU59C,UAAYrL,EAAIqL,WAAa69C,EAAgBh9C,UAAY,GACnE+8C,EAAU/G,SAAWliD,EAAIkiD,UAAYgH,EAAgB1J,SAAW,GAExE,CACA,OAAOyJ,CACX,I,8FAAC,CAl+CY,CAA+B73D,EAAAA,GAu+ChDnG,OAAOwX,OAAOy9C,GAAchxD,UAAWi6D,IACvCl+D,OAAOwX,OAAOy9C,GAAchxD,UAAWk6D,EAAAA,GAEvC,YAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQymC,cAAgBA,G,oGCvjDtC,SAAS/0B,EAAQxhC,GACb,KAAMI,gBAAgBohC,GAClB,MAAM,IAAIn9B,UAAU,IAAEgG,WAAW,oBAAqB,WAiB1D,GAXAjK,KAAKkF,UAAY,SAEjBlF,KAAKX,OAAS,IAAOC,UAAU,aAC/BU,KAAKX,OAAOE,MAAM,sCAOwB,OAAtBK,EAAQ6K,WAAmD,mBAAtB7K,EAAQ6K,WAE7D,MAAM,IAAIhL,MAAM,IAAEwK,WAAW,gBAAiB,gBAE7CrK,EAAQiM,QAAWjM,EAAQ0/D,mBAE5B1/D,EAAQiM,OAAS,QAErB7L,KAAKJ,QAAU,CAAC,EAChBI,KAAKJ,QAAQ6K,UAAY7K,EAAQ6K,UACjCzK,KAAKJ,QAAQe,UAAYf,EAAQe,UAGjCX,KAAKJ,QAAQ2/D,KAAO3/D,EAAQ2/D,OAAQ,EAGpCv/D,KAAKJ,QAAQ4/D,eAAkB5/D,EAAwB,iBACjD,CAACA,EAAQ0/D,kBACR91D,MAAM4E,QAAQxO,EAAQiM,QAEnB,IAAkBu1B,OAAO5hC,IAAII,EAAQiM,QADrC,IAAkBu1B,OAAO5hC,IAAII,EAAQiM,OAAO+M,MAAM,KAEhE,CAKAwoB,EAAOj8B,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAG1D,GAKAi8B,EAAOj8B,UAAUC,YAAcg8B,EAS/BA,EAAOj8B,UAAUoG,aAAe,SAAU7K,EAAO8K,GAE7CxL,KAAKw/D,eAAiBx/D,KAAKJ,QAAQ4/D,eAE9Bx/D,KAAKw/D,eAQVh0D,EAAQrM,KAAKa,KAAMA,KAAKw/D,gBAPpB9+D,EAAMvB,KAAKa,KAAM,IAAIP,MAAM,8BAQnC,EASA2hC,EAAOj8B,UAAU+F,YAAc,SAAUxK,EAAO8K,GACxCxL,KAAKJ,QAAQ2/D,KACbE,EAAkBtgE,KAAKa,KAAMU,EAAO8K,GAEpCk0D,EAAcvgE,KAAKa,KAAMU,EAAO8K,EAExC,EASA,IAAIk0D,EAAgB,SAAUh/D,EAAO8K,GAEjCxL,KAAK2/D,kBAAoB,GAGzB,IAAIC,EAAQ,KACZ,GAAsB,oBAAXr+D,OAAwB,CAC/B,IAAIC,EAAY,EAAQ,MACxBo+D,EAAQp+D,CACZ,MACIo+D,EAAQr+D,OAAO0hB,MAInB,IAAI48C,EAAgBrgE,GACTogE,EAAMpgE,EAAK,CAAE0jB,YAAc,gBAC7B5iB,MAAMC,IACH,GAAIA,EAASqB,GACT,OAAOrB,EAASuR,OACXxR,MAAMwR,GAGIA,IAEVrR,OAAOC,IACJ,MAAM,IAAIjB,MAAM,oBAAsBiB,EAAM,IAGpD,MAAM,IAAIjB,MAAM,oBAAsBc,EAASyB,OAAS,mBAC5D,IAEHvB,OAAOC,GACG,IAAII,SAAQ,CAACC,EAASC,KAEzBA,EAAON,EAAM,MAMzBo/D,EAAW,GACf,IAAK,IAAI72D,EAAQ,EAAGA,EAAQjJ,KAAKw/D,eAAep+D,OAAQ6H,IAAS,CAC7D,MAAMzJ,EAAMQ,KAAKw/D,eAAev2D,GAChC62D,EAASl6D,KAAKi6D,EAAargE,GAC/B,CAEAsB,QAAQkiB,IAAI88C,GACPx/D,MAAMgtB,IACH,IAAKA,EACD,MAAM,IAAI7tB,MAAM,2BAEpB6tB,EAAQ1jB,SAASqB,IAGbjL,KAAK2/D,kBAAkB/5D,KAAKqF,EAAO,GACrC,IAEL3K,MAAK,KACFkL,EAAQrM,KAAKa,KAAMA,KAAK2/D,kBAAkB,IAE7Cl/D,OAAOwB,IAGJvB,EAAMvB,KAAKa,KAAMiC,EAAE,GAE/B,EASIw9D,EAAoB,SAAU/+D,EAAO8K,GAErCxL,KAAK2/D,kBAAoB,GAIzB,IAAK,IAAIvqD,EAAI,EAAGA,EAAIpV,KAAKw/D,eAAep+D,OAAQgU,IAAK,CACjD,MAAM5V,EAAMQ,KAAKw/D,eAAepqD,GAG1BtK,EAAU,IAAI5I,eAGpB,GAFA4I,EAAQ3I,KAAK,MAAO3C,GAAK,GACzBsL,EAAQ5H,KAAK,MACU,MAAnB4H,EAAQ9I,OAAgB,CAGxB,IAAIzB,EAAWiD,KAAKC,MAAMqH,EAAQxH,cAClCtD,KAAK2/D,kBAAkB/5D,KAAKrF,EAChC,CACJ,CAEsC,IAAlCP,KAAK2/D,kBAAkBv+D,OACvBoK,EAAQrM,KAAKa,KAAMA,KAAK2/D,mBAExBj/D,EAAMvB,KAAKa,KAAM,IAAIP,MAAM,OAEnC,EASA2hC,EAAOj8B,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GAEhD,IAsCIu0D,EAtCc,SAAUC,GASxB,IAPA,IAAIC,EAAkB,CAAC,EAEnBC,EAAgB,CAAC,EAEjBC,EAAe,CAAC,EAGX/qD,EAAI,EAAGA,EAAI4qD,EAAQ5+D,OAAQgU,IAAK,CACrC,IAAK4qD,EAAQ5qD,GAAGgrD,iBAAmBJ,EAAQ5qD,GAAGsK,OAC1C,OAEJwgD,EAAgB,IACTA,KACAF,EAAQ5qD,GAAGgrD,eAAeC,SAEjCJ,EAAkB,IACXA,KACAD,EAAQ5qD,GAAGsK,QAElBygD,EAAe,IACRA,KACAH,EAAQ5qD,GAAGkrD,eAEtB,CASA,MAPmB,CACfF,eAAiB,CACbC,QAAUH,GAEdxgD,OAASugD,EACTK,eAAiBH,EAGzB,CAGiBI,CAAYvgE,KAAK2/D,mBAClC,GAAKI,EAAL,CAMA,IAAIS,EAAU,IAAI,IAElBt/D,OAAOwX,OAAO8nD,EAAST,GAGvB,IAAIhgE,EAA0B,oBAAXwB,OAAyBA,OAAS,CAAC,EAMtD,GALKxB,EAAMsvB,KACPtvB,EAAMsvB,GAAK,CAAC,GAIZtvB,EAAMsvB,GAAG+R,OAGT,IAAK,IAAIq/B,KAFTv/D,OAAOwX,OAAO3Y,EAAMsvB,GAAG+R,OAAQo/B,GAEVA,EACjBzgE,EAAMsvB,GAAG+R,OAAOq/B,GAAYD,EAAQC,QAGxC1gE,EAAMsvB,GAAG+R,OAASo/B,EAMtBh1D,EAAQrM,KAAKa,KAAMD,EAAMsvB,GAAG+R,OA3B5B,MAFI1gC,EAAMvB,KAAKa,KAAM,IAAIP,MAAM,0CA8BnC,EAEA,S,qGCtMA,QAlGqB,CA+CjBqlB,MAAQ,SAAUllB,GAMd,GAJa,IAAON,UAAU,kBACvBC,MAAM,CAAC,6BAGTK,EACD,MAAM,IAAIH,MAAM,IAAEwK,WAAW,cAAe,YAKhD,IAAKrK,EAAQsM,KACT,MAAM,IAAIzM,MAAM,IAAEwK,WAAW,cAAe,+BAKhD,IAAIy2D,EAAa,KACjB,OAAQ9gE,EAAQsM,MACZ,IAAK,YAEDtM,EAAQ2lB,IAAIo7C,WAAa,kBACzBD,EAAa,IAAI,EAAAh7C,EAAqB9lB,EAAQqmB,OAC9C,MACJ,IAAK,SAEDrmB,EAAQ2lB,IAAIo7C,WAAa,sBACzBD,EAAa,IAAI,EAAAh7C,EAAkB9lB,EAAQqmB,OAC3C,MACJ,QACI,MAAM,IAAIxmB,MAAM,IAAEwK,WAAW,aAAc,+BAInD,IAAI7K,EAAW,CACXS,KAAO6gE,EACPhhE,OAASE,EAAQF,OACjBumB,MAAQrmB,EAAQ2lB,KAGhBq7C,EAAU,IAAI,IAAIxhE,GAEtB,IAAKwhE,EAAQlyB,uBACT,MAAM,IAAIjvC,MAAM,+BAGpB,OAAOmhE,EAAQnyB,aACnB,E,8BC3GJ,IAAIoyB,EAAc,EAAQ,MACtBv7B,EAAI,EAAQ,MACZw7B,EAAS,EAAQ,MAEjBC,EAAgCF,EAAYE,8BAC5CC,EAAiBH,EAAYG,eAC7BC,EAAuBJ,EAAYI,qBACnCC,EAASL,EAAYK,OACrBC,EAAYN,EAAYM,UACxB3gC,EAAasgC,EAAOtgC,WACpBjC,EAAeuiC,EAAOviC,aAe1B,SAAS6iC,IAAa,CAEtBA,EAAUj8D,UAAY,CACrB1B,MAAO,SAAUmZ,EAAQykD,EAAcC,GACtC,IAAIC,EAAavhE,KAAKuhE,WACtBA,EAAWC,gBACXC,EAAMJ,EAAeA,EAAengE,OAAOmjB,OAAO,OAepD,SAAezH,EAAQ8kD,EAAkBJ,EAAWC,EAAYI,GAC/D,IAAIC,EAASZ,EAAeO,EAAWM,UACnCjlD,EAAOnD,QAAQ6rB,EAAEnR,gCAAkC,GACtDwtC,EAAaG,QAAQ,mEAGtB,SAASC,EAAkBnjC,GAG1B,GAAIA,EAAO,MAAQ,CAElB,IAAIojC,EAAa,QADjBpjC,GAAQ,QAC2B,IAClCqjC,EAAa,OAAiB,KAAPrjC,GAExB,OAAOsjC,OAAOC,aAAaH,EAAYC,EACxC,CACC,OAAOC,OAAOC,aAAavjC,EAE7B,CAEA,SAASwjC,EAAe7nD,GACvB,IAAI8nD,EAA+B,MAApB9nD,EAAEA,EAAEnZ,OAAS,GAAamZ,EAAIA,EAAI,IACjD,IAAKqnD,GAAUS,IAAa9nD,EAE3B,OADAonD,EAAajhE,MAAM,0BACZ6Z,EAER,IAAI7G,EAAQ4xB,EAAEnU,UAAUrB,KAAKuyC,GAC7B,IAAK3uD,GAASA,EAAM,GAAGtS,SAAWihE,EAASjhE,OAE1C,OADAugE,EAAajhE,MAAM,6CAA+C6Z,GAC3DA,EAER,IAAI5U,EAAI08D,EAASp0D,MAAM,GAAI,GAC3B,OAAIizD,EAAOI,EAAW37D,GACd27D,EAAU37D,GACS,MAAhBA,EAAE4oC,OAAO,GACZwzB,EAAkBp6C,SAAShiB,EAAEmR,UAAU,GAAGzI,QAAQ,IAAK,SAE9DszD,EAAajhE,MAAM,oBAAsB6Z,GAClCA,EAET,CAEA,SAAS+nD,EAAWz5C,GAEnB,GAAIA,EAAMD,EAAO,CAChB,IAAI25C,EAAK3lD,EAAO9F,UAAU8R,EAAOC,GAAKxa,QAAQm0D,EAAYJ,GAC1D3hC,GAAWp8B,EAASukB,GACpB24C,EAAWkB,WAAWF,EAAI,EAAG15C,EAAMD,GACnCA,EAAQC,CACT,CACD,CAEA,IAAI65C,EAAY,EACZC,EAAU,EACVC,EAAc,cACdniC,EAAU8gC,EAAW9gC,QAEzB,SAASp8B,EAAS23C,EAAG5N,GACpB,KAAO4N,GAAK2mB,IAAYv0B,EAAIw0B,EAAY9yC,KAAKlT,KAC5C8lD,EAAYC,EACZA,EAAUv0B,EAAEnlC,MAAQmlC,EAAE,GAAGhtC,OACzBq/B,EAAQoiC,aAETpiC,EAAQqiC,aAAe9mB,EAAI0mB,EAAY,CACxC,CAEA,IAAIK,EAAa,CAAC,CAAEC,aAActB,IAC9BuB,EAAe,GACfr6C,EAAQ,EACZ,OAAa,CACZ,IACC,IAAIs6C,EAAWtmD,EAAOnD,QAAQ,IAAKmP,GACnC,GAAIs6C,EAAW,EAAG,CACjB,IAAKtB,GAAUqB,EAAa7hE,OAAS,EACpC,OAAOugE,EAAawB,WAAW,wBAA0BF,EAAan9D,KAAK,OAE5E,IAAK8W,EAAO9F,UAAU8R,GAAOlV,MAAM,SAAU,CAC5C,IAAI0vD,EAAM7B,EAAW6B,IACjBvhE,EAAOuhE,EAAIC,eAAezmD,EAAO9F,UAAU8R,IAC/C,GAAIw6C,EAAItvD,gBACP,OAAO6tD,EAAajhE,MAAM,4CAE3B0iE,EAAIj7D,YAAYtG,GAChB0/D,EAAW+B,eAAiBzhE,CAC7B,CACA,MACD,CACA,GAAIqhE,EAAWt6C,EAAO,CACrB,IAAI26C,EAAa3mD,EAAO9F,UAAU8R,EAAOs6C,GACpCtB,GAAkC,IAAxBqB,EAAa7hE,SAC3BmiE,EAAaA,EAAWl1D,QAAQ,IAAIwhB,OAAOyV,EAAE1U,MAAMhU,OAAQ,KAAM,MACnD+kD,EAAajhE,MAAM,6CAA+C6iE,EAAa,KAE9FjB,EAAWY,EACZ,CACA,OAAQtmD,EAAO2xB,OAAO20B,EAAW,IAChC,IAAK,IACJ,IAAIr6C,EAAMjM,EAAOnD,QAAQ,IAAKypD,EAAW,GACrCM,EAAa5mD,EAAO9F,UAAUosD,EAAW,EAAGr6C,EAAM,EAAIA,OAAM1I,GAChE,IAAKqjD,EACJ,OAAO7B,EAAawB,WAAW,wBAEhC,IAAIM,EAAe56C,EAAM,GAAKyc,EAAEnV,IAAI,IAAKmV,EAAE5T,YAAa4T,EAAE1U,MAAO,KAAKd,KAAK0zC,GAC3E,IAAKC,EACJ,OAAO9B,EAAawB,WAAW,8CAAgDK,EAAa,KAE7F,IAAKjC,EAAW+B,iBAAmB/B,EAAW6B,IAAItvD,gBAGjD,OAED,IAAI4vD,EACHT,EAAaA,EAAa7hE,OAAS,IACnCmgE,EAAW+B,eAAe9sD,SAC1B+qD,EAAW6B,IAAItvD,gBAAgB0C,SAC/B,GACD,GAAIktD,IAAmBD,EAAa,GAAI,CACvC,IAAIE,EAAeF,EAAa,GAAG17D,cACnC,IAAK65D,GAAU8B,EAAe37D,gBAAkB47D,EAC/C,OAAOhC,EAAawB,WAAW,qCAAuCO,EAAiB,SAAWF,EAAa,IAEjH,CACA,IAAIrM,EAAS4L,EAAWa,MACxBX,EAAaW,MACb,IAAIC,EAAa1M,EAAO0M,WAExB,GADAtC,EAAWuC,WAAW3M,EAAO4M,IAAK5M,EAAO6M,UAAWN,GAChDG,EACH,IAAK,IAAII,KAAUJ,EACd3C,EAAO2C,EAAYI,IACtB1C,EAAW2C,iBAAiBD,GAK/Bp7C,IACA,MAED,IAAK,IACJ4X,GAAWp8B,EAAS6+D,GACpBr6C,EAAMs7C,EAA2BvnD,EAAQsmD,EAAU3B,EAAYI,GAC/D,MACD,IAAK,IACJlhC,GAAWp8B,EAAS6+D,GACpBr6C,EAAMu7C,EAA2BxnD,EAAQsmD,EAAU3B,EAAYI,EAAcC,GAC7E,MACD,QACCnhC,GAAWp8B,EAAS6+D,GACpB,IAAIjsD,EAAK,IAAIotD,EACTrB,EAAeD,EAAWA,EAAW3hE,OAAS,GAAG4hE,aAGjDsB,GADAz7C,EAAM07C,EAAsB3nD,EAAQsmD,EAAUjsD,EAAI+rD,EAAcZ,EAAgBT,EAAcC,GACxF3qD,EAAG7V,QASb,GAPK6V,EAAGutD,SACH5C,GAAUf,EAAY4D,kBAAkBxtD,EAAGT,SAC9CS,EAAGutD,QAAS,EAEZvB,EAAar9D,KAAKqR,EAAGT,UAGnBiqB,GAAW6jC,EAAK,CAGnB,IAFA,IAAII,EAAWC,EAAYlkC,EAAS,CAAC,GAE5BrrB,EAAI,EAAGA,EAAIkvD,EAAKlvD,IAAK,CAC7B,IAAImF,EAAItD,EAAG7B,GACX/Q,EAASkW,EAAE5Q,QACX4Q,EAAEkmB,QAAUkkC,EAAYlkC,EAAS,CAAC,EACnC,CACA8gC,EAAW9gC,QAAUikC,EACjBE,EAAc3tD,EAAIsqD,EAAYyB,IACjCD,EAAWn9D,KAAKqR,GAEjBsqD,EAAW9gC,QAAUA,CACtB,MACKmkC,EAAc3tD,EAAIsqD,EAAYyB,IACjCD,EAAWn9D,KAAKqR,GAId2qD,IAAW3qD,EAAGutD,OACjB37C,EAAMg8C,EAAwBjoD,EAAQiM,EAAK5R,EAAGT,QAAS4rD,EAAgBb,GAEvE14C,IAGJ,CAAE,MAAO5mB,GACR,GAAIA,aAAau+B,EAChB,MAAMv+B,EACA,GAAIA,aAAas8B,EACvB,MAAM,IAAIiC,EAAWv+B,EAAEoG,KAAO,KAAOpG,EAAEH,QAASy/D,EAAW9gC,QAASx+B,GAErE0/D,EAAajhE,MAAM,wBAA0BuB,GAC7C4mB,GAAO,CACR,CACIA,EAAMD,EACTA,EAAQC,EAGRy5C,EAAW/qC,KAAK5kB,IAAIuwD,EAAUt6C,GAAS,EAEzC,CACD,CAvNEnlB,CAAMmZ,EAAQykD,EAAcC,EAAWC,EAAYvhE,KAAK2hE,cACxDJ,EAAWuD,aACZ,GAUD,IAAItC,EAAa,YA6MjB,SAASmC,EAAYrqC,EAAGyqC,GAGvB,OAFAA,EAAElC,WAAavoC,EAAEuoC,WACjBkC,EAAEjC,aAAexoC,EAAEwoC,aACZiC,CACR,CAOA,SAASR,EAAsB3nD,EAAQgM,EAAO3R,EAAI+rD,EAAcZ,EAAgBT,EAAcC,GAM7F,SAASoD,EAAaC,EAAOl+D,EAAO2pD,GACnC,OAAIwQ,EAAOjqD,EAAGiuD,eAAgBD,GACtBtD,EAAawB,WAAW,aAAe8B,EAAQ,eAElDrD,GAAU76D,EAAM0S,QAAQ,MAAQ,EAC7BkoD,EAAawB,WAAW,uDAEhClsD,EAAGkuD,SACFF,EAKAl+D,EAAMsH,QAAQ,YAAa,KAAKA,QAAQm0D,EAAYJ,GACpD1R,EAEF,CAMA,IAJA,IAAI0U,EAEAppB,IAAMpzB,EACN8mB,EA/QO,IAgRE,CACZ,IAAIvY,EAAIva,EAAO2xB,OAAOyN,GACtB,OAAQ7kB,GACP,IAAK,IACJ,GAnRS,IAmRLuY,EAEH01B,EAAWxoD,EAAO3O,MAAM2a,EAAOozB,GAC/BtM,EApRM,MAqRA,IAtRQ,IAsRJA,EAIV,MAAM,IAAIjwC,MAAM,uCAHhBiwC,EAtRM,CA0RP,CACA,MACD,IAAK,IACL,IAAK,IACJ,GA9RO,IA+RNA,GAjSQ,IAkSRA,EACC,CAQD,GA3SQ,IAqSJA,IACHiyB,EAAaG,QAAQ,kCACrBsD,EAAWxoD,EAAO3O,MAAM2a,EAAOozB,IAEhCpzB,EAAQozB,EAAI,KACZA,EAAIp/B,EAAOnD,QAAQ0d,EAAGvO,IACd,GAMP,MAAM,IAAInpB,MAAM,2BAA6B03B,EAAI,WAJjD6tC,EAAaI,EADbr+D,EAAQ6V,EAAO3O,MAAM2a,EAAOozB,GACEpzB,EAAQ,GACtC8mB,EA1SW,CA+Sb,KAAO,IAhTe,GAgTXA,EAQV,MAAM,IAAIjwC,MAAM,kCANhBulE,EAAaI,EADbr+D,EAAQ6V,EAAO3O,MAAM2a,EAAOozB,GACEpzB,GAC9B+4C,EAAaG,QAAQ,cAAgBsD,EAAW,uBAAyBjuC,EAAI,OAC7EvO,EAAQozB,EAAI,EACZtM,EApTY,CAwTb,CACA,MACD,IAAK,IACJ,OAAQA,GACP,KAjUO,EAkUNz4B,EAAGouD,WAAWzoD,EAAO3O,MAAM2a,EAAOozB,IACnC,KA9TY,EA+TZ,KA9Ta,EA+Tb,KA9Ta,EA+TZtM,EA/TY,EAgUZz4B,EAAGutD,QAAS,EACb,KApUqB,EAqUrB,KAxUQ,EAyUP,MACD,KAzUc,EA0UbvtD,EAAGutD,QAAS,EACZ,MAED,QACC,MAAM,IAAI/kE,MAAM,qCAElB,MACD,IAAK,GAKJ,OAJAkiE,EAAajhE,MAAM,2BApVX,GAqVJgvC,GACHz4B,EAAGouD,WAAWzoD,EAAO3O,MAAM2a,EAAOozB,IAE5BA,EACR,IAAK,IACJ,OAAQtM,GACP,KA3VO,EA4VNz4B,EAAGouD,WAAWzoD,EAAO3O,MAAM2a,EAAOozB,IACnC,KAxVY,EAyVZ,KAxVa,EAyVb,KAxVa,EAyVZ,MACD,KA7VqB,EA8VrB,KAjWQ,EAmWiB,OADxBj1C,EAAQ6V,EAAO3O,MAAM2a,EAAOozB,IAClB/tC,OAAO,KAChBgJ,EAAGutD,QAAS,EACZz9D,EAAQA,EAAMkH,MAAM,GAAI,IAE1B,KAtWc,MAuWTyhC,IACH3oC,EAAQq+D,GAtWW,GAwWhB11B,GACHiyB,EAAaG,QAAQ,cAAgB/6D,EAAQ,qBAC7Ci+D,EAAaI,EAAUr+D,EAAO6hB,KAEzBg5C,GACJD,EAAaG,QAAQ,cAAgB/6D,EAAQ,qBAAuBA,EAAQ,eAE7Ei+D,EAAaj+D,EAAOA,EAAO6hB,IAE5B,MACD,KAnXM,EAoXL,IAAKg5C,EACJ,OAAOD,EAAawB,WAAW,8BAGlC,OAAOnnB,EAER,IAAK,IACJ7kB,EAAI,IACL,QACC,GAAIA,GAAK,IAER,OAAQuY,GACP,KAnYM,EAoYLz4B,EAAGouD,WAAWzoD,EAAO3O,MAAM2a,EAAOozB,IAClCtM,EA/XW,EAgYX,MACD,KAtYO,EAuYN01B,EAAWxoD,EAAO3O,MAAM2a,EAAOozB,GAC/BtM,EAvYY,EAwYZ,MACD,KAvYoB,EAwYnB,IAAI3oC,EAAQ6V,EAAO3O,MAAM2a,EAAOozB,GAChC2lB,EAAaG,QAAQ,cAAgB/6D,EAAQ,sBAC7Ci+D,EAAaI,EAAUr+D,EAAO6hB,GAC/B,KA1YW,EA2YV8mB,EA1YW,OAuZb,OAAQA,GAIP,KA/Za,EAgaPkyB,GACJD,EAAaG,QAAQ,cAAgBsD,EAAW,qBAAuBA,EAAW,gBAEnFJ,EAAaI,EAAUA,EAAUx8C,GACjCA,EAAQozB,EACRtM,EAtaM,EAuaN,MACD,KApaW,EAqaViyB,EAAaG,QAAQ,+BAAiCsD,EAAW,OAClE,KAraY,EAsaX11B,EA3aM,EA4aN9mB,EAAQozB,EACR,MACD,KA5aK,EA6aJtM,EA5amB,EA6anB9mB,EAAQozB,EACR,MACD,KA5aY,EA6aX,MAAM,IAAIv8C,MAAM,+DAIrBu8C,GACD,CACD,CAMA,SAAS4oB,EAAc3tD,EAAIsqD,EAAYyB,GAItC,IAHA,IAAIxsD,EAAUS,EAAGT,QACbqtD,EAAa,KACbzuD,EAAI6B,EAAG7V,OACJgU,KAAK,CACX,IAAImF,EAAItD,EAAG7B,GACPkwD,EAAQ/qD,EAAE+qD,MACVv+D,EAAQwT,EAAExT,MAEd,IADIw+D,EAAMD,EAAM7rD,QAAQ,MACd,EACT,IAAIwqD,EAAU1pD,EAAE0pD,OAASqB,EAAMr3D,MAAM,EAAGs3D,GACpCvB,EAAYsB,EAAMr3D,MAAMs3D,EAAM,GAC9BC,EAAsB,UAAXvB,GAAsBD,OAErCA,EAAYsB,EACZrB,EAAS,KACTuB,EAAqB,UAAVF,GAAqB,GAGjC/qD,EAAEypD,UAAYA,GAEG,IAAbwB,IAEe,MAAd3B,IACHA,EAAa3iE,OAAOmjB,OAAO,MAC3Bo9C,EAAMuB,EAAeA,EAAe9hE,OAAOmjB,OAAO,QAEnD2+C,EAAawC,GAAY3B,EAAW2B,GAAYz+D,EAChDwT,EAAEwpD,IAAM5C,EAAUsE,MAClBlE,EAAWmE,mBAAmBF,EAAUz+D,GAE1C,CAEA,IADIqO,EAAI6B,EAAG7V,OACJgU,MACNmF,EAAItD,EAAG7B,IACD6uD,SAEY,QAAb1pD,EAAE0pD,SACL1pD,EAAEwpD,IAAM5C,EAAUwE,KAEF,UAAbprD,EAAE0pD,SACL1pD,EAAEwpD,IAAMf,EAAazoD,EAAE0pD,UAI1B,IAAIsB,KAAM/uD,EAAQiD,QAAQ,MAChB,GACTwqD,EAAShtD,EAAGgtD,OAASztD,EAAQvI,MAAM,EAAGs3D,GACtCvB,EAAY/sD,EAAG+sD,UAAYxtD,EAAQvI,MAAMs3D,EAAM,KAE/CtB,EAAS,KACTD,EAAY/sD,EAAG+sD,UAAYxtD,GAG5B,IAAIovD,EAAM3uD,EAAG8sD,IAAMf,EAAaiB,GAAU,IAI1C,GAHA1C,EAAWsE,aAAaD,EAAI5B,EAAWxtD,EAASS,IAG5CA,EAAGutD,OAaN,OAHAvtD,EAAG+rD,aAAeA,EAClB/rD,EAAG4sD,WAAaA,GAET,EAXP,GADAtC,EAAWuC,WAAW8B,EAAI5B,EAAWxtD,GACjCqtD,EACH,IAAKI,KAAUJ,EACV3C,EAAO2C,EAAYI,IACtB1C,EAAW2C,iBAAiBD,EAUjC,CAEA,SAASY,EAAwBjoD,EAAQkpD,EAAYtvD,EAAS4rD,EAAgBb,GAK7E,IAAIwE,EAAiBhF,EAA8BvqD,GACnD,GAAIuvD,GAAkB9E,EAAqBzqD,GAAU,CACpD,IAAIwvD,EAAappD,EAAOnD,QAAQ,KAAOjD,EAAU,IAAKsvD,GAClDjkE,EAAO+a,EAAO9F,UAAUgvD,EAAa,EAAGE,GAM5C,OAJID,IACHlkE,EAAOA,EAAKwM,QAAQm0D,EAAYJ,IAEjCb,EAAWkB,WAAW5gE,EAAM,EAAGA,EAAKT,QAC7B4kE,CACR,CACA,OAAOF,EAAa,CACrB,CAEA,SAASrE,EAAM7kD,EAAQ7Z,GACtB,IAAK,IAAI4mB,KAAK/M,EACTskD,EAAOtkD,EAAQ+M,KAClB5mB,EAAO4mB,GAAK/M,EAAO+M,GAGtB,CAyCA,SAASs8C,EAAWrpD,EAAQgM,GAC3B,IAAI3f,EAAQ2f,EAEZ,SAASs9C,EAAKv8C,GAEb,OADAA,EAAIA,GAAK,EACF/M,EAAO2xB,OAAOtlC,EAAQ0gB,EAC9B,CAEA,SAASw8C,EAAKx8C,GAEb1gB,GADA0gB,EAAIA,GAAK,CAEV,CAcA,SAASy8C,IACR,OAAOxpD,EAAO9F,UAAU7N,EACzB,CAiBA,MAAO,CACNi9D,KAAMA,EACN94B,SAAU,WACT,OAAOnkC,CACR,EACAo9D,SAdD,SAAkBl4D,GACjB,IACIuF,EADO4xB,EAAEnV,IAAI,IAAKhiB,GACL2hB,KAAKs2C,KACtB,OAAI1yD,GACHyyD,EAAKzyD,EAAM,GAAGtS,QACPsS,EAAM,IAEP,IACR,EAOCqpD,UAAW,WACV,OAAOngD,CACR,EACAupD,KAAMA,EACNG,WAzCD,WAEC,IADA,IAAIC,EAAS,EACNt9D,EAAQ2T,EAAOxb,QAAQ,CAC7B,IAAI+1B,EAAI+uC,IACR,GAAU,MAAN/uC,GAAmB,OAANA,GAAoB,OAANA,GAAoB,OAANA,EAC5C,OAAOovC,EAERA,IACAJ,GACD,CACA,OAAQ,CACT,EA+BCC,mBAAoBA,EACpBI,oBA5BD,SAA6B3kE,GAC5B,OAAO+a,EAAO9F,UAAU7N,EAAOA,EAAQpH,EAAKT,UAAYS,CACzD,EA2BC4kE,mCA1BD,SAA4C5kE,GAC3C,OAAO+a,EAAO9F,UAAU7N,EAAOA,EAAQpH,EAAKT,QAAQuJ,gBAAkB9I,EAAK8I,aAC5E,EA0BD,CA4FA,SAASy5D,EAA2BxnD,EAAQgM,EAAO24C,EAAYI,EAAcC,GAC5E,IAAI5lB,EAAIiqB,EAAWrpD,EAAQgM,GAE3B,OAAQg5C,EAAS5lB,EAAEkqB,KAAK,GAAGv7D,cAAgBqxC,EAAEkqB,KAAK,IACjD,IAAK,IAEJ,IAAIQ,EAAU1qB,EAAEqqB,SAAS/gC,EAAEtT,SAC3B,OAAI00C,GACHnF,EAAWmF,QAAQA,EAASphC,EAAEvT,cAAc3wB,OAAQslE,EAAQtlE,OAASkkC,EAAEvT,cAAc3wB,OAASkkC,EAAErR,YAAY7yB,QACrG46C,EAAE5O,YAEFu0B,EAAawB,WAAW,0CAA4CnnB,EAAE5O,YAE/E,IAAK,IAEJ,IAAIu5B,EAAQ3qB,EAAEqqB,SAAS/gC,EAAExR,QACzB,OAAI6yC,EACE/E,GAAWL,EAAW+B,gBAG3B/B,EAAWqF,aACXrF,EAAWkB,WAAWkE,EAAOrhC,EAAEvR,YAAY3yB,OAAQulE,EAAMvlE,OAASkkC,EAAEvR,YAAY3yB,OAASkkC,EAAEtR,UAAU5yB,QACrGmgE,EAAWsF,WACJ7qB,EAAE5O,YALDu0B,EAAawB,WAAW,4BAOzBxB,EAAawB,WAAW,sCAAwCv6C,GAEzE,IAAK,IAEJ,GAAI24C,EAAW6B,KAAO7B,EAAW6B,IAAItvD,gBACpC,OAAO6tD,EAAawB,WAAW,mEAAqEnnB,EAAE5O,YAEvG,GAAIw0B,GAAU5lB,EAAEyqB,mCAAmCnhC,EAAEpR,qBAAuB8nB,EAAEwqB,oBAAoBlhC,EAAEpR,oBACnG,OAAOytC,EAAawB,WAAW,YAAc79B,EAAEpR,mBAAqB,gBAAkB8nB,EAAE5O,YAGzF,GADA4O,EAAEmqB,KAAK7gC,EAAEpR,mBAAmB9yB,QACxB46C,EAAEsqB,aAAe,EACpB,OAAO3E,EAAawB,WAAW,6BAA+B79B,EAAEpR,mBAAqB,gBAAkB8nB,EAAE5O,YAG1G,IAAI05B,EAAU,CACbz+D,UAAM8X,EACN4mD,cAAU5mD,EACV6mD,cAAU7mD,EACV8mD,oBAAgB9mD,GAIjB,GADA2mD,EAAQz+D,KAAO2zC,EAAEqqB,SAAS/gC,EAAEvU,OACvB+1C,EAAQz+D,KACZ,OAAOs5D,EAAawB,WAAW,sEAAwEnnB,EAAE5O,YAQ1G,GANIw0B,GAAyC,SAA/BkF,EAAQz+D,KAAKN,eAC1B45D,EAAaG,QAAQ,mDAAqD9lB,EAAE5O,YAE7E4O,EAAEsqB,aAGEtqB,EAAEwqB,oBAAoBlhC,EAAExS,SAAWkpB,EAAEwqB,oBAAoBlhC,EAAEzS,QAAS,CACvE,IAAInf,EAAQ4xB,EAAEtS,iBAAiBlD,KAAKksB,EAAEoqB,sBACtC,IAAK1yD,EACJ,OAAOiuD,EAAawB,WAAW,sDAAwDnnB,EAAE5O,iBAEnDjtB,IAAnCzM,EAAMwzD,OAAOC,kBAChBL,EAAQE,SAAWtzD,EAAMwzD,OAAOC,mBAEhCL,EAAQE,SAAWtzD,EAAMwzD,OAAOv1C,cAChCm1C,EAAQC,SAAWrzD,EAAMwzD,OAAOp1C,cAEjCkqB,EAAEmqB,KAAKzyD,EAAM,GAAGtS,OACjB,MAAO,GAAIwgE,GAAU5lB,EAAEyqB,mCAAmCnhC,EAAEzS,QAAS,CAGpE,GADAmpB,EAAEmqB,KAAK7gC,EAAEzS,OAAOzxB,QACZ46C,EAAEsqB,aAAe,EACpB,OAAO3E,EAAawB,WAAW,6BAA+B79B,EAAEzS,OAAS,gBAAkBmpB,EAAE5O,YAG9F,GADA05B,EAAQE,SAAWhrB,EAAEqqB,SAAS/gC,EAAE1S,oCAC3Bk0C,EAAQE,SACZ,OAAOrF,EAAawB,WACnB,YAAc79B,EAAE3S,oBAAsB,qCAAuC2S,EAAEzS,OAAS,gBAAkBmpB,EAAE5O,WAG/G,CASA,OARIw0B,GAAUkF,EAAQE,WAAa1hC,EAAE1S,kCAAkChf,KAAKkzD,EAAQE,WACnFrF,EAAaG,QAAQ,4DAA8D9lB,EAAE5O,YAEjFw0B,IACJ5lB,EAAEsqB,aACFQ,EAAQG,eA5KZ,SAAoCjrB,EAAG2lB,GAMtC,SAASyF,EAAQprB,EAAG2lB,GACnB,IAAIjuD,EAAQ4xB,EAAE1T,GAAG9B,KAAKksB,EAAEoqB,sBACxB,OAAK1yD,EAG0B,QAA3BA,EAAM,GAAG3L,cACL45D,EAAawB,WACnB,uFAAyFnnB,EAAE5O,aAG7F4O,EAAEmqB,KAAKzyD,EAAM,GAAGtS,QACTsS,EAAM,IARLiuD,EAAawB,WAAW,yDAA2DnnB,EAAE5O,WAS9F,CAEA,IAAIxwB,EAASo/B,EAAE+gB,YACf,GAAiB,MAAb/gB,EAAEkqB,OAAgB,CACrBlqB,EAAEmqB,KAAK,GAEP,IADA,IAAIkB,EAAiBrrB,EAAE5O,WAChB4O,EAAE5O,WAAaxwB,EAAOxb,QAAQ,CAEpC,GADA46C,EAAEsqB,aACe,MAAbtqB,EAAEkqB,OAAgB,CACrB,IAAIe,EAAiBrqD,EAAO9F,UAAUuwD,EAAgBrrB,EAAE5O,YAExD,OADA4O,EAAEmqB,KAAK,GACAc,CACR,CACA,IAAIv/C,EAAU,KAKd,GAAiB,MAAbs0B,EAAEkqB,QAAgC,MAAdlqB,EAAEkqB,KAAK,GAC9B,OAAQlqB,EAAEkqB,KAAK,IACd,IAAK,IACc,MAAdlqB,EAAEkqB,KAAK,GACVx+C,EAAUs0B,EAAEqqB,SAAS/gC,EAAElT,aACC,MAAd4pB,EAAEkqB,KAAK,KACjBx+C,EAAUs0B,EAAEqqB,SAAS/gC,EAAEjS,aAExB,MACD,IAAK,IACJ3L,EAAUs0B,EAAEqqB,SAAS/gC,EAAE5S,aACvB,MACD,IAAK,IACJhL,EAAUs0B,EAAEqqB,SAAS/gC,EAAE/R,cACvB,MACD,IAAK,IACJ7L,EAAUs0B,EAAEqqB,SAAS/gC,EAAEtT,cAGnB,GAAiB,MAAbgqB,EAAEkqB,QAAgC,MAAdlqB,EAAEkqB,KAAK,GACrCx+C,EAAU0/C,EAAQprB,EAAG2lB,OACf,IAAiB,MAAb3lB,EAAEkqB,OAGZ,OAAOvE,EAAawB,WAAW,wCAF/Bz7C,EAAUs0B,EAAEqqB,SAAS/gC,EAAElU,YAGxB,CACA,IAAK1J,EACJ,OAAOi6C,EAAawB,WAAW,wCAA0CnnB,EAAE5O,WAE7E,CACA,OAAOu0B,EAAawB,WAAW,wDAChC,CACD,CAwG6BmE,CAA2BtrB,EAAG2lB,IAExD3lB,EAAEsqB,aACe,MAAbtqB,EAAEkqB,OACEvE,EAAawB,WAAW,6CAA+CnnB,EAAE5O,aAEjF4O,EAAEmqB,KAAK,GACP5E,EAAWgG,SAAST,EAAQz+D,KAAMy+D,EAAQC,SAAUD,EAAQE,SAAUF,EAAQG,gBAC9E1F,EAAWiG,SACJxrB,EAAE5O,YAEV,QACC,OAAOu0B,EAAawB,WAAW,sDAAwDv6C,GAE1F,CAEA,SAASu7C,EAA2BvnD,EAAQgM,EAAO24C,EAAYI,GAC9D,IAAIjuD,EAAQkJ,EAAO9F,UAAU8R,GAAOlV,MAAM4xB,EAAE1T,IAC5C,IAAKle,EACJ,OAAOiuD,EAAawB,WAAW,uDAAyDv6C,GAEzF,GAA+B,QAA3BlV,EAAM,GAAG3L,cAAyB,CACrC,GAAI6gB,EAAQ,EACX,OAAO+4C,EAAawB,WACnB,sCAAwCv6C,EAAQ,qEAGlD,IAAK0c,EAAE1R,QAAQhgB,KAAKgJ,EAAO9F,UAAU8R,IACpC,OAAO+4C,EAAawB,WAAW,qCAEjC,CAEA,OADA5B,EAAWkG,sBAAsB/zD,EAAM,GAAIA,EAAM,IAC1CkV,EAAQlV,EAAM,GAAGtS,MACzB,CAEA,SAASijE,IACRrkE,KAAKklE,eAAiBhkE,OAAOmjB,OAAO,KACrC,CAEAggD,EAAkBl/D,UAAY,CAC7BkgE,WAAY,SAAU7uD,GACrB,IAAK8uB,EAAE7T,YAAY7d,KAAK4C,GACvB,MAAM,IAAI/W,MAAM,mBAAqB+W,GAEtCxW,KAAKwW,QAAUA,CAChB,EACA2uD,SAAU,SAAUG,EAAOv+D,EAAO4C,GACjC,IAAK27B,EAAE7T,YAAY7d,KAAK0xD,GACvB,MAAM,IAAI7lE,MAAM,qBAAuB6lE,GAExCtlE,KAAKklE,eAAeI,GAAStlE,KAAKoB,OAClCpB,KAAKA,KAAKoB,UAAY,CAAEkkE,MAAOA,EAAOv+D,MAAOA,EAAO4C,OAAQA,EAC7D,EACAvI,OAAQ,EACRsmE,aAAc,SAAUtyD,GACvB,OAAOpV,KAAKoV,GAAG4uD,SAChB,EACA2D,WAAY,SAAUvyD,GACrB,OAAOpV,KAAKoV,GAAGqrB,OAChB,EACAmnC,SAAU,SAAUxyD,GACnB,OAAOpV,KAAKoV,GAAGkwD,KAChB,EACAuC,OAAQ,SAAUzyD,GACjB,OAAOpV,KAAKoV,GAAG2uD,GAChB,EACA+D,SAAU,SAAU1yD,GACnB,OAAOpV,KAAKoV,GAAGrO,KAChB,GAaDhI,EAAQqiE,UAAYA,EACpBriE,EAAQknE,WAAaA,EACrBlnE,EAAQqlE,2BAA6BA,C,4BCz2BrC,SAASpoC,EAAOwV,EAAQu2B,GAOvB,YANW5nD,IAAP4nD,IACHA,EAAK7mE,QAEF6mE,GAA8C,mBAAjCA,EAAG/1B,4BACnBR,EAASu2B,EAAG1jD,OAAO,KAAM0jD,EAAG/1B,0BAA0BR,KAEhDu2B,GAA2B,mBAAdA,EAAG/rC,OAAwB+rC,EAAG/rC,OAAOwV,GAAUA,CACpE,CASA,SAAS0vB,EAAO1vB,EAAQ1qC,GACvB,OAAO5F,OAAOiE,UAAUuF,eAAevL,KAAKqyC,EAAQ1qC,EACrD,CA0CA,IAAIkhE,EAA0BhsC,EAAO,CACpCisC,iBAAiB,EACjBnkE,OAAO,EACPokE,WAAW,EACXC,UAAU,EACVtyD,SAAS,EACTuyD,UAAU,EACVC,SAAS,EACTC,OAAO,EACPp1D,UAAU,EACVq1D,gBAAgB,EAChBC,QAAQ,EACRC,OAAO,EACPC,WAAW,EACXC,MAAM,EACNC,UAAU,EACVC,OAAO,EACPC,UAAU,EACVC,YAAY,EACZ5mE,MAAM,EACN6mE,aAAa,EACbC,UAAU,EACVC,UAAU,EACVC,UAAU,EACVzzD,UAAU,IAgDX,IAAI0zD,EAAqBptC,EAAO,CAC/BqtC,MAAM,EACN54B,MAAM,EACN64B,IAAI,EACJC,KAAK,EACLC,OAAO,EACProD,IAAI,EACJi7C,KAAK,EACLxnD,OAAO,EACP60D,MAAM,EACNC,MAAM,EACNzjD,OAAO,EACPrJ,QAAQ,EACR+sD,OAAO,EACPC,KAAK,IA0BN,IAAIC,EAAyB7tC,EAAO,CACnC6N,QAAQ,EACR5qC,OAAO,EACP6qE,UAAU,EACV35D,OAAO,IA6CR,SAAS6wD,EAAea,GACvB,OAAOA,IAAakI,EAAUC,IAC/B,CAwBA,IAAID,EAAY/tC,EAAO,CAUtBguC,KAAM,YAUNC,gBAAiB,kBASjBC,SAAU,WAWVC,sBAAuB,wBASvBC,cAAe,kBAWZC,EAAcnpE,OAAOC,KAAK4oE,GAAW9jE,KAAI,SAAUa,GACtD,OAAOijE,EAAUjjE,EAClB,IAkBA,IAAIq6D,EAAYnlC,EAAO,CAMtBguC,KAAM,+BAONM,IAAK,6BAOL3E,IAAK,uCAOLF,MAAO,kCAGR1mE,EAAQ2Z,OApUR,SAAgB3V,EAAQ6Z,GACvB,GAAe,OAAX7Z,GAAqC,iBAAXA,EAC7B,MAAM,IAAIkB,UAAU,2BAErB,IAAK,IAAI6C,KAAO8V,EACXskD,EAAOtkD,EAAQ9V,KAClB/D,EAAO+D,GAAO8V,EAAO9V,IAGvB,OAAO/D,CACR,EA2TAhE,EAAQi2C,KA7YR,SAAcvtB,EAAM8iD,EAAWC,GAI9B,QAHWrqD,IAAPqqD,IACHA,EAAKhhE,MAAMrE,WAERsiB,GAA2B,mBAAZ+iD,EAAGx1B,KACrB,OAAOw1B,EAAGx1B,KAAK71C,KAAKsoB,EAAM8iD,GAE3B,IAAK,IAAIn1D,EAAI,EAAGA,EAAIqS,EAAKrmB,OAAQgU,IAChC,GAAI8rD,EAAOz5C,EAAMrS,GAAI,CACpB,IAAImpC,EAAO92B,EAAKrS,GAChB,GAAIm1D,EAAUprE,UAAKghB,EAAWo+B,EAAMnpC,EAAGqS,GACtC,OAAO82B,CAET,CAEF,EA+XAx/C,EAAQi9B,OAASA,EACjBj9B,EAAQipE,wBAA0BA,EAClCjpE,EAAQ8qE,uBAAyBA,EACjC9qE,EAAQqqE,mBAAqBA,EAC7BrqE,EAAQ0rE,wBAjIR,SAAiC5I,GAChC,OAAOb,EAAea,IAAaA,IAAakI,EAAUI,qBAC3D,EAgIAprE,EAAQmiE,OAASA,EACjBniE,EAAQ2rE,uBA3QR,SAAgCriE,GAC/B,OAAO64D,EAAO8G,EAAyB3/D,EAAKN,cAC7C,EA0QAhJ,EAAQkiE,qBA/KR,SAA8BzqD,GAC7B,IAAI1P,EAAM0P,EAAQzO,cAClB,OAAOm5D,EAAO2I,EAAwB/iE,KAAS+iE,EAAuB/iE,EACvE,EA6KA/H,EAAQgiE,8BAhKR,SAAuCvqD,GACtC,IAAI1P,EAAM0P,EAAQzO,cAClB,OAAOm5D,EAAO2I,EAAwB/iE,IAAQ+iE,EAAuB/iE,EACtE,EA8JA/H,EAAQiiE,eAAiBA,EACzBjiE,EAAQ0lE,kBAlNR,SAA2BjuD,GAC1B,OAAO0qD,EAAOkI,EAAoB5yD,EAAQzO,cAC3C,EAiNAhJ,EAAQ4rE,gBAnDR,SAAyB9I,GACxB,OAAOwI,EAAY5wD,QAAQooD,IAAa,CACzC,EAkDA9iE,EAAQgrE,UAAYA,EACpBhrE,EAAQoiE,UAAYA,C,wBC5apBriE,EAAOC,QAAUC,GAAG4d,OAAOguD,O,8BCE3B,IAAI/J,EAAc,EAAQ,MACtB7rB,EAAO6rB,EAAY7rB,KACnBy1B,EAA0B5J,EAAY4J,wBACtCvJ,EAASL,EAAYK,OACrBF,EAAiBH,EAAYG,eAC7BC,EAAuBJ,EAAYI,qBACnCwD,EAAoB5D,EAAY4D,kBAChCsF,EAAYlJ,EAAYkJ,UACxB5I,EAAYN,EAAYM,UAUxB0J,EAAM34B,SAEN4uB,EAAS,EAAQ,MACjBviC,EAAeuiC,EAAOviC,aACtBxC,EAAmB+kC,EAAO/kC,iBAE1BuJ,EAAI,EAAQ,MAOhB,SAASwlC,EAAYC,GACpB,GAAIA,IAAWF,EACd,MAAM,IAAI5mE,UAAU,sBAEtB,CAUA,SAAS+mE,EAAep2D,GACvB,MAAiB,KAAVA,CACR,CA8BA,SAASq2D,EAAkBvjD,EAASlhB,GAInC,OAHK06D,EAAOx5C,EAASlhB,KACpBkhB,EAAQlhB,IAAW,GAEbkhB,CACR,CAcA,SAASwjD,EAAat2D,GACrB,IAAKA,EAAO,MAAO,GACnB,IAAI6S,EArCL,SAAgC7S,GAE/B,OAAOA,EAAQA,EAAMgE,MAAM,gBAAgBnJ,OAAOu7D,GAAkB,EACrE,CAkCYG,CAAuBv2D,GAClC,OAAO1T,OAAOC,KAAKsmB,EAAK2jD,OAAOH,EAAmB,CAAC,GACpD,CA6BA,SAASI,EAAsBC,GAC9B,IAAKhmC,EAAE7T,YAAY7d,KAAK03D,GACvB,MAAM,IAAI/sC,EAAaA,EAAaW,sBAAuB,wCAA0CosC,EAAgB,IAEvH,CAiBA,SAASC,EAAmBC,EAAWF,GACtCD,EAAsBC,GACtBE,EAAYA,GAAa,KAIzB,IAAIvH,EAAS,KACTD,EAAYsH,EAChB,GAAIA,EAAc7xD,QAAQ,MAAQ,EAAG,CACpC,IAAIgyD,EAAcH,EAAc1yD,MAAM,KACtCqrD,EAASwH,EAAY,GACrBzH,EAAYyH,EAAY,EACzB,CACA,GAAe,OAAXxH,GAAiC,OAAduH,EACtB,MAAM,IAAIjtC,EAAaA,EAAaoB,cAAe,4CAEpD,GAAe,QAAXskC,GAAoBuH,IAAc3K,EAAYM,UAAUwE,IAC3D,MAAM,IAAIpnC,EAAaA,EAAaoB,cAAe,0DAEpD,IAAgB,UAAXskC,GAAwC,UAAlBqH,IAA8BE,IAAc3K,EAAYM,UAAUsE,MAC5F,MAAM,IAAIlnC,EACTA,EAAaoB,cACb,sFAGF,GAAI6rC,IAAc3K,EAAYM,UAAUsE,OAAoB,UAAXxB,GAAwC,UAAlBqH,EACtE,MAAM,IAAI/sC,EACTA,EAAaoB,cACb,oFAGF,MAAO,CAAC6rC,EAAWvH,EAAQD,EAC5B,CAWA,SAAS0H,EAAKz1D,EAAK+P,GAClB,IAAK,IAAIg2B,KAAK/lC,EACTirD,EAAOjrD,EAAK+lC,KACfh2B,EAAKg2B,GAAK/lC,EAAI+lC,GAGjB,CAiBA,SAAS3J,EAASs5B,EAAOC,GACxB,IAAIC,EAAKF,EAAMxmE,UACf,KAAM0mE,aAAcD,GAAQ,CAC3B,SAAS7G,IAAK,CACdA,EAAE5/D,UAAYymE,EAAMzmE,UAEpBumE,EAAKG,EADL9G,EAAI,IAAIA,GAER4G,EAAMxmE,UAAY0mE,EAAK9G,CACxB,CACI8G,EAAGzmE,aAAeumE,IACD,mBAATA,GACVlpE,QAAQ/B,MAAM,iBAAmBirE,GAElCE,EAAGzmE,YAAcumE,EAEnB,CAEA,IAAIG,EAAW,CAAC,EACZC,EAAgBD,EAASC,aAAe,EACxCC,EAAkBF,EAASE,eAAiB,EAC5CC,EAAaH,EAASG,UAAY,EAClCC,EAAsBJ,EAASI,mBAAqB,EACpDC,EAAyBL,EAASK,sBAAwB,EAC1DC,EAAeN,EAASM,YAAc,EACtCC,EAA+BP,EAASO,4BAA8B,EACtEC,EAAgBR,EAASQ,aAAe,EACxCC,EAAiBT,EAASS,cAAgB,EAC1CC,EAAsBV,EAASU,mBAAqB,GACpDC,EAA0BX,EAASW,uBAAyB,GAC5DC,EAAiBZ,EAASY,cAAgB,GAE1CC,EAAmB9L,EAAY7kC,OAAO,CACzC4wC,+BAAgC,EAChCC,4BAA6B,EAC7BC,4BAA6B,EAC7BC,2BAA4B,EAC5BC,+BAAgC,GAChCC,0CAA2C,KAe5C,SAASC,EAAe3yD,EAAGC,GAC1B,GAAIA,EAAEpZ,OAASmZ,EAAEnZ,OAAQ,OAAO8rE,EAAe1yD,EAAGD,GAClD,IAAI4c,EAAI,KACR,IAAK,IAAIxN,KAAKpP,EAAG,CAChB,GAAIA,EAAEoP,KAAOnP,EAAEmP,GAAI,OAAOwN,EAC1BA,EAAI5c,EAAEoP,EACP,CACA,OAAOwN,CACR,CAYA,SAASg2C,EAAQ/J,GAEhB,OADKA,EAAIgK,OAAMhK,EAAIgK,KAAO71C,KAAK81C,UACxBjK,EAAIgK,IACZ,CAcA,SAASE,IAAY,CAmGrB,SAASC,EAAah3D,EAAM+mD,GAC3Bt9D,KAAKwtE,MAAQj3D,EACbvW,KAAKytE,SAAWnQ,EAChBoQ,EAAgB1tE,KACjB,CAQA,SAAS0tE,EAAgBjmD,GACxB,IAAIkmD,EAAMlmD,EAAK+lD,MAAMI,MAAQnmD,EAAK+lD,MAAM7lB,cAAcimB,KACtD,GAAInmD,EAAKmmD,OAASD,EAAK,CACtB,IAAIE,EAAKpmD,EAAKgmD,SAAShmD,EAAK+lD,OAE5B,GADAM,GAAQrmD,EAAM,SAAUomD,EAAGzsE,SACtBqmB,EAAKsmD,UAAYF,EAAGzsE,OAASqmB,EAAKsmD,SACtC,IAAK,IAAI34D,EAAIy4D,EAAGzsE,OAAQgU,KAAKqS,EAAMrS,IAC9B8rD,EAAOz5C,EAAMrS,WACTqS,EAAKrS,GAIfs2D,EAAKmC,EAAIpmD,GACTA,EAAKmmD,KAAOD,CACb,CACD,CAqCA,SAASK,IAAgB,CAYzB,SAASC,EAAexmD,EAAMlR,GAE7B,IADA,IAAInB,EAAI,EACDA,EAAIqS,EAAKrmB,QAAQ,CACvB,GAAIqmB,EAAKrS,KAAOmB,EACf,OAAOnB,EAERA,GACD,CACD,CAeA,SAAS84D,EAAcj3D,EAAIwQ,EAAM0mD,EAASC,GAOzC,GANIA,EACH3mD,EAAKwmD,EAAexmD,EAAM2mD,IAAYD,GAEtC1mD,EAAKA,EAAKrmB,QAAU+sE,EACpB1mD,EAAKrmB,UAEF6V,EAAI,CACPk3D,EAAQE,aAAep3D,EACvB,IAAImsD,EAAMnsD,EAAG0wC,cACTyb,IACHgL,GAAWE,EAAmBlL,EAAKnsD,EAAIm3D,GAyjC1C,SAAyBhL,EAAKnsD,EAAIk3D,GACjC/K,GAAOA,EAAIwK,OACX,IAAIhI,EAAKuI,EAAQI,aACb3I,IAAOzE,EAAUsE,QAEpBxuD,EAAGu3D,OAAOL,EAAQlK,OAASkK,EAAQnK,UAAY,IAAMmK,EAAQpnE,MAE/D,CA/jCG0nE,CAAgBrL,EAAKnsD,EAAIk3D,GAE3B,CACD,CAaA,SAASO,EAAiBz3D,EAAIwQ,EAAMknD,GAEnC,IAAIv5D,EAAI64D,EAAexmD,EAAMknD,GAC7B,GAAIv5D,GAAK,EAAG,CAEX,IADA,IAAIw5D,EAAYnnD,EAAKrmB,OAAS,EACvBgU,GAAKw5D,GACXnnD,EAAKrS,GAAKqS,IAAOrS,GAGlB,GADAqS,EAAKrmB,OAASwtE,EACV33D,EAAI,CACP,IAAImsD,EAAMnsD,EAAG0wC,cACTyb,GACHkL,EAAmBlL,EAAKnsD,EAAI03D,GAE7BA,EAAKN,aAAe,IACrB,CACD,CACD,CAiMA,SAASQ,IAAqB,CAwO9B,SAASC,EAAK/D,GACbD,EAAYC,EACb,CAshBA,SAASgE,EAAY53C,GACpB,OACO,KAALA,EAAY,OAAiB,KAALA,GAAY,SAAiB,KAALA,GAAY,SAAkB,KAALA,GAAY,UAAa,KAAOA,EAAEwvB,aAAe,GAE7H,CAaA,SAASqoB,EAAWz4D,EAAMsvB,GACzB,GAAIA,EAAStvB,GACZ,OAAO,EAER,GAAKA,EAAOA,EAAK2Y,WAChB,GACC,GAAI8/C,EAAWz4D,EAAMsvB,GACpB,OAAO,QAECtvB,EAAOA,EAAKqxC,YAExB,CAuBA,SAASqnB,EAASlE,EAAQnrE,GACzBkrE,EAAYC,GAEZ,IAAI7gE,EAAMtK,GAAW,CAAC,EACtBI,KAAK2nD,cAAgB3nD,KAUrBA,KAAKgM,YAAc9B,EAAI8B,aAAe+9D,EAAUE,gBAOhDjqE,KAAKkM,KAAO80D,EAAehhE,KAAKgM,aAAe,OAAS,KACzD,CAmCA,SAASsiE,EAAmBlL,EAAKnsD,EAAIk3D,EAAS1xD,GAC7C2mD,GAAOA,EAAIwK,OACFO,EAAQI,eACNpN,EAAUsE,cAEbxuD,EAAGu3D,OAAOL,EAAQlK,OAASkK,EAAQnK,UAAY,GAExD,CAiBA,SAASkL,GAAe9L,EAAKltB,EAAQi5B,GACpC,GAAI/L,GAAOA,EAAIwK,KAAM,CACpBxK,EAAIwK,OACJ,IAAIt3D,EAAa4/B,EAAO5/B,WAExB,GAAI64D,IAAaA,EAASvnB,YAEzBtxC,EAAWA,EAAWlV,UAAY+tE,MAC5B,CAKN,IAFA,IAAIjkC,EAAQgL,EAAOhnB,WACf9Z,EAAI,EACD81B,GACN50B,EAAWlB,KAAO81B,EAClBA,EAAQA,EAAM0c,YAEftxC,EAAWlV,OAASgU,SACbkB,EAAWA,EAAWlV,OAC9B,CACD,CACD,CAmBA,SAASguE,GAAatlC,EAAYoB,GACjC,GAAIpB,IAAeoB,EAAMpB,WACxB,MAAM,IAAIvL,EAAaA,EAAac,cAAe,gCAEpD,IAAIgwC,EAAqBnkC,EAAMr0B,gBAC3By4D,EAAiBpkC,EAAM0c,YAe3B,OAdIynB,EACHA,EAAmBznB,YAAc0nB,EAEjCxlC,EAAW5a,WAAaogD,EAErBA,EACHA,EAAez4D,gBAAkBw4D,EAEjCvlC,EAAWgN,UAAYu4B,EAExBH,GAAeplC,EAAW6d,cAAe7d,GACzCoB,EAAMpB,WAAa,KACnBoB,EAAMr0B,gBAAkB,KACxBq0B,EAAM0c,YAAc,KACb1c,CACR,CAwCA,SAASqkC,GAAch5D,GACtB,OAAOA,GAAQA,EAAK80B,WAAayjC,EAAKtC,kBACvC,CAQA,SAASgD,GAAcj5D,GACtB,OAAOA,GAAQA,EAAK80B,WAAayjC,EAAK/C,YACvC,CAOA,SAAS0D,GAAWl5D,GACnB,OAAOA,GAAQA,EAAK80B,WAAayjC,EAAK7C,SACvC,CAcA,SAASyD,GAA2BtM,EAAKl4B,GACxC,IAAIykC,EAAmBvM,EAAI9sD,YAAc,GACzC,GAAI0+B,EAAK26B,EAAkBH,KAAkBD,GAAcrkC,GAC1D,OAAO,EAER,IAAI0kC,EAAc56B,EAAK26B,EAAkBJ,IACzC,QAASrkC,GAAS0kC,GAAeD,EAAiBl2D,QAAQm2D,GAAeD,EAAiBl2D,QAAQyxB,GACnG,CAcA,SAAS2kC,GAA6BzM,EAAKl4B,GAC1C,IAAIykC,EAAmBvM,EAAI9sD,YAAc,GAMzC,GAAI0+B,EAAK26B,GAJT,SAAuCp5D,GACtC,OAAOi5D,GAAcj5D,IAASA,IAAS20B,CACxC,IAGC,OAAO,EAER,IAAI0kC,EAAc56B,EAAK26B,EAAkBJ,IACzC,QAASrkC,GAAS0kC,GAAeD,EAAiBl2D,QAAQm2D,GAAeD,EAAiBl2D,QAAQyxB,GACnG,CA4BA,SAAS4kC,GAA+B55B,EAAQ3/B,EAAM20B,GAErD,IAlID,SAAgC30B,GAC/B,OACCA,IACCA,EAAK80B,WAAayjC,EAAKvC,eAAiBh2D,EAAK80B,WAAayjC,EAAKrC,wBAA0Bl2D,EAAK80B,WAAayjC,EAAK/C,aAEnH,CA6HMgE,CAAuB75B,GAC3B,MAAM,IAAI3X,EAAaA,EAAaS,sBAAuB,+BAAiCkX,EAAO7K,UAKpG,GAAIH,GAASA,EAAMpB,aAAeoM,EACjC,MAAM,IAAI3X,EAAaA,EAAac,cAAe,uBAEpD,IA9HD,SAA+B9oB,GAC9B,OACCA,IACCA,EAAK80B,WAAayjC,EAAK5C,oBACvB31D,EAAK80B,WAAayjC,EAAKxC,cACvB/1D,EAAK80B,WAAayjC,EAAKrC,wBACvBl2D,EAAK80B,WAAayjC,EAAKtC,oBACvBj2D,EAAK80B,WAAayjC,EAAK/C,cACvBx1D,EAAK80B,WAAayjC,EAAKzC,6BACvB91D,EAAK80B,WAAayjC,EAAK7C,UAE1B,CAqHG+D,CAAsBz5D,IAKtBg5D,GAAch5D,IAAS2/B,EAAO7K,WAAayjC,EAAKvC,cAEjD,MAAM,IAAIhuC,EACTA,EAAaS,sBACb,wBAA0BzoB,EAAK80B,SAAW,yBAA2B6K,EAAO7K,SAG/E,CA+BA,SAAS4kC,GAAqC/5B,EAAQ3/B,EAAM20B,GAC3D,IAAIykC,EAAmBz5B,EAAO5/B,YAAc,GACxC45D,EAAiB35D,EAAKD,YAAc,GAGxC,GAAIC,EAAK80B,WAAayjC,EAAKrC,uBAAwB,CAClD,IAAI0D,EAAoBD,EAAezgE,OAAO+/D,IAE9C,GAAIW,EAAkB/uE,OAAS,GAAK4zC,EAAKk7B,EAAgBT,IACxD,MAAM,IAAIlxC,EAAaA,EAAaS,sBAAuB,6CAI5D,GAAiC,IAA7BmxC,EAAkB/uE,SAAiBsuE,GAA2Bx5B,EAAQhL,GACzE,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,yDAE7D,CAEA,GAAIwwC,GAAcj5D,KAGZm5D,GAA2Bx5B,EAAQhL,GACvC,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,wDAI7D,GAAIuwC,GAAch5D,GAAO,CAExB,GAAIy+B,EAAK26B,EAAkBJ,IAC1B,MAAM,IAAIhxC,EAAaA,EAAaS,sBAAuB,+BAE5D,IAAIoxC,EAAqBp7B,EAAK26B,EAAkBH,IAEhD,GAAItkC,GAASykC,EAAiBl2D,QAAQ22D,GAAsBT,EAAiBl2D,QAAQyxB,GACpF,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,kDAG5D,IAAKkM,GAASklC,EACb,MAAM,IAAI7xC,EAAaA,EAAaS,sBAAuB,uDAE7D,CACD,CAkBA,SAASqxC,GAAuCn6B,EAAQ3/B,EAAM20B,GAC7D,IAAIykC,EAAmBz5B,EAAO5/B,YAAc,GACxC45D,EAAiB35D,EAAKD,YAAc,GAGxC,GAAIC,EAAK80B,WAAayjC,EAAKrC,uBAAwB,CAClD,IAAI0D,EAAoBD,EAAezgE,OAAO+/D,IAE9C,GAAIW,EAAkB/uE,OAAS,GAAK4zC,EAAKk7B,EAAgBT,IACxD,MAAM,IAAIlxC,EAAaA,EAAaS,sBAAuB,6CAG5D,GAAiC,IAA7BmxC,EAAkB/uE,SAAiByuE,GAA6B35B,EAAQhL,GAC3E,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,yDAE7D,CAEA,GAAIwwC,GAAcj5D,KAEZs5D,GAA6B35B,EAAQhL,GACzC,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,wDAI7D,GAAIuwC,GAAch5D,GAAO,CACxB,SAAS+5D,EAA8B/5D,GACtC,OAAOg5D,GAAch5D,IAASA,IAAS20B,CACxC,CAGA,GAAI8J,EAAK26B,EAAkBW,GAC1B,MAAM,IAAI/xC,EAAaA,EAAaS,sBAAuB,+BAE5D,IAAIoxC,EAAqBp7B,EAAK26B,EAAkBH,IAEhD,GAAItkC,GAASykC,EAAiBl2D,QAAQ22D,GAAsBT,EAAiBl2D,QAAQyxB,GACpF,MAAM,IAAI3M,EAAaA,EAAaS,sBAAuB,iDAE7D,CACD,CA2BA,SAASuxC,GAAcr6B,EAAQ3/B,EAAM20B,EAAOslC,GAE3CV,GAA+B55B,EAAQ3/B,EAAM20B,GAIzCgL,EAAO7K,WAAayjC,EAAKvC,gBAC3BiE,GAAwBP,IAAsC/5B,EAAQ3/B,EAAM20B,GAG9E,IAAIulC,EAAKl6D,EAAKuzB,WAId,GAHI2mC,GACHA,EAAGthD,YAAY5Y,GAEZA,EAAK80B,WAAaohC,EAAwB,CAC7C,IAAIiE,EAAWn6D,EAAK2Y,WACpB,GAAgB,MAAZwhD,EACH,OAAOn6D,EAER,IAAIo6D,EAAUp6D,EAAKugC,SACpB,MACC45B,EAAWC,EAAUp6D,EAEtB,IAAInE,EAAM84B,EAAQA,EAAMr0B,gBAAkBq/B,EAAOY,UAEjD45B,EAAS75D,gBAAkBzE,EAC3Bu+D,EAAQ/oB,YAAc1c,EAElB94B,EACHA,EAAIw1C,YAAc8oB,EAElBx6B,EAAOhnB,WAAawhD,EAER,MAATxlC,EACHgL,EAAOY,UAAY65B,EAEnBzlC,EAAMr0B,gBAAkB85D,EAEzB,GACCD,EAAS5mC,WAAaoM,QACdw6B,IAAaC,IAAYD,EAAWA,EAAS9oB,cAMtD,OALAsnB,GAAeh5B,EAAOyR,eAAiBzR,EAAQA,EAAQ3/B,GACnDA,EAAK80B,UAAYohC,IACpBl2D,EAAK2Y,WAAa3Y,EAAKugC,UAAY,MAG7BvgC,CACR,CAgRA,SAASq6D,GAAQ7F,GAChBD,EAAYC,GAEZ/qE,KAAKwuE,OAASttE,OAAOmjB,OAAO,KAC7B,CA8OA,SAASwsD,GAAK9F,GACbD,EAAYC,GAEZ/qE,KAAKuuE,aAAe,KACpBvuE,KAAKikE,OAAS,KACdjkE,KAAKquE,aAAe,IACrB,CAIA,SAASyC,GAAc/F,GACtBD,EAAYC,EACb,CA0BA,SAASgG,GAAKhG,GACbD,EAAYC,EACb,CAkBA,SAAS/4C,GAAQ+4C,GAChBD,EAAYC,EACb,CAOA,SAASiG,GAAajG,GACrBD,EAAYC,EACb,CAOA,SAASkG,GAAalG,GACrBD,EAAYC,EACb,CAIA,SAASmG,GAASnG,GACjBD,EAAYC,EACb,CAIA,SAASoG,GAAOpG,GACfD,EAAYC,EACb,CAIA,SAASqG,GAAgBrG,GACxBD,EAAYC,EACb,CAIA,SAASsG,GAAiBtG,GACzBD,EAAYC,EACb,CAKA,SAASuG,GAAsBvG,GAC9BD,EAAYC,EACb,CAGA,SAASwG,KAAiB,CAK1B,SAASC,GAAsBC,GAC9B,IAAIC,EAAM,GACNC,EAAW3xE,KAAKqrC,WAAakhC,GAAiBvsE,KAAK8T,iBAAoB9T,KACvEikE,EAAS0N,EAAQ1N,OACjBF,EAAM4N,EAAQpD,aAElB,GAAIxK,GAAiB,MAAVE,GAEI,OADVA,EAAS0N,EAAQC,aAAa7N,IAEjC,IAAI8N,EAAoB,CACvB,CAAErG,UAAWzH,EAAKE,OAAQ,OAM7B,OADA6N,GAAkB9xE,KAAM0xE,EAAKD,EAAYI,GAClCH,EAAI5rE,KAAK,GACjB,CAEA,SAASisE,GAAoBx7D,EAAMqrD,EAAQiQ,GAC1C,IAAI5N,EAAS1tD,EAAK0tD,QAAU,GACxBF,EAAMxtD,EAAKg4D,aAQf,IAAKxK,EACJ,OAAO,EAER,GAAgB,QAAXE,GAAoBF,IAAQ5C,EAAUwE,KAAQ5B,IAAQ5C,EAAUsE,MACpE,OAAO,EAIR,IADA,IAAIrwD,EAAIy8D,EAAkBzwE,OACnBgU,KAAK,CACX,IAAIwwD,EAAKiM,EAAkBz8D,GAE3B,GAAIwwD,EAAG3B,SAAWA,EACjB,OAAO2B,EAAG4F,YAAczH,CAE1B,CACA,OAAO,CACR,CAgBA,SAASiO,GAAuBN,EAAKpG,EAAevkE,GACnD2qE,EAAI9rE,KAAK,IAAK0lE,EAAe,KAAMvkE,EAAMsH,QAAQ,gBAAiB0gE,GAAc,IACjF,CAEA,SAAS+C,GAAkBv7D,EAAMm7D,EAAKD,EAAYI,GAC5CA,IACJA,EAAoB,IAErB,IACIjQ,EAAsB,UADhBrrD,EAAK80B,WAAakhC,EAAgBh2D,EAAOA,EAAKoxC,eACvCz7C,KAEjB,GAAIulE,EAAY,CAEf,KADAl7D,EAAOk7D,EAAWl7D,IAOjB,OALA,GAAmB,iBAARA,EAEV,YADAm7D,EAAI9rE,KAAK2Q,EAOZ,CAEA,OAAQA,EAAK80B,UACZ,KAAK0gC,EACJ,IAAIkG,EAAQ17D,EAAK0wB,WACbq9B,EAAM2N,EAAM7wE,OACZ8pC,EAAQ30B,EAAK2Y,WACbplB,EAAWyM,EAAKC,QAEhB07D,EAAmBpoE,EACvB,IAAK83D,IAAWrrD,EAAK0tD,QAAU1tD,EAAKg4D,aAAc,CAGjD,IAFA,IAAI4D,EAEKC,EAAK,EAAGA,EAAKH,EAAM7wE,OAAQgxE,IACnC,GAA4B,UAAxBH,EAAM1zB,KAAK6zB,GAAI/pE,KAAkB,CACpC8pE,EAAYF,EAAM1zB,KAAK6zB,GAAIrrE,MAC3B,KACD,CAED,IAAKorE,EAEJ,IAAK,IAAIE,EAAMR,EAAkBzwE,OAAS,EAAGixE,GAAO,EAAGA,IAAO,CAE7D,GAAyB,MADrB7G,EAAYqG,EAAkBQ,IACpBpO,QAAiBuH,EAAUA,YAAcj1D,EAAKg4D,aAAc,CACzE4D,EAAY3G,EAAUA,UACtB,KACD,CACD,CAED,GAAI2G,IAAc57D,EAAKg4D,aACtB,IAAS8D,EAAMR,EAAkBzwE,OAAS,EAAGixE,GAAO,EAAGA,IAAO,CAC7D,IAAI7G,EACJ,IADIA,EAAYqG,EAAkBQ,IACpB7G,YAAcj1D,EAAKg4D,aAAc,CAC1C/C,EAAUvH,SACbiO,EAAmB1G,EAAUvH,OAAS,IAAMn6D,GAE7C,KACD,CACD,CAEF,CAEA4nE,EAAI9rE,KAAK,IAAKssE,GAEd,IAAK,IAAI98D,EAAI,EAAGA,EAAIkvD,EAAKlvD,IAAK,CAGV,UADfu5D,EAAOsD,EAAM1zB,KAAKnpC,IACb6uD,OACR4N,EAAkBjsE,KAAK,CACtBq+D,OAAQ0K,EAAK3K,UACbwH,UAAWmD,EAAK5nE,QAEU,SAAjB4nE,EAAK7kE,UACf+nE,EAAkBjsE,KAAK,CAAEq+D,OAAQ,GAAIuH,UAAWmD,EAAK5nE,OAEvD,CAEA,IAASqO,EAAI,EAAGA,EAAIkvD,EAAKlvD,IAAK,CAC7B,IAAIu5D,EAEC1K,EACAF,EAFL,GAAIgO,GADApD,EAAOsD,EAAM1zB,KAAKnpC,GACQwsD,EAAQiQ,GAGrCG,GAAuBN,GAFnBzN,EAAS0K,EAAK1K,QAAU,IAES,SAAWA,EAAS,QADrDF,EAAM4K,EAAKJ,cAEfsD,EAAkBjsE,KAAK,CAAEq+D,OAAQA,EAAQuH,UAAWzH,IAErD+N,GAAkBnD,EAAM+C,EAAKD,EAAYI,EAC1C,CAGA,GAAI/nE,IAAaooE,GAAoBH,GAAoBx7D,EAAMqrD,EAAQiQ,GAGtEG,GAAuBN,GAFnBzN,EAAS1tD,EAAK0tD,QAAU,IAES,SAAWA,EAAS,QADrDF,EAAMxtD,EAAKg4D,cAEfsD,EAAkBjsE,KAAK,CAAEq+D,OAAQA,EAAQuH,UAAWzH,IAGrD,IAAIuO,GAAepnC,EAKnB,GAJIonC,IAAgB1Q,GAAUrrD,EAAKg4D,eAAiBpN,EAAU6I,QAE7DsI,EAAc7N,EAAkB36D,IAE7BwoE,EACHZ,EAAI9rE,KAAK,UACH,CAGN,GAFA8rE,EAAI9rE,KAAK,KAELg8D,GAAUX,EAAqBn3D,GAClC,KAAOohC,GACFA,EAAMrrC,KACT6xE,EAAI9rE,KAAKslC,EAAMrrC,MAEfiyE,GAAkB5mC,EAAOwmC,EAAKD,EAAYI,EAAkB5jE,SAE7Di9B,EAAQA,EAAM0c,iBAGf,KAAO1c,GACN4mC,GAAkB5mC,EAAOwmC,EAAKD,EAAYI,EAAkB5jE,SAC5Di9B,EAAQA,EAAM0c,YAGhB8pB,EAAI9rE,KAAK,KAAMssE,EAAkB,IAClC,CAGA,OACD,KAAK3F,EACL,KAAKE,EAEJ,IADIvhC,EAAQ30B,EAAK2Y,WACVgc,GACN4mC,GAAkB5mC,EAAOwmC,EAAKD,EAAYI,EAAkB5jE,SAC5Di9B,EAAQA,EAAM0c,YAEf,OACD,KAAKokB,EACJ,OAAOgG,GAAuBN,EAAKn7D,EAAKlO,KAAMkO,EAAKxP,OACpD,KAAKklE,EAmBJ,OAAOyF,EAAI9rE,KAAK2Q,EAAK1W,KAAKwO,QAAQ,SAAU0gE,IAC7C,KAAK7C,EACJ,OAAOwF,EAAI9rE,KAAK0/B,EAAEvR,YAAaxd,EAAK1W,KAAMylC,EAAEtR,WAC7C,KAAKs4C,EACJ,OAAOoF,EAAI9rE,KAAK0/B,EAAEvT,cAAexb,EAAK1W,KAAMylC,EAAErR,aAC/C,KAAKu4C,EACJ,IAAI+F,EAAQh8D,EAAKwwD,SACbyL,EAAQj8D,EAAKywD,SAcjB,OAbA0K,EAAI9rE,KAAK0/B,EAAEpR,mBAAoB,IAAK3d,EAAKlO,MACrCkqE,GACHb,EAAI9rE,KAAK,IAAK0/B,EAAExS,OAAQ,IAAKy/C,GACzBC,GAAmB,MAAVA,GACZd,EAAI9rE,KAAK,IAAK4sE,IAELA,GAAmB,MAAVA,GACnBd,EAAI9rE,KAAK,IAAK0/B,EAAEzS,OAAQ,IAAK2/C,GAE1Bj8D,EAAK0wD,gBACRyK,EAAI9rE,KAAK,KAAM2Q,EAAK0wD,eAAgB,UAErCyK,EAAI9rE,KAAK,KAEV,KAAKymE,EACJ,OAAOqF,EAAI9rE,KAAK,KAAM2Q,EAAKxT,OAAQ,IAAKwT,EAAK1W,KAAM,MACpD,KAAKssE,EACJ,OAAOuF,EAAI9rE,KAAK,IAAK2Q,EAAKzM,SAAU,KAGrC,QACC4nE,EAAI9rE,KAAK,KAAM2Q,EAAKzM,UAEvB,CACA,SAAS2oE,GAAWrP,EAAK7sD,EAAMm8D,GAC9B,IAAIC,EACJ,OAAQp8D,EAAK80B,UACZ,KAAK0gC,GACJ4G,EAAQp8D,EAAKqiC,WAAU,IACjB+O,cAAgByb,EAMvB,KAAKqJ,EACJ,MACD,KAAKT,EACJ0G,GAAO,EAsBT,GALKC,IACJA,EAAQp8D,EAAKqiC,WAAU,IAExB+5B,EAAMhrB,cAAgByb,EACtBuP,EAAM7oC,WAAa,KACf4oC,EAEH,IADA,IAAIxnC,EAAQ30B,EAAK2Y,WACVgc,GACNynC,EAAMxqE,YAAYsqE,GAAWrP,EAAKl4B,EAAOwnC,IACzCxnC,EAAQA,EAAM0c,YAGhB,OAAO+qB,CACR,CAkBA,SAAS/5B,GAAUwqB,EAAK7sD,EAAMm8D,GAC7B,IAAIC,EAAQ,IAAIp8D,EAAKnR,YAAYylE,GACjC,IAAK,IAAIlhD,KAAKpT,EACb,GAAI2qD,EAAO3qD,EAAMoT,GAAI,CACpB,IAAIzjB,EAAIqQ,EAAKoT,GACG,iBAALzjB,GACNA,GAAKysE,EAAMhpD,KACdgpD,EAAMhpD,GAAKzjB,EAGd,CAMD,OAJIqQ,EAAKD,aACRq8D,EAAMr8D,WAAa,IAAIg3D,GAExBqF,EAAMhrB,cAAgByb,EACduP,EAAMtnC,UACb,KAAK0gC,EACJ,IAAIkG,EAAQ17D,EAAK0wB,WACb2rC,EAAUD,EAAM1rC,WAAa,IAAI+mC,EACjC1J,EAAM2N,EAAM7wE,OAChBwxE,EAAOC,cAAgBF,EACvB,IAAK,IAAIv9D,EAAI,EAAGA,EAAIkvD,EAAKlvD,IACxBu9D,EAAMG,iBAAiBl6B,GAAUwqB,EAAK6O,EAAM1zB,KAAKnpC,IAAI,IAEtD,MACD,KAAK42D,EACJ0G,GAAO,EAET,GAAIA,EAEH,IADA,IAAIxnC,EAAQ30B,EAAK2Y,WACVgc,GACNynC,EAAMxqE,YAAYywC,GAAUwqB,EAAKl4B,EAAOwnC,IACxCxnC,EAAQA,EAAM0c,YAGhB,OAAO+qB,CACR,CAEA,SAAS7E,GAAQt8B,EAAQ1qC,EAAKC,GAC7ByqC,EAAO1qC,GAAOC,CACf,CAxrFAumE,EAASnoE,UAAY,CAOpB/D,OAAQ,EAWRm9C,KAAM,SAAUt1C,GACf,OAAOA,GAAS,GAAKA,EAAQjJ,KAAKoB,OAASpB,KAAKiJ,GAAS,IAC1D,EASAukC,SAAU,SAAUikC,GACnB,IAAK,IAAIC,EAAM,GAAIt8D,EAAI,EAAGA,EAAIpV,KAAKoB,OAAQgU,IAC1C08D,GAAkB9xE,KAAKoV,GAAIs8D,EAAKD,GAEjC,OAAOC,EAAI5rE,KAAK,GACjB,EAUA2J,OAAQ,SAAU86D,GACjB,OAAO/gE,MAAMrE,UAAUsK,OAAOtQ,KAAKa,KAAMuqE,EAC1C,EAWA9wD,QAAS,SAAU8kC,GAClB,OAAO/0C,MAAMrE,UAAUsU,QAAQta,KAAKa,KAAMu+C,EAC3C,GAED+uB,EAASnoE,UAAU+sC,OAAOC,UAAY,WACrC,IAAI4gC,EAAK/yE,KACLiJ,EAAQ,EAEZ,MAAO,CACN2e,KAAM,WACL,OAAI3e,EAAQ8pE,EAAG3xE,OACP,CACN2F,MAAOgsE,EAAG9pE,KACV+pE,MAAM,GAGA,CACNA,MAAM,EAGT,EACAC,OAAQ,WACP,MAAO,CACND,MAAM,EAER,EAEF,EAmDAzF,EAAapoE,UAAUo5C,KAAO,SAAUnpC,GAEvC,OADAs4D,EAAgB1tE,MACTA,KAAKoV,IAAM,IACnB,EAEAi9B,EAASk7B,EAAcD,GAuGvBU,EAAa7oE,UAAY,CACxB/D,OAAQ,EACRm9C,KAAM+uB,EAASnoE,UAAUo5C,KAYzB20B,aAAc,SAAUlP,GACnBhkE,KAAK6yE,eAAiB7yE,KAAK6yE,cAAcM,kCAC5CnP,EAAYA,EAAUj8D,eAGvB,IADA,IAAIqN,EAAI,EACDA,EAAIpV,KAAKoB,QAAQ,CACvB,IAAIutE,EAAO3uE,KAAKoV,GAChB,GAAIu5D,EAAK7kE,WAAak6D,EACrB,OAAO2K,EAERv5D,GACD,CACA,OAAO,IACR,EAgBAg+D,aAAc,SAAUzE,GACvB,IAAI13D,EAAK03D,EAAKN,aACd,GAAIp3D,GAAMA,IAAOjX,KAAK6yE,cACrB,MAAM,IAAIt0C,EAAaA,EAAagB,qBAErC,IAAI6uC,EAAUpuE,KAAKqzE,eAAe1E,EAAKJ,aAAcI,EAAK3K,WAC1D,OAAIoK,IAAYO,EACRA,GAERT,EAAcluE,KAAK6yE,cAAe7yE,KAAM2uE,EAAMP,GACvCA,EACR,EAgBAkF,eAAgB,SAAU3E,GACzB,OAAO3uE,KAAKozE,aAAazE,EAC1B,EAeA4E,gBAAiB,SAAUvP,GAC1B,IAAI2K,EAAO3uE,KAAKkzE,aAAalP,GAC7B,IAAK2K,EACJ,MAAM,IAAIpwC,EAAaA,EAAac,cAAe2kC,GAGpD,OADA0K,EAAiB1uE,KAAK6yE,cAAe7yE,KAAM2uE,GACpCA,CACR,EAkBA6E,kBAAmB,SAAUjF,EAAcvK,GAC1C,IAAI2K,EAAO3uE,KAAKqzE,eAAe9E,EAAcvK,GAC7C,IAAK2K,EACJ,MAAM,IAAIpwC,EAAaA,EAAac,cAAekvC,EAAeA,EAAe,MAAQvK,EAAYA,GAGtG,OADA0K,EAAiB1uE,KAAK6yE,cAAe7yE,KAAM2uE,GACpCA,CACR,EAcA0E,eAAgB,SAAU9E,EAAcvK,GAClCuK,IACJA,EAAe,MAGhB,IADA,IAAIn5D,EAAI,EACDA,EAAIpV,KAAKoB,QAAQ,CACvB,IAAImV,EAAOvW,KAAKoV,GAChB,GAAImB,EAAKytD,YAAcA,GAAaztD,EAAKg4D,eAAiBA,EACzD,OAAOh4D,EAERnB,GACD,CACA,OAAO,IACR,GAED44D,EAAa7oE,UAAU+sC,OAAOC,UAAY,WACzC,IAAI4gC,EAAK/yE,KACLiJ,EAAQ,EAEZ,MAAO,CACN2e,KAAM,WACL,OAAI3e,EAAQ8pE,EAAG3xE,OACP,CACN2F,MAAOgsE,EAAG9pE,KACV+pE,MAAM,GAGA,CACNA,MAAM,EAGT,EACAC,OAAQ,WACP,MAAO,CACND,MAAM,EAER,EAEF,EAuBAnE,EAAkB1pE,UAAY,CAwB7BsuE,WAAY,SAAU36C,EAASq1B,GAC9B,OAAO,CACR,EA6DAulB,eAAgB,SAAUnF,EAAcjD,EAAexE,GACtD,IAAI96D,EAAc+9D,EAAUE,gBACxBsE,IAAiBpN,EAAU6I,KAC9Bh+D,EAAc+9D,EAAUI,sBACdoE,IAAiBpN,EAAUmJ,MACrCt+D,EAAc+9D,EAAUK,eAEzB,IAAIhH,EAAM,IAAI6L,EAASpE,EAAK,CAAE7+D,YAAaA,IAO3C,GANAo3D,EAAIuQ,eAAiB3zE,KACrBojE,EAAI9sD,WAAa,IAAIg3D,EACrBlK,EAAI0D,QAAUA,GAAW,KACrBA,GACH1D,EAAIj7D,YAAY2+D,GAEbwE,EAAe,CAClB,IAAIvgC,EAAOq4B,EAAIwQ,gBAAgBrF,EAAcjD,GAC7ClI,EAAIj7D,YAAY4iC,EACjB,CACA,OAAOq4B,CACR,EA8CAyQ,mBAAoB,SAAUvI,EAAevE,EAAUC,EAAUC,GAChEoE,EAAsBC,GACtB,IAAI/0D,EAAO,IAAI06D,GAAapG,GAQ5B,OAPAt0D,EAAKlO,KAAOijE,EACZ/0D,EAAKzM,SAAWwhE,EAChB/0D,EAAKwwD,SAAWA,GAAY,GAC5BxwD,EAAKywD,SAAWA,GAAY,GAC5BzwD,EAAK0wD,eAAiBA,GAAkB,GACxC1wD,EAAKD,WAAa,IAAIg3D,EAEf/2D,CACR,EAkBAu9D,mBAAoB,SAAU3jE,GAC7B,IAAIizD,EAAM,IAAI6L,EAASpE,EAAK,CAAE7+D,YAAa+9D,EAAUC,OAGrD,GAFA5G,EAAIuQ,eAAiB3zE,KACrBojE,EAAI9sD,WAAa,IAAIg3D,GACP,IAAVn9D,EAAiB,CACpBizD,EAAI0D,QAAU9mE,KAAK6zE,mBAAmB,QACtCzQ,EAAI0D,QAAQnf,cAAgByb,EAC5BA,EAAIj7D,YAAYi7D,EAAI0D,SACpB,IAAIiN,EAAW3Q,EAAI36D,cAAc,QACjC26D,EAAIj7D,YAAY4rE,GAChB,IAAIC,EAAW5Q,EAAI36D,cAAc,QAEjC,GADAsrE,EAAS5rE,YAAY6rE,GACA,iBAAV7jE,EAAoB,CAC9B,IAAI8jE,EAAY7Q,EAAI36D,cAAc,SAClCwrE,EAAU9rE,YAAYi7D,EAAIC,eAAelzD,IACzC6jE,EAAS7rE,YAAY8rE,EACtB,CACAF,EAAS5rE,YAAYi7D,EAAI36D,cAAc,QACxC,CACA,OAAO26D,CACR,GAiCD0L,EAAK3pE,UAAY,CAMhB+pB,WAAY,KAMZ4nB,UAAW,KAMXjgC,gBAAiB,KAMjB+wC,YAAa,KAMb9d,WAAY,KAMZ,iBAAIzzB,GACH,OAAOrW,KAAK8pC,YAAc9pC,KAAK8pC,WAAWuB,WAAarrC,KAAK+rE,aAAe/rE,KAAK8pC,WAAa,IAC9F,EAMAxzB,WAAY,KAMZqxC,cAAe,KAMfpc,UAAW,KAMXgjC,aAAc,KAMdtK,OAAQ,KAMRD,UAAW,KAOXkQ,QAAS,cAMT,eAAIC,GACH,IAAIC,EAAWp0E,KAAKq0E,cACpB,OAAOD,GAAYA,EAAS/oC,WAAa+oC,EAAS7H,aACnD,EAUAzlB,SAAU,SAAUwtB,GACnB,IAAKA,EAAO,OAAO,EACnB,IAAIp+B,EAASo+B,EACb,EAAG,CACF,GAAIt0E,OAASk2C,EAAQ,OAAO,EAC5BA,EAASo+B,EAAMxqC,UAChB,OAASoM,GACT,OAAO,CACR,EAiBAm+B,YAAa,SAAUz0E,GACtB,IAAIs2C,EAASl2C,KACb,EAAG,CACF,IAAKk2C,EAAOpM,WACX,OAAOoM,EAERA,EAASA,EAAOpM,UACjB,OAASoM,EACV,EAOAq+B,YAAa,SAAUC,GACtB,IAAKA,EAAW,OAAO,EAEvB,GAAIx0E,KAAKqrC,WAAampC,EAAUnpC,SAAU,OAAO,EAEjD,OAAQrrC,KAAKqrC,UACZ,KAAKrrC,KAAKwsE,mBACT,GAAIxsE,KAAKqI,OAASmsE,EAAUnsE,KAAM,OAAO,EACzC,GAAIrI,KAAK+mE,WAAayN,EAAUzN,SAAU,OAAO,EACjD,GAAI/mE,KAAKgnE,WAAawN,EAAUxN,SAAU,OAAO,EACjD,MACD,KAAKhnE,KAAK+rE,aACT,GAAI/rE,KAAKuuE,eAAiBiG,EAAUjG,aAAc,OAAO,EACzD,GAAIvuE,KAAKikE,SAAWuQ,EAAUvQ,OAAQ,OAAO,EAC7C,GAAIjkE,KAAKgkE,YAAcwQ,EAAUxQ,UAAW,OAAO,EACnD,GAAIhkE,KAAKinC,WAAW7lC,SAAWozE,EAAUvtC,WAAW7lC,OAAQ,OAAO,EACnE,IAAK,IAAIgU,EAAI,EAAGA,EAAIpV,KAAKinC,WAAW7lC,OAAQgU,IAAK,CAChD,IAAIu5D,EAAO3uE,KAAKinC,WAAWsX,KAAKnpC,GAChC,IAAKu5D,EAAK4F,YAAYC,EAAUC,mBAAmB9F,EAAKJ,aAAcI,EAAK3K,YAC1E,OAAO,CAET,CACA,MACD,KAAKhkE,KAAKgsE,eACT,GAAIhsE,KAAKuuE,eAAiBiG,EAAUjG,aAAc,OAAO,EACzD,GAAIvuE,KAAKgkE,YAAcwQ,EAAUxQ,UAAW,OAAO,EACnD,GAAIhkE,KAAK+G,QAAUytE,EAAUztE,MAAO,OAAO,EAE3C,MACD,KAAK/G,KAAKqsE,4BACT,GAAIrsE,KAAK+C,SAAWyxE,EAAUzxE,QAAU/C,KAAKH,OAAS20E,EAAU30E,KAC/D,OAAO,EAER,MACD,KAAKG,KAAKisE,UACV,KAAKjsE,KAAKssE,aACT,GAAItsE,KAAKH,OAAS20E,EAAU30E,KAAM,OAAO,EAI3C,GAAIG,KAAKsW,WAAWlV,SAAWozE,EAAUl+D,WAAWlV,OACnD,OAAO,EAGR,IAASgU,EAAI,EAAGA,EAAIpV,KAAKsW,WAAWlV,OAAQgU,IAC3C,IAAKpV,KAAKsW,WAAWlB,GAAGm/D,YAAYC,EAAUl+D,WAAWlB,IACxD,OAAO,EAIT,OAAO,CACR,EAMAs/D,WAAY,SAAUF,GACrB,OAAOx0E,OAASw0E,CACjB,EAgBA9qB,aAAc,SAAUylB,EAAUwF,GACjC,OAAOpE,GAAcvwE,KAAMmvE,EAAUwF,EACtC,EAmBA/qC,aAAc,SAAUulC,EAAUyF,GACjCrE,GAAcvwE,KAAMmvE,EAAUyF,EAAUvE,IACpCuE,GACH50E,KAAKmvB,YAAYylD,EAEnB,EAYAzlD,YAAa,SAAUylD,GACtB,OAAOxF,GAAapvE,KAAM40E,EAC3B,EAcAzsE,YAAa,SAAUgnE,GACtB,OAAOnvE,KAAK0pD,aAAaylB,EAAU,KACpC,EAOAlkC,cAAe,WACd,OAA0B,MAAnBjrC,KAAKkvB,UACb,EAeA0pB,UAAW,SAAU85B,GACpB,OAAO95B,GAAU54C,KAAK2nD,eAAiB3nD,KAAMA,KAAM0yE,EACpD,EAmBAmC,UAAW,WAEV,IADA,IAAI3pC,EAAQlrC,KAAKkvB,WACVgc,GAAO,CACb,IAAItjB,EAAOsjB,EAAM0c,YACbhgC,GAAQA,EAAKyjB,UAAY4gC,GAAa/gC,EAAMG,UAAY4gC,GAC3DjsE,KAAKmvB,YAAYvH,GACjBsjB,EAAM4pC,WAAWltD,EAAK/nB,QAEtBqrC,EAAM2pC,YACN3pC,EAAQtjB,EAEV,CACD,EAgBAmtD,YAAa,SAAUj8C,EAASq1B,GAC/B,OAAOnuD,KAAK2nD,cAAcgsB,eAAeF,WAAW36C,EAASq1B,EAC9D,EAoBAyjB,aAAc,SAAUrD,GAEvB,IADA,IAAIt3D,EAAKjX,KACFiX,GAAI,CACV,IAAIhR,EAAMgR,EAAGu3D,OAEb,GAAIvoE,EACH,IAAK,IAAI0jB,KAAK1jB,EACb,GAAIi7D,EAAOj7D,EAAK0jB,IAAM1jB,EAAI0jB,KAAO4kD,EAChC,OAAO5kD,EAIV1S,EAAKA,EAAGo0B,UAAY2gC,EAAiB/0D,EAAG0wC,cAAgB1wC,EAAG6yB,UAC5D,CACA,OAAO,IACR,EAkBAkrC,mBAAoB,SAAU/Q,GAE7B,IADA,IAAIhtD,EAAKjX,KACFiX,GAAI,CACV,IAAIhR,EAAMgR,EAAGu3D,OAEb,GAAIvoE,GACCi7D,EAAOj7D,EAAKg+D,GACf,OAAOh+D,EAAIg+D,GAGbhtD,EAAKA,EAAGo0B,UAAY2gC,EAAiB/0D,EAAG0wC,cAAgB1wC,EAAG6yB,UAC5D,CACA,OAAO,IACR,EAsBAmrC,mBAAoB,SAAU1G,GAE7B,OAAiB,MADJvuE,KAAK4xE,aAAarD,EAEhC,EAcA2G,wBAAyB,SAAUZ,GAClC,GAAIt0E,OAASs0E,EAAO,OAAO,EAC3B,IAAIa,EAAQb,EACR3B,EAAQ3yE,KACRo1E,EAAQ,KACRC,EAAQ,KAKZ,GAJIF,aAAiBtE,KAEpBsE,GADAC,EAAQD,GACM9G,cAEXsE,aAAiB9B,KAEpB8B,GADA0C,EAAQ1C,GACMtE,aACV+G,GAASD,GAASxC,IAAUwC,GAC/B,IAAK,IAAWxG,EAAPv5D,EAAI,EAAUu5D,EAAOgE,EAAM1rC,WAAW7xB,GAAKA,IAAK,CACxD,GAAIu5D,IAASyG,EACZ,OAAOzI,EAAiBM,0CAA4CN,EAAiBE,4BACtF,GAAI8B,IAAS0G,EACZ,OAAO1I,EAAiBM,0CAA4CN,EAAiBG,2BACvF,CAGF,IAAKqI,IAAUxC,GAASA,EAAMhrB,gBAAkBwtB,EAAMxtB,cACrD,OACCglB,EAAiBC,+BACjBD,EAAiBM,2CAChBE,EAAQwF,EAAMhrB,eAAiBwlB,EAAQgI,EAAMxtB,eAC3CglB,EAAiBG,4BACjBH,EAAiBE,6BAGtB,GAAIwI,GAASF,IAAUxC,EACtB,OAAOhG,EAAiBI,2BAA6BJ,EAAiBE,4BAEvE,GAAIuI,GAASD,IAAUxC,EACtB,OAAOhG,EAAiBK,+BAAiCL,EAAiBG,4BAK3E,IAFA,IAAIwI,EAAS,GACTC,EAAYJ,EAAMrrC,WACfyrC,GAAW,CACjB,IAAKF,GAASE,IAAc5C,EAC3B,OAAOhG,EAAiBK,+BAAiCL,EAAiBG,4BAE3EwI,EAAO1vE,KAAK2vE,GACZA,EAAYA,EAAUzrC,UACvB,CACAwrC,EAAO3wE,UAIP,IAFA,IAAI6wE,EAAS,GACTC,EAAY9C,EAAM7oC,WACf2rC,GAAW,CACjB,IAAKL,GAASK,IAAcN,EAC3B,OAAOxI,EAAiBI,2BAA6BJ,EAAiBE,4BAEvE2I,EAAO5vE,KAAK6vE,GACZA,EAAYA,EAAU3rC,UACvB,CACA0rC,EAAO7wE,UAEP,IAAI+wE,EAAKxI,EAAeoI,EAAQE,GAChC,IAAK,IAAI7rD,KAAK+rD,EAAGp/D,WAAY,CAC5B,IAAI40B,EAAQwqC,EAAGp/D,WAAWqT,GAC1B,GAAIuhB,IAAUynC,EAAO,OAAOhG,EAAiBG,4BAC7C,GAAI5hC,IAAUiqC,EAAO,OAAOxI,EAAiBE,4BAC7C,GAAI2I,EAAO/7D,QAAQyxB,IAAU,EAAG,OAAOyhC,EAAiBG,4BACxD,GAAIwI,EAAO77D,QAAQyxB,IAAU,EAAG,OAAOyhC,EAAiBE,2BACzD,CACA,OAAO,CACR,GAkBDnB,EAAKI,EAAUgD,GACfpD,EAAKI,EAAUgD,EAAK3pE,WACpBumE,EAAKiB,EAAkBmC,GACvBpD,EAAKiB,EAAkBmC,EAAK3pE,WAsiB5B8pE,EAAS9pE,UAAY,CAOpBwuE,eAAgB,KAChB7pE,SAAU,YACVuhC,SAAUkhC,EAOVzF,QAAS,KACThzD,gBAAiB,KACjB85D,KAAM,EAENlkB,aAAc,SAAUylB,EAAUwF,GAEjC,GAAIxF,EAAS9jC,WAAaohC,EAAwB,CAEjD,IADA,IAAIvhC,EAAQikC,EAASjgD,WACdgc,GAAO,CACb,IAAItjB,EAAOsjB,EAAM0c,YACjB5nD,KAAK0pD,aAAaxe,EAAOypC,GACzBzpC,EAAQtjB,CACT,CACA,OAAOunD,CACR,CAOA,OANAoB,GAAcvwE,KAAMmvE,EAAUwF,GAC9BxF,EAASxnB,cAAgB3nD,KACI,OAAzBA,KAAK8T,iBAA4Bq7D,EAAS9jC,WAAa0gC,IAC1D/rE,KAAK8T,gBAAkBq7D,GAGjBA,CACR,EACAhgD,YAAa,SAAUylD,GACtB,IAAIe,EAAUvG,GAAapvE,KAAM40E,GAIjC,OAHIe,IAAY31E,KAAK8T,kBACpB9T,KAAK8T,gBAAkB,MAEjB6hE,CACR,EACA/rC,aAAc,SAAUulC,EAAUyF,GAEjCrE,GAAcvwE,KAAMmvE,EAAUyF,EAAUvE,IACxClB,EAASxnB,cAAgB3nD,KACrB40E,GACH50E,KAAKmvB,YAAYylD,GAEdpF,GAAcL,KACjBnvE,KAAK8T,gBAAkBq7D,EAEzB,EAEAsD,WAAY,SAAUmD,EAAclD,GACnC,OAAOD,GAAWzyE,KAAM41E,EAAclD,EACvC,EAEA7+D,eAAgB,SAAU3P,GACzB,IAAI2xE,EAAM,KASV,OARA7G,EAAWhvE,KAAK8T,iBAAiB,SAAUyC,GAC1C,GAAIA,EAAK80B,UAAY0gC,GAChBx1D,EAAK21B,aAAa,OAAShoC,EAE9B,OADA2xE,EAAMt/D,GACC,CAGV,IACOs/D,CACR,EAoBAptE,cAAe,SAAU+N,GACxB,IAAID,EAAO,IAAIq6D,GAAQ/F,GAcvB,OAbAt0D,EAAKoxC,cAAgB3nD,KACH,SAAdA,KAAKkM,OACRsK,EAAUA,EAAQzO,eAEf0iE,EAAwBzqE,KAAKgM,eAChCuK,EAAKg4D,aAAepN,EAAU6I,MAE/BzzD,EAAKzM,SAAW0M,EAChBD,EAAKC,QAAUA,EACfD,EAAKytD,UAAYxtD,EACjBD,EAAKD,WAAa,IAAIg3D,GACT/2D,EAAK0wB,WAAa,IAAI+mC,GAC7B6E,cAAgBt8D,EACfA,CACR,EAIAu/D,uBAAwB,WACvB,IAAIv/D,EAAO,IAAI86D,GAAiBxG,GAGhC,OAFAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACf/2D,CACR,EAKA8sD,eAAgB,SAAUxjE,GACzB,IAAI0W,EAAO,IAAIw6D,GAAKlG,GAIpB,OAHAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKu+D,WAAWj1E,GACT0W,CACR,EAKAw/D,cAAe,SAAUl2E,GACxB,IAAI0W,EAAO,IAAIyb,GAAQ64C,GAIvB,OAHAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKu+D,WAAWj1E,GACT0W,CACR,EAKAy/D,mBAAoB,SAAUn2E,GAC7B,IAAI0W,EAAO,IAAIy6D,GAAanG,GAI5B,OAHAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKu+D,WAAWj1E,GACT0W,CACR,EAMA0/D,4BAA6B,SAAUlzE,EAAQlD,GAC9C,IAAI0W,EAAO,IAAI+6D,GAAsBzG,GAKrC,OAJAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKzM,SAAWyM,EAAKxT,OAASA,EAC9BwT,EAAKg1B,UAAYh1B,EAAK1W,KAAOA,EACtB0W,CACR,EAeA2/D,gBAAiB,SAAU7tE,GAC1B,IAAKi9B,EAAE7T,YAAY7d,KAAKvL,GACvB,MAAM,IAAIk2B,EAAaA,EAAaW,sBAAuB,8BAAgC72B,EAAO,KAKnG,MAHkB,SAAdrI,KAAKkM,OACR7D,EAAOA,EAAKN,eAEN/H,KAAKm2E,iBAAiB9tE,EAC9B,EACA8tE,iBAAkB,SAAU9tE,GAC3B,IAAIkO,EAAO,IAAIs6D,GAAKhG,GAOpB,OANAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKlO,KAAOA,EACZkO,EAAKzM,SAAWzB,EAChBkO,EAAKytD,UAAY37D,EACjBkO,EAAK6/D,WAAY,EACV7/D,CACR,EAiBA8/D,sBAAuB,SAAUhuE,GAChC,IAAKi9B,EAAEvU,KAAKnd,KAAKvL,GAChB,MAAM,IAAIk2B,EAAaA,EAAaW,sBAAuB,yBAA2B72B,EAAO,KAE9F,GAAkB,SAAdrI,KAAKkM,KACR,MAAM,IAAIqyB,EAAa,+BAAgCxC,EAAiBU,mBAGzE,IAAIlmB,EAAO,IAAI66D,GAAgBvG,GAI/B,OAHAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKzM,SAAWzB,EACTkO,CACR,EAOAq9D,gBAAiB,SAAUrF,EAAcjD,GACxC,IAAIgL,EAAY/K,EAAmBgD,EAAcjD,GAC7C/0D,EAAO,IAAIq6D,GAAQ/F,GACnBoH,EAAS17D,EAAK0wB,WAAa,IAAI+mC,EASnC,OARAz3D,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKzM,SAAWwhE,EAChB/0D,EAAKC,QAAU80D,EACf/0D,EAAKg4D,aAAe+H,EAAU,GAC9B//D,EAAK0tD,OAASqS,EAAU,GACxB//D,EAAKytD,UAAYsS,EAAU,GAC3BrE,EAAMY,cAAgBt8D,EACfA,CACR,EAOAggE,kBAAmB,SAAUhI,EAAcjD,GAC1C,IAAIgL,EAAY/K,EAAmBgD,EAAcjD,GAC7C/0D,EAAO,IAAIs6D,GAAKhG,GASpB,OARAt0D,EAAKoxC,cAAgB3nD,KACrBuW,EAAKD,WAAa,IAAIg3D,EACtB/2D,EAAKzM,SAAWwhE,EAChB/0D,EAAKlO,KAAOijE,EACZ/0D,EAAK6/D,WAAY,EACjB7/D,EAAKg4D,aAAe+H,EAAU,GAC9B//D,EAAK0tD,OAASqS,EAAU,GACxB//D,EAAKytD,UAAYsS,EAAU,GACpB//D,CACR,GAED87B,EAAS48B,EAAUH,GAOnB8B,GAAQzrE,UAAY,CACnBkmC,SAAU0gC,EAMV9kC,WAAY,KACZuvC,iBAAkB,WACjB,OAAOx2E,KAAKikE,OAASjkE,KAAKikE,OAAS,IAAMjkE,KAAKgkE,UAAYhkE,KAAKgkE,SAChE,EACAmP,8BAA+B,WAC9B,MAAmC,SAA5BnzE,KAAK2nD,cAAcz7C,MAAmBlM,KAAKuuE,eAAiBpN,EAAU6I,IAC9E,EAQAyM,cAAe,WACd,SAAUz2E,KAAKinC,aAAcjnC,KAAKinC,WAAW7lC,OAC9C,EACAs1E,aAAc,SAAUruE,GACvB,QAASrI,KAAK22E,iBAAiBtuE,EAChC,EAQA6jC,aAAc,SAAU7jC,GACvB,IAAIsmE,EAAO3uE,KAAK22E,iBAAiBtuE,GACjC,OAAOsmE,EAAOA,EAAK5nE,MAAQ,IAC5B,EACA4vE,iBAAkB,SAAUtuE,GAI3B,OAHIrI,KAAKmzE,kCACR9qE,EAAOA,EAAKN,eAEN/H,KAAKinC,WAAWisC,aAAa7qE,EACrC,EAOA4S,aAAc,SAAU5S,EAAMtB,GACzB/G,KAAKmzE,kCACR9qE,EAAOA,EAAKN,eAEb,IAAI4mE,EAAO3uE,KAAK22E,iBAAiBtuE,GAC7BsmE,EACHA,EAAK5nE,MAAQ4nE,EAAKpjC,UAAY,GAAKxkC,IAEnC4nE,EAAO3uE,KAAK2nD,cAAcwuB,iBAAiB9tE,IACtCtB,MAAQ4nE,EAAKpjC,UAAY,GAAKxkC,EACnC/G,KAAK8yE,iBAAiBnE,GAExB,EACAplB,gBAAiB,SAAUlhD,GAC1B,IAAIsmE,EAAO3uE,KAAK22E,iBAAiBtuE,GACjCsmE,GAAQ3uE,KAAK42E,oBAAoBjI,EAClC,EACAmE,iBAAkB,SAAU3E,GAC3B,OAAOnuE,KAAKinC,WAAWmsC,aAAajF,EACrC,EACA0I,mBAAoB,SAAU1I,GAC7B,OAAOnuE,KAAKinC,WAAWqsC,eAAenF,EACvC,EACAyI,oBAAqB,SAAUxI,GAE9B,OAAOpuE,KAAKinC,WAAWssC,gBAAgBnF,EAAQtkE,SAChD,EAEAgtE,kBAAmB,SAAUvI,EAAcvK,GAC1C,IAAI+S,EAAM/2E,KAAKy0E,mBAAmBlG,EAAcvK,GAChD+S,GAAO/2E,KAAK42E,oBAAoBG,EACjC,EAEAC,eAAgB,SAAUzI,EAAcvK,GACvC,OAA2D,MAApDhkE,KAAKy0E,mBAAmBlG,EAAcvK,EAC9C,EAUAiT,eAAgB,SAAU1I,EAAcvK,GACvC,IAAI2K,EAAO3uE,KAAKy0E,mBAAmBlG,EAAcvK,GACjD,OAAO2K,EAAOA,EAAK5nE,MAAQ,IAC5B,EAUAmwE,eAAgB,SAAU3I,EAAcjD,EAAevkE,GACtD,IACIi9D,EADYuH,EAAmBgD,EAAcjD,GACvB,GACtBqD,EAAO3uE,KAAKy0E,mBAAmBlG,EAAcvK,GAC7C2K,EACHA,EAAK5nE,MAAQ4nE,EAAKpjC,UAAY,GAAKxkC,IAEnC4nE,EAAO3uE,KAAK2nD,cAAc4uB,kBAAkBhI,EAAcjD,IACrDvkE,MAAQ4nE,EAAKpjC,UAAY,GAAKxkC,EACnC/G,KAAK8yE,iBAAiBnE,GAExB,EACA8F,mBAAoB,SAAUlG,EAAcvK,GAC3C,OAAOhkE,KAAKinC,WAAWosC,eAAe9E,EAAcvK,EACrD,EAoBAt6D,uBAAwB,SAAUytE,GACjC,IAAIC,EAAgBlM,EAAaiM,GACjC,OAAO,IAAI5J,EAAavtE,MAAM,SAAUywC,GACvC,IAAIo9B,EAAK,GAoBT,OAnBIuJ,EAAch2E,OAAS,GAC1B4tE,EAAWv+B,GAAM,SAAUl6B,GAC1B,GAAIA,IAASk6B,GAAQl6B,EAAK80B,WAAa0gC,EAAc,CACpD,IAAIsL,EAAiB9gE,EAAK21B,aAAa,SAEvC,GAAImrC,EAAgB,CAEnB,IAAI9jC,EAAU4jC,IAAeE,EAC7B,IAAK9jC,EAAS,CACb,IAAI+jC,EAAoBpM,EAAamM,GACrC9jC,EAAU6jC,EAAcG,OAn1ET9vD,EAm1E6B6vD,EAl1E5C,SAAU9wE,GAChB,OAAOihB,IAAmC,IAA3BA,EAAKhO,QAAQjT,EAC7B,GAi1EM,CACI+sC,GACHs6B,EAAGjoE,KAAK2Q,EAEV,CACD,CAz1EL,IAAuBkR,CA01EnB,IAEMomD,CACR,GACD,EA0BA95D,qBAAsB,SAAUu3D,GAC/B,IAAIkM,EAAwF,UAAtEx3E,KAAKqrC,WAAakhC,EAAgBvsE,KAAOA,KAAK2nD,eAAez7C,KAC/EurE,EAAqBnM,EAAcvjE,cACvC,OAAO,IAAIwlE,EAAavtE,MAAM,SAAUywC,GACvC,IAAIo9B,EAAK,GAeT,OAdAmB,EAAWv+B,GAAM,SAAUl6B,GACtBA,IAASk6B,GAAQl6B,EAAK80B,WAAa0gC,KAGjB,MAAlBT,GAGqB/0D,EAAKigE,sBACTgB,GAAkBjhE,EAAKg4D,eAAiBpN,EAAU6I,KAAOyN,EAAqBnM,KAHlGuC,EAAGjoE,KAAK2Q,GAQV,IACOs3D,CACR,GACD,EACA6J,uBAAwB,SAAUnJ,EAAcvK,GAC/C,OAAO,IAAIuJ,EAAavtE,MAAM,SAAUywC,GACvC,IAAIo9B,EAAK,GAWT,OAVAmB,EAAWv+B,GAAM,SAAUl6B,GAEzBA,IAASk6B,GACTl6B,EAAK80B,WAAa0gC,GACA,MAAjBwC,GAAwBh4D,EAAKg4D,eAAiBA,GAChC,MAAdvK,GAAqBztD,EAAKytD,WAAaA,GAExC6J,EAAGjoE,KAAK2Q,EAEV,IACOs3D,CACR,GACD,GAEDoB,EAAS9pE,UAAUuE,uBAAyBknE,GAAQzrE,UAAUuE,uBAC9DulE,EAAS9pE,UAAU4O,qBAAuB68D,GAAQzrE,UAAU4O,qBAC5Dk7D,EAAS9pE,UAAUuyE,uBAAyB9G,GAAQzrE,UAAUuyE,uBAE9DrlC,EAASu+B,GAAS9B,GAQlB+B,GAAK1rE,UAAUkmC,SAAW2gC,EAC1B35B,EAASw+B,GAAM/B,GAKfgC,GAAc3rE,UAAY,CACzBtF,KAAM,GACN83E,cAAe,SAAUhuE,EAAQiuE,GAChC,OAAO53E,KAAKH,KAAKiX,UAAUnN,EAAQA,EAASiuE,EAC7C,EACA9C,WAAY,SAAUjzE,GACrBA,EAAO7B,KAAKH,KAAOgC,EACnB7B,KAAKurC,UAAYvrC,KAAKH,KAAOgC,EAC7B7B,KAAKoB,OAASS,EAAKT,MACpB,EACAy2E,WAAY,SAAUluE,EAAQ9H,GAC7B7B,KAAK83E,YAAYnuE,EAAQ,EAAG9H,EAC7B,EACAk2E,WAAY,SAAUpuE,EAAQiuE,GAC7B53E,KAAK83E,YAAYnuE,EAAQiuE,EAAO,GACjC,EACAE,YAAa,SAAUnuE,EAAQiuE,EAAO/1E,GAGrCA,EAFY7B,KAAKH,KAAKiX,UAAU,EAAGnN,GAEpB9H,EADL7B,KAAKH,KAAKiX,UAAUnN,EAASiuE,GAEvC53E,KAAKurC,UAAYvrC,KAAKH,KAAOgC,EAC7B7B,KAAKoB,OAASS,EAAKT,MACpB,GAEDixC,EAASy+B,GAAehC,GAIxBiC,GAAK5rE,UAAY,CAChB2E,SAAU,QACVuhC,SAAU4gC,EACV+L,UAAW,SAAUruE,GACpB,IAAI9H,EAAO7B,KAAKH,KACZo4E,EAAUp2E,EAAKiV,UAAUnN,GAC7B9H,EAAOA,EAAKiV,UAAU,EAAGnN,GACzB3J,KAAKH,KAAOG,KAAKurC,UAAY1pC,EAC7B7B,KAAKoB,OAASS,EAAKT,OACnB,IAAI82E,EAAUl4E,KAAK2nD,cAAc0b,eAAe4U,GAIhD,OAHIj4E,KAAK8pC,YACR9pC,KAAK8pC,WAAW4f,aAAawuB,EAASl4E,KAAK4nD,aAErCswB,CACR,GAED7lC,EAAS0+B,GAAMD,IAIf9+C,GAAQ7sB,UAAY,CACnB2E,SAAU,WACVuhC,SAAUihC,GAEXj6B,EAASrgB,GAAS8+C,IAKlBE,GAAa7rE,UAAY,CACxB2E,SAAU,iBACVuhC,SAAU6gC,GAEX75B,EAAS2+B,GAAcD,IAKvBE,GAAa9rE,UAAUkmC,SAAWmhC,EAClCn6B,EAAS4+B,GAAcnC,GAKvBoC,GAAS/rE,UAAUkmC,SAAWqhC,EAC9Br6B,EAAS6+B,GAAUpC,GAKnBqC,GAAOhsE,UAAUkmC,SAAW+gC,EAC5B/5B,EAAS8+B,GAAQrC,GAKjBsC,GAAgBjsE,UAAUkmC,SAAW8gC,EACrC95B,EAAS++B,GAAiBtC,GAK1BuC,GAAiBlsE,UAAU2E,SAAW,qBACtCunE,GAAiBlsE,UAAUkmC,SAAWohC,EACtCp6B,EAASg/B,GAAkBvC,GAK3BwC,GAAsBnsE,UAAUkmC,SAAWghC,EAC3Ch6B,EAASi/B,GAAuBR,IAEhCS,GAAcpsE,UAAU2sE,kBAAoB,SAAUv7D,EAAMk7D,GAC3D,OAAOD,GAAsBryE,KAAKoX,EAAMk7D,EACzC,EACA3C,EAAK3pE,UAAUqoC,SAAWgkC,GAoW1B,IACC,GAAItwE,OAAO+wC,eAAgB,CAiC1B,SAASkmC,GAAe5hE,GACvB,OAAQA,EAAK80B,UACZ,KAAK0gC,EACL,KAAKU,EACJ,IAAIiF,EAAM,GAEV,IADAn7D,EAAOA,EAAK2Y,WACL3Y,GACgB,IAAlBA,EAAK80B,UAAoC,IAAlB90B,EAAK80B,UAC/BqmC,EAAI9rE,KAAKuyE,GAAe5hE,IAEzBA,EAAOA,EAAKqxC,YAEb,OAAO8pB,EAAI5rE,KAAK,IACjB,QACC,OAAOyQ,EAAKg1B,UAEf,CAhDArqC,OAAO+wC,eAAes7B,EAAapoE,UAAW,SAAU,CACvDqxB,IAAK,WAEJ,OADAk3C,EAAgB1tE,MACTA,KAAK+tE,QACb,IAGD7sE,OAAO+wC,eAAe68B,EAAK3pE,UAAW,cAAe,CACpDqxB,IAAK,WACJ,OAAO2hD,GAAen4E,KACvB,EAEAmH,IAAK,SAAUtH,GACd,OAAQG,KAAKqrC,UACZ,KAAK0gC,EACL,KAAKU,EACJ,KAAOzsE,KAAKkvB,YACXlvB,KAAKmvB,YAAYnvB,KAAKkvB,aAEnBrvB,GAAQqiE,OAAOriE,KAClBG,KAAKmI,YAAYnI,KAAK2nD,cAAc0b,eAAexjE,IAEpD,MAED,QACCG,KAAKH,KAAOA,EACZG,KAAK+G,MAAQlH,EACbG,KAAKurC,UAAY1rC,EAEpB,IAqBDiuE,GAAU,SAAUt8B,EAAQ1qC,EAAKC,GAEhCyqC,EAAO,KAAO1qC,GAAOC,CACtB,CACD,CACD,CAAE,MAAO9E,IAET,CAEAlD,EAAQ2uE,gBAAkBA,EAC1B3uE,EAAQ8xE,KAAOA,GACf9xE,EAAQiyE,aAAeA,GACvBjyE,EAAQ+xE,cAAgBA,GACxB/xE,EAAQizB,QAAUA,GAClBjzB,EAAQkwE,SAAWA,EACnBlwE,EAAQsyE,iBAAmBA,GAC3BtyE,EAAQkyE,aAAeA,GACvBlyE,EAAQ8vE,kBAAoBA,EAC5B9vE,EAAQ6xE,QAAUA,GAClB7xE,EAAQoyE,OAASA,GACjBpyE,EAAQqyE,gBAAkBA,GAC1BryE,EAAQwuE,aAAeA,EACvBxuE,EAAQivE,aAAeA,EACvBjvE,EAAQ+vE,KAAOA,EACf/vE,EAAQuuE,SAAWA,EACnBvuE,EAAQmyE,SAAWA,GACnBnyE,EAAQgyE,KAAOA,GACfhyE,EAAQuyE,sBAAwBA,GAChCvyE,EAAQwyE,cAAgBA,E,6DC1iGxB,SAAS6G,EAAKx4E,GAIV,GAHAI,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,0BAEZS,gBAAgBo4E,GAClB,MAAM,IAAIn0E,UAAU,mDAUxB,GAPAjE,KAAKJ,QAAUA,GAAW,CAAC,EAK3BI,KAAK0gE,WAAa1gE,KAAKJ,QAAQC,MAE1BG,KAAK0gE,WACN,MAAM,IAAIz8D,UAAU,qCAOxBjE,KAAKq4E,aAAer4E,KAAKJ,QAAQqmB,MAAM8xC,SAAW,MAMlD/3D,KAAKs4E,aAAet4E,KAAKJ,QAAQqmB,MAAMkoC,SAAW,QAMlDnuD,KAAKu4E,gBAAkBv4E,KAAKJ,QAAQqmB,MAAM06C,YAAc,SAMxD3gE,KAAKw4E,mBAAqBx4E,KAAKJ,QAAQqmB,MAAMwyD,eAAiB,SAM9Dz4E,KAAK04E,aAAe14E,KAAKJ,QAAQqmB,MAAMnb,SAAW,UAMlD9K,KAAKN,OAASM,KAAKJ,QAAQF,QAAU,KACzC,CAEA04E,EAAIjzE,UAAY,CAUZspC,cAAgB,KAKhBrpC,YAAcgzE,EAKdO,SAAW,CACPniD,IAAM,CACFzvB,MAAQ,iKAOR6N,MAAQ,oBAGZgkE,KAAO,CAEH7xE,MAAQ,oYAcR6N,MAAQ,oIAchBikE,mBAAqB,WAajB,MAZS,CACL,wDACA,2CACA,yCACA,+CACA,6CACA,yCACA,yCACA,+CACA,8CAGM/yE,KAAK,IACnB,EAOAgzE,wBAA0B,WACtB,MAAO,uGACX,EAuCApqC,qBAAuB,WACnB1uC,KAAKX,OAAOE,MAAM,gCAElB,IAAIo5E,EAAW,GACf,GAAoB,SAAhB34E,KAAKN,OACLi5E,EAAW34E,KAAK24E,SAASC,KAAK7xE,UAC3B,IAAoB,QAAhB/G,KAAKN,OAIZ,OADAM,KAAKX,OAAOqB,MAAM,+CACX,EAHPi4E,EAAW34E,KAAK24E,SAASniD,IAAIzvB,KAIjC,CAiBA,OAXA4xE,GADAA,GADAA,GADAA,GADAA,EAAWA,EAAStqE,QAAQ,eAAgBrO,KAAKq4E,eAC7BhqE,QAAQ,eAAgBrO,KAAKs4E,eAC7BjqE,QAAQ,qBAAsBrO,KAAKw4E,qBACnCnqE,QAAQ,kBAAmBrO,KAAKu4E,kBAChClqE,QAAQ,eAAgBrO,KAAK04E,cAG7B,SAAhB14E,KAAKN,SAELi5E,GADAA,EAAWA,EAAStqE,QAAQ,iBAAkBrO,KAAK64E,qBAC/BxqE,QAAQ,sBAAuBrO,KAAK84E,2BAI5DH,EAAWA,EAAStqE,QAAQ,2BAA4BrO,KAAK+4E,qBAO7D/4E,KAAKyuC,cAAgBkqC,EACrB34E,KAAKX,OAAOE,MAAM,kBAAmBo5E,IAE9B,IAPH34E,KAAKX,OAAOmU,KAAK,uCACV,EAOf,EAOAulE,gBAAkB,WACd/4E,KAAKX,OAAOE,MAAM,2BASlB,IANA,IAQeqnB,EARXoyD,EAAuB,QAAhBh5E,KAAKN,OAAmBM,KAAK24E,SAASniD,IAAI5hB,MAAQ5U,KAAK24E,SAASC,KAAKhkE,MAC5E8L,EAAsB,QAAhB1gB,KAAKN,OAAmB,IAAM,GAEpCuL,EAAS,GACTguE,EAAOj5E,KACPiG,EAAMjG,KAAK0gE,WAAWt4B,UACjBhzB,EAAI,EAAGA,EAAInP,EAAI7E,OAAQgU,IAEjBwR,EAKRxR,EAJKsL,IACAA,EAAOkG,IAAM3gB,EAAI7E,OAAS,EAAK,GAAK,KAExC6J,EAASA,EAAOslB,OAAO0oD,EAAKC,eAAeF,EAAM/yE,EAAI2gB,GAAGjhB,EAAGM,EAAI2gB,GAAG1gB,GAAIwa,GAI9E,OAAOzV,CACX,EAUAiuE,eAAiB,SAAUF,EAAMlyE,EAAKjH,GAClC,IAAIs5E,EAAMH,EAGV,OADAG,GADAA,EAAMA,EAAI9qE,QAAQ,WAAYvH,IACpBuH,QAAQ,YAAaxO,EAEnC,EAOAu5E,UAAY,SAAU15E,GACH,QAAXA,GAA+B,SAAXA,EACpBM,KAAKN,OAASA,EAEdM,KAAKX,OAAOmU,KAAK,qCAEzB,EAOA6lE,UAAY,WACR,OAAOr5E,KAAKN,MAChB,GAGJ,S,qGCnKA,QAhIkC,CAoB9BolB,MAAQ,SAAUllB,GAEd,IAAIP,EAAS,IAAOC,UAAU,+BAC9BD,EAAOE,MAAM,CAAC,yCAEd,IAAIM,EAAO,KAEX,GAAID,EAAQW,SAAZ,CACI,GAAIX,EAAQ4K,YACRnL,EAAOE,MAAM,0BACbM,EAAOD,EAAQW,aACZ,CACH,IAAI6rC,EAAe,KAQnB,GANIA,EAD4B,iBAArBxsC,EAAQW,SACAiD,KAAKC,MAAM7D,EAAQW,UAEnBX,EAAQW,SAIT,CAEd,GAAI6rC,EAAa1rC,MAOb,YALAd,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BmiC,EAAa1rC,MAAMiG,aAC3E3E,OAASoqC,EAAa1rC,MAAMk+B,KAC5B1yB,KAAO,IAAaC,eAS5B,GAHAtM,EAAO,IAAI,EAAA6lB,GAGP0mB,EAAa9e,UAAW9jB,MAAM4E,QAAQg+B,EAAa9e,SAiCnD,YADA1tB,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,+BA7BrE,IAFA,IAAIy9B,EAAoB,KAEftyB,EAAI,EAAGA,EAAIg3B,EAAa9e,QAAQlsB,OAAQgU,IAAK,CAClD,IAAInK,EAASmhC,EAAa9e,QAAQlY,GAClCsyB,EAAoB,IAAI,IAEpBz8B,IACuB,kBAAnBA,EAAOquE,SACP5xC,EAAkBD,OAASx8B,EAAOw8B,OAClCC,EAAkBx7B,KAAO,iBACC,uBAAnBjB,EAAOquE,UACd5xC,EAAkBI,IAAM78B,EAAOw8B,OAC/BC,EAAkBx7B,KAAO,qBACzBw7B,EAAkB6xC,QAAUtuE,EAAOsuE,SAGnC7xC,EAAkBrjC,WAClBqjC,EAAkBrjC,SAASiB,EAAI2F,EAAO3F,EACtCoiC,EAAkBrjC,SAASkB,EAAI0F,EAAO1F,GAG1CmiC,EAAkBK,KAAO98B,EAAO88B,KAChCL,EAAkBG,QAAU58B,EAAOs8B,KACnCG,EAAkBC,SAAW18B,EAAOuuE,SACpC9xC,EAAkBE,WAAa38B,EAAOwuE,QACtC/xC,EAAkBgyC,eAAiBzuE,EAAOyuE,gBAG9C75E,EAAKguB,mBAAmBjoB,KAAK8hC,EACjC,CAMJ,IAAK7nC,EAAKguB,mBAAmBzsB,OAEzB,YADAxB,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,8BAG7E,CAEA,IAAKpK,EAMD,YALAD,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,8BAC1BiC,KAAO,IAAaytE,YACpB33E,QAAU,KAMlB,GAAInC,EAAKksC,gBAML,YALAnsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BpK,EAAKksC,iBAC7D7/B,KAAO,IAAaC,YACpBnK,OAAS,MAIrB,CAQJpC,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAOF,EAHtC,MAFID,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAM7E,E,6DCjHJ,SAAS07D,EAAK/lE,GACV,KAAMI,gBAAgB2lE,GAClB,MAAM,IAAI1hE,UAAU,mDAKxBjE,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,yBAMlBS,KAAK45E,UAAY,KAMjB55E,KAAK0D,OAAS,KAMd1D,KAAK65E,OAAS,KAGVj6E,IACIA,EAAQg6E,WAA0C,iBAAtBh6E,EAAQg6E,YACpC55E,KAAK45E,UAAYh6E,EAAQg6E,UAEzB55E,KAAK0D,OAASo2E,EAAYl6E,EAAQg6E,YAElCh6E,EAAQi6E,QACR75E,KAAK+5E,UAAUn6E,EAAQi6E,QAGnC,CAwHA,SAASC,EAAaF,GAClB,GAAsB,oBAAXr4E,OAGP,OAAO,IAAIoC,EADK,aACOC,gBAAgBg2E,EAAW,YAIlD,IAAII,EACAt2E,EACAu2E,EAAW,qEAEf,GAAI14E,OAAOsC,cAAe,EAEtBH,EAAS,IAAInC,OAAOsC,cAAc,qBAC3BC,OAAQ,EACfJ,EAAOK,QAAQ61E,GACf,IAAIM,EAAax2E,EAAOw2E,WACxB,GAAIA,EAAWC,UAOX,MANID,EAAWj+D,MAAQi+D,EAAWE,UAC9BH,GAAY,WAAaC,EAAWj+D,KAAO,aAAei+D,EAAWE,SAErEF,EAAWG,SACXJ,GAAY,MAAQC,EAAWG,OAAS,KAEtC,IAAI56E,MAAMw6E,GAEpB,OAAOv2E,CACX,CAAO,GAAInC,OAAOoC,UAAW,CAEzBq2E,EAAS,IAAIz4E,OAAOoC,UACpB,IACID,EAASs2E,EAAOp2E,gBAAgBg2E,EAAW,WAC/C,CAAE,MAAO33E,GAEL,KAAkB,gBAAdA,EAAEH,QACI,IAAIrC,MAAMw6E,GAEV,IAAIx6E,MAAM,qDAAuDwC,EAAEH,QAEjF,CAEA,GAAI4B,EAAOqQ,qBAAqB,eAAe3S,OAAS,EAEpD,IADA,IAAIk5E,EAAc52E,EAAOqQ,qBAAqB,eACrCqB,EAAI,EAAGA,EAAIklE,EAAYl5E,OAAQgU,IAAK,CACzC,IAAIlV,EAAUo6E,EAAYllE,GAAGjD,UAE7B,IAA8C,IAA1CjS,EAAQuZ,QAAQ,qBAEhB,MADAwgE,GAAY,IAAM/5E,EAAU,IACtB,IAAIT,MAAMw6E,EAExB,MACG,IAAKv2E,EAAOoQ,gBACf,MAAM,IAAIrU,MAAMw6E,GAEpB,OAAOv2E,CACX,CAEI,MAAM,IAAIjE,MAAM,+CAG5B,CAgDA,SAAS86E,EAAehkE,GACpB,IAAI1W,EAAO,CAAC,EAGZ,GAAI0W,EAAK0wB,WAAW7lC,OAAS,EAAG,CAC5B,IAAIo5E,EAgDZ,SAA0BjkE,GACtB,GAAIA,EAAK0wB,WAAW7lC,OAAS,EAAG,CAG5B,IAFA,IAAIq5E,EAAiB,CAAC,EAClBxzC,EAAa1wB,EAAK0wB,WACb7xB,EAAI,EAAGA,EAAI6xB,EAAW7lC,OAAQgU,IAAK,CACxC,IAAIslE,EAAYzzC,EAAW7xB,GAC3BqlE,EAAeC,EAAU5wE,UAAY4wE,EAAUnvC,SACnD,CACA,OAAOkvC,CACX,CACJ,CA1D6BE,CAAgBpkE,GACrC1W,EAAiB,WAAI26E,CACzB,CAGA,GAAIjkE,EAAK00B,gBAKL,IAJA,IACIC,EADA0vC,EAAY,CAAC,EAEb3yE,EAAWsO,EAAKD,WAEXlB,EAAI,EAAGA,EAAInN,EAAS7G,OAAQgU,IAGjC,GAAuB,KAFvB81B,EAAQjjC,EAASmN,IAEPi2B,SACNxrC,EAAkB,YAAIqrC,EAAMK,eACzB,GAAuB,IAAnBL,EAAMG,SAGb,GAFAuvC,EAAYL,EAAcrvC,GAErBrrC,EAAKqrC,EAAMphC,UAGT,CAGH,IAAKN,MAAM4E,QAAQvO,EAAKqrC,EAAMphC,WAAY,CACtC,IAAIitE,EAAMl3E,EAAKqrC,EAAMphC,UACrBjK,EAAKqrC,EAAMphC,UAAY,GACvBjK,EAAKqrC,EAAMphC,UAAUlE,KAAKmxE,EAC9B,CACAl3E,EAAKqrC,EAAMphC,UAAUlE,KAAKg1E,EAC9B,MAVI/6E,EAAKqrC,EAAMphC,UAAY8wE,EAgBvC,OAAO/6E,CACX,CA7QA8lE,EAAIxgE,UAAY,CASZC,YAAcugE,EAOdkV,aAAe,WACX,OAAO76E,KAAK45E,SAChB,EASAkB,aAAe,SAAUlB,GACjBA,GAAkC,iBAAdA,IACpB55E,KAAK45E,UAAYA,EACjB55E,KAAK0D,OAASo2E,EAAYF,GAElC,EAQAmB,UAAY,WACR,OAAO/6E,KAAK65E,MAChB,EAUAE,UAAY,SAAUF,GACdA,GAAUA,EAAO1tC,MAA+B,mBAAhB0tC,EAAO1tC,OACvCnsC,KAAK65E,OAASA,EAEtB,EAOAmB,UAAY,WACR,OAAOh7E,KAAK0D,MAChB,EAKAu3E,UAAY,SAAU7X,GAClBpjE,KAAK0D,OAAS0/D,CAClB,EAUA3/D,MAAQ,WAKJ,IAHKzD,KAAK0D,QAAU1D,KAAK45E,YACrB55E,KAAK0D,OAASo2E,EAAY95E,KAAK45E,YAE/B55E,KAAK0D,OAAQ,CACb,IAEQw3E,EAFJnwC,EAuGhB,SAAwBrnC,GACpB,IAAIqnC,EACoB,IAApBrnC,EAAO2nC,SAEPN,EAAOrnC,EAAOoQ,gBACa,IAApBpQ,EAAO2nC,WACdN,EAAOrnC,GAEX,OAAOqnC,CACX,CAhHuBowC,CAAcn7E,KAAK0D,QAC9B,OAAIqnC,GAGI/qC,KAAK65E,QAAU75E,KAAK65E,OAAO1tC,KAC3B+uC,EAAel7E,KAAK65E,OAAO1tC,KAAKpB,IAEhCmwC,EAAe,CAAC,GACHnwC,EAAKjhC,UAAYywE,EAAcxvC,GAEzCmwC,GAEA,CAAC,CAEhB,CACJ,GA6LJ,S,uFCvWA,MAAM,EAA+Bl8E,GAAGk2B,K,wBCAxC,MAAM,EAA+Bl2B,GAAGo8E,O,wHCApCC,EAAoB,CAEpBC,WAAa,yBACbC,UAAY,2BACZC,UAAY,2BAOZC,aAAe,SAAUC,GACrB,OAAQA,EAAO17E,KAAKs7E,WAAa,IAAMI,EAAM17E,KAAKs7E,UACtD,EAOAK,YAAc,SAAUD,GACpB,OAAQA,EAAO17E,KAAKu7E,UAAY,IAAMG,EAAM17E,KAAKu7E,SACrD,EAOAK,YAAc,SAAUF,GACpB,OAAQA,EAAO17E,KAAKw7E,UAAY,IAAME,EAAM17E,KAAKw7E,SACrD,EAOAK,+BAAiC,SAAUH,GAOvC,IAAI/zE,EAAYa,SAASC,cAAc,OACvCd,EAAUzD,GAAKlE,KAAKy7E,aAAaC,GACjC/zE,EAAUe,UAAY,0BAEtB,IAAI6L,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK27E,YAAYD,GAC7BnnE,EAAO7L,UAAY,4FACnB6L,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAE5B,IAAItS,EAAO3I,KACXuU,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvChC,KAAK87E,OACL,IAAIC,EAASvzE,SAASqL,eAAelL,EAAKizE,YAAYF,IACzB,UAAzBK,EAAO98E,MAAM+U,QACb+nE,EAAO98E,MAAM+U,QAAU,OAEvB+nE,EAAO98E,MAAM+U,QAAU,OAE/B,IACArM,EAAUQ,YAAYoM,GAEtB,IAAIwnE,EAASvzE,SAASC,cAAc,OAkCpC,OAjCAszE,EAAO73E,GAAKlE,KAAK47E,YAAYF,GAC7BK,EAAO1pE,iBAAiB,SAAS,WAE7B,IA0BD,GAEH1K,EAAUQ,YAAY4zE,GAEfp0E,CACX,GAGJ,UClGA,IAAItI,EAAS2Q,EAAAA,EAAO1Q,UAAU,WAS1B08E,EAAiB,CAOjBC,SAAW,CAAC,EASZj7D,IAAM,SAAU/a,EAAKi2E,GAGjB,GAFA78E,EAAOE,MAAM,gBAAiB28E,GAEzBj2E,EAAL,CAMA,IAAI8E,EAA4B,oBAAXxJ,OAAyBA,OAAyB,oBAAToH,KAAuBA,KAAO,KACxFoC,IAKA/K,KAAKi8E,SAAWlxE,EAAQoxE,uBAAyB,CAAC,GAGtD,IAAIC,EAAen2E,EAAIuoB,mBACnB6tD,EAAcD,EAAaz0B,cAC3B20B,EAAQF,EAAal4E,GAEpBlE,KAAKi8E,UAAkD,IAAtC/6E,OAAOC,KAAKnB,KAAKi8E,UAAU76E,OAIxCpB,KAAKi8E,SAASK,KACft8E,KAAKi8E,SAASK,GAASrnE,EAAAA,EAAGC,aAJ9BlV,KAAKi8E,SAAW,CAAC,EACjBj8E,KAAKi8E,SAASK,GAASrnE,EAAAA,EAAGC,YAO9B,IAAIwmE,EAAM17E,KAAKi8E,SAASK,GACxB,IAAKD,EAAYxoE,eAAe7T,KAAKy7E,aAAaC,IAAO,CACrDr8E,EAAOE,MAAM,oBAEb,IAAIg9E,EAAmBv8E,KAAK67E,+BAA+BH,GAC3Da,EAAiBt9E,MAAMmiD,cAAgB,OACfg7B,EAAa1yE,uBAAuB,iCAC1C,GAAGvB,YAAYo0E,EAErC,CAGA,IAAIC,EAAkBH,EAAYxoE,eAAe7T,KAAK47E,YAAYF,IAClEQ,EAAKO,UAAUD,GACXzxE,IAGAA,EAAQoxE,sBAAwBn8E,KAAKi8E,UAEzC58E,EAAOE,MAAM,2BA5Cb,MAFIF,EAAOE,MAAM,uBA+CrB,GAGJkR,EAAAA,EAAMiI,OAAOsjE,EAAgBX,GAE7B,U,iCCvEIh8E,EAAS2Q,EAAAA,EAAO1Q,UAAU,YAU1Bo9E,EAAW,CASXC,sBAAwB,IAAIh3D,EAAAA,OAAO,CAC/ByS,OAAS,EACTrgB,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,UACRF,MAAQ,IAEZoE,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,6BAOhB8kE,yBAA2B,IAAI7sE,EAAAA,MAAM,CACjCiM,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,2BAEZD,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,UACR+kE,SAAW,CAAC,GAAI,IAChBjlE,MAAQ,MAOhBklE,0BAA4B,IAAI/sE,EAAAA,MAAM,CAClCiM,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,2BAEZD,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,UACRF,MAAQ,MAiBhB5H,MAAQ,CACJ+sE,cAAgB,GAChBC,YAAc,GACdC,eAAiB,IAWrBC,YAAc,KAMdC,cAAgB,KAMhBC,cAAgB,KAMhBC,iBAAmB,KAMnBC,OAAS,KAMTC,sBAAwB,KAMxBC,eAAiB,KAMjBC,mBAAqB,KAMrBC,YAAc,KAOd1zC,MAAQ,WACJ,IAAI2zC,EAAS79E,KAAKkF,UAElB7F,EAAOE,MAAM,IAAMs+E,EAAS,sBAI5B79E,KAAK89E,eACL99E,KAAK+9E,sBACL/9E,KAAKg+E,sBACLh+E,KAAKi+E,gBAAgBhjE,aAAa,gBAAgB,EACtD,EAWAijE,qBAAuB,SAAUj8E,GAC7B,IAAIA,EAAEk8E,SAAN,CAKA,IAAIC,EAAen8E,EAAEiqB,WAErB,GAAIlsB,KAAKw9E,OAAQ,CACb,IAAIa,EACAnpD,EAAQl1B,KAAKw9E,OAAO/jD,cAExB,GADA4kD,EAASr+E,KAAKL,OAAQu1B,GACC,eAAnBA,EAAKwE,UACL0kD,EAAelpD,EAAKopD,wBACjB,IAAuB,YAAnBppD,EAAKwE,UAGZ,OAFA0kD,EAAelpD,EAAKqpD,mBAAmB9jD,gBAG3C,CACAz6B,KAAKy9E,sBAAsBtrE,UAAYksE,EACvCr+E,KAAK09E,eAAezmB,YAAYmnB,EACpC,CAlBA,CAmBJ,EAUAI,mBAAqB,SAAUv8E,EAAGiK,GACD,SAAzBjK,EAAEc,OAAO2lB,aACT1oB,KAAKgoC,cAET,IAAI/hC,EAAMjG,KAAKiH,SACXw3E,EAAex4E,EAAIuoB,mBAAmBtqB,GAGtC6G,EAA4B,oBAAXxJ,OAAyBA,OAAyB,oBAAToH,KAAuBA,KAAO,KACxFoC,IAMA/K,KAAKkQ,MAAQnF,EAAQ2zE,iBAAmB,CAAC,GAI7C,IAAIC,EAAS3+E,KAAKkF,UAClB,IAAK,IAAIwD,KAAa1I,KAAKkQ,MACvB,GAAIlQ,KAAKkQ,MAAMxF,eAAehC,GAE1B,IADA,IAAI0c,EAAWplB,KAAKkQ,MAAMxH,GACjB0M,EAAI,EAAGA,EAAIgQ,EAAShkB,OAAQgU,IAAK,CACtC,IAAIwO,EAAIwB,EAAShQ,GACbwO,GAAKA,EAAE1E,QAAUxW,IAAci2E,GAAU/6D,EAAE3d,IAAI/B,KAAOu6E,IACtD76D,EAAE1E,QAAS,EACQ,OAAf0E,EAAEg7D,UACFh7D,EAAEg7D,SAAS10C,QAGvB,CAUR,GALA20C,EAAAA,EAAalnD,MAAM1xB,EAAK,CACpByhB,QAAU,aAIC,SADF1nB,KAAKi+E,gBAAgBv1D,YACX,CACnB1oB,KAAK8+E,mBACL9+E,KAAK++E,yBACL/+E,KAAKg/E,sBAAsB9yE,GAC3B,IAAK,IAAI0a,EAAI,EAAGA,EAAI5mB,KAAKkQ,MAAMyuE,GAAQv9E,OAAQwlB,IACvC5mB,KAAKkQ,MAAMyuE,GAAQ/3D,GAAG3gB,IAAI/B,KAAOu6E,IACjCz+E,KAAKkQ,MAAMyuE,GAAQ/3D,GAAG1H,QAAS,EAG3C,KAAO,CACHlf,KAAK89E,eACL99E,KAAK+9E,sBACL/9E,KAAKg+E,sBACL,IAAK,IAAIr4E,EAAI,EAAGA,EAAI3F,KAAKkQ,MAAMyuE,GAAQv9E,OAAQuE,IACvC3F,KAAKkQ,MAAMyuE,GAAQh5E,GAAGM,IAAI/B,KAAOu6E,IACjCz+E,KAAKkQ,MAAMyuE,GAAQh5E,GAAGuZ,QAAS,EAG3C,CACJ,EASA6+D,oBAAsB,WAClB,IAAI93E,EAAMjG,KAAKiH,SACf,GAAKhB,EAOL,IAHA,IAEIg5E,EAFeh5E,EAAIuoB,mBAEK9kB,uBAAuB,uBAC1C/D,EAAI,EAAGA,EAAIs5E,EAAS79E,OAAQuE,IAAK,CAItC,IAHA,IAAIyQ,EAAQ6oE,EAASt5E,GACjB2+D,EAAMluD,EAAMnO,SAAS7G,OACrB89E,EAAgB,GACX9pE,EAAI,EAAGA,EAAIkvD,EAAKlvD,IAAK,CAC1B,IAAImB,EAAOH,EAAMnO,SAASmN,GAC1B,GAA6B,IAAzBmB,EAAKtO,SAAS7G,OAAc,CAC5B,IAAI8pC,EAAQ30B,EAAKtO,SAAS,GACF,6CAApBijC,EAAMxiC,WACc,8CAApBwiC,EAAMxiC,WACNw2E,EAAct5E,KAAK2Q,EAE3B,CACJ,CACA,IAAK,IAAIqQ,EAAI,EAAGA,EAAIs4D,EAAc99E,OAAQwlB,IACtCxQ,EAAM+Y,YAAY+vD,EAAct4D,GAExC,CACJ,EAKAk3D,aAAe,WACX,IAAI73E,EAAMjG,KAAKiH,SAQXjH,KAAKs9E,gBACLr3E,EAAI8wD,YAAY/2D,KAAKs9E,eACrBt9E,KAAKs9E,cAAgB,MAGrBt9E,KAAKo9E,cACLn3E,EAAIk5E,kBAAkBn/E,KAAKo9E,aAC3Bp9E,KAAKo9E,YAAc,KAE3B,EASAgC,qBAAuB,SAAUn5E,GACzBjG,KAAKy9E,uBACLz9E,KAAKy9E,sBAAsB3zC,WAAW3a,YAAYnvB,KAAKy9E,uBAG3Dz9E,KAAKy9E,sBAAwBj1E,SAASC,cAAc,OACpDzI,KAAKy9E,sBAAsB/0E,UAAY,4CAEvC1I,KAAK09E,eAAiB,IAAI3uD,IAAJ,CAAY,CAC9BvoB,QAAUxG,KAAKy9E,sBACfzuD,WAAY,EACZrlB,OAAS,CAAC,GAAI,IACd01E,YAAc,kBAGlBp5E,EAAIgpB,WAAWjvB,KAAK09E,eACxB,EAQA4B,kBAAoB,SAAUr5E,GACtBjG,KAAK29E,oBACL39E,KAAK29E,mBAAmB7zC,WAAW3a,YAAYnvB,KAAK29E,oBAGxD39E,KAAK29E,mBAAqBn1E,SAASC,cAAc,OACjDzI,KAAK29E,mBAAmBj1E,UAAY,iBAEpC1I,KAAK49E,YAAc,IAAI7uD,IAAJ,CAAY,CAC3BvoB,QAAUxG,KAAK29E,mBACf3uD,WAAY,EACZrlB,OAAS,CAAC,GAAI,GACd01E,YAAc,gBAGlBp5E,EAAIgpB,WAAWjvB,KAAK49E,YACxB,EAOA2B,gCAAkC,SAAUlkD,GACxCr7B,KAAKJ,QAAQy7B,OAASA,GAAU,CAAC,EAGjCh8B,EAAOE,MAAM,cAAeS,KAAKJ,QAAQy7B,OAAOzS,OAGhD,IAAI42D,EAAiB,CACjBzqE,MAAQ2nE,EAASC,sBACjBzgE,KAAOwgE,EAASI,yBAAyBtnD,UACzCzd,OAAS2kE,EAASI,yBAAyB7mD,aAG3Cj2B,KAAKJ,QAAQy7B,OAAO3wB,eAAe,YAAc1K,KAAKJ,QAAQy7B,OAAOokD,mBAAmBp8D,QACxFm8D,EAAezqE,MAAQ/U,KAAKJ,QAAQy7B,OAAOokD,SAE3Cz/E,KAAKJ,QAAQy7B,OAAO3wB,eAAe,UAAY1K,KAAKJ,QAAQy7B,OAAOzS,iBAAiB3Y,EAAAA,QACzC,MAAvCjQ,KAAKJ,QAAQy7B,OAAOzS,MAAM4M,YAC1BgqD,EAAetjE,KAAOlc,KAAKJ,QAAQy7B,OAAOzS,MAAM4M,WAEP,MAAzCx1B,KAAKJ,QAAQy7B,OAAOzS,MAAMqN,cAC1BupD,EAAeznE,OAAS/X,KAAKJ,QAAQy7B,OAAOzS,MAAMqN,cAI1Dj2B,KAAKJ,QAAQy7B,OAAOzS,MAAQ,IAAI3Y,EAAAA,MAAMuvE,GAGtCngF,EAAOE,MAAM,eAAgBS,KAAKJ,QAAQy7B,OAAOqkD,QAEjD,IAAIC,EAAkB,CAClBzjE,KAAOwgE,EAASM,0BAA0BxnD,UAC1Czd,OAAS2kE,EAASM,0BAA0B/mD,aAG5Cj2B,KAAKJ,QAAQy7B,OAAO3wB,eAAe,WAAa1K,KAAKJ,QAAQy7B,OAAOqkD,kBAAkBzvE,EAAAA,QAC1C,MAAxCjQ,KAAKJ,QAAQy7B,OAAOqkD,OAAOlqD,YAC3BmqD,EAAgBzjE,KAAOlc,KAAKJ,QAAQy7B,OAAOqkD,OAAOlqD,WAER,MAA1Cx1B,KAAKJ,QAAQy7B,OAAOqkD,OAAOzpD,cAC3B0pD,EAAgB5nE,OAAS/X,KAAKJ,QAAQy7B,OAAOqkD,OAAOzpD,cAI5Dj2B,KAAKJ,QAAQy7B,OAAOqkD,OAAS,IAAIzvE,EAAAA,MAAM0vE,EAC3C,EAOAX,sBAAwB,SAAU9yE,GAC9B,IAAIjG,EAAMjG,KAAKiH,SAGX0B,EAAO3I,KACXA,KAAKo9E,YAAc,IAAI7yC,EAAAA,KAAgB,CACnC3tB,OAAS5c,KAAKq9E,cAEduC,UAAY,SAAU/+D,GAClB,OAAIA,EAAM+8B,cAAciiC,UAChBl3E,EAAK60E,QACLx9E,KAAK8/E,mBAEF,EAGf,EACA5zE,KAAOA,EACPjN,MAAQe,KAAKJ,QAAQy7B,OAAOzS,OAAS8zD,EAASI,2BAElD98E,KAAKo9E,YAAY2C,cAAc,CAC3B13E,KAAO,WACPuU,OAAS5c,OAEbiG,EAAI+5E,eAAehgF,KAAKo9E,aAGxBp9E,KAAKo/E,qBAAqBn5E,GAG1BjG,KAAKo9E,YAAYrvD,GAAG,aAAa,SAACsuB,GAE9B1zC,EAAK60E,OAASnhC,EAAIvjB,OACtB,IAGA94B,KAAKo9E,YAAYrvD,GAAG,WAAW,WAE3B,GAAIplB,EAAK60E,OAAQ,CACb,IAAIa,EACAD,EACAlpD,EAAQvsB,EAAK60E,OAAO/jD,cAExB,GADA4kD,EAAS11E,EAAKhJ,OAAQu1B,GACC,eAAnBA,EAAKwE,UACL0kD,EAAelpD,EAAKopD,wBACjB,IAAuB,YAAnBppD,EAAKwE,UAGZ,OAFA0kD,EAAelpD,EAAKqpD,mBAAmB9jD,gBAG3C,CACA9xB,EAAK80E,sBAAsBtrE,UAAYksE,EACvC11E,EAAK+0E,eAAezmB,YAAYmnB,EACpC,CAEAz1E,EAAK80E,sBAAsB/0E,UAAY,2CACvCC,EAAK+0E,eAAeuC,UAAU,CAAC,GAAI,IAGnCt3E,EAAK60E,OAAS,KAEd70E,EAAK80E,sBAAwB,KAC7B90E,EAAKy2E,qBAAqBn5E,EAC9B,GACJ,EAKA84E,uBAAyB,WAAY,IAAA14E,EAAA,KAC7BJ,EAAMjG,KAAKiH,SAEfjH,KAAKq9E,cAAgB,IAAI6C,KAEzBlgF,KAAKs9E,cAAgB,IAAIxiB,IAAJ,CAAgB,CACjCl+C,OAAS5c,KAAKq9E,cACdp+E,MAAQe,KAAKJ,QAAQy7B,OAAOqkD,QAAUhD,EAASM,4BAInDh9E,KAAKs9E,cAAc7f,gBAAkB,UAErCx3D,EAAI4wD,SAAS72D,KAAKs9E,eAGlBr3E,EAAIk6E,cAAcv2E,SACd,SAAC8lB,GACG,GAA0B,kBAAtBA,EAAQxqB,UAA+B,CAEvC,IAAI4uD,EAAUztD,EAAKi3E,cAAc3mB,UAE7BjnC,EAAQtO,QAAQ0yC,GAAS3jD,QAAU2jD,GACnCpkC,EAAQmnC,SACJxwD,EAAKi3E,cAAe,CAChBntE,MAAQ9J,EAAKzG,QAAQwgF,iBAAiBjwE,MACtCxJ,YAAcN,EAAKzG,QAAQwgF,iBAAiBz5E,aAI5D,CACJ,GAER,GAGJ,U,kCC9hBI05E,EAAmB,CAOnB1gE,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAOAoiB,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,mBAC5BhY,EAAUe,UAAY,8DACff,CACX,EAYA24E,qCAAuC,WAEnC,IAAIv1E,EAAU/K,KAEVuU,EAAS/L,SAASC,cAAc,UAEhCoS,EAAOrS,SAASC,cAAc,QA2BlC,OA1BA8L,EAAOpM,YAAY0S,GACnBtG,EAAOrQ,GAAKlE,KAAK2f,QAAQ,4BACzBpL,EAAO7L,UAAY,2HACnB6L,EAAO0G,aAAa,aAAc,mCAClC1G,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAMxB1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQw1E,yBAAyBt+E,EACrC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQw1E,yBAAyBt+E,EACrC,IAGGsS,CACX,EAeAisE,iCAAmC,WAC/B,IAAIxuB,EAASxpD,SAASC,cAAc,UAOpC,OANAupD,EAAO9tD,GAAKlE,KAAK2f,QAAQ,wBACzBqyC,EAAOtpD,UAAY,6BAKZspD,CACX,EAEAyuB,oCAAsC,WAClC,IAAIl4E,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,iCACTH,CACX,EAEAm4E,+BAAiC,WAC7B,IAAIn4E,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,oCACTH,CACX,EAOAo4E,uCAAyC,WACrC,IAAIh4E,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OAGvC,GAFAd,EAAUe,UAAY,qDAEjBqB,EAAAA,EAAAA,KAAa,CACd,IAAI62E,EAAUp4E,SAASC,cAAc,UACrCm4E,EAAQ18E,GAAKlE,KAAK2f,QAAQ,4BAC1BihE,EAAQl4E,UAAY,4FACpBk4E,EAAQzwE,MAAQ,eAEZywE,EAAQvuE,iBACRuuE,EAAQvuE,iBACJ,SACA,WACI1J,EAAKk4E,8BACT,IAEGD,EAAQruE,aAEfquE,EAAQruE,YACJ,WACA,WACI5J,EAAKk4E,8BACT,IAGRl5E,EAAUQ,YAAYy4E,EAC1B,CAEA,IAAI7iE,EAAWvV,SAASC,cAAc,OACtCsV,EAASrV,UAAY,yDACrBqV,EAAS5L,UAAY,sBACrBxK,EAAUQ,YAAY4V,GAEtB,IAAI+iE,EAAet4E,SAASC,cAAc,UAC1Cq4E,EAAa58E,GAAKlE,KAAK2f,QAAQ,8BAC/BmhE,EAAap4E,UAAY,wFACzBo4E,EAAa3wE,MAAQ,qBAEjB2wE,EAAazuE,iBACbyuE,EAAazuE,iBAAiB,SAAS,SAAUpQ,GACO,mBAAzC0G,EAAKo4E,iCACZp4E,EAAKo4E,iCAEb,IAAG,GACID,EAAavuE,aACpBuuE,EAAavuE,YAAY,WAAW,SAAUtQ,GACU,mBAAzC0G,EAAKo4E,iCACZp4E,EAAKo4E,iCAEb,IAEJp5E,EAAUQ,YAAY24E,GAEtB,IAAIE,EAAcx4E,SAASC,cAAc,UACzCu4E,EAAY98E,GAAKlE,KAAK2f,QAAQ,6BAC9BqhE,EAAYt4E,UAAY,mGACxBs4E,EAAY7wE,MAAQ,oBAGhB6wE,EAAY3uE,iBACZ2uE,EAAY3uE,iBAAiB,SAAS,WAClC7J,SAASqL,eAAelL,EAAKgX,QAAQ,6BAA6BV,OACtE,IAAG,GACI+hE,EAAYzuE,aACnByuE,EAAYzuE,YAAY,WAAW,WAC/B/J,SAASqL,eAAelL,EAAKgX,QAAQ,6BAA6BV,OACtE,IAGJ,IAAIpE,EAAOrS,SAASC,cAAc,QAOlC,OANAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjB63D,EAAY74E,YAAY0S,GACxBlT,EAAUQ,YAAY64E,GAEfr5E,CACX,EAQAs5E,uCAAyC,WACrC,IAAIC,EAAU14E,SAASC,cAAc,OACrCy4E,EAAQx4E,UAAY,+BACpB,IAAIH,EAAMC,SAASC,cAAc,OAIjC,OAHAF,EAAIrE,GAAK,wBACTg9E,EAAQ/4E,YAAYI,GAEb24E,CACX,EAOAC,mCAAqC,WACjC,IAAI54E,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,uCACtBpX,EAAIG,UAAY,8EAEhB,IAAIszC,EAAIxzC,SAASC,cAAc,KAM/B,OALAuzC,EAAEtzC,UAAY,0CACdszC,EAAE7pC,UAAY,wBAEd5J,EAAIJ,YAAY6zC,GAETzzC,CACX,EAOA64E,wCAA0C,WACtC,IAAI74E,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,yCACjB5V,EAAAA,EAAAA,OACDxB,EAAIG,UAAY,8BAGpB,IAAIszC,EAAIxzC,SAASC,cAAc,KAK/B,OAJAuzC,EAAEtzC,UAAY,8BACdszC,EAAE7pC,UAAY,wBACd5J,EAAIJ,YAAY6zC,GAETzzC,CACX,EASA84E,kCAAoC,SAAUh5E,EAAMtB,GAChD,IAAIwB,EAAMC,SAASqL,eAAe7T,KAAK2f,QAAQ,yCAE/C,GAAIpX,EAAK,CACL,IAAIyzC,EAAIxzC,SAASC,cAAc,KAC/BuzC,EAAEtzC,UAAY,8BACd,IAAI44E,EAAS94E,SAASC,cAAc,QACpC64E,EAAOn4D,UAAY9gB,EACnB,IAAIk5E,EAAU/4E,SAASC,cAAc,QACrC84E,EAAQp4D,UAAYpiB,EACpBi1C,EAAE7zC,YAAYm5E,GACdtlC,EAAE7zC,YAAYo5E,GACdh5E,EAAIJ,YAAY6zC,EACpB,CAEA,OAAOzzC,CACX,GAGJ,UCjRA,IAAIi5E,EAA0B,CAY1BC,gBAAkB,SAAUj7E,EAASi6D,GACjC,OAAOl/D,OAAOk6B,iBAAiBj1B,EAAS,MAAMk1B,iBAAiB+kC,EACnE,EAaAihB,cAAgB,SAAU7/E,EAAM8F,GAAwB,IAAbkvB,EAAI9oB,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,GAAAA,UAAA,GAAG,KAG1ChD,GAD0B/K,KAAKs8D,SAAat8D,KAAKs8D,OAAU9zD,SAASC,cAAc,YACjE8zD,WAAW,MAQhC,OANIxxD,EAAQ8rB,KADC,OAATA,EACe,GAAHtG,OAAMvwB,KAAKyhF,gBAAgB95E,EAAW,eAAc,KAAA4oB,OAAIvwB,KAAKyhF,gBAAgB95E,EAAW,aAAY,KAAA4oB,OAAIvwB,KAAKyhF,gBAAgB95E,EAAW,gBAErIkvB,EAGL9rB,EAAQ42E,YAAY9/E,GACnBiW,KACnB,EAaA8pE,aAAe,SAAU9/C,EAAG+/C,EAAYC,EAAWC,GAC/C,OAAOF,GAAc//C,EAAIggD,GAAaC,EAAU,EACpD,EAaAC,gBAAkB,SAAUC,EAAMC,EAAUC,EAAWC,GACnD,OAAQF,EAAWC,EAAaF,EAAOG,CAC3C,EAaAC,gBAAkB,SAAUC,EAAMJ,EAAUC,EAAWC,GACnD,OAAQE,EAAOH,EAAYD,GAAYE,CAC3C,EAWAG,aAAe,SAAUztD,EAAO/tB,GAC5B,IAAIye,EACJ,GAAqB,IAAjBsP,EAAM1zB,OACN,OAAO,EAEX,IAAKokB,EAAM,EAAGA,EAAMsP,EAAM1zB,OAAQokB,IAC9B,GAAIze,EAAQ+tB,EAAMtP,GAAKy8D,KACnB,OAAOz8D,EAGf,OAAOA,EAAM,CACjB,EAYAg9D,wBAA0B,SAAU3iF,EAAM8H,EAAWoD,EAASrC,GAC1D,IAAIC,EAAOoC,EAEX,GAAKpD,GAIA9H,EAAL,CAIA,IAAMZ,EAAQ,CACVwjF,WAAa,QACbC,YAAc,UACdC,UAAY,UACZC,eAAiB,QAWrB,KARI74E,EAAAA,EAAAA,OACA9K,EAAMwjF,WAAa,WACnBxjF,EAAMyjF,YAAc,UACpBzjF,EAAM0jF,UAAY,UAClB1jF,EAAM2jF,eAAiB,WAIpBj7E,EAAUunB,YACbvnB,EAAUwnB,YAAYxnB,EAAUunB,YAGpC,IAAM2zD,EACI,GADJA,EAEM,GAFNA,EAGO,GAHPA,EAIK,GAGPC,EAAyBn6E,EAAK/I,QAAQmjF,sBACtCC,EAAUnjF,EAAK8mB,OAEfs8D,EAAaz/E,KAAKC,MAAMD,KAAKqC,UAAUm9E,IAC3CC,EAAW3oE,MAAK,SAAU4oE,EAAIC,GAC1B,OAAOD,EAAGphD,EAAIqhD,EAAGrhD,CACrB,IAEA,IAAIshD,EAAOH,EAAW,GAAGnhD,EACrBuhD,EAAOJ,EAAWA,EAAW7hF,OAAS,GAAG0gC,EACzCmgD,EAAOpiF,EAAKmF,SACZs+E,EAAW,IAETC,EAAY/6E,SAASC,cAAc,OACzC86E,EAAUr/E,GAAK,4BACfyD,EAAUQ,YAAYo7E,GAGtB,IAAI7rC,EAAcn2C,OAAOk6B,iBAAiB9zB,GAAW+zB,iBAAiB,SAASrtB,QAAQ,KAAM,IACzFupC,EAAer2C,OAAOk6B,iBAAiB9zB,GAAW+zB,iBAAiB,UAAUrtB,QAAQ,KAAM,IACzFm1E,EAAe5rC,EAAeirC,EAAaA,EAC3CY,EAAc/rC,EAAcmrC,EAAcA,EAI1Ca,EAAc,GACdC,EAAa3jF,KAAK0hF,cAAcnqD,KAAKC,MAAM6rD,GAAMO,iBAAmB,MAAOj8E,EAAW,UAAF4oB,OAAYtxB,EAAMwjF,aAKtGoB,EAAiB7jF,KAAK0hF,cAAcnqD,KAAKC,MAAMyqD,GAAM2B,iBAAmB,KAAMj8E,GAG9Ek6E,EAAa2B,EAPE,GACD,GAOdrB,EAAYsB,EAAcC,EAAcC,EAExCG,EAAet7E,SAASorE,gBAAgB,6BAA8B,OAC5EkQ,EAAa5/E,GAAK,+BAClB4/E,EAAa7oE,aAAa,QAAS,oDACnC6oE,EAAa7oE,aAAa,UAAW,OAAFsV,OAASmnB,EAAW,KAAAnnB,OAAIqnB,IAC3DksC,EAAa7oE,aAAa,QAAS,QACnC6oE,EAAa7oE,aAAa,SAAU,QAGpC,IACI8oE,EADEC,EAAgBzsD,KAAKyR,MAAM64C,EAfT,IAmBpBkC,EADAV,IAASD,EACD,GAEA7rD,KAAK8X,IAAI,GAAK9X,KAAKiY,KAAKjY,KAAK70B,KAAK2gF,EAAOD,GAAQY,GAAiBzsD,KAAK70B,IAAI,MAAS,EAEhG,IAAIo/E,EAAYvqD,KAAKyR,MAAMo6C,EAAOW,GAASA,EACvCE,EAAY1sD,KAAKiY,KAAK6zC,EAAOU,GAASA,EAEtCE,IAAcZ,IACdY,GAAaF,GAGjBjC,EAAYvqD,KAAKC,MAAkB,IAAZsqD,GAAmB,IAC1CmC,EAAY1sD,KAAKC,MAAkB,IAAZysD,GAAmB,IAE1C,IAAIC,EAAa3sD,KAAKC,OAAOysD,EAAYnC,GAAaiC,GAGlDG,EAAa,EAAIF,IACjBD,EAAQxsD,KAAK8X,IAAI,GAAK9X,KAAKiY,KAAKjY,KAAK70B,KAAK2gF,EAAOD,GAAQY,GAAiBzsD,KAAK70B,IAAI,MACnFo/E,EAAYvqD,KAAKyR,MAAMo6C,EAAOW,GAASA,GACvCE,EAAY1sD,KAAKiY,KAAK6zC,EAAOU,GAASA,KAEpBV,IACdY,GAAaF,GAGjBjC,EAAYvqD,KAAKC,MAAkB,IAAZsqD,GAAmB,IAC1CmC,EAAY1sD,KAAKC,MAAkB,IAAZysD,GAAmB,IAC1CC,EAAa3sD,KAAKyR,OAAOi7C,EAAYnC,GAAaiC,IAGtDG,EAAa3sD,KAAK5kB,IAAI4kB,KAAKC,MAAM0sD,GAAa,GAE9C,IAAMC,EAAQ37E,SAASorE,gBAAgB,6BAA8B,KACrEuQ,EAAMlpE,aAAa,QAAS,sBAE5B,IAGI8mE,EAQAqC,EACAC,EACAC,EACAC,EACAC,EACAC,EAhBEC,EAAUl8E,SAASorE,gBAAgB,6BAA8B,KAEjE+Q,EAAiB9C,EAAaqC,EAIhCnC,EADAsB,IAASD,EACCvB,EAAa,GAEbA,GAAcoC,EAAYnC,GAUxC,IAAK,IAAI1sE,EAAI,EAAGA,GAAK8uE,EAAY9uE,KAC7BgvE,EAAY57E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,QAAS,wBAChCmpE,EAAUnpE,aAAa,cAAehc,EAAMwjF,YAC5C2B,EAAUnpE,aAAa,YAAa,QACpCmpE,EAAUnpE,aAAa,OAAQ,WAG/BmpE,EAAUx/B,aAAertB,KAAKC,MAAM,KAAOsqD,EAAY1sE,EAAI2uE,IAAU,KAAKH,iBAE1ES,EAAmBxC,EAAazsE,EAAIuvE,EAEpCP,EAAUnpE,aAAa,YAAa,aAAFsV,OAAemzD,EAAcC,EAAa,EAAC,MAAApzD,OAAK8zD,EAAmB,EAAC,MACtGD,EAAUnpE,aAAa,cAAe,OACtCkpE,EAAMh8E,YAAYi8E,GAElBE,EAAqB/sD,KAAKC,MAAM6sD,GAAoB,GAEpDE,EAAc/7E,SAASorE,gBAAgB,6BAA8B,MACrE4Q,EAAYh8E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,KAAM,WAC7BupE,EAAUvpE,aAAa,eAAgB,KAC7B,IAAN7F,EACAovE,EAAUvpE,aAAa,iBAAkB,OAEzCupE,EAAUvpE,aAAa,iBAAkB,KAE7CupE,EAAUvpE,aAAa,SAAU,WACjCupE,EAAUvpE,aAAa,OAAQ,QAC/BupE,EAAUvpE,aAAa,IAAK,IAAFsV,OAAMmzD,EAAcC,EAAU,KAAApzD,OAAI+zD,EAAkB,MAAA/zD,OAAK4xD,EAAYuB,EAAcC,EAAU,KAAApzD,OAAI+zD,KAE3HG,EAAYj8E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,KAAM,WAC7BwpE,EAAUxpE,aAAa,eAAgB,KACvCwpE,EAAUxpE,aAAa,iBAAkB,KACzCwpE,EAAUxpE,aAAa,SAAU,WACjCwpE,EAAUxpE,aAAa,OAAQ,QAC/BwpE,EAAUxpE,aAAa,IAAK,IAAFsV,OAAMmzD,EAAcC,EAAU,KAAApzD,OAAI+zD,EAAkB,MAAA/zD,OAAKmzD,EAAcC,EAAa,EAAC,KAAApzD,OAAI+zD,IACnHG,EAAUxpE,aAAa,YAAa,oBAEpCspE,EAAYp8E,YAAYs8E,GACxBF,EAAYp8E,YAAYq8E,GACxBE,EAAQv8E,YAAYo8E,GAGxB,IAAIK,EAAcp8E,SAASorE,gBAAgB,6BAA8B,QACzEgR,EAAY3pE,aAAa,QAAS,oBAClC2pE,EAAY3pE,aAAa,cAAehc,EAAMwjF,YAC9CmC,EAAY3pE,aAAa,YAAa,QACtC2pE,EAAY3pE,aAAa,OAAQ,WACjC2pE,EAAYhgC,YAAc,eAE1BggC,EAAY3pE,aAAa,YAAa,aAAFsV,OAAemzD,EAAe,MAAAnzD,OAAKgH,KAAKC,MAAMqqD,EAAa,GAAE,kBACjG+C,EAAY3pE,aAAa,cAAe,UAExCkpE,EAAMh8E,YAAYy8E,GAClBd,EAAa37E,YAAYg8E,GACzBL,EAAa37E,YAAYu8E,GAIrBzC,EAAO,MACPA,GAAQ,IACRqB,EAAW,MAGf,IAAMuB,EAAgBttD,KAAKyR,MAAMm5C,EAAY0B,GACzCiB,EAAQvtD,KAAK8X,IAAI,GAAK9X,KAAKiY,KAAKjY,KAAK70B,IAAKu/E,EAAQ4C,GAAiBttD,KAAK70B,IAAI,MAAS,EACnFqiF,EAAY9C,EAGd+C,EAAaztD,KAAKyR,MAAM+7C,EAAYD,GACpCE,EAAaH,GACbC,EAAQvtD,KAAK8X,IAAI,GAAK9X,KAAKiY,KAAKjY,KAAK70B,IAAKu/E,EAAQ4C,GAAiBttD,KAAK70B,IAAI,MAC5EsiF,EAAaztD,KAAKyR,MAAM+7C,EAAYD,IAC7BE,EAlJW,IAmJlBF,EAAQvtD,KAAK8X,IAAI,GAAK9X,KAAKiY,KAAKjY,KAAK70B,IAAKu/E,EAAQ4C,GAAiBttD,KAAK70B,IAAI,KAAQ,GACpFsiF,EAAaztD,KAAKyR,MAAM+7C,EAAYD,IAIxC,IAAMG,EAAYH,GADlBE,EAAaztD,KAAK5kB,IAAIqyE,EAAY,IAG5BE,EAAQ18E,SAASorE,gBAAgB,6BAA8B,KACrEsR,EAAMjqE,aAAa,QAAS,sBAgB5B,IAdA,IAOIkqE,EACAC,EACAC,GACAC,GACAC,GACAC,GAZEC,GAAUj9E,SAASorE,gBAAgB,6BAA8B,KAGjEwO,GAAUD,EAAY4C,EACtBW,IAAWX,EAAYE,GAAa7C,GACpCuD,GAAiBpuD,KAAKC,OAAO2qD,EAAYuD,IAAWV,GASjD5vE,GAAI,EAAGA,IAAK4vE,EAAa,EAAG5vE,MACjC+vE,EAAY38E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,QAAS,wBAChCkqE,EAAUlqE,aAAa,cAAehc,EAAMwjF,YAC5C0C,EAAUlqE,aAAa,YAAa,QACpCkqE,EAAUlqE,aAAa,OAAQ,WAG3B7F,KAAM4vE,EAAa,IAEnBG,EAAUvgC,aAAertB,KAAKC,MAAM,IAAMpiB,GAAI0vE,GAAS,KAAKlB,kBAGhEwB,EAAmB1B,EAAcC,EAAavuE,GAAIuwE,GAE9CvwE,KAAM4vE,EAAa,IACnBI,EAAmB1B,EAAcC,EAAaxB,GAGlDgD,EAAUlqE,aAAa,YAAa,aAAFsV,OAAe60D,EAAgB,MAAA70D,OAAKsxD,EAlMtD,GAkMiF,EAAC,MAClGsD,EAAUlqE,aAAa,cAAe,UACtCiqE,EAAM/8E,YAAYg9E,GAElBE,GAAqBD,EAAmB,GAExCE,GAAc98E,SAASorE,gBAAgB,6BAA8B,MACrE2R,GAAY/8E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,KAAM,WAC7BsqE,GAAUtqE,aAAa,eAAgB,KAC7B,IAAN7F,GACAmwE,GAAUtqE,aAAa,iBAAkB,OAEzCsqE,GAAUtqE,aAAa,iBAAkB,KAE7CsqE,GAAUtqE,aAAa,SAAU,WACjCsqE,GAAUtqE,aAAa,OAAQ,QAC/BsqE,GAAUtqE,aAAa,IAAK,IAAFsV,OAAM80D,GAAkB,KAAA90D,OAAIsxD,EAAU,MAAAtxD,OAAK80D,GAAkB,QAEvFG,GAAYh9E,SAASorE,gBAAgB,6BAA8B,SACzD34D,aAAa,KAAM,WAC7BuqE,GAAUvqE,aAAa,eAAgB,KACvCuqE,GAAUvqE,aAAa,iBAAkB,KACzCuqE,GAAUvqE,aAAa,SAAU,WACjCuqE,GAAUvqE,aAAa,OAAQ,QAC/BuqE,GAAUvqE,aAAa,IAAK,IAAFsV,OAAM80D,GAAkB,KAAA90D,OAAIsxD,EAAU,MAAAtxD,OAAK80D,GAAkB,KAAA90D,OAAIsxD,EAAa,IACxG2D,GAAUvqE,aAAa,YAAa,mBAEpCqqE,GAAYn9E,YAAYq9E,IACxBF,GAAYn9E,YAAYo9E,IACxBE,GAAQt9E,YAAYm9E,IAGxB,IAAIM,GAAcp9E,SAASorE,gBAAgB,6BAA8B,QACzEgS,GAAY3qE,aAAa,QAAS,oBAClC2qE,GAAY3qE,aAAa,cAAehc,EAAMwjF,YAC9CmD,GAAY3qE,aAAa,YAAa,QACtC2qE,GAAY3qE,aAAa,OAAQ,WACjC2qE,GAAYhhC,YAAc,aAAHr0B,OAAgB+yD,EAAQ,KAE/CsC,GAAY3qE,aAAa,YAAa,aAAFsV,OAAemzD,EAAcC,EAAaxB,EAAY,EAAC,MAAA5xD,OAAKsxD,EA1O5E,GADC,GA2OqH,EAAC,MAC3I+D,GAAY3qE,aAAa,cAAe,UAExCiqE,EAAM/8E,YAAYy9E,IAClB9B,EAAa37E,YAAY+8E,GACzBpB,EAAa37E,YAAYs9E,IAEzB,IAAMI,GAAiBr9E,SAASorE,gBAAgB,6BAA8B,KAE1EkS,GAAS,EACI,OAAbxC,IACAwC,GAAS,KAOb,IAJA,IAAIC,GAAS/lF,KAAKgiF,gBAAgBgB,EAAQ,GAAGf,KAAO6D,GAAQrC,EAAatB,EAAWC,IAChF4D,GAAShmF,KAAK4hF,aAAaoB,EAAQ,GAAGlhD,EAAG+/C,EAAYC,EAAWC,GAChEkE,GAAQ,IAAH11D,OAAOw1D,GAAM,KAAAx1D,OAAIy1D,IAEjB5wE,GAAI,EAAGA,GAAI4tE,EAAQ5hF,OAAQgU,KAChC2wE,GAAS/lF,KAAKgiF,gBAAgBgB,EAAQ5tE,IAAG6sE,KAAO6D,GAAQrC,EAAatB,EAAWC,IAChF4D,GAAShmF,KAAK4hF,aAAaoB,EAAQ5tE,IAAG0sB,EAAG+/C,EAAYC,EAAWC,GAChEkE,IAAS,KAAJ11D,OAASw1D,GAAM,KAAAx1D,OAAIy1D,IAG5B,IAAME,GAAW19E,SAASorE,gBAAgB,6BAA8B,QACxEsS,GAASjrE,aAAa,KAAM,WAC5BirE,GAASjrE,aAAa,eAAgB,KACtCirE,GAASjrE,aAAa,iBAAkB,KACxCirE,GAASjrE,aAAa,SAAUhc,EAAMyjF,aACtCwD,GAASjrE,aAAa,OAAQ,QAC9BirE,GAASjrE,aAAa,IAAKgrE,IAG3BA,IAAS,KAAJ11D,OAASw1D,GAAM,KAAAx1D,OAAIsxD,GACxBoE,IAAS,KAAJ11D,OAASkzD,EAActB,EAAS,KAAA5xD,OAAIsxD,GAEzC,IAAMsE,GAAW39E,SAASorE,gBAAgB,6BAA8B,QACxEuS,GAASlrE,aAAa,KAAM,WAC5BkrE,GAASlrE,aAAa,eAAgB,KACtCkrE,GAASlrE,aAAa,iBAAkB,KACxCkrE,GAASlrE,aAAa,SAAU,WAChCkrE,GAASlrE,aAAa,OAAQhc,EAAM0jF,WACpCwD,GAASlrE,aAAa,eAAgB,OACtCkrE,GAASlrE,aAAa,IAAKgrE,IAE3BJ,GAAe19E,YAAY+9E,IAC3BL,GAAe19E,YAAYg+E,IAC3BrC,EAAa37E,YAAY09E,IAGzB,IAAMO,GAAY59E,SAASorE,gBAAgB,6BAA8B,KAEnEyS,GAAgB79E,SAASorE,gBAAgB,6BAA8B,QAC7EyS,GAAcprE,aAAa,QAASknE,GACpCkE,GAAcprE,aAAa,SAAU4mE,GACrCwE,GAAcprE,aAAa,YAAa,aAAFsV,OAAekzD,EAActB,EAAS,QAC5EkE,GAAcprE,aAAa,aAAc,UACzCorE,GAAcprE,aAAa,iBAAkB,OAE7C,IAAMqrE,GAAa9iF,KAAKC,MAAMD,KAAKqC,UAAUm9E,IAC7CsD,GAAWhsE,MAAK,SAAU4oE,EAAIC,GAC1B,OAAOD,EAAGjB,KAAOkB,EAAGlB,IACxB,IAEA,IAAMsE,GAAa/9E,SAASorE,gBAAgB,6BAA8B,QAC1E2S,GAAWtrE,aAAa,KAAM,cAC9BsrE,GAAWtrE,aAAa,QAAS,qBACjCsrE,GAAWtrE,aAAa,OAAQ,QAChCsrE,GAAWtrE,aAAa,SAAUhc,EAAM2jF,gBACxC2D,GAAWtrE,aAAa,eAAgB,SACxCsrE,GAAWtrE,aAAa,aAAc,UAEtC,IAAMurE,GAAah+E,SAASorE,gBAAgB,6BAA8B,QAC1E4S,GAAWvrE,aAAa,KAAM,cAC9BurE,GAAWvrE,aAAa,QAAS,qBACjCurE,GAAWvrE,aAAa,OAAQ,QAChCurE,GAAWvrE,aAAa,SAAUhc,EAAM2jF,gBACxC4D,GAAWvrE,aAAa,eAAgB,SACxCurE,GAAWvrE,aAAa,aAAc,UAEtC,IAAMwrE,GAAcj+E,SAASorE,gBAAgB,6BAA8B,UAC3E6S,GAAYxrE,aAAa,KAAM,eAC/BwrE,GAAYxrE,aAAa,IAAK,GAC9BwrE,GAAYxrE,aAAa,QAAS,sCAClCwrE,GAAYxrE,aAAa,OAAQhc,EAAM2jF,gBACvC6D,GAAYxrE,aAAa,aAAc,UAEvCmrE,GAAUj+E,YAAYs+E,IACtBL,GAAUj+E,YAAYo+E,IACtBH,GAAUj+E,YAAYq+E,IAGtB,IAAME,GAAal+E,SAASorE,gBAAgB,6BAA8B,QACpE+S,GAAWn+E,SAASorE,gBAAgB,6BAA8B,SAClEgT,GAAYp+E,SAASorE,gBAAgB,6BAA8B,SACnEiT,GAAar+E,SAASorE,gBAAgB,6BAA8B,SAE1E8S,GAAWzrE,aAAa,QAAS,kFAAFsV,OAAoFtxB,EAAMwjF,WAAU,kBACnIiE,GAAWznF,MAAMmiD,cAAgB,OACjCslC,GAAWznF,MAAMoF,SAAW,QAG5BqiF,GAAWzrE,aAAa,QAAS,eACjCyrE,GAAWzrE,aAAa,cAAe,UAEvCsoE,EAAUp7E,YAAYu+E,IAEtBC,GAAS1rE,aAAa,QAAS,iBAC/B0rE,GAAS1rE,aAAa,IAAK,KAC3B0rE,GAAS1rE,aAAa,KAAM,SAE5B2rE,GAAU3rE,aAAa,QAAS,iBAChC2rE,GAAU3rE,aAAa,IAAK,KAC5B2rE,GAAU3rE,aAAa,KAAM,OAE7B4rE,GAAW5rE,aAAa,QAAS,kBACjC4rE,GAAW5rE,aAAa,IAAK,KAC7B4rE,GAAW5rE,aAAa,KAAM,OAE9ByrE,GAAWv+E,YAAYw+E,IACnB7D,EAAuBgE,cACvBJ,GAAWv+E,YAAYy+E,IAE3BF,GAAWv+E,YAAY0+E,IAEvB,IAAME,GAAWv+E,SAASorE,gBAAgB,6BAA8B,KAExEwS,GAAUj+E,YAAY4+E,IAEtB,IAAMC,GAAgBx+E,SAASorE,gBAAgB,6BAA8B,QAC7EoT,GAAc/rE,aAAa,KAAM,WACjC+rE,GAAc/rE,aAAa,OAAQ,WACnC+rE,GAAc/rE,aAAa,SAAU,WACrC+rE,GAAc/rE,aAAa,eAAgB,OAC3C+rE,GAAc/rE,aAAa,eAAgB,KAC3C+rE,GAAc/rE,aAAa,iBAAkB,KAE7C,IAAMgsE,GAAsBz+E,SAASorE,gBAAgB,6BAA8B,QAyHnF,OAxHAqT,GAAoBhsE,aAAa,KAAM,WACvCgsE,GAAoBhsE,aAAa,OAAQ,WACzCgsE,GAAoBhsE,aAAa,SAAU,WAC3CgsE,GAAoBhsE,aAAa,eAAgB,KACjDgsE,GAAoBhsE,aAAa,eAAgB,KACjDgsE,GAAoBhsE,aAAa,iBAAkB,OACnDgsE,GAAoBhsE,aAAa,YAAa,kBAE9C8rE,GAAS5+E,YAAY8+E,IACrBF,GAAS5+E,YAAY6+E,IACrBD,GAAS5+E,YAAYu+E,IAIrBK,GAAS9rE,aAAa,QAAS,eAC/B8rE,GAAS9nF,MAAMmiD,cAAgB,OAgG/BilC,GAAch0E,iBAAiB,eA9F/B,WACIk0E,GAAWtrE,aAAa,aAAc,WACtCurE,GAAWvrE,aAAa,aAAc,WACtCwrE,GAAYxrE,aAAa,aAAc,WACvCvS,EAAUw+E,sBAAsBv+E,EAAMq6E,EAAQ,IAG9C0D,GAAWp/D,UAAU7K,OAAO,eAC5BsqE,GAASz/D,UAAU7K,OAAO,eAC1BiqE,GAAWp/D,UAAU7K,OAAO,kBAC5BsqE,GAASz/D,UAAU7K,OAAO,kBAC1BiqE,GAAWp/D,UAAUtG,IAAI,iBACzB+lE,GAASz/D,UAAUtG,IAAI,gBAC3B,IAkFAqlE,GAAch0E,iBAAiB,cAhF/B,WACIk0E,GAAWtrE,aAAa,aAAc,UACtCurE,GAAWvrE,aAAa,aAAc,UACtCwrE,GAAYxrE,aAAa,aAAc,UACvCvS,EAAUy+E,sBAAsBx+E,GAEhC+9E,GAAWp/D,UAAU7K,OAAO,iBAC5BsqE,GAASz/D,UAAU7K,OAAO,iBAC1BiqE,GAAWp/D,UAAUtG,IAAI,kBACzB+lE,GAASz/D,UAAUtG,IAAI,iBAC3B,IAuEAqlE,GAAch0E,iBAAiB,cArE/B,SAAsBpQ,GAClB,IAAMmlF,EAAatD,EAAauD,iBAChCD,EAAW9hF,EAAIrD,EAAEohD,QACjB+jC,EAAW7hF,EAAItD,EAAEqhD,QACjB,IAAMgkC,EAAgBF,EAAWG,gBAAgBzD,EAAa0D,eAAeC,WACvEC,EAAY1nF,KAAKqiF,gBAAgBiF,EAAchiF,EAAGm+E,EAAatB,EAAWC,IAAW0D,GAGrF6B,EAAYpwD,KAAK5kB,IAAI,EAAG3S,KAAKuiF,aAAa+D,GAAYoB,IAEtDE,EAAK5E,EAAQ2E,EAAY,GACzBE,EAAK7E,EAAQ2E,GACfl4C,EAAIm4C,EACJF,EAAYE,EAAG3F,KAAO4F,EAAG5F,KAAOyF,IAChCj4C,EAAIo4C,GAGR,IAAMC,EAAS9nF,KAAKgiF,gBAAgBvyC,EAAEwyC,KAAO6D,GAAQrC,EAAatB,EAAWC,IACvE2F,EAAS/nF,KAAK4hF,aAAanyC,EAAE3N,EAAG+/C,EAAYC,EAAWC,GAG7D0E,GAAYxrE,aAAa,KAAM6sE,GAC/BrB,GAAYxrE,aAAa,KAAM8sE,GAE/BxB,GAAWtrE,aAAa,KAAM6sE,GAC9BvB,GAAWtrE,aAAa,KAAM4mE,GAC9B0E,GAAWtrE,aAAa,KAAM6sE,GAC9BvB,GAAWtrE,aAAa,KAAM,GAE9BurE,GAAWvrE,aAAa,KAAMyoE,EAAcC,GAC5C6C,GAAWvrE,aAAa,KAAM8sE,GAC9BvB,GAAWvrE,aAAa,KAAMknE,EAAYuB,EAAcC,GACxD6C,GAAWvrE,aAAa,KAAM8sE,GAE9Br/E,EAAUs/E,sBAAsBr/E,EAAM8mC,GAGtC,IAAMw4C,EAAc,cAAH13D,OAAiBkf,EAAE3N,EAAE8hD,iBAAgB,MAChDsE,EAAe,WAAH33D,OAAckf,EAAE04C,MAAK,MACjCC,EAAgB,UAAH73D,OAAakf,EAAEhrB,IAAIm/D,iBAAgB,aAAArzD,OAAYkf,EAAEjrB,IAAIo/D,iBAAgB,KAExF+C,GAASx0E,UAAY81E,EACrBrB,GAAUz0E,UAAY+1E,EACtBrB,GAAW10E,UAAYi2E,EAEvB,IAKIC,EALEC,EAAmB/wD,KAAK5kB,IAC1B3S,KAAK0hF,cAAc0G,EAAevB,IAClC7mF,KAAK0hF,cAAcuG,EAAatB,KAIhCl3C,EAAEwyC,KAAQA,EAAO6D,GAAU,GAC3BuC,EAAiB,gCAAH93D,OAAmC+3D,EAAmB,GAAE,iBAAA/3D,OAAgB+3D,EAAmB,GAAE,mBAC3G5B,GAAWzrE,aAAa,YAAa,aAAFsV,SAAiB+3D,EAAmB,EAAI,IAAG,SACvE74C,EAAEwyC,MAASA,EAAO6D,GAAU,IACnCuC,EAAiB,8BAAH93D,OAAiC+3D,EAAmB,GAAE,kBAAA/3D,OAAiB+3D,EAAmB,GAAE,oBAE1G5B,GAAWzrE,aAAa,YAAa,aAAFsV,OAAgB+3D,EAAmB,EAAI,GAAE,SAGhFtB,GAAc/rE,aAAa,IAAKotE,GAChCpB,GAAoBhsE,aAAa,IAAKotE,GAEtCtB,GAAS9rE,aAAa,YAAa,aAAFsV,OAAeu3D,EAAM,KAAAv3D,OAAIw3D,EAAM,MAChEhB,GAAS9nF,MAAMy1C,UAAY,aAAHnkB,OAAgBu3D,EAAM,OAAAv3D,OAAMw3D,EAAM,MAC9D,EAI0DxlD,KAAKviC,OAE/DomF,GAAUj+E,YAAYk+E,IACtBvC,EAAa37E,YAAYi+E,IAEzB7C,EAAUp7E,YAAY27E,GAEfn8E,CApiBP,CAqiBJ,EAYA4gF,kBAAoB,SAAU1oF,EAAM8H,EAAWoD,EAASrC,GACpD,GAAKf,EAAL,CAKA,KAAOA,EAAUunB,YACbvnB,EAAUwnB,YAAYxnB,EAAUunB,YAGpC,IAAI8zD,EAAWnjF,GAAQA,EAAK8mB,OAAU9mB,EAAK8mB,OAAS,CAAC,EAEjDpe,EAAMC,SAASC,cAAc,YAwBjC,OAvBAF,EAAIrE,GAAK,yBACTqE,EAAIigF,KAAO,GACXjgF,EAAIkgF,KAAO,GACXlgF,EAAItJ,MAAM6Y,MAAQ,OAClBvP,EAAI4J,UAAY3O,KAAKqC,UAAUm9E,OAAS7iE,EAAW,GACnD5X,EAAI8J,iBAAiB,aAAa,SAAUpQ,GACxCyG,EAAUggF,iCAAiC39E,EAAS9I,EACxD,IAcA0F,EAAUQ,YAAYI,GAEfZ,CAjCP,CAkCJ,EAYAghF,oBAAsB,SAAU9oF,EAAM8H,EAAWoD,EAASrC,GACtD,IAAIC,EAAOoC,EAEX,GAAKpD,GAIA9H,EAAL,CAKA,KAAO8H,EAAUunB,YACbvnB,EAAUwnB,YAAYxnB,EAAUunB,YAGpC,IAAI8zD,EAAUnjF,EAAK8mB,OAEnB,GAAI9mB,EAAKmF,SAAW,IAAM,CACtBnF,EAAKqwC,KAAO,KACZ,IAAK,IAAI96B,EAAI,EAAGA,EAAI4tE,EAAQ5hF,OAAQgU,IAChC4tE,EAAQ5tE,GAAG6sE,MAAQ,GAE3B,CAEA,IAAIa,EAAyBn6E,EAAK/I,QAAQmjF,sBAEtCF,EACM,GADNA,EAEQ,GAFRA,EAGS,GAHTA,EAIO,GAGPY,EAAcliF,OAAOk6B,iBAAiB9zB,GAAW+zB,iBAAiB,SAClE8nD,EAAejiF,OAAOk6B,iBAAiB9zB,GAAW+zB,iBAAiB,UACnE5jB,EAAQ2rE,EAAYp1E,QAAQ,KAAM,IAAMw0E,EAAcA,EACtD95E,EAASy6E,EAAan1E,QAAQ,KAAM,IAAMw0E,EAAaA,EAEvDv9E,EAAIsjF,GAAGt5E,MAAMu5E,SACZC,MAAM,CAAC,EAAGhxE,IAEXvS,EAAIqjF,GAAGt5E,MAAMu5E,SACZC,MAAM,CAAC//E,EAAQ,IAEhBggF,EAAQH,GAAGpvE,IAAImzC,OACdr9C,MAAMhK,GACN0jF,OAAO,UACPC,MAAM,GAEPC,EAAQN,GAAGpvE,IAAImzC,OACdr9C,MAAM/J,GACNyjF,OAAO,QACPC,MAAM,GAEPhtE,EAAO2sE,GAAGpvE,IAAIyC,OACbktE,YAAY,SACZ7jF,GAAE,SAAUmqC,GACT,OAAOnqC,EAAEmqC,EAAEwyC,KACf,IACC18E,GAAE,SAAUkqC,GACT,OAAOlqC,EAAEkqC,EAAE3N,EACf,IAEAunC,EAAOuf,GAAGpvE,IAAI6vD,OACb8f,YAAY,SACZ7jF,GAAE,SAAUmqC,GACT,OAAOnqC,EAAEmqC,EAAEwyC,KACf,IACCmH,GAAGrgF,GACHsgF,IAAG,SAAU55C,GACV,OAAOlqC,EAAEkqC,EAAE3N,EACf,IAEAtoB,EAAMovE,GAAGU,OAAO3hF,GACf4hF,OAAO,OACP5a,KAAK,QAAS72D,EAAQ+qE,EAAcA,GACpClU,KAAK,SAAU5lE,EAAS85E,EAAaA,GACrC0G,OAAO,KACP5a,KAAK,YAAa,aAAekU,EAAc,IAAMA,EAAa,KAEnE2G,EAAUZ,GAAGptD,OAAOwnD,GAAS,SAAUvzC,GACvC,OAAOA,EAAEwyC,IACb,IACA38E,EAAEmkF,OAAOD,GAET,IAAIE,EAAU,CACV,EACAd,GAAGj2E,IAAIqwE,GAAS,SAAUvzC,GACtB,OAAOA,EAAE3N,CACb,KAEJv8B,EAAEkkF,OAAOC,GAETlwE,EAAI+vE,OAAO,QACNI,MAAM3G,GACNrU,KAAK,QAAS,WACdA,KAAK,IAAKtF,GAEf7vD,EAAI+vE,OAAO,KACN5a,KAAK,QAAS,aACdA,KAAK,YAAa,eAAiB5lE,EAAS,KAC5C5J,KAAK4pF,GACLQ,OAAO,QACP5a,KAAK,KAAM,IACXA,KAAK,KAAM,SACXA,KAAK,IAAK72D,GACVjW,KAAK,aAAehC,EAAKqwC,KAAO,KAErC12B,EAAI+vE,OAAO,KACN5a,KAAK,QAAS,aACdxvE,KAAK+pF,GACLK,OAAO,QACP5a,KAAK,YAAa,eAClBA,KAAK,IAAK,GACVA,KAAK,KAAM,SACX9sE,KAAK,gBAEV2X,EAAI+vE,OAAO,KACN5a,KAAK,QAAS,oBACdA,KAAK,YAAa,eAAiB5lE,EAAS,KAC5C5J,KAAK4pF,EACDC,OAAO,UACPY,UAAU7gF,EAAQ,EAAG,GACrB8gF,WAAW,KAGpBrwE,EAAI+vE,OAAO,KACN5a,KAAK,QAAS,sBACdxvE,KAAK+pF,EACDF,OAAO,QACPY,UAAU9xE,EAAO,EAAG,GACpB+xE,WAAW,KAGpBrwE,EAAI+vE,OAAO,QACNI,MAAM3G,GACNrU,KAAK,QAAS,WACdA,KAAK,IAAK1yD,GAEfzC,EAAIswE,UAAU,UACTjqF,KAAKmjF,GACL+G,QACAR,OAAO,UACP5a,KAAK,MAAM,SAAUl/B,GAClB,OAAOnqC,EAAEmqC,EAAEwyC,KACf,IACCtT,KAAK,MAAM,SAAUl/B,GAClB,OAAOlqC,EAAEkqC,EAAE3N,EACf,IACC6sC,KAAK,IAAK,GACVA,KAAK,QAAS,aAEnB,IAAI7mD,EAAQtO,EAAI+vE,OAAO,KAAKtqF,MAAM,UAAW,QAE7C6oB,EAAMyhE,OAAO,QACR5a,KAAK,KAAM,cACXA,KAAK,QAAS,gBACnB7mD,EAAMyhE,OAAO,QACR5a,KAAK,KAAM,cACXA,KAAK,QAAS,gBACnB7mD,EAAMyhE,OAAO,UACR5a,KAAK,KAAM,eACXA,KAAK,IAAK,GACVA,KAAK,QAAS,4BAEnB,IAAIpmE,EAAMqgF,GAAGU,OAAO3hF,GAAW4hF,OAAO,OACjC5a,KAAK,QAAS,cACd1vE,MAAM,UAAW,GAElB+qF,EAAapB,GAAGqB,UAAS,SAAUx6C,GACnC,OAAOA,EAAEwyC,IACb,IAAG54E,KA8DH,OA5DAmQ,EAAI+vE,OAAO,QACN5a,KAAK,QAAS,cACdA,KAAK,QAAS72D,GACd62D,KAAK,SAAU5lE,GACfglB,GAAG,aAAa,WACbjG,EAAM7oB,MAAM,UAAW,MACvByJ,EAAUw+E,sBAAsBv+E,EAAMq6E,EAAQ,GAClD,IACCj1D,GAAG,YAAY,WACZjG,EAAM7oB,MAAM,UAAW,QACvByJ,EAAUy+E,sBAAsBx+E,GAGhCJ,EAAI2hF,aACC19C,SAAS,KACTvtC,MAAM,UAAW,EAC1B,IACC8uB,GAAG,aAAa,WACb,IAAIqgB,EAAIw6C,GAAGuB,MAAMnqF,MACbgF,EAAWM,EAAE6mD,OAAO/d,EAAE,IAEtBh5B,EAAImiB,KAAK5kB,IAAI,EAAGq3E,EAAWhH,EAASh+E,IAEpC4iF,EAAK5E,EAAQ5tE,EAAI,GACjByyE,EAAK7E,EAAQ5tE,GACbq6B,EAAIzqC,EAAW4iF,EAAG,GAAKC,EAAG,GAAK7iF,EAAW6iF,EAAKD,EAE/CwC,EAAK9kF,EAAEmqC,EAAEwyC,MACToI,EAAK9kF,EAAEkqC,EAAE3N,GAEbha,EAAMwhE,OAAO,gBACR3a,KAAK,KAAMyb,GACXzb,KAAK,KAAM0b,GAChBviE,EAAMwhE,OAAO,eACR3a,KAAK,KAAMyb,GAAIzb,KAAK,KAAMppE,EAAEmkF,EAAQ,KACpC/a,KAAK,KAAMyb,GAAIzb,KAAK,KAAMppE,EAAEmkF,EAAQ,KACzC5hE,EAAMwhE,OAAO,eACR3a,KAAK,KAAMrpE,EAAEkkF,EAAQ,KAAK7a,KAAK,KAAM0b,GACrC1b,KAAK,KAAMrpE,EAAEkkF,EAAQ,KAAK7a,KAAK,KAAM0b,GAE1C3hF,EAAUs/E,sBAAsBr/E,EAAM8mC,GAGtClnC,EAAI2hF,aACC19C,SAAS,KACTvtC,MAAM,UAAW,IAEtB,IAAIqrF,EAAW,GACfA,GAAY,eAAiB76C,EAAE3N,EAAI,KAC/BghD,EAAuBgE,eACvBwD,GAAY,iBAAmB76C,EAAE04C,MAAQ,MAE7CmC,GAAY,gBAAkB76C,EAAEhrB,IAAM,WAAagrB,EAAEjrB,IAAM,IAE3Djc,EAAIgiF,KAAKD,GACJrrF,MAAM,OAAS2pF,GAAG/nE,MAAM2pE,MAAS,MACjCvrF,MAAM,MAAQ2pF,GAAG/nE,MAAM4pE,MAAQ,GAAM,KAC9C,IAGGjxE,CAjOP,CAkOJ,EAYAkxE,0BAA4B,SAAU7qF,EAAM8H,EAAWoD,EAASrC,GAC5D,IAAIC,EAAOoC,EAEX,GAAKpD,GAIA9H,EAAL,CAIA,IAAImjF,EAAUnjF,EAAK8mB,OAEfgkE,EAAa,iEASjB,GARmBhiF,EAAK/I,QAAQmjF,sBAAsB+D,eAElD6D,GAAc,+DAElBA,GAAc,mEAEdC,SAASC,gBAAe,WAAa,IAEjChrF,EAAKmF,SAAW,IAAM,CACtBnF,EAAKqwC,KAAO,KACZ,IAAK,IAAI96B,EAAI,EAAGA,EAAI4tE,EAAQ5hF,OAAQgU,IAChC4tE,EAAQ5tE,GAAG6sE,MAAQ,GAE3B,CAEA,IAAK,IAAI7sE,EAAI,EAAGA,EAAI4tE,EAAQ5hF,OAAQgU,IAAK,CACrC,IAAI6sE,EAAOe,EAAQ5tE,GAAG6sE,KAClB6I,EAAc,IACd7I,EAAO,IACP6I,EAAc,EACP7I,EAAO,KACd6I,EAAc,IAIlB7I,EAAO1qD,KAAKC,MAAMyqD,EAAO6I,GAAeA,EACxC9H,EAAQ5tE,GAAG6sE,KAAOA,CACtB,CAEA,IAAI7iF,EAAW,CACX8M,KAAO,SACP6+E,aAAe,wCACfC,cAAgB,OAChBC,iBAAmB,EACnB/oC,YAAc,GACdgpC,UAAY,GACZC,cAAgB,EAChBnzE,MAAQ,UACRozE,SAAW,EACXC,MAAQ,QACRC,mBAAqB,GACrBC,gBAAkB,CACdn8C,WAAa,EACbo8C,iBAAmB,IACnBF,mBAAqB,KAEzBG,aAAe,CACXzzE,MAAQ,UACR0zE,aAAe,QACfC,iBAAmB,GACnBC,aAAe,QACfz7E,MAAQ,aAAetQ,EAAKqwC,KAAO,IACnC27C,WAAa,UACbC,YAAc,EACdC,aAAc,GAElBC,YAAc,CACVC,kBAAoB,EACpBC,gBAAiB,EACjBC,WAAa,GACbC,wBAAyB,EACzBC,YAAc,OACdC,iBAAmB,EACnBC,gBAAkB,EAClBC,UAAW,GAEfC,WAAa,GACbC,OAAS,CAAC,CACNC,aAAe,UACfC,YAAcjC,EACdkC,OAAS,QACTC,YAAc,EACdC,kBAAoB,OACpBC,sBAAwB,EACxBC,YAAc,OACdd,WAAa,EACb3jB,QAAS,EACTtkE,GAAK,YACLgpF,WAAa,GACbC,WAAa,UACbC,UAAY,EACZC,UAAY,UACZC,cAAgB,EAChBn9E,MAAQ,WACRo9E,WAAa,MAEjBC,OAAS,GACTC,UAAY,CAAC,CACTvpF,GAAK,cACLwpF,eAAiB,GACjBv9E,MAAQ,iBAEZw9E,QAAU,CACNC,YAAc,UACdC,gBAAkB,EAClBlL,UAAY,UACZmL,YAAa,GAEjBC,OAAS,GACTC,UAAY,GACZC,aAAejL,GAGfkL,EAAoBtD,SAASuD,UAAUxmF,EAAWvI,GAOtD,OALA8uF,EAAkBE,YAAY,WAAW,SAAUnsF,GAC/C,IAAImO,EAAMnO,EAAEosF,MAAMJ,aAAahsF,EAAEgH,OACjCP,EAAUs/E,sBAAsBr/E,EAAMyH,EAC1C,IAEO89E,CAnHP,CAoHJ,GAGJ,U,osDCljCA,I,MAAI7uF,EAAS2Q,EAAAA,EAAO1Q,UAAU,iBAyE1BgvF,GAAaC,EAAA,SAAApoF,GAYb,SAAAmoF,EAAa1uF,GAAS,IAAAyG,E,MAYlB,G,4FAZkBC,CAAA,KAAAgoF,GAClBjvF,EAAOE,MAAM,mB,EASb,K,EAAA,CAHAK,EAAUA,GAAW,CAAC,G,MAGtB0uF,MAAAjoF,E,6EAEsBioF,GAClB,MAAM,IAAIrqF,UAAU,2BA2DxB,OApDAoC,EAAKnB,UAAY,gBAGjBmB,EAAKuZ,KAAOhgB,EAAQsE,IAAM+Q,EAAAA,EAAGC,WAG7B7O,EAAKmoF,eAAiB,KACtBnoF,EAAKooF,aAAe,KACpBpoF,EAAKqoF,gBAAkB,KACvBroF,EAAKsoF,kBAAoB,KACzBtoF,EAAKuoF,kBAAoB,KACzBvoF,EAAKwoF,eAAiB,KAGtBxoF,EAAKyoF,WAAa,KAGlBzoF,EAAK0oF,gBAAkB,KACvB1oF,EAAK2oF,iBAAmB,KACxB3oF,EAAK4oF,aAAe,KAGpB5oF,EAAK6oF,SAAW,KAGhB7oF,EAAK8oF,MAAQ,CAAC,EAOd9oF,EAAK+oF,eAAiB,KACtB/oF,EAAKgpF,eAAiB,KACtBhpF,EAAKipF,aAAe,KAGpBjpF,EAAKkpF,YAAc,KACnBlpF,EAAKmpF,eAAiB,KAGtBnpF,EAAKulB,QAAU,KAGfvlB,EAAKgK,YAAYzQ,GAGjByG,EAAK8jB,WAAa9jB,EAAKopF,uBAGtBppF,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAK8jB,YAAc9jB,EAAKG,QAAUH,EAAK8jB,WAEjFC,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAA0nF,EAAAnoF,G,EAAAmoF,E,EAAA,EAAAxnF,IAAA,SAAAC,MAsTA,SAAQd,GAGJ,GAFA5G,EAAOE,MAAM,yBAET0G,IAGIjG,KAAKJ,QAAQsf,SAES,OAAlBlf,KAAKkvF,WACLlvF,KAAK0uF,gBAAgBzvF,MAAM+U,QAAU,QAGzChU,KAAK0vF,wBAAwBzpF,GAC7BjG,KAAK2vF,uBAAuB1pF,IAI3BjG,KAAKJ,QAAQmD,QAAW/C,KAAKJ,QAAQyE,UACtC23E,EAAeh7D,IAAI/a,EAAKjG,MAIxBA,KAAKJ,QAAO,QAAS,CACrB,IAAI6B,EAAOgP,EAAAA,EAAMiI,OAAO,CAAEgX,QAAU1vB,MAAQA,KAAKJ,QAAO,QACxDI,KAAI,OAAU,IAAI4vF,EAAAA,QAAanuF,GAC/BzB,KAAI,OAAQyG,SACZ,IAAIkC,EAAO3I,KACXA,KAAI,OAAQ+tB,GAAG,kBAAkB,SAAC9rB,GAC9B0G,EAAKs0C,cAAc,CACf/wC,KAAO,iBACPhM,QAAU+B,EAAE/B,SAEpB,GACJ,C,iBAIJouF,E,EAAA,S,EAAA,K,WAAA,G,kFAAA,CAAaroF,IAGTjG,KAAKJ,QAAQyE,UACbrE,KAAKi3D,YAAYj3D,KAAKJ,QAAQyE,WAIN,IAAxBrE,KAAKJ,QAAQs3D,QACbl3D,KAAKsiB,eAAegF,UAAUtG,IAAI,uBAE1C,GAAC,CAAAla,IAAA,YAAAC,MAQD,WAEI,OADA1H,EAAOE,MAAM,4BACNS,KAAKJ,QAAQsf,MACxB,GAEA,CAAApY,IAAA,YAAAC,MAKA,SAAWmY,GACP7f,EAAOE,MAAM,4BACbS,KAAKJ,QAAQsf,OAASA,CAC1B,GAEA,CAAApY,IAAA,UAAAC,MAoBA,WACI,OAAO0J,EAAAA,EAAMiI,OAAO,CAChBxM,KAAO,iBACRlM,KAAKmvF,MACZ,GAEA,CAAAroF,IAAA,UAAAC,MAmBA,SAASlH,GACLG,KAAKmvF,MAAQtvF,CACjB,GAEA,CAAAiH,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKmqB,UAChB,GAEA,CAAArjB,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAKqvF,cAChB,GAEA,CAAAvoF,IAAA,WAAAC,MAKA,SAAUyF,GACDA,EAKCA,aAAiBsuD,KAMvBtuD,EAAM8uB,SAASt7B,KAAKgvF,kBAEpBhvF,KAAKqvF,eAAiB7iF,EACtBxM,KAAKovF,eAAiB5iF,EAAMuwD,aARxB19D,EAAOqD,IAAI,oDALX1C,KAAKqvF,eAAiB,IAc9B,GAEA,CAAAvoF,IAAA,aAAAC,MAKA,WACI,IAAI8oF,EAAW7vF,KAAKqvF,eAAetyB,YAAY+yB,cAY/C,OAVa,IAAIC,EAAAA,EAAgB,CAC7Bp1D,aAAe36B,KAAKgvF,mBAIHgB,cAAcH,EAAU,CACzCI,eAAiB,YACjBC,kBAAoB,aAI5B,GAEA,CAAAppF,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAKgvF,gBAChB,GAEA,CAAAloF,IAAA,QAAAC,MAIA,SAAO0V,GACHpd,EAAOE,MAAM,wBAEb,IAAI0G,EAAMjG,KAAKiH,SAGfjH,KAAK0uF,gBAAgBzvF,MAAM+U,QAAU,OAIrChU,KAAKyuF,aAAaxzE,aAAa,gBAAgB,GAG/Cjb,KAAKmwF,iBACLnwF,KAAKowF,0BAA0BnqF,OAAuB,IAAXwW,GAAyBA,GAEpEzc,KAAKqwF,UACT,GAEA,CAAAvpF,IAAA,OAAAC,MAKA,WAKI/G,KAAKyuF,aAAaxzE,aAAa,gBAAgB,GAC/Cjb,KAAK0uF,gBAAgBzvF,MAAM+U,QAAU,QACrChU,KAAKswF,gBAAgBtwF,KAAKmvF,OAC1BnvF,KAAK4uF,kBAAkBlmF,UAAY,6EACvC,GAMA,CAAA5B,IAAA,cAAAC,MAOA,SAAanH,GACTP,EAAOE,MAAM,gCAAiCK,GAG9CI,KAAKJ,QAAU,CACXmD,OAAS,KACT0D,OAAS,KACTyY,QAAS,EACTrT,OAAS,KACT0kF,QAAS,EACTC,iBAAmB,CACf3lF,aAAe,QAEnBu1E,iBAAmB,CACfjwE,MAAQ,sBACRxJ,YAAc,2BAElBo8E,sBAAwB,CACpBphD,eAAgB,EAChB8uD,cAAe,EACfC,WAAY,EACZC,oBAAqB,EACrBC,qBAAsB,EACtB9J,cAAe,EACftoE,MAAQ,KACRzb,OAAS,MAEb8tF,cAAgB,CACZrsF,QAAU,KACVssF,KAAO,KACP/3D,OAAS,OAKjBtoB,EAAAA,EAAMC,YAAY1Q,KAAKJ,QAASA,GAEhCI,KAAKJ,QAAQmD,OAASnD,EAAQmD,QAAU,KAIxC/C,KAAKJ,QAAQiM,OAASjM,EAAQiM,OAG9B,IAAIqjF,EAAWtvF,EAAQmjF,uBAAyB,CAAC,EAGjD/iF,KAAI,OAAU,KAGd,IAAI+wF,EAAkB7B,EAAS1wE,MAC/Bxe,KAAKJ,QAAQmjF,sBAAsBvkE,MAAoC,mBAApBuyE,EAC7CA,EAAkBzC,EAAc0C,2BAGtC,IAAIC,EAAmB/B,EAASnsF,OAChC/C,KAAKJ,QAAQmjF,sBAAsBhgF,YAAsC,IAArBkuF,EAC9CA,EAAmB,KAGzB,IAAIC,EAAUtxF,EAAQixF,eAAiB,CAAC,EAUxC7wF,KAAKJ,QAAQixF,cAAcC,KAAOI,EAAQJ,MAAQ,CAAC,EACnD9wF,KAAKmxF,qBAGLnxF,KAAKJ,QAAQixF,cAAc93D,OAASm4D,EAAQn4D,QAAU,CAAC,EACvD/4B,KAAKoxF,sBACT,GAEA,CAAAtqF,IAAA,uBAAAC,MAOA,WACI1H,EAAOE,MAAM,yCAA0CS,KAAK4f,MAG5D,IAAIjY,EAAY3H,KAAKsmB,8BAEjByzC,EAAQ/5D,KAAKyuF,aAAezuF,KAAKsgF,uCACrC34E,EAAUQ,YAAY4xD,GAGlB/5D,KAAKJ,QAAQsf,QACblf,KAAKyuF,aAAaxvE,QAItB,IAAIpV,EAAQ7J,KAAK0uF,gBAAkB1uF,KAAKwgF,mCACpC6Q,EAAWrxF,KAAKygF,sCACpB52E,EAAM1B,YAAYkpF,GAGlB,IAAIv8B,EAAS90D,KAAK2gF,yCAClB0Q,EAASlpF,YAAY2sD,GAGrB,IAAItwD,EAAUxE,KAAKihF,yCACnBjhF,KAAK2uF,kBAAoBnqF,EAAQ0qB,WACjCmiE,EAASlpF,YAAY3D,GAGrB,IAAI8sF,EAAUtxF,KAAK4uF,kBAAoB5uF,KAAKmhF,qCAC5CkQ,EAASlpF,YAAYmpF,GAGrB,IAAI1/E,EAAO5R,KAAK6uF,eAAiB7uF,KAAKohF,0CACtCiQ,EAASlpF,YAAYyJ,GAErB,IAAIkqC,EAAS97C,KAAK0gF,iCAOlB,OANA2Q,EAASlpF,YAAY2zC,GAE6B,OAA9C97C,KAAKJ,QAAQmjF,sBAAsBhgF,QACnC4E,EAAUQ,YAAY0B,GAGnBlC,CACX,GAMA,CAAAb,IAAA,uBAAAC,MAKA,WACI1H,EAAOE,MAAM,wCAEb,IAAIw5B,EAASu1D,EAAciD,eAAeC,OAC1CnyF,EAAOE,MAAM,eAAgBw5B,GAIzB/4B,KAAKJ,QAAQixF,cAAc93D,kBAAkB1V,EAAAA,QAC7C0V,EAAS/4B,KAAKJ,QAAQixF,cAAc93D,QAGxC/4B,KAAKivF,aAAe,IAAIh/E,EAAAA,MAAM,CAC1B8E,MAAQgkB,GAEhB,GAEA,CAAAjyB,IAAA,qBAAAC,MAKA,WACI1H,EAAOE,MAAM,qCAGb,IAAI87B,EAASr7B,KAAKJ,QAAQixF,cAAcC,KAGxCzxF,EAAOE,MAAM,cAAe87B,EAAOzS,OAGnC,IAAI42D,EAAiB,CACjBzqE,MAAQ2nE,EAASC,sBACjB5kE,OAAS2kE,EAASI,yBAAyB7mD,aAG3CoF,EAAO3wB,eAAe,YAAc2wB,EAAOokD,mBAAmBp8D,EAAAA,QAC9Dm8D,EAAezqE,MAAQsmB,EAAOokD,SAE9BpkD,EAAO3wB,eAAe,UAAY2wB,EAAOzS,iBAAiBg0D,EAAAA,SAC1D4C,EAAeznE,OAASsjB,EAAOzS,OAGnC5oB,KAAK+uF,gBAAkB,IAAI9+E,EAAAA,MAAMuvE,GAGjCngF,EAAOE,MAAM,eAAgB87B,EAAOqkD,QAEpC,IAAIC,EAAkB,CAClB5nE,OAAS2kE,EAASM,0BAA0B/mD,aAG5CoF,EAAO3wB,eAAe,WAAa2wB,EAAOqkD,kBAAkB9C,EAAAA,SAC5D+C,EAAgB5nE,OAASsjB,EAAOqkD,QAGpC1/E,KAAKgvF,iBAAmB,IAAI/+E,EAAAA,MAAM0vE,EACtC,GAEA,CAAA74E,IAAA,wBAAAC,MAMA,WACI1H,EAAOE,MAAM,wCAEb,IAAIkyF,EAAazxF,KAAKJ,QAAQixF,cAAcrsF,QAE5CnF,EAAOE,MAAM,gBAAiBkyF,GAE9B,IAAI92D,EAAe2zD,EAAciD,eAAeG,QAChDxwF,OAAOC,KAAKw5B,GAAc/wB,SAAQ,SAAC9C,GAC/B,GAAK2qF,EAAW/mF,eAAe5D,GAGxB,CACH,IAAI6qF,EAAgBh3D,EAAa7zB,GACJ,WAAzBsT,EAAOu3E,KAGPlhF,EAAAA,EAAMC,YAAYihF,EAAeF,EAAW3qF,IAC5C2qF,EAAW3qF,GAAO6qF,EAE1B,MATIF,EAAW3qF,GAAO6zB,EAAa7zB,EAUvC,GACJ,GAMA,CAAAA,IAAA,0BAAAC,MAOA,SAAyBd,GAAK,IAAA6mB,EAAA,KAC1BztB,EAAOE,MAAM,4CAGR0G,IAILjG,KAAKovF,eAAiB,IAAIlP,KAE1BlgF,KAAKqvF,eAAiB,IAAIv0B,IAAJ,CAAgB,CAClCl+C,OAAS5c,KAAKovF,eACdnwF,MAAQe,KAAKgvF,mBAIjBhvF,KAAKqvF,eAAe5xB,gBAAkB,iBAEtCx3D,EAAI4wD,SAAS72D,KAAKqvF,gBAGlBppF,EAAIk6E,cAAcv2E,SACd,SAAC8lB,GACG,GAAIA,aAAmBymC,EAAAA,QAAe,CAElC,IAAIrC,EAAUhnC,EAAKuiE,eAAe14B,UAE9BjnC,EAAQtO,QAAQ0yC,GAAS3jD,QAAU2jD,GACnCpkC,EAAQmnC,SACJ/pC,EAAKuiE,eAAgB,CACjBl/E,MAAQ2c,EAAKltB,QAAQwgF,iBAAiBjwE,MACtCxJ,YAAcmmB,EAAKltB,QAAQwgF,iBAAiBz5E,aAI5D,CACJ,IAER,GAEA,CAAAG,IAAA,yBAAAC,MAOA,SAAwBd,GAAK,IAAAunB,EAAA,KACzBnuB,EAAOE,MAAM,2CAGR0G,IAKLjG,KAAKsvF,aAAe,IAAI/kD,EAAAA,KAAgB,CACpC3tB,OAAS5c,KAAKovF,eACdljF,KAAO,aACPjN,MAAQe,KAAK+uF,gBACb6C,WAAY,IAGhB5xF,KAAKsvF,aAAavP,cAAc,CAC5B13E,KAAO,gBACPuU,OAAS5c,OAGbiG,EAAI+5E,eAAehgF,KAAKsvF,cAGxBtvF,KAAKsvF,aAAavhE,GAAG,aAAa,SAACsuB,GAC/Bh9C,EAAOE,MAAM,YAAa88C,GAGL,OAAjB7uB,EAAK5B,UACL4B,EAAK4hE,eAAeyC,cAAcrkE,EAAK5B,SACvC4B,EAAK5B,QAAU,MAIM,OAArB4B,EAAK+hE,cACL/hE,EAAK4hE,eAAeyC,cAAcrkE,EAAK+hE,aACvC/hE,EAAK+hE,YAAc,MAEvB/hE,EAAKgiE,eAAiBnzC,EAAIvjB,QAI1B,IADA,IAAIg5D,EAAYtkE,EAAK4hE,eAAeU,cAC3B16E,EAAI,EAAGA,EAAI08E,EAAU1wF,OAAQgU,IAClCoY,EAAK4hE,eAAeyC,cAAcC,EAAU18E,IAMhDoY,EAAKyvB,cAAc,0BACvB,IAGAj9C,KAAKsvF,aAAavhE,GAAG,WAAW,SAACsuB,GAC7Bh9C,EAAOE,MAAM,UAAW88C,GAKxB7uB,EAAKyvB,cAAc,yBAGnBzvB,EAAK+hE,YAAc/hE,EAAKgiE,oBAI+B,IAA5ChiE,EAAK5tB,QAAQ4wF,iBAAiB/lF,WAA2E,OAA9C+iB,EAAK5tB,QAAQmjF,sBAAsBhgF,SACrGyqB,EAAKkhE,gBAAgBzvF,MAAM+U,QAAU,SAKzCwZ,EAAK8hE,aAAa3kD,WAAU,GAC5Bnd,EAAKukE,iBACT,IACJ,GAEA,CAAAjrF,IAAA,4BAAAC,MASA,SAA2Bd,EAAKwW,GAC5Bpd,EAAOE,MAAM,8CAGR0G,IAIDwW,GACIzc,KAAKqvF,iBACLppF,EAAI8wD,YAAY/2D,KAAKqvF,gBACrBrvF,KAAKqvF,eAAiB,MAI1BrvF,KAAKsvF,eACLrpF,EAAIk5E,kBAAkBn/E,KAAKsvF,cAC3BtvF,KAAKsvF,aAAe,MAE5B,GAMA,CAAAxoF,IAAA,eAAAC,MAOA,WAII,GAA4B,OAAxB/G,KAAKwvF,eAAT,CAWA,IANA,IAAI7gF,EAAW,GAGXqjF,EADMhyF,KAAKiH,SACGmlB,UAAUC,gBACxB4lE,EAAW,YACXC,EAAclyF,KAAKwvF,eAAe/1D,cAAcgB,iBAC3CrlB,EAAI,EAAGA,EAAI88E,EAAY9wF,OAAQgU,IAAK,CACzC,IAAI+8E,EAAKD,EAAY98E,GACjBg9E,EAAKD,EAELH,IAAYC,IACZG,GAAK5lE,EAAAA,EAAAA,WAAgB2lE,EAAIH,EAASC,IAEtCtjF,EAAS/I,KAAK,CACV4e,IAAM+S,KAAKC,MAAc,IAAR46D,EAAG,IAAY,IAChC3tE,IAAM8S,KAAKC,MAAc,IAAR46D,EAAG,IAAY,KAExC,CAEA,OAAOzjF,CArBP,CAFItP,EAAOmU,KAAK,+BAwBpB,GAEA,CAAA1M,IAAA,aAAAC,MAOA,WACI,GAA4B,OAAxB/G,KAAKwvF,eAAT,CAYA,IAPA,IAAIpuF,EAAS,EAGT4wF,EADMhyF,KAAKiH,SACGmlB,UAAUC,gBACxB4lE,EAAW,YAEXC,EAAclyF,KAAKwvF,eAAe/1D,cAAcgB,iBAC3CrlB,EAAI,EAAG8M,EAAKgwE,EAAY9wF,OAAS,EAAGgU,EAAI8M,IAAM9M,EAAG,CACtD,IAAIi9E,GAAK7lE,EAAAA,EAAAA,WAAgB0lE,EAAY98E,GAAI48E,EAASC,GAC9CK,GAAK9lE,EAAAA,EAAAA,WAAgB0lE,EAAY98E,EAAI,GAAI48E,EAASC,GACtDI,EAAG,GAAK96D,KAAKC,MAAc,IAAR66D,EAAG,IAAY,IAClCA,EAAG,GAAK96D,KAAKC,MAAc,IAAR66D,EAAG,IAAY,IAClCC,EAAG,GAAK/6D,KAAKC,MAAc,IAAR86D,EAAG,IAAY,IAClCA,EAAG,GAAK/6D,KAAKC,MAAc,IAAR86D,EAAG,IAAY,IAClClxF,IAAUmxF,EAAAA,EAAAA,aAAoBF,EAAIC,EACtC,CAEA,OAAOlxF,CAnBP,CAFI/B,EAAOmU,KAAK,+BAsBpB,GAEA,CAAA1M,IAAA,mBAAAC,MAOA,WACI,GAA4B,OAAxB/G,KAAKwvF,eAAT,CAYA,IAPA,IACIwC,EADMhyF,KAAKiH,SACGmlB,UAAUC,gBAGxBmmE,EAAc,GAEdN,EAAclyF,KAAKwvF,eAAe/1D,cAAcgB,iBAC3CrlB,EAAI,EAAGA,EAAI88E,EAAY9wF,OAAQgU,IAAK,CACzC,IAAIi9E,GAAK7lE,EAAAA,EAAAA,WAAgB0lE,EAAY98E,GAAI48E,EAN9B,aAOXK,EAAG,GAAK96D,KAAKC,MAAc,IAAR66D,EAAG,IAAY,IAClCA,EAAG,GAAK96D,KAAKC,MAAc,IAAR66D,EAAG,IAAY,IAClCG,EAAY5sF,KAAKysF,EACrB,CAEA,OAAOG,CAhBP,CAFInzF,EAAOmU,KAAK,+BAmBpB,GAEA,CAAA1M,IAAA,kBAAAC,MAMA,WACI1H,EAAOE,MAAM,kCAGb,IAAIoP,EAAW3O,KAAKyyF,eAEpB,GADApzF,EAAOE,MAAM,WAAYoP,GACpBA,EAAL,CAMA,IAAI/O,EAAU,CAAC,EAGf6Q,EAAAA,EAAMC,YAAY9Q,EAASI,KAAKJ,QAAQ4wF,kBAGxC//E,EAAAA,EAAMC,YAAY9Q,EAAS,CACvBiM,OAASjM,EAAQiM,QAAU7L,KAAKJ,QAAQiM,SAKjB,kBAAhBjM,EAAQwK,MACiB,kBAArBpK,KAAKJ,QAAQwK,IACpBxK,EAAQwK,IAAMpK,KAAKJ,QAAQwK,IAE3BxK,EAAQwK,KAAM,GAItBqG,EAAAA,EAAMC,YAAY9Q,EAAS,CACvBwK,IAAMxK,EAAQwK,MAIlB,IAAIzB,EAAO3I,KAGP0yF,IAA4D,OAA5C1yF,KAAKJ,QAAQ4wF,iBAAiB7vF,WAAyE,mBAA5CX,KAAKJ,QAAQ4wF,iBAAiB7vF,WACzGgyF,IAA4D,OAA5C3yF,KAAKJ,QAAQ4wF,iBAAiB/lF,WAAyE,mBAA5CzK,KAAKJ,QAAQ4wF,iBAAiB/lF,WAoC7GgG,EAAAA,EAAMC,YAAY9Q,EAAS,CACvB6K,UAlC2B,SAAUQ,GACrC5L,EAAOE,MAAM0L,GACTA,IACAtC,EAAK+lF,gBAAgBzvF,MAAM+U,QAAU,QAEjCrL,EAAKwmF,QACLxmF,EAAKwmF,MAAQ,CAAC,GAElBxmF,EAAKwmF,MAAQxmF,EAAKiqF,yBAAyB3nF,EAAO8+B,YAClDphC,EAAK2nF,gBAAgB3nF,EAAKwmF,OAC1BxmF,EAAKimF,kBAAkBlmF,UAAY,8EACnCC,EAAKkqF,UAAW,EAChBlqF,EAAK2mF,aAAa3kD,WAAU,IAE5BgoD,GACAhqF,EAAK/I,QAAQ4wF,iBAAiB/lF,UAAUtL,KAAKwJ,EAAMA,EAAKy/B,UAEhE,EAkBIznC,UAf2B,SAAUD,GAErCiI,EAAK+lF,gBAAgBzvF,MAAM+U,QAAU,OAErC3U,EAAOqB,MAAMA,EAAMoB,SACnB6G,EAAKimF,kBAAkBlmF,UAAY,8EACnCC,EAAKkqF,UAAW,EAChBlqF,EAAK2mF,aAAa3kD,WAAU,GACxB+nD,GACA/pF,EAAK/I,QAAQ4wF,iBAAiB7vF,UAAUxB,KAAKwJ,EAAMjI,EAE3D,IASA,IAAIukB,EAAWrlB,EAAQqlB,UAAY,IAE/BA,EAAW,GACXxU,EAAAA,EAAMC,YAAY9Q,EAAS,CACvBqlB,SAAWA,IAKnBxU,EAAAA,EAAMC,YAAY9Q,EAAS,CACvBolB,UAAYrW,IAGhBtP,EAAOE,MAAM,qBAAsBK,GAGnCI,KAAK4uF,kBAAkBlmF,UAAY,gFAGnC2mB,EAAAA,GAAGC,SAASoX,YAAY9mC,EA9FxB,MAFIP,EAAOmU,KAAK,sBAiGpB,GAMA,CAAA1M,IAAA,2BAAAC,MAOA,SAA0BgjC,GACtB1qC,EAAOE,MAAM,0CAA2CwqC,GAExD,IAAIolD,EAAQplD,EAIZ,GADoB/pC,KAAK8yF,mBACzB,CAIA3D,EAAM,GAAGlN,KAAO,EAChBkN,EAAM,GAAGhH,MAAQ,EACjBgH,EAAM,GAAG4D,OAAS5D,EAAM,GAAG1qE,IAC3B0qE,EAAM,GAAG6D,OAAS7D,EAAM,GAAG3qE,IAC3B2qE,EAAM,GAAG1qE,IAAM8S,KAAKC,MAAqB,IAAf23D,EAAM,GAAG1qE,KAAgB,IACnD0qE,EAAM,GAAG3qE,IAAM+S,KAAKC,MAAqB,IAAf23D,EAAM,GAAG3qE,KAAgB,IAEnD,IAAIyuE,EAAiB,EACjBC,EAAgB,EAChBC,EAAsB,EACtBC,EAAuB,EACvBC,EAAY,EACZC,EAAU,EAEVC,EAAY,GAChB9wF,QAAQC,IAAIysF,GACZ,IAAK,IAAI/5E,EAAI,EAAGA,EAAI+5E,EAAM/tF,OAAQgU,IAAK,CACnC,IAAImF,EAAI,CAAC40E,EAAM/5E,GAAGoP,IAAK2qE,EAAM/5E,GAAGqP,KAC5B+uE,GAAqBjB,EAAAA,EAAAA,aAAoBh4E,EAAG,CAAC40E,EAAM/5E,EAAE,GAAG49E,OAAQ7D,EAAM/5E,EAAE,GAAG29E,SAC3E9Q,EAAOuR,EAAqBH,EAE5BI,EAAKtE,EAAM/5E,GAAG0sB,EACd4xD,EAAKvE,EAAM/5E,EAAI,GAAG0sB,EAClB2xD,EAAK,IACLA,EAAK,GAELC,EAAK,IACLA,EAAK,GAET,IAAIvL,EAAQsL,EAAKC,EACbvL,EAAQ,GACR8K,GAAkBO,EAClBJ,GAAwBjL,GACjBA,EAAQ,IACf+K,GAAiBM,EACjBL,GAAuBhL,GAE3BkL,EAAYpR,EACZkN,EAAM/5E,GAAG6sE,KAAOA,EAEhBsR,EAAU3tF,KAAKytF,GAEfC,GAAYnL,EAAS5wD,KAAK2X,IAAI3X,KAAKC,MAAM2wD,EAAQlG,EAAO,MAAQ,EAChEkN,EAAM/5E,GAAG+yE,MAASA,EAAS5wD,KAAK2X,IAAI3X,KAAKC,MAAM2wD,EAAQlG,EAAO,MAAQ,EAKtE,IAAIl7E,EAAQooF,EAAM/5E,GAAG+yE,MAEjBgH,EAAM/5E,GAAG4C,MADTjR,EAAQ,IAAMA,EAAQ,GACL,UACVA,EAAQ,IAAMA,EAAQ,GACZ,UACVA,EAAQ,GACE,UAEA,UAErBooF,EAAM/5E,GAAG29E,OAAS5D,EAAM/5E,GAAGqP,IAC3B0qE,EAAM/5E,GAAG49E,OAAS7D,EAAM/5E,GAAGoP,IAC3B2qE,EAAM/5E,GAAGqP,IAAM8S,KAAKC,MAAqB,IAAf23D,EAAM/5E,GAAGqP,KAAgB,IACnD0qE,EAAM/5E,GAAGoP,IAAM+S,KAAKC,MAAqB,IAAf23D,EAAM/5E,GAAGoP,KAAgB,GACvD,CAGAnlB,EAAOE,MAAM,iBAAkBg0F,GAO/B,IAJA,IAAII,EAAUxE,EAAM,GAAGrtD,EACnB8xD,EAAUzE,EAAM,GAAGrtD,EACnB+xD,EAAgB1E,EAAM,GAAGhH,MAEpB2L,EAAK,EAAGA,EAAK3E,EAAM/tF,OAAQ0yF,IAAM,CACtC,IAAIrkD,EAAI0/C,EAAM2E,GACVrkD,EAAE3N,GAAK,MACP2N,EAAE3N,EAAI,GAEN2N,EAAE3N,EAAI8xD,IACNA,EAAUnkD,EAAE3N,GAEZ2N,EAAE3N,EAAI6xD,IACNA,EAAUlkD,EAAE3N,GAGZ2N,EAAE04C,MAAQ0L,IACVA,EAAgBpkD,EAAE04C,MAE1B,CAEA,MAAO,CACHsI,aAAeoD,EACfnD,UAAYn5D,KAAKC,MAAM87D,EAAUnE,EAAM/tF,QACvC2yF,aAAeb,EACfc,cAAgBf,EAChBtC,mBAAqBwC,EACrBvC,oBAAsBwC,EACtBa,OAASN,EAAQ/P,iBACjBsQ,OAASN,EAAQhQ,iBACjB5+E,SAAWhF,KAAKm0F,aAChBjkD,KA1GQ,IA2GRvpB,OAASwoE,EAtGb,CAwGJ,GAEA,CAAAroF,IAAA,kBAAAC,MAOA,SAAiBgjC,GACb1qC,EAAOE,MAAM,iCAAkCwqC,GAE/C/pC,KAAKo0F,uBAGL,IAAIzsF,EAAY3H,KAAKJ,QAAQmjF,sBAAsBhgF,OAC/C4E,GACAA,EAAUQ,YAAYnI,KAAK0uF,iBAE/B/mF,EAAY3H,KAAK2uF,kBAMK3uF,KAAKJ,QAAQmjF,sBAAsBvkE,MAGzCrf,KAAKa,KAAM+pC,EAAYpiC,EANzB3H,MAQd,IAAIyB,EAAOzB,KAAKJ,QAAQmjF,sBACpBv8E,EAAUgC,SAASqL,eAAe,4BAA8B7T,KAAK4f,MACrEpZ,IACI/E,EAAKkgC,eACLlgC,EAAKgvF,cACLhvF,EAAKivF,WACLjvF,EAAKkvF,oBACLlvF,EAAKmvF,uBAELpqF,EAAQvH,MAAM+U,QAAU,SAgBhChU,KAAKi9C,cAAc,CACf/wC,KAAO,yBAEf,GAEA,CAAApF,IAAA,uBAAAC,MAKA,WACI1H,EAAOE,MAAM,uCAGb,IAAIoiC,EAAgB3hC,KAAKJ,QAAQmjF,sBAAsBphD,cACnD+uD,EAAY1wF,KAAKJ,QAAQmjF,sBAAsB2N,UAC/CD,EAAezwF,KAAKJ,QAAQmjF,sBAAsB0N,aAClDE,EAAqB3wF,KAAKJ,QAAQmjF,sBAAsB4N,mBACxDC,EAAsB5wF,KAAKJ,QAAQmjF,sBAAsB6N,oBAGzDroF,EAAMvI,KAAK6uF,eACf,GAAItmF,EAAIinB,kBACJ,KAAOjnB,EAAI2mB,YACP3mB,EAAI4mB,YAAY5mB,EAAI2mB,YAKxByS,GACA3hC,KAAKqhF,kCAAkC,qBAAsB9pD,KAAKC,MAAMx3B,KAAKmvF,MAAMnqF,UAAU4+E,iBAAmB,MAGhH+M,GACA3wF,KAAKqhF,kCAAkC,sBAAuBrhF,KAAKmvF,MAAMwB,mBAAmB/M,iBAAmB,MAG/GgN,GACA5wF,KAAKqhF,kCAAkC,sBAAuBrhF,KAAKmvF,MAAMyB,oBAAoBhN,iBAAmB,MAGhH8M,GACA1wF,KAAKqhF,kCAAkC,mBAAoBrhF,KAAKmvF,MAAMuB,UAAU9M,iBAAmB,MAGnG6M,GACAzwF,KAAKqhF,kCAAkC,sBAAuBrhF,KAAKmvF,MAAMsB,aAAa7M,iBAAmB,KAEjH,GAEA,CAAA98E,IAAA,iBAAAC,MAIA,WAKI,GAHA/G,KAAKuvF,YAAc,KACnBvvF,KAAKwvF,eAAiB,KAElBxvF,KAAKovF,eAAgB,CAEjBpvF,KAAK4rB,UACL5rB,KAAKovF,eAAeyC,cAAc7xF,KAAK4rB,SACvC5rB,KAAK4rB,QAAU,MAKnB,IADA,IAAIkmE,EAAY9xF,KAAKovF,eAAeU,cAC3B16E,EAAI,EAAGA,EAAI08E,EAAU1wF,OAAQgU,IAClCpV,KAAKovF,eAAeyC,cAAcC,EAAU18E,GAEpD,CACJ,GAEA,CAAAtO,IAAA,iBAAAC,MAIA,WAKI,GAHA/G,KAAKkvF,SAAW,KAGZlvF,KAAK2uF,kBACL,KAAO3uF,KAAK2uF,kBAAkBz/D,YAC1BlvB,KAAK2uF,kBAAkBx/D,YAAYnvB,KAAK2uF,kBAAkBz/D,WAGtE,GAMA,CAAApoB,IAAA,2BAAAC,MAOA,SAA0B9E,GACtB,IAAI+4D,EAASh7D,KAAKyuF,aAAa/lE,YAChB,SAAXsyC,GACAh7D,KAAKgoC,cAGT,IAAI/hC,EAAMjG,KAAKiH,SACf43E,EAAAA,EAAalnD,MAAM1xB,EAAK,CACpByhB,QAAU,kBAIC,SAAXszC,GAEsB,OAAlBh7D,KAAKkvF,WACLlvF,KAAK0uF,gBAAgBzvF,MAAM+U,QAAU,QAGzChU,KAAK0vF,wBAAwBzpF,GAC7BjG,KAAK2vF,uBAAuB1pF,KAE5BjG,KAAK0uF,gBAAgBzvF,MAAM+U,QAAU,OAKjC/R,GAAKA,EAAEc,OAAOuxD,SAAWryD,EAAEc,OAAOuxD,QAAQ+/B,cACH,SAAnCpyF,EAAEc,OAAOuxD,QAAQ+/B,cACjBr0F,KAAKs0F,kBAGLt0F,KAAKuvF,YAAc,KACnBvvF,KAAKwvF,eAAiB,MAG1BxvF,KAAKs0F,iBAETt0F,KAAKmwF,iBAEDluF,GAAKA,EAAEc,OAAOuxD,SAAWryD,EAAEc,OAAOuxD,QAAQyC,YAC1C/2D,KAAKowF,0BAA0BnqF,EAAuC,SAAjChE,EAAEc,OAAOuxD,QAAQyC,aAEtD/2D,KAAKowF,0BAA0BnqF,GAAK,GAGhD,GAEA,CAAAa,IAAA,+BAAAC,MAOA,WACI,IAAIwB,EAAMvI,KAAK6uF,eAGO,iCAAlBtmF,EAAIG,WACJ5F,aAAa9C,KAAK8uF,YAClBvmF,EAAIG,UAAY,8BAEhBH,EAAIG,UAAY,8CAIpB1I,KAAK8uF,WAAaxsF,YAAW,WACzBiG,EAAIG,UAAY,4BACpB,GAAG,IACP,I,EAAC,EAAA5B,IAAA,wBAAAC,MAl4CD,SAA8BgE,GAC1B,IAAIpC,EAAOoC,EAEPpC,EAAKijB,UACLjjB,EAAKymF,eAAeyC,cAAclpF,EAAKijB,SACvCjjB,EAAKijB,QAAU,KAEvB,GAAC,CAAA9kB,IAAA,wBAAAC,MAUD,SAA8BgE,EAAS0kC,GACnC,IAAI9mC,EAAOoC,EAEPpC,EAAKijB,UACLjjB,EAAKymF,eAAeyC,cAAclpF,EAAKijB,SACvCjjB,EAAKijB,QAAU,MAEnB,IACIO,EADMxjB,EAAK1B,SACAmlB,UAAUC,gBAErBjB,GAAcoB,EAAAA,EAAAA,WAAgB,CAACijB,EAAEjrB,IAAKirB,EAAEhrB,KAAM,YAAa0H,GAC3DooE,EAAkB5rF,EAAKymF,eACtBU,cAAc,GACdr2D,cACA+6D,gBAAgBppE,GAEjBqpE,EAAY,IAAIC,EAAAA,MAAMH,GAE1B5rF,EAAKijB,QAAU,IAAIyJ,IAAJ,CAAY,CACvB1mB,SAAW8lF,IAEfp1F,EAAOE,MAAMk1F,GAGb9rF,EAAKijB,QAAQ0P,SAAS3yB,EAAKsmF,cAG3BtmF,EAAKymF,eAAeuF,WAAWhsF,EAAKijB,QACxC,GAEA,CAAA9kB,IAAA,wBAAAC,MAQA,SAA8BgE,EAAS0kC,GACnC,IAAI9mC,EAAOoC,EACXujF,EAAcnH,sBAAsBx+E,GACpC2lF,EAAcpH,sBAAsBv+E,EAAM8mC,EAC9C,GAEA,CAAA3oC,IAAA,8BAAAC,MAQA,SAAoCgE,EAAS0kC,GACzCpwC,EAAOqD,IAAI,+BAMX,IAJA,IAAIiG,EAAOoC,EAEP6pF,EAAOnlD,EAAE9oB,OACTkuE,EAAQlsF,EAAK1B,SAASmlB,UAAUC,gBAC3BjX,EAAI,EAAGA,EAAIw/E,EAAKxzF,OAAQgU,IAAK,CAClC,IAAIhF,EAAMwkF,EAAKx/E,GACXgW,GAAcoB,EAAAA,EAAAA,WAAgB,CAACpc,EAAIoU,IAAKpU,EAAIqU,KAAM,YAAaowE,GAC/DJ,EAAY,IAAIC,EAAAA,MAAMtpE,GAE1BziB,EAAKijB,QAAU,IAAIyJ,IAAJ,CAAY,CACvB1mB,SAAW8lF,IAEfp1F,EAAOE,MAAMk1F,GAGb,IAAIp5D,EAASizD,EAAciD,eAAeuD,QACtCC,EAAS,IAAIpvE,EAAAA,OAAO,CACpByS,OAASiD,EAAO25D,YAChBj9E,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQqjB,EAAO45D,iBACfn9E,MAAQujB,EAAO65D,mBAEnBh5E,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQqjB,EAAO85D,mBAGvBxsF,EAAKijB,QAAQ0P,SAAS,IAAIrrB,EAAAA,MAAM,CAC5B8E,MAAQggF,KAIZpsF,EAAKymF,eAAeuF,WAAWhsF,EAAKijB,QACxC,CACJ,GAEA,CAAA9kB,IAAA,mCAAAC,MAQA,SAAyCgE,EAAS9I,GAC9C5C,EAAOqD,IAAI,mCAAoCqI,EAAS9I,EAC5D,GAEA,CAAA6E,IAAA,+BAAAC,MAOA,SAAqClH,EAAM8H,EAAWoD,GAIlD,GAHA1L,EAAOE,MAAM,8CAGW,oBAAbqrF,SAAX,CAKA,IAAIpmF,EAAUg9E,EAAwBkJ,0BAA0B7qF,EAAM8H,EAAWoD,EAASujF,GAEtF9pF,IACAxE,KAAKkvF,SAAW1qF,EALpB,MAFInF,EAAOqD,IAAI,gCASnB,GAEA,CAAAoE,IAAA,yBAAAC,MAOA,SAA+BlH,EAAM8H,EAAWoD,GAI5C,GAHA1L,EAAOE,MAAM,wCAGK,oBAAPqpF,GAAX,CAKA,IAAIpkF,EAAUg9E,EAAwBmH,oBAAoB9oF,EAAM8H,EAAWoD,EAASujF,GAEhF9pF,IACAxE,KAAKkvF,SAAW1qF,EALpB,MAFInF,EAAOqD,IAAI,0BASnB,GAEA,CAAAoE,IAAA,sBAAAC,MAOA,SAA4BlH,EAAM8H,EAAWoD,GACzC1L,EAAOE,MAAM,qCAEb,IAAIiF,EAAUg9E,EAAwB+G,kBAAkB1oF,EAAM8H,EAAWoD,EAASujF,GAE9E9pF,IACAxE,KAAKkvF,SAAW1qF,EAExB,GAAC,CAAAsC,IAAA,6BAAAC,MASD,SAAmClH,EAAM8H,EAAWoD,GAChD1L,EAAOE,MAAM,4CAEb,IAAIiF,EAAUg9E,EAAwBgB,wBAAwB3iF,EAAM8H,EAAWoD,EAASujF,GAEpF9pF,IACAxE,KAAKkvF,SAAW1qF,EAExB,I,4FAAC,CAlYY,CAA+B6C,EAAAA,G,EAAOknF,E,EAAA,iB,EA0F3B,CAIpBiD,OAAS,IAAItyF,EAAAA,KAAK,CACd+W,IAAM+V,EAAAA,EAAqB,YAG3BzP,OAAS,CAAC,GAAK,GACf64E,aAAc,IAGlBN,QAAU,CAENE,YAAc,EACdG,eAAiB,2BACjBF,iBAAmB,qBACnBC,iBAAmB,K,kGAyE1B3G,GAg5CLrtF,OAAOwX,OAAO41E,EAAcnpF,UAAWk7E,GACvCn/E,OAAOwX,OAAO41E,EAAcnpF,UAAWk6D,EAAAA,GAEvC,WAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQ4+D,cAAgBA,E,wBC7rDtCxvF,EAAOC,QAAUC,GAAGq2F,W,wBCApBv2F,EAAOC,QAAUC,GAAGwN,MAAM8oF,U,yHC2L1B,QA3K0B,CAoBtBxwE,MAAQ,SAAUllB,GAEd,IAAIP,EAAS,IAAOC,UAAU,uBAC9BD,EAAOE,MAAM,CAAC,iCAEd,IAAIM,EAAO,KAEX,GAAID,EAAQW,SAAZ,CACI,GAAIX,EAAQ4K,YACRnL,EAAOE,MAAM,0BACbM,EAAOD,EAAQW,aACZ,CACH,OAAQX,EAAQiL,cACZ,IAAK,MACDxL,EAAOE,MAAM,0BAEb,IACI,IAAIy8C,EAAI,IAAI,IAAI,CACZ69B,OAAS,EAAAn0D,IAWb,GARgC,iBAArB9lB,EAAQW,SACfy7C,EAAE8+B,aAAal7E,EAAQW,UAEvBy7C,EAAEi/B,UAAUr7E,EAAQW,YAGxBV,EAAOm8C,EAAEv4C,SAGL,MAAM,IAAIhE,MAAM,IAAKwK,WAAW,gCAExC,CAAE,MAAOhI,GACL,IAAIH,EAAUG,EAAEH,QAMhB,YALAlC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BnI,GACxDE,OAAS,IACTkK,KAAO,IAAaC,cAG5B,CAEA,MAEJ,IAAK,OACD9M,EAAOE,MAAM,2BACbF,EAAOE,MAAM,6BAA8BK,EAAQW,UAEnD,IAAI6rC,EAAe,KAQnB,IANIA,EAD4B,iBAArBxsC,EAAQW,SACAiD,KAAKC,MAAM7D,EAAQW,UAEnBX,EAAQW,WAIP6rC,EAAa1rC,MAO7B,YALAd,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BmiC,EAAa1rC,MAAMiG,aAC3E3E,OAAS,IACTkK,KAAO,IAAaC,eAM5B,GAAIigC,EAAc,CACd,IAEIjB,EAFApB,EAAaqC,EAAarC,WAC1BiB,EAAe,IAAI,EAAAtlB,EAEvB,GAAIlc,MAAM4E,QAAQ27B,IAAeA,EAAW3oC,OACxC,IAAK,IAAIgU,EAAI,EAAGA,EAAI20B,EAAW3oC,OAAQgU,IACnC+1B,EAAY,IAAI,IAEa,iBAAlBpB,EAAW30B,IAEd20B,EAAW30B,GAAGoP,MACd2mB,EAAU3mB,IAAMulB,EAAW30B,GAAGoP,KAE9BulB,EAAW30B,GAAGqP,MACd0mB,EAAU1mB,IAAMslB,EAAW30B,GAAGqP,KAE9BslB,EAAW30B,GAAG0sB,IACdqJ,EAAUrJ,EAAIiI,EAAW30B,GAAG0sB,GAE5BiI,EAAW30B,GAAGq2B,MACdN,EAAUM,IAAM1B,EAAW30B,GAAGq2B,KAE9B1B,EAAW30B,GAAGgQ,WACd+lB,EAAU/lB,SAAW2kB,EAAW30B,GAAGgQ,WAEP,iBAAlB2kB,EAAW30B,KAEzB+1B,EAAUrJ,EAAIiI,EAAW30B,IAGzB5L,MAAM4E,QAAQ48B,EAAajB,aAC3BiB,EAAajB,WAAWnkC,KAAKulC,GAIzCtrC,EAAOmrC,CACX,CAEA,IAAKnrC,EAMD,YALAD,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,8BAC1BiC,KAAO,IAAaytE,YACpB33E,QAAU,KAIlB,MAEJ,QAMI,YALApC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAC1BiC,KAAO,IAAaytE,YACpB33E,QAAU,KAMtB,GAAInC,EAAKksC,gBAML,YALAnsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BpK,EAAKksC,iBAC7D7/B,KAAO,IAAaC,YACpBnK,OAAS,OAGV,GAAInC,EAAKa,MAAO,CACnB,IAAI60F,EAAY11F,EAAKa,MAAMiG,YAM3B,YALA/G,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BsrF,GACxDrpF,KAAO,IAAaC,YACpBnK,OAAS,MAGjB,CACJ,CAMJpC,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAOF,EAFtC,MAFID,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAK7E,E,wBCxLJnL,EAAOC,QAAUC,GAAG+vB,O,wBCApBjwB,EAAOC,QAAUC,GAAGC,MAAMgR,K,8BCE1B,IAAI4wD,EAAc,EAAQ,MACtBloB,EAAM,EAAQ,MACdmoB,EAAS,EAAQ,MACjB00B,EAAW,EAAQ,MACnBC,EAAM,EAAQ,MAEd5mB,EAAoBl2B,EAAIk2B,kBAExBpE,EAA0B5J,EAAY4J,wBACtCzJ,EAAiBH,EAAYG,eAC7B2J,EAAkB9J,EAAY8J,gBAC9BZ,EAAYlJ,EAAYkJ,UACxB5I,EAAYN,EAAYM,UACxB3gC,EAAasgC,EAAOtgC,WAEpB4gC,EAAYq0B,EAAIr0B,UA0BpB,SAASs0B,EAAqB9gF,GAC7B,OAAOA,EAAMvG,QAAQ,gBAAiB,MAAMA,QAAQ,0BAA2B,KAChF,CA6DA,SAAS1K,EAAU/D,GA+ClB,QA7CwBugB,KADxBvgB,EAAUA,GAAW,CAAC,GACV6gC,UACX7gC,EAAQ6gC,SAAU,GAanBzgC,KAAK0Y,OAAS9Y,EAAQ8Y,QAAUmoD,EAAYnoD,OAY5C1Y,KAAK21F,WAAa/1F,EAAQ+1F,YAAcC,EAkBxC51F,KAAKmL,QAAUvL,EAAQuL,SAAWvL,EAAQ+hE,aACtC/hE,EAAQ+hE,cAAgD,mBAAzB/hE,EAAQ+hE,aAC1C,MAAM,IAAI19D,UAAU,kEACVrE,EAAQ+hE,cAClB/hE,EAAQ+hE,aAAa,UAAW,wEAAyE3hE,MAS1GA,KAAK01F,qBAAuB91F,EAAQ81F,sBAAwBA,EAW5D11F,KAAKygC,UAAY7gC,EAAQ6gC,QAWzBzgC,KAAK61F,MAAQ71F,KAAK0Y,OAAOxX,OAAOmjB,OAAO,MAAOzkB,EAAQi2F,MACvD,CAuFA,SAASD,EAAWh2F,GACnB,IAAIsK,EAAMtK,GAAW,CAAC,EAUtBI,KAAK6hE,SAAW33D,EAAI23D,UAAYkI,EAAUE,gBAkB1CjqE,KAAK81F,iBAAmB5rF,EAAI4rF,kBAAoB,KAMhD91F,KAAK2mE,OAAQ,EAWb3mE,KAAKsjE,oBAAiBnjD,EAStBngB,KAAKojE,SAAMjjD,EAaXngB,KAAKygC,aAAUtgB,EAKfngB,KAAKmL,QAAUjB,EAAIiB,OACpB,CAEA,SAAS9G,EAASo8B,EAASlqB,GAC1BA,EAAKssD,WAAapiC,EAAQoiC,WAC1BtsD,EAAKusD,aAAeriC,EAAQqiC,YAC7B,CAiJA,SAASizB,EAAU/lE,EAAOpH,EAAOxnB,GAChC,MAAoB,iBAAT4uB,EACHA,EAAMguB,OAAOp1B,EAAOxnB,GAGvB4uB,EAAM5uB,QAAUwnB,EAAQxnB,GAAUwnB,EAC9B,IAAIotE,KAAKC,KAAK/zB,OAAOlyC,EAAOpH,EAAOxnB,GAAU,GAE9C4uB,CAET,CA2CA,SAAS40C,EAAc9jD,EAASvK,GAC1BuK,EAAQwiD,eAGZxiD,EAAQwiD,eAAen7D,YAAYoO,GAFnCuK,EAAQsiD,IAAIj7D,YAAYoO,EAI1B,CAnVA5S,EAAUwB,UAAUvB,gBAAkB,SAAUgZ,EAAQilD,GACvD,IAAK8I,EAAgB9I,GACpB,MAAM,IAAI59D,UAAU,qDAAuD49D,EAAW,mBAEvF,IAAIR,EAAerhE,KAAK0Y,OAAOxX,OAAOmjB,OAAO,MAAOrkB,KAAK61F,OACrDv0B,EAAYk0B,EAASU,aACrBJ,EAAmBz0B,EAAa,KAAO,KACvCoJ,EAAwB5I,IAC3BP,EAAYk0B,EAASW,cACrBL,EAAmB30B,EAAU6I,MACnBnI,IAAakI,EAAUK,gBACjC0rB,EAAmB30B,EAAUmJ,KAE9BjJ,EAAa,IAAMy0B,EACnBz0B,EAAaj1D,IAAMi1D,EAAaj1D,KAAO+0D,EAAUwE,IAEjD,IAAIpE,EAAa,IAAIvhE,KAAK21F,WAAW,CACpC9zB,SAAUA,EACVi0B,iBAAkBA,EAClB3qF,QAASnL,KAAKmL,UAEXs1B,EAAUzgC,KAAKygC,QAAU,CAAC,OAAItgB,EAC9BngB,KAAKygC,SACR8gC,EAAW60B,mBAAmB31D,GAG/B,IAAIg1D,EAAM,IAAIr0B,EAWd,OAVAq0B,EAAI9zB,aAAeJ,EACnBk0B,EAAIl0B,WAAaA,GACJV,EAAYG,eAAea,IACT,iBAAXjlD,GACnB64E,EAAI9zB,aAAawB,WAAW,0BAE7BsyB,EAAIhyF,MAAMzD,KAAK01F,qBAAqBxzB,OAAOtlD,IAAUykD,EAAcC,GAC9DC,EAAW6B,IAAItvD,iBACnB2hF,EAAI9zB,aAAawB,WAAW,wBAEtB5B,EAAW6B,GACnB,EAmGAwyB,EAAWzwF,UAAY,CAStBq8D,cAAe,WACd,IAAI60B,EAAO,IAAIxnB,EACf7uE,KAAKojE,IAAMpC,EAAehhE,KAAK6hE,UAAYw0B,EAAKviB,oBAAmB,GAASuiB,EAAK3iB,eAAe1zE,KAAK81F,iBAAkB,GACxH,EACAjwB,aAAc,SAAU0I,EAAcvK,EAAWsB,EAAO2M,GACvD,IAAI7O,EAAMpjE,KAAKojE,IACXnsD,EAAKmsD,EAAIwQ,gBAAgBrF,EAAcjJ,GAAStB,GAChDM,EAAM2N,EAAM7wE,OAChBwjE,EAAc5kE,KAAMiX,GACpBjX,KAAKsjE,eAAiBrsD,EAEtBjX,KAAKygC,SAAWp8B,EAASrE,KAAKygC,QAASxpB,GACvC,IAAK,IAAI7B,EAAI,EAAGA,EAAIkvD,EAAKlvD,IAAK,CACzBm5D,EAAe0D,EAAMpK,OAAOzyD,GAAhC,IACIrO,EAAQkrE,EAAMnK,SAAS1yD,GAEvBu5D,GADArJ,EAAQ2M,EAAMrK,SAASxyD,GAChBguD,EAAImT,kBAAkBhI,EAAcjJ,IAC/CtlE,KAAKygC,SAAWp8B,EAAS4tE,EAAMtK,WAAWvyD,GAAIu5D,GAC9CA,EAAK5nE,MAAQ4nE,EAAKpjC,UAAYxkC,EAC9BkQ,EAAG67D,iBAAiBnE,EACrB,CACD,EACA7K,WAAY,SAAUyK,EAAcvK,EAAWsB,GAC9CtlE,KAAKsjE,eAAiBtjE,KAAKsjE,eAAex5B,UAC3C,EACA47B,mBAAoB,SAAUzB,EAAQF,GAAM,EAC5CG,iBAAkB,SAAUD,GAAS,EACrCwD,sBAAuB,SAAU1kE,EAAQlD,GACxC,IAAIy2F,EAAMt2F,KAAKojE,IAAI6S,4BAA4BlzE,EAAQlD,GACvDG,KAAKygC,SAAWp8B,EAASrE,KAAKygC,QAAS61D,GACvC1xB,EAAc5kE,KAAMs2F,EACrB,EACAC,oBAAqB,SAAUC,EAAI5tE,EAAOxnB,GAAS,EACnDqhE,WAAY,SAAUzyC,EAAOpH,EAAOxnB,GAGnC,GAFA4uB,EAAQ+lE,EAAUv3E,MAAMxe,KAAM+N,WAEnB,CACV,GAAI/N,KAAK2mE,MACR,IAAI8vB,EAAWz2F,KAAKojE,IAAI4S,mBAAmBhmD,QAEvCymE,EAAWz2F,KAAKojE,IAAIC,eAAerzC,GAEpChwB,KAAKsjE,eACRtjE,KAAKsjE,eAAen7D,YAAYsuF,GACtB,QAAQ7iF,KAAKoc,IACvBhwB,KAAKojE,IAAIj7D,YAAYsuF,GAGtBz2F,KAAKygC,SAAWp8B,EAASrE,KAAKygC,QAASg2D,EACxC,CACD,EACAC,cAAe,SAAUruF,GAAO,EAChCy8D,YAAa,WACZ9kE,KAAKojE,IAAIyR,WACV,EAOAuhB,mBAAoB,SAAU31D,GACzBA,IACHA,EAAQoiC,WAAa,GAEtB7iE,KAAKygC,QAAUA,CAChB,EAEAimC,QAAS,SAAU12C,EAAOpH,EAAOxnB,GAChC4uB,EAAQ+lE,EAAUv3E,MAAMxe,KAAM+N,WAC9B,IAAI4oF,EAAO32F,KAAKojE,IAAI2S,cAAc/lD,GAClChwB,KAAKygC,SAAWp8B,EAASrE,KAAKygC,QAASk2D,GACvC/xB,EAAc5kE,KAAM22F,EACrB,EAEA/vB,WAAY,WAEX5mE,KAAK2mE,OAAQ,CACd,EACAE,SAAU,WACT7mE,KAAK2mE,OAAQ,CACd,EAEAY,SAAU,SAAUl/D,EAAM0+D,EAAUC,EAAUC,GAC7C,IAAIovB,EAAOr2F,KAAKojE,IAAIuQ,eACpB,GAAI0iB,GAAQA,EAAKxiB,mBAAoB,CACpC,IAAI+iB,EAAKP,EAAKxiB,mBAAmBxrE,EAAM0+D,EAAUC,EAAUC,GAC3DjnE,KAAKygC,SAAWp8B,EAASrE,KAAKygC,QAASm2D,GACvChyB,EAAc5kE,KAAM42F,GACpB52F,KAAKojE,IAAI0D,QAAU8vB,CACpB,CACD,EACAC,YAAa,SAAUj0D,EAAO9gC,GAC7B,GAA4B,mBAAjB9B,KAAKmL,QACf,IACCnL,KAAKmL,QAAQy3B,EAAO9gC,EAAS9B,KAC9B,CAAE,MAAOiC,GACR,MAAM,IAAIu+B,EAAW,aAAeoC,EAAQ,KAAO9gC,EAAU,YAAcG,EAAGjC,KAAKygC,QACpF,MAEAh+B,QAAQ/B,MAAM,WAAakiC,EAAQ,MAAQ9gC,EA4B9C,SAAkB4hB,GACjB,GAAIA,EACH,MAAO,aAAeA,EAAEm/C,WAAa,QAAUn/C,EAAEo/C,aAAe,GAElE,CAhCuDg0B,CAAS92F,KAAKygC,SAEpE,EAIAqhC,QAAS,SAAUhgE,GAClB9B,KAAK62F,YAAY,UAAW/0F,EAC7B,EACApB,MAAO,SAAUoB,GAChB9B,KAAK62F,YAAY,QAAS/0F,EAC3B,EAWAqhE,WAAY,SAAUrhE,GAErB,MADA9B,KAAK62F,YAAY,aAAc/0F,GACzB,IAAI0+B,EAAW1+B,EAAS9B,KAAKygC,QACpC,GAoDD,+JAA+JpyB,QAC9J,QACA,SAAUvH,GACT8uF,EAAWzwF,UAAU2B,GAAO,WAC3B,OAAO,IACR,CACD,IAiCD/H,EAAQg4F,aAAenB,EACvB72F,EAAQ4E,UAAYA,EACpB5E,EAAQ22F,qBAAuBA,EAC/B32F,EAAQi4F,mBAjBR,SAA4Bp0D,GAC3B,GAAc,UAAVA,EAAmB,KAAM,oBAC9B,EAgBA7jC,EAAQk4F,qBARR,WACC,KAAM,sBACP,C,+CCnkBA,MAAM,EAA+Bj4F,GAAGW,OAAOu3F,I,i4DCiB/C,IAAI73F,EAAS2Q,EAAAA,EAAO1Q,UAAU,uBA6B1B43F,EAAG,SAAAC,GAYH,SAAAD,EAAat3F,GAAS,IAAAyG,E,MAGlB,G,4FAHkBC,CAAA,KAAA4wF,G,EAClB,K,EAAA,CAAMt3F,G,MAANs3F,MAAA7wF,E,6EAEsB6wF,GAClB,MAAM,IAAIjzF,UAAU,2BAuBxB,OApBArE,EAAUA,GAAW,CAAC,EAItByG,EAAKuW,OAAS,KAIdvW,EAAK+wF,WAAax3F,EAAQw3F,YAAc,KAIpCx3F,EAAQ+6B,eAAiBnxB,MAAM4E,QAAQxO,EAAQ+6B,gBAC/C/6B,EAAQ+6B,aAAe,CAAC/6B,EAAQ+6B,eAGP,OAAzB/6B,EAAQ+6B,mBAAyD,IAAzB/6B,EAAQ+6B,eAChD/6B,EAAQ+6B,aAAe,IAG3BvQ,EAAA/jB,EAAAA,EACJ,CA8BA,O,qRAAAO,CAAAswF,EAAAC,G,EAAAD,E,EAAA,EAAApwF,IAAA,cAAAC,MAyBA,SAAaswF,EAASxH,EAAU3pE,GAM5B,IALA,IAAIoxE,EAAuC,cAArBD,EAAQvtF,SAA4ButF,EAAQ/gF,WAAW,GAAGA,WAAa+gF,EAAQ/gF,WAIjGF,EAAQkhF,EACHC,EAAK,EAAGA,EAAKD,EAAel2F,OAAQm2F,IAAM,CAC/C,IAAM/wF,EAAU8wF,EAAeC,GAC/B,GAAyB,aAArB/wF,EAAQsD,SAAyB,CACjCsM,EAAQ5P,EAAQ8P,WAChB,KACJ,CACA,GAAyB,cAArB9P,EAAQsD,SAA0B,CAClCsM,EAAQ,CAAC5P,GACT,KACJ,CACJ,CAOA,IAFA,IAAIgxF,EAAY,CAAC,EACbvuF,GAAS,EACJmM,EAAI,EAAGA,EAAIgB,EAAMhV,OAAQgU,IAAK,CACnC,IAAImB,EAAOH,EAAMhB,GACjB,OAAQmB,EAAKzM,UACT,IAAK,QAKD,IAAI5F,EAAKqS,EAAK0wB,WAAW,GACzB,GAAI/iC,GAAsB,OAAhBA,EAAG4F,SAAmB,CAC5B,IACI2tF,EAAKlhF,EACTihF,EAFStzF,EAAGqnC,WAEIksD,CACpB,CACA,MAEJ,IAAK,YAEDxuF,IASA,IARA,IAAIyuF,EAAQnhF,EAAKD,WACblS,GAAQ,EACR6X,GAAO,EACP07E,GAAO,EACPC,EAAY,KACZC,EAAc,KACdC,EAAkB,KAClBC,EAAaxhF,EACRqQ,EAAI,EAAGA,EAAI8wE,EAAMt2F,OAAQwlB,IAC9B,OAAQ8wE,EAAM9wE,GAAG9c,UACb,IAAK,UACD6tF,GAAO,EACP,MACJ,IAAK,aACD17E,GAAO,EACP,MACJ,IAAK,QACD7X,GAAQ,EACR,MACJ,IAAK,QACDyzF,EAAcH,EAAM9wE,GACpBgxE,EAAYF,EAAM9wE,GAAGtQ,WACrB,MACJ,IAAK,WAED,IAAI0hF,EAAWN,EAAM9wE,GAAGg+B,YAAY32C,MAAM,GACtCupF,EAAUQ,KACVJ,EAAYJ,EAAUQ,GAAU1hF,YAEpC,MACJ,IAAK,eACDwhF,EAAkBJ,EAAM9wE,GAAGtQ,WAC3B,MACJ,IAAK,OACDyhF,EAAa,KASzB,GAAID,EAAiB,CACjBz4F,EAAOqD,IAAI,iBAAkBo1F,GAC7B,IAAIG,EAAY/xE,EAAQgyE,aACpBD,GAAkC,mBAAdA,GACpBA,EAAUpI,EAAS5mF,GAAQ6uF,EAEnC,CAGA,GAAIC,EAAY,CACZ14F,EAAOqD,IAAI,SAAUq1F,GACrB,IAAII,EAAUjyE,EAAQkyE,SAClBD,GAA8B,mBAAZA,GAClBA,EAAQtI,EAAS5mF,GAAQ8uF,EAEjC,CAMA,GAAI3zF,GAASwzF,GAAkC,IAArBA,EAAUx2F,OAAc,CAI9C,IAHA,IAAIi3F,EAAgB,KAChBC,EAAe,KAEV3yF,EAAI,EAAGA,EAAIiyF,EAAUx2F,OAAQuE,IAClC,OAAQiyF,EAAUjyF,GAAGmE,UACjB,IAAK,aACDuuF,EAAgBT,EAAUjyF,GAC1B,MACJ,IAAK,YACD2yF,EAAeV,EAAUjyF,GAQrC,IAAI4yF,EAAY1I,EAAS5mF,GAAOyhC,gBAAgBriC,KAC5CmwF,EAAmB3I,EAAS5mF,GAAOyhC,gBAAgB/jC,YACnDI,EAAQwxF,GAAaC,EAIzB,GAHAn5F,EAAOE,MAAMwH,IAGRuxF,GAAgBD,EAAe,CAChC,IAAII,EAAWvyE,EAAQwyE,WACnBD,GAAgC,mBAAbA,GACnBA,EAAS5I,EAAS5mF,GAAQovF,EAGlC,MAAO,GAAIC,IAAiBD,EAAe,CACvC,IAAIM,EAAUzyE,EAAQ0yE,UAClBD,GAA8B,mBAAZA,GAClBA,EAAQ9I,EAAS5mF,GAAQqvF,EAGjC,MAAO,GAAIA,GAAgBD,EAAe,CACtC,IAAIQ,EAAe3yE,EAAQ4yE,eACvBD,GAAwC,mBAAjBA,GACvBA,EAAahJ,EAAS5mF,GAAQqvF,EAAcD,EAEpD,CAGJ,KAAO,CACH,IAAIv/D,EAAU+2D,EAAS5mF,GACnBhK,EAAQ65B,EAAQvD,WACpB,GAAIt2B,GAA0B,mBAAVA,EAAsB,CACtC,IAAI85F,EAAU95F,EAAME,KAAKa,KAAM84B,EAAS,GACpCigE,GAA8B,IAAnBA,EAAQ33F,SACnBnC,EAAQ85F,EAAQ,GAExB,CAEA,GAAIpB,EAAM,CACN,IAAIqB,EAAU9yE,EAAQ+yE,aAClBD,GAA8B,mBAAZA,GAClBA,EAAQnJ,EAAS5mF,GAAQ2uF,EAEjC,CAEA,GAAI37E,EAAM,CACN,IAAIi9E,EAAUhzE,EAAQizE,gBAClBD,GAA8B,mBAAZA,GAClBA,EAAQrJ,EAAS5mF,GAAQ2uF,EAEjC,CAKA,GAAIxzF,GAASnF,EAAO,CAChB,IAAI8V,EAAQ9V,EAAMg4B,WAClB,GAAIliB,GAASA,aAAiB4Q,EAAAA,OAAQ,CAClC,IAAIyzE,EAAYlzE,EAAQmzE,YACpBD,GAAkC,mBAAdA,GACpBA,EAAUvJ,EAAS5mF,GAAQ4uF,EAEnC,MAAO,GAAI9iF,GAASA,aAAiB7V,EAAAA,KAAM,CACvC,IAAIo6F,EAAWpzE,EAAQqzE,WACnBD,GAAgC,mBAAbA,GACnBA,EAASzJ,EAAS5mF,GAAQ4uF,EAElC,CAGJ,CACJ,CACA,MACJ,QACIx4F,EAAOE,MAAM,2BAEzB,CACJ,GAEA,CAAAuH,IAAA,gBAAAC,MAUA,SAAe8oF,EAAUjwF,GACrBP,EAAOqD,IAAI,0CACX,IAAI20F,EAAOmC,EAAAtC,EAAA,2BAAAsC,CAAA,CAA2B3J,EAAUjwF,IAChD,GAAgB,OAAZy3F,EACA,OAAO,KAIPr3F,KAAK0K,eAAe,eACpB1K,KAAKy5F,qBAAqBpC,EAASr3F,KAAKo3F,YAI5C,IAAIsC,EAAoB15F,KAAK25F,2BAA2BtC,EAASxH,EAAUjwF,GAGvEg6F,EAAqBC,EAAAA,EAAOl6F,OAAO+5F,GACvC,MAA2B,KAAvBE,EACO,KAGJA,CACX,GAAC,CAAA9yF,IAAA,6BAAAC,MAaD,SAA4BswF,EAASxH,EAAUjwF,GAE3C,SAASk6F,EAAyBj6F,EAAMoY,GACpC,IAAI8hF,EAAWl6F,EAAK2tC,SAAS,IAEF,MAAvBusD,EAASxrD,OAAO,KAChBwrD,EAAWA,EAAS9rF,MAAM,IAG9BgK,EAAUA,GAAW,EAGrB,IAAID,EADJC,GADAA,EAAU0P,SAAmB,IAAV1P,EAAe,KAChBu1B,SAAS,IAK3B,OAHAx1B,GAAgB+hF,EAAS/7C,OAAO,EAAG,GACnChmC,GAAgB+hF,EAAS/7C,OAAO,EAAG,IACnChmC,GAAgB+hF,EAAS/7C,OAAO,EAAG,IACtBj2C,aACjB,CAaA,IAAIiyF,EAA6B,SAAUlhE,EAASviB,GAGhD,GAFAlX,EAAOE,MAAM,qBAAsBgX,GAE9BuiB,GAKDA,EAAQvD,qBAAsBtlB,EAAAA,MAAO,CACrC,IAAIgqF,EAAYnhE,EAAQvD,WAAWkB,UACnC,IAAKwjE,EACD,OAGJ,IAAIC,EAAc,OACdC,EAAY,OACZC,EAAQH,EAAUvjE,UACtB,GAAI0jE,EAAO,CACP,IAAIC,EAASD,EAAMxhF,MAAM,IAAK,GAC9BuhF,EAAYE,EAAO,GACnBH,EAAcG,EAAO,EACzB,CAEA,IAAIC,EAAkBxhE,EAAQvD,WAAWkB,UAAUR,YACnD,IAAKqkE,EACD,OAEJ,GAAIA,aAA2B1d,EAAAA,OAAQ,CACnC,IAAI2d,EAAaT,EAAwB,WACrC9hF,EAAQsiF,EAAgB5kE,WAE5B,GAAIlsB,MAAM4E,QAAQ4J,GAAQ,CACtB,IAAI2d,EAAK,QACTA,GAAM3d,EAAM,GAAK,IACjB2d,GAAM3d,EAAM,GAAK,IACjB2d,GAAM3d,EAAM,GAAK,IAEjBA,EADA2d,GAAM3d,EAAM,GAAK,GAErB,CACA,GAAI0B,EAAAA,EAAMkc,MAAM5d,GAAQ,CACpB,IAAIwiF,EAAW9gF,EAAAA,EAAMoc,UAAU9d,GAC/BuiF,EAAaT,EAAwBU,EAASzkE,IAAKykE,EAASviF,QAChE,MACIsiF,EAAaT,EAAwB9hF,GAEzC,IAAIyiF,EAAcH,EAAgBjkE,YAAc,IAGhD,GAAI9f,GAA+E,IAAvEA,EAAKxC,qBAAqB,kCAAkC3S,OAAc,CAClF,IAAIs5F,EAAgBlyF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,kCACnEmsB,EAAcz/E,aAAa,WAAYk/E,GACvCO,EAAcz/E,aAAa,aAAci/E,GACzCQ,EAAcz/E,aAAa,YAAas/E,GACxCG,EAAcz/E,aAAa,aAAcw/E,GACzCC,EAAcz/E,aAAa,cARZ,KASf1E,EAAKpO,YAAYuyF,EACrB,CACJ,CAEA,IAAIC,EAAc7hE,EAAQvD,WAAW0B,WACrC,IAAK0jE,EACD,OAEJ,GAAIA,aAAuBh1E,EAAAA,OAAQ,CAC/B,IAAI+8D,EAAc,KACdkY,EAAc,KAClB,GAAID,EAAY1kE,YAAa,CAIzB,GAHA2kE,EAAcD,EAAY1kE,YAAYI,WACtCqsD,EAAciY,EAAY1kE,YAAYP,WAElClsB,MAAM4E,QAAQs0E,GAAc,CAC5B,IAAImY,EAAM,QACVA,GAAOnY,EAAY,GAAK,IACxBmY,GAAOnY,EAAY,GAAK,IACxBmY,GAAOnY,EAAY,GAAK,IAExBA,EADAmY,GAAOnY,EAAY,GAAK,GAE5B,CACA,GAAIhpE,EAAAA,EAAMkc,MAAM8sD,GAAc,CAC1B,IAAIoY,EAAiBphF,EAAAA,EAAMoc,UAAU4sD,GACrCA,EAAcoX,EAAwBgB,EAAe/kE,IAAK+kE,EAAe7iF,QAC7E,MACIyqE,EAAcoX,EAAwBpX,EAE9C,CAEA,IAAIC,EAAY,KAChB,GAAIgY,EAAYnlE,UAAW,CAGvB,GAFAmtD,EAAYgY,EAAYnlE,UAAUE,WAE9BlsB,MAAM4E,QAAQu0E,GAAY,CAC1B,IAAIoY,EAAM,QACVA,GAAOpY,EAAU,GAAK,IACtBoY,GAAOpY,EAAU,GAAK,IACtBoY,GAAOpY,EAAU,GAAK,IAEtBA,EADAoY,GAAOpY,EAAU,GAAK,GAE1B,CACA,GAAIjpE,EAAAA,EAAMkc,MAAM+sD,GAAY,CACxB,IAAIqY,EAAethF,EAAAA,EAAMoc,UAAU6sD,GACnCA,EAAYmX,EAAwBkB,EAAajlE,IAAKilE,EAAa/iF,QACvE,MACI0qE,EAAYmX,EAAwBnX,EAE5C,CAEA,GAAIpsE,GAA2E,IAAnEA,EAAKxC,qBAAqB,8BAA8B3S,OAAc,CAC9E,IAAI65F,EAAezyF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,8BAClE0sB,EAAahgF,aAAa,OAAQ,UAClCggF,EAAahgF,aAAa,SAAU0/E,EAAYtiE,aAChD4iE,EAAahgF,aAAa,YAAa0nE,GACvCsY,EAAahgF,aAAa,cAAeynE,GACzCuY,EAAahgF,aAAa,cAAe2/E,GACzCrkF,EAAKpO,YAAY8yF,EACrB,CACJ,CACJ,CACJ,EAkBIC,EAA4B,SAAUpiE,EAASviB,GAG/C,GAFAlX,EAAOE,MAAM,+BAAgCgX,GAExCuiB,GAKDA,EAAQvD,qBAAsBtlB,EAAAA,MAAO,CACrC,IAAI0qF,EAAc7hE,EAAQvD,WAAW0B,WAErC,IAAK0jE,EACD,OAGJ,GAAIA,aAAuBz7F,EAAAA,KAAM,CAC7B,IAAIoG,EAAI,EACJC,EAAI,EAEJ41F,EAAS,SAETvhF,EAAO+gF,EAAYv8B,UACnB7hD,EAASo+E,EAAYS,YAYzB,GAVI7+E,EAAOnb,SACPkE,EAAIiX,EAAO,GAKPhX,GAJJA,EAAIgX,EAAO,MAI2B3C,EAAK,GAAM,EAAIA,EAAK,GAAKrU,GAI/DgR,GAAwD,IAAhDA,EAAKxC,qBAAqB,WAAW3S,OAAc,CAC3D,IAAIi6F,EAAU7yF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,WAC7D8sB,EAAQpgF,aAAa,IAAK3V,GAC1B+1F,EAAQpgF,aAAa,IAAK1V,GAC1B81F,EAAQpgF,aAAa,SApBZ,UAqBTogF,EAAQpgF,aAAa,SAAUkgF,GAC/B5kF,EAAKpO,YAAYkzF,EACrB,CACJ,CACJ,CACJ,EAiIAr7F,KAAKs7F,YAAYjE,EAASxH,EAAU,CAChC6I,WAAasB,EACbpB,UAAYsC,EACZpC,eAhDmC,SAAUhgE,EAASyiE,EAAeC,GACrEn8F,EAAOE,MAAM,8BACb27F,EAA0BpiE,EAASyiE,GACnCvB,EAA2BlhE,EAAS0iE,EACxC,EA6CInC,YA9HgC,SAAUvgE,EAASviB,GACnD,GAAKuiB,GAKDA,EAAQvD,qBAAsBtlB,EAAAA,MAAO,CACrC,IAAI0qF,EAAc7hE,EAAQvD,WAAW0B,WACrC,IAAK0jE,EACD,OAEJ,GAAIA,aAAuBh1E,EAAAA,OAAQ,CAC/B,IAAI+8D,EAAc,KACdkY,EAAc,KAClB,GAAID,EAAY1kE,YAAa,CAIzB,GAHA2kE,EAAcD,EAAY1kE,YAAYI,WACtCqsD,EAAciY,EAAY1kE,YAAYP,WAElClsB,MAAM4E,QAAQs0E,GAAc,CAC5B,IAAI/sD,EAAK,QACTA,GAAM+sD,EAAY,GAAK,IACvB/sD,GAAM+sD,EAAY,GAAK,IACvB/sD,GAAM+sD,EAAY,GAAK,IAEvBA,EADA/sD,GAAM+sD,EAAY,GAAK,GAE3B,CACA,GAAIhpE,EAAAA,EAAMkc,MAAM8sD,GAAc,CAC1B,IAAI8X,EAAW9gF,EAAAA,EAAMoc,UAAU4sD,GAC/BA,EAAcoX,EAAwBU,EAASzkE,IAAKykE,EAASviF,QACjE,MACIyqE,EAAcoX,EAAwBpX,EAE9C,CAEA,IAAIC,EAAY,KAChB,GAAIgY,EAAYnlE,UAAW,CAGvB,GAFAmtD,EAAYgY,EAAYnlE,UAAUE,WAE9BlsB,MAAM4E,QAAQu0E,GAAY,CAC1B,IAAI7qD,EAAM,QACVA,GAAO6qD,EAAU,GAAK,IACtB7qD,GAAO6qD,EAAU,GAAK,IACtB7qD,GAAO6qD,EAAU,GAAK,IAEtBA,EADA7qD,GAAO6qD,EAAU,GAAK,GAE1B,CACA,GAAIjpE,EAAAA,EAAMkc,MAAM+sD,GAAY,CACxB,IAAI8Y,EAAkB/hF,EAAAA,EAAMoc,UAAU6sD,GACtCA,EAAYmX,EAAwB2B,EAAgB1lE,IAAK0lE,EAAgBxjF,QAC7E,MACI0qE,EAAYmX,EAAwBnX,EAE5C,CAEA,GAAIpsE,GAA2E,IAAnEA,EAAKxC,qBAAqB,8BAA8B3S,OAAc,CAC9E,IAAIs3F,EAAalwF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,cAC5DmtB,EAAiBlzF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,8BACpEmtB,EAAezgF,aAAa,OAAQ,UACpCygF,EAAezgF,aAAa,SAAU0/E,EAAYtiE,aAClDqjE,EAAezgF,aAAa,YAAa0nE,GACzC+Y,EAAezgF,aAAa,cAAeynE,GAC3CgZ,EAAezgF,aAAa,cAAe2/E,GAC3ClC,EAAWvwF,YAAYuzF,GACvBnlF,EAAKpO,YAAYuwF,EACrB,CACJ,CACJ,CACJ,EA4DIa,WArD+B,SAAUzgE,EAASviB,GAAO,EAsDzD6hF,SA5CgB,SAAUt/D,EAAS6iE,GACnC,IAAK,IAAIvmF,EAAI,EAAGA,EAAIumF,EAAKv6F,OAAQgU,IAE7B,GAAqB,SADXumF,EAAKvmF,GACPtL,SACJ,OAIR,IAAIyuF,EAAYz/D,EAAQ4R,gBAAgBriC,KACxC,GAAIkwF,EAAW,CACX,IAAIlwF,EAAOG,SAASC,cAAc,QAClCJ,EAAK8J,UAAYomF,EACjBoD,EAAKxzF,YAAYE,EACrB,CACJ,EA+BI6vF,aA5BwB,SAAUp/D,EAASviB,GAC3C,GAAIA,GAAQA,EAAKnV,OAAQ,CAErB,IADA,IAAIw6F,EAAc,GACTj2F,EAAI,EAAGA,EAAI4Q,EAAKnV,OAAQuE,IAAK,CAClC,IAAMa,EAAU+P,EAAK5Q,GACrB,GAAyB,SAArBa,EAAQsD,SAAqB,CAC7B,IAAIhD,EAAMN,EAAQ0lC,aAAa,QAC3BvV,EAAAA,EAAQiC,cAAc9wB,SAAShB,IAC/B80F,EAAYh2F,KAAKY,EAEzB,CACJ,CACIo1F,GAAeA,EAAYx6F,QAC3Bw6F,EAAYhyF,SAAQ,SAAA3H,GAChBA,EAAEwa,QACN,GAER,CACJ,IAcA,IAAIi9E,EAAoBG,EAAAA,EAAOrsD,SAAS6pD,GACxC,OAAKqC,GACM,IAIf,GAAC,CAAA5yF,IAAA,uBAAAC,MAQD,SAAsBswF,EAASD,GAC3B,IAAIyE,EAAoBrzF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,gBAEvE,IAAK,IAAMznE,KAAOswF,EACd,GAAIl2F,OAAOwJ,eAAevL,KAAKi4F,EAAYtwF,GAAM,CAC7C,IAAMC,EAAQqwF,EAAWtwF,GACrBg1F,EAActzF,SAASorE,gBAAgByjB,EAAQ9oB,aAAc,QACjEutB,EAAY7gF,aAAa,OAAQnU,GACjC,IAAIjH,EAAO2I,SAAS66D,eAAe7/D,KAAKqC,UAAUkB,IAClD+0F,EAAY3zF,YAAYtI,GACxBg8F,EAAkB1zF,YAAY2zF,EAClC,CAGJ,IAAI5sE,EAAamoE,EAAQnoE,WACzBmoE,EAAQ3tC,aAAamyC,EAAmB3sE,EAC5C,GAEA,CAAApoB,IAAA,eAAAC,MASA,SAAc6V,EAAQhd,GAClBP,EAAOqD,IAAI,yCAGW,iBAAXka,EACP5c,KAAK4c,OAASi9E,EAAAA,EAAOp2F,MAAMmZ,GACT,OAAXA,IACP5c,KAAK4c,OAASA,GAGlB,IAAIizE,EAAW7vF,KAAK+7F,0BAA0Bn/E,EAAQhd,GAQtD,OAPAP,EAAOE,MAAM,iBAAkBswF,GAG/BA,EAASjmF,SAAQ,SAAAkvB,GACbnC,EAAAA,EAAQwE,0BAA0BrC,EACtC,IAEO+2D,CACX,GAAC,CAAA/oF,IAAA,4BAAAC,MAYD,SAA2B6V,EAAQhd,GAC/B,IAEIo8F,EAFAnM,EAAQ2J,EAAAtC,EAAA,sBAAAsC,CAAA,CAAsB58E,EAAQhd,IAGtCq8F,EAAY,GAehB,GALAA,GADAA,GANIA,EADkB,iBAAXr/E,EACKA,EAEAA,EAAO9I,gBAAgBooF,WAIjB7tF,QAAQ,MAAO,KACfA,QAAQ,aAAc,QAK7B,QAFf2tF,EAASnC,EAAAA,EAAOp2F,MAAMw4F,IAIlB,OAAOpM,EAIX,SAASsM,EAAyBt8F,GAC9B,IAAImY,EAAQ,GACZA,GAAgBnY,EAAKm+C,OAAO,EAAG,GAC/BhmC,GAAgBnY,EAAKm+C,OAAO,EAAG,GAC/BhmC,GAAgBnY,EAAKm+C,OAAO,EAAG,GAI/B,IAHA,IAAIjoB,EAAMpO,SAAS3P,EAAO,IAAIw1B,SAAS,IACnC4uD,EAAO,GACP93B,EAAMvuC,EAAI30B,QAAU,EACfgU,EAAI,EAAGA,EAAK,EAAIkvD,EAAMlvD,IAC3BgnF,GAAQ,IAGZ,OADArmE,EAAM,IAAMqmE,EAAOrmE,CAEvB,CA8BA,IAAIsmE,EAAmC,SAAUvjE,EAASviB,GAGtD,GAFAlX,EAAOE,MAAM,qBAAsBgX,GAE9BuiB,EAAL,CAwBA,IAnBA,IAAIwjE,EAAQxjE,EAAQ4R,gBAAgBriC,KAChCk0F,EAASJ,EAAwB,YACjCK,EAAa,UACbC,EAAc,EAEdrC,EAAQ,OACRD,EAAY,OAGZuC,EAAc,KACdC,EAAgB,EAChBC,EAAmB,UACnBC,EAAqB,UACrBC,EAAqB,EAGrBC,GAAkC,EAClCC,GAA8B,EAC9BC,EAAa1mF,EAAKD,WACb3Q,EAAI,EAAGA,EAAIs3F,EAAW77F,OAAQuE,IACnC,OAAQs3F,EAAWt3F,GAAGmE,UAClB,IAAK,QAGL,IAAK,YAED,MACJ,IAAK,QACDyyF,EAASJ,EAAwBc,EAAWt3F,GAAGi/C,aAC/C,MACJ,IAAK,iCACDm4C,GAAkC,EAElC,IADA,IAAIG,EAAYD,EAAWt3F,GAAGshC,WACrBvjB,EAAI,EAAGA,EAAIw5E,EAAU97F,OAAQsiB,IAClC,OAAQw5E,EAAUx5E,GAAG5Z,UACjB,IAAK,aACDswF,EAAQ8C,EAAUx5E,GAAG6nB,UACrB,MACJ,IAAK,WACD4uD,EAAY+C,EAAUx5E,GAAG6nB,UACzB,MACJ,IAAK,YACDixD,EAAaL,EAAwBe,EAAUx5E,GAAG6nB,WAClD,MACJ,IAAK,aACDkxD,EAAc90E,SAASu1E,EAAUx5E,GAAG6nB,UAAW,IAY3D,MACJ,IAAK,6BACDyxD,GAA8B,EAE9B,IADA,IAAIG,EAAeF,EAAWt3F,GAAGshC,WACxBmrD,EAAK,EAAGA,EAAK+K,EAAa/7F,OAAQgxF,IAEvC,OAAQ+K,EAAa/K,GAAItoF,UACrB,IAAK,OACD4yF,EAAcS,EAAa/K,GAAI7mD,UAC/B,MACJ,IAAK,SACDoxD,EAAgBh1E,SAASw1E,EAAa/K,GAAI7mD,UAAW,IACrD,MACJ,IAAK,YACD,IAAI6xD,EAAiBD,EAAa/K,GAAI7mD,UAClC8xD,EAAc9lE,KAAKC,MAAO9d,EAAAA,EAAM+zB,IAAI2vD,EAAep/C,OAAO,EAAG,IAAM,IAAO,IAAM,GAChFs/C,EAAgBnB,EAAwBiB,GAC5CR,EAAmBljF,EAAAA,EAAMC,UAAU2jF,EAAeD,GAClD,MACJ,IAAK,cACD,IAAIE,EAAmBJ,EAAa/K,GAAI7mD,UACpCiyD,EAAgBjmE,KAAKC,MAAO9d,EAAAA,EAAM+zB,IAAI8vD,EAAiBv/C,OAAO,EAAG,IAAM,IAAO,IAAM,GACpFy/C,EAAkBtB,EAAwBoB,GAC9CV,EAAqBnjF,EAAAA,EAAMC,UAAU8jF,EAAiBD,GACtD,MACJ,IAAK,cACDV,EAAqBn1E,SAASw1E,EAAa/K,GAAI7mD,UAAW,KAWlF,IAAImyD,EAAgB,KAChBV,GAA+C,WAAhBN,EAC/BgB,EAAgB,IAAI/3E,EAAAA,OAAO,CACvByS,OAASukE,EACTzgF,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ4kF,IAEZ7kF,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ6kF,EACR/kF,MAAQglF,MAGTC,IAIPW,EAAgB,IAAIx+F,EAAAA,KAAK,CACrB+W,IAAM,qHACN2D,KAAO,CAAC,GAAI,IACZ2C,OAAS,CAAC,KAAM,IAChBohF,aAAe,WACfC,aAAe,SACfC,aAAe,YAMvB/kE,EAAQwC,SAAS,IAAIrrB,EAAAA,MAAM,CACvB8E,MAAQ2oF,EACR77F,KAAO,IAAIkvE,EAAAA,KAAK,CACZl6C,KAAOsjE,EAAY,IAAMC,EACzBrjE,UAAY,OACZl1B,KAAOy6F,EAEPpgF,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQukF,IAEZxkF,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQwkF,EACR1kF,MAAQ2kF,QAzIpB,CA6IJ,EA0BIqB,EAAkC,SAAUhlE,EAASviB,GACrDlX,EAAOE,MAAM,YAAagX,GAmB1B,IAhBA,IAAIwnF,EAAO,KACPC,EAAS,KACTzB,EAASJ,EAAwB,YAEjC8B,GAAa,EACbC,EAAS,GACTC,EAAS,GAETC,GAAY,EACZC,EAAW,KACXC,EAAgB,SAChBC,EAAW,GACXC,EAAgB,SAEhBvB,EAAa1mF,EAAKD,WAClBmoF,GAAa,EACR94F,EAAI,EAAGA,EAAIs3F,EAAW77F,OAAQuE,IACnC,OAAQs3F,EAAWt3F,GAAGmE,UAClB,IAAK,OACD20F,GAAa,EAEb,IADA,IAAIroF,EAAQ6mF,EAAWt3F,GAAG2Q,WACjBlB,EAAI,EAAGA,EAAIgB,EAAMhV,OAAQgU,IAC9B,OAAQgB,EAAMhB,GAAGtL,UACb,IAAK,OACDi0F,EAAO3nF,EAAMhB,GAAGwvC,YAChB,MACJ,IAAK,OACDq5C,GAAa,EACbC,EAAS5yD,WAAWl1B,EAAMhB,GAAGwvC,aAC7B,MACJ,IAAK,OACDq5C,GAAa,EACbE,EAAS7yD,WAAWl1B,EAAMhB,GAAGwvC,aAKzC,MACJ,IAAK,UACDw5C,GAAY,EAEZ,IADA,IAAIlB,EAAYD,EAAWt3F,GAAGshC,WACrBvjB,EAAI,EAAGA,EAAIw5E,EAAU97F,OAAQsiB,IAClC,OAAQw5E,EAAUx5E,GAAG5Z,UACjB,IAAK,IACDu0F,EAAW/yD,WAAW4xD,EAAUx5E,GAAG6nB,WACnC,MACJ,IAAK,IACDgzD,EAAWjzD,WAAW4xD,EAAUx5E,GAAG6nB,WACnC,MACJ,IAAK,SACD+yD,EAAgBpB,EAAUx5E,GAAG6nB,UAC7B,MACJ,IAAK,SACDizD,EAAgBtB,EAAUx5E,GAAG6nB,UAKzC,MACJ,IAAK,QACDyyD,EAAS1yD,WAAW2xD,EAAWt3F,GAAGi/C,aAClC,MACJ,IAAK,QACD23C,EAASJ,EAAwBc,EAAWt3F,GAAGi/C,aAO3D,IAAI84C,EAAgB,KACpB,GAAIe,EAAY,CAEZ,IAAIC,EAAc,CACdzoF,IAAM8nF,GAAQ,qHACd/lF,MAAQukF,EACRlgC,YAAc,YACd/sD,MAAQ0uF,GAAU,GAGlBC,GACAxtF,EAAAA,EAAMC,YAAYguF,EAAa,CAC3B9kF,KAAO,CAACskF,EAAQC,KAIpBC,GACA3tF,EAAAA,EAAMC,YAAYguF,EAAa,CAC3BniF,OAAS,CAAC8hF,EAAUE,GACpBZ,aAAe,cACfC,aAAeU,GAAiB,SAChCT,aAAeW,GAAiB,WAIxCd,EAAgB,IAAIx+F,EAAAA,KAAKw/F,EAC7B,CAGA,IAAIC,EAAuB7lE,EAAQsC,mBACnC,GAAIujE,EAAsB,CACtB,IAAIzN,EAAUyN,EAAqB7lE,EAAS,GAI5C,GAHIo4D,IAAY1nF,MAAM4E,QAAQ8iF,KAC1BA,EAAU,CAACA,IAEXA,GAA8B,IAAnBA,EAAQ9vF,OAAc,CACjC,IAAIuQ,EAA6B,IAAnBu/E,EAAQ9vF,OAAgB8vF,EAAQ,GAAKA,EAAQA,EAAQ9vF,OAAS,GAE5E03B,EAAQwC,SAAS,IAAIrrB,EAAAA,MAAM,CACvB8E,MAAQ2oF,EACR77F,KAAO8P,EAAO8kB,YAEtB,CACJ,CACJ,EA8FImoE,EAA6B,SAAU9lE,EAASviB,GAAO,EAa3D,OAVAvW,KAAKs7F,YAAYU,EAAQnM,EAAU,CAC/BsJ,gBAAkByF,EAClB3F,aAAe2F,EACfrF,WAAaqF,EACblG,WAAa14F,KAAK6+F,gBAAkBxC,EAAmC,KACvEzD,UAAYkF,EACZhF,eAAiB94F,KAAK6+F,gBAhBiB,SAAU/lE,EAASyiE,EAAeC,GACzEn8F,EAAOE,MAAM,0BACb88F,EAAiCvjE,EAAS0iE,GAC1CsC,EAAgChlE,EAASyiE,EAC7C,EAYmFuC,EAC/E5F,aA7EoB,SAAUp/D,EAAS80B,GAGvC,GAFAvuD,EAAOE,MAAM,eAAgBquD,GAExB90B,EAAL,CASA,IALA,IAAIgmE,EAAQ,CAAC,EAETC,EAASjmE,EAAQtC,IAAI,SAAW,GAChCwoE,EAAgBlmE,EAAQtC,IAAI,gBAAkB,GAC9CyoE,EAAU,KACL7pF,EAAI,EAAGA,EAAIw4C,EAAOxsD,OAAQgU,IAAK,CACpC,IAAIvV,EAAO+tD,EAAOx4C,GACd/M,EAAOxI,EAAKonC,WAAW,GACvB7wB,EAAQvW,EAAKyW,WACjB,GAAsB,SAAlBjO,EAAKyB,SACL,OAAQzB,EAAKkjC,WAET,IAAK,QACDwzD,EAASl/F,EAAK+kD,YACdk6C,EAAMz2F,KAAO02F,EACb,MAEJ,IAAK,QACL,IAAK,iBACD,IAAK,IAAIn4E,EAAI,EAAGA,EAAIxQ,EAAMhV,OAAQwlB,IACJ,UAAtBxQ,EAAMwQ,GAAG9c,WACTm1F,EAAU7oF,EAAMwQ,GAAGg+B,aAG3B,MACJ,QACIk6C,EAAMz2F,EAAKkjC,WAAa1rC,EAAK+kD,YAI7C,CAGIq6C,IACAD,EAAiBA,EAAiBC,EAAU,MAAQD,EAAgBC,EACpEH,EAAMn4F,YAAcq4F,GAGpB99F,OAAOC,KAAK29F,GAAO19F,QACnB03B,EAAQinD,cAAc+e,GAAO,EAzCjC,CA2CJ,IAgCOjP,CACX,GAAC,CAAA/oF,IAAA,qBAAAC,MAOD,SAAoBD,GAQhB,IAPA,IAAIC,EAAQ,CAAC,EAMTm4F,GAD8C,cAAzBl/F,KAAK4c,OAAO9S,SAA4B9J,KAAK4c,OAAOtG,WAAW,GAAKtW,KAAK4c,QAC1DtG,WAC/BlB,EAAI,EAAGA,EAAI8pF,EAAgB99F,OAAQgU,IAAK,CAC7C,IAAI+/D,EAAQ+pB,EAAgB9pF,GAC5B,GAAuB,iBAAnB+/D,EAAMrrE,SAEN,IADA,IAAIq1F,EAAqBhqB,EAAM7+D,WACtBsQ,EAAI,EAAGA,EAAIu4E,EAAmB/9F,OAAQwlB,IAAK,CAChD,IAAI+rD,EAAQwsB,EAAmBv4E,GAC/B,GAAuB,SAAnB+rD,EAAM7oE,SAAqB,CAC3B,IAAIzB,EAAOsqE,EAAM1rC,WAAW,GAC5B,GAAI5+B,GAA0B,SAAlBA,EAAKyB,UACTzB,EAAKkjC,YAAczkC,EAAK,CACxBC,EAAQvD,KAAKC,MAAMkvE,EAAM/tB,aACzB,KACJ,CAER,CACJ,CAER,CACA,OAAO79C,CACX,I,4FAAC,CA9uCE,CAAqBq4F,KAkvC5B,UAGI79F,OAAOvC,IAAMuC,OAAOvC,GAAGW,SACvB4B,OAAOvC,GAAGW,OAAO0/F,YAAcnI,E,6DCnxC/BoI,EAAkB,CAQlBhgG,UAAY,SAAU+I,GAElB,QAAuB,IAAZ6d,EACP,IAAIA,EAAU,CACdA,IAAc,CACVC,SAAU,IAGjBD,EAAQE,IAAID,QAAWo5E,EAAAA,YAAkBA,EAAAA,aAC1C,IAAIl5E,EAAUhe,GAAQ,UACtB,OAAOk3F,EAAAA,UAAcl5E,EACzB,EAKAye,WAAa,WACT,IAAI06D,EAAUD,EAAAA,aACd,IAAK,IAAMz4F,KAAO04F,EAAS,CACvB,GAAIt+F,OAAOwJ,eAAevL,KAAKqgG,EAAS14F,GACrB04F,EAAQ14F,GAChBg+B,YAEf,CACJ,EAKAF,UAAY,WACR,IAAI46D,EAAUD,EAAAA,aACd,IAAK,IAAMz4F,KAAO04F,EAAS,CACvB,GAAIt+F,OAAOwJ,eAAevL,KAAKqgG,EAAS14F,GACrB04F,EAAQ14F,GAChB89B,WAEf,CACJ,GAGJ,UAGIrjC,OAAO8tB,KACP9tB,OAAO8tB,GAAGrf,OAASsvF,E,iFChDvB,SAASG,EAAkB7/F,GAIvB,GAHAI,KAAKX,OAAS,IAAOC,UAAU,oBAC/BU,KAAKX,OAAOE,MAAM,wCAEZS,gBAAgBy/F,GAClB,MAAM,IAAIx7F,UAAU,gEAIxB,IAAKrE,EACD,MAAM,IAAIH,MAAM,IAAEwK,WAAW,cAAe,YAIhDjK,KAAKZ,SAAWQ,CACpB,CAEA6/F,EAAiBt6F,UAAY,CAUzBspC,cAAgB,KAKhBrpC,YAAcq6F,EAUd/wD,qBAAuB,WAInB1uC,KAAKX,OAAOmU,KAAK,gBAOjB,IAJA,IACIxF,EADU,IAAI,IAAehO,KAAKZ,UACjB4G,YAEjB8E,EAAU,GACLsK,EAAI,EAAGA,EAAIpH,EAAO5M,OAAQgU,IAAK,CACpC,IAAIwO,EAAI5V,EAAOoH,GACXtK,IACAA,GAAW,KAEfA,GAAW8Y,EAAEje,EAAI,IAAMie,EAAE1d,CAC7B,CAiBA,OAHAlG,KAAKX,OAAOE,MAAMuL,GAClB9K,KAAKyuC,cAAgB3jC,EAEd9K,KAAKyuC,aAChB,GAGJ,S,8BC7FA,SAASxN,IACL,KAAMjhC,gBAAgBihC,GAClB,MAAM,IAAIh9B,UAAU,oEAGxBjE,KAAK6tB,mBAAqB,EAC9B,C,iBAEAoT,EAAqB97B,UAAY,CAE7BC,YAAc67B,GAIlB,S,uECNA,SAASy+D,EAAsB9/F,GAC3B,KAAMI,gBAAgB0/F,GAClB,MAAM,IAAIz7F,UAAU,oEAMxBjE,KAAKkF,UAAY,uBAGjB,EAAAwgB,EAAYlH,MAAMxe,KAAM+N,WAExB/N,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,0CAMlBS,KAAKmlB,MAAQnlB,KAAKJ,QAAQulB,QAAS,CACvC,CAMAu6E,EAAqBv6F,UAAYjE,OAAOmjB,OAAO,EAAAqB,EAAYvgB,UAAW,CAKlEggB,MAAQ,CAEJqR,IAAM,WACF,OAAOx2B,KAAK2/F,MAChB,EAEAx4F,IAAM,SAAU26B,GACZ9hC,KAAK2/F,OAAS79D,CAClB,KAQR49D,EAAqBv6F,UAAUC,YAAcs6F,EAO7CA,EAAqBv6F,UAAUijC,QAAU,WAErC,IAAIniC,EAAM,GA+BV,OA9BAA,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKqoC,WAEbpiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsoC,WAGbriC,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKuoC,SAEbtiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsE,MAEb2B,EAAIL,KAAK,CACLD,EAAI,QACJO,EAAIlG,KAAKmlB,QAEblf,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKL,SAEbsG,EAAIL,KAAK,CACLD,EAAI,WACJO,EAAIlG,KAAKmE,WAGN8B,CACX,EAEA,S,8BC3DA,SAAS25F,IACL,KAAM5/F,gBAAgB4/F,GAClB,MAAM,IAAI37F,UAAU,gEAGxBjE,KAAKqE,SAAW,KAEhBrE,KAAK6/F,UAAY,KAEjB7/F,KAAKknC,gBAAkB,CAAC,EAExBlnC,KAAKkM,KAAO,KAEZlM,KAAK8/F,SAAW,KAMhB9/F,KAAKkF,UAAY,kBACrB,C,iBAEA06F,EAAiBz6F,UAAY,CAEzBC,YAAcw6F,GAIlB,S,wHCDA,SAASG,EAAgBh8E,GACrB,KAAM/jB,gBAAgB+/F,GAClB,MAAM,IAAI97F,UAAU,IAAEgG,WAAW,oBAAqB,mBAO1DjK,KAAKkF,UAAY,iBAEjBlF,KAAKX,OAAS,IAAOC,UAAU,8BAC/BU,KAAKX,OAAOE,MAAM,2CAElB,IAAIK,EAAUI,KAAKgkB,qBAAqBD,GAQxC,GAPKnkB,EAAQkM,YACTlM,EAAQkM,UAAY,IAAkBi0F,eAAe97E,UAIzD,IAAczF,MAAMxe,KAAM,CAACJ,IAEtBA,EAAQstC,eAKTltC,KAAKJ,QAAQstC,eAAiBttC,EAAQstC,oBAJtC,IAAKttC,EAAQyE,SACT,MAAM,IAAI5E,MAAM,IAAEwK,WAAW,gBAAiB,mBAWtD,GAJKrK,EAAQqJ,QACTjJ,KAAKJ,QAAQqJ,MAAQrJ,EAAQqJ,MAAQ,iBAGrCrJ,EAAQukB,QAER,IADA,IAAI1U,EAASvO,OAAOC,KAAKvB,EAAQukB,SACxB/O,EAAI,EAAGA,EAAI3F,EAAOrO,OAAQgU,IAAK,CACpC,IAAItO,EAAM2I,EAAO2F,SAEmB,IAAzBxV,EAAQukB,QAAQrd,IACU,iBAAzBlH,EAAQukB,QAAQrd,IAAkE,IAA7C5F,OAAOC,KAAKvB,EAAQukB,QAAQrd,IAAM1F,QAC9C,iBAAzBxB,EAAQukB,QAAQrd,IAAqD,IAAhClH,EAAQukB,QAAQrd,GAAK1F,QACjEoI,MAAM4E,QAAQxO,EAAQukB,QAAQrd,KAAyC,IAAhClH,EAAQukB,QAAQrd,GAAK1F,gBAEtDpB,KAAKJ,QAAQukB,QAAQrd,EAEpC,CAGJ9G,KAAKJ,QAAQyE,SAAWzE,EAAQyE,SAChCrE,KAAKJ,QAAQqJ,MAAQrJ,EAAQqJ,OAAS,gBACtCjJ,KAAKJ,QAAQwkB,iBAAmBxkB,EAAQwkB,kBAAoB,EAChE,CAKA27E,EAAe56F,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAGlE,GAKA46F,EAAe56F,UAAUC,YAAc26F,EAQvCA,EAAe56F,UAAU6e,qBAAuB,SAAUD,GACtD,IAAInkB,EAAUmkB,EA4Ed,OA1EInkB,EAAQ0kB,gBACRtkB,KAAKX,OAAOmU,KAAK,+CAEb5T,EAAQ0kB,cAAcpY,OACtBlM,KAAKX,OAAOmU,KAAK,oDACZ5T,EAAQqJ,QACLO,MAAM4E,QAAQxO,EAAQ0kB,cAAcpY,OAAStM,EAAQ0kB,cAAcpY,KAAK9K,OAAS,EACjFxB,EAAQqJ,MAAQrJ,EAAQ0kB,cAAcpY,KAAK,GAE3CtM,EAAQqJ,MAAQrJ,EAAQ0kB,cAAcpY,aAGvCtM,EAAQ0kB,cAAcpY,MAG7BtM,EAAQ0kB,cAAcC,OACtBvkB,KAAKX,OAAOmU,KAAK,oDACZ5T,EAAQstC,iBAETttC,EAAQstC,eAAiBltC,KAAKggG,UAAUpgG,EAAQ0kB,cAAcC,cAE3D3kB,EAAQ0kB,cAAcC,MAG7B3kB,EAAQ0kB,cAAclI,SACtBpc,KAAKX,OAAOmU,KAAK,sDACZ5T,EAAQstC,iBAETttC,EAAQstC,eAAiBltC,KAAKigG,YAAYrgG,EAAQ0kB,cAAclI,gBAE7Dxc,EAAQ0kB,cAAclI,QAG7Bxc,EAAQ0kB,cAAc47E,UACtBlgG,KAAKX,OAAOmU,KAAK,uDACZ5T,EAAQstC,iBAETttC,EAAQstC,eAAiBltC,KAAKmgG,aAAavgG,EAAQ0kB,cAAc47E,iBAE9DtgG,EAAQ0kB,cAAc47E,UAG5BtgG,EAAQukB,SAAWjjB,OAAOC,KAAKvB,EAAQ0kB,eAAeljB,OAAS,IAChExB,EAAQukB,QAAUvkB,EAAQ0kB,sBAGvB1kB,EAAQ0kB,eAGf1kB,EAAQyE,WACJzE,EAAQyE,SAASiB,IACjBtF,KAAKX,OAAOmU,KAAK,4CAEZ5T,EAAQyE,SAASmgB,MAClB5kB,EAAQyE,SAASmgB,IAAM5kB,EAAQyE,SAASiB,UAErC1F,EAAQyE,SAASiB,GAGxB1F,EAAQyE,SAASkB,IACjBvF,KAAKX,OAAOmU,KAAK,4CAEZ5T,EAAQyE,SAASogB,MAClB7kB,EAAQyE,SAASogB,IAAM7kB,EAAQyE,SAASkB,UAErC3F,EAAQyE,SAASkB,IAI5B3F,EAAQ2E,MACRvE,KAAKX,OAAOmU,KAAK,4CACV5T,EAAQ2E,KAGZ3E,CACX,EASAmgG,EAAe56F,UAAUoG,aAAe,SAAU7K,EAAO8K,GACrD,IAAI5L,EAAU,CACV2K,WAAavK,KAAKJ,QAAQ2K,WAE1Boa,cAAgB,UAChBuoB,eAAiBltC,KAAKJ,QAAQstC,eAC9BjkC,MAAQjJ,KAAKJ,QAAQqJ,MACrB5E,SAAWrE,KAAKJ,QAAQyE,SACxBugB,mBAAqB5kB,KAAKJ,QAAQglB,mBAClCC,QAAU7kB,KAAKJ,QAAQwkB,iBACvBD,QAAUnkB,KAAKJ,QAAQukB,SAG3BnkB,KAAK8K,QAAU,IAAsBga,MAAMllB,GAGzCI,KAAK8K,QAEDU,EAAQrM,KAAKa,KAAMA,KAAK8K,SADxBpK,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,0BAEzD,EASA81F,EAAe56F,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GACxD,GAAIxL,KAAKO,SAAU,CACf,IAAIX,EAAU,CACVW,SAAWP,KAAKO,SAChBiK,YAAcxK,KAAKJ,QAAQ4K,YAC3BW,QAAUzK,EACV+J,UAAYe,EACZzL,MAAQC,MAGZ,IAAuB8kB,MAAMllB,EACjC,MACIc,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,2BAEvD,EAQA81F,EAAe56F,UAAU66F,UAAY,SAAUz7E,GAC3C,MAAO,CACHrY,KAAO,UACPgmF,YAAc,CAAC,CACX,CAAC3tE,EAAKlb,KAAMkb,EAAKpb,KACjB,CAACob,EAAKjb,MAAOib,EAAKpb,KAClB,CAACob,EAAKjb,MAAOib,EAAKnb,QAClB,CAACmb,EAAKlb,KAAMkb,EAAKnb,QACjB,CAACmb,EAAKlb,KAAMkb,EAAKpb,OAG7B,EAQA42F,EAAe56F,UAAU86F,YAAc,SAAU7jF,GAC7C,MAAO,CACHlQ,KAAO,SACPksB,OAAShc,EAAOgc,OAChB85D,YAAc,CAAC91E,EAAO9W,EAAG8W,EAAO7W,GAExC,EAQAw6F,EAAe56F,UAAUg7F,aAAe,SAAUD,GAM9C,IALA,IAAIE,EAAW,CACXl0F,KAAO,UACPgmF,YAAc,CAAC,KAGV98E,EAAI,EAAGA,EAAI8qF,EAAQ9+F,SAAUgU,EAClCgrF,EAASlO,YAAY,GAAGtsF,KAAK,CAACs6F,EAAQ9qF,GAAG9P,EAAG46F,EAAQ9qF,GAAG7P,IAG3D,OAAO66F,CACX,EAKAL,EAAeM,QAAU,CAAC,aAE1B,S,wBCjVAvhG,EAAOC,QAAUC,GAAG4d,OAAO0jF,I,uDCEdtwF,EAAO1Q,UAAU,aAmH9B,QAtGgB,CAyBZihG,YAAc,SAAU/5F,EAASsuD,EAAQntD,GAErC,IAMIoxC,EANAynD,EAAkB,EAAGC,EAAkB,EAAGC,EAAQ,EAAGC,EAAQ,EAAGC,EAAY,EAAGC,EAAY,EAC3F/rC,EACAA,EAAOziD,iBAAiB,YAAayuF,GAAe,GAEpDt6F,EAAQ6L,iBAAiB,YAAayuF,GAAe,GAGzD,IAAIC,EAAW,CACX33F,OAAS,EACTC,KAAO,EACPC,MAAQ,EACRH,IAAM,GAGV,SAAS23F,EAAe7+F,IACpBA,EAAIA,GAAKV,OAAOsf,OACdwH,iBAEFm4E,EAAkBv+F,EAAEohD,QACpBo9C,EAAkBx+F,EAAEqhD,QAEpBvK,EAAOvyC,EAAQ+uC,wBACf,IAAMyrD,EAAer5F,EAAU4tC,wBAC/BwrD,EAAW,CACP33F,OAAS43F,EAAa53F,OACtBC,KAAO23F,EAAa33F,KACpBC,MAAQ03F,EAAa13F,MACrBH,IAAM63F,EAAa73F,KAGvBX,SAAS6J,iBAAiB,UAAW4uF,GAAkB,GACvDz4F,SAAS6J,iBAAiB,YAAa6uF,GAAa,EACxD,CAEA,SAASD,IAELL,GAAaF,EACbG,GAAaF,EACbn4F,SAASw9B,oBAAoB,UAAWi7D,GAAkB,GAC1Dz4F,SAASw9B,oBAAoB,YAAak7D,GAAa,EAC3D,CAEA,SAASA,EAAaj/F,GAGlB,IAAIk/F,GAFJl/F,EAAIA,GAAKV,OAAOsf,OAEMwiC,QAClB+9C,EAAgBn/F,EAAEqhD,QAElB+9C,EAAWX,EACXY,EAAWX,EAEfD,EAAQF,EAAkBW,EAC1BR,EAAQF,EAAkBW,EAE1B,IAAIG,EAAUxoD,EAAK1vC,KAAOq3F,EACtBc,EAASzoD,EAAK5vC,IAAMw3F,EAExB,GAAIY,EAAUR,EAAS13F,MAChBm4F,EAAST,EAAS53F,KAClBo4F,EAAUxoD,EAAKjhC,MAAQipF,EAASz3F,OAChCk4F,EAASzoD,EAAKhwC,OAASg4F,EAAS33F,OAGnCs3F,EAAQW,EACRV,EAAQW,MACL,CAEH,IAAIG,EAAOb,EAAYF,EACnBgB,EAAOb,EAAYF,EACvBn6F,EAAQvH,MAAMy1C,UAAY,aAAe+sD,EAAO,MAAQC,EAAO,KACnE,CACJ,CACJ,E,6DChGJ,SAASC,EAAa/hG,GAClB,KAAMI,gBAAgB2hG,GAClB,MAAM,IAAI19F,UAAU,2DAGxBjE,KAAKX,OAAS,IAAOC,YACrBU,KAAKX,OAAOE,MAAM,iCAKlBS,KAAKJ,QAAUA,GAAW,CAAC,EAO3BI,KAAKglB,UAAYhlB,KAAKJ,QAAQolB,WAAa,GAM3ChlB,KAAK4hG,UAAY5hG,KAAKJ,QAAQgiG,WAAa,IAM3C5hG,KAAKuoC,OAASvoC,KAAKJ,QAAQ2oC,SAAU,EAMrCvoC,KAAKsE,IAAMtE,KAAKJ,QAAQ0E,KAAO,SAM/BtE,KAAKL,OAASK,KAAKJ,QAAQD,QAAU,OAKrCK,KAAKmE,SAAWnE,KAAKJ,QAAQuE,SAM7BnE,KAAKolB,SAAWplB,KAAKJ,QAAQwlB,WAAY,CAC7C,CAKAu8E,EAAYz8F,UAAY,cAExBy8F,EAAYx8F,UAAY,CASpBC,YAAcu8F,EASdE,aAAe,SAAUC,GAErB,IADA,IAAI98E,EAAY,GACP5P,EAAI,EAAGA,EAAI0sF,EAAY1gG,OAAQgU,IAAK,CACzC,IAAIwO,EAAIk+E,EAAY1sF,GAChBwO,EAAEY,KAAOZ,EAAEa,KACXO,EAAUpf,KAAKge,EAEvB,CAEA5jB,KAAKglB,UAAYA,CACrB,EAWA+8E,aAAe,SAAU/6F,GAErB,IAAKA,EACD,OAAOhH,KAAKglB,UAGhB,IAAI/b,EAAQjJ,KAAKglB,UAAU5jB,OAAS,EACpC,OAAI4F,EAAMiC,GAASjC,EAAMiC,GACrBjJ,KAAKX,OAAOmU,KAAK,wBACVxT,KAAKglB,WAGThlB,KAAKglB,UAAUhe,EAC1B,EASAg7F,aAAe,SAAUF,GACrB,IAAK,IAAI1sF,EAAI,EAAGA,EAAI0sF,EAAY1gG,OAAQgU,IAAK,CACzC,IAAIwO,EAAIk+E,EAAY1sF,GAChBwO,EAAEY,KAAOZ,EAAEa,KACXzkB,KAAKglB,UAAUpf,KAAKk8F,EAAY1sF,GAExC,CACJ,EASAizB,OAAS,WAEL,IADA,IAAI45D,EAAS,GACJ7sF,EAAI,EAAGA,EAAIpV,KAAKglB,UAAU5jB,OAAQgU,IACvC6sF,EAAOr8F,KAAK5F,KAAKglB,UAAU5P,GAAGoP,KAGlC,OADAxkB,KAAKX,OAAOE,MAAM0iG,GACXA,EAAOn8F,KAAK9F,KAAK4hG,UAC5B,EASAt5D,OAAS,WAEL,IADA,IAAI45D,EAAS,GACJ9sF,EAAI,EAAGA,EAAIpV,KAAKglB,UAAU5jB,OAAQgU,IACvC8sF,EAAOt8F,KAAK5F,KAAKglB,UAAU5P,GAAGqP,KAGlC,OADAzkB,KAAKX,OAAOE,MAAM2iG,GACXA,EAAOp8F,KAAK9F,KAAK4hG,UAC5B,GASJD,EAAYx8F,UAAUijC,QAAU,WAC5B,IAAIniC,EAAM,GA2BV,OAzBAA,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKqoC,WAEbpiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsoC,WAEbriC,EAAIL,KAAK,CACLD,EAAI,YACJO,EAAIlG,KAAK4hG,YAEb37F,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKuoC,SAEbtiC,EAAIL,KAAK,CACLD,EAAI,MACJO,EAAIlG,KAAKsE,MAEb2B,EAAIL,KAAK,CACLD,EAAI,SACJO,EAAIlG,KAAKL,SAGNsG,CACX,EAEA,S,gFCjFA,QA/He,CAyBX/C,KAAO,SAAUtD,GAkCb,IAAIR,EAAWQ,GAAW,CACtBF,OAAS,MAETyK,SAAW,MACXrK,QAAU,EACVH,OAAS,KACToM,MAAO,EACPnB,SAAU,EACVyzE,OAAS,OACTx4C,SAAW,KACXv7B,eAAiB,MAKrB,GAAsB,oBAAX/I,QAA+C,UAArB3B,EAAQuK,SAA7C,CAeA,GAVyB,QAArBvK,EAAQuK,UAAyC,SAAnBvK,EAAQD,OACtCP,EAAS2M,MAAO,EACY,UAArBnM,EAAQuK,UAA2C,QAAnBvK,EAAQD,SAC/CP,EAAS2M,MAAO,GAGpB3M,EAASymC,SAAW,KACpBzmC,EAASi/E,OAASj/E,EAAS2M,KAAO,OAAS,KAGvC3M,EAAS2M,KAAM,CACf,IAAIiC,EAAS,CAAC,EACdA,EAAOqwE,OAASj/E,EAASi/E,OACzBrwE,EAAO63B,SAAWzmC,EAASymC,gBACpB73B,EAAO63B,SACdzmC,EAASI,IAAM,IAAO6B,aAAazB,EAAQJ,IAAKwO,EACpD,CAIA,OAAQ5O,EAAS+K,UACb,IAAK,MAEsB,QAAnBvK,EAAQF,QAAoBE,EAAQgL,UACpCxL,EAASI,IAAM,IAAO6B,aAAajC,EAASI,IAAK,CAC7CulE,GAAI,IAAI97B,MAAOuQ,aAIvB,IAAIr6C,KAAKC,GACT,MACJ,IAAK,QAGGA,EAASS,OACTT,EAASI,IAAM,IAAO6B,aAAajC,EAASI,IAAKJ,EAASS,OAI9D,IAAMV,KAAKC,GACX,MACJ,QACI,MAAM,IAAIK,MAAM,wCA5CxB,MAFIgD,QAAQC,IAAI,yFAgDpB,E,8BCpIJ,IAAIs5B,EAAS,eAUbj9B,EAAQm3F,aAAel6D,EAAO,CAC7BmmE,IAAK,IACLC,KAAM,IACNC,GAAI,IACJC,GAAI,IACJC,KAAM,MAoBPxjG,EAAQo3F,cAAgBn6D,EAAO,CAC9BwmE,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRn4B,GAAI,IACJo4B,IAAK,IACLC,IAAK,KACLC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,MAAO,IACPC,MAAO,IACP71D,MAAO,IACP81D,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,IAAK,IACL7B,IAAK,IACL8B,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,SAAU,IACVC,KAAM,IACNC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,MAAO,IACPC,QAAS,IACTC,SAAU,IACVC,OAAQ,IACRC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,GAAI,IACJC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,KAAM,IACN7D,KAAM,IACN8D,cAAe,IACfC,OAAQ,IACRC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,IAAK,IACLC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,SAAU,IACVC,MAAO,IACPC,SAAU,IACVC,YAAa,IACbC,UAAW,IACXC,QAAS,IACTC,UAAW,IACXC,UAAW,IACXC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,KAAM,IACNC,SAAU,IACVC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,WAAY,IACZC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRC,QAAS,IACTC,SAAU,IACVC,UAAW,IACXC,SAAU,IACVC,QAAS,IACTC,gBAAiB,IACjBC,cAAe,IACfC,SAAU,IACVC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,aAAc,IACdC,YAAa,IACbC,cAAe,IACfC,kBAAmB,IACnBC,kBAAmB,IACnBC,mBAAoB,IACpBC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,IAAK,KACLC,QAAS,KACTC,KAAM,IACNC,KAAM,IACNC,KAAM,KACNC,KAAM,KACNC,IAAK,IACL5hG,OAAQ,IACR6hG,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,QAAS,IACTC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,KAAM,IACNC,KAAM,KACNC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,KAAM,KACNC,MAAO,IACPC,SAAU,IACVC,KAAM,IACN7hB,OAAQ,IACR8hB,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,qBAAsB,IACtBC,KAAM,KACNC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,KAAM,IACNC,UAAW,IACXC,UAAW,IACXC,IAAK,IACLC,IAAK,KACLC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,UAAW,IACXC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,OAAQ,IACRC,gBAAiB,IACjBC,iBAAkB,IAClBC,WAAY,IACZC,YAAa,IACbC,YAAa,IACbC,UAAW,IACXC,SAAU,IACVC,SAAU,IACVC,YAAa,IACbC,WAAY,IACZC,YAAa,IACbC,KAAM,IACNC,KAAM,IACNC,SAAU,IACVC,OAAQ,IACRC,QAAS,IACTC,yBAA0B,IAC1BC,sBAAuB,IACvBC,gBAAiB,IACjBC,MAAO,IACPC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRlX,KAAM,IACNmX,OAAQ,IACRC,WAAY,IACZC,UAAW,IACXC,KAAM,IACNC,QAAS,IACTC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,gBAAiB,IACjBC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,UAAW,IACXC,KAAM,IACN1oC,KAAM,IACN2oC,OAAQ,IACRC,gCAAiC,IACjCC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,IAAK,IACLC,IAAK,IACLC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,KAAM,KACNC,OAAQ,IACRC,QAAS,IACTC,YAAa,IACbC,YAAa,IACbC,SAAU,IACVC,WAAY,IACZC,OAAQ,IACRC,eAAgB,IAChBC,gBAAiB,IACjBC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,GAAI,IACJ9nE,GAAI,IACJ+nE,QAAS,IACTC,MAAO,IACPC,SAAU,IACVC,QAAS,IACT3oE,IAAK,IACL4oE,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,iBAAkB,IAClBC,eAAgB,IAChBC,uBAAwB,IACxBC,iBAAkB,IAClBC,iBAAkB,IAClBC,KAAM,IACNC,QAAS,IACTC,QAAS,IACTC,YAAa,IACbC,MAAO,IACPC,IAAK,IACLC,cAAe,IACfC,QAAS,IACTC,MAAO,IACPlxG,IAAK,IACLmxG,OAAQ,IACRC,cAAe,IACfC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,MAAO,IACPC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,QAAS,IACTC,UAAW,IACXC,eAAgB,IAChBC,sBAAuB,IACvBC,UAAW,IACXC,gBAAiB,IACjBC,gBAAiB,IACjBC,qBAAsB,IACtBC,cAAe,IACfC,oBAAqB,IACrBC,yBAA0B,IAC1BC,qBAAsB,IACtBC,iBAAkB,IAClBC,eAAgB,IAChBC,cAAe,IACfC,kBAAmB,IACnBC,kBAAmB,IACnBC,UAAW,IACXC,UAAW,IACXC,UAAW,IACXC,aAAc,IACdC,iBAAkB,IAClBC,UAAW,IACXC,eAAgB,IAChBC,gBAAiB,IACjBC,iBAAkB,IAClBC,oBAAqB,IACrBC,kBAAmB,IACnBC,eAAgB,IAChBC,kBAAmB,IACnBC,mBAAoB,IACpBC,gBAAiB,IACjBC,mBAAoB,IACpBC,QAAS,IACTC,aAAc,IACdC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,GAAI,IACJC,MAAO,IACPC,IAAK,KACLC,IAAK,KACLC,GAAI,IACJC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,OAAQ,IACRvoG,GAAI,IACJ25D,QAAS,IACT6uC,SAAU,IACVC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPt3D,MAAO,IACPu3D,SAAU,IACVC,iBAAkB,IAClBC,OAAQ,IACRC,qBAAsB,IACtBC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,MAAO,IACPC,WAAY,IACZC,YAAa,IACbC,MAAO,IACPC,OAAQ,IACRC,WAAY,IACZC,OAAQ,IACRC,YAAa,IACbC,MAAO,IACPC,QAAS,IACTC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,YAAa,IACbC,aAAc,IACdC,aAAc,IACdC,cAAe,IACfC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,MAAO,IACPC,kBAAmB,IACnBC,sBAAuB,IACvBC,MAAO,KACPC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,WAAY,IACZC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,GAAI,IACJC,GAAI,IACJC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,SAAU,IACVC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,SAAU,IACVC,KAAM,KACNC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,GAAI,IACJC,GAAI,IACJC,IAAK,IACLC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,GAAI,IACJC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,SAAU,IACVC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,MAAO,IACPC,aAAc,IACdC,iBAAkB,IAClBC,iBAAkB,IAClBC,eAAgB,IAChBC,YAAa,IACbC,kBAAmB,IACnBC,aAAc,IACdC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJ5nB,GAAI,IACJ6nB,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,UAAW,IACXC,WAAY,IACZC,QAAS,IACTC,OAAQ,IACRC,UAAW,KACXC,KAAM,KACNC,MAAO,IACPC,OAAQ,IACRC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,MAAO,IACPC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,KACLC,aAAc,IACdC,SAAU,IACVC,SAAU,IACVC,MAAO,IACPC,OAAQ,IACRC,cAAe,IACfC,eAAgB,IAChBC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,eAAgB,IAChBC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,aAAc,IACdC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,GAAI,IACJC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,OAAQ,IACRC,OAAQ,IACRrsG,GAAI,IACJssG,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,MAAO,IACPC,MAAO,IACPj6G,MAAO,IACPk6G,WAAY,IACZC,SAAU,IACVC,SAAU,IACVC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,QAAS,IACTC,GAAI,IACJC,OAAQ,IACRC,MAAO,IACPC,SAAU,IACVC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVC,aAAc,IACdC,SAAU,IACVC,QAAS,IACTC,eAAgB,IAChBC,eAAgB,IAChBC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,KAAM,IACNC,KAAM,KACNC,KAAM,IACNC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,GAAI,IACJC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,IAAK,KACLC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNx+B,KAAM,IACNy+B,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,WAAY,IACZC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRhxG,IAAK,IACLixG,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,KACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,SAAU,IACVC,KAAM,IACNC,GAAI,IACJC,GAAI,IACJC,iBAAkB,IAClBC,UAAW,IACXC,UAAW,IACXC,UAAW,IACXC,aAAc,IACdC,oBAAqB,IACrBC,cAAe,IACfC,YAAa,IACbC,kBAAmB,IACnBC,kBAAmB,IACnBC,eAAgB,IAChBC,kBAAmB,IACnBC,UAAW,IACXC,gBAAiB,IACjBC,cAAe,IACfC,eAAgB,IAChBC,eAAgB,IAChBC,eAAgB,IAChBC,eAAgB,IAChBC,gBAAiB,IACjBC,kBAAmB,IACnBC,oBAAqB,IACrBC,gBAAiB,IACjBC,QAAS,IACTC,aAAc,IACdC,cAAe,IACfC,eAAgB,IAChBC,aAAc,IACdC,gBAAiB,IACjBC,kBAAmB,IACnBC,iBAAkB,IAClBC,gBAAiB,IACjBC,aAAc,IACdC,gBAAiB,IACjBC,WAAY,IACZC,cAAe,IACfC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,SAAU,IACVC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,QAAS,IACTC,SAAU,IACVC,KAAM,KACNC,OAAQ,IACRC,WAAY,IACZC,QAAS,IACTC,UAAW,IACXC,WAAY,IACZC,iBAAkB,IAClBC,cAAe,IACfC,YAAa,IACbC,QAAS,IACTC,SAAU,IACVC,QAAS,IACTC,eAAgB,IAChBC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,GAAI,IACJC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,GAAI,IACJ3pC,GAAI,IACJ4pC,MAAO,IACPC,SAAU,IACVC,WAAY,IACZC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,WAAY,IACZC,KAAM,IACNC,SAAU,IACVC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,cAAe,IACfC,cAAe,IACfC,cAAe,IACfC,mBAAoB,IACpBC,mBAAoB,IACpBC,mBAAoB,IACpBC,WAAY,IACZC,eAAgB,IAChBC,eAAgB,IAChBC,eAAgB,IAChBC,cAAe,IACfC,eAAgB,IAChBC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,eAAgB,IAChBC,gBAAiB,IACjBC,IAAK,IACLC,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,SAAU,IACVC,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,KAAM,IACNC,KAAM,KACNC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,GAAI,IACJC,GAAI,IACJ39B,GAAI,IACJ49B,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,QAAS,IACTC,UAAW,KACXC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,IAAK,IACLp7H,IAAK,IACLq7H,OAAQ,IACRC,WAAY,IACZC,WAAY,IACZC,SAAU,IACV1oG,OAAQ,IACR2oG,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,cAAe,IACfC,YAAa,IACbC,UAAW,IACXC,IAAK,KACLC,IAAK,KACLC,IAAK,IACLC,MAAO,IACPC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,UAAW,IACXC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,GAAI,IACJC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,GAAI,IACJC,GAAI,IACJC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,IAAK,IACLC,KAAM,KACNC,MAAO,KACPC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,QAAS,IACTC,SAAU,IACVC,KAAM,IACNC,MAAO,KACPC,OAAQ,KACRC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,SAAU,KACVC,KAAM,IACNC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,GAAI,IACJC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,MAAO,KACPC,oBAAqB,IACrBC,mBAAoB,IACpBC,kBAAmB,IACnBC,sBAAuB,IACvBC,OAAQ,IACRC,OAAQ,IACRC,MAAO,KACPC,qBAAsB,IACtBC,eAAgB,IAChBC,QAAS,KACTC,OAAQ,IACRC,QAAS,IACTC,IAAK,KACLC,IAAK,KACLC,IAAK,KACLC,IAAK,IACLC,KAAM,IACNC,MAAO,KACPC,UAAW,KACXC,KAAM,KACNC,IAAK,KACLC,MAAO,IACPC,IAAK,KACLC,IAAK,IACLC,KAAM,IACNC,KAAM,KACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,IAAK,IACLC,KAAM,IACNC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,IAAK,KACLC,IAAK,IACLC,WAAY,IACZC,WAAY,IACZC,gBAAiB,IACjBC,gBAAiB,IACjBC,KAAM,IACNC,MAAO,KACPC,UAAW,KACXC,KAAM,KACNC,MAAO,IACPC,IAAK,KACLC,MAAO,IACPC,IAAK,KACLC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,KAAM,KACNC,KAAM,IACNC,QAAS,IACTC,iBAAkB,IAClBC,KAAM,IACNC,KAAM,KACNC,IAAK,IACLC,IAAK,IACLC,aAAc,IACdC,UAAW,IACXC,qBAAsB,IACtBC,WAAY,IACZC,SAAU,IACVC,cAAe,KACfC,UAAW,IACXC,WAAY,IACZC,gBAAiB,IACjBC,oBAAqB,KACrBC,kBAAmB,KACnBC,eAAgB,IAChBC,qBAAsB,KACtBC,gBAAiB,IACjBC,gBAAiB,KACjBC,aAAc,KACdC,MAAO,IACPC,SAAU,KACVC,OAAQ,KACRC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,gBAAiB,IACjBC,mBAAoB,KACpBC,qBAAsB,IACtBC,QAAS,IACTC,aAAc,IACdC,eAAgB,IAChBC,YAAa,KACbC,kBAAmB,KACnBC,aAAc,IACdC,wBAAyB,KACzBC,kBAAmB,KACnBC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,YAAa,IACbC,iBAAkB,KAClBC,sBAAuB,IACvBC,kBAAmB,IACnBC,iBAAkB,IAClBC,oBAAqB,KACrBC,sBAAuB,IACvBC,gBAAiB,KACjBC,qBAAsB,IACtBC,kBAAmB,KACnBC,uBAAwB,IACxBC,UAAW,KACXC,eAAgB,IAChBC,YAAa,IACbC,iBAAkB,KAClBC,sBAAuB,IACvBC,iBAAkB,KAClBC,YAAa,KACbC,iBAAkB,IAClBC,SAAU,IACVC,cAAe,IACfC,kBAAmB,IACnBC,cAAe,IACfC,eAAgB,IAChBC,KAAM,IACNC,UAAW,IACXC,OAAQ,KACRC,MAAO,KACPC,QAAS,IACTC,IAAK,IACLC,OAAQ,IACRC,KAAM,KACNC,MAAO,IACPC,QAAS,KACTC,MAAO,IACPC,MAAO,IACPC,OAAQ,KACRC,OAAQ,KACRC,YAAa,IACbC,YAAa,IACbC,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,UAAW,IACXC,eAAgB,IAChBC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,KAAM,IACNC,MAAO,KACPC,MAAO,IACPC,QAAS,KACTC,UAAW,IACXC,WAAY,KACZC,MAAO,IACPC,QAAS,KACTC,KAAM,IACNC,MAAO,KACPC,MAAO,IACPC,QAAS,KACTC,UAAW,IACXC,WAAY,KACZC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,cAAe,IACfC,gBAAiB,IACjBC,eAAgB,IAChBC,iBAAkB,IAClBC,GAAI,IACJC,GAAI,IACJvjG,IAAK,IACLwjG,OAAQ,IACRC,MAAO,IACPC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,QAAS,KACTC,OAAQ,IACRC,QAAS,KACTC,MAAO,KACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,IAAK,KACLC,IAAK,KACLC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,MAAO,IACPC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,KAAM,IACNC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,qBAAsB,IACtBC,eAAgB,IAChBC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJC,MAAO,IACPC,IAAK,IACLp0H,MAAO,IACPq0H,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,KAAM,IACNC,QAAS,IACTC,IAAK,IACLC,GAAI,IACJC,KAAM,KACNC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,QAAS,IACTC,UAAW,IACXC,YAAa,IACbC,gBAAiB,IACjBC,IAAK,IACLC,KAAM,IACNC,SAAU,IACVC,OAAQ,IACRC,MAAO,IACPnnH,KAAM,IACNonH,SAAU,IACVC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,QAAS,IACTC,IAAK,KACLC,IAAK,KACLC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJC,UAAW,IACXC,IAAK,IACLC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRC,KAAM,IACNC,SAAU,IACVC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,UAAW,IACXC,OAAQ,IACRC,QAAS,IACTC,QAAS,IACTC,GAAI,IACJC,cAAe,IACfC,SAAU,IACVC,KAAM,IACNC,KAAM,KACNC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJC,KAAM,IACNC,MAAO,IACPC,IAAK,IACL/nI,IAAK,IACLgoI,KAAM,IACNC,WAAY,IACZC,YAAa,IACbC,SAAU,IACVC,cAAe,IACfC,mBAAoB,IACpBC,cAAe,IACfC,OAAQ,IACRC,YAAa,IACbC,SAAU,IACVC,SAAU,IACVC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,OAAQ,IACRC,KAAM,IACNC,QAAS,IACTC,SAAU,IACVC,SAAU,IACVC,SAAU,IACVpiI,KAAM,IACNqiI,WAAY,IACZC,aAAc,IACdC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,KAAM,IACNC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,YAAa,IACbC,QAAS,IACTC,MAAO,IACPC,QAAS,IACTC,KAAM,IACN16C,KAAM,IACN26C,MAAO,IACPC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,SAAU,IACVC,KAAM,IACNC,KAAM,IACNC,MAAO,IACP50D,MAAO,IACP60D,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,UAAW,IACXC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,QAAS,IACTC,MAAO,IACPC,OAAQ,IACRC,KAAM,IACNC,GAAI,IACJC,KAAM,IACNC,QAAS,IACTC,SAAU,IACVC,MAAO,IACP3nG,KAAM,IACN4nG,IAAK,IACLxwH,IAAK,IACLywH,eAAgB,IAChBC,mBAAoB,IACpBC,qBAAsB,IACtBC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,KACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,kBAAmB,IACnBC,WAAY,IACZC,WAAY,IACZC,WAAY,IACZC,cAAe,IACfC,oBAAqB,IACrBC,eAAgB,IAChBC,aAAc,IACdC,mBAAoB,IACpBC,mBAAoB,IACpBC,gBAAiB,IACjBC,mBAAoB,IACpBC,WAAY,IACZC,iBAAkB,IAClBC,eAAgB,IAChBC,gBAAiB,IACjBC,kBAAmB,IACnBC,iBAAkB,IAClBC,gBAAiB,IACjBC,SAAU,IACVC,cAAe,IACfC,eAAgB,IAChBC,gBAAiB,IACjBC,cAAe,IACfC,iBAAkB,IAClBC,mBAAoB,IACpBC,kBAAmB,IACnBC,iBAAkB,IAClBC,cAAe,IACfC,iBAAkB,IAClBC,YAAa,IACbC,eAAgB,IAChBC,KAAM,IACNC,aAAc,IACdC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,OAAQ,IACRC,WAAY,IACZC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,KACNC,OAAQ,IACRC,QAAS,IACTC,aAAc,IACdC,KAAM,IACNC,OAAQ,IACRC,SAAU,IACVC,MAAO,IACPC,YAAa,IACbC,OAAQ,IACRC,KAAM,IACNC,KAAM,KACNC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,YAAa,IACbC,QAAS,IACTC,GAAI,IACJC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,OAAQ,IACRC,SAAU,IACVC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,SAAU,IACVC,MAAO,IACPC,KAAM,IACNC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,eAAgB,IAChBC,eAAgB,IAChBC,SAAU,IACVC,cAAe,IACfC,gBAAiB,IACjBC,aAAc,IACdC,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,YAAa,IACbC,cAAe,IACfC,OAAQ,IACRC,SAAU,IACVC,KAAM,IACNC,MAAO,IACPC,IAAK,IACLC,KAAM,IACNC,MAAO,KACPC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,KAAM,IACNC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,UAAW,IACXC,KAAM,IACNC,MAAO,IACPC,OAAQ,KACRC,MAAO,IACPC,OAAQ,KACRC,KAAM,IACNC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,WAAY,IACZC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,WAAY,IACZC,IAAK,IACLC,OAAQ,IACRC,OAAQ,IACRC,mBAAoB,IACpBC,aAAc,IACdC,kBAAmB,IACnBC,eAAgB,IAChBC,oBAAqB,IACrBC,YAAa,IACbC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,gBAAiB,IACjBC,YAAa,IACbC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,UAAW,IACXC,YAAa,IACbC,UAAW,IACXC,WAAY,IACZC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,WAAY,IACZC,YAAa,IACbC,SAAU,IACVC,cAAe,IACfC,mBAAoB,IACpBC,cAAe,IACfC,OAAQ,IACRC,YAAa,IACbC,SAAU,IACVC,SAAU,IACVC,QAAS,IACTC,SAAU,IACVC,IAAK,IACLlpG,IAAK,IACLmpG,KAAM,IACNC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,QAAS,IACTC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,SAAU,IACVC,cAAe,IACfC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,OAAQ,IACRC,SAAU,IACVC,UAAW,IACXC,UAAW,IACXC,WAAY,IACZC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,QAAS,IACTC,OAAQ,IACRC,MAAO,IACPC,IAAK,KACLjvJ,OAAQ,IACRkvJ,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,UAAW,IACXC,UAAW,IACXC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,OAAQ,IACRC,YAAa,IACbC,SAAU,IACVC,WAAY,KACZC,OAAQ,IACRC,UAAW,IACXC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,WAAY,IACZC,eAAgB,IAChBC,WAAY,IACZC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNrrJ,IAAK,IACLsrJ,OAAQ,IACRC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,QAAS,IACTC,KAAM,IACNC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,aAAc,IACdC,aAAc,IACdC,eAAgB,IAChBC,UAAW,IACXC,cAAe,IACfC,gBAAiB,IACjBC,OAAQ,IACRC,KAAM,IACNC,SAAU,IACVC,UAAW,IACXC,QAAS,IACTC,MAAO,IACPC,QAAS,IACTC,SAAU,IACVC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,iBAAkB,IAClBC,kBAAmB,IACnBC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,SAAU,IACVC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,SAAU,IACVC,WAAY,IACZC,aAAc,IACdC,iBAAkB,IAClBC,MAAO,IACPC,UAAW,IACXC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,WAAY,IACZC,iBAAkB,IAClBC,YAAa,IACbC,YAAa,IACbC,YAAa,IACbC,cAAe,IACfC,cAAe,IACfC,eAAgB,IAChBC,MAAO,IACPC,eAAgB,IAChBC,gBAAiB,IACjBC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,MAAO,IACPC,WAAY,IACZC,WAAY,IACZC,OAAQ,IACRC,SAAU,IACVC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,OAAQ,IACRC,WAAY,IACZC,SAAU,IACVC,WAAY,IACZC,OAAQ,IACRC,MAAO,IACPC,UAAW,IACXC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,SAAU,IACVC,aAAc,KACdC,cAAe,KACfC,aAAc,KACdC,cAAe,KACfC,SAAU,IACVC,gBAAiB,IACjBC,iBAAkB,IAClBC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,OAAQ,IACRC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,YAAa,IACbC,aAAc,IACdC,kBAAmB,IACnBC,cAAe,IACfC,cAAe,IACfC,IAAK,KACLC,IAAK,KACLC,MAAO,IACPC,MAAO,KACPC,MAAO,KACPC,KAAM,KACNC,KAAM,KACNC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,KACRC,OAAQ,KACRC,OAAQ,KACRC,OAAQ,KACRC,OAAQ,IACRC,QAAS,IACTC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,OAAQ,IACRC,OAAQ,IACRC,IAAK,KACLC,IAAK,KACLC,KAAM,KACNC,KAAM,KACNC,GAAI,IACJC,GAAI,IACJC,OAAQ,IACRC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,MAAO,IACPC,KAAM,IACNC,MAAO,IACPC,IAAK,KACLC,IAAK,KACLC,MAAO,IACPC,MAAO,IACPC,GAAI,IACJC,GAAI,IACJC,MAAO,IACPC,MAAO,IACPC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,KAAM,KACNC,KAAM,KACNC,OAAQ,IACRC,OAAQ,IACRC,MAAO,IACPC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,KAAM,IACNC,KAAM,IACNC,MAAO,IACPC,MAAO,IACPC,IAAK,IACLC,IAAK,IACLC,IAAK,IACLC,IAAK,KACLC,IAAK,KACLC,KAAM,IACNC,KAAM,IACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,IAAK,IACLC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,OAAQ,IACRC,eAAgB,IAChBC,KAAM,IACNC,KAAM,IACNC,IAAK,IACLC,IAAK,KACLC,KAAM,IACNC,KAAM,IACNC,QAAS,IACTC,KAAM,IACNC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,IAAK,IACLC,KAAM,MAQPlmK,EAAQuiE,UAAYviE,EAAQo3F,a,8IC1nE5B,MAAM,EAA+Bn3F,GAAG8gB,OAAO8/D,U,8KCK3CvgF,EAAS2Q,EAAAA,EAAO1Q,UAAU,YAmxC9B,QAjxCe,CAOXqgB,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAOAoiB,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,WAC5BhY,EAAUe,UAAY,8DACff,CACX,EAYAu9J,6BAA+B,WAE3B,IAAIn6J,EAAU/K,KAEVuU,EAAS/L,SAASC,cAAc,UAEhCoS,EAAOrS,SAASC,cAAc,QA2BlC,OA1BA8L,EAAOpM,YAAY0S,GACnBtG,EAAOrQ,GAAKlE,KAAK2f,QAAQ,oBACzBpL,EAAO7L,UAAY,wIACnB6L,EAAO0G,aAAa,aAAc,iCAClC1G,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAMxB1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQo6J,sBAAsBljK,EAClC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQo6J,sBAAsBljK,EAClC,IAGGsS,CACX,EAgBA6wJ,yBAA2B,WACvB,IAAIpzG,EAASxpD,SAASC,cAAc,UAQpC,OAPAupD,EAAO9tD,GAAKlE,KAAK2f,QAAQ,gBACzBqyC,EAAOtpD,UAAY,6BAMZspD,CACX,EAEAqzG,4BAA8B,WAC1B,IAAI98J,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,iCACTH,CACX,EAEAm4E,+BAAiC,WAC7B,IAAIn4E,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,oCACTH,CACX,EAOA+8J,+BAAiC,WAE7B,IAAI38J,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OACvCd,EAAUe,UAAY,mDAEtB,IAAIH,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,yDAChBH,EAAI4J,UAAY,sBAChBxK,EAAUQ,YAAYI,GAEtB,IAAIg9J,EAAW/8J,SAASC,cAAc,UACtC88J,EAASrhK,GAAKlE,KAAK2f,QAAQ,qBAC3B4lJ,EAAS78J,UAAY,qHACrB68J,EAASp1J,MAAQ,qBAGbo1J,EAASlzJ,iBACTkzJ,EAASlzJ,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqBV,OAC9D,IAAG,GACIsmJ,EAAShzJ,aAChBgzJ,EAAShzJ,YAAY,WAAW,WAC5B/J,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqBV,OAC9D,IAGJ,IAAIpE,EAAOrS,SAASC,cAAc,QAQlC,OAPAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjBo8I,EAASp9J,YAAY0S,GAErBlT,EAAUQ,YAAYo9J,GAEf59J,CACX,EAOA69J,+BAAiC,WAC7B,IAAI79J,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUe,UAAY,mDAEff,CACX,EASA89J,gCAAkC,SAAUtzJ,GAA2B,IAAhB6B,IAAOjG,UAAA3M,OAAA,QAAA+e,IAAApS,UAAA,KAAAA,UAAA,GACtDiuC,EAAIxzC,SAASC,cAAc,KAC/BuzC,EAAE7pC,UAAYA,EACd,IAAIuzJ,EAAgB1xJ,EAA0C,GAAhC,8BAG9B,OAFAgoC,EAAEtzC,UAAY,wCAA0Cg9J,EAEjD1pH,CACX,EAQA2pH,6BAA+B,WAE3B,IAAIh9J,EAAO3I,KAEP4lK,EAAOp9J,SAASC,cAAc,QA0FlC,OAzFAm9J,EAAK1hK,GAAKlE,KAAK2f,QAAQ,eACvBimJ,EAAKl9J,UAAY,uCACjBk9J,EAAK3qJ,aAAa,aAAc,+BAEhC2qJ,EAAKvzJ,iBAAiB,UAAU,SAAUpQ,GACtC5C,EAAOqD,IAAIT,GACXA,EAAEomB,iBAGF,IAAI1B,EAASne,SAASkB,uBAAuBf,EAAKgX,QAAQ,oBAGtDiJ,EAAQjC,EAAO,GAAGrQ,WAAW,GAAGpS,GAChC2kB,EAAMlC,EAAOA,EAAOvlB,OAAS,GAAGkV,WAAW,GAAGpS,GAC9C4kB,EAAU7T,EAAAA,EAAGhM,MAAM2f,GACnBG,EAAQ9T,EAAAA,EAAGhM,MAAM4f,GAErB,GAAoF,KAA/ErgB,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBmJ,IAAU/hB,OACe,KAArFyB,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BmJ,IAAU/hB,OACG,KAA7EyB,SAASqL,eAAelL,EAAKgX,QAAQ,oBAAsBoJ,IAAQhiB,OACmB,KAAnFyB,SAASqL,eAAelL,EAAKgX,QAAQ,0BAA4BoJ,IAAQhiB,MAC7E,OAAO,EAIX4B,EAAKk9J,oCAAoCl/I,GASzC,IAAIm/I,EAAkB,KAClBt9J,SAASqL,eAAelL,EAAKgX,QAAQ,+BAEjCnX,SAASqL,eAAelL,EAAKgX,QAAQ,+BACjCnX,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8B9J,UACnEiwJ,EAAkBt9J,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8B5Y,OAIzFyB,SAASqL,eAAelL,EAAKgX,QAAQ,gCACjCnX,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+B9J,UACpEiwJ,EAAkBt9J,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+B5Y,QAMlG,IAAIg/J,EAAgB,KAEhBv9J,SAASqL,eAAelL,EAAKgX,QAAQ,yBACjCnX,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwB9J,UAC7DkwJ,EAAgBv9J,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwB5Y,OAIjFyB,SAASqL,eAAelL,EAAKgX,QAAQ,gCACjCnX,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+B9J,UACpEkwJ,EAAgBv9J,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+B5Y,OAO5F,IAFA,IAAIi/J,EAAa,GACbC,EAAoBz9J,SAASkB,uBAAuB,2BAC/Ckd,EAAI,EAAGA,EAAIq/I,EAAkB7kK,OAAQwlB,IAAK,CAC/C,IAAI1iB,EAAK+hK,EAAkBr/I,GAAGlQ,QAC1BO,EAAKzO,SAASqL,eAAe3P,GAC5B+S,EAAGpB,SACJmwJ,EAAWpgK,KAAKqR,EAAGlQ,MAE3B,CAYA,OAVA4B,EAAKu9J,yBAAyB,CAC1BC,YAAcL,EACdM,UAAYL,EACZC,WAAaA,KAOV,CACX,IAEOJ,CACX,EAOAS,gCAAkC,WAC9B,IAAI1+J,EAAYa,SAASC,cAAc,OASvC,OARAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,uBAC5BhY,EAAUe,UAAY,6BAEtBf,EAAUQ,YAAYnI,KAAKsmK,oCAC3B3+J,EAAUQ,YAAYnI,KAAKumK,8BAC3B5+J,EAAUQ,YAAYnI,KAAKwmK,yCAC3B7+J,EAAUQ,YAAYnI,KAAKymK,qCAEpB9+J,CACX,EAOA++J,2BAA6B,WACzB,IAAIn+J,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,+BACtBpX,EAAIG,UAAY,8EAEhB,IAAIszC,EAAIxzC,SAASC,cAAc,KAM/B,OALAuzC,EAAEtzC,UAAY,0CACdszC,EAAE7pC,UAAY,wBAEd5J,EAAIJ,YAAY6zC,GAETzzC,CACX,EAYA+9J,iCAAmC,WAC/B,IAAI/9J,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,wBACfpX,CACX,EAOAs9J,oCAAsC,SAAUl/I,GAC5Cne,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAAyBxN,UAAY,GAC1E,IAAK,IAAIiD,EAAI,EAAGA,EAAIuR,EAAOvlB,OAAQgU,IAAK,CACpC,IAAIyR,EAAMF,EAAOvR,GAAGkB,WAAW,GAAGpS,GAC9BA,EAAK+Q,EAAAA,EAAGhM,MAAM4d,GAClB,GAAiF,kDAA7Ere,SAASqL,eAAe7T,KAAK2f,QAAQ,mBAAqBzb,IAAKwE,UAA+D,CAC9H,IAAIi+J,EAAcn+J,SAASC,cAAc,OACzCk+J,EAAYj+J,UAAY,gCACxB,IAAIk+J,EAAmBp+J,SAASC,cAAc,QAC9Cm+J,EAAiBl+J,UAAY,0BAC7Bk+J,EAAiBz0J,UAAY3J,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAA2Bzb,IAAKiO,UAAY,MAC9Gw0J,EAAYx+J,YAAYy+J,GACxB,IAAIC,EAAmBr+J,SAASC,cAAc,QAC9Co+J,EAAiBn+J,UAAY,0BAC7B,IACIo+J,EADgBt+J,SAASqL,eAAe7T,KAAK2f,QAAQ,0BAA4Bzb,IACrD6C,MAE5B8/J,EAAiB10J,UADD,OAAhB20J,GAAwC,KAAhBA,EACKA,EAEAt+J,SAASqL,eAAe7T,KAAK2f,QAAQ,oBAAsBzb,IAAK6C,MAEjG4/J,EAAYx+J,YAAY0+J,GACW,KAA/BA,EAAiB10J,WACjB3J,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAAyBxX,YAAYw+J,EAElF,CACJ,CACJ,EAQAJ,2BAA6B,WAEzB,IAAI59J,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OACvCd,EAAUzD,GAAKlE,KAAK2f,QAAQ,kBAG5B,IAAIonJ,EAAWv+J,SAASC,cAAc,OACtCs+J,EAAS7iK,GAAKlE,KAAK2f,QAAQ,wBAC3BhY,EAAUQ,YAAY4+J,GAEtB,IAAIC,EAAUx+J,SAASC,cAAc,OACrCu+J,EAAQ9iK,GAAKlE,KAAK2f,QAAQ,sBAE1B,IAAI2pE,EAAS9gF,SAASC,cAAc,UACpC6gF,EAAOplF,GAAKlE,KAAK2f,QAAQ,mCACzB2pE,EAAO5gF,UAAY,gCAGnB4gF,EAAOj3E,iBAAiB,UAAU,SAAUpQ,GACxC0G,EAAKs+J,mCAAmChlK,EAC5C,IAUA,IARA,IAAIilK,EAAW,CAAC,CACZtoI,KAAO,UACP1sB,MAAQ,eACT,CACC0sB,KAAO,WACP1sB,MAAQ,eAGHkD,EAAI,EAAGA,EAAI8xJ,EAAS9lK,OAAQgU,IAAK,CACtC,IAAI2mC,EAASvzC,SAASC,cAAc,UACpCszC,EAAOh1C,MAAQmgK,EAAS9xJ,GAAGwpB,KAC3Bmd,EAAOl6C,KAAOqlK,EAAS9xJ,GAAGlD,MAC1Bo3E,EAAOnhF,YAAY4zC,EACvB,CACAirH,EAAQ7+J,YAAYmhF,GACpB3hF,EAAUQ,YAAY6+J,GAEtB,IAAIG,EAAS3+J,SAASC,cAAc,OAWpC,OAVA0+J,EAAOjjK,GAAKlE,KAAK2f,QAAQ,qBACzBwnJ,EAAOz+J,UAAY,sFACnBy+J,EAAOh3J,MAAQ,qBACfg3J,EAAO90J,iBAAiB,SAAS,SAAUpQ,GACvCuG,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBjX,UAAY,6BACzEF,SAASqL,eAAelL,EAAKgX,QAAQ,gBAAgBjX,UAAY,uCACjEC,EAAKy+J,2BAA2BnlK,EACpC,IACA0F,EAAUQ,YAAYg/J,GAEfx/J,CACX,EAYA0/J,8BAAgC,SAAUriK,EAAUwnC,EAAU86H,GAC1D,IAAI/+J,EAAMC,SAASqL,eAAe7T,KAAK2f,QAAQ,yBAG/C,GAAIpX,EAAIinB,kBACJ,KAAOjnB,EAAI2mB,YACP3mB,EAAI4mB,YAAY5mB,EAAI2mB,YAI5B,IAAIq4I,EAAoB/+J,SAASC,cAAc,OAC/C8+J,EAAkB7+J,UAAY,sBAE9B,IAAI8+J,EAAgBh/J,SAASC,cAAc,SAC3C++J,EAAc9+J,UAAY,2BAC1B8+J,EAAcr1J,UAAY,aAC1Bo1J,EAAkBp/J,YAAYq/J,GAE9B,IAAIC,EAAgB,EAGpB,GAFW9/I,SAAS3iB,EAAW,IAAM,IAI9B,CACH,IAAI0iK,EAAkBnwI,KAAKC,MAAMxyB,GAEjCyiK,GADAC,GAAoC,KACF,KACtC,MALID,EAAgBlwI,KAAKC,MAAMxyB,GAAY,KAO3C,IAAI2iK,EAAcn/J,SAASC,cAAc,OACzCk/J,EAAYzjK,GAAKlE,KAAK2f,QAAQ,2BAC9BgoJ,EAAYx1J,UAAYs1J,EACxBF,EAAkBp/J,YAAYw/J,GAE9Bp/J,EAAIJ,YAAYo/J,GAEhB,IAAIK,EAAoBp/J,SAASC,cAAc,OAC/Cm/J,EAAkBl/J,UAAY,sBAE9B,IAAIm/J,EAAgBr/J,SAASC,cAAc,SAC3Co/J,EAAcn/J,UAAY,2BAC1Bm/J,EAAc11J,UAAY,UAC1By1J,EAAkBz/J,YAAY0/J,GAE9B,IAAIC,EAAct/J,SAASC,cAAc,OAOzC,OANAq/J,EAAY5jK,GAAKlE,KAAK2f,QAAQ,2BAC9BmoJ,EAAY31J,UAAYm1J,EAAS96H,GACjCo7H,EAAkBz/J,YAAY2/J,GAE9Bv/J,EAAIJ,YAAYy/J,GAETr/J,CACX,EAOAi+J,sCAAwC,WACpC,IAAIj+J,EAAMC,SAASC,cAAc,OAEjC,GADAF,EAAIG,UAAY,oEACXqB,EAAAA,EAAAA,KAAa,CACd,IAAIg+J,EAAcv/J,SAASC,cAAc,OACzCs/J,EAAYr/J,UAAY,gCACxBH,EAAIJ,YAAY4/J,EACpB,CACA,IAAInzJ,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,6BACxB/K,EAAM1I,KAAO,WACb3D,EAAIJ,YAAYyM,GAChB,IAAIozJ,EAAYx/J,SAASC,cAAc,SAKvC,GAJAu/J,EAAUt/J,UAAY,qBACtBs/J,EAAUtxJ,QAAU1W,KAAK2f,QAAQ,6BACjCqoJ,EAAU71J,UAAY,qBACtB5J,EAAIJ,YAAY6/J,KACXj+J,EAAAA,EAAAA,KAAa,CACd,IAAIk+J,EAAYz/J,SAASC,cAAc,SACvCw/J,EAAUvxJ,QAAU1W,KAAK2f,QAAQ,6BACjCsoJ,EAAU91J,UAAY,oBACtB5J,EAAIJ,YAAY8/J,GAChB,IAAIC,EAAgB1/J,SAASC,cAAc,OAC3Cy/J,EAAcx/J,UAAY,eAC1BH,EAAIJ,YAAY+/J,EACpB,CACA,OAAO3/J,CACX,EAOAk+J,kCAAoC,WAEhC,IAAIl+J,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,yBACfpX,CACX,EAUA4/J,+BAAiC,SAAUC,EAAcd,GAErD,IAAIv8J,EAAU/K,KAEVuI,EAAMC,SAASqL,eAAe7T,KAAK2f,QAAQ,0BAG/C,GAAIpX,EAAIinB,kBACJ,KAAOjnB,EAAI2mB,YACP3mB,EAAI4mB,YAAY5mB,EAAI2mB,YAS5B,IAJA,IAAIm5I,EAAgB,EAChBC,EAAgB,EAGXlzJ,EAAI,EAAGA,EAAIgzJ,EAAahnK,OAAQgU,IAAK,CAC1C,IAAIlR,EAAKkR,EAAI,EAETwO,EAAIwkJ,EAAahzJ,GAEjBmzJ,EAAS//J,SAASC,cAAc,OACpC8/J,EAAO7/J,UAAY,8BACnB6/J,EAAOp2J,UAAYjO,EAAK,IACxBqE,EAAIJ,YAAYogK,GAEhBD,GAAiBh9H,WAAW1nB,EAAE4oB,UAC9B67H,GAAiB/8H,WAAW1nB,EAAE5e,UAE9B,IAAIA,EAAW,EAEf,GADgB2iB,SAAS0gJ,EAAgB,IAAM,IAGxC,CACH,IAAIX,EAAkBnwI,KAAKC,MAAM6wI,GAEjCrjK,GADA0iK,GAAoC,KACP,KACjC,MALI1iK,EAAWuyB,KAAKC,MAAM6wI,GAAiB,KAO3C,IAAIG,EAAShgK,SAASC,cAAc,OACpC+/J,EAAO9/J,UAAY,mCACnB8/J,EAAOtkK,GAAKlE,KAAK2f,QAAQ,oCAAsCzb,GAC/DskK,EAAOr4J,MAAQ,cAAgBnL,EAAhB,cAAgDsiK,EAASgB,GACxEE,EAAOr2J,UAAYyR,EAAEgpB,YAErB47H,EAAOn2J,iBAAiB,aAAa,SAAUpQ,GAC3C8I,EAAQ09J,+BAA+BxmK,EAC3C,IACAumK,EAAOn2J,iBAAiB,YAAY,SAAUpQ,GAC1C8I,EAAQ29J,8BAA8BzmK,EAC1C,IACAumK,EAAOn2J,iBAAiB,SAAS,SAAUpQ,GAEW,mBAAvC8I,EAAQ49J,4BACf59J,EAAQ49J,2BAA2B1mK,EAE3C,IACAsG,EAAIJ,YAAYqgK,EACpB,CAEA,OAAOjgK,CACX,EAiBAqgK,kCAAoC,SAAUj/I,EAAG9nB,EAAMgQ,GAEnD,IAAI9G,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAK,eAAiBylB,EAC1BphB,EAAIG,UAAamJ,EAAc,oCAAsC,0CAErE,IAAIg3J,EAAcrgK,SAASC,cAAc,SACzCogK,EAAY3kK,GAAK,qBAAuBylB,EACxCk/I,EAAYnyJ,QAAU,gBAAkBiT,EACxCk/I,EAAY12J,UAAYtQ,EACxBgnK,EAAYx2J,iBAAiB,SAAS,WAClC,IAAI+C,EAAIpV,KAAKkE,GAAGqqC,OAAOvuC,KAAKkE,GAAG9C,OAAS,GACxCoH,SAASqL,eAAe,sBAAwBuB,GAAGrO,MAAQ,GAC3D,IAAK,IAAI6f,EAAI,EAAGA,EAAI,EAAGA,IACnBpe,SAASqL,eAAe,eAAiB+S,GAAG3nB,MAAM+U,QAAU,OAEhExL,SAASqL,eAAe,eAAenL,UAAY,uCACnDF,SAASqL,eAAe,uBAAyBuB,GAAGS,SAAU,EAC9DrN,SAASqL,eAAe,gBAAkBuB,GAAG1M,UAAY,+BACzDF,SAASqL,eAAe,sBAAwBuB,GAAG1M,UAAY,4BACnE,IACAH,EAAIJ,YAAY0gK,GAEhB,IAAI7hJ,EAAcxe,SAASC,cAAc,SACzCue,EAAY9iB,GAAK,gBAAkBylB,EACnC3C,EAAYte,UAAY,+BACxBse,EAAY9a,KAAO,OACnB8a,EAAYC,YAAc,iCAC1BD,EAAY3U,iBAAiB,SAAS,SAAUpQ,GAC5C,IAAIklB,EAAWllB,EAAEmlB,OAASnlB,EAAEolB,QAC5B,GAAiB,KAAbF,GAAgC,KAAbA,EAAvB,CAGA,IAAI/R,EAAIpV,KAAKkE,GAAGqqC,OAAOvuC,KAAKkE,GAAG9C,OAAS,GACpCoH,SAASqL,eAAe,gBAAkBuB,GAAGrO,MAAM3F,OAAS,EAC5DoH,SAASqL,eAAe,0BAA4BuB,GAAGnW,MAAM+U,QAAU,QAEvExL,SAASqL,eAAe,0BAA4BuB,GAAGnW,MAAM+U,QAAU,OAK3EjJ,EAAQwc,yBAAyBtlB,EAVjC,CAWJ,IACA+kB,EAAY3U,iBAAiB,QAAQ,WACjC,IAAI+C,EAAIpV,KAAKkE,GAAGqqC,OAAOvuC,KAAKkE,GAAG9C,OAAS,GACxCoH,SAASqL,eAAe,0BAA4BuB,GAAGnW,MAAM+U,QAAU,MAC3E,IACAzL,EAAIJ,YAAY6e,GAEhB,IAAIgB,EAAmBxf,SAASC,cAAc,SAC9Cuf,EAAiB9jB,GAAK,sBAAwBylB,EAC9C3B,EAAiBtf,UAAY,6BAC7Bsf,EAAiB9b,KAAO,OACxB8b,EAAiB9U,UAAW,EAC5B3K,EAAIJ,YAAY6f,GAEhB,IAAIE,EAAqB1f,SAASC,cAAc,SAChDyf,EAAmBhkB,GAAK,uBAAyBylB,EACjDzB,EAAmBhc,KAAO,WAC1B3D,EAAIJ,YAAY+f,GAEhB,IAAI4gJ,EAAqBtgK,SAASC,cAAc,SAiDhD,OAhDAqgK,EAAmB5kK,GAAK,0BAA4BylB,EACpDm/I,EAAmBpyJ,QAAU,uBAAyBiT,EACtDm/I,EAAmBpgK,UAAY,0BAC/BogK,EAAmB34J,MAAQ,+BAC3B24J,EAAmBz2J,iBAAiB,SAAS,SAAUgqC,GACnDA,EAAIh0B,iBACJg0B,EAAI/zB,kBACJ,IACI1B,EADAxR,EAAIpV,KAAKkE,GAAGqqC,OAAOvuC,KAAKkE,GAAG9C,OAAS,GAExC,IAAKwlB,EAAI,EAAGA,EAAI,EAAGA,IACXxR,IAAMwR,IACNpe,SAASqL,eAAe,uBAAyB+S,GAAG/Q,SAAU,EACG,iCAA7DrN,SAASqL,eAAe,sBAAwB+S,GAAG7f,QACnDyB,SAASqL,eAAe,sBAAwB+S,GAAG7f,MAAQ,GAC3DyB,SAASqL,eAAe,gBAAkB+S,GAAGle,UAAY,+BACzDF,SAASqL,eAAe,sBAAwB+S,GAAGle,UAAY,+BAI3E,GAAIF,SAASqL,eAAe,uBAAyBuB,GAAGS,QAAS,CAE7D,IADArN,SAASqL,eAAe,sBAAwBuB,GAAGrO,MAAQ,GACtD6f,EAAI,EAAGA,EAAI,EAAGA,IACfpe,SAASqL,eAAe,eAAiB+S,GAAG3nB,MAAM+U,QAAU,OAEhExL,SAASqL,eAAe,eAAenL,UAAY,uCACnDF,SAASqL,eAAe,uBAAyBuB,GAAGS,SAAU,EAC9DrN,SAASqL,eAAe,gBAAkBuB,GAAG1M,UAAY,+BACzDF,SAASqL,eAAe,sBAAwBuB,GAAG1M,UAAY,4BACnE,KAAO,CAEH,IADAF,SAASqL,eAAe,sBAAwBuB,GAAGrO,MAAQ,+BACtD6f,EAAI,EAAGA,EAAI,EAAGA,IAEXpe,SAASqL,eAAe,eAAiB+S,GAAG3nB,MAAM+U,QADlDoB,IAAMwR,EACsD,OAEA,OAGpEpe,SAASqL,eAAe,eAAenL,UAAY,uDACnDF,SAASqL,eAAe,uBAAyBuB,GAAGS,SAAU,EAC9DrN,SAASqL,eAAe,gBAAkBuB,GAAG1M,UAAY,6BACzDF,SAASqL,eAAe,sBAAwBuB,GAAG1M,UAAY,8BACnE,CAGAqC,EAAQg+J,qBAAqB1sH,EACjC,IACA9zC,EAAIJ,YAAY2gK,GAETvgK,CACX,EAWAygK,wCAA0C,SAAUr/I,GAEhD,IAAI5e,EAAU/K,KAEVipK,EAAQzgK,SAASC,cAAc,OAqBnC,OApBAwgK,EAAM/kK,GAAK,qBAAuBylB,EAClCs/I,EAAMvgK,UAAY,qBAClBugK,EAAM94J,MAAQ,oBACJ,IAANwZ,GAAiB,IAANA,GACXs/I,EAAM52J,iBAAiB,SAAS,SAAUpQ,GACtC,IAAImT,EAAIpV,KAAKkE,GAAGqqC,OAAOvuC,KAAKkE,GAAG9C,OAAS,GACxCoH,SAASqL,eAAe,eAAiBuB,GAAG1M,UAAY,0CACxDF,SAASqL,eAAe,gBAAkBuB,GAAGrO,MAAQ,GACrDyB,SAASqL,eAAe,gBAAkBuB,GAAG1M,UAAY,+BACzDF,SAASqL,eAAe,sBAAwBuB,GAAGrO,MAAQ,GAC3DyB,SAASqL,eAAe,sBAAwBuB,GAAG1M,UAAY,6BAC/DF,SAASqL,eAAe,mBAAmB5U,MAAM+U,QAAU,GAM3DjJ,EAAQm+J,wBAAwBjnK,EACpC,IAEGgnK,CACX,EAUAE,qCAAuC,WAEnC,IAAIp+J,EAAU/K,KAEVopK,EAAS5gK,SAASC,cAAc,OA6BpC,OA5BA2gK,EAAOllK,GAAK,kBACZklK,EAAOj5J,MAAQ,oBACfi5J,EAAO/2J,iBAAiB,SAAS,SAAUpQ,GAGvC,IAFA,IAAImnB,EAAY,EACZC,EAAW,EACNjU,EAAI,EAAGA,EAAI,EAAGA,IAC2C,4CAA1D5M,SAASqL,eAAe,eAAiBuB,GAAG1M,UAC1B,IAAd0gB,IACAA,EAAYhU,GAGhBiU,IAGJD,EAAY,IACZ5gB,SAASqL,eAAe,eAAiBuV,GAAW1gB,UAAY,qCAKnD,IAAb2gB,IACA7gB,SAASqL,eAAe,mBAAmB5U,MAAM+U,QAAU,QAI/DjJ,EAAQs+J,qBAAqBpnK,EACjC,IAEOmnK,CACX,EAWAE,6CAA+C,SAAU3/I,GAErD,IAAI5e,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OAmBjC,OAlBAF,EAAIrE,GAAK,0BAA4BylB,EACrCphB,EAAIG,UAAY,6BAEZH,EAAI8J,iBACJ9J,EAAI8J,iBAAiB,SAAS,SAAUpQ,GACpC8I,EAAQ0e,gCAAgCxnB,GACxCuG,SAASqL,eAAe,0BAA4B8V,GAAG1qB,MAAM+U,QAAU,MAC3E,IAAG,GACIzL,EAAIgK,aACXhK,EAAIgK,YAAY,WAAW,SAAUtQ,GACjC8I,EAAQ0e,gCAAgCxnB,GACxCuG,SAASqL,eAAe,0BAA4B8V,GAAG1qB,MAAM+U,QAAU,MAC3E,IAMGzL,CACX,EAaAghK,yCAA2C,SAAU76J,EAAUib,EAAGzlB,GAC9D,IAAIyD,EAAYa,SAASqL,eAAe,0BAA4B8V,GAEhEphB,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAK,wBAA0BA,EACnCqE,EAAIG,UAAY,yBAChBH,EAAI4J,UAAYyX,EAAAA,EAAaC,6BAA6Bnb,GAE1D/G,EAAUQ,YAAYI,EAC1B,EAcAihK,gDAAkD,SAAUC,GAExD,IAAI1+J,EAAU/K,KAEV0pK,EAAelhK,SAASC,cAAc,OAC1CihK,EAAaxlK,GAAKlE,KAAK2f,QAAQ,0BAE/B,IAAIzN,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,sCAClBwJ,EAAMC,UAAY,iCAClBu3J,EAAavhK,YAAY+J,GAEzB,IAAIy3J,EAAWnhK,SAASC,cAAc,OACtCkhK,EAASjhK,UAAY,sBAErB,IAAK,IAAI0M,EAAI,EAAGA,EAAIq0J,EAAWroK,OAAQgU,IAAK,CACxC,IAAIgxJ,EAAYqD,EAAWr0J,GAEvB7M,EAAMC,SAASC,cAAc,OAGjC,GAFAF,EAAIG,UAAY,0EAEE,YAAd09J,EAAyB,CACzB,IAAIwD,EAAWphK,SAASC,cAAc,SACtCmhK,EAAS1lK,GAAKlE,KAAK2f,QAAQ,uBAC3BiqJ,EAAS19J,KAAO,QAChB09J,EAASvhK,KAAO,mBAChBuhK,EAAS7iK,MAAQ,UACP,IAANqO,IACAw0J,EAAS/zJ,SAAU,GAKnB+zJ,EAASv3J,iBACTu3J,EAASv3J,iBAAiB,UAAU,SAAUpQ,GAC1C8I,EAAQ8+J,2BAA2B5nK,EACvC,IACO2nK,EAASr3J,aAChBq3J,EAASr3J,YAAY,YAAY,SAAUtQ,GACvC8I,EAAQ8+J,2BAA2B5nK,EACvC,IAEJsG,EAAIJ,YAAYyhK,GAEhB,IAAIE,EAAWthK,SAASC,cAAc,SACtCqhK,EAASphK,UAAY,yCACrBohK,EAASpzJ,QAAU1W,KAAK2f,QAAQ,uBAChCmqJ,EAAS35J,MAAQ,UACjB25J,EAAS33J,UAAY,UACrB5J,EAAIJ,YAAY2hK,EACpB,CAEA,GAAkB,WAAd1D,EAAwB,CACxB,IAAI2D,EAAkBvhK,SAASC,cAAc,SAC7CshK,EAAgB7lK,GAAKlE,KAAK2f,QAAQ,8BAClCoqJ,EAAgB79J,KAAO,QACvB69J,EAAgB1hK,KAAO,mBACvB0hK,EAAgBhjK,MAAQ,SACd,IAANqO,IACA20J,EAAgBl0J,SAAU,GAK1Bk0J,EAAgB13J,iBAChB03J,EAAgB13J,iBAAiB,UAAU,SAAUpQ,GACjD8I,EAAQ8+J,2BAA2B5nK,EACvC,IACO8nK,EAAgBx3J,aACvBw3J,EAAgBx3J,YAAY,YAAY,SAAUtQ,GAC9C8I,EAAQ8+J,2BAA2B5nK,EACvC,IAEJsG,EAAIJ,YAAY4hK,GAEhB,IAAIC,EAAkBxhK,SAASC,cAAc,SAC7CuhK,EAAgBthK,UAAY,yCAC5BshK,EAAgBtzJ,QAAU1W,KAAK2f,QAAQ,8BACvCqqJ,EAAgB75J,MAAQ,SACxB65J,EAAgB73J,UAAY,SAC5B5J,EAAIJ,YAAY6hK,EACpB,CAEAL,EAASxhK,YAAYI,EACzB,CAGA,OAFAmhK,EAAavhK,YAAYwhK,GAElBD,CACX,EAQAO,8CAAgD,WAE5C,IAAIl/J,EAAU/K,KAEV0pK,EAAelhK,SAASC,cAAc,OAC1CihK,EAAaxlK,GAAKlE,KAAK2f,QAAQ,4BAC/B+pJ,EAAahhK,UAAY,WAEzB,IAAIwJ,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,6CAClBwJ,EAAMC,UAAY,iBAClBu3J,EAAavhK,YAAY+J,GAEzB,IAAIy3J,EAAWnhK,SAASC,cAAc,OACtCkhK,EAASjhK,UAAY,sBAErB,IAAIH,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,4EAChB,IAAIwhK,EAAe1hK,SAASC,cAAc,SAC1CyhK,EAAahmK,GAAKlE,KAAK2f,QAAQ,6BAC/BuqJ,EAAah+J,KAAO,QACpBg+J,EAAa7hK,KAAO,qBACpB6hK,EAAanjK,MAAQ,UACrBmjK,EAAar0J,SAAU,EAInBq0J,EAAa73J,iBACb63J,EAAa73J,iBAAiB,UAAU,SAAUpQ,GAC9C8I,EAAQo/J,6BAA6BloK,EACzC,IACOioK,EAAa33J,aACpB23J,EAAa33J,YAAY,YAAY,SAAUtQ,GAC3C8I,EAAQo/J,6BAA6BloK,EACzC,IAEJsG,EAAIJ,YAAY+hK,GAEhB,IAAIE,EAAe5hK,SAASC,cAAc,SAC1C2hK,EAAa1hK,UAAY,qBACzB0hK,EAAa1zJ,QAAU1W,KAAK2f,QAAQ,6BACpCyqJ,EAAaj6J,MAAQ,cACrBi6J,EAAaj4J,UAAY,cACzB5J,EAAIJ,YAAYiiK,GAChBT,EAASxhK,YAAYI,GAErB,IAAI8hK,EAAO7hK,SAASC,cAAc,OAClC4hK,EAAK3hK,UAAY,4EACjB,IAAI4hK,EAAgB9hK,SAASC,cAAc,SAC3C6hK,EAAcpmK,GAAKlE,KAAK2f,QAAQ,8BAChC2qJ,EAAcp+J,KAAO,QACrBo+J,EAAcjiK,KAAO,qBACrBiiK,EAAcvjK,MAAQ,WAIlBujK,EAAcj4J,iBACdi4J,EAAcj4J,iBAAiB,UAAU,SAAUpQ,GAC/C8I,EAAQo/J,6BAA6BloK,EACzC,IACOqoK,EAAc/3J,aACrB+3J,EAAc/3J,YAAY,YAAY,SAAUtQ,GAC5C8I,EAAQo/J,6BAA6BloK,EACzC,IAEJooK,EAAKliK,YAAYmiK,GAEjB,IAAIC,EAAgB/hK,SAASC,cAAc,SAU3C,OATA8hK,EAAc7hK,UAAY,qBAC1B6hK,EAAc7zJ,QAAU1W,KAAK2f,QAAQ,8BACrC4qJ,EAAcp6J,MAAQ,aACtBo6J,EAAcp4J,UAAY,aAC1Bk4J,EAAKliK,YAAYoiK,GAEjBZ,EAASxhK,YAAYkiK,GACrBX,EAAavhK,YAAYwhK,GAElBD,CACX,EAaAc,uCAAyC,WAErC,IAAIz/J,EAAU/K,KAEVuU,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,8BACzB,IAAI6oD,EAAS,GA4Bb,OA3BIz+D,EAAAA,EAAAA,OACAy+D,EAAS,8BAEbj0D,EAAO7L,UAAY,+FAAH6nB,OAAkGi4C,EAAM,kFACxHj0D,EAAOpE,MAAQ,aAEfoE,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GAIhC1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvCA,EAAEomB,iBACF,IAAIrmB,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ0/J,2BAA2BxoK,EACvC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpCA,EAAEomB,iBACF,IAAIrmB,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ0/J,2BAA2BxoK,EACvC,IAGGsS,CACX,EAOAm2J,uCAAyC,WACrC,IAAIniK,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,qBACtBpX,EAAIG,UAAY,WAEhB,IAAIwJ,EAAQ1J,SAASC,cAAc,SAOnC,OANAyJ,EAAMxJ,UAAY,kCAClBwJ,EAAMC,UAAY,qBAClB5J,EAAIJ,YAAY+J,GAIT3J,CACX,EAUAoiK,6CAA+C,SAAU3E,GAErD,IAAIj7J,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OAIjC,IAAK,IAAI1B,KAHTwB,EAAIG,UAAY,8DAGEs9J,EACd,GAAIA,EAAWt7J,eAAe3D,GAAQ,CAClC,IAAI/E,EAASgkK,EAAWj/J,GACxB,OAAQA,GACJ,IAAK,OACD,IAAI6jK,EAAYpiK,SAASC,cAAc,SACvCmiK,EAAU1mK,GAAKlE,KAAK2f,QAAQ,yBAC5BirJ,EAAU1+J,KAAO,WACjB0+J,EAAU7jK,MAAQ,OAClB6jK,EAAUviK,KAAO,QACjBuiK,EAAU/0J,SAAW7T,EAIjB4oK,EAAUv4J,iBACVu4J,EAAUv4J,iBAAiB,UAAU,SAAUpQ,GAC3C8I,EAAQ8/J,wBAAwB5oK,EACpC,IACO2oK,EAAUr4J,aACjBq4J,EAAUr4J,YAAY,YAAY,SAAUtQ,GACxC8I,EAAQ8/J,wBAAwB5oK,EACpC,IAEJsG,EAAIJ,YAAYyiK,GAEhB,IAAIE,EAAYtiK,SAASC,cAAc,SACvCqiK,EAAUpiK,UAAY,0BACtBoiK,EAAUp0J,QAAU1W,KAAK2f,QAAQ,yBACjCmrJ,EAAU34J,UAAY,SACtB5J,EAAIJ,YAAY2iK,GAChB,MAEJ,IAAK,SACD,IAAIC,EAAcviK,SAASC,cAAc,SACzCsiK,EAAY7mK,GAAKlE,KAAK2f,QAAQ,2BAC9BorJ,EAAY7+J,KAAO,WACnB6+J,EAAYhkK,MAAQ,SACpBgkK,EAAY1iK,KAAO,SACnB0iK,EAAYl1J,SAAW7T,EAInB+oK,EAAY14J,iBACZ04J,EAAY14J,iBAAiB,UAAU,SAAUpQ,GAC7C8I,EAAQ8/J,wBAAwB5oK,EACpC,IACO8oK,EAAYx4J,aACnBw4J,EAAYx4J,YAAY,YAAY,SAAUtQ,GAC1C8I,EAAQ8/J,wBAAwB5oK,EACpC,IAEJsG,EAAIJ,YAAY4iK,GAEhB,IAAIC,EAAcxiK,SAASC,cAAc,SACzCuiK,EAAYtiK,UAAY,0BACxBsiK,EAAYt0J,QAAU1W,KAAK2f,QAAQ,2BACnCqrJ,EAAY74J,UAAY,UACxB5J,EAAIJ,YAAY6iK,GAChB,MAEJ,IAAK,SACD,IAAIC,EAAcziK,SAASC,cAAc,SACzCwiK,EAAY/mK,GAAKlE,KAAK2f,QAAQ,2BAC9BsrJ,EAAY/+J,KAAO,WACnB++J,EAAYlkK,MAAQ,SACpBkkK,EAAY5iK,KAAO,QACnB4iK,EAAYp1J,SAAW7T,EAInBipK,EAAY54J,iBACZ44J,EAAY54J,iBAAiB,UAAU,SAAUpQ,GAC7C8I,EAAQ8/J,wBAAwB5oK,EACpC,IACOgpK,EAAY14J,aACnB04J,EAAY14J,YAAY,YAAY,SAAUtQ,GAC1C8I,EAAQ8/J,wBAAwB5oK,EACpC,IAEJsG,EAAIJ,YAAY8iK,GAEhB,IAAIC,EAAc1iK,SAASC,cAAc,SACzCyiK,EAAYxiK,UAAY,0BACxBwiK,EAAYx0J,QAAU1W,KAAK2f,QAAQ,2BACnCurJ,EAAY/4J,UAAY,QACxB5J,EAAIJ,YAAY+iK,GAG5B,CAGJ,OAAO3iK,CACX,EAWA4iK,8BAAgC,WAC5B,IAAIv2J,EAAQpM,SAASC,cAAc,SAMnC,OALAmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,iBACxB/K,EAAMlM,UAAY,8CAClBkM,EAAM1I,KAAO,SACb0I,EAAM7N,MAAQ,wBAEP6N,CACX,EAWAw2J,6BAA+B,WAC3B,IAAIziK,EAAO3I,KAEPqrK,EAAc7iK,SAASC,cAAc,UAazC,OAZA4iK,EAAYnnK,GAAKlE,KAAK2f,QAAQ,gBAC9B0rJ,EAAYl7J,MAAQ,+BACpBk7J,EAAY3iK,UAAY,sFACxB2iK,EAAYl7J,MAAQ,+BACpBk7J,EAAYpwJ,aAAa,WAAY,KACrCowJ,EAAYpwJ,aAAa,gBAAgB,GACzCowJ,EAAYh5J,iBAAiB,SAAS,SAAUpQ,GAC5C,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAK2iK,kBAAkBrpK,EAC3B,IAEOopK,CACX,G,8rDC/uCJ,IAAIhsK,EAAS2Q,EAAAA,EAAO1Q,UAAU,SAwE1BiiC,EAAK,SAAAp7B,GAYL,SAAAo7B,EAAa3hC,GAAS,IAAAyG,E,MAMlB,G,4FANkBC,CAAA,KAAAi7B,G,EAIlB,K,EAAA,CAHA3hC,EAAUA,GAAW,CAAC,G,MAGtB2hC,MAAAl7B,E,6EAEsBk7B,GAClB,MAAM,IAAIt9B,UAAU,2BAgBxB,OAVAoC,EAAKnB,UAAY,QAEjBmB,EAAK6jB,WAAWtqB,GAGhByG,EAAK8jB,WAAa9jB,EAAKigB,8BAGtBjgB,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAK8jB,YAAc9jB,EAAKG,QAAUH,EAAK8jB,WAEjFC,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAA26B,EAAAp7B,G,EAAAo7B,E,EAAA,EAAAz6B,IAAA,SAAAC,MAKA,SAAQd,GACJ,GAAIA,EAAK,CAML,GAJAjG,KAAKmqB,WAAanqB,KAAKsQ,eAAerK,GACtCjG,KAAKwG,QAAUxG,KAAKmqB,WAGhBnqB,KAAKJ,QAAO,OAAS,CACrB,IAAI6B,EAAOgP,EAAAA,EAAMiI,OAAO,CAAEgX,QAAU1vB,MAAQA,KAAKJ,QAAO,QACxDI,KAAI,OAAU,IAAI4vF,EAAAA,QAAanuF,GAC/BzB,KAAI,OAAQyG,SACZ,IAAIkC,EAAO3I,KACXA,KAAI,OAAQ+tB,GAAG,kBAAkB,SAAC9rB,GAC9B0G,EAAKs0C,cAAc,CACf/wC,KAAO,iBACPhM,QAAU+B,EAAE/B,SAEpB,GACJ,CAGIF,KAAK62C,WACL00H,EAAAA,EAAUhrE,YACNvgG,KAAKwrK,qBACLxrK,KAAKyrK,2BACLxlK,EAAIuoB,oBAKPxuB,KAAKq2D,WACNr2D,KAAK0rK,iBAAiBzwJ,aAAa,gBAAgB,EAE3D,C,iBAGAsmB,E,EAAA,S,EAAA,K,WAAA,G,kFAAA,CAAat7B,IAGTjG,KAAKJ,QAAQyE,UACbrE,KAAKi3D,YAAYj3D,KAAKJ,QAAQyE,WAIN,IAAxBrE,KAAKJ,QAAQs3D,QACbl3D,KAAKsiB,eAAegF,UAAUtG,IAAI,uBAE1C,GAAC,CAAAla,IAAA,eAAAC,MAWD,WACI,OAAO/G,KAAKq2D,SAChB,GAEA,CAAAvvD,IAAA,eAAAC,MAKA,SAAcsvD,QACQl2C,IAAdk2C,EAICA,GAAar2D,KAAKq2D,YAAgBA,IAAcr2D,KAAKq2D,YAGtDA,EACA7tD,SAASqL,eAAe,qBAAuB7T,KAAK4f,MAAMX,QAE1Djf,KAAK0rK,iBAAiBzsJ,QAE1Bjf,KAAKq2D,UAAYA,GAXbh3D,EAAOqD,IAAI,2DAYnB,GAEA,CAAAoE,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAK2rK,gBAChB,GAEA,CAAA7kK,IAAA,WAAAC,MAKA,SAAUyF,GACDA,EAKCA,aAAiBsuD,KAMvBtuD,EAAM8uB,SAASt7B,KAAK4rK,sBAEpB5rK,KAAK2rK,iBAAmBn/J,GAPpBnN,EAAOqD,IAAI,oDALX1C,KAAK2rK,iBAAmB,IAahC,GAEA,CAAA7kK,IAAA,aAAAC,MAKA,WACI,OAAOvD,KAAKqC,UAAU7F,KAAK6rK,eAC/B,GAEA,CAAA/kK,IAAA,aAAAC,MAKA,SAAY+kK,GACR,IACI9rK,KAAK6rK,eAAiBroK,KAAKC,MAAMqoK,EACrC,CAAE,MAAO7pK,GACL5C,EAAOqD,IAAI,2BAA6BT,EAAEH,QAC9C,CACJ,GAEA,CAAAgF,IAAA,UAAAC,MAKA,WAEI,IADA,IAAI4f,EAAS,GACJ1d,EAAQ,EAAGA,EAAQjJ,KAAK+rK,eAAe3qK,OAAQ6H,IAAS,CAC7D,IAAM+yC,EAAIh8C,KAAK+rK,eAAe9iK,GAC9B0d,EAAO/gB,KAAKo2C,EAAEgwH,gBAClB,CACA,IAAInsK,EAAO,CACPqM,KAAO,QACPya,OAASA,EACTy/I,UAAYpmK,KAAKisK,kBACjBjG,WAAahmK,KAAKksK,mBAClB/F,YAAcnmK,KAAKmsK,oBACnB7+I,QAAU,CAAC,GAGf,OADA7c,EAAAA,EAAMiI,OAAO7Y,EAAKytB,QAASttB,KAAKosK,2BACzBvsK,CACX,GAEA,CAAAiH,IAAA,UAAAC,MAUA,SAASlH,GAGLG,KAAKisK,kBAAoBpsK,EAAKumK,UAC9BpmK,KAAKmsK,oBAAsBtsK,EAAKsmK,YAChCnmK,KAAKksK,mBAAqBrsK,EAAKmmK,WAE/B,IAAK,IAAIp/I,EAAI,EAAGA,EAAI/mB,EAAK8mB,OAAOvlB,OAAQwlB,IAAK,CACzC,IAAMuQ,EAAIt3B,EAAK8mB,OAAOC,GAClBuQ,GACAn3B,KAAK+rK,eAAenlJ,GAAGylJ,cAAcl1I,EAAG,YAEhD,CAGA,IAAK,IAAI/hB,EAAI,EAAGA,EAAIpV,KAAK+rK,eAAe3qK,OAAQgU,IAAK,CACjD,IAAIhR,EAAQpE,KAAK+rK,eAAe32J,GAChC,GAAIhR,EAAM4nK,gBAAiB,CAKvB,IAAI9nK,EAAMkR,EAAI,EAAK,IAAMpV,KAAK4f,KAC1BsM,EAAa9nB,EAAM4nK,gBAAgB,GAAGt9I,QAAQ,GAAK,MAAQtqB,EAAM4nK,gBAAgB,GAAGt9I,QAAQ,GAChGlmB,SAASqL,eAAe,0BAA4B3P,GAAI6C,MAAQmlB,EAChE1jB,SAASqL,eAAe,oBAAsB3P,GAAI6C,MAAQmlB,EAEtD9W,EAAI,GAAKA,EAAI,IAEb5M,SAASqL,eAAe,mBAAqB3P,GAAIwE,UAAY,mDAErE,CACJ,CACA1I,KAAKosK,0BAA4BvsK,EAAKytB,OAC1C,GAEA,CAAAxmB,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKmqB,UAChB,GAEA,CAAArjB,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAK4rK,oBAChB,GAEA,CAAA9kK,IAAA,OAAAC,MAIA,WAOI,IAAK,IAAIkC,EAAQ,EAAGA,EAAQjJ,KAAK+rK,eAAe3qK,OAAQ6H,IAAS,CAC7D,IACI/E,EAAK+E,EAAQ,EACbijB,EAFUlsB,KAAK+rK,eAAe9iK,GAEX+iK,gBACnB9/I,IACY1jB,SAASqL,eAAe,oBAAsB3P,EAAK,IAAMlE,KAAK4f,MACpE7Y,MAAQmlB,EAAW,GAAGwC,QAAQ,GAAK,MAAQxC,EAAW,GAAGwC,QAAQ,GACnEzlB,EAAQ,GAAKA,EAAQ,IACrBT,SAASqL,eAAe,mBAAqB3P,EAAK,IAAMlE,KAAK4f,MAAMlX,UAAY,iDAG3F,CAGA,IAII4jK,EAJA3lJ,EAASne,SAASkB,uBAAuB,mBAAqB1J,KAAK4f,MACvE5f,KAAK6lK,oCAAoCl/I,GAIV,WAA3B3mB,KAAKisK,mBACLK,EAAe9jK,SAASqL,eAAe,8BAAgC7T,KAAK4f,SAExE0sJ,EAAaz2J,QAAU,SAG3By2J,EAAe9jK,SAASqL,eAAe,uBAAyB7T,KAAK4f,SAEjE0sJ,EAAaz2J,QAAU,QAK/B,IAAI02J,EAAiB/jK,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAC5E2sJ,IACAA,EAAexlK,MAAQ/G,KAAKmsK,qBAIhC,IAAIK,EAAYhkK,SAASqL,eAAe,yBAA2B7T,KAAK4f,MACpE4sJ,KACiD,IAA7CxsK,KAAKksK,mBAAmBzyJ,QAAQ,QAChC+yJ,EAAU32J,SAAU,EAEpB22J,EAAU32J,SAAU,GAI5B,IAAI42J,EAAcjkK,SAASqL,eAAe,2BAA6B7T,KAAK4f,MACxE6sJ,KACmD,IAA/CzsK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCgzJ,EAAY52J,SAAU,EAEtB42J,EAAY52J,SAAU,GAI9B,IAAI62J,EAAclkK,SAASqL,eAAe,2BAA6B7T,KAAK4f,MACxE8sJ,KACmD,IAA/C1sK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCizJ,EAAY72J,SAAU,EAEtB62J,EAAY72J,SAAU,GAI9B,IAAI7Q,EAAWhF,KAAKosK,0BAA0BzqI,cAC1C6K,EAAWxsC,KAAKosK,0BAA0B1qI,UAG1C0mI,EAAepoK,KAAK2sK,wBAAwB3sK,KAAKosK,0BAA0BvqI,mBAE3EumI,GACApoK,KAAK4sK,kCAAkC5nK,EAAUwnC,EAAU47H,GAI/DpoK,KAAK6sK,oBAAoBnkK,UAAY,kEACrC1I,KAAK8sK,wBACL9sK,KAAK+sK,uBAAuBrkK,UAAY,EAC5C,GAEA,CAAA5B,IAAA,QAAAC,MAGA,WACI/G,KAAKisK,kBAAoB,KACzBjsK,KAAKksK,mBAAqB,GAC1BlsK,KAAKmsK,oBAAsB,KAE3B,IAAK,IAAI/2J,EAAI,EAAGA,EAAIpV,KAAK+rK,eAAe3qK,OAAQgU,IAC5CpV,KAAK+rK,eAAe32J,GAAGlM,QAG3BlJ,KAAKgtK,4BACLhtK,KAAKitK,0BACLjtK,KAAKktK,4BAELltK,KAAKqwF,WAELrwF,KAAK6sK,oBAAoBnkK,UAAY,uCACrC1I,KAAK+sK,uBAAuBrkK,UAAY,4BAC5C,GAMA,CAAA5B,IAAA,aAAAC,MAMA,SAAYnH,GACRI,KAAKmtK,mBAAmBvtK,GAGxBI,KAAKJ,QAAU,CACXy2D,WAAY,EACZxf,WAAY,EACZ05C,QAAS,EACT7D,OAAS,CAAC,SAAU,WACpBs5E,WAAa,CACToH,MAAO,EACPC,QAAS,EACTC,QAAS,GAEbC,aAAe,CAAC,EAChB9iJ,oBAAsB,CAAC,EACvB21D,iBAAmB,CACfjwE,MAAQ,aACRxJ,YAAc,kCAKtB8J,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAASA,GAG3B,IAAI4tK,EAAqB,CACrBC,UAAY,CACRjuK,IAAMwsB,EAAAA,EAAa,IACnBriB,OAASqiB,EAAAA,EAAQC,eAErByhJ,OAAS,CACLluK,IAAMwsB,EAAAA,EAAqB,YAC3BriB,OAASqiB,EAAAA,EAAQC,eAErB0hJ,QAAU,CACNnuK,IAAMwsB,EAAAA,EAAoB,WAC1BriB,OAASqiB,EAAAA,EAAQC,gBAIzBjsB,KAAKJ,QAAQguK,YAAcn9J,EAAAA,EAAMiI,OAAO80J,EAAoB5tK,EAAQguK,aAGpE5tK,KAAKq2D,UAAYr2D,KAAKJ,QAAQy2D,UAG9Br2D,KAAK62C,UAAY72C,KAAKJ,QAAQi3C,UAE9B72C,KAAK4f,KAAO5f,KAAKJ,QAAQsE,IAAMwmB,EAAAA,EAAWxV,WAG1ClV,KAAK0rK,iBAAmB,KACxB1rK,KAAKwrK,qBAAuB,KAC5BxrK,KAAKyrK,2BAA6B,KAClCzrK,KAAK4uF,kBAAoB,KACzB5uF,KAAK6sK,oBAAsB,KAC3B7sK,KAAK+sK,uBAAyB,KAC9B/sK,KAAK6tK,4BAA8B,KAGnC7tK,KAAK+rK,eAAiB,GAGtB/rK,KAAKisK,kBAAoB,KACzBjsK,KAAK8tK,iBAGL9tK,KAAKmsK,oBAAsB,KAC3BnsK,KAAK+tK,mBAGL/tK,KAAKksK,mBAAqB,GAC1BlsK,KAAKguK,kBAGLhuK,KAAK6yF,UAAW,EAEhB7yF,KAAKiuK,OAAS,KAGdjuK,KAAKkuK,cAAgB,KAGrBluK,KAAK2rK,iBAAmB,KAGxB3rK,KAAK6rK,eAAiB,KAGtB7rK,KAAI,OAAU,KAGdA,KAAKmuK,cAAgB,KACrBnuK,KAAKouK,UAAYpuK,KAAKquK,gBAEtBruK,KAAKsuK,cAAgB,KAGrBtuK,KAAKuuK,0BAA4B,KACjCvuK,KAAKwuK,yBAA2B,KAGhCxuK,KAAK4rK,qBAAuB,IAAI37J,EAAAA,MAAM,CAClC8H,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,sBACRF,MAAQ,OAGhB9X,KAAKyuK,sBAAwB,IAAIx+J,EAAAA,MAAM,CACnC8H,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,sBACRF,MAAQ,OAShB9X,KAAKosK,0BAA4B,KASjCpsK,KAAK0rB,WAAa,CAAC,EAGnB1rB,KAAK2rB,YAAc,IACvB,GAEA,CAAA7kB,IAAA,qBAAAC,MAOA,SAAoBnH,GAGhB,GAAIA,EAAQ8sF,OAER,GAAIljF,MAAM4E,QAAQxO,EAAQ8sF,SAAW9sF,EAAQ8sF,OAAOtrF,OAChD,IAAK,IAAIgU,EAAI,EAAGA,EAAIxV,EAAQ8sF,OAAOtrF,OAAQgU,IACN,iBAAtBxV,EAAQ8sF,OAAOt3E,IACkB,WAApCxV,EAAQ8sF,OAAOt3E,GAAGrN,gBAClBnI,EAAQ8sF,OAAOt3E,GAAK,UAEgB,YAApCxV,EAAQ8sF,OAAOt3E,GAAGrN,gBAClBnI,EAAQ8sF,OAAOt3E,GAAK,aAGxB/V,EAAOqD,IAAI,qFACX9C,EAAQ8sF,OAAOt3E,GAAK,WAI5B/V,EAAOmU,KAAK,yCACZ5T,EAAQ8sF,OAAS,KAKC,SAAtB9sF,EAAQy2D,YACRz2D,EAAQy2D,WAAY,GAEE,UAAtBz2D,EAAQy2D,YACRz2D,EAAQy2D,WAAY,EAE5B,GAEA,CAAAvvD,IAAA,iBAAAC,MASA,SAAgBd,GAAK,IAAA6mB,EAAA,KAEbnlB,EAAY3H,KAAKmqB,WACrB,GAAIxiB,EAAU6nB,kBAAoB,EAC9B,OAAO7nB,EAGX,IAAIoyD,EAAQ/5D,KAAK0rK,iBAAmB1rK,KAAKklK,+BACzCv9J,EAAUQ,YAAY4xD,GAEtB,IAAI20G,EAAa1uK,KAAKwrK,qBAAuBxrK,KAAKolK,2BAC9CuJ,EAAgB3uK,KAAKqlK,8BACzBqJ,EAAWvmK,YAAYwmK,GAGvB,IAAIC,EAAc5uK,KAAKyrK,2BAA6BzrK,KAAKslK,iCACzDqJ,EAAcxmK,YAAYymK,GAG1B,IAAIC,EAAY7uK,KAAK6sK,oBAAsB7sK,KAAK2lK,+BAGhDkJ,EAAU1mK,YAAYnI,KAAKwpK,gDAAgDxpK,KAAKJ,QAAQ8sF,SAIxF,IADA,IAAI/lE,EAAS3mB,KAAK8uK,mCAAmC7oK,GAC5CmP,EAAI,EAAGA,EAAIuR,EAAOvlB,OAAQgU,IAC/By5J,EAAU1mK,YAAYwe,EAAOvR,IAGjCy5J,EAAU1mK,YAAYnI,KAAKiqK,iDAG3BjqK,KAAK6tK,4BAA8B7tK,KAAKwqK,yCACxCqE,EAAU1mK,YAAYnI,KAAK6tK,6BAC3B,IAAIkB,EAAY/uK,KAAK0qK,yCACrBqE,EAAU5mK,YAAYnI,KAAK2qK,6CAA6C3qK,KAAKJ,QAAQomK,aACrF6I,EAAU1mK,YAAY4mK,GAEtB,IAAIC,EAAchvK,KAAKwlK,iCAGvB,GAFAqJ,EAAU1mK,YAAY6mK,KAEjBjlK,EAAAA,EAAAA,KAAa,CACd,IAAIshK,EAAcrrK,KAAKorK,+BACvB4D,EAAY7mK,YAAYkjK,EAC5B,CAGA,IAAI4D,EAAejvK,KAAKmrK,gCACxB6D,EAAY7mK,YAAY8mK,GAExBN,EAAcxmK,YAAY0mK,GAG1B,IAAIK,EAAelvK,KAAK+sK,uBAAyB/sK,KAAKqmK,kCACtDsI,EAAcxmK,YAAY+mK,GAE1B,IAAIpzH,EAAS97C,KAAK0gF,iCAClBiuF,EAAcxmK,YAAY2zC,GAG1B,IAAIw1C,EAAUtxF,KAAK4uF,kBAAoB5uF,KAAK0mK,6BAS5C,OARAiI,EAAcxmK,YAAYmpF,GAE1B3pF,EAAUQ,YAAYumK,GAElB/mK,EAAU0K,kBACV1K,EAAU0K,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAKqiJ,6BAA6BltK,EAAE,IAG5E0F,CACX,GAMA,CAAAb,IAAA,iBAAAC,MAMA,WAEI/G,KAAKisK,kBAAoB,SAGzB,IAAI7F,EAAYpmK,KAAKJ,QAAQ8sF,OACxB05E,GAAkC,IAArBA,EAAUhlK,SACxBpB,KAAKJ,QAAQ8sF,OAAS,CAAC,SAAU,YAIjCljF,MAAM4E,QAAQg4J,IAAcA,EAAUhlK,SAEjB,YAAjBglK,EAAU,IAAqC,WAAjBA,EAAU,KACxCpmK,KAAKisK,kBAAoB7F,EAAU,KAK3C,IAAI34I,EAAiBztB,KAAKJ,QAAQ2tK,aAC9B9/I,EAAehpB,QACfzE,KAAKisK,kBAAoBx+I,EAAehpB,MAEhD,GAEA,CAAAqC,IAAA,mBAAAC,MAMA,WAEI/G,KAAKmsK,oBAAsB,UAG3B,IAAI1+I,EAAiBztB,KAAKJ,QAAQ2tK,aAC9B9/I,EAAeiH,kBACf10B,KAAKmsK,oBAAsB1+I,EAAeiH,gBAElD,GAEA,CAAA5tB,IAAA,kBAAAC,MAKA,WAEI/G,KAAKksK,mBAAqB,GAG1B,IAAI6C,EAAY/uK,KAAKJ,QAAQomK,WAU7B,KATK+I,GAAmC,WAArB30J,EAAO20J,IAA4D,IAAlC7tK,OAAOC,KAAK4tK,GAAW3tK,UACvEpB,KAAKJ,QAAQomK,WAAa,CACtBoH,MAAO,EACPC,QAAS,EACTC,QAAS,IAKbyB,GAAkC,WAArB30J,EAAO20J,IAA0B7tK,OAAOC,KAAK4tK,GAAW3tK,OACrE,IAAK,IAAIuE,KAAKopK,EACNA,EAAUrkK,eAAe/E,IACrBopK,EAAUppK,IACV3F,KAAKksK,mBAAmBtmK,KAAKD,GAO7C,IAAI8nB,EAAiBztB,KAAKJ,QAAQ2tK,aAC9B/jK,MAAM4E,QAAQqf,EAAeu4I,cAC7BhmK,KAAKksK,mBAAqBz+I,EAAeu4I,WAEjD,GAEA,CAAAl/J,IAAA,gBAAAC,MAOA,WACI,IAAIgE,EAAU/K,KACVwG,EAAUgC,SAASC,cAAc,OACrCjC,EAAQkC,UAAY,sBACpB,IAAI0mK,EAAS5mK,SAASC,cAAc,UAcpC,OAbA2mK,EAAO1mK,UAAY,2BAEnB0mK,EAAOC,QAAU,WAIb,OAH6B,MAAzBtkK,EAAQujK,eACRvjK,EAAQujK,cAAcr3G,iBAAY92C,IAE/B,CACX,EACAngB,KAAKmuK,cAAgB3lK,SAASC,cAAc,OAC5CzI,KAAKmuK,cAAczlK,UAAY,0BAC/BlC,EAAQ2B,YAAYnI,KAAKmuK,eACzB3nK,EAAQ2B,YAAYinK,GAEb5oK,CACX,GAMA,CAAAM,IAAA,qCAAAC,MASA,SAAoCd,GAChC,IAAI0gB,EAAS,GACTixD,EAAQ,EAGRhvD,EAAQ,IAAIqB,EAAAA,QAAiB,CAC7Bpe,OAAS7L,KAAKJ,QAAQiM,QAAU,KAChCgb,IAAM,CACF3iB,GAAK0zE,EACL1lE,MAAQ,SACRmY,QAAUrqB,KAAK4f,KACfmM,WAAa/rB,KAAKJ,QAAQguK,YAAuB,UACjD55J,SAAU,GAEdyW,oBAAsBzqB,KAAKJ,QAAQ6qB,qBAAuB,OAW9D,IATA7B,EAAM0mJ,OAAOrpK,GAGbjG,KAAKuvK,6BAA6B3mJ,GAClCjC,EAAO/gB,KAAK5F,KAAKylK,gCAAgC,WACjD9+I,EAAO/gB,KAAKgjB,EAAMuB,YAClBnqB,KAAK+rK,eAAenmK,KAAKgjB,GAGpBgvD,EAAQ,EAAGA,EAAQ,EAAGA,IAAS,CAChC,IAAIt8D,EAAO,IAAI2O,EAAAA,QAAiB,CAC5Bpe,OAAS7L,KAAKJ,QAAQiM,QAAU,KAChCgb,IAAM,CACF3iB,GAAK0zE,EACL1lE,MAAQ,UAAY0lE,EAAM,GAC1BvtD,QAAUrqB,KAAK4f,KACfmM,WAAa/rB,KAAKJ,QAAQguK,YAAoB,OAC9C55J,SAAU,EACVuW,cAAe,GAEnBE,oBAAsBzqB,KAAKJ,QAAQ6qB,qBAAuB,OAE9DnP,EAAKg0J,OAAOrpK,GACZjG,KAAKuvK,6BAA6Bj0J,GAClCqL,EAAO/gB,KAAK5F,KAAKylK,gCAAgC,SAAS,IAC1D9+I,EAAO/gB,KAAK0V,EAAK6O,YACjBnqB,KAAK+rK,eAAenmK,KAAK0V,EAC7B,CAGA,IAAIuN,EAAM,IAAIoB,EAAAA,QAAiB,CAC3Bpe,OAAS7L,KAAKJ,QAAQiM,QAAU,KAChCgb,IAAM,CACF3iB,GAAK0zE,EACL1lE,MAAQ,UACRmY,QAAUrqB,KAAK4f,KACfmM,WAAa/rB,KAAKJ,QAAQguK,YAAqB,QAC/C55J,SAAU,EACVsW,WAAY,GAEhBG,oBAAsBzqB,KAAKJ,QAAQ6qB,qBAAuB,OAQ9D,OANA5B,EAAIymJ,OAAOrpK,GACXjG,KAAKuvK,6BAA6B1mJ,GAClClC,EAAO/gB,KAAK5F,KAAKylK,gCAAgC,YACjD9+I,EAAO/gB,KAAKijB,EAAIsB,YAChBnqB,KAAK+rK,eAAenmK,KAAKijB,GAElBlC,CACX,GAEA,CAAA7f,IAAA,+BAAAC,MAMA,SAA8ByoK,GAAW,IAAAhiJ,EAAA,KAChCgiJ,IAIDA,EAAU3kJ,aAAaxY,kBAEvBm9J,EAAU3kJ,aAAaxY,iBACnB,SACA,SAACpQ,GAAC,OAAKurB,EAAKiiJ,wBAAwBxtK,EAAE,IAG1CutK,EAAUxkJ,kBAAkB3Y,iBACxB,SACA,SAACpQ,GAAC,OAAKurB,EAAKkiJ,0BAA0BztK,EAAGutK,EAAU,IAEnDA,EAAUrkJ,qBACVqkJ,EAAUrkJ,oBAAoB9Y,iBAC1B,SACA,SAACpQ,GACG5C,EAAOE,MAAM,+BAAgC0C,EAIjD,IAGJutK,EAAUtkJ,kBACVskJ,EAAUtkJ,iBAAiB7Y,iBACvB,SACA,SAACpQ,GACG5C,EAAOE,MAAM,4BAA6B0C,EAI9C,KAGDutK,EAAU3kJ,aAAatY,cAE9Bi9J,EAAU3kJ,aAAatY,YACnB,WACA,SAACtQ,GAAC,OAAKurB,EAAKiiJ,wBAAwBxtK,EAAE,IAE1CutK,EAAUxkJ,kBAAkBzY,YACxB,WACA,SAACtQ,GAAC,OAAKurB,EAAKkiJ,0BAA0BztK,EAAGutK,EAAU,IAEnDA,EAAUrkJ,qBACVqkJ,EAAUrkJ,oBAAoB5Y,YAC1B,WACA,SAACtQ,GAGG,IAIRutK,EAAUtkJ,kBACVskJ,EAAUtkJ,iBAAiB3Y,YACvB,WACA,SAACtQ,GAGG,KAKpB,GAMA,CAAA6E,IAAA,2BAAAC,MAOA,SAA0BnH,GACtBP,EAAOqD,IAAI,2BAA4B9C,GASvC,IAGIgpB,EAWAC,EAdAlC,EAAS3mB,KAAK+rK,eAIlB,GAAIplJ,EAAO,IAAMA,EAAO,GAAGqlJ,cAAe,CACtC,IAAI2D,EAAkBhpJ,EAAO,GAAGqlJ,gBAChCpjJ,EAAQ,CACJtjB,EAAIqqK,EAAgB,GACpBpqK,EAAIoqK,EAAgB,IAExBtwK,EAAOqD,IAAI,QAASkmB,EACxB,CAIA,IAAI0L,EAAW3N,EAAOA,EAAOvlB,OAAS,GACtC,GAAIkzB,GAAYA,EAAS03I,cAAe,CACpC,IAAI4D,EAAgBt7I,EAAS03I,gBAC7BnjJ,EAAM,CACFvjB,EAAIsqK,EAAc,GAClBrqK,EAAIqqK,EAAc,IAEtBvwK,EAAOqD,IAAI,MAAOmmB,EACtB,CAIA,IADA,IAAIvN,EAAO,GACFlG,EAAI,EAAGA,EAAIuR,EAAOvlB,OAAS,EAAGgU,IACnC,GAAIuR,EAAOvR,IAAMuR,EAAOvR,GAAG42J,cAAe,CACtC,IAAI6D,EAAclpJ,EAAOvR,GAAG42J,gBAC5B,GAAI6D,EAAa,CACb,IAAI3jJ,EAAa,CACb5mB,EAAIuqK,EAAY,GAChBtqK,EAAIsqK,EAAY,IAEpBxwK,EAAOqD,IAAI,OAAQwpB,GACnB5Q,EAAK1V,KAAKsmB,EACd,CACJ,CAIJlsB,KAAKisK,kBAAoBrsK,EAAQwmK,UACjCpmK,KAAKmsK,oBAAsBvsK,EAAQumK,YACnCnmK,KAAKksK,mBAAqBtsK,EAAQomK,WAGlC,IAKI8J,EALAvC,EAAevtK,KAAKJ,QAAQ2tK,aAM3BA,EAAappK,SAKd2rK,EAAgBvC,EAAappK,SAJI,YAA7BnE,KAAKmsK,qBAAgE,WAA3BnsK,KAAKisK,oBAC/C6D,EAAgB,mBAQxB,IAAIC,EAAYxC,EAAapjK,UAAY,MACrC6lK,EAAWzC,EAAaztK,SAAW,EACrB,UAAdiwK,GAAsC,IAAbC,IAEzBA,EAAW,MAIf,IAAIt9E,IAA2C,OAA3B66E,EAAa5sK,WAAwD,mBAA3B4sK,EAAa5sK,WACvEgyF,IAA2C,OAA3B46E,EAAa9iK,WAAwD,mBAA3B8iK,EAAa9iK,WAGvEM,EAAU/K,KACdA,KAAKiwK,gBAAgB,CACjB57I,WAAazL,EACb0L,SAAWzL,EACX2L,UAAYlZ,EACZ7W,MAAQ8oK,EAAa9oK,OAASzE,KAAKisK,kBACnCv3I,gBAAkB64I,EAAa74I,iBAAmB10B,KAAKmsK,oBACvDnG,WAAauH,EAAavH,YAAchmK,KAAKksK,mBAC7Cz/H,wBAAyB,EACzB5nC,aAAe,IACf/E,QAAUkwK,EACV7lK,SAAW4lK,EACX5rK,SAAW2rK,EAEXrlK,UAAY,SAAU6iB,GAClBjuB,EAAOqD,IAAI4qB,GACPA,GACAviB,EAAQmlK,yBAAyB5iJ,GAEjCqlE,GACA46E,EAAa9iK,UAAUtL,KAAK4L,EAASuiB,EAE7C,EAEA3sB,UAAY,SAAUD,GAClBqK,EAAQ+hK,wBACR/hK,EAAQmiK,4BACR7tK,EAAOqD,IAAIhC,EAAMoB,SACb4wF,GACA66E,EAAa5sK,UAAUxB,KAAK4L,EAASrK,EAE7C,GAER,GAEA,CAAAoG,IAAA,0BAAAC,MAOA,WACI/G,KAAK6sK,oBAAoBnkK,UAAY,wDAWrCmkB,EAAAA,EAAAA,SAAoB7sB,KAAK2rB,aACzB3rB,KAAKi9C,cAAc,gBACvB,GAEA,CAAAn2C,IAAA,4BAAAC,MAQA,SAA2B9E,EAAGkuK,GAAkB,IAAA/hJ,EAAA,KACxCnoB,EAAMjG,KAAKiH,SACXkpK,EAAiBplJ,2BAA2BlV,SAE5C7V,KAAK6sK,oBAAoBnkK,UAAY,uDACrCzG,EAAEc,OAAOsT,cAAcA,cAAciR,UAAUtG,IAAI,YAEnDhhB,KAAK2rB,YAAc1lB,EAAI8nB,GACnB,SACA,WACI9rB,EAAEc,OAAOsT,cAAcA,cAAciR,UAAU7K,OAAO,YAEX,yDAAvC2R,EAAKy+I,oBAAoBnkK,YACzB0lB,EAAKy+I,oBAAoBnkK,UAAY,yCAEzCmkB,EAAAA,EAAAA,SAAoBuB,EAAKzC,aAMzByC,EAAK6uB,cAAc,gBACvB,IAOJj9C,KAAKi9C,cAAc,qBAGnBj9C,KAAK6sK,oBAAoBnkK,UAAY,IAWrCmkB,EAAAA,EAAAA,SAAoB7sB,KAAK2rB,aACzB3rB,KAAKi9C,cAAc,iBAE3B,GAEA,CAAAn2C,IAAA,wBAAAC,MAQA,SAAuB9E,GACnB,IAAI+4D,EAASh7D,KAAK0rK,iBAAiBhjJ,YACpB,SAAXsyC,GACAh7D,KAAKgoC,cAET,IAAI/hC,EAAMjG,KAAKiH,SAEf43E,EAAAA,EAAalnD,MAAM1xB,GAEdjG,KAAK2rK,kBAAqB3rK,KAAK6yF,UAChC7yF,KAAKowK,SAETpwK,KAAKq2D,YAAyB,SAAX2E,GAGnBh7D,KAAKi9C,cAAc,oBAGfj9C,KAAKJ,QAAQyE,WAAarE,KAAKq2D,WAC/Br2D,KAAKi7D,eAAej7D,KAAKJ,QAAQyE,SAEzC,GAEA,CAAAyC,IAAA,+BAAAC,MAQA,SAA8B9E,GAC1B,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MAEhBA,IAIL1H,EAAOqD,IAAIqE,GACX/G,KAAKmsK,oBAAsBplK,EAC/B,GAEA,CAAAD,IAAA,qCAAAC,MASA,SAAoC9E,GAEhCjC,KAAKmqK,6BAA6BloK,GAGlCjC,KAAKktK,4BACLltK,KAAKqwK,6BACLrwK,KAAKswK,oCAGLtwK,KAAKkmK,yBAAyB,CAC1BC,YAAcnmK,KAAKmsK,oBACnB/F,UAAYpmK,KAAKisK,kBACjBjG,WAAahmK,KAAKksK,oBAE1B,GAEA,CAAAplK,IAAA,6BAAAC,MAQA,SAA4B9E,GACxB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MAChBA,IAGL/G,KAAKisK,kBAAoBllK,EAC7B,GAEA,CAAAD,IAAA,6BAAAC,MAOA,SAA4B9E,GACxB5C,EAAOqD,IAAI,6BAA8BT,EAE7C,GAEA,CAAA6E,IAAA,0BAAAC,MASA,SAAyB9E,GACrB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MACjB8O,EAAU5T,EAAEc,OAAO8S,QAEvB,GAAK9O,GAA2B,iBAAVA,EAAtB,CAGAA,EAAQA,EAAMgB,cAId,IAFA,IAAI4Q,GAAS,EACT43J,EAAS,KACJn7J,EAAI,EAAGA,EAAIpV,KAAKksK,mBAAmB9qK,OAAQgU,IAC5CpV,KAAKksK,mBAAmB92J,KAAOrO,IAC/BwpK,EAASn7J,EACTuD,GAAS,GAKZA,GAAW9C,GACZ7V,KAAKksK,mBAAmBtmK,KAAKmB,GAG7B4R,GAAU9C,GACV7V,KAAKksK,mBAAmBnmI,OAAOwqI,EAAQ,EAlB3C,CAoBJ,GAEA,CAAAzpK,IAAA,oBAAAC,MAOA,WAGI,IADA,IAAIypK,EAAgBxwK,KAAK+rK,eAChB32J,EAAI,EAAGA,EAAIo7J,EAAcpvK,OAAQgU,IACtCo7J,EAAcp7J,GAAGlM,QAIrBlJ,KAAKowK,SAELpwK,KAAKitK,yBACT,GAEA,CAAAnmK,IAAA,6BAAAC,MAOA,WAEI/G,KAAKktK,4BACLltK,KAAKqwK,6BACLrwK,KAAKswK,oCAMLtwK,KAAKi9C,cAAc,mBACvB,GAEA,CAAAn2C,IAAA,iCAAAC,MAQA,SAAgC9E,GAE5B,IAAIwuK,EAAQxuK,EAAEc,OAAOmB,GACjBshB,EAAMirJ,EAAM35J,UAAU25J,EAAMh3J,QAAQ,KAAO,GAG3CxX,EAAEc,OAAOukB,WACTrlB,EAAEc,OAAOukB,UAAUtG,IAAI,6CAGtBhhB,KAAK2rK,kBAKF3rK,KAAK2rK,iBAAiB5uG,YAAY2zG,eAAe/oJ,SAASnC,EAAK,KAErE8V,SAASt7B,KAAKyuK,sBACpB,GAEA,CAAA3nK,IAAA,gCAAAC,MAQA,SAA+B9E,GAE3B,IAAIwuK,EAAQxuK,EAAEc,OAAOmB,GACjBshB,EAAMirJ,EAAM35J,UAAU25J,EAAMh3J,QAAQ,KAAO,GAG3CxX,EAAEc,OAAOukB,WACTrlB,EAAEc,OAAOukB,UAAU7K,OAAO,6CAGzBzc,KAAK2rK,kBAIF3rK,KAAK2rK,iBAAiB5uG,YAAY2zG,eAAe/oJ,SAASnC,EAAK,KAErE8V,SAAS,KACf,GAMA,CAAAx0B,IAAA,kBAAAC,MASA,SAAiBnH,IAERA,GAA+B,WAAnBwa,EAAOxa,IAAwD,IAAhCsB,OAAOC,KAAKvB,GAASwB,QAMhExB,EAAQy0B,YAIRz0B,EAAQ00B,WAMb10B,EAAQiM,OAAS7L,KAAKJ,QAAQ2tK,aAAa1hK,QAAU7L,KAAKJ,QAAQiM,OAIvC,kBAAhBjM,EAAQwK,MACiB,kBAArBpK,KAAKJ,QAAQwK,IACpBxK,EAAQwK,IAAMpK,KAAKJ,QAAQwK,IAE3BxK,EAAQwK,KAAM,GAGtB/K,EAAOqD,IAAI9C,GAGXI,KAAK2wK,2BAGLthJ,EAAAA,GAAGC,SAASuX,MAAMjnC,GACtB,GAEA,CAAAkH,IAAA,2BAAAC,MASA,SAA0BumB,GAEtB,IAAItoB,EAAWsoB,EAAQqU,cACnB6K,EAAWlf,EAAQoU,UAEnB0mI,EAAepoK,KAAK2sK,wBAAwBr/I,EAAQuU,mBAGpDumI,GACApoK,KAAK4sK,kCAAkC5nK,EAAUwnC,EAAU47H,GAK/D,IAAIz5J,EAAW2e,EAAQsU,cACnBjzB,GACA3O,KAAK4wK,iCAAiCjiK,EAAU3O,KAAK4rK,sBAIrDxD,GAAgBA,EAAa,GAAGz5J,UAChC3O,KAAK6wK,wCAAwCzI,EAAcpoK,KAAK4rK,sBAIpE,IAAIrnJ,EAAO+I,EAAQ/I,KACnB,GAAIA,EAAM,CACN,IAAIte,EAAMjG,KAAKiH,SACX6pK,EAAS,CAACvsJ,EAAKlb,KAAMkb,EAAKnb,OAAQmb,EAAKjb,MAAOib,EAAKpb,KAEnD+kB,EAAUjoB,EAAImmB,UAAUC,gBAAgBC,UAC5B,cAAZ4B,IACA4iJ,GAAS5yG,EAAAA,EAAAA,iBAAsB4yG,EAAQ,YAAa5iJ,IAExDjoB,EAAImmB,UAAU+xC,IAAI2yG,EAAQ7qK,EAAIm4D,UAClC,CAGAp+D,KAAKosK,0BAA4B9+I,EAajCttB,KAAKi9C,cAAc,CACf/wC,KAAO,kBAIXlM,KAAK6sK,oBAAoBnkK,UAAY,kEACrC1I,KAAK8sK,wBACL9sK,KAAK+sK,uBAAuBrkK,UAAY,EAC5C,GAEA,CAAA5B,IAAA,oCAAAC,MAWA,SAAmC/B,EAAUwnC,EAAU47H,GAEnDpoK,KAAK+wK,6BAA+B/wK,KAAKqnK,8BAA8BriK,EAAUwnC,EAAUmC,EAAAA,EAAUmC,sBAGrG9wC,KAAKgxK,8BAAgChxK,KAAKmoK,+BAA+BC,EAAcz5H,EAAAA,EAAUmC,qBACrG,GAEA,CAAAhqC,IAAA,mCAAAC,MAQA,SAAkC4H,EAAU1P,GACxCe,KAAKqwK,6BAEL,IAAIpqK,EAAMjG,KAAKiH,SAEf,GAAK0H,EAAL,CAKA,IAAIsiK,EAAgB,CAChB/kK,KAAO,oBACP2jF,SAAW,CACP,CACI3jF,KAAO,UACP5H,IAAM,CACF4H,KAAO,OACPglK,WAAa,CACT7oK,KAAO,cAGfsG,SAAWA,KAUnBkhF,EALgB,IAAIE,EAAAA,EAAgB,CACpCohF,sBAAwB,YACxBx2I,aAAe17B,IAGUmyK,aACzBH,EAAe,CACXhhF,eAAiB,YACjBC,kBAAoB,cAK5BlwF,KAAKkuK,cAAgB,IAAIpzG,IAAJ,CAAgB,CACjCl+C,OAAS,IAAIsjE,IAAJ,CAAiB,CACtB2P,SAAWA,IAEf5wF,MAAQA,EACRkR,MAAQ,mBAEZlK,EAAI4wD,SAAS72D,KAAKkuK,cAvClB,CAwCJ,GAEA,CAAApnK,IAAA,0CAAAC,MAQA,SAAyCqhK,EAAcnpK,GAAO,IAAAw8D,EAAA,KAC1Dz7D,KAAKswK,oCAEL,IAAIrqK,EAAMjG,KAAKiH,SAGfjH,KAAK6rK,eAAiB,CAClB3/J,KAAO,oBACP5H,IAAM,CACF4H,KAAO,OACPglK,WAAa,CACT7oK,KAAO,cAGfwnF,SAAW,IAIf,IAAK,IAAIz6E,EAAI,EAAGA,EAAIgzJ,EAAahnK,OAAQgU,IAAK,CAK1C,IAJA,IAAIwO,EAAIwkJ,EAAahzJ,GACjBlR,EAAKkR,EAAI,EAETi8J,EAASztJ,EAAEjV,SAASujF,YACftrE,EAAI,EAAGA,EAAIyqJ,EAAOjwK,OAAQwlB,IAEH,iBAAjByqJ,EAAOzqJ,GAAG,KACjByqJ,EAAOzqJ,GAAG,GAAK0kB,WAAW+lI,EAAOzqJ,GAAG,IACpCyqJ,EAAOzqJ,GAAG,GAAK0kB,WAAW+lI,EAAOzqJ,GAAG,KAI5C5mB,KAAK6rK,eAAeh8E,SAASjqF,KAAK,CAC9BsG,KAAO,UACPyC,SAAWiV,EAAEjV,SACbuiK,WAAa,CACTI,aAAe,IAAMptK,EAAK,gBAAkByqC,EAAAA,EAAUsC,gBAAgBrtB,EAAE5e,UACpE,cAAgB2pC,EAAAA,EAAUmC,qBAAqBltB,EAAE4oB,WAEzDtoC,GAAKA,GAEb,CAGAlE,KAAK6rK,eAAeh8E,SAASjqF,KAAK,CAC9BsG,KAAO,UACPyC,SAAW,CACPzC,KAAO,QACPgmF,YAAclyF,KAAK+rK,eAAe,GAAGC,iBAEzCkF,WAAa,CACTvqK,YAAc,kBACd,gBAAkB3G,KAAKJ,QAAQguK,YAAYH,UAAUjuK,OAK7D,IAAK,IAAImG,EAAI,EAAGA,EAAI3F,KAAK+rK,eAAe3qK,OAAS,EAAGuE,IAChD,GAAI3F,KAAK+rK,eAAepmK,IAAM3F,KAAK+rK,eAAepmK,GAAGqmK,cAAe,CAChE,IAAI95E,EAAclyF,KAAK+rK,eAAepmK,GAAGqmK,gBACrC95E,GACAlyF,KAAK6rK,eAAeh8E,SAASjqF,KAAK,CAC9BsG,KAAO,UACPyC,SAAW,CACPzC,KAAO,QACPgmF,YAAcA,GAElBg/E,WAAa,CACTvqK,YAAc,gBACd,gBAAkB3G,KAAKJ,QAAQguK,YAAYF,OAAOluK,MAIlE,CAIJQ,KAAK6rK,eAAeh8E,SAASjqF,KAAK,CAC9BsG,KAAO,UACPyC,SAAW,CACPzC,KAAO,QACPgmF,YAAclyF,KAAK+rK,eAAe/rK,KAAK+rK,eAAe3qK,OAAS,GAAG4qK,iBAEtEkF,WAAa,CACTvqK,YAAc,kBACd,gBAAkB3G,KAAKJ,QAAQguK,YAAYD,QAAQnuK,OAK3D,IAsBIiF,EAtBA8sK,EAAgB,IAAIxhF,EAAAA,EAAgB,CACpCohF,sBAAwB,YACxBx2I,aAAe17B,IAEfivB,EAAUluB,KAAKiH,SAASmlB,UAAUC,gBAAgBC,UAClDujE,EAAW0hF,EAAcH,aACzBpxK,KAAK6rK,eAAgB,CACjB57E,eAAiB,YACjBC,kBAAoBhiE,IAK5BluB,KAAK2rK,iBAAmB,IAAI7wG,IAAJ,CAAgB,CACpCl+C,OAAS,IAAIsjE,IAAJ,CAAiB,CACtB2P,SAAWA,IAEf5wF,MAAQA,EACRgZ,QAAU,GACV9H,MAAQ,mBAImB,WAA3BnQ,KAAKisK,mBACLxnK,EAAQ,SACRzE,KAAK2rK,iBAAiBluG,gBAAkB,yCAExCh5D,EAAQ,UACRzE,KAAK2rK,iBAAiBluG,gBAAkB,yCAG5Cx3D,EAAI4wD,SAAS72D,KAAK2rK,kBAGlB1lK,EAAIk6E,cAAcv2E,SACd,SAAC8lB,GACG,GAAIA,aAAmBymC,EAAAA,QAAe,CAElC,IAAIrC,EAAU2H,EAAKkwG,iBAAiBh1G,UAEhCjnC,EAAQtO,QAAQ0yC,GAAS3jD,QAAU2jD,GACnCpkC,EAAQmnC,SACJ4E,EAAKkwG,iBAAkB,CACnBx7J,MAAQsrD,EAAK77D,QAAQwgF,iBAAiBjwE,MAAQ,KAAO1L,EAAQ,IAC7DkC,YAAc80D,EAAK77D,QAAQwgF,iBAAiBz5E,aAI5D,CACJ,GACA3G,MAKJA,KAAKwuK,yBAA2B,IAAIhkI,EAAAA,OAAkB,CAClDo1C,UAAY4xF,EAAAA,YACZ9xJ,OAAS,CAAC1f,KAAK2rK,kBACf1sK,MAAQe,KAAKyuK,wBAEjBzuK,KAAKwuK,yBAAyBzgJ,GAC1B,UACA,SAAC9rB,GAAC,OAAKw5D,EAAKg2G,2BAA2BxvK,EAAE,IAE7CgE,EAAI+5E,eAAehgF,KAAKwuK,0BAGxBxuK,KAAKuuK,0BAA4B,IAAI/jI,EAAAA,OAAkB,CACnD9qB,OAAS,CAAC1f,KAAK2rK,kBACf1sK,MAAQe,KAAKyuK,wBAEjBzuK,KAAKuuK,0BAA0BxgJ,GAC3B,UACA,SAAC9rB,GAAC,OAAKw5D,EAAKi2G,wBAAwBzvK,EAAE,IAE1CgE,EAAI+5E,eAAehgF,KAAKuuK,0BAC5B,GAEA,CAAAznK,IAAA,6BAAAC,MAQA,SAA4B9E,GACxB,GAA0B,IAAtBA,EAAEyT,SAAStU,OAAc,CAEzB,IAAIk5B,EAAIr4B,EAAEyT,SAAS,GACfi8J,EAAsBnpK,SAASqL,eAAe,oCAAsCymB,EAAEs3I,QAAU,IAAM5xK,KAAK4f,MAC3G+xJ,GAAuBA,EAAoBrqJ,WAC3CqqJ,EAAoBrqJ,UAAUtG,IAAI,4CAE1C,CAGA,GAA4B,IAAxB/e,EAAE4vK,WAAWzwK,OAAc,CAC3B,IAAI0wK,EAAoB7vK,EAAE4vK,WAAW,GAEjCE,EAAwBvpK,SAASqL,eAAe,oCAAsCi+J,EAAkBF,QAAU,IAAM5xK,KAAK4f,MAC7HmyJ,GAAyBA,EAAsBzqJ,WAC/CyqJ,EAAsBzqJ,UAAU7K,OAAO,4CAE/C,CACJ,GAEA,CAAA3V,IAAA,0BAAAC,MAOA,SAAyB9E,GACrB,IAAIgE,EAAMjG,KAAKiH,SACf,GAA0B,IAAtBhF,EAAEyT,SAAStU,OAAc,CAEzB,IAAIk5B,EAAIr4B,EAAEyT,SAAS,GACnB1V,KAAKmuK,cAAch8J,UAAYmoB,EAAEoQ,gBAAgB4mI,aAE5CtxK,KAAKsuK,cAUNtuK,KAAKsuK,cAAcr3G,YAAYh1D,EAAE+vK,gBAAgB9lJ,aARjDlsB,KAAKsuK,cAAgB,IAAIv/I,IAAJ,CAAY,CAC7BvoB,QAAUxG,KAAKouK,UACf/uF,YAAc,gBACdh7E,SAAWpC,EAAE+vK,gBAAgB9lJ,aAEjCjmB,EAAIgpB,WAAWjvB,KAAKsuK,eAK5B,MAG8B,MAAtBtuK,KAAKsuK,eACLtuK,KAAKsuK,cAAcr3G,iBAAY92C,EAG3C,GAMA,CAAArZ,IAAA,SAAAC,MAMA,WACI/G,KAAKisK,kBAAoB,KACzBjsK,KAAKksK,mBAAqB,GAC1BlsK,KAAKmsK,oBAAsB,KAG3BnsK,KAAKktK,4BAELltK,KAAKqwK,6BACLrwK,KAAKswK,oCAEL,IAAK,IAAIl7J,EAAI,EAAGA,EAAIpV,KAAK+rK,eAAe3qK,OAAQgU,IAC5CpV,KAAK+rK,eAAe32J,GAAGlM,QAG3BlJ,KAAKgtK,2BACT,GAEA,CAAAlmK,IAAA,0BAAAC,MAMA,WAOI,IAAIulK,EALJtsK,KAAK8tK,iBACL9tK,KAAK+tK,mBACL/tK,KAAKguK,kBAI0B,WAA3BhuK,KAAKisK,mBACLK,EAAe9jK,SAASqL,eAAe,8BAAgC7T,KAAK4f,SAExE0sJ,EAAaz2J,QAAU,SAG3By2J,EAAe9jK,SAASqL,eAAe,uBAAyB7T,KAAK4f,SAEjE0sJ,EAAaz2J,QAAU,QAK/B,IAAI02J,EAAiB/jK,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAC5E2sJ,IACAA,EAAexlK,MAAQ/G,KAAKmsK,qBAIhC,IAAIK,EAAYhkK,SAASqL,eAAe,yBAA2B7T,KAAK4f,MACpE4sJ,KACiD,IAA7CxsK,KAAKksK,mBAAmBzyJ,QAAQ,QAChC+yJ,EAAU32J,SAAU,EAEpB22J,EAAU32J,SAAU,GAI5B,IAAI42J,EAAcjkK,SAASqL,eAAe,2BAA6B7T,KAAK4f,MACxE6sJ,KACmD,IAA/CzsK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCgzJ,EAAY52J,SAAU,EAEtB42J,EAAY52J,SAAU,GAI9B,IAAI62J,EAAclkK,SAASqL,eAAe,2BAA6B7T,KAAK4f,MACxE8sJ,KACmD,IAA/C1sK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCizJ,EAAY72J,SAAU,EAEtB62J,EAAY72J,SAAU,EAGlC,GAEA,CAAA/O,IAAA,4BAAAC,MAMA,WACI,IAAI4f,EAASne,SAASilD,iBAAiB,8BACvC,GAAsB,IAAlB9mC,EAAOvlB,OAAc,CAErB,IADA,IAAI6wK,EAAa,GACRtsK,EAAI,EAAGA,EAAIghB,EAAOvlB,OAAQuE,KACU,IAArCghB,EAAOhhB,GAAGzB,GAAGuV,QAAQzZ,KAAK4f,OAC1BqyJ,EAAWrsK,KAAK+gB,EAAOhhB,IAI/B,IAAK,IAAIyP,EAAI,EAAGA,EAAK68J,EAAW7wK,OAAS,EAAIgU,IAAK,CAE9C,IAAIkS,EAAY2qJ,EAAW78J,GAAGkS,UAC9B,GAAyB,IAArBA,EAAUlmB,OACV,IAAK,IAAIwlB,EAAI,EAAGA,EAAIU,EAAUlmB,OAAQwlB,IACb,6BAAjBU,EAAUV,IAEVpe,SAASqL,eAAe7T,KAAK2f,QAAQ,0BAA4BvK,EAAI,KAAK6J,OAI1F,CACJ,CACJ,GAEA,CAAAnY,IAAA,4BAAAC,MAMA,WAKI,GAJA/G,KAAKosK,0BAA4B,KAI7BpsK,KAAKgxK,8BAA+B,CACpC,IAAIkB,EAAalyK,KAAKgxK,8BACtB,GAAIkB,EAAW1iJ,kBACX,KAAO0iJ,EAAWhjJ,YACdgjJ,EAAW/iJ,YAAY+iJ,EAAWhjJ,WAG9C,CAEA,GAAIlvB,KAAK+wK,6BAA8B,CACnC,IAAIoB,EAAYnyK,KAAK+wK,6BACrB,GAAIoB,EAAU3iJ,kBACV,KAAO2iJ,EAAUjjJ,YACbijJ,EAAUhjJ,YAAYgjJ,EAAUjjJ,WAG5C,CACJ,GAEA,CAAApoB,IAAA,6BAAAC,MAMA,WACI,IAAId,EAAMjG,KAAKiH,SAEW,MAAtBjH,KAAKkuK,gBACLjoK,EAAI8wD,YAAY/2D,KAAKkuK,eACrBluK,KAAKkuK,cAAgB,KAE7B,GAEA,CAAApnK,IAAA,oCAAAC,MAMA,WACI,IAAId,EAAMjG,KAAKiH,SAGc,MAAzBjH,KAAK2rK,mBACL1lK,EAAI8wD,YAAY/2D,KAAK2rK,kBACrB3rK,KAAK2rK,iBAAmB,KACxB3rK,KAAK6rK,eAAiB,MAGA,MAAtB7rK,KAAKsuK,gBACLroK,EAAI4oB,cAAc7uB,KAAKsuK,eACvBtuK,KAAKsuK,cAAgB,MAGa,MAAlCtuK,KAAKuuK,4BACLtoK,EAAIk5E,kBAAkBn/E,KAAKuuK,2BAC3BvuK,KAAKuuK,0BAA4B,MAEA,MAAjCvuK,KAAKwuK,2BACLvoK,EAAIk5E,kBAAkBn/E,KAAKwuK,0BAC3BxuK,KAAKwuK,yBAA2B,KAExC,GAEA,CAAA1nK,IAAA,+BAAAC,MAQA,SAA8B9E,GAE1B,GAAIA,EAAEc,QAAUd,EAAEc,OAAOmB,KAAoD,IAA9CjC,EAAEc,OAAOmB,GAAGuV,QAAQ,qBAI/C,IAFA,IAAI24J,EAAUzqJ,SAAS1lB,EAAEc,OAAOmB,GAAG0U,MAAM,KAAK,GAAG,GAAI,IAAM,EAElDgO,EAAI,EAAGA,EAAI5mB,KAAK+rK,eAAe3qK,OAAQwlB,IACxCA,IAAMe,SAASyqJ,EAAS,KACxBpyK,KAAK+rK,eAAenlJ,GAAG+F,8BAK/B,IAAK,IAAIvX,EAAI,EAAGA,EAAIpV,KAAK+rK,eAAe3qK,OAAQgU,IAC5CpV,KAAK+rK,eAAe32J,GAAGuX,wBAGnC,GAEA,CAAA7lB,IAAA,2BAAAC,MAKA,WACI/G,KAAK4uF,kBAAkBlmF,UAAY,gFACnC1I,KAAK6yF,UAAW,EAKhB,IAAIpxF,EAAOzB,KAAKJ,QAAQ2tK,aACxB,GAAI9rK,GAAQA,EAAK3B,QAAS,CAClBE,KAAKiuK,SACLnrK,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,MAElB,IAAIljK,EAAU/K,KACdA,KAAKiuK,OAAS3rK,YAAW,YACI,IAArByI,EAAQ8nF,SACR9nF,EAAQ+hK,wBAEJ/hK,EAAQkjK,QACRnrK,aAAaiI,EAAQkjK,OAGjC,GAAG,KACP,CACJ,GAEA,CAAAnnK,IAAA,wBAAAC,MAKA,WACI,GAAI/G,KAAK6yF,SAAU,CACf7yF,KAAK4uF,kBAAkBlmF,UAAY,8EACnC1I,KAAK6yF,UAAW,EAChB,IAAIpxF,EAAOzB,KAAKJ,QAAQ2tK,aACpB9rK,GAAQA,EAAK3B,UACbgD,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,KAEtB,CACJ,GAMA,CAAAnnK,IAAA,0BAAAC,MASA,SAAyBqhK,GACrB,IAAIiK,EAAkB,GAGlB3qJ,EAAU0gJ,EAAa,GACC,IAAxBA,EAAahnK,QACbixK,EAAgBzsK,KAAK8hB,GAGzB,IAAK,IAAItS,EAAI,EAAGA,EAAIgzJ,EAAahnK,OAAQgU,IAAK,CAC1C,IAAIwO,EAAIwkJ,EAAahzJ,GACrB,GAAIwO,EAAEgpB,cAAgBllB,EAAQklB,YAAa,CACvCllB,EAAQ1iB,UAAYsmC,WAAW1nB,EAAE5e,UAAYsmC,WAAW5jB,EAAQ1iB,WAAWwoC,WAC3E9lB,EAAQ8kB,UAAYlB,WAAW1nB,EAAE4oB,UAAYlB,WAAW5jB,EAAQ8kB,WAAWgB,WAC3E,IAAK,IAAI5mB,EAAI,EAAGA,EAAIhD,EAAEjV,SAASujF,YAAY9wF,OAAQwlB,IAC/Cc,EAAQ/Y,SAASujF,YAAYtsF,KAAKge,EAAEjV,SAASujF,YAAYtrE,GAEjE,MACIyrJ,EAAgBzsK,KAAK8hB,GACrBA,EAAU9D,EAENxO,IAAMgzJ,EAAahnK,OAAS,IAC5BixK,EAAgBzsK,KAAKge,GACrB8D,EAAU,KAGtB,CAEA,OADAroB,EAAOqD,IAAI2vK,GACJA,CACX,I,4FAAC,CAtkEI,CAAuBhrK,EAAAA,GA2kEhCnG,OAAOwX,OAAO6oB,EAAMp8B,UAAWmtK,GAC/BpxK,OAAOwX,OAAO6oB,EAAMp8B,UAAWk6D,EAAAA,GAE/B,UAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQ6R,MAAQA,E,8BCnrE9B,IAQYgxI,E,iBAkEZ,QA1EiB,CAObr9J,UACQq9J,EAAYh7I,KAAKyR,MAAMC,KAAKC,OACzB,WACH,OAAOqpI,GACX,GASJlqK,KAAO,SAAUnE,GACb,IAAImE,EAAO,KAEP+M,EAAIlR,EAAG6S,YAAY,KAOvB,OALI1O,GADO,IAAP+M,EACOlR,EAEAA,EAAG4S,UAAU,EAAG1B,GAGpB/M,CACX,EASAY,MAAQ,SAAU/E,GACd,IAAI+E,EAAQ,KAERZ,EAAOrI,KAAKqI,KAAKnE,GAEjBkR,EAAI/M,EAAK0O,YAAY,KAMzB,OALW,IAAP3B,IACAnM,EAAQZ,EAAKyO,UAAU1B,EAAI,IAIxBnM,CACX,EASA8/B,KAAO,SAAU7kC,GACb,IAAI6kC,EAAO,KAEP3zB,EAAIlR,EAAG6S,YAAY,KAKvB,OAJW,IAAP3B,IACA2zB,EAAOphB,SAASzjB,EAAG4S,UAAU1B,EAAI,GAAI,KAGlC2zB,CACX,E,iFCEJ,QAzE0B,CA2CtBjkB,MAAQ,SAAUllB,GAED,IAAON,UAAU,uBACvBC,MAAM,CAAC,iCAEd,IAEIH,EAAWQ,GAAW,CAAC,EAGvB4yK,IAAkC,OAApB5yK,EAAQuL,SAA+C,mBAApBvL,EAAQuL,SAEzDrJ,EAAU,KAGV2wK,EAAQ,IAAI,IAAiBrzK,GACjC,IAAKqzK,EAAM/jI,uBAAwB,CAE/B,GADA5sC,EAAU,iCACN0wK,EAEA,YADA5yK,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa+B,IAGzD,MAAM,IAAIrC,MAAMqC,EACpB,CAGA,OAFU2wK,EAAMhkI,aAGpB,E,uEC7BJ,QA1C4B,CAuBxB3pB,MAAQ,SAAUllB,GAEd,IAAIP,EAAS,IAAOC,UAAU,yBAC9BD,EAAOE,MAAM,CAAC,mCAEd,IAAIH,EAAWQ,GAAW,CAAC,EAEvB6yK,EAAQ,IAAI,IAAmBrzK,GACnC,IAAKqzK,EAAM/jI,uBACP,MAAM,IAAIjvC,MAAM,kCAEpB,IAAIqL,EAAU2nK,EAAMhkI,cAIpB,OAFApvC,EAAOE,MAAMuL,GAENA,CACX,E,2FCSJ,SAAS4nK,EAAiB9yK,GAItB,GAHAI,KAAKX,OAAS,IAAOC,UAAU,mBAC/BU,KAAKX,OAAOE,MAAM,uCAEZS,gBAAgB0yK,GAClB,MAAM,IAAIzuK,UAAU,+DAMxB,GAHAjE,KAAKJ,QAAUA,GAAW,CAAC,GAGtBI,KAAKJ,QACN,MAAM,IAAIH,MAAM,IAAEwK,WAAW,cAAe,YAKhD,IAAKjK,KAAKJ,QAAQsM,KACd,MAAM,IAAIzM,MAAM,IAAEwK,WAAW,cAAe,+BAMhD,OADAjK,KAAK0gE,WAAa,KACV1gE,KAAKJ,QAAQsM,MACjB,IAAK,YACDlM,KAAK0gE,WAAa,IAAI,EAAAh7C,EAAqB1lB,KAAKJ,QAAQqmB,OACxD,MACJ,IAAK,SACDjmB,KAAK0gE,WAAa,IAAI,EAAAh7C,EAAkB1lB,KAAKJ,QAAQqmB,OACrD,MACJ,QACI,MAAM,IAAIxmB,MAAM,IAAEwK,WAAW,aAAc,+BAOnDjK,KAAKN,OAASM,KAAKJ,QAAQF,QAAU,KACzC,CAEAgzK,EAAgBvtK,UAAY,CAMxBspC,cAAgB,KAKhBrpC,YAAcstK,EAKd/5F,SAAW,CACPniD,IAAM,CAEFzvB,MAAQ,sGACR6N,MAAQ,CACJxQ,MAAQ,mBACRuuK,OAAS,2BAGjB/5F,KAAO,CAEH7xE,MAAQ,iHAMR6N,MAAQ,CACJxQ,MAAQ,oBACRuuK,OAAS,2BAarBjkI,qBAAuB,WACnB1uC,KAAKX,OAAOE,MAAM,4CAElB,IAAIo5E,EAAW,GAuBf,MAtBoB,SAAhB34E,KAAKN,OACLi5E,EAAW34E,KAAK24E,SAASC,KAAK7xE,MACP,QAAhB/G,KAAKN,SACZi5E,EAAW34E,KAAK24E,SAASniD,IAAIzvB,OAUjC4xE,GADAA,GADAA,GADAA,GAHAA,GADAA,EAAWA,EAAStqE,QAAQ,WAAYrO,KAAK0gE,WAAWr4B,WACpCh6B,QAAQ,WAAYrO,KAAK0gE,WAAWp4B,WAGpCj6B,QAAQ,cAAerO,KAAK0gE,WAAWn4B,SACvCl6B,QAAQ,WAAYrO,KAAK0gE,WAAWp8D,MACpC+J,QAAQ,gBAAiBrO,KAAK0gE,WAAWv8D,WACzCkK,QAAQ,gBAAiBrO,KAAK0gE,WAAWt7C,UAG7DuzD,GAAsB34E,KAAK+4E,kBAC3B/4E,KAAKX,OAAOE,MAAM,kBAAmBo5E,GAGrC34E,KAAKyuC,cAAgBkqC,EAEd34E,KAAKyuC,aAChB,EAOAsqC,gBAAkB,WAGd,IAAI65F,EACJ,GAHA5yK,KAAKX,OAAOE,MAAM,oCAGE,SAAhBS,KAAKN,OACLkzK,EAAa5yK,KAAK24E,SAASC,SACxB,IAAoB,QAAhB54E,KAAKN,OAGZ,MAAM,IAAID,MAAM,mDAFhBmzK,EAAa5yK,KAAK24E,SAASniD,GAG/B,CAGA,GAAkC,yBAA9Bx2B,KAAK0gE,WAAWx7D,UAEhB,OADO0tK,EAAWh+J,MAAMxQ,MACZiK,QAAQ,aAAcrO,KAAK0gE,WAAWv7C,MAAMqoB,YACrD,GAAkC,sBAA9BxtC,KAAK0gE,WAAWx7D,UAEvB,OADO0tK,EAAWh+J,MAAM+9J,OACZtkK,QAAQ,gBAAiBrO,KAAK0gE,WAAWz7C,UAErD,MAAM,IAAIxlB,MAAM,wDAExB,GAGJ,S;;;;;;;;ACvMgEX,EAAOC,QAG/D,WAAe,aAEvB,SAAS8zK,EAAiBvtK,GACxB,IAAI4G,SAAc5G,EAClB,OAAa,OAANA,IAAwB,WAAT4G,GAA8B,aAATA,EAC7C,CAEA,SAAS4mK,EAAWxtK,GAClB,MAAoB,mBAANA,CAChB,CAIA,IASI8I,EARA5E,MAAM4E,QACG5E,MAAM4E,QAEN,SAAU9I,GACnB,MAA6C,mBAAtCpE,OAAOiE,UAAUqoC,SAASruC,KAAKmG,EACxC,EAKEg/D,EAAM,EACNyuG,OAAY,EACZC,OAAoB,EAEpBC,EAAO,SAAcptI,EAAUqtI,GACjCC,EAAM7uG,GAAOz+B,EACbstI,EAAM7uG,EAAM,GAAK4uG,EAEL,KADZ5uG,GAAO,KAKD0uG,EACFA,EAAkBI,GAElBC,IAGN,EAEA,SAASC,EAAaC,GACpBP,EAAoBO,CACtB,CAEA,SAASC,EAAQC,GACfR,EAAOQ,CACT,CAEA,IAAIC,EAAkC,oBAAXnyK,OAAyBA,YAAS4e,EACzDwzJ,EAAgBD,GAAiB,CAAC,EAClCE,EAA0BD,EAAcE,kBAAoBF,EAAcG,uBAC1EC,EAAyB,oBAATprK,MAA2C,oBAAZud,SAAyD,qBAA9B,CAAC,EAAEsnB,SAASruC,KAAK+mB,SAG3F8tJ,EAAwC,oBAAtBC,mBAA8D,oBAAlBC,eAA2D,oBAAnBC,eAG1G,SAASC,IAGP,OAAO,WACL,OAAOluJ,QAAQ4nC,SAASslH,EAC1B,CACF,CAGA,SAASiB,IACP,YAAyB,IAAdtB,EACF,WACLA,EAAUK,EACZ,EAGKkB,GACT,CAEA,SAASC,IACP,IAAIC,EAAa,EACbC,EAAW,IAAIb,EAAwBR,GACvC78J,EAAO/N,SAAS66D,eAAe,IAGnC,OAFAoxG,EAASC,QAAQn+J,EAAM,CAAEo+J,eAAe,IAEjC,WACLp+J,EAAK1W,KAAO20K,IAAeA,EAAa,CAC1C,CACF,CAGA,SAASI,IACP,IAAIC,EAAU,IAAIV,eAElB,OADAU,EAAQC,MAAMC,UAAY3B,EACnB,WACL,OAAOyB,EAAQG,MAAMC,YAAY,EACnC,CACF,CAEA,SAASX,IAGP,IAAIY,EAAmB5yK,WACvB,OAAO,WACL,OAAO4yK,EAAiB9B,EAAO,EACjC,CACF,CAEA,IAAID,EAAQ,IAAI3pK,MAAM,KACtB,SAAS4pK,IACP,IAAK,IAAIh+J,EAAI,EAAGA,EAAIkvD,EAAKlvD,GAAK,GAI5BywB,EAHestI,EAAM/9J,IACX+9J,EAAM/9J,EAAI,IAIpB+9J,EAAM/9J,QAAK+K,EACXgzJ,EAAM/9J,EAAI,QAAK+K,EAGjBmkD,EAAM,CACR,CAEA,SAAS6wG,IACP,IACE,IAAIC,EAAQ5yI,SAAS,cAATA,GAA0B6yI,QAAQ,SAE9C,OADAtC,EAAYqC,EAAME,WAAaF,EAAMG,aAC9BlB,GACT,CAAE,MAAOpyK,GACP,OAAOqyK,GACT,CACF,CAEA,IAAIjB,OAAgB,EAcpB,SAAS/yK,EAAKk1K,EAAeC,GAC3B,IAAIv/H,EAASl2C,KAETkrC,EAAQ,IAAIlrC,KAAKoF,YAAY28B,QAEP5hB,IAAtB+qB,EAAMwqI,IACRC,EAAYzqI,GAGd,IAAI0qI,EAAS1/H,EAAO0/H,OAGpB,GAAIA,EAAQ,CACV,IAAI/vI,EAAW93B,UAAU6nK,EAAS,GAClC3C,GAAK,WACH,OAAO4C,EAAeD,EAAQ1qI,EAAOrF,EAAUqQ,EAAO4/H,QACxD,GACF,MACEC,EAAU7/H,EAAQhL,EAAOsqI,EAAeC,GAG1C,OAAOvqI,CACT,CAiCA,SAAS8qI,EAAUxkI,GAEjB,IAAIykI,EAAcj2K,KAElB,GAAIwxC,GAA4B,iBAAXA,GAAuBA,EAAOpsC,cAAgB6wK,EACjE,OAAOzkI,EAGT,IAAI0kI,EAAU,IAAID,EAAYl0I,GAE9B,OADAhhC,EAAQm1K,EAAS1kI,GACV0kI,CACT,CA7EE7C,EADEU,EACcK,IACPR,EACOW,IACPP,EACOY,SACWz0J,IAAlBuzJ,EACOyB,IAEAb,IAuElB,IAAIoB,EAAan+I,KAAK81C,SAAS7/B,SAAS,IAAI12B,UAAU,GAEtD,SAASirB,IAAQ,CAEjB,IAAIo0I,OAAU,EACVC,EAAY,EACZC,EAAW,EAEf,SAASC,IACP,OAAO,IAAIryK,UAAU,2CACvB,CAEA,SAASsyK,IACP,OAAO,IAAItyK,UAAU,uDACvB,CAEA,SAASuyK,EAAQC,EAAS1vK,EAAO2vK,EAAoBC,GACnD,IACEF,EAAQt3K,KAAK4H,EAAO2vK,EAAoBC,EAC1C,CAAE,MAAO10K,GACP,OAAOA,CACT,CACF,CAEA,SAAS20K,EAAsBV,EAASW,EAAUJ,GAChDxD,GAAK,SAAUiD,GACb,IAAIY,GAAS,EACTp2K,EAAQ81K,EAAQC,EAASI,GAAU,SAAU9vK,GAC3C+vK,IAGJA,GAAS,EACLD,IAAa9vK,EACfhG,EAAQm1K,EAASnvK,GAEjBgwK,EAAQb,EAASnvK,GAErB,IAAG,SAAUszE,GACPy8F,IAGJA,GAAS,EAET91K,EAAOk1K,EAAS77F,GAClB,GAAG,YAAc67F,EAAQz/J,QAAU,sBAE9BqgK,GAAUp2K,IACbo2K,GAAS,EACT91K,EAAOk1K,EAASx1K,GAEpB,GAAGw1K,EACL,CAEA,SAASc,EAAkBd,EAASW,GAC9BA,EAASjB,SAAWQ,EACtBW,EAAQb,EAASW,EAASf,SACjBe,EAASjB,SAAWS,EAC7Br1K,EAAOk1K,EAASW,EAASf,SAEzBC,EAAUc,OAAU12J,GAAW,SAAUpZ,GACvC,OAAOhG,EAAQm1K,EAASnvK,EAC1B,IAAG,SAAUszE,GACX,OAAOr5E,EAAOk1K,EAAS77F,EACzB,GAEJ,CAEA,SAAS48F,EAAoBf,EAASgB,EAAeT,GAC/CS,EAAc9xK,cAAgB8wK,EAAQ9wK,aAAeqxK,IAAYn2K,GAAQ42K,EAAc9xK,YAAYrE,UAAYi1K,EACjHgB,EAAkBd,EAASgB,QAEX/2J,IAAZs2J,EACFM,EAAQb,EAASgB,GACRpE,EAAW2D,GACpBG,EAAsBV,EAASgB,EAAeT,GAE9CM,EAAQb,EAASgB,EAGvB,CAEA,SAASn2K,EAAQm1K,EAASnvK,GACxB,GAAImvK,IAAYnvK,EACd/F,EAAOk1K,EAASI,UACX,GAAIzD,EAAiB9rK,GAAQ,CAClC,IAAI0vK,OAAU,EACd,IACEA,EAAU1vK,EAAMzG,IAClB,CAAE,MAAOI,GAEP,YADAM,EAAOk1K,EAASx1K,EAElB,CACAu2K,EAAoBf,EAASnvK,EAAO0vK,EACtC,MACEM,EAAQb,EAASnvK,EAErB,CAEA,SAASowK,EAAiBjB,GACpBA,EAAQkB,UACVlB,EAAQkB,SAASlB,EAAQJ,SAG3BuB,EAAQnB,EACV,CAEA,SAASa,EAAQb,EAASnvK,GACpBmvK,EAAQN,SAAWO,IAIvBD,EAAQJ,QAAU/uK,EAClBmvK,EAAQN,OAASQ,EAEmB,IAAhCF,EAAQoB,aAAal2K,QACvB6xK,EAAKoE,EAASnB,GAElB,CAEA,SAASl1K,EAAOk1K,EAAS77F,GACnB67F,EAAQN,SAAWO,IAGvBD,EAAQN,OAASS,EACjBH,EAAQJ,QAAUz7F,EAElB44F,EAAKkE,EAAkBjB,GACzB,CAEA,SAASH,EAAU7/H,EAAQhL,EAAOsqI,EAAeC,GAC/C,IAAI6B,EAAephI,EAAOohI,aACtBl2K,EAASk2K,EAAal2K,OAG1B80C,EAAOkhI,SAAW,KAElBE,EAAal2K,GAAU8pC,EACvBosI,EAAal2K,EAASg1K,GAAaZ,EACnC8B,EAAal2K,EAASi1K,GAAYZ,EAEnB,IAAXr0K,GAAgB80C,EAAO0/H,QACzB3C,EAAKoE,EAASnhI,EAElB,CAEA,SAASmhI,EAAQnB,GACf,IAAIqB,EAAcrB,EAAQoB,aACtBE,EAAUtB,EAAQN,OAEtB,GAA2B,IAAvB2B,EAAYn2K,OAAhB,CAQA,IAJA,IAAI8pC,OAAQ,EACRrF,OAAW,EACX4xI,EAASvB,EAAQJ,QAEZ1gK,EAAI,EAAGA,EAAImiK,EAAYn2K,OAAQgU,GAAK,EAC3C81B,EAAQqsI,EAAYniK,GACpBywB,EAAW0xI,EAAYniK,EAAIoiK,GAEvBtsI,EACF2qI,EAAe2B,EAAStsI,EAAOrF,EAAU4xI,GAEzC5xI,EAAS4xI,GAIbvB,EAAQoB,aAAal2K,OAAS,CAjB9B,CAkBF,CAEA,SAASy0K,EAAe2B,EAAStB,EAASrwI,EAAU4xI,GAClD,IAAIC,EAAc5E,EAAWjtI,GACzB9+B,OAAQ,EACRrG,OAAQ,EACRi3K,GAAY,EAEhB,GAAID,EAAa,CACf,IACE3wK,EAAQ8+B,EAAS4xI,EACnB,CAAE,MAAOx1K,GACP01K,GAAY,EACZj3K,EAAQuB,CACV,CAEA,GAAIi0K,IAAYnvK,EAEd,YADA/F,EAAOk1K,EAASK,IAGpB,MACExvK,EAAQ0wK,EAGNvB,EAAQN,SAAWO,IAEZuB,GAAeC,EACxB52K,EAAQm1K,EAASnvK,IACM,IAAd4wK,EACT32K,EAAOk1K,EAASx1K,GACP82K,IAAYpB,EACrBW,EAAQb,EAASnvK,GACRywK,IAAYnB,GACrBr1K,EAAOk1K,EAASnvK,GAEpB,CAEA,SAAS6wK,EAAkB1B,EAAS2B,GAClC,IACEA,GAAS,SAAwB9wK,GAC/BhG,EAAQm1K,EAASnvK,EACnB,IAAG,SAAuBszE,GACxBr5E,EAAOk1K,EAAS77F,EAClB,GACF,CAAE,MAAOp4E,GACPjB,EAAOk1K,EAASj0K,EAClB,CACF,CAEA,IAAIiC,EAAK,EACT,SAAS4zK,IACP,OAAO5zK,GACT,CAEA,SAASyxK,EAAYO,GACnBA,EAAQR,GAAcxxK,IACtBgyK,EAAQN,YAASz1J,EACjB+1J,EAAQJ,aAAU31J,EAClB+1J,EAAQoB,aAAe,EACzB,CAEA,SAASS,IACP,OAAO,IAAIt4K,MAAM,0CACnB,CAEA,IAAIu4K,EAAa,WACf,SAASA,EAAW/B,EAAarhK,GAC/B5U,KAAKi4K,qBAAuBhC,EAC5Bj2K,KAAKk2K,QAAU,IAAID,EAAYl0I,GAE1B/hC,KAAKk2K,QAAQR,IAChBC,EAAY31K,KAAKk2K,SAGf9nK,EAAQwG,IACV5U,KAAKoB,OAASwT,EAAMxT,OACpBpB,KAAKk4K,WAAatjK,EAAMxT,OAExBpB,KAAK81K,QAAU,IAAItsK,MAAMxJ,KAAKoB,QAEV,IAAhBpB,KAAKoB,OACP21K,EAAQ/2K,KAAKk2K,QAASl2K,KAAK81K,UAE3B91K,KAAKoB,OAASpB,KAAKoB,QAAU,EAC7BpB,KAAKm4K,WAAWvjK,GACQ,IAApB5U,KAAKk4K,YACPnB,EAAQ/2K,KAAKk2K,QAASl2K,KAAK81K,WAI/B90K,EAAOhB,KAAKk2K,QAAS6B,IAEzB,CA4EA,OA1EAC,EAAW7yK,UAAUgzK,WAAa,SAAoBvjK,GACpD,IAAK,IAAIQ,EAAI,EAAGpV,KAAK41K,SAAWO,GAAW/gK,EAAIR,EAAMxT,OAAQgU,IAC3DpV,KAAKo4K,WAAWxjK,EAAMQ,GAAIA,EAE9B,EAEA4iK,EAAW7yK,UAAUizK,WAAa,SAAoBC,EAAOjjK,GAC3D,IAAI+hB,EAAIn3B,KAAKi4K,qBACTK,EAAanhJ,EAAEp2B,QAGnB,GAAIu3K,IAAetC,EAAW,CAC5B,IAAIuC,OAAQ,EACR73K,OAAQ,EACR83K,GAAW,EACf,IACED,EAAQF,EAAM/3K,IAChB,CAAE,MAAO2B,GACPu2K,GAAW,EACX93K,EAAQuB,CACV,CAEA,GAAIs2K,IAAUj4K,GAAQ+3K,EAAMzC,SAAWO,EACrCn2K,KAAKy4K,WAAWJ,EAAMzC,OAAQxgK,EAAGijK,EAAMvC,cAClC,GAAqB,mBAAVyC,EAChBv4K,KAAKk4K,aACLl4K,KAAK81K,QAAQ1gK,GAAKijK,OACb,GAAIlhJ,IAAMuhJ,GAAW,CAC1B,IAAIxC,EAAU,IAAI/+I,EAAE4K,GAChBy2I,EACFx3K,EAAOk1K,EAASx1K,GAEhBu2K,EAAoBf,EAASmC,EAAOE,GAEtCv4K,KAAK24K,cAAczC,EAAS9gK,EAC9B,MACEpV,KAAK24K,cAAc,IAAIxhJ,GAAE,SAAUmhJ,GACjC,OAAOA,EAAWD,EACpB,IAAIjjK,EAER,MACEpV,KAAK24K,cAAcL,EAAWD,GAAQjjK,EAE1C,EAEA4iK,EAAW7yK,UAAUszK,WAAa,SAAoBtkI,EAAO/+B,EAAGrO,GAC9D,IAAImvK,EAAUl2K,KAAKk2K,QAGfA,EAAQN,SAAWO,IACrBn2K,KAAKk4K,aAED/jI,IAAUkiI,EACZr1K,EAAOk1K,EAASnvK,GAEhB/G,KAAK81K,QAAQ1gK,GAAKrO,GAIE,IAApB/G,KAAKk4K,YACPnB,EAAQb,EAASl2K,KAAK81K,QAE1B,EAEAkC,EAAW7yK,UAAUwzK,cAAgB,SAAuBzC,EAAS9gK,GACnE,IAAIwjK,EAAa54K,KAEjB+1K,EAAUG,OAAS/1J,GAAW,SAAUpZ,GACtC,OAAO6xK,EAAWH,WAAWrC,EAAWhhK,EAAGrO,EAC7C,IAAG,SAAUszE,GACX,OAAOu+F,EAAWH,WAAWpC,EAAUjhK,EAAGilE,EAC5C,GACF,EAEO29F,CACT,CAxGiB,GAyJjB,SAASh1J,EAAIud,GACX,OAAO,IAAIy3I,EAAWh4K,KAAMugC,GAAS21I,OACvC,CAmEA,SAAS/4B,EAAK58G,GAEZ,IAAI01I,EAAcj2K,KAElB,OAAKoO,EAAQmyB,GAKJ,IAAI01I,GAAY,SAAUl1K,EAASC,GAExC,IADA,IAAII,EAASm/B,EAAQn/B,OACZgU,EAAI,EAAGA,EAAIhU,EAAQgU,IAC1B6gK,EAAYl1K,QAAQw/B,EAAQnrB,IAAI9U,KAAKS,EAASC,EAElD,IATO,IAAIi1K,GAAY,SAAUtiI,EAAG3yC,GAClC,OAAOA,EAAO,IAAIiD,UAAU,mCAC9B,GASJ,CAoCA,SAAS40K,EAASx+F,GAEhB,IACI67F,EAAU,IADIl2K,KACY+hC,GAE9B,OADA/gC,EAAOk1K,EAAS77F,GACT67F,CACT,CAEA,SAAS4C,IACP,MAAM,IAAI70K,UAAU,qFACtB,CAEA,SAAS80K,KACP,MAAM,IAAI90K,UAAU,wHACtB,CA0GA,IAAIy0K,GAAY,WACd,SAAS53K,EAAQ+2K,GACf73K,KAAK01K,GAAcoC,IACnB93K,KAAK81K,QAAU91K,KAAK41K,YAASz1J,EAC7BngB,KAAKs3K,aAAe,GAEhBv1I,IAAS81I,IACS,mBAAbA,GAA2BiB,IAClC94K,gBAAgBc,EAAU82K,EAAkB53K,KAAM63K,GAAYkB,KAElE,CA2PA,OA/DAj4K,EAAQqE,UAAU1E,MAAQ,SAAgBg1K,GACxC,OAAOz1K,KAAKM,KAAK,KAAMm1K,EACzB,EA0CA30K,EAAQqE,UAAU6zK,QAAU,SAAkBnzI,GAC5C,IAAIqwI,EAAUl2K,KACVoF,EAAc8wK,EAAQ9wK,YAE1B,OAAI0tK,EAAWjtI,GACNqwI,EAAQ51K,MAAK,SAAUyG,GAC5B,OAAO3B,EAAYrE,QAAQ8kC,KAAYvlC,MAAK,WAC1C,OAAOyG,CACT,GACF,IAAG,SAAUszE,GACX,OAAOj1E,EAAYrE,QAAQ8kC,KAAYvlC,MAAK,WAC1C,MAAM+5E,CACR,GACF,IAGK67F,EAAQ51K,KAAKulC,EAAUA,EAChC,EAEO/kC,CACT,CAtQgB,GAkRhB,SAASm4K,KACP,IAAIC,OAAQ,EAEZ,QAAsB,IAAX,EAAA5zI,EACT4zI,EAAQ,EAAA5zI,OACH,GAAoB,oBAAT38B,KAChBuwK,EAAQvwK,UAER,IACEuwK,EAAQ12I,SAAS,cAATA,EACV,CAAE,MAAOvgC,GACP,MAAM,IAAIxC,MAAM,2EAClB,CAGF,IAAI05K,EAAID,EAAMp4K,QAEd,GAAIq4K,EAAG,CACL,IAAIC,EAAkB,KACtB,IACEA,EAAkBl4K,OAAOiE,UAAUqoC,SAASruC,KAAKg6K,EAAEp4K,UACrD,CAAE,MAAOkB,GAET,CAEA,GAAwB,qBAApBm3K,IAA2CD,EAAEE,KAC/C,MAEJ,CAEAH,EAAMp4K,QAAU43K,EAClB,CAMA,OA/CAA,GAAUvzK,UAAU7E,KAAOA,EAC3Bo4K,GAAU11J,IAAMA,EAChB01J,GAAUv7B,KAAOA,EACjBu7B,GAAU33K,QAAUi1K,EACpB0C,GAAU13K,OAAS63K,EACnBH,GAAUY,cAAgBhG,EAC1BoF,GAAUa,SAAW/F,EACrBkF,GAAUc,MAAQvG,EAqClByF,GAAUO,SAAWA,GACrBP,GAAU53K,QAAU43K,GAEbA,EAEN,CAxoCgFp1I,E,wBCTjFxkC,EAAOC,QAAUC,GAAGC,MAAM49E,I,wHCoG1B,SAAS48F,EAAiB75K,GACtB,KAAMI,gBAAgBy5K,GAClB,MAAM,IAAIx1K,UAAU,IAAEgG,WAAW,oBAAqB,oBAe1D,GARAjK,KAAKkF,UAAY,kBAGjB,IAAcsZ,MAAMxe,KAAM+N,WAE1B/N,KAAKX,OAAS,IAAOC,UAAU,+BAC/BU,KAAKX,OAAOE,MAAM,6CAEbK,EAAQyE,SACT,MAAM,IAAI5E,MAAM,IAAEwK,WAAW,gBAAiB,aAIlD,GAA2B,OAAvBrK,EAAQyE,SAASiB,EACjB,MAAM,IAAI7F,MAAM,IAAEwK,WAAW,gBAAiB,eAGlD,GAA2B,OAAvBrK,EAAQyE,SAASkB,EACjB,MAAM,IAAI9F,MAAM,IAAEwK,WAAW,gBAAiB,eAGlD,IAAKrK,EAAQqF,OAASrF,EAAQoF,SAC1B,MAAM,IAAIvF,MAAM,qHA2DpB,IAtDKG,EAAQqF,MAAQrF,EAAQoF,WACzBhF,KAAKJ,QAAQF,OAAS,WAElBM,KAAKJ,QAAQqF,aACNjF,KAAKJ,QAAQqF,MAMxBrF,EAAQqF,OAASrF,EAAQoF,WACzBhF,KAAKJ,QAAQF,OAAS,OAElBM,KAAKJ,QAAQoF,iBACNhF,KAAKJ,QAAQoF,UAK5BhF,KAAKJ,QAAQF,OAASM,KAAKJ,QAAQF,QAAU,OAI7CM,KAAKJ,QAAQuE,SAAWvE,EAAQuE,UAAY,kBAC5CnE,KAAKJ,QAAQomK,WAAapmK,EAAQomK,YAAc,GAChDhmK,KAAKJ,QAAQ+E,QAAU/E,EAAQ+E,UAAW,EAC1C3E,KAAKJ,QAAQ2E,IAAM3E,EAAQ2E,KAAO,YAClCvE,KAAKJ,QAAQiF,aAAejF,EAAQiF,cAAgB,IACpD7E,KAAKJ,QAAQgF,SAAWhF,EAAQgF,UAAY,SAGxChF,EAAQ85K,WACR15K,KAAKX,OAAOmU,KAAK,mCAErBxT,KAAKJ,QAAQ85K,WAAY,EACrB95K,EAAQ+5K,OACR35K,KAAKX,OAAOmU,KAAK,+BAErBxT,KAAKJ,QAAQ+5K,OAAQ,EAGjB/5K,EAAQ6E,OACc,YAAlB7E,EAAQ6E,QACRzE,KAAKJ,QAAQ6E,MAAQ,OAEH,WAAlB7E,EAAQ6E,QACRzE,KAAKJ,QAAQ6E,MAAQ,eAGzBzE,KAAKJ,QAAQ6E,MAAQ,MAIzBzE,KAAKJ,QAAQ8E,YAAc,GACvB9E,EAAQ8E,YAAa,CACrB,IAAI8E,MAAM4E,QAAQxO,EAAQ8E,aAKtB,MAAM,IAAIjF,MAAM,IAAEwK,WAAW,aAAc,gBAJ3C,IAAK,IAAItE,EAAI,EAAGA,EAAI/F,EAAQ8E,YAAYtD,OAAQuE,IAC5C3F,KAAKJ,QAAQ8E,YAAYkB,KAAKhG,EAAQ8E,YAAYiB,GAK9D,CAGA,IAAIi0K,EAAmB,CAAC,EACpBC,EAAiB,CAAC,EAClBC,EAAsB,CAAC,EAC3B,GAAIl6K,EAAQomK,YAC0B,IAA9BpmK,EAAQomK,WAAW5kK,OAAc,CACjCpB,KAAKX,OAAOmU,KAAK,uCACjB,IAAK,IAAI2jB,EAAI,EAAGA,EAAIv3B,EAAQomK,WAAW5kK,OAAQ+1B,IACN,iBAA1Bv3B,EAAQomK,WAAW7uI,KAC1Bv3B,EAAQomK,WAAW7uI,GAAKv3B,EAAQomK,WAAW7uI,GAAGpvB,cAKpB,SAA1BnI,EAAQomK,WAAW7uI,KACnB2iJ,EAAoBC,eAAiB,SACrCD,EAAoBhzK,IAAM,UAC1BgzK,EAAoBE,SAAW,IAC/BF,EAAoB/yK,MAAQ,YAC5B/G,KAAKJ,QAAQ8E,YAAYkB,KAAKk0K,IAEJ,WAA1Bl6K,EAAQomK,WAAW7uI,KACnByiJ,EAAiBG,eAAiB,SAClCH,EAAiB9yK,IAAM,UACvB8yK,EAAiBI,SAAW,IAC5BJ,EAAiB7yK,MAAQ,SACzB/G,KAAKJ,QAAQ8E,YAAYkB,KAAKg0K,IAEJ,WAA1Bh6K,EAAQomK,WAAW7uI,KACnB0iJ,EAAeE,eAAiB,SAChCF,EAAe/yK,IAAM,UACrB+yK,EAAeG,SAAW,IAC1BH,EAAe9yK,MAAQ,OACvB/G,KAAKJ,QAAQ8E,YAAYkB,KAAKi0K,IAG1C,CAKJ,GADA75K,KAAKJ,QAAQiL,aAAgD,iBAAzBjL,EAAQiL,aAA6BjL,EAAQiL,aAAa9C,cAAgB,OAC1GnI,EAAQiL,cAAyC,SAAzBjL,EAAQiL,aAChC,MAAM,IAAIpL,MAAM,IAAEwK,WAAW,oBAAqB,iBAMtD,GAJAjK,KAAKJ,QAAQiL,aAAe,QAIvB7K,KAAKJ,QAAQkM,UAAW,CACzB,IAAIwZ,EAAW,IAAkBm0J,gBAAgBx1J,SACjD,IAAKqB,EACD,MAAM,IAAI7lB,MAAM,8BAEpBO,KAAKJ,QAAQkM,UAAYwZ,EACzBtlB,KAAKX,OAAOE,MAAM,4BAA8BS,KAAKJ,QAAQkM,UACjE,CACJ,CAKA2tK,EAAgBt0K,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAGnE,GAKAs0K,EAAgBt0K,UAAUC,YAAcq0K,EAQxCA,EAAgBt0K,UAAUoG,aAAe,SAAU7K,EAAO8K,GACtD,IACI,IAAIyuK,EAAY,IAAI,IAAuBj6K,KAAKJ,SAChD,IAAKq6K,EAAUvrI,uBACX,MAAM,IAAIjvC,MAAM,IAAEwK,WAAW,0BAGjCjK,KAAK8K,QAAUmvK,EAAUxrI,aAC7B,CAAE,MAAOxsC,GAEL,YADAvB,EAAMvB,KAAKa,KAAM,IAAI,IAAaiC,EAAEH,SAExC,CAEA0J,EAAQrM,KAAKa,KAAMA,KAAK8K,QAC5B,EASA2uK,EAAgBt0K,UAAUkG,gBAAkB,SAAUF,EAASV,GAC3D,GAAIzK,KAAKO,SAAU,CACf,IAAIX,EAAU,CACVW,SAAWP,KAAKO,SAChBsK,aAAe7K,KAAKJ,QAAQiL,aAC5BL,YAAcxK,KAAKJ,QAAQ4K,YAC3BC,UAAYA,EACZU,QAAUA,EACVpL,MAAQC,MAGZ,IAA+B8kB,MAAMllB,EACzC,MACIuL,EAAQhM,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,2BAEzD,EAEA,S,wBC7TAnL,EAAOC,QAAUC,GAAGC,MAAM29E,M,qDCA1B,MAAM,EAA+B59E,GAAGW,OAAOu6K,I,aCA/C,MAAM,EAA+Bl7K,GAAGk2B,KAAKilJ,gB,aCA7C,MAAM,EAA+Bn7K,GAAGk2B,KAAKklJ,W,y1DC4B7C,IAAIF,EAAG,SAAAG,GAYH,SAAAH,EAAat6K,GAAS,IAAAyG,E,MAGlB,G,4FAHkBC,CAAA,KAAA4zK,G,EAClB,K,EAAA,CAAMt6K,G,MAANs6K,MAAA7zK,E,6EAEsB6zK,GAClB,MAAM,IAAIj2K,UAAU,2BAOxB,GAJAoC,EAAKzG,QAAUA,GAAW,CAAC,EAIvByG,EAAKzG,QAAQ06K,gBAAyD,mBAAhCj0K,EAAKzG,QAAQ06K,eAA+B,CAClF,IAAIC,EAAOl0K,EAAKzG,QAAQ06K,eACxBj0K,EAAKzG,QAAQ06K,eAAiB,SAAUxhJ,EAASviB,GAC7CvW,KAAKs6K,eAAexhJ,EAASviB,GAC7BgkK,EAAKp7K,KAAKa,KAAM84B,EAASviB,EAC7B,CACJ,MACIlQ,EAAKzG,QAAQ06K,eAAiBj0K,EAAKi0K,eAWvC,OANkC,OAA9Bj0K,EAAKzG,QAAQ+6B,mBAA8D,IAA9Bt0B,EAAKzG,QAAQ+6B,eAC1Dt0B,EAAKzG,QAAQ+6B,aAAe,CAAC,GAGjCt0B,EAAKuW,OAAS,KAEdwN,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAAszK,EAAAG,G,EAAAH,G,EAAA,EAAApzK,IAAA,eAAAC,MASA,SAAc6V,EAAQhd,GAIlB,IAAIiwF,EAAQ2J,EAAA0gF,EAAA,sBAAA1gF,CAAA,CAAsB58E,EAAQhd,IAGpB,iBAAXgd,EACP5c,KAAK4c,OAASi9E,EAAAA,EAAOp2F,MAAMmZ,GACT,OAAXA,IACP5c,KAAK4c,OAASA,GAQlB,IAAIjU,EAAO3I,KAkBX,OAjBA6vF,EAASjmF,SAAQ,SAAUkvB,EAAS7vB,EAAO6rB,GACvCgE,EAAQ0hJ,MAAMvxK,EAAQ,GAEtB,IAAIlC,EAAQ+xB,EAAQ4R,gBAAgByqB,KAOpC,GANIpuD,GACA+xB,EAAQinD,cAAc,CAClBp5E,YAAcI,KAGK+xB,EAAQsC,mBACR,CACvB,IAAIq/I,EAAgB9jJ,EAAAA,EAAQ+D,6BAA6B/xB,EAAK/I,QAAQ+6B,cAClE8/I,GACA3hJ,EAAQwC,SAASm/I,EAEzB,CACJ,IACO5qF,CACX,GAEA,CAAA/oF,IAAA,gBAAAC,MAUA,SAAe8oF,EAAUjwF,GA4CrB,GArCAiwF,EAASjmF,SAAQ,SAAUkvB,EAAS7vB,EAAO6rB,GAEvC,IAAI/tB,EAAQ+xB,EAAQ4R,gBAAgB/jC,YAChCI,GACA+xB,EAAQinD,cAAc,CAClB5qB,KAAOpuD,IAIf4vB,EAAAA,EAAQwE,0BAA0BrC,GAOlC,IAAI5sB,EAAO4sB,EAAQW,cAAcC,UACjC,GAAa,YAATxtB,EAAoB,CAEpB,IAAIwuK,EAAK5hJ,EAAQpc,QACjBg+J,EAAGvzK,IAAI,OAAQ+E,GACfwuK,EAAGlgJ,YAAY,IAAI4/I,IAAJ,CAAethJ,EAAQW,cAAcgB,mBACpDo1D,EAASjqF,KAAK80K,GAEd5lJ,EAAMiR,OAAO98B,EAAO,EACxB,MAAO,GAAa,iBAATiD,EAAyB,CAEhC,IAAIyuK,EAAK7hJ,EAAQpc,QACjBi+J,EAAGxzK,IAAI,OAAQ+E,GACfyuK,EAAGngJ,YAAY,IAAI2/I,IAAJ,CAAoBrhJ,EAAQW,cAAcgB,mBACzDo1D,EAASjqF,KAAK+0K,GAEd7lJ,EAAMiR,OAAO98B,EAAO,EACxB,CACJ,SAG6BkX,IAAzBngB,KAAKJ,QAAQg7K,QAAuB,CACpC,IAAI9zK,EAAM9G,KAAKJ,QAAQg7K,QACnB9zK,GAMA+oF,EAASv1E,MALK,SAAUC,EAAGC,GACvB,IAAIgH,EAAOjH,EAAEic,IAAI1vB,IAAQ,EACrBya,EAAO/G,EAAEgc,IAAI1vB,IAAQ,EACzB,OAAO0a,EAAKgsB,WAAW/rB,cAAcF,EAAKisB,gBAAYrtB,EAAW,CAAE06J,SAAU,GACjF,GAGR,CAGA,IAAIC,EAAOthF,EAAA0gF,EAAA,2BAAA1gF,CAAA,CAA2B3J,EAAUjwF,IAChD,GAAgB,OAAZk7K,EACA,OAAO,KAIP96K,KAAKJ,QAAQ8K,eAAe,eAC5B1K,KAAK+6K,qBAAqBD,EAAS96K,KAAKJ,QAAQw3F,YAMpDp3F,KAAKg7K,mBAAmBF,EAASjrF,EAAU,CACvCuH,WAAap3F,KAAKi7K,mBAItB,IAAIC,EAAoBrhF,EAAAA,EAAOrsD,SAASstI,GACxC,IAAKI,EACD,OAAO,KAIX,IAAIC,EAAqBthF,EAAAA,EAAOl6F,OAAOu7K,GACvC,MAA2B,KAAvBC,EACO,KAGJA,CACX,GAEA,CAAAr0K,IAAA,iBAAAC,MAMA,SAAgB+xB,EAASviB,GACrB,IAAIi3D,EAAQj3D,EAGZ,IAAKA,EAAM,CACP,IAAIuoF,EAAQhmE,EAAQ4R,gBACpB,IAAK,IAAM5jC,KAAOg4F,EACd,GAAI59F,OAAOwJ,eAAevL,KAAK2/F,EAAOh4F,GAAM,CACxC,IAAMN,EAAUs4F,EAAMh4F,GACtB,GAAIN,aAAmBsoE,KAAM,CACzBtB,EAAQhnE,EACR,KACJ,CACJ,CAER,CAEA,GAAKgnE,EAAL,CAYA,IAAK,IAAIvkE,EAAQ,EAAGA,EAAQukE,EAAMl3D,WAAWlV,OAAQ6H,IAAS,CAC1D,IAAIzC,EAAUgnE,EAAMl3D,WAAWrN,GACN,IAArBzC,EAAQ6kC,UACRvS,EAAQ3xB,IAAIX,EAAQsD,SAAUtD,EAAQo+C,YAE9C,CAKAjuB,EAAAA,EAAQ2B,wBAAyB,EACjC,IAAIr5B,EAAQ03B,EAAAA,EAAQkC,0BAA0BC,GAC1C75B,GACA65B,EAAQwC,SAASr8B,EArBrB,MAFIwD,QAAQ+Q,KAAK,mBAyBrB,GAEA,CAAA1M,IAAA,qBAAAC,MAMA,SAAoBD,GAWhB,IAVA,IAAIC,EAAQ,CAAC,EASTq0K,EADoBp7K,KAAK4c,OAAOtG,WAAW,GACFA,WACpC3Q,EAAI,EAAGA,EAAIy1K,EAAqBh6K,OAAQuE,IAAK,CAClD,IAAI01K,EAAWD,EAAqBz1K,GACpC,GAA0B,aAAtB01K,EAASvxK,SAET,IADA,IAAIwxK,EAAsBD,EAAS/kK,WAC1BlB,EAAI,EAAGA,EAAIkmK,EAAoBl6K,OAAQgU,IAAK,CACjD,IAAImmK,EAAUD,EAAoBlmK,GAClC,GAAyB,eAArBmmK,EAAQzxK,SAER,IADA,IAAI0xK,EAAuBD,EAAQjlK,WAC1BsQ,EAAI,EAAGA,EAAI40J,EAAqBp6K,OAAQwlB,IAAK,CAClD,IAAI60J,EAAWD,EAAqB50J,GACpC,GAA0B,SAAtB60J,EAAS3xK,SAAqB,CAC9B,IAAIzB,EAAOozK,EAASx0I,WAAW,GAC/B,GAAI5+B,GAA0B,SAAlBA,EAAKyB,UACTzB,EAAKkjC,YAAczkC,EAAK,CACxBC,EAAQvD,KAAKC,MAAMg4K,EAAS72H,aAC5B,KACJ,CAER,CACJ,CAER,CAER,CACA,OAAO79C,CACX,GAEA,CAAAD,IAAA,uBAAAC,MAOA,SAAsBq8D,EAAKg0B,EAAYhrF,GAEnC,IAAI+V,EAAW3Z,SAASC,cAAc,YAClCizK,EAAiBlzK,SAASC,cAAc,cAsF5C,GAAI2D,GA/CJ,SAASuvK,EAAOplK,EAAMzE,GAClB,IAAK,IAAMhL,KAAOgL,EACd,GAAI5Q,OAAOwJ,eAAevL,KAAK2S,EAAMhL,GAAM,CACvC,IAAIN,EAAUsL,EAAKhL,IAAQ,GACvB+f,EAAMre,SAASC,cAAc3B,GAEjC,GAAuB,iBAAZN,GAA2C,iBAAZA,EACtCqgB,EAAI1U,UAAY3L,EAChB+P,EAAKpO,YAAY0e,QACd,GAAIrgB,aAAmBgD,MAAO,CACjCqd,EAAI5L,aAAa,OAAQ,SACzB4L,EAAI5L,aAAa,QAASzU,EAAQpF,QAClC,IAAK,IAAI6H,EAAQ,EAAGA,EAAQzC,EAAQpF,OAAQ6H,IAAS,CACjD,IAAIs1C,EAAO/3C,EAAQyC,IAAU,GACzB0gB,EAAInhB,SAASC,cAAc,SAC/B,GAAoB,iBAAT81C,GAAqC,iBAATA,EACnC50B,EAAExX,UAAYosC,EACd13B,EAAI1e,YAAYwhB,QACb,GAAI40B,aAAgB/0C,MAAO,CAC9BmgB,EAAE1O,aAAa,OAAQ,SACvB0O,EAAE1O,aAAa,QAASsjC,EAAKn9C,QAC7B,IAAK,IAAIgU,EAAI,EAAGA,EAAImpC,EAAKn9C,OAAQgU,IAAK,CAClC,IAAIrO,EAAQw3C,EAAKnpC,IAAM,GACnBzP,EAAI6C,SAASC,cAAc,SACV,iBAAV1B,GAAuC,iBAAVA,IACpCpB,EAAEwM,UAAYpL,EACd4iB,EAAExhB,YAAYxC,GAEtB,CACAkhB,EAAI1e,YAAYwhB,EACpB,MAAW40B,aAAgBr9C,QACvB2lB,EAAI1e,YAAYwzK,EAAMhyJ,EAAG40B,GAIjC,CACAhoC,EAAKpO,YAAY0e,EACrB,MAAWrgB,aAAmBtF,QAC1BqV,EAAKpO,YAAYwzK,EAAM90J,EAAKrgB,GAIpC,CAEJ,OAAO+P,CACX,CAIIolK,CAAMD,EAAgBtkF,QAStB,IAAK,IAAMtwF,KAAOswF,EACd,GAAIl2F,OAAOwJ,eAAevL,KAAKi4F,EAAYtwF,GAAM,CAC7C,IAAMC,EAAQqwF,EAAWtwF,GACrBg1F,EAActzF,SAASC,cAAc,QACzCqzF,EAAY7gF,aAAa,OAAQnU,GACjC,IAAIjH,EAAO2I,SAAS66D,eAAe7/D,KAAKqC,UAAUkB,IAClD+0F,EAAY3zF,YAAYtI,GACxB67K,EAAevzK,YAAY2zF,EAC/B,CAGR35E,EAASha,YAAYuzK,GAErB,IAAIxsJ,EAAak0C,EAAIl0C,WACrBk0C,EAAI1Z,aAAavnC,EAAU+M,EAC/B,GAEA,CAAApoB,IAAA,mBAAAC,MAOA,SAAkB+xB,EAASviB,GAEvB,IAAIqlK,EAAiBpzK,SAASorE,gBAAgBr9D,EAAKuzB,WAAWykC,aAAc,cAC5E53C,EAAAA,EAAQiC,cAAchvB,SAAQ,SAAA9C,GAC1B,GAAIgyB,EAAQtC,IAAI1vB,GAAM,CAClB,IAAI2e,EAAYjd,SAASorE,gBAAgBr9D,EAAKuzB,WAAWykC,aAAcznE,GACvE2e,EAAUtT,UAAY2mB,EAAQtC,IAAI1vB,GAClC80K,EAAezzK,YAAYsd,EAC/B,CACJ,IACAlP,EAAKpO,YAAYyzK,EACrB,GAEA,CAAA90K,IAAA,qBAAAC,MAQA,SAAoBq8D,EAAKysB,EAAUgsF,GAW/B,IAFA,IAAI5yK,GAAS,EACTmN,EAAQgtD,EAAI9sD,WACPlB,EAAI,EAAGA,EAAIgB,EAAMhV,OAAQgU,IAAK,CACnC,IAAImB,EAAOH,EAAMhB,GACjB,OAAQmB,EAAKzM,UACT,IAAK,MACL,IAAK,MACL,IAAK,MAED,IAAIgvB,EAAU+2D,IADd5mF,GAGA,GADY6vB,EAAQvD,WACT,CACP,IAAIumJ,EAAMD,EAAQzkF,WACd0kF,GAAsB,mBAARA,GACdA,EAAIhjJ,EAASviB,EAErB,CACA,MACJ,IAAK,WACD,MACJ,QAGI9T,QAAQ+Q,KAAK,qBAAsB+C,EAAKzM,UAGpD,CACJ,M,yFAAC,CA3dE,CAAqBiyK,KA+d5B,UAGIx6K,OAAOvC,IAAMuC,OAAOvC,GAAGW,SACvB4B,OAAOvC,GAAGW,OAAOq8K,YAAc9B,E,wBC/fnCp7K,EAAOC,QAAUC,GAAGW,OAAOs8K,O,wHC0G3B,SAAS16I,EAAO3hC,GACZ,KAAMI,gBAAgBuhC,GAClB,MAAM,IAAIt9B,UAAU,IAAEgG,WAAW,oBAAqB,UAc1D,GARAjK,KAAKkF,UAAY,QAGjB,IAAcsZ,MAAMxe,KAAM+N,WAE1B/N,KAAKX,OAAS,IAAOC,UAAU,qBAC/BU,KAAKX,OAAOE,MAAM,mCAEbK,EAAQy0B,WACT,MAAM,IAAI50B,MAAM,IAAEwK,WAAW,gBAAiB,eAIlD,GAA6B,OAAzBrK,EAAQy0B,WAAW/uB,EACnB,MAAM,IAAI7F,MAAM,IAAEwK,WAAW,gBAAiB,iBAGlD,GAA6B,OAAzBrK,EAAQy0B,WAAW9uB,EACnB,MAAM,IAAI9F,MAAM,IAAEwK,WAAW,gBAAiB,iBAGlD,IAAKrK,EAAQ00B,SACT,MAAM,IAAI70B,MAAM,IAAEwK,WAAW,gBAAiB,aAIlD,GAA2B,OAAvBrK,EAAQ00B,SAAShvB,EACjB,MAAM,IAAI7F,MAAM,IAAEwK,WAAW,gBAAiB,eAGlD,GAA2B,OAAvBrK,EAAQ00B,SAAS/uB,EACjB,MAAM,IAAI9F,MAAM,IAAEwK,WAAW,gBAAiB,eA4BlD,GAtBIrK,EAAQiL,cAAyC,SAAzBjL,EAAQiL,cAChC7K,KAAKX,OAAOmU,KAAK,2CAErBxT,KAAKJ,QAAQiL,aAAe,OAE5B7K,KAAKJ,QAAQuE,SAAWvE,EAAQuE,UAAY,cAC5CnE,KAAKJ,QAAQy0B,WAAaz0B,EAAQy0B,WAClCr0B,KAAKJ,QAAQ00B,SAAW10B,EAAQ00B,SAChCt0B,KAAKJ,QAAQ40B,UAAY50B,EAAQ40B,WAAa,GAC9Cx0B,KAAKJ,QAAQ80B,gBAAkB90B,EAAQ80B,iBAAmB,UAEtD90B,EAAQ6E,OACc,YAAlB7E,EAAQ6E,QACRzE,KAAKJ,QAAQ6E,MAAQ,OAEH,WAAlB7E,EAAQ6E,QACRzE,KAAKJ,QAAQ6E,MAAQ,eAGzBzE,KAAKJ,QAAQ6E,MAAQ,MAEzBzE,KAAKJ,QAAQ8E,YAAc,GACvB9E,EAAQ8E,YAAa,CACrB,IAAI8E,MAAM4E,QAAQxO,EAAQ8E,aAKtB,MAAM,IAAIjF,MAAM,IAAEwK,WAAW,aAAc,gBAJ3C,IAAK,IAAItE,EAAI,EAAGA,EAAI/F,EAAQ8E,YAAYtD,OAAQuE,IAC5C3F,KAAKJ,QAAQ8E,YAAYkB,KAAKhG,EAAQ8E,YAAYiB,GAK9D,CAGA,IAAIi0K,EAAmB,CAAC,EACpBC,EAAiB,CAAC,EAClBC,EAAsB,CAAC,EAC3B,GAAIl6K,EAAQomK,YAC0B,IAA9BpmK,EAAQomK,WAAW5kK,OAAc,CACjCpB,KAAKX,OAAOmU,KAAK,uCACjB,IAAK,IAAI2jB,EAAI,EAAGA,EAAIv3B,EAAQomK,WAAW5kK,OAAQ+1B,IACN,iBAA1Bv3B,EAAQomK,WAAW7uI,KAC1Bv3B,EAAQomK,WAAW7uI,GAAKv3B,EAAQomK,WAAW7uI,GAAGpvB,cAKpB,SAA1BnI,EAAQomK,WAAW7uI,KACnB2iJ,EAAoBC,eAAiB,SACrCD,EAAoBhzK,IAAM,UAC1BgzK,EAAoBE,SAAW,IAC/BF,EAAoB/yK,MAAQ,YAC5B/G,KAAKJ,QAAQ8E,YAAYkB,KAAKk0K,IAEJ,WAA1Bl6K,EAAQomK,WAAW7uI,KACnByiJ,EAAiBG,eAAiB,SAClCH,EAAiB9yK,IAAM,UACvB8yK,EAAiBI,SAAW,IAC5BJ,EAAiB7yK,MAAQ,SACzB/G,KAAKJ,QAAQ8E,YAAYkB,KAAKg0K,IAEJ,WAA1Bh6K,EAAQomK,WAAW7uI,KACnB0iJ,EAAeE,eAAiB,SAChCF,EAAe/yK,IAAM,UACrB+yK,EAAeG,SAAW,IAC1BH,EAAe9yK,MAAQ,OACvB/G,KAAKJ,QAAQ8E,YAAYkB,KAAKi0K,IAG1C,CAaJ,GAVA75K,KAAKJ,QAAQ6sC,uBAAyB7sC,EAAQ6sC,yBAA0B,EACxEzsC,KAAKJ,QAAQs8K,YAAct8K,EAAQs8K,cAAe,EAClDl8K,KAAKJ,QAAQiF,aAAejF,EAAQiF,cAAgB,IACpD7E,KAAKJ,QAAQgF,SAAWhF,EAAQgF,UAAY,SAC5C5E,KAAKJ,QAAQu8K,kBAAoB,KACjCn8K,KAAKJ,QAAQ2E,IAAM3E,EAAQ2E,KAAO,YAClCvE,KAAKJ,QAAQg1B,eAAiBh1B,EAAQg1B,gBAAkB,IAInD50B,KAAKJ,QAAQkM,UAAW,CACzB,IAAIswK,EAAe,IAAkB76I,MAAMtd,SAE3C,IAAKm4J,EACD,MAAM,IAAI38K,MAAM,8BAEpBO,KAAKJ,QAAQkM,UAAYswK,EACzBp8K,KAAKX,OAAOE,MAAM,4BAA8BS,KAAKJ,QAAQkM,UACjE,CACJ,CAKAy1B,EAAMp8B,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAGzD,GAKAo8B,EAAMp8B,UAAUC,YAAcm8B,EAS9BA,EAAMp8B,UAAUoG,aAAe,SAAU7K,EAAO8K,GAC5C,IAAI5L,EAAU,CAEVuE,SAAWnE,KAAKJ,QAAQuE,SACxBkwB,WAAar0B,KAAKJ,QAAQy0B,WAC1BC,SAAWt0B,KAAKJ,QAAQ00B,SACxBE,UAAYx0B,KAAKJ,QAAQ40B,UACzB0nJ,YAAcl8K,KAAKJ,QAAQs8K,YAC3Bx3K,YAAc1E,KAAKJ,QAAQ8E,YAC3BG,aAAe7E,KAAKJ,QAAQiF,aAC5BD,SAAW5E,KAAKJ,QAAQgF,SACxBH,MAAQzE,KAAKJ,QAAQ6E,MACrBgoC,uBAAyBzsC,KAAKJ,QAAQ6sC,uBACtC/X,gBAAkB10B,KAAKJ,QAAQ80B,gBAC/BnwB,IAAMvE,KAAKJ,QAAQ2E,IACnBqwB,eAAiB50B,KAAKJ,QAAQg1B,gBAGlC50B,KAAK8K,QAAU,IAAoBga,MAAMllB,GAGpCI,KAAK8K,QAGNU,EAAQrM,KAAKa,KAAMA,KAAK8K,SAFxBpK,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,0BAIvD,EASAs3B,EAAMp8B,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GAI/C,GAAIxL,KAAKO,SAAU,CACf,IAAIX,EAAU,CACViF,aAAe7E,KAAKJ,QAAQiF,aAC5BD,SAAW5E,KAAKJ,QAAQgF,SACxBrE,SAAWP,KAAKO,SAChBsK,aAAe7K,KAAKJ,QAAQiL,aAC5BL,YAAcxK,KAAKJ,QAAQ4K,YAC3BW,QAAUzK,EACV+J,UAAYe,EACZzL,MAAQC,KACRysC,uBAAyBzsC,KAAKJ,QAAQ6sC,wBAG1C,IAAqB3nB,MAAMllB,EAC/B,MACIc,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAEiK,WAAW,2BAEvD,EAEA,S,wBCjUAnL,EAAOC,QAAUC,GAAG0wB,QAAQroB,O,8BCyB5B,SAASm6B,IACL,KAAMxhC,gBAAgBwhC,GAClB,MAAM,IAAIv9B,UAAU,gEAGxBjE,KAAKwsC,SAAW,KAEhBxsC,KAAKgF,SAAW,KAEhBhF,KAAK4+B,KAAO,KAEZ5+B,KAAK4sC,YAAc,KAEnB5sC,KAAK2O,SAAW,IACpB,C,iBAEA6yB,EAAiBr8B,UAAY,CAEzBC,YAAco8B,GAIlB,S,+CCTA,IAAI66I,EAAoB,CAGpBjyK,KAAM,EAON6Z,OAAS,SAAUmjC,GAYf,QAN8B,IAA1Bi1H,EAAkBjyK,IACN,UAEA,YARO,gBAWeg9C,CAC1C,EAQAriC,KAAO,CACHu3J,QAAU,CAEN,iBAAmB,kDACnB,gBAAkB,iDAClB,cAAgB,sDAChB,aAAe,sDAQnBr4J,OAAS,WACL,MAAO,CAEH,iBAAmBo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QAAQ,mBACzD,gBAAkBD,EAAkBp4J,OAAOjkB,KAAKs8K,QAAQ,kBACxD,cAAgBD,EAAkBp4J,OAAOjkB,KAAKs8K,QAAQ,gBACtD,aAAeD,EAAkBp4J,OAAOjkB,KAAKs8K,QAAQ,eAE7D,GAQJ7C,gBAAkB,CAEd6C,QAAU,wBAMVr4J,OAAS,WACL,OAAOo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QACzC,GAQJl7I,OAAS,CACL8sB,KAAO,+EAMP1uD,IAAM,SAAUsH,GAEP0C,MAAM4E,QAAQtH,KACfA,EAAMA,EAAI8R,MAAM,MAIpB,IADA,IAAIpZ,EAAM,GACD4V,EAAI,EAAGA,EAAItO,EAAI1F,OAAQgU,IAC5B5V,EAAI4V,GAAKpV,KAAKkuD,KAAOpnD,EAAIsO,GAAK,cAElC,OAAO5V,CACX,GAQJ0hC,aAAe,CACXo7I,QAAU,wBAMVr4J,OAAS,WACL,OAAOo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QACzC,GAQJv8E,eAAiB,CACbu8E,QAAU,qBAMVr4J,OAAS,WACL,OAAOo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QACzC,GAQJx4J,QAAU,CACNw4J,QAAU,oBAMVr4J,OAAS,WACL,OAAOo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QACzC,GAQJ/6I,MAAQ,CACJ+6I,QAAU,yBAMVr4J,OAAS,WACL,OAAOo4J,EAAkBp4J,OAAOjkB,KAAKs8K,QACzC,IAIR,S,8BChMA,SAASC,EAAc77K,GACnB,KAAMV,gBAAgBu8K,GAClB,MAAM,IAAIt4K,UAAU,4DAGxB,IAAIhC,EAAIvB,EACa,iBAAVA,GAAsBA,aAAiBwhE,QAC9CliE,KAAK8B,QAAUpB,EACfV,KAAKgC,QAAU,EACfhC,KAAKkM,KAAOqwK,EAAa5iG,cAEzB35E,KAAK8B,QAAUG,EAAEH,SAAW,cAC5B9B,KAAKkM,KAAOjK,EAAEiK,KACdlM,KAAKgC,OAASC,EAAED,SAAW,GAG/BhC,KAAKqI,KAAO,eACZrI,KAAKw8K,OAAQ,IAAK/8K,OAAS+8K,KAC/B,C,iBASAD,EAAapwK,YAAc,gBAQ3BowK,EAAaE,YAAc,cAQ3BF,EAAa5iG,YAAc,gBAK3B4iG,EAAap3K,UAAYjE,OAAOmjB,OAAO5kB,MAAM0F,UAAW,CACpDC,YAAc,CACV2B,MAAQw1K,EACRzgJ,UAAW,EACXsW,cAAe,KAIvB,S,2FCkCA,QA5FqC,CAoBjCttB,MAAQ,SAAUllB,GAEd,IAAIP,EAAS,IAAOC,UAAU,kCAC9BD,EAAOE,MAAM,CAAC,4CAEd,IAAIM,EAAO,KAEX,GAAID,EAAQW,SAAZ,CACI,GAAIX,EAAQ4K,YACRnL,EAAOE,MAAM,0BACbM,EAAOD,EAAQW,aACZ,CAGH,IAAI6rC,EAYJ,GAdA/sC,EAAOE,MAAM,2BAIT6sC,EAD4B,iBAArBxsC,EAAQW,SACAiD,KAAKC,MAAM7D,EAAQW,UAEnBX,EAAQW,SAK3BV,EAAO,IAAI,KAGPusC,EAoBA,YADAxsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAA4BrK,EAAQW,YAlB3E,aAA1B6rC,EAAatnC,UACbjF,EAAKoF,KAAO,GACZpF,EAAKmF,SAAWonC,EAAarnC,YAE7BlF,EAAKoF,KAAOmnC,EAAarnC,UACzBlF,EAAKmF,SAAW,IAGpBnF,EAAKiC,QAAU,GACfjC,EAAKqE,GAAK,GACVrE,EAAK0E,IAAM6nC,EAAa9nC,IACxBzE,EAAK8O,SAAWy9B,EAAaz9B,SAC7B,IAAI0iK,EAASjlI,EAAahoC,MAAMwU,MAAM,KAa1C,GAZQ/Y,EAAK6O,WACL7O,EAAK6O,SAASpJ,EAAI+rK,EAAO,GACzBxxK,EAAK6O,SAASnJ,EAAI8rK,EAAO,IAU7BxxK,EAAKksC,gBAML,YALAnsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BpK,EAAKksC,iBAC7D7/B,KAAO,IAAaC,YACpBnK,OAAS,MAIrB,CAQJpC,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAOF,EAHtC,MAFID,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,IAAKkK,WAAW,2BAM7E,E,kJCzFJ,QAbgB,CAOZ0V,QAAU,SAAUzb,GAEhB,OADWlE,KAAK07E,IAAOx3E,EAAK,IAAMlE,KAAK07E,IAAMx3E,CAEjD,G,g+CCWJ,IAAI7E,EAAS2Q,EAAAA,EAAO1Q,UAAU,UAkGxBswF,EAAY,SAAAzpF,GAYd,SAAAypF,EAAahwF,GAAS,IAAAyG,EA0BlB,G,4FA1BkBC,CAAA,KAAAspF,GAClBhwF,EAAUA,GAAW,CACjB4M,MAAQ,KACRkjB,QAAU,KACV3sB,OAAS,KACTpD,OAAS,UACT0I,KAAO,SACP1B,YAAc,SACdwJ,MAAQ,WACR43B,KAAO,YACP20I,MAAO,EACPC,MAAQ,CACJD,KAAO,KACPnoK,OAAS,IAEbsxB,SAAW,MAGfxmC,EAAOE,MAAM,uBAAwBK,MAErCyG,EAAAE,EAAA,KAAAqpF,EAAA,CAAM,CACFppF,QAAUgC,SAASC,cAAc,OACjChC,OAAS7G,EAAQ6G,OACjB1D,OAAS,mBAGS6sF,GAClB,MAAM,IAAI3rF,UAAU,2BA4HH,OAtHrBoC,EAAKnB,UAAY,SAqBjBmB,EAAKu2K,aAAe,CAAC,EAwCrBv2K,EAAKw2K,gBAAkB,CAAC,EAsCxBx2K,EAAKy2K,eAAiB,CAAC,EAGvBz2K,EAAKq1E,IAAM97E,EAAQsE,IAAM+Q,EAAAA,EAAGC,WAG5B7O,EAAKof,UAAY,KACjBpf,EAAKw7D,SAAW,KAGhBx7D,EAAKsB,UAAY,KACjBtB,EAAKkO,OAAS,KACdlO,EAAK02K,cAAgB,KACrB12K,EAAK22K,UAAY,KACjB32K,EAAK42K,UAAY,KACjB52K,EAAKq2K,KAAO,KACZr2K,EAAK62K,gBAAkB,6BAEvB72K,EAAK82K,YAAYv9K,GACjByG,EAAK+2K,gBAAgB/2K,CACzB,CAMA,O,qRAAAO,CAAAgpF,EAAAzpF,G,EAAAypF,E,EAAA,EAAA9oF,IAAA,SAAAC,MAKA,WAEI,IAAK/G,KAAKJ,QAAQmD,QACV/C,KAAKJ,QAAQ8vB,QAAS,CAEtB,IAAI2tJ,EAAgBr9K,KAAKJ,QAAQ8vB,QAAQpN,eACrCg7J,EAAgBD,EAAc5iH,cAAc,6BAEhDz6D,KAAKJ,QAAQmD,OAASu6K,GAAiBD,EAAcvmI,SACzD,CAEA92C,KAAK2H,WACL3H,KAAKJ,QAAQmD,OAAOoF,YAAYnI,KAAK2H,UAE7C,GAMA,CAAAb,IAAA,cAAAC,MAOA,SAAanH,GACTI,KAAKJ,QAAU,CACX4M,MAAQ,KACRkjB,QAAU,KACV3sB,OAAS,KACTw6K,UAAW,EACX59K,OAAS,UACT0I,KAAO,SACP1B,YAAc,SACdwJ,MAAQ,WACR43B,KAAO,YACP4H,UAAY,MACZ+sI,MAAO,EACPc,YAAc,CACVC,OAAQ,EACRC,SAAU,EACVnlF,WAAY,EACZolF,WAAY,EACZC,cAAe,GAEnBjB,MAAQ,CACJD,KAAO,KACPnoK,OAAS,UAEbsxB,SAAW,MAIf,IAAI82I,EAAQlsK,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAAQ+8K,MAAO/8K,EAAQ+8K,OACjDa,EAAc/sK,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAAQ49K,YAAa59K,EAAQ49K,aACjE/sK,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAASA,GAC3B6Q,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAAQ+8K,MAAOA,GACjClsK,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAAQ49K,YAAaA,GAEvCn+K,EAAO0jC,MAAM/iC,KAAKJ,SAEdI,KAAKJ,QAAQ4M,MAIbxM,KAAKJ,QAAQ8vB,QAIb1vB,KAAKJ,QAAQmD,OAIjB,IAAIpD,EAASK,KAAKJ,QAAQD,OACzBA,EAAUK,KAAK69K,UAAUl+K,GAAUK,KAAK69K,UAAU,IAE9C79K,KAAKJ,QAAQyI,MACdrI,KAAK89K,QAAQ,UAGZ99K,KAAKJ,QAAQ+G,aACd3G,KAAK+9K,eAAe,UAGnB/9K,KAAKJ,QAAQuQ,OACdnQ,KAAKg+K,SAAS,YAGbh+K,KAAKJ,QAAQmoC,MACd/nC,KAAKi+K,QAAQ,kBAGS99J,IAAtBngB,KAAKJ,QAAQ88K,MACb18K,KAAKk+K,SAAQ,EAErB,GAEA,CAAAp3K,IAAA,gBAAAC,MAOA,WAAiB,IAAA+lB,EAAA,KAET3c,EAAQnQ,KAAKJ,QAAQuQ,MACrBnQ,KAAKJ,QAAQ88K,OACbvsK,EAAQnQ,KAAKJ,QAAQ+8K,MAAMD,KAAO18K,KAAKJ,QAAQuQ,OAGnD,IAAI5H,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,qBACtBpX,EAAIG,UAAY,wFAEe,WAA3B1I,KAAKJ,QAAQ+vC,WACbpnC,EAAI+e,UAAUjZ,QAAQ,wCAAyC,4CAKnE,IAAIquK,EAAO18K,KAAKm+K,aAAa,2EAAD5tJ,OACoCvwB,KAAKk9K,gBAAe,8KAAA3sJ,OAGvCvwB,KAAK07E,IAAG,+JAAAnrD,OAEsBvwB,KAAK07E,IAAG,4FAAAnrD,OAE5CvwB,KAAK07E,IAAG,4HAAAnrD,OAEPvwB,KAAK07E,IAAG,wJAAAnrD,OAEuCvwB,KAAK07E,IAAG,oGAAAnrD,OAChCvwB,KAAK07E,IAAG,qHAAAnrD,OAE/BvwB,KAAK07E,IAAG,uJAAAnrD,OAEuCvwB,KAAK07E,IAAG,oHAAAnrD,OAChCvwB,KAAK07E,IAAG,uHAAAnrD,OAE7BvwB,KAAK07E,IAAG,sSAAAnrD,OAIAvwB,KAAK07E,IAAG,gMAAAnrD,OAGuBvwB,KAAK07E,IAAG,6UAAAnrD,OAM3CvwB,KAAK07E,IAAG,wLAAAnrD,OAGuBvwB,KAAK07E,IAAG,yUAAAnrD,OAMvCvwB,KAAK07E,IAAG,wLAAAnrD,OAGuBvwB,KAAK07E,IAAG,+NAAAnrD,OAK1CvwB,KAAK07E,IAAG,sMAAAnrD,OAIEvwB,KAAK07E,IAAG,sWAAAnrD,OAMVvwB,KAAK07E,IAAG,iTAU3D,GADA17E,KAAK08K,KAAOA,EAAKxtJ,WACblvB,KAAK08K,KAAM,CACX,GAAI18K,KAAKJ,QAAQ88K,KAAM,CACnB,IAAIh0K,EAAY1I,KAAK08K,KAAKh0K,UAC1B1I,KAAK08K,KAAKh0K,UAAYA,EAAU2F,QAAQrO,KAAKk9K,gBAAiB,GAClE,CAGA,IAFA,IAAIv9K,EAASK,KAAKJ,QAAQD,OAAOgL,cAC7ByzK,EAASp+K,KAAK08K,KAAKjvH,iBAAiB,oCAC/Br4C,EAAI,EAAGA,EAAIgpK,EAAOh9K,OAAQgU,IAAK,CACpC,IAAIipK,EAAQD,EAAOhpK,GAEfipK,EAAMn6K,GAAGyG,cAAc7C,SAASnI,KAChC0+K,EAAMxoK,SAAU,GAGpBwoK,EAAMhsK,iBAAiB,UAAU,SAACpQ,GAAC,OAAK6qB,EAAKwxJ,oBAAoBr8K,EAAE,GACvE,CAEAjC,KAAK+8K,cAAgB/8K,KAAK08K,KAAKjiH,cAAc,2BAA6Bz6D,KAAK07E,KAC3E17E,KAAK+8K,eACL/8K,KAAK+8K,cAAc1qK,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAKyxJ,2BAA2Bt8K,EAAE,IAG1FjC,KAAKg9K,UAAYh9K,KAAK08K,KAAKjiH,cAAc,0BAA4Bz6D,KAAK07E,KAC1E17E,KAAKi9K,UAAYj9K,KAAK08K,KAAKjiH,cAAc,0BAA4Bz6D,KAAK07E,KAC1E17E,KAAKg9K,UAAU3qK,iBAAiB,UAAU,SAACpQ,GAAC,OAAK6qB,EAAK0xJ,kBAAkBv8K,EAAE,IAC1EjC,KAAKg9K,UAAU3qK,iBAAiB,WAAW,SAACpQ,GAAC,OAAK6qB,EAAK2xJ,iBAAiBx8K,EAAE,IAC1EjC,KAAKi9K,UAAU5qK,iBAAiB,UAAU,SAACpQ,GAAC,OAAK6qB,EAAK4xJ,kBAAkBz8K,EAAE,IAC1EjC,KAAKi9K,UAAU5qK,iBAAiB,WAAW,SAACpQ,GAAC,OAAK6qB,EAAK6xJ,iBAAiB18K,EAAE,IAExDjC,KAAK08K,KAAKjiH,cAAc,+BAAiCz6D,KAAK07E,KACpErpE,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAK8xJ,sBAAsB38K,EAAE,IAC1DjC,KAAK08K,KAAKjiH,cAAc,6BAA+Bz6D,KAAK07E,KAClErpE,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAK+xJ,oBAAoB58K,EAAE,IAGlEjC,KAAKJ,QAAQ49K,cACTx9K,KAAKJ,QAAQ49K,YAAYE,UACzB19K,KAAK08K,KAAKp1J,UAAU7K,OAAO,gBAAiB,gBAC5Bzc,KAAK08K,KAAKjiH,cAAc,2BAA6Bz6D,KAAK07E,KAChEp0D,UAAUtG,IAAI,cACPhhB,KAAK08K,KAAKjiH,cAAc,wBAA0Bz6D,KAAK07E,KAC7Dp0D,UAAU7K,OAAO,eACXzc,KAAK08K,KAAKjiH,cAAc,wBAA0Bz6D,KAAK07E,KAC7Dp0D,UAAUtG,IAAI,eAEzBhhB,KAAKJ,QAAQ49K,YAAYC,QACzBl1K,EAAI+e,UAAUjZ,QAAQ,wCAAyC,iCAC/D9F,EAAI+e,UAAUjZ,QAAQ,2CAA4C,qCAEjErO,KAAKJ,QAAQ49K,YAAYjlF,WACZv4F,KAAK08K,KAAKjiH,cAAc,qBAAuBz6D,KAAK07E,KAC1Dp0D,UAAUtG,IAAI,cAErBhhB,KAAKJ,QAAQ49K,YAAYG,WACZ39K,KAAK08K,KAAKjiH,cAAc,qBAAuBz6D,KAAK07E,KAC1Dp0D,UAAUtG,IAAI,cAErBhhB,KAAKJ,QAAQ49K,YAAYI,cACV59K,KAAK08K,KAAKjiH,cAAc,uBAAyBz6D,KAAK07E,KAC5Dp0D,UAAUtG,IAAI,cAGpC,CACAzY,EAAIJ,YAAYnI,KAAK08K,MAIrB,IAAInoK,EAASvU,KAAKm+K,aAAa,8EAAD5tJ,OAGhBvwB,KAAK2f,QAAQ,kBAAiB,sIAAA4Q,OAElCpgB,EAAK,sCAUf,OALAnQ,KAAKuU,OAASA,EAAO2a,WACjBlvB,KAAKuU,QACLvU,KAAKuU,OAAOlC,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAKgyJ,oBAAoB78K,EAAE,IAGpEjC,KAAKJ,QAAQmoC,MACjB,IAAK,WACD/nC,KAAKuU,OAAO+S,UAAUtG,IAAI,mBAAoB,qBAC9C,MACJ,IAAK,YACDhhB,KAAKuU,OAAO+S,UAAUtG,IAAI,oBAAqB,sBAC/C,MAEJ,QACIhhB,KAAKuU,OAAO+S,UAAUtG,IAAI,kBAAmB,oBAIrD,GAAKhhB,KAAKJ,QAAQ+8K,MAAMpoK,OAGpB,OAAQvU,KAAKJ,QAAQ+8K,MAAMpoK,QACvB,IAAK,SACD,MACJ,IAAK,OACDvU,KAAKuU,OAAO+S,UAAUjZ,QAAQ,2BAA4B,0BAC1DrO,KAAKuU,OAAO+S,UAAUjZ,QAAQ,6BAA8B,4BAC5D,MACJ,QACIrO,KAAKuU,OAAO+S,UAAU7K,OAAO,2BAA4B,mCAVjEzc,KAAKuU,OAAO+S,UAAU7K,OAAO,2BAA4B,8BAc7DlU,EAAIJ,YAAYnI,KAAKuU,QAErBvU,KAAK2H,UAAYY,CACrB,GAEA,CAAAzB,IAAA,eAAAC,MAOA,SAAcy/B,GAeV,GAdc,WACV,IAAKjlC,OAAOoC,UACR,OAAO,EAEX,IAAIq2E,EAAS,IAAIr2E,UACjB,IACIq2E,EAAOp2E,gBAAgB,IAAK,YAChC,CAAE,MAAO+kD,GACL,OAAO,CACX,CACA,OAAO,CACX,CAGIo2H,GAGA,OAFa,IAAIp7K,WACAC,gBAAgB4iC,EAAK,aAC3B7kC,KAIf,IAAIg3C,EAAMnwC,SAASC,cAAc,OAEjC,OADAkwC,EAAIxmC,UAAYq0B,EACTmS,CACX,GAEA,CAAA7xC,IAAA,qBAAAC,MAKA,WAII,SAAI/G,KAAKJ,QAAQ8vB,SACgC,mBAAtC1vB,KAAKJ,QAAQ8vB,QAAQpN,cACa,mBAAlCtiB,KAAKJ,QAAQ8vB,QAAQjM,SAIpC,GAEA,CAAA3c,IAAA,iBAAAC,MAQA,SAAgByF,EAAO3M,EAAMZ,GAAO,IAAAuuB,EAAA,KAC5BviB,EAAS,KACb,IAAKuB,EAED,OADAnN,EAAOmU,KAAK,wDACLvI,EAEX,IAAKuB,EAAMuwD,cACNvwD,EAAMuwD,YAAY+yB,gBAClBtjF,EAAMuwD,YAAY+yB,cAAc1uF,OAEjC,OADA/B,EAAOmU,KAAK,6CACLvI,EAOXuB,EAAMuwD,YAAY+yB,cAAclmF,SAAQ,SAACkvB,IACzBA,EAAQvD,YACN/H,EAAK5tB,QAAQ8vB,SAAoD,mBAAlClC,EAAK5tB,QAAQ8vB,QAAQ6F,UAC9DuD,EAAQwC,SAAS9N,EAAK5tB,QAAQ8vB,QAAQ6F,WAE9C,IAGA,IAAI31B,EAAU,CACV+6B,aAAe17B,EACfm4F,WAAa,CAAC,GAEdv3F,IAGAD,EAAQw3F,WAAa,CACjB,qBAAuBv3F,IAI3BG,KAAKJ,QAAQ+G,cACb/G,EAAQw3F,WAAWzwF,YAAe3G,KAAKi9K,WAAaj9K,KAAKi9K,UAAUl2K,MAAS/G,KAAKi9K,UAAUl2K,MAAQ/G,KAAKJ,QAAQ+G,aAGpH,IAAIq4K,EAAY,KAChB,OAAQh/K,KAAKJ,QAAQD,OAAOgL,eACxB,IAAK,MACD/K,EAAQq/K,aAAc,EACtBr/K,EAAQs/K,gBAAiB,EACzBF,EAAY,IAAI3/E,EAAAA,EAAYz/F,GAC5B,MACJ,IAAK,MACDo/K,EAAY,IAAIhD,EAAAA,QAAYp8K,GAC5B,MACJ,IAAK,UACDo/K,EAAY,IAAIjvF,EAAAA,EAAgBnwF,GAMxC,IAAKo/K,EAED,OADA3/K,EAAOmU,KAAK,4CACLvI,EAGX,IAAIk0K,EAAW3yK,EAAMuwD,YAAY1wC,gBAK7BpmB,EAAMjG,KAAKiH,SACXhB,IACAk5K,EAAWA,GAAYl5K,EAAImmB,UAAUC,iBAGzC,IAAIwjE,EAAWrjF,EAAMuwD,YAAY+yB,cASjC,OALA7kF,EAAS+zK,EAAUhvF,cAAcH,EAAU,CACvCI,eAAiB,YACjBC,kBAAoBivF,GAAY,aAIxC,GAKA,CAAAr4K,IAAA,sBAAAC,MAIA,SAAqB9E,GACZjC,KAAKo/K,sBACN//K,EAAOmU,KAAK,8CAIhB,IAAIhH,EAASxM,KAAKJ,QAAQ8vB,cAA6CvP,IAAlCngB,KAAKJ,QAAQ8vB,QAAQjM,SAA0BzjB,KAAKJ,QAAQ8vB,QAAQjM,WAAazjB,KAAKJ,QAAQ4M,MAC/H3M,EAAQG,KAAKJ,QAAQ8vB,cAA4CvP,IAAjCngB,KAAKJ,QAAQ8vB,QAAQ0Y,QAAyBpoC,KAAKJ,QAAQ8vB,QAAQ0Y,UAAY,CAAC,EAChHnpC,EAASe,KAAKJ,QAAQ8vB,cAA6CvP,IAAlCngB,KAAKJ,QAAQ8vB,QAAQ6F,SAA0Bv1B,KAAKJ,QAAQ8vB,QAAQ6F,WAAa,CAAC,EAEnHr1B,EAAUF,KAAKq/K,eAAe7yK,EAAO3M,EAAMZ,GAC/C,GAAKiB,GAAuB,SAAZA,EAAhB,CA8BA,GATAF,KAAKi9C,cAAc,CACf/wC,KAAO,iBACPhM,QAAUA,EACVmI,KAAOrI,KAAKJ,QAAQyI,KACpB1B,YAAc3G,KAAKJ,QAAQ+G,YAC3BhH,OAASK,KAAKJ,QAAQD,OACtB6M,MAAQA,IAGRxM,KAAKJ,QAAQ29K,SAAU,CACvB,IAAI9zG,EAAOjhE,SAASC,cAAc,KAKlC,GAFAghE,EAAKxuD,aAAa,OAAQ,QAAUjb,KAAK6hE,SAAf,kBAAwD59B,mBAAmB/jC,IACrGupE,EAAKxuD,aAAa,WAAYjb,KAAKJ,QAAQyI,KAAOrI,KAAKylB,WACnDjd,SAAS01C,YAAa,CACtB,IAAIr9B,EAAQrY,SAAS01C,YAAY,eACjCr9B,EAAMs9B,UAAU,SAAS,GAAM,GAC/BsrB,EAAKxsB,cAAcp8B,EACvB,MACI4oD,EAAKxqD,OAEb,CAEIjf,KAAKJ,QAAQimC,UAA6C,mBAA1B7lC,KAAKJ,QAAQimC,UAC7C7lC,KAAKJ,QAAQimC,SAAS3lC,EAASsM,EA5CnC,CA8CJ,GAEA,CAAA1F,IAAA,sBAAAC,MAIA,SAAqB9E,GACjBjC,KAAK69K,UAAU57K,EAAEc,OAAOgE,MAC5B,GAEA,CAAAD,IAAA,oBAAAC,MAIA,SAAmB9E,GACfjC,KAAK89K,QAAQ77K,EAAEc,OAAOgE,MAC1B,GAAC,CAAAD,IAAA,mBAAAC,MAED,SAAkB9E,GACJjC,KAAKiH,UAIXjH,KAAKJ,QAAQ8vB,SAAmD,mBAAjC1vB,KAAKJ,QAAQ8vB,QAAQ4vJ,SACpDt/K,KAAKJ,QAAQ8vB,QAAQ4vJ,SAE7B,GAEA,CAAAx4K,IAAA,oBAAAC,MAIA,SAAmB9E,GACfjC,KAAK+9K,eAAe97K,EAAEc,OAAOgE,MACjC,GAAC,CAAAD,IAAA,mBAAAC,MAED,SAAkB9E,GACJjC,KAAKiH,UAIXjH,KAAKJ,QAAQ8vB,SAAmD,mBAAjC1vB,KAAKJ,QAAQ8vB,QAAQ4vJ,SACpDt/K,KAAKJ,QAAQ8vB,QAAQ4vJ,SAE7B,GAEA,CAAAx4K,IAAA,6BAAAC,MAIA,SAA4B9E,GACxBA,EAAEc,OAAOw8K,eAA2C,SAA1Bt9K,EAAEc,OAAOw8K,cACnC,IAAIlgK,EAAWrf,KAAK08K,KAAKjiH,cAAc,IAAMx4D,EAAEc,OAAOmpC,aAAa,kBAC9D7sB,IAGyB,SAA1Bpd,EAAEc,OAAOw8K,cACTlgK,EAASiI,UAAUtG,IAAI,yBACvBhhB,KAAK08K,KAAKp1J,UAAUtG,IAAI,sBACxBhhB,KAAK08K,KAAKp1J,UAAUtG,IAAI,yBACxB3B,EAASiI,UAAU7K,OAAO,qBAE1B4C,EAASiI,UAAU7K,OAAO,yBAC1Bzc,KAAK08K,KAAKp1J,UAAU7K,OAAO,sBAC3Bzc,KAAK08K,KAAKp1J,UAAU7K,OAAO,yBAC3B4C,EAASiI,UAAUtG,IAAI,oBAE/B,GAAC,CAAAla,IAAA,wBAAAC,MAED,SAAuB9E,GACnBjC,KAAK89K,QAAQ99K,KAAKg9K,UAAUj2K,OAC5B/G,KAAK+9K,eAAe/9K,KAAKi9K,UAAUl2K,OACnC/G,KAAK+8K,cAAc99J,OACvB,GAAC,CAAAnY,IAAA,sBAAAC,MAED,SAAqB9E,GACjBjC,KAAKg9K,UAAUj2K,MAAQ,GACvB/G,KAAKi9K,UAAUl2K,MAAQ,GACvB/G,KAAK+8K,cAAc99J,OACvB,GAKA,CAAAnY,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAK2H,SAChB,GAEA,CAAAb,IAAA,aAAAC,MAKA,SAAY2oB,GACR1vB,KAAKJ,QAAQ8vB,QAAUA,CAC3B,GAEA,CAAA5oB,IAAA,YAAAC,MAKA,SAAWhE,GACP/C,KAAKJ,QAAQmD,OAASA,CAC1B,GAEA,CAAA+D,IAAA,YAAAC,MAKA,SAAWpH,GAEP,OADAK,KAAKJ,QAAQD,OAASA,EAAOgL,cACrB3K,KAAKJ,QAAQD,QACjB,IAAK,MACDK,KAAKylB,UAAY,OACjBzlB,KAAK6hE,SAAW,uCAChB,MACJ,IAAK,MACD7hE,KAAKylB,UAAY,OACjBzlB,KAAK6hE,SAAW,sBAChB,MACJ,IAAK,UACD7hE,KAAKylB,UAAY,WACjBzlB,KAAK6hE,SAAW,uBAChB,MACJ,QAEI7hE,KAAKJ,QAAQD,OAAS,UACtBK,KAAKylB,UAAY,WACjBzlB,KAAK6hE,SAAW,uBAG5B,GAEA,CAAA/6D,IAAA,UAAAC,MAKA,SAASsB,GACLrI,KAAKJ,QAAQyI,KAAOA,CACxB,GAEA,CAAAvB,IAAA,iBAAAC,MAKA,SAAgBouD,GACZn1D,KAAKJ,QAAQ+G,YAAcwuD,CAC/B,GAEA,CAAAruD,IAAA,WAAAC,MAKA,SAAUoJ,GACNnQ,KAAKJ,QAAQuQ,MAAQA,EACjBnQ,KAAKuU,SAELvU,KAAKuU,OAAOqwC,YAAe5kD,KAAKJ,QAAQ88K,KAAQ18K,KAAKJ,QAAQ+8K,MAAMD,KAAOvsK,EAAQA,EAE1F,GAEA,CAAArJ,IAAA,UAAAC,MAKA,SAASmF,GAEL,GADAlM,KAAKJ,QAAQmoC,KAAO77B,EAChBlM,KAAKuU,OAGL,OAFAvU,KAAKuU,OAAO+S,UAAU7K,OAAO,mBAAoB,qBACjDzc,KAAKuU,OAAO+S,UAAU7K,OAAO,oBAAqB,sBAC1Czc,KAAKJ,QAAQmoC,MACjB,IAAK,WACD/nC,KAAKuU,OAAO+S,UAAUtG,IAAI,mBAAoB,qBAC9C,MACJ,IAAK,YACDhhB,KAAKuU,OAAO+S,UAAUtG,IAAI,oBAAqB,sBAC/C,MAEJ,QACIhhB,KAAKuU,OAAO+S,UAAUtG,IAAI,kBAAmB,oBAI7D,GAEA,CAAAla,IAAA,UAAAC,MAKA,SAASmY,GAML,GALAlf,KAAKJ,QAAQ88K,KAAOx9J,EAChBlf,KAAKuU,SAELvU,KAAKuU,OAAOqwC,YAAe5kD,KAAKJ,QAAQ88K,KAAQ18K,KAAKJ,QAAQ+8K,MAAMD,KAAO18K,KAAKJ,QAAQuQ,MAAQnQ,KAAKJ,QAAQuQ,OAE5GnQ,KAAK08K,MAAQ18K,KAAKJ,QAAQ88K,KAAM,CAEhC,IAAIh0K,EAAY1I,KAAK08K,KAAKh0K,UAC1B1I,KAAK08K,KAAKh0K,UAAYA,EAAU2F,QAAQrO,KAAKk9K,gBAAiB,IAI9D,IAFA,IAAIv9K,EAASK,KAAKJ,QAAQD,OAAOgL,cAC7ByzK,EAASp+K,KAAK08K,KAAKjvH,iBAAiB,oCAC/Br4C,EAAI,EAAGA,EAAIgpK,EAAOh9K,OAAQgU,IAAK,CACpC,IAAIipK,EAAQD,EAAOhpK,GACfipK,EAAMn6K,GAAGyG,cAAc7C,SAASnI,KAChC0+K,EAAMxoK,SAAU,EAExB,CACJ,CACJ,GAEA,CAAA/O,IAAA,iBAAAC,MAKA,SAAgBtF,GAEhB,GAEA,CAAAqF,IAAA,WAAAC,MAKA,SAAUyF,GACNxM,KAAKJ,QAAQ4M,MAAQA,CACzB,GAEA,CAAA1F,IAAA,cAAAC,MAKA,SAAaA,GACT/G,KAAKJ,QAAQ29K,SAAWx2K,CAC5B,I,4FAAC,CA76Ba,CAASM,KAk7B3BnG,OAAOwX,OAAOk3E,EAAazqF,UAAWq6K,GACtCt+K,OAAOwX,OAAOk3E,EAAazqF,UAAWk6D,EAAAA,GAEtC,UAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQ+vJ,OAAS7vF,E,2FC/6B/B,QApHyB,CAuBrB9qE,MAAQ,SAAUllB,GAED,IAAON,UAAU,sBACvBC,MAAM,CAAC,gCAEd,IAAIuL,EAAU,KAQV1L,EAAW,CAEX8M,KAAOtM,EAAQqlB,SAAW,SAAW,YACrCvlB,OAASE,EAAQ2K,WACjB0b,MAAQ,CACJjB,UAAY,KACZ48E,UAAY,KACZr5D,OAAS,KACTjkC,IAAM,KACN3E,OAAS,KACTslB,SAAW,KACXE,MAAQ,KACRC,SAAW,OAKnBhmB,EAAS6mB,MAAMjB,UAAYplB,EAAQolB,UACnC5lB,EAAS6mB,MAAMtmB,OAASC,EAAQiL,aAChCzL,EAAS6mB,MAAMhB,SAAWrlB,EAAQqlB,SAClC7lB,EAAS6mB,MAAMd,MAAQvlB,EAAQulB,MAC/B/lB,EAAS6mB,MAAMb,SAAWxlB,EAAQwlB,SAClChmB,EAAS6mB,MAAM9hB,SAAWvE,EAAQuE,SAGlC,IAAIquK,IAAkC,OAApB5yK,EAAQuL,SAA+C,mBAApBvL,EAAQuL,SACzDwnF,IAAsC,OAAtB/yF,EAAQ6K,WAAmD,mBAAtB7K,EAAQ6K,WAE7D3I,EAAU,KACd,OAAQlC,EAAQslB,KACZ,IAAK,OAED,IAAIutJ,EAAQ,IAAI,EAAA/sJ,EAAgBtmB,GAChC,IAAKqzK,EAAM/jI,uBAAwB,CAE/B,GADA5sC,EAAU,oCACN0wK,EAEA,YADA5yK,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa+B,IAGzD,MAAM,IAAIrC,MAAMqC,EACpB,CACAgJ,EAAU2nK,EAAMhkI,cAChB,MACJ,IAAK,MAWD,GATArvC,EAASmmB,IAAM,CACXwyC,QAAU,KACV5J,QAAU,KACVwS,WAAa,KACb8X,cAAgB,KAChB3tE,QAAU,QAGdA,EAAU,EAAA4a,EAAeZ,MAAM1lB,IACjB,CAEV,GADA0C,EAAU,mCACN0wK,EAEA,YADA5yK,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa+B,IAGzD,MAAM,IAAIrC,MAAMqC,EACpB,CACA,MACJ,QAEI,GADAA,EAAU,0DACN0wK,EAEA,YADA5yK,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa+B,IAGzD,MAAM,IAAIrC,MAAMqC,GAOxB,OAJI6wF,GACA/yF,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAO+K,GAGnCA,CACX,E,kCC7HA+1D,EAAc,EAAQ,MACTA,EAAYnoD,OACKmoD,EAAY4J,wBACrB5J,EAAYG,eACXH,EAAY8J,gBAClB9J,EAAYkJ,UACZlJ,EAAYM,UAEhC,IAAIL,EAAS,EAAQ,MACEA,EAAOviC,aACHuiC,EAAO/kC,iBACV+kC,EAAOjiC,cACViiC,EAAOtgC,WAE5B,IAAImY,EAAM,EAAQ,MACHA,EAAIk4B,KACIl4B,EAAIq4B,aACHr4B,EAAIm4B,cACVn4B,EAAI3mB,QACH2mB,EAAIs2B,SACIt2B,EAAI04B,iBACR14B,EAAIs4B,aACCt4B,EAAIk2B,kBACdl2B,EAAIi4B,QACLj4B,EAAIw4B,OACKx4B,EAAIy4B,gBACPz4B,EAAI40B,aACJ50B,EAAIq1B,aACZr1B,EAAIm2B,KACAn2B,EAAI20B,SACJ30B,EAAIu4B,SACSv4B,EAAI24B,sBACrB34B,EAAIo4B,KACKp4B,EAAI44B,cAE5B,IAAImuG,EAAY,EAAQ,MACxB3gL,EAAQ,GAAY2gL,EAAU/7K,UACC+7K,EAAUhqF,qBACZgqF,EAAU1oF,mBACR0oF,EAAUzoF,oB,wGCxCzCn4F,EAAOC,QAAUC,GAAGmtB,I,8BCYpB,SAASwzJ,IACL,KAAM3/K,gBAAgB2/K,GAClB,MAAM,IAAI17K,UAAU,uDAGxBjE,KAAK0rC,YAAc,KACnB1rC,KAAK4rC,eAAiB,KACtB5rC,KAAK8hC,EAAI,KACT9hC,KAAKyrC,IAAM,IACf,C,iBAEAk0I,EAAQx6K,UAAY,CAEhBC,YAAcu6K,GAIlB,S,6wBC7BA,IAAMC,EAAa,CAAC,gBAAiB,gBAkCrC,QAPmB,SAAUv7K,EAAUw7K,GACnC,IAAIC,EA1BR,SAAiCz7K,EAAUw7K,GAEvC,IAAIE,EAAiB,GAAHxvJ,OAAOqvJ,EAAY,CAAAC,IACjCG,EAAgB,GACpB,GAAI37K,GAAYA,EAASyD,SAAS,QAAS,CACvC,IAAIm4K,EAAaz3K,SAASqL,eAAe,kCACrCqsK,EAAU13K,SAASqL,eAAe,+BACtCmsK,EAAgB,GAAHzvJ,OAAA4vJ,EAAOF,EAAWh4K,UAAQk4K,EAAKD,EAAQj4K,UACxD,CACA,GAAI5D,GAAYA,EAASyD,SAAS,SAAU,CACxC,IAAIs4K,EAAc53K,SAASqL,eAAe,mCACtCwsK,EAAW73K,SAASqL,eAAe,gCACvCmsK,EAAgB,GAAHzvJ,OAAA4vJ,EAAOC,EAAYn4K,UAAQk4K,EAAKE,EAASp4K,UAC1D,CAEA,OAAO+3K,EAAcvwK,QAAO,SAAAusC,GACxB,IAAIskI,EAAUtkI,EAAE93C,GAAGwP,MAAM,gBAAgB,GACrC6sK,EAAcR,EAAej4K,SAASw4K,GAE1C,GAAiB,SADFtkI,EAAEjoC,qBAAqB,UAAU,GAAGm4B,aAAa,kBACpCq0I,EACxB,OAAOvkI,CAEf,GACJ,CAGsBwkI,CAAuBn8K,EAAUw7K,GAC/CC,EAAY1+K,OAAS,GACrB0+K,EAAY,GAAG/rK,qBAAqB,UAAU,GAAGkL,OAEzD,C,uQCikCA,QA/lCa,CAOTU,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAOAoiB,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,cAC5BhY,EAAUe,UAAY,8DACff,CACX,EAYA84K,2BAA6B,WAEzB,IAAI11K,EAAU/K,KAEVuU,EAAS/L,SAASC,cAAc,UAEhCoS,EAAOrS,SAASC,cAAc,QA2BlC,OA1BA8L,EAAOpM,YAAY0S,GACnBtG,EAAOrQ,GAAKlE,KAAK2f,QAAQ,uBACzBpL,EAAO7L,UAAY,8IACnB6L,EAAO0G,aAAa,aAAc,0BAClC1G,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAMxB1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ21K,oBAAoBz+K,EAChC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC+I,EAAQ21K,oBAAoBz+K,EAChC,IAGGsS,CACX,EAeAosK,uBAAyB,WACrB,IAAI3uH,EAASxpD,SAASC,cAAc,UAOpC,OANAupD,EAAO9tD,GAAKlE,KAAK2f,QAAQ,mBACzBqyC,EAAOtpD,UAAY,6BAKZspD,CACX,EAEA4uH,0BAA4B,WACxB,IAAIr4K,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,iCACTH,CACX,EAEAm4E,+BAAiC,WAC7B,IAAIn4E,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,oCACTH,CACX,EAOAs4K,6BAA+B,WAC3B,IAAIl4K,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OACvCd,EAAUe,UAAY,mDAEtB,IAAIH,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,yDAChBH,EAAI4J,UAAY,qBAChBxK,EAAUQ,YAAYI,GAyBtB,IAAIg9J,EAAW/8J,SAASC,cAAc,UACtC88J,EAASrhK,GAAKlE,KAAK2f,QAAQ,wBAC3B4lJ,EAAS78J,UAAY,wHACrB68J,EAASp1J,MAAQ,oBAGbo1J,EAASlzJ,iBACTkzJ,EAASlzJ,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBV,OACjE,IAAG,GACIsmJ,EAAShzJ,aAChBgzJ,EAAShzJ,YAAY,WAAW,WAC5B/J,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBV,OACjE,IAGJ,IAAIpE,EAAOrS,SAASC,cAAc,QAQlC,OAPAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjBo8I,EAASp9J,YAAY0S,GAErBlT,EAAUQ,YAAYo9J,GAEf59J,CACX,EAQAm5K,2BAA6B,WAEzB,IAAIn4K,EAAO3I,KAEP4lK,EAAOp9J,SAASC,cAAc,QAUlC,OATAm9J,EAAK1hK,GAAKlE,KAAK2f,QAAQ,kBACvBimJ,EAAKl9J,UAAY,8DAEjBk9J,EAAKvzJ,iBAAiB,UAAU,SAAUpQ,GAGtC,OAFAA,EAAEomB,iBACF1f,EAAKo4K,uBAAuB9+K,IACrB,CACX,IAEO2jK,CACX,EAOAob,8BAAgC,WAE5B,IAAIr4K,EAAO3I,KAEP2H,EAAYa,SAASC,cAAc,OACvCd,EAAUzD,GAAKlE,KAAK2f,QAAQ,qBAC5BhY,EAAUe,UAAY,6BAEtB,IAAIy+J,EAAS3+J,SAASC,cAAc,OAWpC,OAVA0+J,EAAOjjK,GAAKlE,KAAK2f,QAAQ,mBACzBwnJ,EAAOz+J,UAAY,8FACnBy+J,EAAOh3J,MAAQ,qBACfg3J,EAAO90J,iBAAiB,SAAS,SAAUpQ,GACvCuG,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBjX,UAAY,6BACvEF,SAASqL,eAAelL,EAAKgX,QAAQ,mBAAmBjX,UAAY,uCACpEC,EAAKs4K,yBAAyBh/K,EAClC,IACA0F,EAAUQ,YAAYg/J,GAEfx/J,CACX,EAYAu5K,4BAA8B,SAAU5zJ,EAAS6zJ,EAAgB7Z,GAC7D,IAAItiK,EAAWsoB,EAAQtoB,SACnBwnC,EAAWlf,EAAQroB,KACnBm8K,EAAS9zJ,EAAQ5e,SACjB2yK,EAAOF,EAAe18K,MACtByH,EAAOi1K,EAAezhL,OACtBsmK,EAAamb,EAAenb,WAE5Bz9J,EAAMC,SAASqL,eAAe7T,KAAK2f,QAAQ,sBAG3CpX,EAAIinB,mBAAqBjnB,EAAI2mB,WAAWhrB,KAAOlE,KAAK2f,QAAQ,yBAC5DpX,EAAI4mB,YAAY5mB,EAAI2mB,YAIxB,IAAIoyJ,EAAqB94K,SAASC,cAAc,OAChD64K,EAAmBp9K,GAAKlE,KAAK2f,QAAQ,wBACrC2hK,EAAmB54K,UAAY,UAI/B,IAAI64K,EAAgB/4K,SAASC,cAAc,OAC3C84K,EAAc74K,UAAY,oBAE1B,IAAI84K,EAAYh5K,SAASC,cAAc,SACvC+4K,EAAU94K,UAAY,yBACtB84K,EAAUrvK,UAAY,SACtBovK,EAAcp5K,YAAYq5K,GAE1B,IAAIC,EAAUj5K,SAASC,cAAc,OACrCg5K,EAAQv9K,GAAKlE,KAAK2f,QAAQ,yBAEtB8hK,EAAQtvK,UADC,SAATjG,EACoB,QAEA,WAExBq1K,EAAcp5K,YAAYs5K,GAE1BH,EAAmBn5K,YAAYo5K,GAI/B,IAAIG,EAAgBl5K,SAASC,cAAc,OAC3Ci5K,EAAch5K,UAAY,oBAE1B,IAAIi5K,EAAYn5K,SAASC,cAAc,SACvCk5K,EAAUj5K,UAAY,yBACtBi5K,EAAUxvK,UAAY,SACtBuvK,EAAcv5K,YAAYw5K,GAE1B,IAAI3a,EAAUx+J,SAASC,cAAc,OACrCu+J,EAAQ9iK,GAAKlE,KAAK2f,QAAQ,yBAC1BqnJ,EAAQ70J,UAAYkvK,EACpBK,EAAcv5K,YAAY6+J,GAE1Bsa,EAAmBn5K,YAAYu5K,GAG/B,IAAIE,EAAkBp5K,SAASC,cAAc,OAC7Cm5K,EAAgBl5K,UAAY,oBAE5B,IAAImgK,EAAcrgK,SAASC,cAAc,SACzCogK,EAAYngK,UAAY,yBACxBmgK,EAAY12J,UAAY,WACxByvK,EAAgBz5K,YAAY0gK,GAE5B,IAAIgZ,EAAYr5K,SAASC,cAAc,OAQvC,GAPAo5K,EAAU39K,GAAKlE,KAAK2f,QAAQ,2BAC5BkiK,EAAU1vK,UAAYm5B,WAAW81I,EAAO97K,GAAGopB,QAAQ,GAAK,KAAO4c,WAAW81I,EAAO77K,GAAGmpB,QAAQ,GAC5FkzJ,EAAgBz5K,YAAY05K,GAE5BP,EAAmBn5K,YAAYy5K,GAG3B58K,GAAgC,IAApBA,EAAS5D,OAAc,CACnC,IAAImmK,EAAoB/+J,SAASC,cAAc,OAC/C8+J,EAAkB7+J,UAAY,oBAE9B,IAAI8+J,EAAgBh/J,SAASC,cAAc,SAC3C++J,EAAc9+J,UAAY,yBAC1B8+J,EAAcr1J,UAAY,aAC1Bo1J,EAAkBp/J,YAAYq/J,GAE9B,IAAIC,EAAgB,EAGpB,GAFW9/I,SAAS3iB,EAAW,IAAM,IAI9B,CACH,IAAI0iK,EAAkBnwI,KAAKC,MAAMxyB,GAEjCyiK,GADAC,GAAoC,KACF,KACtC,MALID,EAAgBlwI,KAAKC,MAAMxyB,GAAY,KAO3C,IAAI2iK,EAAcn/J,SAASC,cAAc,OACzCk/J,EAAYzjK,GAAKlE,KAAK2f,QAAQ,yBAC9BgoJ,EAAYx1J,UAAYs1J,EACxBF,EAAkBp/J,YAAYw/J,GAE9B2Z,EAAmBn5K,YAAYo/J,EACnC,CAGA,GAAI/6H,GAAgC,IAApBA,EAASprC,OAAc,CACnC,IAAIwmK,EAAoBp/J,SAASC,cAAc,OAC/Cm/J,EAAkBl/J,UAAY,oBAE9B,IAAIm/J,EAAgBr/J,SAASC,cAAc,SAC3Co/J,EAAcn/J,UAAY,yBAC1Bm/J,EAAc11J,UAAY,UAC1By1J,EAAkBz/J,YAAY0/J,GAE9B,IAAIC,EAAct/J,SAASC,cAAc,OACzCq/J,EAAY5jK,GAAKlE,KAAK2f,QAAQ,yBAC9BmoJ,EAAY31J,UAAYm1J,EAAS96H,GACjCo7H,EAAkBz/J,YAAY2/J,GAE9BwZ,EAAmBn5K,YAAYy/J,EACnC,CAIA,GAAI5B,EAAW5kK,OAAS,EAAG,CACvB,IAAI0gL,EAAsBt5K,SAASC,cAAc,OACjDq5K,EAAoBp5K,UAAY,oBAEhC,IAAIq5K,EAAkBv5K,SAASC,cAAc,SAC7Cs5K,EAAgBr5K,UAAY,yBAC5Bq5K,EAAgB5vK,UAAY,eAC5B2vK,EAAoB35K,YAAY45K,GAEhC,IAAIC,EAAgBx5K,SAASC,cAAc,OAC3Cu5K,EAAc99K,GAAKlE,KAAK2f,QAAQ,+BAEhCqiK,EAAc7vK,UAAY6zJ,EAAWlgK,KAAK,MAC1Cg8K,EAAoB35K,YAAY65K,GAEhCV,EAAmBn5K,YAAY25K,EACnC,CAIA,OADAv5K,EAAIL,QAAQo5K,GACL/4K,CACX,EAOA05K,yBAA2B,WACvB,IAAI15K,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,kCACtBpX,EAAIG,UAAY,8EAEhB,IAAIszC,EAAIxzC,SAASC,cAAc,KAM/B,OALAuzC,EAAEtzC,UAAY,0CACdszC,EAAE7pC,UAAY,wBAEd5J,EAAIJ,YAAY6zC,GAETzzC,CACX,EAOA25K,6BAA+B,WAC3B,IAAIv6K,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUe,UAAY,mDAEff,CACX,EAOAw6K,8BAAgC,WAC5B,IAAInmI,EAAIxzC,SAASC,cAAc,KAK/B,OAJAuzC,EAAE93C,GAAKlE,KAAK2f,QAAQ,yBACpBq8B,EAAEtzC,UAAY,qBACdszC,EAAE7pC,UAAY,SAEP6pC,CACX,EAeAomI,qCAAuC,WACnC,IAAI75K,EAAMC,SAASC,cAAc,OAOjC,OANAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,oBACtBpX,EAAIG,UAAY,WAKTH,CACX,EASA85K,0CAA4C,SAAUxsK,GAClD,IAAIlN,EAAO3I,KAEPuI,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,gFAEhB,IAAIkM,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,4BACxB/K,EAAMvM,KAAO,uBACbuM,EAAM1I,KAAO,QACb0I,EAAMiB,UAAaA,EACfjB,EAAMvC,iBACNuC,EAAMvC,iBAAiB,UAAU,SAAUpQ,GACvCuG,SAASqL,eAAelL,EAAKgX,QAAQ,yBAAyBjX,UAAY,gCAC1EF,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBjX,UAAY,6BACzEF,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+BjX,UAAY,qBAChFF,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8BjX,UAAY,6BAC/EF,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB5Y,MAAQ,uBAClE4B,EAAK25K,sBAAsBrgL,EAC/B,IAAG,GACI2S,EAAMrC,aACbqC,EAAMrC,YAAY,YAAY,WAC1B/J,SAASqL,eAAelL,EAAKgX,QAAQ,yBAAyBjX,UAAY,gCAC1EF,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBjX,UAAY,6BACzEF,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+BjX,UAAY,qBAChFF,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8BjX,UAAY,6BAC/EF,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB5Y,MAAQ,uBAClE4B,EAAK25K,uBACT,IAGJ1tK,EAAM7N,MAAQ,WACdwB,EAAIJ,YAAYyM,GAEhB,IAAI1C,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,4CAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,4BAC7BzN,EAAMC,UAAY,QAClBD,EAAM/B,MAAQ,QACd5H,EAAIJ,YAAY+J,GAEhB,IAAI2I,EAAOrS,SAASC,cAAc,QAelC,OAdAoS,EAAK3W,GAAKlE,KAAK2f,QAAQ,+BACvB9E,EAAKnS,UAAY,aACjBmS,EAAK1I,UAAY,QACb0I,EAAKxI,iBACLwI,EAAKxI,iBAAiB,SAAS,WAC3B7J,SAASqL,eAAelL,EAAKgX,QAAQ,6BAA6BV,OACtE,IAAG,GACIpE,EAAKtI,aACZsI,EAAKtI,YAAY,WAAW,WACxB/J,SAASqL,eAAelL,EAAKgX,QAAQ,6BAA6BV,OACtE,IAEJ1W,EAAIJ,YAAY0S,GAETtS,CACX,EASAg6K,yCAA2C,SAAU1sK,GACjD,IAAIlN,EAAO3I,KAEPuI,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,gFAEhB,IAAIkM,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,2BACxB/K,EAAMvM,KAAO,uBACbuM,EAAM1I,KAAO,QACb0I,EAAMiB,UAAaA,EACfjB,EAAMvC,iBACNuC,EAAMvC,iBAAiB,UAAU,SAAUpQ,GACvCuG,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBjX,UAAY,gCACzEF,SAASqL,eAAelL,EAAKgX,QAAQ,yBAAyBjX,UAAY,6BAC1EF,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8BjX,UAAY,qBAC/EF,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+BjX,UAAY,6BAChFF,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB5Y,MAAQ,yBAClE4B,EAAK25K,sBAAsBrgL,EAC/B,IAAG,GACI2S,EAAMrC,aACbqC,EAAMrC,YAAY,YAAY,WAC1B/J,SAASqL,eAAelL,EAAKgX,QAAQ,wBAAwBjX,UAAY,gCACzEF,SAASqL,eAAelL,EAAKgX,QAAQ,yBAAyBjX,UAAY,6BAC1EF,SAASqL,eAAelL,EAAKgX,QAAQ,8BAA8BjX,UAAY,qBAC/EF,SAASqL,eAAelL,EAAKgX,QAAQ,+BAA+BjX,UAAY,6BAChFF,SAASqL,eAAelL,EAAKgX,QAAQ,qBAAqB5Y,MAAQ,yBAClE4B,EAAK25K,uBACT,IAGJ1tK,EAAM7N,MAAQ,cACdwB,EAAIJ,YAAYyM,GAEhB,IAAI1C,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,4CAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,2BAC7BzN,EAAMC,UAAY,WAClBD,EAAM/B,MAAQ,WAEd5H,EAAIJ,YAAY+J,GAEhB,IAAI2I,EAAOrS,SAASC,cAAc,QAelC,OAdAoS,EAAK3W,GAAKlE,KAAK2f,QAAQ,8BACvB9E,EAAKnS,UAAY,aACjBmS,EAAK1I,UAAY,WACb0I,EAAKxI,iBACLwI,EAAKxI,iBAAiB,SAAS,WAC3B7J,SAASqL,eAAelL,EAAKgX,QAAQ,4BAA4BV,OACrE,IAAG,GACIpE,EAAKtI,aACZsI,EAAKtI,YAAY,WAAW,WACxB/J,SAASqL,eAAelL,EAAKgX,QAAQ,4BAA4BV,OACrE,IAEJ1W,EAAIJ,YAAY0S,GAETtS,CACX,EAYAi6K,wCAA0C,SAAU3sK,GAChD,IACImmC,EAAIxzC,SAASC,cAAc,KAK/B,OAJAuzC,EAAE93C,GAAKlE,KAAK2f,QAAQ,8BACpBq8B,EAAEtzC,UAAamN,EAAW,qBAAuB,6BACjDmmC,EAAE7pC,UAAY,6BAEP6pC,CACX,EAQAymI,wCAA0C,SAAU5sK,GAEhD,IAAI9K,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,wBACtBpX,EAAIG,UAAamN,EAAW,gCAAkC,6BAE9D,IAAI6sK,EAASl6K,SAASC,cAAc,SACpCi6K,EAAOx+K,GAAKlE,KAAK2f,QAAQ,8BACzB+iK,EAAOh6K,UAAY,qBACnBg6K,EAAOjwK,IAAM,IACbiwK,EAAOpnK,KAAO,IACdonK,EAAO37K,MAAQ,IACf27K,EAAOx2K,KAAO,SACdw2K,EAAOvyK,MAAQ,QACXuyK,EAAOrwK,iBACPqwK,EAAOrwK,iBAAiB,UAAU,SAAUpQ,GACe,mBAA5C8I,EAAQ43K,iCACf53K,EAAQ63K,8BAA8B3gL,EAE9C,IACOygL,EAAOnwK,aACdmwK,EAAOnwK,YAAY,YAAY,SAAUtQ,GACkB,mBAA5C8I,EAAQ43K,iCACf53K,EAAQ63K,8BAA8B3gL,EAE9C,IAEJsG,EAAIJ,YAAYu6K,GAEhB,IAAIG,EAASr6K,SAASC,cAAc,SACpCo6K,EAAO1wK,UAAY,IACnB0wK,EAAOn6K,UAAY,qBACnBH,EAAIJ,YAAY06K,GAEhB,IAAIC,EAASt6K,SAASC,cAAc,SACpCq6K,EAAO5+K,GAAKlE,KAAK2f,QAAQ,8BACzBmjK,EAAOp6K,UAAY,qBACnBo6K,EAAOrwK,IAAM,IACbqwK,EAAOnwK,IAAM,KACbmwK,EAAOxnK,KAAO,IACdwnK,EAAO/7K,MAAQ,IACf+7K,EAAO52K,KAAO,SACd42K,EAAO3yK,MAAQ,SACX2yK,EAAOzwK,iBACPywK,EAAOzwK,iBAAiB,UAAU,SAAUpQ,GACe,mBAA5C8I,EAAQ43K,iCACf53K,EAAQ43K,gCAAgC1gL,EAEhD,IACO6gL,EAAOvwK,aACduwK,EAAOvwK,YAAY,YAAY,SAAUtQ,GACkB,mBAA5C8I,EAAQ43K,iCACf53K,EAAQ43K,gCAAgC1gL,EAEhD,IAEJsG,EAAIJ,YAAY26K,GAEhB,IAAIC,EAASv6K,SAASC,cAAc,SAKpC,OAJAs6K,EAAO5wK,UAAY,MACnB4wK,EAAOr6K,UAAY,qBACnBH,EAAIJ,YAAY46K,GAETx6K,CACX,EAQAy6K,2CAA6C,SAAUntK,GACnD,IACImmC,EAAIxzC,SAASC,cAAc,KAK/B,OAJAuzC,EAAE93C,GAAKlE,KAAK2f,QAAQ,6BACpBq8B,EAAEtzC,UAAamN,EAAW,qBAAuB,6BACjDmmC,EAAE7pC,UAAY,uBAEP6pC,CACX,EAQAinI,2CAA6C,SAAUptK,GAEnD,IAAI9K,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,uBACtBpX,EAAIG,UAAamN,EAAW,gCAAkC,6BAE9D,IAAI6sK,EAASl6K,SAASC,cAAc,SACpCi6K,EAAOx+K,GAAKlE,KAAK2f,QAAQ,4BACzB+iK,EAAOh6K,UAAY,8BACnBg6K,EAAOjwK,IAAM,IACbiwK,EAAOpnK,KAAO,MACdonK,EAAO37K,MAAQ,IACf27K,EAAOx2K,KAAO,SACdw2K,EAAOvyK,MAAQ,WACXuyK,EAAOrwK,iBACPqwK,EAAOrwK,iBAAiB,UAAU,SAAUpQ,GACI,mBAAjC8I,EAAQm4K,sBACfn4K,EAAQm4K,qBAAqBjhL,EAErC,IACOygL,EAAOnwK,aACdmwK,EAAOnwK,YAAY,YAAY,SAAUtQ,GACO,mBAAjC8I,EAAQm4K,sBACfn4K,EAAQm4K,qBAAqBjhL,EAErC,IAEJsG,EAAIJ,YAAYu6K,GAEhB,IAAIG,EAASr6K,SAASC,cAAc,SAKpC,OAJAo6K,EAAO1wK,UAAY,KACnB0wK,EAAOn6K,UAAY,qBACnBH,EAAIJ,YAAY06K,GAETt6K,CACX,EAaA46K,8CAAgD,SAAU1Z,GAEtD,IAAI1+J,EAAU/K,KAEV0pK,EAAelhK,SAASC,cAAc,OAC1CihK,EAAaxlK,GAAKlE,KAAK2f,QAAQ,6BAE/B,IAAIzN,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,yCAClBwJ,EAAMC,UAAY,iCAClBu3J,EAAavhK,YAAY+J,GAKzB,IAHA,IAAIkxK,EAAiB56K,SAASC,cAAc,OAGnC2M,EAAI,EAAGA,EAAIq0J,EAAWroK,OAAQgU,IAAK,CACxC,IAAIgxJ,EAAYqD,EAAWr0J,GAEvB7M,EAAMC,SAASC,cAAc,OAGjC,GAFAF,EAAIG,UAAY,oEAEE,YAAd09J,EAAyB,CACzB,IAAIwD,EAAWphK,SAASC,cAAc,SACtCmhK,EAAS1lK,GAAKlE,KAAK2f,QAAQ,0BAC3BiqJ,EAAS19J,KAAO,QAChB09J,EAASvhK,KAAO,sBACN,IAAN+M,IACAw0J,EAAS/zJ,SAAU,GAKnB+zJ,EAASv3J,iBACTu3J,EAASv3J,iBAAiB,UAAU,SAAUpQ,GAC1C8I,EAAQs4K,yBAAyBphL,EACrC,IACO2nK,EAASr3J,aAChBq3J,EAASr3J,YAAY,YAAY,SAAUtQ,GACvC8I,EAAQs4K,yBAAyBphL,EACrC,IAGJ2nK,EAAS7iK,MAAQ,UACjBwB,EAAIJ,YAAYyhK,GAEhB,IAAIE,EAAWthK,SAASC,cAAc,SACtCqhK,EAASphK,UAAY,4CACrBohK,EAASpzJ,QAAU1W,KAAK2f,QAAQ,0BAChCmqJ,EAAS35J,MAAQ,UACjB25J,EAAS33J,UAAY,UACrB5J,EAAIJ,YAAY2hK,EACpB,CAEA,GAAkB,WAAd1D,EAAwB,CACxB,IAAI2D,EAAkBvhK,SAASC,cAAc,SAC7CshK,EAAgB7lK,GAAKlE,KAAK2f,QAAQ,iCAClCoqJ,EAAgB79J,KAAO,QACvB69J,EAAgB1hK,KAAO,sBACb,IAAN+M,IACA20J,EAAgBl0J,SAAU,GAK1Bk0J,EAAgB13J,iBAChB03J,EAAgB13J,iBAAiB,UAAU,SAAUpQ,GACjD8I,EAAQs4K,yBAAyBphL,EACrC,IACO8nK,EAAgBx3J,aACvBw3J,EAAgBx3J,YAAY,YAAY,SAAUtQ,GAC9C8I,EAAQs4K,yBAAyBphL,EACrC,IAGJ8nK,EAAgBhjK,MAAQ,SACxBwB,EAAIJ,YAAY4hK,GAEhB,IAAIC,EAAkBxhK,SAASC,cAAc,SAC7CuhK,EAAgBthK,UAAY,4CAC5BshK,EAAgBtzJ,QAAU1W,KAAK2f,QAAQ,iCACvCqqJ,EAAgB75J,MAAQ,SACxB65J,EAAgB73J,UAAY,SAC5B5J,EAAIJ,YAAY6hK,EACpB,CAEAoZ,EAAej7K,YAAYI,EAC/B,CAGA,OAFAmhK,EAAavhK,YAAYi7K,GAElB1Z,CACX,EASA4Z,8CAAgD,SAAUC,GAEtD,IAAI56K,EAAO3I,KAEPuI,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,6BACtBpX,EAAIG,UAAY,WAEhB,IAAIwJ,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMC,UAAY,8BAClBD,EAAMxJ,UAAY,WAClBH,EAAIJ,YAAY+J,GAEhB,IAAIo3E,EAAS9gF,SAASC,cAAc,UACpC6gF,EAAOplF,GAAKlE,KAAK2f,QAAQ,6BACzB2pE,EAAO5gF,UAAY,gCACnB4gF,EAAOn5E,MAAQ,mBAIfm5E,EAAOj3E,iBAAiB,UAAU,SAAUpQ,GACxC0G,EAAK66K,yBAAyBvhL,EAClC,IAEA,IAAK,IAAImT,EAAI,EAAGA,EAAImuK,EAAWniL,OAAQgU,IAAK,CACxC,IAAIu6B,EAAY4zI,EAAWnuK,GAC3B,GAAgC,cAA5Bu6B,EAAU5nC,cAA+B,CACzC,IAAI07K,EAAkBj7K,SAASC,cAAc,UACnC,IAAN2M,IACAquK,EAAgB/tK,SAAW,YAE/B+tK,EAAgB18K,MAAQ,YACxB08K,EAAgB5hL,KAAO,SACvBynF,EAAOnhF,YAAYs7K,EACvB,CACA,GAAgC,YAA5B9zI,EAAU5nC,cAA6B,CACvC,IAAI27K,EAAgBl7K,SAASC,cAAc,UACjC,IAAN2M,IACAsuK,EAAchuK,SAAW,YAE7BguK,EAAc38K,MAAQ,UACtB28K,EAAc7hL,KAAO,UACrBynF,EAAOnhF,YAAYu7K,EACvB,CACJ,CAGA,OAFAn7K,EAAIJ,YAAYmhF,GAET/gF,CACX,EAWAo7K,qCAAuC,WACnC,IAAIh7K,EAAO3I,KAEPuU,EAAS/L,SAASC,cAAc,UACpC8L,EAAOrQ,GAAKlE,KAAK2f,QAAQ,4BACzB,IAAI6oD,EAAS,GA2Bb,OA1BIz+D,EAAAA,EAAAA,OACAy+D,EAAS,8BAEbj0D,EAAO7L,UAAY,6FAAH6nB,OAAgGi4C,EAAM,kFACtHj0D,EAAOpE,MAAQ,aAEfoE,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GAGhC1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvCA,EAAEomB,iBACF,IAAIrmB,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAKi7K,uBAAuB3hL,EAChC,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpCA,EAAEomB,iBACF,IAAIrmB,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAKi7K,uBAAuB3hL,EAChC,IAGGsS,CACX,EAOAsvK,qCAAuC,WACnC,IAAIt7K,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,mBAEtB,IAAIzN,EAAQ1J,SAASC,cAAc,SAOnC,OANAyJ,EAAMxJ,UAAY,0CAClBwJ,EAAMC,UAAY,qBAClB5J,EAAIJ,YAAY+J,GAIT3J,CACX,EASAu7K,2CAA6C,SAAU9d,GAEnD,IAAIj7J,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OAIjC,IAAK,IAAI1B,KAHTwB,EAAIG,UAAY,4DAGEs9J,EACd,GAAIA,EAAWt7J,eAAe3D,GAAQ,CAClC,IAAI/E,EAASgkK,EAAWj/J,GACxB,OAAQA,GACJ,IAAK,OACD,IAAI6jK,EAAYpiK,SAASC,cAAc,SACvCmiK,EAAU1mK,GAAKlE,KAAK2f,QAAQ,uBAC5BirJ,EAAU1+J,KAAO,WACjB0+J,EAAUviK,KAAO,SACjBuiK,EAAU/0J,SAAW7T,EAIjB4oK,EAAUv4J,iBACVu4J,EAAUv4J,iBAAiB,UAAU,SAAUpQ,GAC3C8I,EAAQg5K,sBAAsB9hL,EAClC,IACO2oK,EAAUr4J,aACjBq4J,EAAUr4J,YAAY,YAAY,SAAUtQ,GACxC8I,EAAQg5K,sBAAsB9hL,EAClC,IAGJ2oK,EAAU7jK,MAAQ,OAClBwB,EAAIJ,YAAYyiK,GAEhB,IAAIE,EAAYtiK,SAASC,cAAc,SACvCqiK,EAAUpiK,UAAY,wBACtBoiK,EAAUp0J,QAAU1W,KAAK2f,QAAQ,uBACjCmrJ,EAAU34J,UAAY,SACtB5J,EAAIJ,YAAY2iK,GAChB,MAEJ,IAAK,SACD,IAAIC,EAAcviK,SAASC,cAAc,SACzCsiK,EAAY7mK,GAAKlE,KAAK2f,QAAQ,yBAC9BorJ,EAAY7+J,KAAO,WACnB6+J,EAAY1iK,KAAO,SACnB0iK,EAAYl1J,SAAW7T,EAInB+oK,EAAY14J,iBACZ04J,EAAY14J,iBAAiB,UAAU,SAAUpQ,GAC7C8I,EAAQg5K,sBAAsB9hL,EAClC,IACO8oK,EAAYx4J,aACnBw4J,EAAYx4J,YAAY,YAAY,SAAUtQ,GAC1C8I,EAAQg5K,sBAAsB9hL,EAClC,IAGJ8oK,EAAYhkK,MAAQ,SACpBwB,EAAIJ,YAAY4iK,GAEhB,IAAIC,EAAcxiK,SAASC,cAAc,SACzCuiK,EAAYtiK,UAAY,wBACxBsiK,EAAYt0J,QAAU1W,KAAK2f,QAAQ,yBACnCqrJ,EAAY74J,UAAY,UACxB5J,EAAIJ,YAAY6iK,GAChB,MAEJ,IAAK,SACD,IAAIC,EAAcziK,SAASC,cAAc,SACzCwiK,EAAY/mK,GAAKlE,KAAK2f,QAAQ,yBAC9BsrJ,EAAY/+J,KAAO,WACnB++J,EAAY5iK,KAAO,QACnB4iK,EAAYp1J,SAAW7T,EAInBipK,EAAY54J,iBACZ44J,EAAY54J,iBAAiB,UAAU,SAAUpQ,GAC7C8I,EAAQg5K,sBAAsB9hL,EAClC,IACOgpK,EAAY14J,aACnB04J,EAAY14J,YAAY,YAAY,SAAUtQ,GAC1C8I,EAAQg5K,sBAAsB9hL,EAClC,IAGJgpK,EAAYlkK,MAAQ,SACpBwB,EAAIJ,YAAY8iK,GAEhB,IAAIC,EAAc1iK,SAASC,cAAc,SACzCyiK,EAAYxiK,UAAY,wBACxBwiK,EAAYx0J,QAAU1W,KAAK2f,QAAQ,yBACnCurJ,EAAY/4J,UAAY,QACxB5J,EAAIJ,YAAY+iK,GAG5B,CAGJ,OAAO3iK,CACX,EAYAy7K,4BAA8B,WAC1B,IAAIpvK,EAAQpM,SAASC,cAAc,SAMnC,OALAmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,oBACxB/K,EAAMlM,UAAY,0BAClBkM,EAAM1I,KAAO,SACb0I,EAAM7N,MAAQ,uBAEP6N,CACX,EAWAqvK,2BAA6B,WACzB,IAAIt7K,EAAO3I,KAEPqrK,EAAc7iK,SAASC,cAAc,UAazC,OAZA4iK,EAAYnnK,GAAKlE,KAAK2f,QAAQ,mBAC9B0rJ,EAAY3iK,UAAY,kIACxB2iK,EAAYl7J,MAAQ,+BACpBk7J,EAAYpwJ,aAAa,WAAY,KACrCowJ,EAAYpwJ,aAAa,gBAAgB,GAEzCowJ,EAAYh5J,iBAAiB,SAAS,SAAUpQ,GAC5C,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAKu7K,gBAAgBjiL,EACzB,IAEOopK,CACX,G,8rDC1jCJ,IAAIhsK,EAAS2Q,EAAAA,EAAO1Q,UAAU,YAiE1B6kL,EAAQ,SAAAh+K,GAYR,SAAAg+K,EAAavkL,GAAS,IAAAyG,E,MAMlB,G,4FANkBC,CAAA,KAAA69K,G,EAIlB,K,EAAA,CAHAvkL,EAAUA,GAAW,CAAC,G,MAGtBukL,MAAA99K,E,6EAEsB89K,GAClB,MAAM,IAAIlgL,UAAU,2BAgBxB,OAVAoC,EAAKnB,UAAY,WAEjBmB,EAAK6jB,WAAWtqB,GAGhByG,EAAK8jB,WAAa9jB,EAAKigB,8BAGtBjgB,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAK8jB,YAAc9jB,EAAKG,QAAUH,EAAK8jB,WAEjFC,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAAu9K,EAAAh+K,G,EAAAg+K,E,EAAA,EAAAr9K,IAAA,SAAAC,MAKA,SAAQd,GACJ,GAAIA,EAAK,CAKL,GAHAjG,KAAKmqB,WAAanqB,KAAKsQ,eAAerK,GAGlCjG,KAAKJ,QAAO,OAAS,CACrB,IAAI6B,EAAOgP,EAAAA,EAAMiI,OAAO,CAAEgX,QAAU1vB,MAAQA,KAAKJ,QAAO,QACxDI,KAAI,OAAU,IAAI4vF,EAAAA,QAAanuF,GAC/BzB,KAAI,OAAQyG,SACZ,IAAIkC,EAAO3I,KACXA,KAAI,OAAQ+tB,GAAG,kBAAkB,SAAC9rB,GAC9B0G,EAAKs0C,cAAc,CACf/wC,KAAO,iBACPhM,QAAU+B,EAAE/B,SAEpB,GACJ,CAGIF,KAAK62C,WACL00H,EAAAA,EAAUhrE,YACNvgG,KAAKokL,mBACLpkL,KAAKqkL,yBACLp+K,EAAIuoB,oBAKPxuB,KAAKq2D,WACNr2D,KAAKskL,gBAAgBrpK,aAAa,gBAAgB,EAE1D,C,iBAGAkpK,E,EAAA,S,EAAA,K,WAAA,G,kFAAA,CAAal+K,IAGTjG,KAAKJ,QAAQyE,UACbrE,KAAKi3D,YAAYj3D,KAAKJ,QAAQyE,WAIN,IAAxBrE,KAAKJ,QAAQs3D,QACbl3D,KAAKsiB,eAAegF,UAAUtG,IAAI,uBAE1C,GAMA,CAAAla,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKq2D,SAChB,GAEA,CAAAvvD,IAAA,eAAAC,MAKA,SAAcsvD,QACQl2C,IAAdk2C,EAICA,GAAar2D,KAAKq2D,YAAgBA,IAAcr2D,KAAKq2D,YAGtDA,EACA7tD,SAASqL,eAAe,wBAA0B7T,KAAK4f,MAAMX,QAE7Djf,KAAKskL,gBAAgBrlK,QAEzBjf,KAAKq2D,UAAYA,GAXbh3D,EAAOqD,IAAI,8DAYnB,GAEA,CAAAoE,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAKukL,aAChB,GAEA,CAAAz9K,IAAA,WAAAC,MAKA,SAAUyF,GACDA,EAKCA,aAAiBsuD,KAMvBtuD,EAAM8uB,SAASt7B,KAAK4rK,sBAGpB5rK,KAAKukL,cAAgB/3K,GARjBnN,EAAOqD,IAAI,oDALX1C,KAAKukL,cAAgB,IAc7B,GAEA,CAAAz9K,IAAA,aAAAC,MAKA,WACI,OAAOvD,KAAKqC,UAAU7F,KAAK6rK,eAC/B,GAEA,CAAA/kK,IAAA,aAAAC,MAKA,SAAY+kK,GACR,IACI9rK,KAAK6rK,eAAiBroK,KAAKC,MAAMqoK,EACrC,CAAE,MAAO7pK,GACL5C,EAAOqD,IAAI,2BAA6BT,EAAEH,QAC9C,CACJ,GAEA,CAAAgF,IAAA,UAAAC,MAKA,WACI,IAAIlH,EAAO,CACPqM,KAAO,WACPk6J,UAAYpmK,KAAKisK,kBACjB9F,YAAcnmK,KAAKmsK,oBACnBnG,WAAahmK,KAAKksK,mBAClBv8H,UAAY3vC,KAAKwkL,kBACjBpgL,MAAQpE,KAAKykL,aAAazY,gBAC1B1+I,QAAU,CAAC,GAGf,OADA7c,EAAAA,EAAMiI,OAAO7Y,EAAKytB,QAASttB,KAAK0kL,oBACzB7kL,CACX,GAEA,CAAAiH,IAAA,UAAAC,MAWA,SAASlH,GACLG,KAAKisK,kBAAoBpsK,EAAKumK,UAC9BpmK,KAAKmsK,oBAAsBtsK,EAAKsmK,YAChCnmK,KAAKksK,mBAAqBrsK,EAAKmmK,WAC/BhmK,KAAKwkL,kBAAoB3kL,EAAK8vC,UAKXnnC,SAASqL,eAAe,6BAAuC7T,KAAK4f,MAC1E/J,SAAU,EACvB,IAAI8uK,EAAiBn8K,SAASqL,eAAe,sBAAgC7T,KAAK4f,MAChEpX,SAASqL,eAAe,4BAAsC7T,KAAK4f,MACzE7Y,MAAQlH,EAAKuE,MACzBugL,EAAe59K,MAAQlH,EAAKuE,MAAM,GAAGsqB,QAAQ,GAAK,MAAQ7uB,EAAKuE,MAAM,GAAGsqB,QAAQ,GAChF1uB,KAAKykL,aAAapY,cAAcxsK,EAAKuE,MAAO,aAC5CpE,KAAK0kL,mBAAqB7kL,EAAKytB,OACnC,GAEA,CAAAxmB,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKmqB,UAChB,GAEA,CAAArjB,IAAA,WAAAC,MAKA,WACI,OAAO/G,KAAK4rK,oBAChB,GAEA,CAAA9kK,IAAA,UAAAC,MAQA,SAAS1C,EAAU0C,EAAOnH,GAStB,GARAI,KAAKowK,SAGY,SADJpwK,KAAKskL,gBAAgB57J,aAE9B1oB,KAAKskL,gBAAgBrlK,QAGfjf,KAAKiH,SACf,CAKA,IAAI7H,EAAW,CACXuwC,UAAY,YACZjwC,OAAS,OACT0mK,UAAY,UACZJ,WAAa,IAIjBv1J,EAAAA,EAAMiI,OAAOtZ,EAAUQ,GAEvBI,KAAKykL,aAAapY,cAAchoK,GAChC,IAAI6nB,EAAalsB,KAAKykL,aAAazY,gBAenC,GAbYxjK,SAASqL,eAAe,sBAAgC7T,KAAK4f,MACnE7Y,MAAQmlB,EAAW,GAAGwC,QAAQ,GAAK,MAAQxC,EAAW,GAAGwC,QAAQ,GAEvE1uB,KAAKisK,kBAAoB7sK,EAASgnK,UACP,YAAvBhnK,EAASgnK,UACT59J,SAASqL,eAAe,0BAA4B7T,KAAK4f,MAAM/J,SAAU,EAEzErN,SAASqL,eAAe,iCAAmC7T,KAAK4f,MAAM/J,SAAU,EAGpF7V,KAAKksK,mBAAqB9sK,EAAS4mK,WAEnChmK,KAAKmsK,oBAAsB/sK,EAASM,OACZ,SAApBN,EAASM,OAAmB,CAC5B,IAAIuF,EAAO8B,EAAM6R,MAAM,KACvB5Y,KAAK4kL,iBAAmB3/K,EAAK,IAAM,EACnCuD,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK4kL,iBAChF5kL,KAAK6kL,mBAAqB5/K,EAAK,IAAM,EACrCuD,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK6kL,mBAChFr8K,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAMX,OACrE,MACIjf,KAAK8kL,iBAAmB/9K,EACxByB,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK8kL,iBAC9Et8K,SAASqL,eAAe,2BAA6B7T,KAAK4f,MAAMX,QAGpEjf,KAAKwkL,kBAAoBplL,EAASuwC,UAE5BnnC,SAASqL,eAAe,6BAA+B7T,KAAK4f,MAAMmlK,cADhD,cAAvB3lL,EAASuwC,UAC8E,EAAsF,EAE9K3vC,KAAK+gL,wBA9CL,CA+CJ,GAEA,CAAAj6K,IAAA,OAAAC,MAIA,WAEI,IAAImlB,EAAalsB,KAAKykL,aAAazY,gBAanC,GAXYxjK,SAASqL,eAAe,sBAAgC7T,KAAK4f,MACnE7Y,MAAQmlB,EAAW,GAAGwC,QAAQ,GAAK,MAAQxC,EAAW,GAAGwC,QAAQ,GAGxC,YAA3B1uB,KAAKisK,kBACLzjK,SAASqL,eAAe,0BAA4B7T,KAAK4f,MAAM/J,SAAU,EAEzErN,SAASqL,eAAe,iCAAmC7T,KAAK4f,MAAM/J,SAAU,EAInD,SAA7B7V,KAAKmsK,oBAAgC,CACrC,IAAIt8H,EAAU7vC,KAAK0kL,mBAAmBz/K,KAAO,GAC7CjF,KAAK4kL,iBAAmBrtJ,KAAKyR,MAAM6G,EAAU,IAC7CrnC,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK4kL,iBAChF5kL,KAAK6kL,mBAAqBttJ,KAAKC,MAAiD,IAAzCqY,EAAU,GAAM7vC,KAAK4kL,mBAC5Dp8K,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK6kL,mBAChFr8K,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAMX,OACrE,MACIjf,KAAK8kL,iBAAmB9kL,KAAK0kL,mBAAmB1/K,SAAW,IAC3DwD,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAM7Y,MAAQ/G,KAAK8kL,iBAC9Et8K,SAASqL,eAAe,2BAA6B7T,KAAK4f,MAAMX,QAIxC,cAA3Bjf,KAAKwkL,kBACAh8K,SAASqL,eAAe,6BAA+B7T,KAAK4f,MAAMmlK,cAAgB,EAAIv8K,SAASqL,eAAe,6BAA+B7T,KAAK4f,MAAMmlK,cAAgB,EAE9K/kL,KAAKglL,qBAAqBt8K,UAAY,EAC1C,GAEA,CAAA5B,IAAA,QAAAC,MAGA,WACI/G,KAAKilL,kBAILjlL,KAAKykL,aAAa/3J,eAClBlkB,SAASqL,eAAe,qBAAuB7T,KAAK4f,MAAM3gB,MAAMunB,QAAU,GAC1Ehe,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAM7Y,MAAQ,GACzEyB,SAASqL,eAAe,sBAAwB7T,KAAK4f,MAAM7Y,MAAQ,GACnEyB,SAASqL,eAAe,qBAAuB7T,KAAK4f,MAAM3gB,MAAMunB,QAAU,GAC1Ehe,SAASqL,eAAe,6BAA+B7T,KAAK4f,MAAM/J,SAAU,EAC5ErN,SAASqL,eAAe,sBAAwB7T,KAAK4f,MAAMlX,UAAY,sCACvEF,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAAMlX,UAAY,oCAC7E1I,KAAK0kL,mBAAqB,KAC1B1kL,KAAKqwF,WAELrwF,KAAKglL,qBAAqBt8K,UAAY,4BAC1C,GAMA,CAAA5B,IAAA,aAAAC,MAMA,SAAYnH,GACRI,KAAKmtK,mBAAmBvtK,GAGxBI,KAAKJ,QAAU,CACXy2D,WAAY,EACZxf,WAAY,EACZ05C,QAAS,EACT20F,QAAU,CAAC,OAAQ,YACnBx4F,OAAS,CAAC,SAAU,WACpBs5E,WAAa,CACToH,MAAO,EACPC,QAAS,EACTC,QAAS,GAEbiW,WAAa,CAAC,YAAa,WAC3Bx3J,WAAa,CACTvsB,IAAMwsB,EAAAA,EAAqB,YAC3BriB,OAASqiB,EAAAA,EAAQC,eAErBk5J,gBAAkB,CAAC,EACnB16J,oBAAsB,CAAC,EACvB21D,iBAAmB,CACfjwE,MAAQ,wBACRxJ,YAAc,6CAKtB8J,EAAAA,EAAMiI,OAAO1Y,KAAKJ,QAASA,GAG3BI,KAAKq2D,UAAYr2D,KAAKJ,QAAQy2D,UAG9Br2D,KAAK62C,UAAY72C,KAAKJ,QAAQi3C,UAG9B72C,KAAK4f,KAAO5f,KAAKJ,QAAQsE,IAAMwmB,EAAAA,EAAWxV,WAI1ClV,KAAKisK,kBAAoB,KACzBjsK,KAAK8tK,iBAEL9tK,KAAKmsK,oBAAsB,KAC3BnsK,KAAK+tK,mBAEL/tK,KAAKksK,mBAAqB,GAC1BlsK,KAAKguK,kBAELhuK,KAAKwkL,kBAAoB,KACzBxkL,KAAKolL,iBAGLplL,KAAKykL,aAAe,KAGpBzkL,KAAKskL,gBAAkB,KACvBtkL,KAAK4uF,kBAAoB,KACzB5uF,KAAKqlL,eAAiB,KACtBrlL,KAAKglL,qBAAuB,KAC5BhlL,KAAKokL,mBAAqB,KAC1BpkL,KAAKqkL,yBAA2B,KAGhCrkL,KAAK0kL,mBAAqB,KAG1B1kL,KAAKukL,cAAgB,KACrBvkL,KAAK6rK,eAAiB,KAGtB7rK,KAAI,OAAU,KAGdA,KAAK6yF,UAAW,EAEhB7yF,KAAKiuK,OAAS,KAGdjuK,KAAK4rK,qBAAuB,IAAI37J,EAAAA,MAAM,CAClCiM,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,2BAEZD,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,uBACRF,MAAQ,MAWhB9X,KAAK0rB,WAAa,CAAC,EAGnB1rB,KAAK2rB,YAAc,IACvB,GAEA,CAAA7kB,IAAA,qBAAAC,MAOA,SAAoBnH,GAGhB,IAAIwV,EAGJ,GAAIxV,EAAQslL,QACR,GAAI17K,MAAM4E,QAAQxO,EAAQslL,SAEtB,GAA+B,IAA3BtlL,EAAQslL,QAAQ9jL,OAChBxB,EAAQslL,QAAU,UAElB,IAAK9vK,EAAI,EAAGA,EAAIxV,EAAQslL,QAAQ9jL,OAAQgU,IACF,iBAAvBxV,EAAQslL,QAAQ9vK,IACvB/V,EAAOqD,IAAI,8FAKvBrD,EAAOmU,KAAK,0CACZ5T,EAAQslL,QAAU,KAK1B,GAAItlL,EAAQ8sF,OACR,GAAIljF,MAAM4E,QAAQxO,EAAQ8sF,QAEtB,GAA8B,IAA1B9sF,EAAQ8sF,OAAOtrF,OACfxB,EAAQ8sF,OAAS,UAEjB,IAAKt3E,EAAI,EAAGA,EAAIxV,EAAQ8sF,OAAOtrF,OAAQgU,IACF,iBAAtBxV,EAAQ8sF,OAAOt3E,GACtB/V,EAAOqD,IAAI,yFAE6B,WAApC9C,EAAQ8sF,OAAOt3E,GAAGrN,gBAClBnI,EAAQ8sF,OAAOt3E,GAAK,UAEgB,YAApCxV,EAAQ8sF,OAAOt3E,GAAGrN,gBAClBnI,EAAQ8sF,OAAOt3E,GAAK,iBAMpC/V,EAAOmU,KAAK,yCACZ5T,EAAQ8sF,OAAS,KAKzB,GAAI9sF,EAAQ2jL,WACR,GAAI/5K,MAAM4E,QAAQxO,EAAQ2jL,YAEtB,GAAkC,IAA9B3jL,EAAQ2jL,WAAWniL,OACnBxB,EAAQ2jL,WAAa,UAErB,IAAKnuK,EAAI,EAAGA,EAAIxV,EAAQ2jL,WAAWniL,OAAQgU,IACF,iBAA1BxV,EAAQ2jL,WAAWnuK,IAC1B/V,EAAOqD,IAAI,iGAKvBrD,EAAOmU,KAAK,6CACZ5T,EAAQ2jL,WAAa,KAKH,SAAtB3jL,EAAQy2D,YACRz2D,EAAQy2D,WAAY,GAEE,UAAtBz2D,EAAQy2D,YACRz2D,EAAQy2D,WAAY,EAE5B,GAEA,CAAAvvD,IAAA,iBAAAC,MAMA,WAEI/G,KAAKisK,kBAAoB,SAGzB,IAAIxC,EAAazpK,KAAKJ,QAAQ8sF,OACzB+8E,GAAoC,IAAtBA,EAAWroK,SAC1BpB,KAAKJ,QAAQ8sF,OAAS,CAAC,SAAU,YAIjCljF,MAAM4E,QAAQq7J,IAAeA,EAAWroK,SAElB,YAAlBqoK,EAAW,IAAsC,WAAlBA,EAAW,KAC1CzpK,KAAKisK,kBAAoBxC,EAAW,KAK5C,IAAIh8I,EAAiBztB,KAAKJ,QAAQulL,gBAC9B13J,EAAehpB,QACfzE,KAAKisK,kBAAoBx+I,EAAehpB,MAEhD,GAEA,CAAAqC,IAAA,mBAAAC,MAMA,WAEI/G,KAAKmsK,oBAAsB,OAG3B,IAAI+Y,EAAUllL,KAAKJ,QAAQslL,QACtBA,GAA8B,IAAnBA,EAAQ9jL,SACpBpB,KAAKJ,QAAQslL,QAAU,CAAC,OAAQ,aAIhC17K,MAAM4E,QAAQ82K,IAAYA,EAAQ9jL,SAEf,SAAf8jL,EAAQ,IAAgC,aAAfA,EAAQ,KACjCllL,KAAKmsK,oBAAsB+Y,EAAQ,KAK3C,IAAIz3J,EAAiBztB,KAAKJ,QAAQulL,gBAC9B13J,EAAe/tB,SACfM,KAAKmsK,oBAAsB1+I,EAAe/tB,QAE1C+tB,EAAexoB,OACfjF,KAAKmsK,oBAAsB,QAE3B1+I,EAAezoB,WACfhF,KAAKmsK,oBAAsB,WAEnC,GAEA,CAAArlK,IAAA,iBAAAC,MAMA,WAEI/G,KAAKwkL,kBAAoB,YAGzB,IAAIjB,EAAavjL,KAAKJ,QAAQ2jL,WACzBA,GAAoC,IAAtBA,EAAWniL,SAC1BpB,KAAKJ,QAAQ2jL,WAAa,CAAC,YAAa,YAIxC/5K,MAAM4E,QAAQm1K,IAAeA,EAAWniL,SAElB,cAAlBmiL,EAAW,IAAwC,YAAlBA,EAAW,KAC5CvjL,KAAKwkL,kBAAoBjB,EAAW,KAK5C,IAAI91J,EAAiBztB,KAAKJ,QAAQulL,gBAC7B13J,EAAe9oB,UAChB3E,KAAKwkL,kBAAoB,cAEE,IAA3B/2J,EAAe9oB,UACf3E,KAAKwkL,kBAAoB,UACzBxkL,KAAKJ,QAAQ2jL,WAAa,CAAC,UAAW,aAE9C,GAEA,CAAAz8K,IAAA,kBAAAC,MAKA,WAEI/G,KAAKksK,mBAAqB,GAG1B,IAAI6C,EAAY/uK,KAAKJ,QAAQomK,WAU7B,KATK+I,GAAmC,WAArB30J,EAAO20J,IAA4D,IAAlC7tK,OAAOC,KAAK4tK,GAAW3tK,UACvEpB,KAAKJ,QAAQomK,WAAa,CACtBoH,MAAO,EACPC,QAAS,EACTC,QAAS,IAKbyB,GAAkC,WAArB30J,EAAO20J,IAA0B7tK,OAAOC,KAAK4tK,GAAW3tK,OACrE,IAAK,IAAIuE,KAAKopK,EACNA,EAAUrkK,eAAe/E,IACrBopK,EAAUppK,GACV3F,KAAKksK,mBAAmBtmK,KAAKD,GAO7C,IAAI8nB,EAAiBztB,KAAKJ,QAAQulL,gBAC9B37K,MAAM4E,QAAQqf,EAAeu4I,cAC7BhmK,KAAKksK,mBAAqBz+I,EAAeu4I,WAEjD,GAMA,CAAAl/J,IAAA,iBAAAC,MASA,SAAgBd,GAAK,IAAA6mB,EAAA,KAEbnlB,EAAY3H,KAAKmqB,WACrB,GAAIxiB,EAAU6nB,kBAAoB,EAC9B,OAAO7nB,EAGX,IAAIoyD,EAAQ/5D,KAAKskL,gBAAkBtkL,KAAKygL,6BACxC94K,EAAUQ,YAAY4xD,GAGtB,IAAIlwD,EAAQ7J,KAAKokL,mBAAqBpkL,KAAK2gL,yBACvCtvF,EAAWrxF,KAAK4gL,4BACpB/2K,EAAM1B,YAAYkpF,GAGlB,IAAIv8B,EAAS90D,KAAKqkL,yBAA2BrkL,KAAK6gL,+BAClDxvF,EAASlpF,YAAY2sD,GAGrB,IAAI8wG,EAAO5lK,KAAKqlL,eAAiBrlL,KAAK8gL,6BAEtClb,EAAKz9J,YAAYnI,KAAKmjL,8CAA8CnjL,KAAKJ,QAAQ8sF,SAGjFk5E,EAAKz9J,YAAYnI,KAAKmiL,iCACtB,IAAI/9K,EAAQpE,KAAKslL,gCAAgCr/K,GACjD2/J,EAAKz9J,YAAY/D,GAKjB,IAHA,IAAImhL,GAAkB,EAClBC,GAAiB,EACjBC,EAAazlL,KAAKoiL,uCACbhtK,EAAI,EAAGA,EAAIpV,KAAKJ,QAAQslL,QAAQ9jL,OAAQgU,IACb,SAA5BpV,KAAKJ,QAAQslL,QAAQ9vK,KACrBmwK,EAAyB,IAANnwK,EACnBqwK,EAAWt9K,YAAYnI,KAAKqiL,0CAA0CkD,KAE1C,aAA5BvlL,KAAKJ,QAAQslL,QAAQ9vK,KACrBowK,EAAwB,IAANpwK,EAClBqwK,EAAWt9K,YAAYnI,KAAKuiL,yCAAyCiD,KAe7E,GAZA5f,EAAKz9J,YAAYs9K,GAGjB7f,EAAKz9J,YAAYnI,KAAKwiL,wCAAwC+C,IAC9D3f,EAAKz9J,YAAYnI,KAAKyiL,wCAAwC8C,IAC9D3f,EAAKz9J,YAAYnI,KAAKgjL,2CAA2CwC,IACjE5f,EAAKz9J,YAAYnI,KAAKijL,2CAA2CuC,IAGjE5f,EAAKz9J,YAAYnI,KAAKsjL,8CAA8CtjL,KAAKJ,QAAQ2jL,aAG7EvjL,KAAKJ,QAAQomK,YAAkD,WAAnC5rJ,EAAOpa,KAAKJ,QAAQomK,aAA6E,IAAhD9kK,OAAOC,KAAKnB,KAAKJ,QAAQomK,YAAY5kK,OAAe,CACjIwkK,EAAKz9J,YAAYnI,KAAK2jL,wCACtB,IAAI5U,EAAY/uK,KAAK6jL,uCACrB9U,EAAU5mK,YAAYnI,KAAK8jL,2CAA2C9jL,KAAKJ,QAAQomK,aACnFJ,EAAKz9J,YAAY4mK,EACrB,CAGA,IAAI2W,EAAS1lL,KAAKkiL,+BAGlB,GAFAtc,EAAKz9J,YAAYu9K,KAEZ37K,EAAAA,EAAAA,KAAa,CACd,IAAIshK,EAAcrrK,KAAKikL,6BACvByB,EAAOv9K,YAAYkjK,EACvB,CAGA,IAAI4D,EAAejvK,KAAK2lL,iBAAmB3lL,KAAKgkL,8BAChD0B,EAAOv9K,YAAY8mK,GAEnB59E,EAASlpF,YAAYy9J,GAGrB,IAAIggB,EAAa5lL,KAAKglL,qBAAuBhlL,KAAKghL,gCAClD3vF,EAASlpF,YAAYy9K,GAErB,IAAI9pI,EAAS97C,KAAK0gF,iCAClB2Q,EAASlpF,YAAY2zC,GAGrB,IAAIw1C,EAAUtxF,KAAK4uF,kBAAoB5uF,KAAKiiL,2BAU5C,OATAp4K,EAAM1B,YAAYmpF,GAElB3pF,EAAUQ,YAAY0B,GAGlBlC,EAAU0K,kBACV1K,EAAU0K,iBAAiB,SAAS,SAACpQ,GAAC,OAAK6qB,EAAK+4J,2BAA2B5jL,EAAE,IAG1E0F,CACX,GAEA,CAAAb,IAAA,kCAAAC,MAQA,SAAiCd,GAC7BjG,KAAKykL,aAAe,IAAIx6J,EAAAA,QAAiB,CACrCpe,OAAS7L,KAAKJ,QAAQiM,QAAU,KAChCgb,IAAM,CACF3iB,GAAK,EACLmmB,QAAUrqB,KAAK4f,KACfmM,WAAa/rB,KAAKJ,QAAQmsB,WAC1B/X,SAAU,GAEdyW,oBAAsBzqB,KAAKJ,QAAQ6qB,qBAAuB,OAE9DzqB,KAAKykL,aAAanV,OAAOrpK,GAEzB,IAAI0C,EAAO3I,KAqDX,OAnDAwI,SAASqL,eAAe,gCAAkC7T,KAAK4f,MAAMyvJ,QAAU,WAC3E1mK,EAAKm9K,qBACL,IAAI7/K,EAAM0C,EAAK1B,SACX0B,EAAK87K,aAAa15J,2BAA2BlV,SAE7ClN,EAAK08K,eAAe38K,UAAY,0DAEhC1I,KAAK2rB,YAAc1lB,EAAI8nB,GACnB,SACA,WACIplB,EAAK08K,eAAe38K,UAAY,uCAChCC,EAAKs0C,cAAc,mBACvB,MAIJt0C,EAAK08K,eAAe38K,UAAY,wCAGhCmkB,EAAAA,EAAAA,SAAoB7sB,KAAK2rB,cAO7BhjB,EAAKs0C,cAAc,qBACvB,EAEAz0C,SAASqL,eAAe,2BAA6B7T,KAAK4f,MAAMyvJ,QAAU,WACtE1mK,EAAKm9K,qBACLn9K,EAAK08K,eAAe38K,UAAY,uCAEhCzC,EAAI8/K,GACA,SACA,WACIp9K,EAAK08K,eAAe38K,UAAY,sCACpC,IAEJC,EAAKs0C,cAAc,mBACvB,EAEAz0C,SAASqL,eAAe,sBAAwB7T,KAAK4f,MAAMyvJ,QAAU,WACjE1mK,EAAKm9K,qBAMLn9K,EAAKs0C,cAAc,mBACvB,EACOj9C,KAAKykL,aAAat6J,UAC7B,GAMA,CAAArjB,IAAA,yBAAAC,MAOA,WAEI,GAAK/G,KAAKykL,cAAiBzkL,KAAKykL,aAAazY,eAAkBhsK,KAAKykL,aAAazY,gBAAjF,CAMA,IAQI/mK,EACAD,EATAghL,EAAsBhmL,KAAKykL,aAAazY,gBACxC3nK,EAAW,CACXiB,EAAI0gL,EAAoB,GACxBzgL,EAAIygL,EAAoB,IAO5B,GALA3mL,EAAOqD,IAAI,YAAa2B,GAKuB,SAA3CrE,KAAKmsK,oBAAoBpkK,cAA0B,CACnD,IAAIk+K,EAAgBz9K,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAC7EmxB,EAAQppB,SAASs+J,EAAcl/K,MAAO,IACtC2pC,OAASA,MAAMK,KACfA,EAAQ,GAEZ,IAAIm1I,EAAmB19K,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAChFiwB,EAAUloB,SAASu+J,EAAiBn/K,MAAO,IAC3C2pC,OAASA,MAAMb,KACfA,EAAU,GAGd5qC,EAAe,KAAR8rC,EAAyB,GAAVlB,EACtBxwC,EAAOqD,IAAI,UAAYuC,EAC3B,CACA,GAA+C,aAA3CjF,KAAKmsK,oBAAoBpkK,cAA8B,CACvD,IAAIo+K,EAAY39K,SAASqL,eAAe,4BAA8B7T,KAAK4f,MAE3E5a,EAAyC,IAA9BsmC,WAAW66I,EAAUp/K,OAChC1H,EAAOqD,IAAI,cAAgBsC,EAC/B,CAGA,GAAKC,GAASD,EAAd,CAMA,IAAIpF,EAAUI,KAAKJ,QAAQulL,iBAAmB,CAAC,EAI3CpV,EAAYnwK,EAAQuK,UAAY,MAChC6lK,EAAWpwK,EAAQE,SAAW,EAChB,UAAdiwK,GAAsC,IAAbC,IAEzBA,EAAW,MAIf,IAAIt9E,IAAsC,OAAtB9yF,EAAQe,WAAmD,mBAAtBf,EAAQe,WAC7DgyF,IAAsC,OAAtB/yF,EAAQ6K,WAAmD,mBAAtB7K,EAAQ6K,WAG7DM,EAAU/K,KACVomL,EAAoB,CACpB/hL,SAAWA,EACXI,MAAQ7E,EAAQ6E,OAASzE,KAAKisK,kBAC9BjG,WAAapmK,EAAQomK,YAAchmK,KAAKksK,mBACxCxsK,OAASE,EAAQF,QAAUM,KAAKmsK,oBAChCuN,UAAY95K,EAAQ85K,YAAa,EACjC55K,QAAUkwK,EACV7lK,SAAW4lK,EACX5rK,SAAWvE,EAAQuE,SAEnBsG,UAAY,SAAU6iB,GAClBjuB,EAAOqD,IAAI4qB,GACPA,IACAviB,EAAQs7K,uBAAuB/4J,EAAS84J,GACxCr7K,EAAQu7K,gBAAgBh5J,IAExBqlE,GACA/yF,EAAQ6K,UAAUtL,KAAK4L,EAASuiB,EAExC,EAEA3sB,UAAY,SAAUD,GAElBqK,EAAQ+hK,wBACRztK,EAAOqD,IAAIhC,EAAMoB,SACb4wF,GACA9yF,EAAQe,UAAUxB,KAAK4L,EAASrK,EAExC,IAE0C,YAAzCV,KAAKwkL,kBAAkBz8K,eAAiCnI,EAAQ+E,WACjEyhL,EAAkBzhL,SAAU,GAE5BM,IACAmhL,EAAkBnhL,KAAOA,GAEzBD,IACAohL,EAAkBphL,SAAWA,GAGjChF,KAAKumL,iBAAiBH,EA5DtB,MAFI/mL,EAAOqD,IAAI,2EArCf,MAFIrD,EAAOqD,IAAI,mEAsGnB,GAEA,CAAAoE,IAAA,sBAAAC,MAQA,SAAqB9E,GACjB,IAAI+4D,EAASh7D,KAAKskL,gBAAgB57J,YACnB,SAAXsyC,GACAh7D,KAAKgoC,cAGT,IAAI/hC,EAAMjG,KAAKiH,SAEf43E,EAAAA,EAAalnD,MAAM1xB,GACnBjG,KAAKq2D,YAAyB,SAAX2E,GAGnBh7D,KAAKi9C,cAAc,oBAEfj9C,KAAKJ,QAAQyE,WAAarE,KAAKq2D,WAC/Br2D,KAAKi7D,eAAej7D,KAAKJ,QAAQyE,SAEzC,GAEA,CAAAyC,IAAA,wBAAAC,MAQA,SAAuB9E,GACnB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MAChBA,IAGS,gBAAVA,IACA/G,KAAKmsK,oBAAsB,YAEjB,aAAVplK,IACA/G,KAAKmsK,oBAAsB,QAEnC,GAEA,CAAArlK,IAAA,2BAAAC,MAQA,SAA0B9E,GACtB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MAChBA,IAGL/G,KAAKisK,kBAAoBllK,EAC7B,GAEA,CAAAD,IAAA,2BAAAC,MAQA,SAA0B9E,GACtB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MAChBA,IAGuB,YAAxBA,EAAMgB,cACNS,SAASqL,eAAe,yBAA2B7T,KAAK4f,MAAMzN,UAAY,UAE1E3J,SAASqL,eAAe,yBAA2B7T,KAAK4f,MAAMzN,UAAY,SAE9EnS,KAAKwkL,kBAAoBz9K,EAC7B,GAEA,CAAAD,IAAA,wBAAAC,MASA,SAAuB9E,GACnB,IAAI8E,EAAQ9E,EAAEc,OAAOgE,MACjB8O,EAAU5T,EAAEc,OAAO8S,QAEvB,GAAK9O,EAAL,CAMA,IAFA,IAAI4R,GAAS,EACT43J,EAAS,KACJn7J,EAAI,EAAGA,EAAIpV,KAAKksK,mBAAmB9qK,OAAQgU,IAC5CoxK,EAAUxmL,KAAKksK,mBAAmB92J,GAAIrO,EAAMgB,iBAC5CwoK,EAASn7J,EACTuD,GAAS,GAIZA,GAAW9C,GACZ7V,KAAKksK,mBAAmBtmK,KAAKmB,EAAMgB,eAGnC4Q,GAAU9C,IACV7V,KAAKksK,mBAAmBqE,GAAU,KAhBtC,CAkBJ,GAEA,CAAAzpK,IAAA,kBAAAC,MAOA,WAEI/G,KAAKowK,QACT,GAEA,CAAAtpK,IAAA,2BAAAC,MAOA,WAEI/G,KAAK8lL,qBAML9lL,KAAKi9C,cAAc,iBACvB,GAEA,CAAAn2C,IAAA,yBAAAC,MAIA,WAA2B,GAM3B,CAAAD,IAAA,mBAAAC,MAOA,SAAkBnH,IAETA,GAAgC,WAAnBwa,EAAOxa,IAA0D,IAAhCsB,OAAOC,KAAKvB,GAASwB,QAInExB,EAAQyE,WAMc,kBAAhBzE,EAAQwK,MACiB,kBAArBpK,KAAKJ,QAAQwK,IACpBxK,EAAQwK,IAAMpK,KAAKJ,QAAQwK,IAE3BxK,EAAQwK,KAAM,GAItB/K,EAAOqD,IAAI9C,GAGXI,KAAK8lL,qBAGL9lL,KAAK2wK,2BAGLthJ,EAAAA,GAAGC,SAASwX,SAASlnC,GACzB,GAEA,CAAAkH,IAAA,yBAAAC,MAUA,SAAwBumB,EAAS6zJ,GAE7BnhL,KAAKymL,gCAAgCn5J,EAAS6zJ,GAG9CnhL,KAAK0mL,wBAA0Bp5J,EAa/BttB,KAAKi9C,cAAc,CACf/wC,KAAO,gBAIXlM,KAAKqlL,eAAe38K,UAAY,kEAChC1I,KAAK8sK,wBACL9sK,KAAKglL,qBAAqBt8K,UAAY,iBAC1C,GAEA,CAAA5B,IAAA,kCAAAC,MAUA,SAAiCumB,EAAS6zJ,GACtCnhL,KAAK2mL,2BAA6B3mL,KAAKkhL,4BAA4B5zJ,EAAS6zJ,EAAgBxyI,EAAAA,EAAUmC,qBAC1G,GAEA,CAAAhqC,IAAA,kBAAAC,MAOA,SAAiBumB,GAAS,IAAAE,EAAA,KAMtB,GAJAxtB,KAAK0kL,mBAAqBp3J,EAE1BttB,KAAK8sK,wBAEAx/I,EAAQ3e,SAAb,CAIA,IAAI1I,EAAMjG,KAAKiH,SAGfjH,KAAK6rK,eAAiB,CAClB3/J,KAAO,oBACP5H,IAAM,CACF4H,KAAO,OACPglK,WAAa,CACT7oK,KAAO,cAGfwnF,SAAW,CACP,CACI3jF,KAAO,UACP5H,IAAM,CACF4H,KAAO,OACPglK,WAAa,CACT7oK,KAAO,cAGfsG,SAAW2e,EAAQ3e,YAI/B3O,KAAK6rK,eAAeh8E,SAASjqF,KAAK,CAC9BsG,KAAO,UACPyC,SAAW,CACPzC,KAAO,QACPgmF,YAAclyF,KAAKykL,aAAazY,iBAEpCkF,WAAa,CACTvqK,YAAc,kBACd,gBAAkB3G,KAAKJ,QAAQmsB,WAAWvsB,OAGlD,IAwBIiF,EAxBA8sK,EAAgB,IAAIxhF,EAAAA,EAAgB,CACpCohF,sBAAwB,YACxBx2I,aAAe36B,KAAK4rK,uBAEpB19I,EAAUjoB,EAAImmB,UAAUC,gBAAgBC,UACxCujE,EAAW0hF,EAAcH,aACzBpxK,KAAK6rK,eAAgB,CACjB57E,eAAiB,YACjBC,kBAAoBhiE,IAKxBxuB,EAAuC,SAA7BM,KAAKmsK,oBAAkC,YAAc,cAuCnE,GArCAnsK,KAAKukL,cAAgB,IAAIzpH,IAAJ,CAAgB,CACjCl+C,OAAS,IAAIsjE,IAAJ,CAAiB,CACtB2P,SAAWA,IAEf5wF,MAAQe,KAAK4rK,qBACb3zJ,QAAU,GACV9H,MAAQ,OAASzQ,IAIU,WAA3BM,KAAKisK,mBACLxnK,EAAQ,SACRzE,KAAKukL,cAAc9mH,gBAAkB,2CAErCh5D,EAAQ,UACRzE,KAAKukL,cAAc9mH,gBAAkB,2CAGzCx3D,EAAI4wD,SAAS72D,KAAKukL,eAclBvkL,KAAKi9C,cAAc,CACf/wC,KAAO,qBAIP2jF,EAAS,IAAMA,EAAS,GAAGp2D,eAAiBo2D,EAAS,GAAGp2D,cAAc6kC,YAAa,CACnF,IAAI9iC,EAASq0D,EAAS,GAAGp2D,cAAc6kC,YACvCr4D,EAAImmB,UAAU+xC,IAAI3iC,EAAQv1B,EAAIm4D,UAClC,CAGI1+D,EAAuC,SAA7BM,KAAKmsK,oBAAkC,YAAc,cACnElmK,EAAIk6E,cAAcv2E,SACd,SAAC8lB,GACG,GAAIA,aAAmBymC,EAAAA,QAAe,CAElC,IAAIrC,EAAUtmC,EAAK+2J,cAAc5tH,UAE7BjnC,EAAQtO,QAAQ0yC,GAAS3jD,QAAU2jD,GACnCpkC,EAAQmnC,SACJrpC,EAAK+2J,cAAe,CAChBp0K,MAAQqd,EAAK5tB,QAAQwgF,iBAAiBjwE,MAAQ,KAAOzQ,EAAS,IAAM+E,EAAQ,IAC5EkC,YAAc6mB,EAAK5tB,QAAQwgF,iBAAiBz5E,aAI5D,CACJ,GA/GJ,CAiHJ,GAMA,CAAAG,IAAA,SAAAC,MAMA,WAEI/G,KAAKilL,kBAGLjlL,KAAKykL,aAAav7K,QAGlBlJ,KAAK8lL,qBAGL9lL,KAAK0kL,mBAAqB,IAC9B,GAEA,CAAA59K,IAAA,kBAAAC,MAMA,WAII,IAAIk/K,EAAgBz9K,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAC7EqmK,IACAA,EAAcl/K,MAAQ,KAG1B,IAAIm/K,EAAmB19K,SAASqL,eAAe,8BAAgC7T,KAAK4f,MAChFsmK,IACAA,EAAiBn/K,MAAQ,KAG7B,IAYIulK,EAcAC,EA1BA4Z,EAAY39K,SAASqL,eAAe,4BAA8B7T,KAAK4f,MACvEumK,IACAA,EAAUp/K,MAAQ,KAItB/G,KAAK8tK,iBACL9tK,KAAK+tK,mBACL/tK,KAAKolL,iBACLplL,KAAKguK,kBAI0B,WAA3BhuK,KAAKisK,mBACLK,EAAe9jK,SAASqL,eAAe,iCAAmC7T,KAAK4f,SAE3E0sJ,EAAaz2J,QAAU,SAG3By2J,EAAe9jK,SAASqL,eAAe,0BAA4B7T,KAAK4f,SAEpE0sJ,EAAaz2J,QAAU,QAMgB,aAA3C7V,KAAKmsK,oBAAoBpkK,gBACzBwkK,EAAiB/jK,SAASqL,eAAe,2BAA6B7T,KAAK4f,SAEvE2sJ,EAAe12J,QAAU,QAEzBrN,SAASqL,eAAe,uBAAyB7T,KAAK4f,QACtDpX,SAASqL,eAAe,uBAAyB7T,KAAK4f,MAAMlX,UAAY,wBAExEF,SAASqL,eAAe,wBAA0B7T,KAAK4f,QACvDpX,SAASqL,eAAe,wBAA0B7T,KAAK4f,MAAMlX,UAAY,iCAG7E6jK,EAAiB/jK,SAASqL,eAAe,4BAA8B7T,KAAK4f,SAExE2sJ,EAAe12J,QAAU,QAEzBrN,SAASqL,eAAe,wBAA0B7T,KAAK4f,QACvDpX,SAASqL,eAAe,wBAA0B7T,KAAK4f,MAAMlX,UAAY,wBAEzEF,SAASqL,eAAe,uBAAyB7T,KAAK4f,QACtDpX,SAASqL,eAAe,uBAAyB7T,KAAK4f,MAAMlX,UAAY,+BAKhF,IAAIk+K,EAAkBp+K,SAASqL,eAAe,6BAA+B7T,KAAK4f,MAC9EgnK,IACAA,EAAgB7/K,MAAQ/G,KAAKwkL,mBAEW,YAAxCoC,EAAgB7/K,MAAMgB,cACtBS,SAASqL,eAAe,yBAA2B7T,KAAK4f,MAAMzN,UAAY,UAE1E3J,SAASqL,eAAe,yBAA2B7T,KAAK4f,MAAMzN,UAAY,SAI9E,IAAIq6J,EAAYhkK,SAASqL,eAAe,uBAAyB7T,KAAK4f,MAClE4sJ,KACiD,IAA7CxsK,KAAKksK,mBAAmBzyJ,QAAQ,QAChC+yJ,EAAU32J,SAAU,EAEpB22J,EAAU32J,SAAU,GAG5B,IAAI42J,EAAcjkK,SAASqL,eAAe,yBAA2B7T,KAAK4f,MACtE6sJ,KACmD,IAA/CzsK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCgzJ,EAAY52J,SAAU,EAEtB42J,EAAY52J,SAAU,GAG9B,IAAI62J,EAAclkK,SAASqL,eAAe,yBAA2B7T,KAAK4f,MACtE8sJ,KACmD,IAA/C1sK,KAAKksK,mBAAmBzyJ,QAAQ,UAChCizJ,EAAY72J,SAAU,EAEtB62J,EAAY72J,SAAU,EAGlC,GAEA,CAAA/O,IAAA,qBAAAC,MAMA,WACI,IAAId,EAAMjG,KAAKiH,SAEXjH,KAAKukL,gBACLt+K,EAAI8wD,YAAY/2D,KAAKukL,eACrBvkL,KAAKukL,cAAgB,MAGzBvkL,KAAK6rK,eAAiB,IAC1B,GAEA,CAAA/kK,IAAA,6BAAAC,MAQA,SAA4B9E,GAEpBA,EAAEc,QAAUd,EAAEc,OAAOmB,KAAoD,IAA9CjC,EAAEc,OAAOmB,GAAGuV,QAAQ,sBAI/CzZ,KAAKykL,aAAa93J,wBAE1B,GAEA,CAAA7lB,IAAA,2BAAAC,MAKA,WACI/G,KAAK4uF,kBAAkBlmF,UAAY,gFACnC1I,KAAK6yF,UAAW,EAIhB,IAAIpxF,EAAOzB,KAAKJ,QAAQulL,gBACxB,GAAI1jL,GAAQA,EAAK3B,QAAS,CAClBE,KAAKiuK,SACLnrK,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,MAElB,IAAIljK,EAAU/K,KACdA,KAAKiuK,OAAS3rK,YAAW,YACI,IAArByI,EAAQ8nF,SACR9nF,EAAQ+hK,wBAEJ/hK,EAAQkjK,QACRnrK,aAAaiI,EAAQkjK,OAGjC,GAAG,KACP,CACJ,GAEA,CAAAnnK,IAAA,wBAAAC,MAKA,WACI,GAAI/G,KAAK6yF,SAAU,CACf7yF,KAAK4uF,kBAAkBlmF,UAAY,8EACnC1I,KAAK6yF,UAAW,EAChB,IAAIpxF,EAAOzB,KAAKJ,QAAQulL,gBACpB1jL,GAAQA,EAAK3B,UACbgD,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,KAEtB,CACJ,I,4FAAC,CA7kDO,CAA0B5mK,EAAAA,GAklDtCnG,OAAOwX,OAAOyrK,EAASh/K,UAAW0hL,GAClC3lL,OAAOwX,OAAOyrK,EAASh/K,UAAWk6D,EAAAA,GAElC,UAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQy0J,SAAWA,GAGjC,IAAMqC,EAAY,SAAUlhL,EAAGC,GAC3B,GAAID,IAAMC,EACN,OAAO,EACJ,GAAkB,WAAb6U,EAAO9U,IAAuB,MAALA,GAA4B,WAAb8U,EAAO7U,IAAuB,MAALA,EAAY,CACrF,GAAIrE,OAAOC,KAAKmE,GAAGlE,SAAWF,OAAOC,KAAKoE,GAAGnE,OACzC,OAAO,EAGX,IAAK,IAAIkY,KAAQhU,EAAG,CAChB,IAAIC,EAAEmF,eAAe4O,GAKjB,OAAO,EAJP,IAAKktK,EAAUlhL,EAAEgU,GAAO/T,EAAE+T,IACtB,OAAO,CAKnB,CACA,OAAO,CACX,CACI,OAAO,CAEf,C,qRCptDA,IAAIja,E,QAAS2Q,EAAO1Q,UAAU,UAsI9B,QA1Ha,CAQTmE,MAAQ,SAAU2I,GACd,IAAIg3D,EAAM,KAENrjE,EAA0B,oBAAXwB,OAAyBA,OAAS,KAE9B,gCAAZxC,QAAO,YAAAqb,EAAPrb,WAAmC,OAAXwC,OAI/B6hE,GADS,IAAIz/D,EADG0xK,EAAAA,MAAAA,KAEHzxK,gBAAgBwI,EAAK,YAC3BrM,EAAM4D,UAGby/D,GADS,IAAIrjE,EAAM4D,WACNC,gBAAgBwI,EAAK,YAC3BrM,EAAM8D,gBAEbu/D,EAAM,IAAIrjE,EAAM8D,cAAc,qBAC1BC,OAAQ,EACZs/D,EAAIr/D,QAAQqI,IAEZ/M,EAAOqD,IAAI,6CAGf,IAAIokL,EAAY1jH,EAAI3I,cAAc,eAClC,OAAIqsH,GAGArkL,QAAQ/B,MAAMomL,GACP,OAGXznL,EAAOE,MAAM6jE,GACNA,EACX,EAQA51B,SAAW,SAAU41B,GAIjB,IACIh3D,GADc,IAAImlE,eACAO,kBAAkB1O,GAGxC,OADA/jE,EAAOE,MAAM6M,GACNA,CACX,EASAzM,OAAS,SAAUyM,GA6Bf,IA5BA,IAII26K,EAAY,GACZC,GAFJ56K,EAAMA,EAAIiC,QAHA,kBAGa,YAAYA,QAFvB,cAEsC,QAAQA,QAD5C,gBAC6D,WAE3DuK,MAAM,MAClB2vB,EAAS,EACT0+I,EAAW,QAEXC,EAAc,CACd,iBAAmB,EACnB,mBAAqB,EACrB,kBAAoB,EACpB,gBAAkB,EAClB,kBAAoB,EACpB,oBAAsB,EACtB,mBAAqB,EACrB,iBAAmB,EACnB,kBAAoB,EACpB,mBAAqB,EACrB,mBAAqB,EACrB,iBAAmB,EACnB,gBAAkB,EAClB,kBAAoB,EACpB,iBAAmB,EACnB,eAAiB,GAGZ9xK,EAAI,EAAGA,EAAI4xK,EAAM5lL,OAAQgU,IAAK,CACnC,IAAI+xK,EAAKH,EAAM5xK,GACXgyK,EAASC,QAAQF,EAAGzzK,MAAM,WAC1B4zK,EAAUD,QAAQF,EAAGzzK,MAAM,WAC3B6zK,EAAUF,QAAQF,EAAGzzK,MAAM,aAC3BxH,EAAOk7K,EAAS,SAAWE,EAAU,UAAYC,EAAU,UAAY,QACvEC,EAASP,EAAW,KAAO/6K,EAC/B+6K,EAAW/6K,EACX,IAAIu7K,EAAU,GAEdl/I,GAAU2+I,EAAYM,GACtB,IAAK,IAAI5gK,EAAI,EAAGA,EAAI2hB,EAAQ3hB,IACxB6gK,GAAW,KAEA,qBAAXD,EACAT,EAAYA,EAAU/oI,OAAO,EAAG+oI,EAAU3lL,OAAS,GAAK+lL,EAAK,KAE7DJ,GAAaU,EAAUN,EAAK,IAEpC,CAGA,OADA9nL,EAAOE,MAAMwnL,GACNA,CACX,E,wHCzEJ,SAAS7lJ,EAAcnd,GACnB,KAAM/jB,gBAAgBkhC,GAClB,MAAM,IAAIj9B,UAAU,IAAGgG,WAAW,oBAAqB,iBAO3DjK,KAAKkF,UAAY,eAEjBlF,KAAKX,OAAS,IAAOC,UAAU,4BAC/BU,KAAKX,OAAOE,MAAM,yCAElB,IAAIK,EAAUI,KAAKgkB,qBAAqBD,GASxC,GAPKnkB,EAAQkM,YACTlM,EAAQkM,UAAY,IAAkBo1B,aAAajd,UAIvD,IAAczF,MAAMxe,KAAM+N,YAErBnO,EAAQiC,KACT,MAAM,IAAIpC,MAAM,IAAGwK,WAAW,gBAAiB,SAInDjK,KAAKJ,QAAQiC,KAAOjC,EAAQiC,KAGvBjC,EAAQsM,OACTtM,EAAQsM,KAAO,CAAC,qCAGpBlM,KAAKJ,QAAQsM,KAAOtM,EAAQsM,KAC5BlM,KAAKJ,QAAQ8nL,UAAY9nL,EAAQ+nL,MAAQ,GACzC3nL,KAAKJ,QAAQwkB,iBAAmBxkB,EAAQwkB,kBAAoB,GAI9B,QAA1BpkB,KAAKJ,QAAQuK,UAAkD,SAA5BnK,KAAKJ,QAAQ2K,aAChDvK,KAAKX,OAAOmU,KAAK,mFACjBxT,KAAKJ,QAAQ2K,WAAa,OAS9BvK,KAAKJ,QAAQiL,aAAgB7K,KAAKJ,QAAmB,YAAI,GAAK,MAClE,CAMAshC,EAAa/7B,UAAYjE,OAAOmjB,OAAO,IAAclf,UAAW,CAGhE,GAKA+7B,EAAa/7B,UAAUC,YAAc87B,EAQrCA,EAAa/7B,UAAU6e,qBAAuB,SAAUD,GACpD,MAAMnkB,EAAUmkB,EAsBhB,OApBInkB,EAAQ0kB,gBACRtkB,KAAKX,OAAOmU,KAAK,+CAEb5T,EAAQ0kB,cAAcpY,OACtBlM,KAAKX,OAAOmU,KAAK,oDACZ5T,EAAQsM,OACTtM,EAAQsM,KAAOtM,EAAQ0kB,cAAcpY,OAIzCtM,EAAQ0kB,cAAcojK,YACtB1nL,KAAKX,OAAOmU,KAAK,yDACZ5T,EAAQ+nL,OACT/nL,EAAQ+nL,KAAO/nL,EAAQ0kB,cAAcojK,mBAItC9nL,EAAQ0kB,eAGZ1kB,CACX,EASAshC,EAAa/7B,UAAUoG,aAAe,SAAU7K,EAAO8K,GASnD,IAAIk8K,EAAY,GACZ1nL,KAAKJ,QAAQ8nL,YACbA,EAAY1nL,KAAKJ,QAAQ8nL,WAG7B,IAAIx7K,EAAO,GACPlM,KAAKJ,QAAQsM,OACbA,EAAOlM,KAAKJ,QAAQsM,KAAKpG,KAAK,MAIlC9F,KAAK8K,QAAU,IAAO09B,oBAAoB,CACtC3mC,KAAOoiC,mBAAmBjkC,KAAKJ,QAAQiC,MACvCqK,KAAOA,EACPy7K,KAAOD,EACPtjK,iBAAmBpkB,KAAKJ,QAAQwkB,mBAGlCpkB,KAAK8K,QAEDU,EAAQrM,KAAKa,KAAMA,KAAK8K,SADxBpK,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAGiK,WAAW,0BAE1D,EASAi3B,EAAa/7B,UAAUkG,gBAAkB,SAAU3K,EAAO8K,GACtD,GAAIxL,KAAKO,SAAU,CACf,IAAIX,EAAU,CACVW,SAAWP,KAAKO,SAChBiK,YAAcxK,KAAKJ,QAAQ4K,YAC3BC,UAAYe,EACZL,QAAUzK,EACVX,MAAQC,MAGZ,EAAA0lB,EAA4BZ,MAAMllB,EACtC,MACIc,EAAMvB,KAAKa,KAAM,IAAI,IAAa,IAAGiK,WAAW,2BAExD,EAEA,S,iFC1IA,QAxE4B,CAmBxB6a,MAAQ,SAAUllB,GAEd,IAAIC,EAAO,KAEX,GAAID,EAAQW,SAAZ,CACI,GAAIX,EAAQ4K,YACR3K,EAAOD,EAAQW,aACZ,CACH,IAII,KAFAV,GADe,IAAI,KACL4D,MAAM7D,EAAQW,WAGxB,MAAM,IAAId,MAAM,wCAExB,CAAE,MAAOwC,GACL,IAAIH,EAAUG,EAAEH,QAWhB,MAVgC,iBAArBlC,EAAQW,SACfuB,GAAW,KAAOlC,EAAQW,SAAW,KAErCuB,GAAW,KAAOlC,EAAQW,SAASuT,gBAAgB3B,UAAY,UAEnEvS,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,2BAA4BnI,GACtDoK,KAAO,IAAaytE,YACpB33E,QAAU,IAGlB,CAGA,GAAInC,EAAKksC,gBAML,YALAnsC,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,6BAA8BpK,EAAKksC,iBAC7D7/B,KAAO,IAAaC,YACpBnK,OAAS,MAIrB,CAUJpC,EAAQ6K,UAAUtL,KAAKS,EAAQG,MAAOF,EAFtC,MANID,EAAQuL,QAAQhM,KAAKS,EAAQG,MAAO,IAAI,IAAa,CACjD+B,QAAU,IAAKmI,WAAW,0BAC1BiC,KAAO,IAAaC,YACpBnK,QAAU,IAMtB,E,wBClFJlD,EAAOC,QAAUC,GAAGC,MAAM8xE,I,8wDCuB1B,IAAIkrG,EAAO,SAAA2L,GAYP,SAAA3L,EAAar8K,GAAS,IAAAyG,E,MAGlB,G,4FAHkBC,CAAA,KAAA21K,G,EAClB,K,EAAA,CAAMr8K,G,MAANq8K,MAAA51K,E,6EAEsB41K,GAClB,MAAM,IAAIh4K,UAAU,2BAaxB,OAVAoC,EAAKzG,QAAUA,GAAW,CAAC,EAIO,OAA9ByG,EAAKzG,QAAQ+6B,mBAA8D,IAA9Bt0B,EAAKzG,QAAQ+6B,eAC1Dt0B,EAAKzG,QAAQ+6B,aAAe,CAAC,GAGjCt0B,EAAKuW,OAAS,KAEdwN,EAAA/jB,EAAAA,EACJ,CAEA,O,qRAAAO,CAAAq1K,EAAA2L,G,EAAA3L,E,EAAA,EAAAn1K,IAAA,eAAAC,MASA,SAAc6V,EAAQhd,GAAS,I,UAAAktB,EAAA,KACvB+iE,G,EAAQosF,E,EAAA,e,EAAA,K,WAAA,G,kFAAA,CAAsBr/J,EAAQhd,IAsC1C,MAnCsB,iBAAXgd,EACP5c,KAAK4c,OAASpZ,KAAKC,MAAMmZ,GACP,OAAXA,IACP5c,KAAK4c,OAASA,GAGlBizE,EAASjmF,SAAQ,SAACkvB,GACd,IAAI6lE,EAAuB7lE,EAAQsC,mBAGnC,GAAIujE,EAAsB,CACtB,IAAItjE,EAASsjE,EAAqBx/F,KAAK2tB,EAAMgM,EAAS,GAClDuC,GAA4B,IAAlBA,EAAOj6B,QACjB03B,EAAQwC,SAASD,EAAO,GAEhC,KAAO,CAKH,IAAIp8B,EAAQ03B,EAAAA,EAAQkC,0BAA0BC,GAC9C,GAAI75B,EACA65B,EAAQwC,SAASr8B,OACd,CAGH,IAAIw7K,EAAgB9jJ,EAAAA,EAAQ+D,6BAA6B5N,EAAKltB,QAAQ+6B,cAClE8/I,IACA3hJ,EAAQwC,SAASm/I,GACjB9jJ,EAAAA,EAAQwE,0BAA0BrC,GAE1C,CACJ,CACJ,IAEO+2D,CACX,GAEA,CAAA/oF,IAAA,gBAAAC,MAUA,SAAe8oF,EAAUjwF,GAErBiwF,EAASjmF,SAAQ,SAAUkvB,GACvBnC,EAAAA,EAAQwE,0BAA0BrC,EACtC,IAEA,IAAI+uJ,EAAgB7nL,KAAK8nL,oBAAoBj4F,EAAUjwF,GAUvD,OAJII,KAAKJ,QAAQ8K,eAAe,eAC5BxJ,OAAOwX,OAAOmvK,EAAe7nL,KAAKJ,QAAQw3F,YAGvC5zF,KAAKqC,UAAUgiL,EAC1B,GAEA,CAAA/gL,IAAA,qBAAAC,MAKA,SAAoBD,GAChB,OAAO9G,KAAK4c,OAAO9V,EACvB,I,4FAAC,CAvHM,CAAyBihL,KA2HpC,UAGIxmL,OAAOvC,IAAMuC,OAAOvC,GAAGW,SACvB4B,OAAOvC,GAAGW,OAAOowF,gBAAkBksF,E,gFC1GvC,SAAS+L,EAAwBpoL,GAI7B,GAHAI,KAAKX,OAAS,IAAOC,UAAU,0BAC/BU,KAAKX,OAAOE,MAAM,8CAEZS,gBAAgBgoL,GAClB,MAAM,IAAI/jL,UAAU,sEAIxB,IAAKrE,EACD,MAAM,IAAIH,MAAM,IAAEwK,WAAW,cAAe,YAMhDjK,KAAKZ,SAAWQ,EAOhBI,KAAKqhL,KAAOrhL,KAAKZ,SAASmL,YAAc,KAC5C,CAEAy9K,EAAuB7iL,UAAY,CAU/BspC,cAAgB,KAKhBrpC,YAAc4iL,EAkCdt5I,qBAAuB,WACnB,IAAI5jC,EAAU,GACVsK,EAAI,EAER,OAAQpV,KAAKqhL,MACT,IAAK,MACDrhL,KAAKX,OAAOE,MAAM,uBAGlB,IACIyO,EADU,IAAI,IAAqBhO,KAAKZ,UACvB4G,YAErB,IAAKoP,EAAI,EAAGA,EAAIpH,EAAO5M,OAAQgU,IAAK,CAChC,IAAIwO,EAAI5V,EAAOoH,GACXtK,IACAA,GAAW,KAEfA,GAAW8Y,EAAEje,EAAI,IAAMie,EAAE1d,CAC7B,CAEA,MAEJ,IAAK,OACDlG,KAAKX,OAAOE,MAAM,wBAElB,IAAI0oL,EAAc,CAAC,EAEnBA,EAAY9jL,SAAWnE,KAAKZ,SAAS+E,SAErC8jL,EAAY7jL,MAAQpE,KAAKZ,SAASiF,SAASiB,EAAI,IAAMtF,KAAKZ,SAASiF,SAASkB,EAE/C,aAAzBvF,KAAKZ,SAASM,QACduoL,EAAYnjL,SAAW,WACvBmjL,EAAYljL,UAAY/E,KAAKZ,SAAS4F,WAEtCijL,EAAYnjL,SAAW,OACvBmjL,EAAYljL,UAAY/E,KAAKZ,SAAS6F,MAG1CgjL,EAAYzjL,QAAUxE,KAAKZ,SAASqF,MAEhCzE,KAAKZ,SAASuF,QACdsjL,EAAYt4I,UAAY,UAExBs4I,EAAYt4I,UAAY,YAG5Bs4I,EAAYvjL,YAAc1E,KAAKZ,SAASsF,YAExCujL,EAAYpjL,aAAe7E,KAAKZ,SAASyF,aAEzCojL,EAAYrjL,SAAW5E,KAAKZ,SAASwF,SAErCqjL,EAAY3jL,IAAMtE,KAAKZ,SAASmF,IAGhCuG,EAAUtH,KAAKqC,UAAUoiL,GACzB,MAEJ,QACIjoL,KAAKX,OAAOqB,MAAM,mDAM1B,OAHAV,KAAKX,OAAOE,MAAMuL,GAClB9K,KAAKyuC,cAAgB3jC,EAEd9K,KAAKyuC,aAChB,GAGJ,S,2FCpKA,SAASy5I,IACL,KAAMloL,gBAAgBkoL,GAClB,MAAM,IAAIjkL,UAAU,oEAE5B,CAyDA,SAASkkL,EAAervJ,EAASsvJ,GAC7B,IAAI15K,EAAW,IAAI,IAOnB,GANIoqB,EAAQnqB,UAAsC,UAA1BmqB,EAAQnqB,SAASzC,OACrCwC,EAASrK,SAAW,CAChBmgB,IAAMsU,EAAQnqB,SAASujF,YAAY,GACnCztE,IAAMqU,EAAQnqB,SAASujF,YAAY,KAGvCp5D,EAAQo4I,WAAY,CACpB,IAAK,IAAI53J,KAAQwf,EAAQo4I,WACR,UAAT53J,EACA5K,EAASoxF,SAAWhnE,EAAQo4I,WAAW53J,GACvB,UAATA,EAC0B,YAA7Bwf,EAAQo4I,WAAW53J,GACnB5K,EAASxC,KAAO,gBACoB,QAA7B4sB,EAAQo4I,WAAW53J,GAC1B5K,EAASxC,KAAO,qBACoB,WAA7B4sB,EAAQo4I,WAAW53J,IAAmD,cAA7Bwf,EAAQo4I,WAAW53J,KACnE5K,EAASxC,KAAO,mBAGpBwC,EAASw4B,gBAAgB5tB,GAAQwf,EAAQo4I,WAAW53J,GAG3B,YAA7Bwf,EAAQo4I,WAAWv7J,QACnBjH,EAASmxF,eAA0C1/E,IAA9B2Y,EAAQo4I,WAAW5jI,QAAsD,OAA9BxU,EAAQo4I,WAAW5jI,OAAkB,gBAAkB,SAE/H,CACA86I,EAAgB75K,UAAU3I,KAAK8I,EACnC,CApFAw5K,EAAsB/iL,UAAY,CAS9BC,YAAc8iL,EASdzkL,MAAQ,SAAUqO,GACd,IAAIs2K,EAAkB,IAAI,IAE1B,MAAMh4K,EAAM5M,KAAKC,MAAMqO,GAEvB,GAAiB,sBAAb1B,EAAIlE,KACJ,IAAK,IAAIkJ,EAAI,EAAGA,EAAIhF,EAAIy/E,SAASzuF,SAAUgU,EACvC+yK,EAAc/3K,EAAIy/E,SAASz6E,GAAIgzK,OAEhC,IAAiB,YAAbh4K,EAAIlE,KAER,IAAiB,kBAAbkE,EAAIlE,KACX,MAmED,CACH6/B,gBApEuB37B,GAEnB,IAAIi4K,EAAO,IAAGp+K,WAAW,2BAA4BmG,EAAIlE,MACzD,MAAM,IAAI,IAAO,CACbpK,QAAUumL,EACVn8K,KAAO,IAAOytE,YACd33E,OAAS,KAEjB,CAVImmL,EAAc/3K,EAAKg4K,EAUvB,CAEA,OAAOA,CACX,GA6DJ,S,8BCpHA,SAASjnJ,IACL,KAAMnhC,gBAAgBmhC,GAClB,MAAM,IAAIl9B,UAAU,iEA4CxBjE,KAAKkM,KAAO,KAMZlM,KAAKqE,SAAW,CACZiB,EAAI,KACJC,EAAI,MAORvF,KAAK6nC,QAAU,KAMf7nC,KAAK2nC,SAAW,KAMhB3nC,KAAK4nC,WAAa,KAMlB5nC,KAAK05E,eAAiB,KAMtB15E,KAAKynC,OAAS,KAMdznC,KAAK8nC,IAAM,KAMX9nC,KAAK+nC,KAAO,IAChB,C,iBAEA5G,EAAkBh8B,UAAY,CAE1BC,YAAc+7B,GAGlB,S,8BC1GA,SAASmnJ,IACL,KAAMtoL,gBAAgBsoL,GAClB,MAAM,IAAIrkL,UAAU,+DAGxBjE,KAAKogE,eAAiB,CAClBC,QAAU,CAAC,EACXlwD,MAAQ,KACRo4K,mBAAqB,KACrBl9F,MAAQ,KACRm9F,iBAAmB,IAGvBxoL,KAAK0f,OAAS,CAAC,EAEf1f,KAAKsgE,eAAiB,CAAC,CAC3B,C,iBAEAgoH,EAAgBnjL,UAAY,CAKxBC,YAAckjL,EAQdG,gBAAkB,SAAU58K,GACxB,GAAKA,EAGL,QAAI7L,KAAKogE,eAAeC,QAAQx0D,EAIpC,EAQA68K,YAAc,SAAU78K,GACpB,OAAO7L,KAAKogE,eAAeC,QAAQx0D,EACvC,EASA+xD,WAAa,SAAUF,EAAW3F,GAC9B,GAAK2F,GAAc3F,EAAnB,CAGA,IAAIjE,EAAU,KAUd,GAAI9zD,KAAK0f,OAAQ,CACb,IAAIA,EAAS1f,KAAK0f,OAClB,IAAK,IAAI5Y,KAAO4Y,EACZ,GAAIA,EAAOhV,eAAe5D,GAAM,CAC5B,IAAI6hL,EAAQ7hL,EAAI8R,MAAM,KACtB,GAAI8kD,IAAcirH,EAAM,IAChBA,EAAM,GAAI,CACV,IAAIC,EAAoBD,EAAM,GAAG/vK,MAAM,KAGvC,GAF0B+vK,EAAM,GAAG/vK,MAAM,KAEjB,KAAOm/C,EAAQptD,cAAe,CAClDmpD,EAAUhtD,EACV,KACJ,CACA,GAAI8hL,EAAkB,KAAO7wH,EAAQptD,cAAe,CAChDmpD,EAAUhtD,EACV,KACJ,CACJ,CAER,CAER,CACA,GAAKgtD,EAGL,OAAOA,CArCP,CAsCJ,EASA+0H,cAAgB,SAAUh9K,GACtB,IAAI6T,EAAS,CAAC,EACVopK,EAAgB9oL,KAAK0oL,YAAY78K,GACrC,GAAIi9K,EACA,IAAK,IAAI1zK,EAAI,EAAGA,EAAI0zK,EAAc1nL,OAAQgU,IAAK,CAC3C,IAAI2zK,EAAQD,EAAc1zK,GAC1BsK,EAAOqpK,GAAS/oL,KAAK0f,OAAOqpK,EAChC,CAEJ,OAAOrpK,CACX,EASAspK,aAAe,SAAUl1H,GACrB,GAAK9zD,KAAK0f,OAGV,OAAO1f,KAAK0f,OAAOo0C,EACvB,EAyBAm1H,eAAiB,SAAUvrH,EAAW3F,GAClC,IAAI/pD,EAAS,CAAC,EAEd,IAAiB,QAAZ+pD,GAAiE,IAA5C72D,OAAOC,KAAKnB,KAAKsgE,gBAAgBl/D,SAAqD,IAApCF,OAAOC,KAAKnB,KAAK0f,QAAQte,OAAc,CAE/G,IAAI0yD,EAAU9zD,KAAK49D,WAAWF,EAAW3F,GAEzC,GAAIjE,EAAS,CAET,IAAIo1H,EAAYlpL,KAAKgpL,aAAal1H,GAE9B3yD,EAAOnB,KAAKmpL,YAAYr1H,GAC5B,GAAoB,IAAhB3yD,EAAKC,OACL,OAIJ,IAAK,IAAIgU,EAAI,EAAGA,EAAIjU,EAAKC,OAAQgU,IAEzB8zK,EAAUE,cAAct9K,UAAU3K,EAAKiU,MACvCpH,EAAOxO,IAAM0pL,EAAUE,cAAct9K,UAAU3K,EAAKiU,KAI5D,GAAgB,QAAZ2iD,EAAmB,CACE,QAEJnkD,KAAK5F,EAAOxO,KACzBwO,EAAOqtB,OAAS,IAGhBrtB,EAAOqtB,OAAS6tJ,EAAU7tJ,OAAO,GAAGhzB,IAE5C,CAwBA,GAtBA2F,EAAOmgD,QAAU+6H,EAAUE,cAAcj7H,QACzCngD,EAAOrO,OAAUupL,EAAUG,SAAWH,EAAUG,QAAQjoL,OAAU8nL,EAAUG,QAAQ,GAAGhhL,KAAO,GAC9F2F,EAAOs7K,WAAaJ,EAAUK,kBAG9Bv7K,EAAO8nD,SAAWozH,EAAUM,iBAAiBzzH,oBAC7C/nD,EAAO4nD,SAAWszH,EAAUM,iBAAiB3zH,oBAC7C7nD,EAAOwtB,OAAS0tJ,EAAUM,iBAAiBjlK,KAC3CvW,EAAOynD,QAAUyzH,EAAUzzH,QAC3BznD,EAAOmC,MAAQ+4K,EAAU/4K,MACzBnC,EAAOrH,YAAcuiL,EAAUviL,YAEf,QAAZoxD,IACA/pD,EAAOmU,SAAW+mK,EAAU/mK,UAS5B+mK,EAAUO,YAAa,CACvBz7K,EAAO07K,oBAAsBR,EAAUO,YAAYC,oBACnD,IAAIC,EAAUT,EAAUO,YAAYG,kBACpC,GAAID,EAAS,CACT37K,EAAO27K,QAAUA,EACjB,IAAIE,EAAU7pL,KAAK8pL,WAAWH,GAG9B37K,EAAO+7K,UAAY7oL,OAAOC,KAAK0oL,EAAQG,cACvCh8K,EAAOg8K,aAAeH,EAAQG,aAE9Bh8K,EAAOi8K,kBAAoBJ,EAAQI,mBAAqBjqL,KAAK8pL,WAAW,MAAMG,iBAClF,CACJ,CACJ,CACJ,CACA,OAAOj8K,CACX,EAQAm7K,YAAc,SAAUr1H,GACpB,IAAIo2H,EAAW,GACf,GAAIlqL,KAAKogE,gBAAkBpgE,KAAKogE,eAAeC,SAA+D,IAApDn/D,OAAOC,KAAKnB,KAAKogE,eAAeC,SAASj/D,OAAc,CAC7G,IAAI+oL,EAAiBnqL,KAAKogE,eAAeC,QACzC,IAAK,IAAIv5D,KAAOqjL,EAAgB,CACPA,EAAerjL,GACrB8C,SAAQ,SAAUwgL,GACzBA,IAAiBt2H,GACjBo2H,EAAStkL,KAAKkB,EAEtB,GACJ,CACJ,CACA,OAAOojL,CACX,EAQAG,kBAAoB,WAChB,OAAOrqL,KAAKsgE,cAChB,EASAwpH,WAAa,SAAUQ,GACnB,GAAKtqL,KAAKsgE,eAGV,OAAOtgE,KAAKsgE,eAAegqH,EAC/B,EAYAxsH,qBAAuB,SAAUhK,GAC7B,IAAI9lD,EAAS,CAAC,EAEd,GAAI8lD,EAAS,CAET,IAAIo1H,EAAYlpL,KAAKgpL,aAAal1H,GAClC9lD,EAAOs7K,WAAaJ,EAAUK,kBAC9Bv7K,EAAO8nD,SAAWozH,EAAUM,iBAAiBzzH,oBAC7C/nD,EAAO4nD,SAAWszH,EAAUM,iBAAiB3zH,oBAC7C7nD,EAAOwtB,OAAS0tJ,EAAUM,iBAAiBjlK,IAC/C,CAEA,OAAOvW,CACX,GAIJ,S,wBClUAlP,EAAOC,QAAUC,GAAGq2B,O,+CCQpB,QARa,CACTk1J,YAAc,ykaACdC,WAAa,ypaACb58I,IAAM,y5aACN68I,cAAgB,isYAChBx+J,cAAgB,EAAE,MAAO,I,GCJzBy+J,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBzqK,IAAjB0qK,EACH,OAAOA,EAAa9rL,QAGrB,IAAID,EAAS4rL,EAAyBE,GAAY,CAGjD7rL,QAAS,CAAC,GAOX,OAHA+rL,EAAoBF,GAAUzrL,KAAKL,EAAOC,QAASD,EAAQA,EAAOC,QAAS4rL,GAGpE7rL,EAAOC,OACf,CCrBA4rL,EAAoBhhK,EAAK7qB,IACxB,IAAIisL,EAASjsL,GAAUA,EAAOksL,WAC7B,IAAOlsL,EAAiB,QACxB,IAAM,EAEP,OADA6rL,EAAoBl7I,EAAEs7I,EAAQ,CAAExwK,EAAGwwK,IAC5BA,CAAM,ECLdJ,EAAoBl7I,EAAI,CAAC1wC,EAASksL,KACjC,IAAI,IAAInkL,KAAOmkL,EACXN,EAAoB/mK,EAAEqnK,EAAYnkL,KAAS6jL,EAAoB/mK,EAAE7kB,EAAS+H,IAC5E5F,OAAO+wC,eAAelzC,EAAS+H,EAAK,CAAE+0B,YAAY,EAAMrF,IAAKy0J,EAAWnkL,IAE1E,ECND6jL,EAAoBrlJ,EAAI,WACvB,GAA0B,iBAAf4lJ,WAAyB,OAAOA,WAC3C,IACC,OAAOlrL,MAAQ,IAAIwiC,SAAS,cAAb,EAChB,CAAE,MAAOvgC,GACR,GAAsB,iBAAXV,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBopL,EAAoB/mK,EAAI,CAACxT,EAAKkJ,IAAUpY,OAAOiE,UAAUuF,eAAevL,KAAKiR,EAAKkJ,G,qFCAlF,MAAM,EAA+Bta,GAAGmsL,W,gCCAxC,MAAM,EAA+BnsL,GAAGosL,SAAS9qF,K,uBCAjD,MAAM,EAA+BthG,GAAGW,OAAO0rL,I,aCA/C,MAAM,EAA+BrsL,GAAGW,OAAO2rL,gB,aCA/C,MAAM,EAA+BtsL,GAAGW,OAAO4rL,iB,kDCA/C,MAAM,EAA+BvsL,GAAGwN,MAAMg/K,K,aCA9C,MAAM,EAA+BxsL,GAAG4d,OAAO04E,W,sECA/C,MAAM,EAA+Bt2F,GAAG4d,OAAO6uK,S,uBC+2F3CC,EAAS,CACZC,SAh3Fc,EAi3FdC,MAh3FW,CACXz9H,QAAS,CACR+a,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACP,IAGFxP,KAAM,CACL6D,KAAM,UAEPiW,SAAU,CACTjW,KAAM,KAEP2/K,OAAQ,CACP3/K,KAAM,QACNnF,MAAO,UAER+kL,eAAgB,CACf5/K,KAAM,UAEP6/K,KAAM,CACL7/K,KAAM,UAEP8/K,QAAS,CACR9/K,KAAM,SACN,QAAW,EACX0rI,OAAQ,IACRq0C,MAAO,WAERC,MAAO,CACNhgL,KAAM,SACN,QAAW,EACX+/K,MAAO,WAERE,KAAM,CACLjgL,KAAM,SACN,QAAW,EACX+/K,MAAO,WAERG,MAAO,CACNlgL,KAAM,SAEPmgL,IAAK,CACJngL,KAAM,OAEPo9K,WAAY,CACXp9K,KAAM,cAEPogL,QAAS,CACRpgL,KAAM,WAEP+U,QAAS,CACRioD,UAAU,EACVh9D,KAAM,WAEPsX,OAAQ,CACPtX,KAAM,UAEPqgL,OAAQ,CACPrgL,KAAM,UAEPg+E,WAAY,CACXh+E,KAAM,cAEPwT,OAAQ,CACPwpD,UAAU,EACVh9D,KAAM,QACNnF,MAAO,UA6yFRka,QA1yFa,CACb,IAAK,CACJ/U,KAAM,WAyyFP0Q,OAtyFY,CACZ,gBACA,gBACA,oBACA,iBACA,eACA,gBAiyFA4vK,cA/xFmB,CACnBtgL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACP40K,OAAQ,CACR,IAGFjtL,IAAK,CACJ0M,KAAM,UAEPwgL,MAAO,CACNxgL,KAAM,QACNnF,MAAO,UAER+pK,OAAQ,CACP5kK,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,EACT,KACA,UACD,IACA,YAGFurL,OAAQ,CACPzgL,KAAM,OACN2L,OAAQ,CACP+0K,IAAK,CACL,EACAC,IAAK,CACL,GAED,QAAW,OAEZn6K,QAAS,CACRxG,KAAM,SACN,QAAW,GAEZ0G,QAAS,CACR1G,KAAM,SACN,QAAW,IAEZ4gL,YAAa,CACZ5gL,KAAM,UAEP6gL,UAAW,CACV7gL,KAAM,aAEP8gL,SAAU,CACT9gL,KAAM,UACN,SAAW,GAEZ,IAAK,CACJA,KAAM,MAwuFP+gL,cAruFmB,CACnB/gL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACPq1K,OAAQ,CACR,IAGF1tL,IAAK,CACJ0M,KAAM,UAEPwgL,MAAO,CACNxgL,KAAM,QACNnF,MAAO,UAER+pK,OAAQ,CACP5kK,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,EACT,KACA,UACD,IACA,YAGFsR,QAAS,CACRxG,KAAM,SACN,QAAW,GAEZ0G,QAAS,CACR1G,KAAM,SACN,QAAW,IAEZihL,SAAU,CACTjhL,KAAM,SACN,QAAW,IACX+/K,MAAO,UAERU,OAAQ,CACPzgL,KAAM,OACN2L,OAAQ,CACP+0K,IAAK,CACL,EACAC,IAAK,CACL,GAED,QAAW,OAEZC,YAAa,CACZ5gL,KAAM,UAEP8gL,SAAU,CACT9gL,KAAM,UACN,SAAW,GAEZ,IAAK,CACJA,KAAM,MA4qFPkhL,kBAzqFuB,CACvBlhL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACP,aAAc,CACd,IAGFrY,IAAK,CACJ0M,KAAM,UAEPwgL,MAAO,CACNxgL,KAAM,QACNnF,MAAO,UAER+pK,OAAQ,CACP5kK,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,EACT,KACA,UACD,IACA,YAGFsR,QAAS,CACRxG,KAAM,SACN,QAAW,GAEZ0G,QAAS,CACR1G,KAAM,SACN,QAAW,IAEZihL,SAAU,CACTjhL,KAAM,SACN,QAAW,IACX+/K,MAAO,UAERa,YAAa,CACZ5gL,KAAM,UAEPmhL,SAAU,CACTnhL,KAAM,OACN2L,OAAQ,CACPy1K,UAAW,CACX,EACA3sK,OAAQ,CACR,EACA4sK,OAAQ,CACR,GAED,QAAW,UAEZC,UAAW,CACVthL,KAAM,SACN,QAAW,GAEZuhL,WAAY,CACXvhL,KAAM,SACN,QAAW,GAEZwhL,YAAa,CACZxhL,KAAM,SACN,QAAW,GAEZyhL,UAAW,CACVzhL,KAAM,SACN,QAAW,GAEZ8gL,SAAU,CACT9gL,KAAM,UACN,SAAW,GAEZ,IAAK,CACJA,KAAM,MA8lFP0hL,eA3lFoB,CACpB1hL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACPi0J,QAAS,CACT,IAGFjsK,KAAM,CACLqpE,UAAU,EACVh9D,KAAM,KAEP0G,QAAS,CACR1G,KAAM,SACN,QAAW,IAEZ4gL,YAAa,CACZ5gL,KAAM,UAEP2hL,OAAQ,CACP3hL,KAAM,SACN,QAAW,IACX4hL,QAAS,IACTC,QAAS,GAEVt+K,OAAQ,CACPvD,KAAM,KAEP8hL,UAAW,CACV9hL,KAAM,SACN,QAAW,MAEZ+hL,QAAS,CACR/hL,KAAM,UACN,SAAW,GAEZgiL,cAAe,CACdhiL,KAAM,SACN,QAAW,GACX6hL,QAAS,GAEVI,eAAgB,CACfjiL,KAAM,UAEPkiL,iBAAkB,CACjBliL,KAAM,UAEPmiL,kBAAmB,CAClBniL,KAAM,KAEPoiL,YAAa,CACZpiL,KAAM,UACN,SAAW,GAEZqiL,WAAY,CACXriL,KAAM,UACN,SAAW,GAEZ6gL,UAAW,CACV7gL,KAAM,cAgiFPsiL,aA7hFkB,CAClBtiL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACP42K,MAAO,CACP,IAGFC,KAAM,CACLxlH,UAAU,EACVh9D,KAAM,QACNnF,MAAO,UAERmrF,YAAa,CACZhpB,UAAU,EACVh9D,KAAM,QACN9K,OAAQ,EACR2F,MAAO,CACNmF,KAAM,QACN9K,OAAQ,EACR2F,MAAO,YAygFT4nL,aArgFkB,CAClBziL,KAAM,CACLg9D,UAAU,EACVh9D,KAAM,OACN2L,OAAQ,CACP9C,MAAO,CACP,IAGFvV,IAAK,CACJ0pE,UAAU,EACVh9D,KAAM,UAEPgmF,YAAa,CACZhpB,UAAU,EACVh9D,KAAM,QACN9K,OAAQ,EACR2F,MAAO,CACNmF,KAAM,QACN9K,OAAQ,EACR2F,MAAO,YAk/ETyF,MA9+EW,CACXtI,GAAI,CACHgI,KAAM,SACNg9D,UAAU,GAEXh9D,KAAM,CACLA,KAAM,OACN2L,OAAQ,CACPqE,KAAM,CACN,EACAD,KAAM,CACN,EACA8uD,OAAQ,CACR,EACA3uD,OAAQ,CACR,EACAwyK,QAAS,CACT,EACA,iBAAkB,CAClB,EACA1B,OAAQ,CACR,EACA2B,UAAW,CACX,EACA1yK,WAAY,CACZ,GAED+sD,UAAU,GAEX/mD,SAAU,CACTjW,KAAM,KAEP0Q,OAAQ,CACP1Q,KAAM,UAEP,eAAgB,CACfA,KAAM,UAEPwG,QAAS,CACRxG,KAAM,SACN6hL,QAAS,EACTD,QAAS,IAEVl7K,QAAS,CACR1G,KAAM,SACN6hL,QAAS,EACTD,QAAS,IAEVr+K,OAAQ,CACPvD,KAAM,UAEP0E,OAAQ,CACP1E,KAAM,UAEPyE,MAAO,CACNzE,KAAM,UAw7EP0E,OAr7EY,CACZ,cACA,cACA,gBACA,iBACA,wBACA,gBACA,gBACA,mBACA,qBA66EAk+K,kBA36EuB,CACvBj9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAk6ElBC,YA/5EiB,CACjB,gBAAiB,CAChB9iL,KAAM,SACN+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElBt9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aA24ElBK,cAx4EmB,CACnB,kBAAmB,CAClBljL,KAAM,SACN+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElBt9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAo3ElBM,eAj3EoB,CACpBx9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAw2ElB,wBAAyB,CACzBl9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAGlBO,YAl3EiB,CACjB,WAAY,CACXpjL,KAAM,OACN2L,OAAQ,CACP03K,KAAM,CACN,EACA/3J,MAAO,CACP,EACA60H,OAAQ,CACR,GAED,QAAW,OACX4iC,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,YAAa,CACZjjL,KAAM,OACN2L,OAAQ,CACP23K,MAAO,CACP,EACAh4J,MAAO,CACP,EACAi4J,MAAO,CACP,GAED,QAAW,QACXR,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,mBAAoB,CACnBjjL,KAAM,SACN,QAAW,EACXwjL,SAAU,CACT,CACC,YAAa,UAGfT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,mBAAoB,CACnBjjL,KAAM,SACN,QAAW,KACXwjL,SAAU,CACT,CACC,YAAa,UAGfT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,gBAAiB,CAChBjjL,KAAM,SACN+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElBt9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAuxElBY,cApxEmB,CACnB,mBAAoB,CACnBzjL,KAAM,OACN2L,OAAQ,CACPzT,MAAO,CACP,EACA6X,KAAM,CACN,EACA,cAAe,CACf,GAED,QAAW,QACXgzK,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,IACX6hL,QAAS,EACT9B,MAAO,SACPyD,SAAU,CACT,CACC,mBAAoB,SAGtBT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,qBAAsB,CACrBjjL,KAAM,UACN,SAAW,EACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,kBAAmB,CAClBjjL,KAAM,SACN+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,OACN2L,OAAQ,CACP+3K,KAAM,CACN,EACA,aAAc,CACd,EACAhzK,OAAQ,CACR,GAED,QAAW,OACXqyK,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,qBAAsB,CACrBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,CACC,IAAK,iBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,eAAgB,CACfjjL,KAAM,OACN2L,OAAQ,CACPg4K,MAAO,CACP,EACAC,OAAQ,CACR,EACAC,YAAa,CACb,GAEDL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,gBAAiB,CAChBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,0BAA2B,CAC1BjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,EACA6uF,KAAM,CACN,GAED,QAAW,OACXF,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,YAAa,CACZjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT9B,MAAO,mCACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,gBAAiB,CAChBjjL,KAAM,OACN2L,OAAQ,CACPk3K,KAAM,CACN,EACAj3K,MAAO,CACP,EACA/O,OAAQ,CACR,EACAinL,KAAM,CACN,GAED,QAAW,OACXN,SAAU,CACT,aACA,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,EACA,EACA,GAED6qL,MAAO,SACPyD,SAAU,CACT,aACA,aACA,CACC,gBAAiB,CAChB,OACA,QACA,YAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,aAAc,CACbjjL,KAAM,gBACN+jL,QAAQ,EACRhB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,SACN,QAAW,EACX0rI,OAAQ,IACRq0C,MAAO,UACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,eAAgB,CACfjjL,KAAM,UACN,QAAW,CACV,GAED+/K,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,oBAAqB,CACpBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,CACC,0BAA2B,OAE5B,CACC,mBAAoB,CACnB,OACA,iBAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,cAAe,CACdjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAEDsuL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,OACN2L,OAAQ,CACPg0K,OAAQ,CACR,EACAxiL,KAAM,CACN,EACAC,MAAO,CACP,EACAH,IAAK,CACL,EACAC,OAAQ,CACR,EACA,WAAY,CACZ,EACA,YAAa,CACb,EACA,cAAe,CACf,EACA,eAAgB,CAChB,GAED,QAAW,SACXsmL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,uBAAwB,CACvBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,EACA6uF,KAAM,CACN,GAED,QAAW,OACXF,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,uBAAwB,CACvBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,EACA6uF,KAAM,CACN,GAED,QAAW,OACXF,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,0BAA2B,CAC1BjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,EACA,iBAAkB,CAClB,EACA6uF,KAAM,CACN,GAED,QAAW,OACXF,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,aAAc,CACbjjL,KAAM,YACN,QAAW,GACX+jL,QAAQ,EACRhB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,YAAa,CACZjjL,KAAM,QACNnF,MAAO,SACP,QAAW,CACV,oBACA,4BAED2oL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,YAAa,CACZjjL,KAAM,SACN,QAAW,GACX6hL,QAAS,EACT9B,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,GACX6hL,QAAS,EACT9B,MAAO,MACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,mBAAoB,CACnBjjL,KAAM,SACN,QAAW,IACX+/K,MAAO,MACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,sBAAuB,CACtBjjL,KAAM,SACN,QAAW,EACX+/K,MAAO,MACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,eAAgB,CACfjjL,KAAM,OACN2L,OAAQ,CACP+3K,KAAM,CACN,EACAvmL,KAAM,CACN,EACAwiL,OAAQ,CACR,EACAviL,MAAO,CACP,GAED,QAAW,SACXomL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,qBAAsB,CACrBjjL,KAAM,SACN+/K,MAAO,MACP,QAAW,EACXyD,SAAU,CACT,cAED,gBAAiB,cACjBT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,aAIH,uBAAwB,CACvBjjL,KAAM,QACNnF,MAAO,OACP8Q,OAAQ,CACPg0K,OAAQ,CACR,EACAxiL,KAAM,CACN,EACAC,MAAO,CACP,EACAH,IAAK,CACL,EACAC,OAAQ,CACR,EACA,WAAY,CACZ,EACA,YAAa,CACb,EACA,cAAe,CACf,EACA,eAAgB,CAChB,GAEDsmL,SAAU,CACT,aACA,CACC,mBAAoB,CACnB,WAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,8BAA+B,CAC9BjjL,KAAM,iCACNwjL,SAAU,CACT,aACA,CACC,mBAAoB,CACnB,WAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,OACN2L,OAAQ,CACPg0K,OAAQ,CACR,EACAxiL,KAAM,CACN,EACAC,MAAO,CACP,EACAH,IAAK,CACL,EACAC,OAAQ,CACR,EACA,WAAY,CACZ,EACA,YAAa,CACb,EACA,cAAe,CACf,EACA,eAAgB,CAChB,GAED,QAAW,SACXsmL,SAAU,CACT,aACA,CACC,IAAK,yBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,GACX+/K,MAAO,UACPyD,SAAU,CACT,aACA,CACC,mBAAoB,CACnB,OACA,iBAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,oBAAqB,CACpBjjL,KAAM,QACNnF,MAAO,OACP8Q,OAAQ,CACPq4K,WAAY,CACZ,EACAlmI,SAAU,CACV,GAED0lI,SAAU,CACT,aACA,CACC,mBAAoB,CACnB,WAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,cAAe,CACdjjL,KAAM,SACN,QAAW,EACX0rI,OAAQ,IACRq0C,MAAO,UACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,eAAgB,CACfjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT9B,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,oBAAqB,CACpBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,CACC,0BAA2B,OAE5B,CACC,mBAAoB,CACnB,OACA,iBAIHT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,iBAAkB,CACjBjjL,KAAM,OACN2L,OAAQ,CACPk3K,KAAM,CACN,EACAoB,UAAW,CACX,EACAC,UAAW,CACX,GAED,QAAW,OACXV,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,QACNnF,MAAO,SACPklL,MAAO,MACP7qL,OAAQ,EACR,QAAW,CACV,EACA,GAEDsuL,SAAU,CACT,aACA,CACC,IAAK,uBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,eAElB,qBAAsB,CACrBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,CACC,IAAK,iBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,eAAgB,CACfjjL,KAAM,OACN2L,OAAQ,CACPg4K,MAAO,CACP,EACAC,OAAQ,CACR,EACAC,YAAa,CACb,GAEDL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,gBAAiB,CAChBjjL,KAAM,UACN,SAAW,EACXwjL,SAAU,CACT,aACA,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElBt9K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAy5ClBsB,cAt5CmB,CACnBx+K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aA64ClBuB,iBA14CsB,CACtBz+K,WAAY,CACX3F,KAAM,OACN2L,OAAQ,CACPrD,QAAS,CACT,EACAu6K,KAAM,CACN,GAED,QAAW,UACX,gBAAiB,aAi4ClBt/K,OA93CY,CACZvD,KAAM,QACNnF,MAAO,KA63CPwpL,gBA33CqB,CACrBrkL,KAAM,OACN2L,OAAQ,CACP,KAAM,CACN,EACA,KAAM,CACN,EACA,IAAK,CACL,EACA,KAAM,CACN,EACA,IAAK,CACL,EACA,KAAM,CACN,EACA,GAAM,CACN,EACA,MAAO,CACP,EACAmL,IAAK,CACL,EACAwtK,IAAK,CACL,EACAzB,KAAM,CACN,EACA0B,IAAK,CACL,EACA,OAAQ,CACR,IAg2CDC,cA71CmB,CACnBxkL,KAAM,OACN2L,OAAQ,CACP68E,MAAO,CACP,EACA0lF,WAAY,CACZ,EACAjlJ,QAAS,CACT,IAs1CD,SAAY,CACZ85J,WAAY,CACX/iL,KAAM,cAEPmO,MAAO,CACNnO,KAAM,QACNnF,MAAO,iBAER0pC,KAAM,CACLvkC,KAAM,SACN,QAAW,EACX6hL,QAAS,GAEVttH,SAAU,CACTv0D,KAAM,SACN,QAAW,SAEZA,KAAM,CACLA,KAAM,OACN2L,OAAQ,CACP84K,SAAU,CACV,EACAC,YAAa,CACb,EACAC,SAAU,CACV,EACAC,YAAa,CACb,GAED,QAAW,eAEZC,WAAY,CACX7kL,KAAM,OACN2L,OAAQ,CACPy2B,IAAK,CACL,EACA0iJ,IAAK,CACL,EACAC,IAAK,CACL,GAED,QAAW,OAEZ,QAAW,CACV/kL,KAAM,IACNg9D,UAAU,IAGXgoH,cAn4CmB,CACnBhlL,KAAM,QACN6hL,QAAS,EACTD,QAAS,GACT/mL,MAAO,CACN,SACA,SAED3F,OAAQ,GA43CR6tL,WA13CkB,CAClB/iL,KAAM,QACNnF,MAAO,IACPgnL,QAAS,GAw3CT3B,MAt3CW,CACX7vK,OAAQ,CACPrQ,KAAM,OACN,QAAW,WACX2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,gBAAiB,gBACjB7W,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,UAIH9qL,SAAU,CACT6H,KAAM,QACN,QAAW,CACV,KACA,IACA,IAED9K,OAAQ,EACR2F,MAAO,SACP,gBAAiB,gBACjBmjF,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,UAIHn3K,MAAO,CACN9L,KAAM,QACN,gBAAiB,gBACjB,QAAW,UACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEbinG,UAAW,CACVjlL,KAAM,SACN,gBAAiB,gBACjB,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACTmB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,IA0zCbmiG,IAvzCS,CACT,YAAa,CACZngL,KAAM,QACN,gBAAiB,gBACjB,QAAW,UACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,gBAAiB,CAChBh+E,KAAM,QACN,gBAAiB,gBACjB,QAAW,UACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,YAAa,CACZh+E,KAAM,QACN,gBAAiB,gBACjB,QAAW,UACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,mBAAoB,CACnBh+E,KAAM,SACN,gBAAiB,gBACjB,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACTmB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,oBAAqB,CACpBh+E,KAAM,SACN,gBAAiB,gBACjB,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACTmB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,oBAAqB,CACpBh+E,KAAM,SACN,gBAAiB,gBACjB,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACTmB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,GAEb,mBAAoB,CACnBh+E,KAAM,SACN,gBAAiB,gBACjB,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACTmB,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGFjlG,YAAY,IA6tCboiG,QA1tCa,CACb1vK,OAAQ,CACP1Q,KAAM,SACNg9D,UAAU,GAEXkoH,aAAc,CACbllL,KAAM,SACN6hL,QAAS,EACT,QAAW,IAmtCZzE,WAhtCgB,CAChBp9K,KAAM,CACLA,KAAM,uBACN,QAAW,WACX,gBAAiB,gBACjBg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,WAwsCHx+K,MAnsCW,CACX,aACA,aACA,eACA,gBACA,uBACA,eACA,eACA,kBACA,oBA2rCA0gL,WAzrCgB,CAChB,iBAAkB,CACjBnlL,KAAM,UACN,SAAW,EACX+iL,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,eAAgB,CACfjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,aAAc,CACbjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,iBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,qBAAsB,CACrBjjL,KAAM,QACNg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,gBAEN,CACC,kBAAkB,IAGpBT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,kBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,eAAgB,CACfjjL,KAAM,gBACNg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,4BAskClB,uBAAwB,CACxB,yBAA0B,CACzBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,uBAAwB,CACvBjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,2BAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,2BAA4B,CAC3BjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,kCAAmC,CAClCjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,4BAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,yBAA0B,CACzBjjL,KAAM,gBACNg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,2BAElB,wBAAyB,CACxBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT9B,MAAO,SACP/hG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,sBAAuB,CACtBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT9B,MAAO,SACP/hG,YAAY,EACZwlG,SAAU,CACT,yBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,mCAAoC,CACnCjjL,KAAM,UACN,SAAW,EACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBAGlBmC,WAvsCgB,CAChB,eAAgB,CACfplL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,aAAc,CACbjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,iBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,kBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,aAAc,CACbjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,SACN,QAAW,EACXg+E,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,YAAa,CACZjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,QACNnF,MAAO,SACPgnL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,cACPyD,SAAU,CACT,CACC,IAAK,iBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,eAElB,eAAgB,CACfjjL,KAAM,gBACNg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,YAGF,gBAAiB,2BAElB,gBAAiB,CAChBjjL,KAAM,QACNg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,kBAEN,CACC,IAAK,gBAEN,CACC9yK,OAAQ,UACR6zK,IAAK,CACJnC,aAAa,KAIhBW,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,kBAGF,gBAAiB,eAygClBoC,aAtgCkB,CAClB,gBAAiB,CAChBrlL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,eAAgB,CACfjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,cAAe,CACdjjL,KAAM,SACN,QAAW,EACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,mBAAoB,CACnBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,0BAA2B,CAC1BjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,oBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,qBAAsB,CACrBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACXkuF,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,yBAA0B,CACzBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,WACXkuF,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,sBAAuB,CACtBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,sBAAuB,CACtBjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,wBAAyB,CACxBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,gBAs1BlBqC,cAn1BmB,CACnB,iBAAkB,CACjBtlL,KAAM,SACN,QAAW,GACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,oBAAqB,CACpBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,gBAAiB,CAChBjjL,KAAM,QACN,QAAW,CACV,cACA,CACC,UAED,CACC,mBAED,EACA,qBACA,GACA,YACA,GACA,OACA,GACA,OACA,GACA,SACA,EACA,OAEDg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,oBAGF,gBAAiB,cAElB,kBAAmB,CAClBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBA2vBlBsC,aAxvBkB,CAClB,eAAgB,CACfvlL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZwlG,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,aAAc,CACbjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwlG,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,kBAAmB,CAClBjjL,KAAM,QACN,QAAW,mBACXg+E,YAAY,EACZwlG,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,kBAAmB,CAClBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,aACA,kBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,eAAgB,CACfjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZwlG,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,aAAc,CACbjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwnG,aAAa,EACbhC,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,kBAAmB,CAClBjjL,KAAM,QACN,QAAW,mBACXg+E,YAAY,EACZwlG,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,kBAAmB,CAClBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,OACA,UACA,kBAGF,gBAAiB,eAElB,iBAAkB,CACjBjjL,KAAM,QACNnF,MAAO,SACP3F,OAAQ,EACR,QAAW,CACV,EACA,GAED8oF,YAAY,EACZ+hG,MAAO,SACPyD,SAAU,CACT,cAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,MACX2uF,SAAU,CACT,aACA,kBAEDT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBA+elBwC,aA5ekB,CAClB,iBAAkB,CACjBzlL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,oBAAqB,CACpBjjL,KAAM,SACN,QAAW,EACX0rI,OAAQ,IACR1tD,YAAY,EACZ+hG,MAAO,UACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,wBAAyB,CACxBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,oBAAqB,CACpBjjL,KAAM,SACN,QAAW,EACX6hL,SAAU,EACVD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,kBAAmB,CAClBjjL,KAAM,SACN,QAAW,EACX6hL,SAAU,EACVD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,oBAAqB,CACpBjjL,KAAM,OACN2L,OAAQ,CACPgxE,OAAQ,CACR,EACAzlC,QAAS,CACT,GAED,QAAW,SACX6rI,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,uBAAwB,CACvBjjL,KAAM,SACN,QAAW,IACX6hL,QAAS,EACT7jG,YAAY,EACZ+hG,MAAO,eACPgD,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBA2XlByC,gBAxXqB,CACrB,mCAAoC,CACnC1lL,KAAM,SACN,QAAW,IACX6hL,QAAS,EACTD,QAAS,IACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,gCAAiC,CAChCjjL,KAAM,OACN2L,OAAQ,CACP5R,IAAK,CACL,EACA86F,SAAU,CACV,GAED,QAAW,WACXkuF,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,yBAA0B,CACzBjjL,KAAM,SACN,QAAW,GACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,yBAA0B,CACzBjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,4BAA6B,CAC5BjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,yBAA0B,CACzBjjL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBAySlB0C,iBAtSsB,CACtB,mBAAoB,CACnB3lL,KAAM,QACN,QAAW,UACXg+E,YAAY,EACZwlG,SAAU,CACT,CACC,IAAK,uBAGPT,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,iBAElB,qBAAsB,CACrBjjL,KAAM,gBACNg+E,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,eAElB,qBAAsB,CACrBjjL,KAAM,SACN,QAAW,EACX6hL,QAAS,EACTD,QAAS,EACT5jG,YAAY,EACZ+kG,WAAY,CACXC,cAAc,EACdC,WAAY,CACX,SAGF,gBAAiB,kBA8PlBjlG,WA3PgB,CAChB19C,SAAU,CACTtgC,KAAM,SACN,QAAW,IACX6hL,QAAS,EACT9B,MAAO,gBAERjnI,MAAO,CACN94C,KAAM,SACN,QAAW,EACX6hL,QAAS,EACT9B,MAAO,iBAiPR,gBAAiB,CACjB,cAAe,CACd//K,KAAM,iBAEP,cAAe,CACdA,KAAM,iBAEP,0BAA2B,CAC1BA,KAAM,iBAEP,aAAc,CACbA,KAAM,iBAEP,gBAAiB,CAChBA,KAAM,iBAEP4lL,SAAU,CACT5lL,KAAM,kBAGP6gL,UAlQe,CACf,IAAK,CACJ7gL,KAAM,YAmQR,MAAM6lL,EAAgB,CAAC,OAAQ,SAAU,eAAgB,UAAW,UAAW,SAAU,UAEzF,SAASC,EAAMxlL,EAAO0pC,GAClB,MAAMjrC,EAAS,CAAC,EAChB,IAAK,MAAMtF,KAAK6G,EACF,QAAN7G,IACAsF,EAAOtF,GAAK6G,EAAM7G,IAQ1B,OALAosL,EAAcnoL,SAASjE,IACfA,KAAKuwC,IACLjrC,EAAOtF,GAAKuwC,EAAOvwC,GACvB,IAEGsF,CACX,CAuWA,MAAM+xB,EACF,WAAA53B,CAAY0B,EAAKC,EAAOjF,EAAS6+D,GAC7B3gE,KAAK8B,SAAWgF,EAAM,GAAGA,MAAU,IAAMhF,EACrC6+D,IACA3gE,KAAK2gE,WAAaA,GAClB55D,SAAyCA,EAAMkrL,WAC/CjyL,KAAKic,KAAOlV,EAAMkrL,SAE1B,EAaJ,SAASC,EAAS7zG,KAAWtxD,GACzB,IAAK,MAAMnY,KAASmY,EAChB,IAAK,MAAMpnB,KAAKiP,EACZypE,EAAO14E,GAAKiP,EAAMjP,GAG1B,OAAO04E,CACX,CAEA,MAAM8zG,UAA+B1yL,MACjC,WAAA2F,CAAY0B,EAAKhF,GACbswL,MAAMtwL,GACN9B,KAAK8B,QAAUA,EACf9B,KAAK8G,IAAMA,CACf,EAOJ,MAAMurL,EACF,WAAAjtL,CAAY8wC,EAAQo8I,EAAW,IAC3BtyL,KAAKk2C,OAASA,EACdl2C,KAAKsyL,SAAW,CAAC,EACjB,IAAK,MAAOjqL,EAAM4mL,KAAeqD,EAC7BtyL,KAAKsyL,SAASjqL,GAAQ4mL,CAE9B,CACA,MAAA1+J,CAAO+hK,GACH,OAAO,IAAID,EAAMryL,KAAMsyL,EAC3B,CACA,GAAA97J,CAAInuB,GACA,GAAIrI,KAAKsyL,SAASjqL,GACd,OAAOrI,KAAKsyL,SAASjqL,GAEzB,GAAIrI,KAAKk2C,OACL,OAAOl2C,KAAKk2C,OAAO1f,IAAInuB,GAE3B,MAAM,IAAI5I,MAAM,GAAG4I,wBACvB,CACA,GAAAooL,CAAIpoL,GACA,QAAIrI,KAAKsyL,SAASjqL,MAEXrI,KAAKk2C,QAASl2C,KAAKk2C,OAAOu6I,IAAIpoL,EACzC,EAGJ,MAAMkqL,EAAW,CAAExqJ,KAAM,QACnByqJ,EAAa,CAAEzqJ,KAAM,UACrB0qJ,EAAa,CAAE1qJ,KAAM,UACrB2qJ,EAAc,CAAE3qJ,KAAM,WACtB4qJ,EAAY,CAAE5qJ,KAAM,SACpB6qJ,EAA2B,CAAE7qJ,KAAM,wBACnC8qJ,EAAa,CAAE9qJ,KAAM,UACrB+qJ,EAAY,CAAE/qJ,KAAM,SAEpBgrJ,EAAe,CAAEhrJ,KAAM,YACvBirJ,EAAgB,CAAEjrJ,KAAM,aACxBkrJ,EAAc,CAAElrJ,KAAM,WACtBmrJ,EAAoB,CAAEnrJ,KAAM,iBAC5BorJ,GAAqC,CAAEprJ,KAAM,kCACnD,SAASjT,GAAMs+J,EAAUC,GACrB,MAAO,CACHtrJ,KAAM,QACNqrJ,WACAC,IAER,CACA,SAASC,GAAapnL,GAClB,GAAkB,UAAdA,EAAK67B,KAAkB,CACvB,MAAMqrJ,EAAWE,GAAapnL,EAAKknL,UACnC,MAAyB,iBAAXlnL,EAAKmnL,EACf,SAASD,MAAalnL,EAAKmnL,KACJ,UAAvBnnL,EAAKknL,SAASrrJ,KAAmB,QAAU,SAASqrJ,IAC5D,CAEI,OAAOlnL,EAAK67B,IAEpB,CACA,MAAMwrJ,GAAmB,CACrBhB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAI,EACAH,EACA/9J,GAAMg+J,GACNG,EACAC,EACAC,IAOJ,SAASK,GAAaC,EAAU1uH,GAC5B,GAAe,UAAXA,EAAEh9B,KAEF,OAAO,KAEN,GAAsB,UAAlB0rJ,EAAS1rJ,MACd,GAAe,UAAXg9B,EAAEh9B,OACQ,IAARg9B,EAAEsuH,GAA+B,UAApBtuH,EAAEquH,SAASrrJ,OAAsByrJ,GAAaC,EAASL,SAAUruH,EAAEquH,aAC3D,iBAAfK,EAASJ,GAAkBI,EAASJ,IAAMtuH,EAAEsuH,GACpD,OAAO,SAGV,IAAII,EAAS1rJ,OAASg9B,EAAEh9B,KACzB,OAAO,KAEN,GAAsB,UAAlB0rJ,EAAS1rJ,KACd,IAAK,MAAM2rJ,KAAcH,GACrB,IAAKC,GAAaE,EAAY3uH,GAC1B,OAAO,IAGnB,CACA,MAAO,YAAYuuH,GAAaG,gBAAuBH,GAAavuH,aACxE,CACA,SAAS4uH,GAAYC,EAAUC,GAC3B,OAAOA,EAAatwI,MAAKwhB,GAAKA,EAAEh9B,OAAS6rJ,EAAS7rJ,MACtD,CACA,SAAS+rJ,GAAkBF,EAAUC,GACjC,OAAOA,EAAatwI,MAAKwhB,GACX,SAANA,EACoB,OAAb6uH,EAEI,UAAN7uH,EACEv7D,MAAM4E,QAAQwlL,GAEV,WAAN7uH,EACE6uH,IAAapqL,MAAM4E,QAAQwlL,IAAiC,iBAAbA,EAG/C7uH,WAAa6uH,GAGhC,CAoBA,SAASG,GAAWH,EAAUI,GAC1B,MAAsB,UAAlBJ,EAAS7rJ,MAAoC,UAAhBisJ,EAAOjsJ,KAC7B6rJ,EAASR,SAASrrJ,OAASisJ,EAAOZ,SAASrrJ,MAA8B,iBAAf6rJ,EAASP,EAEvEO,EAAS7rJ,OAASisJ,EAAOjsJ,IACpC,CAGA,MAAMksJ,GAAK,OAAiBC,GAAK,OAASC,GAAK,EAAI,GAAIC,GAAK,EAAI,GAAIC,GAAK,EAAID,GAAKA,GAAIE,GAAKF,GAAKA,GAAKA,GAAIG,GAAUh9J,KAAK3F,GAAK,IAAK4iK,GAAU,IAAMj9J,KAAK3F,GACvJ,SAAS6iK,GAAehwF,GAKpB,OAJAA,GAAgB,KACJ,IACRA,GAAS,KAENA,CACX,CACA,SAASiwF,IAAUrmJ,EAAG/I,EAAG9qB,EAAGuzB,IAIxB,IAAIzoC,EAAGw8B,EACP,MAAMv8B,EAAIovL,IAAS,UAJnBtmJ,EAAIumJ,GAAQvmJ,IAIuB,UAHnC/I,EAAIsvJ,GAAQtvJ,IAGuC,UAFnD9qB,EAAIo6K,GAAQp6K,KAXS,GAcjB6zB,IAAM/I,GAAKA,IAAM9qB,EACjBlV,EAAIw8B,EAAIv8B,GAGRD,EAAIqvL,IAAS,SAAYtmJ,EAAI,SAAY/I,EAAI,SAAY9qB,GAAKy5K,IAC9DnyJ,EAAI6yJ,IAAS,SAAYtmJ,EAAI,SAAY/I,EAAI,SAAY9qB,GAAK05K,KAElE,MAAMxwK,EAAI,IAAMne,EAAI,GACpB,MAAO,CAAEme,EAAI,EAAK,EAAIA,EAAG,KAAOpe,EAAIC,GAAI,KAAOA,EAAIu8B,GAAIiM,EAC3D,CACA,SAAS6mJ,GAAQtvL,GACb,OAAQA,GAAK,OAAWA,EAAI,MAAQiyB,KAAK8X,KAAK/pC,EAAI,MAAS,MAAO,IACtE,CACA,SAASqvL,GAAQ5vH,GACb,OAAQA,EAAIuvH,GAAM/8J,KAAK8X,IAAI01B,EAAG,EAAI,GAAKA,EAAIsvH,GAAKF,EACpD,CACA,SAASU,IAAUnxK,EAAGnJ,EAAGC,EAAGuzB,IACxB,IAAIxoC,GAAKme,EAAI,IAAM,IAAKpe,EAAIorC,MAAMn2B,GAAKhV,EAAIA,EAAIgV,EAAI,IAAKunB,EAAI4O,MAAMl2B,GAAKjV,EAAIA,EAAIiV,EAAI,IAInF,OAHAjV,EAhCqB,EAgCZuvL,GAAQvvL,GACjBD,EAAI2uL,GAAKa,GAAQxvL,GACjBw8B,EAAIoyJ,GAAKY,GAAQhzJ,GACV,CACHizJ,GAAQ,UAAYzvL,EAAI,UAAYC,EAAI,SAAYu8B,GACpDizJ,IAAS,SAAYzvL,EAAI,UAAYC,EAAI,QAAYu8B,GACrDizJ,GAAQ,SAAYzvL,EAAI,SAAYC,EAAI,UAAYu8B,GACpDiM,EAER,CACA,SAASgnJ,GAAQzvL,GAEb,OADAA,EAAKA,GAAK,OAAW,MAAQA,EAAI,MAAQiyB,KAAK8X,IAAI/pC,EAAG,EAAI,KAAO,MACpD,EAAK,EAAKA,EAAI,EAAK,EAAIA,CACvC,CACA,SAASwvL,GAAQ/vH,GACb,OAAQA,EAAIqvH,GAAMrvH,EAAIA,EAAIA,EAAIsvH,IAAMtvH,EAAIovH,GAC5C,CAqDA,SAASa,GAAcpgL,GAEnB,GAAc,iBADdA,EAAQA,EAAM7M,cAAcia,QAExB,MAAO,CAAC,EAAG,EAAG,EAAG,GAGrB,MAAMizK,EAAmBC,GAAYtgL,GACrC,GAAIqgL,EAAkB,CAClB,MAAO5mJ,EAAG/I,EAAG9qB,GAAKy6K,EAClB,MAAO,CAAC5mJ,EAAI,IAAK/I,EAAI,IAAK9qB,EAAI,IAAK,EACvC,CAEA,GAAI5F,EAAMmO,WAAW,KAAM,CAEvB,GADkB,+CACJnP,KAAKgB,GAAQ,CACvB,MAAM0G,EAAO1G,EAAMxT,OAAS,EAAI,EAAI,EACpC,IAAIgU,EAAI,EACR,MAAO,CACH+/K,GAASvgL,EAAM3G,MAAMmH,EAAGA,GAAKkG,IAC7B65K,GAASvgL,EAAM3G,MAAMmH,EAAGA,GAAKkG,IAC7B65K,GAASvgL,EAAM3G,MAAMmH,EAAGA,GAAKkG,IAC7B65K,GAASvgL,EAAM3G,MAAMmH,EAAGA,EAAIkG,IAAS,MAE7C,CACJ,CAEA,GAAI1G,EAAMmO,WAAW,OAAQ,CACzB,MAAMqyK,EAAY,oIACZC,EAAWzgL,EAAMlB,MAAM0hL,GAC7B,GAAIC,EAAU,CACV,MAAO1hJ,EACPtF,EACAinJ,EACAC,EACAjwJ,EACAkwJ,EACAC,EACAj7K,EACAk7K,EACAC,EACAp7K,EACAsrF,GACIwvF,EACEO,EAAY,CAACL,GAAM,IAAKE,GAAM,IAAKE,GAAI7vL,KAAK,IAClD,GAAkB,OAAd8vL,GACc,QAAdA,GACc,OAAdA,GACc,QAAdA,EAAqB,CACrB,MAAMC,EAAY,CAACP,EAAIE,EAAIE,GAAI5vL,KAAK,IAC9BgwL,EAA0B,QAAdD,EAAuB,IACtB,KAAdA,EAAoB,IAAM,EAC/B,GAAIC,EAAU,CACV,MAAM5nJ,EAAO,CACT,IAAOG,EAAIynJ,EAAU,EAAG,GACxB,IAAOxwJ,EAAIwwJ,EAAU,EAAG,GACxB,IAAOt7K,EAAIs7K,EAAU,EAAG,GACxBv7K,EAAIw7K,IAAYx7K,EAAGsrF,GAAM,GAE7B,GAAImwF,GAAgB9nJ,GAChB,OAAOA,CAGf,CAEJ,CACA,MACJ,CACJ,CAEA,MACM+nJ,EAAWrhL,EAAMlB,MADL,mIAElB,GAAIuiL,EAAU,CACV,MAAOtiJ,EACP75B,EACAy7K,EACA7lJ,EACA+lJ,EACA/xK,EACAiyK,EACAp7K,EACAsrF,GACIowF,EACEL,EAAY,CAACL,GAAM,IAAKE,GAAM,IAAKE,GAAI7vL,KAAK,IAClD,GAAkB,OAAd8vL,GACc,QAAdA,GACc,OAAdA,GACc,QAAdA,EAAqB,CACrB,MAAMM,EAAO,EACRp8K,EACD,IAAO41B,EAAG,EAAG,KACb,IAAOhsB,EAAG,EAAG,KACbnJ,EAAIw7K,IAAYx7K,EAAGsrF,GAAM,GAE7B,GAAImwF,GAAgBE,GAChB,OAvIhB,UAAmBp8K,EAAG41B,EAAGhsB,EAAGqqB,IAIxB,SAASzT,EAAE3Q,GACP,MAAMhkB,GAAKgkB,EAAI7P,EAAI,IAAM,GACnBS,EAAIm1B,EAAInY,KAAK9kB,IAAIiR,EAAG,EAAIA,GAC9B,OAAOA,EAAInJ,EAAIgd,KAAK5kB,KAAK,EAAG4kB,KAAK9kB,IAAI9M,EAAI,EAAG,EAAIA,EAAG,GACvD,CACA,OARAmU,EAAI26K,GAAe36K,GACnB41B,GAAK,IACLhsB,GAAK,IAME,CAAC4W,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIyT,EAC9B,CA6HuBooJ,CAASD,EAGxB,CAEJ,CACJ,CACA,SAASf,GAASp/J,GACd,OAAOpO,SAASoO,EAAIqgK,OAAO,EAAGrgK,GAAM,IAAM,GAC9C,CACA,SAASggK,GAAWx7K,EAAG87K,GACnB,OAAO,GAAMA,EAAgB97K,EAAI,IAAOA,EAAG,EAAG,EAClD,CACA,SAAS,GAAMoP,EAAGlX,EAAKE,GACnB,OAAO4kB,KAAK9kB,IAAI8kB,KAAK5kB,IAAIF,EAAKkX,GAAIhX,EACtC,CASA,SAASqjL,GAAgBlhK,GACrB,OAAQA,EAAMyuB,KAAKhW,OAAOmD,MAC9B,CAQA,MAAMwkJ,GAAc,CAChBoB,UAAW,CAAC,IAAK,IAAK,KACtBC,aAAc,CAAC,IAAK,IAAK,KACzBC,KAAM,CAAC,EAAG,IAAK,KACfC,WAAY,CAAC,IAAK,IAAK,KACvBC,MAAO,CAAC,IAAK,IAAK,KAClBC,MAAO,CAAC,IAAK,IAAK,KAClBC,OAAQ,CAAC,IAAK,IAAK,KACnBC,MAAO,CAAC,EAAG,EAAG,GACdC,eAAgB,CAAC,IAAK,IAAK,KAC3BhpJ,KAAM,CAAC,EAAG,EAAG,KACbipJ,WAAY,CAAC,IAAK,GAAI,KACtBC,MAAO,CAAC,IAAK,GAAI,IACjBC,UAAW,CAAC,IAAK,IAAK,KACtBC,UAAW,CAAC,GAAI,IAAK,KACrBC,WAAY,CAAC,IAAK,IAAK,GACvBC,UAAW,CAAC,IAAK,IAAK,IACtBC,MAAO,CAAC,IAAK,IAAK,IAClBC,eAAgB,CAAC,IAAK,IAAK,KAC3BC,SAAU,CAAC,IAAK,IAAK,KACrBC,QAAS,CAAC,IAAK,GAAI,IACnBC,KAAM,CAAC,EAAG,IAAK,KACfC,SAAU,CAAC,EAAG,EAAG,KACjBC,SAAU,CAAC,EAAG,IAAK,KACnBC,cAAe,CAAC,IAAK,IAAK,IAC1BC,SAAU,CAAC,IAAK,IAAK,KACrBC,UAAW,CAAC,EAAG,IAAK,GACpBC,SAAU,CAAC,IAAK,IAAK,KACrBC,UAAW,CAAC,IAAK,IAAK,KACtBC,YAAa,CAAC,IAAK,EAAG,KACtBC,eAAgB,CAAC,GAAI,IAAK,IAC1BC,WAAY,CAAC,IAAK,IAAK,GACvBC,WAAY,CAAC,IAAK,GAAI,KACtBC,QAAS,CAAC,IAAK,EAAG,GAClBC,WAAY,CAAC,IAAK,IAAK,KACvBC,aAAc,CAAC,IAAK,IAAK,KACzBC,cAAe,CAAC,GAAI,GAAI,KACxBC,cAAe,CAAC,GAAI,GAAI,IACxBC,cAAe,CAAC,GAAI,GAAI,IACxBC,cAAe,CAAC,EAAG,IAAK,KACxBC,WAAY,CAAC,IAAK,EAAG,KACrBC,SAAU,CAAC,IAAK,GAAI,KACpBC,YAAa,CAAC,EAAG,IAAK,KACtBC,QAAS,CAAC,IAAK,IAAK,KACpBC,QAAS,CAAC,IAAK,IAAK,KACpBC,WAAY,CAAC,GAAI,IAAK,KACtBC,UAAW,CAAC,IAAK,GAAI,IACrBC,YAAa,CAAC,IAAK,IAAK,KACxBC,YAAa,CAAC,GAAI,IAAK,IACvBC,QAAS,CAAC,IAAK,EAAG,KAClBC,UAAW,CAAC,IAAK,IAAK,KACtBC,WAAY,CAAC,IAAK,IAAK,KACvBC,KAAM,CAAC,IAAK,IAAK,GACjBC,UAAW,CAAC,IAAK,IAAK,IACtBC,KAAM,CAAC,IAAK,IAAK,KACjB7rJ,MAAO,CAAC,EAAG,IAAK,GAChB8rJ,YAAa,CAAC,IAAK,IAAK,IACxBC,KAAM,CAAC,IAAK,IAAK,KACjBC,SAAU,CAAC,IAAK,IAAK,KACrBC,QAAS,CAAC,IAAK,IAAK,KACpBC,UAAW,CAAC,IAAK,GAAI,IACrBC,OAAQ,CAAC,GAAI,EAAG,KAChBC,MAAO,CAAC,IAAK,IAAK,KAClBC,MAAO,CAAC,IAAK,IAAK,KAClBC,SAAU,CAAC,IAAK,IAAK,KACrBC,cAAe,CAAC,IAAK,IAAK,KAC1BC,UAAW,CAAC,IAAK,IAAK,GACtBC,aAAc,CAAC,IAAK,IAAK,KACzBC,UAAW,CAAC,IAAK,IAAK,KACtBC,WAAY,CAAC,IAAK,IAAK,KACvBC,UAAW,CAAC,IAAK,IAAK,KACtBC,qBAAsB,CAAC,IAAK,IAAK,KACjCC,UAAW,CAAC,IAAK,IAAK,KACtBC,WAAY,CAAC,IAAK,IAAK,KACvBC,UAAW,CAAC,IAAK,IAAK,KACtBC,UAAW,CAAC,IAAK,IAAK,KACtBC,YAAa,CAAC,IAAK,IAAK,KACxBC,cAAe,CAAC,GAAI,IAAK,KACzBC,aAAc,CAAC,IAAK,IAAK,KACzBC,eAAgB,CAAC,IAAK,IAAK,KAC3BC,eAAgB,CAAC,IAAK,IAAK,KAC3BC,eAAgB,CAAC,IAAK,IAAK,KAC3BC,YAAa,CAAC,IAAK,IAAK,KACxBC,KAAM,CAAC,EAAG,IAAK,GACfC,UAAW,CAAC,GAAI,IAAK,IACrBC,MAAO,CAAC,IAAK,IAAK,KAClBC,QAAS,CAAC,IAAK,EAAG,KAClBC,OAAQ,CAAC,IAAK,EAAG,GACjBC,iBAAkB,CAAC,IAAK,IAAK,KAC7BC,WAAY,CAAC,EAAG,EAAG,KACnBC,aAAc,CAAC,IAAK,GAAI,KACxBC,aAAc,CAAC,IAAK,IAAK,KACzBC,eAAgB,CAAC,GAAI,IAAK,KAC1BC,gBAAiB,CAAC,IAAK,IAAK,KAC5BC,kBAAmB,CAAC,EAAG,IAAK,KAC5BC,gBAAiB,CAAC,GAAI,IAAK,KAC3BC,gBAAiB,CAAC,IAAK,GAAI,KAC3BC,aAAc,CAAC,GAAI,GAAI,KACvBC,UAAW,CAAC,IAAK,IAAK,KACtBC,UAAW,CAAC,IAAK,IAAK,KACtBC,SAAU,CAAC,IAAK,IAAK,KACrBC,YAAa,CAAC,IAAK,IAAK,KACxBC,KAAM,CAAC,EAAG,EAAG,KACbC,QAAS,CAAC,IAAK,IAAK,KACpBC,MAAO,CAAC,IAAK,IAAK,GAClBC,UAAW,CAAC,IAAK,IAAK,IACtBC,OAAQ,CAAC,IAAK,IAAK,GACnBC,UAAW,CAAC,IAAK,GAAI,GACrBC,OAAQ,CAAC,IAAK,IAAK,KACnBC,cAAe,CAAC,IAAK,IAAK,KAC1BC,UAAW,CAAC,IAAK,IAAK,KACtBC,cAAe,CAAC,IAAK,IAAK,KAC1BC,cAAe,CAAC,IAAK,IAAK,KAC1BC,WAAY,CAAC,IAAK,IAAK,KACvBC,UAAW,CAAC,IAAK,IAAK,KACtBC,KAAM,CAAC,IAAK,IAAK,IACjBC,KAAM,CAAC,IAAK,IAAK,KACjBC,KAAM,CAAC,IAAK,IAAK,KACjBC,WAAY,CAAC,IAAK,IAAK,KACvBC,OAAQ,CAAC,IAAK,EAAG,KACjBC,cAAe,CAAC,IAAK,GAAI,KACzB/vJ,IAAK,CAAC,IAAK,EAAG,GACdgwJ,UAAW,CAAC,IAAK,IAAK,KACtBC,UAAW,CAAC,GAAI,IAAK,KACrBC,YAAa,CAAC,IAAK,GAAI,IACvBC,OAAQ,CAAC,IAAK,IAAK,KACnBC,WAAY,CAAC,IAAK,IAAK,IACvBC,SAAU,CAAC,GAAI,IAAK,IACpBC,SAAU,CAAC,IAAK,IAAK,KACrBC,OAAQ,CAAC,IAAK,GAAI,IAClBC,OAAQ,CAAC,IAAK,IAAK,KACnBC,QAAS,CAAC,IAAK,IAAK,KACpBC,UAAW,CAAC,IAAK,GAAI,KACrBC,UAAW,CAAC,IAAK,IAAK,KACtBC,UAAW,CAAC,IAAK,IAAK,KACtBC,KAAM,CAAC,IAAK,IAAK,KACjBC,YAAa,CAAC,EAAG,IAAK,KACtBC,UAAW,CAAC,GAAI,IAAK,KACrBC,IAAK,CAAC,IAAK,IAAK,KAChBC,KAAM,CAAC,EAAG,IAAK,KACfC,QAAS,CAAC,IAAK,IAAK,KACpBC,OAAQ,CAAC,IAAK,GAAI,IAClBC,UAAW,CAAC,GAAI,IAAK,KACrBC,OAAQ,CAAC,IAAK,IAAK,KACnBC,MAAO,CAAC,IAAK,IAAK,KAClBC,MAAO,CAAC,IAAK,IAAK,KAClBC,WAAY,CAAC,IAAK,IAAK,KACvBC,OAAQ,CAAC,IAAK,IAAK,GACnBC,YAAa,CAAC,IAAK,IAAK,KAG5B,SAASC,GAAkB91L,EAAM60C,EAAIymB,GACjC,OAAOt7D,EAAOs7D,GAAKzmB,EAAK70C,EAC5B,CACA,SAAS+1L,GAAiB/1L,EAAM60C,EAAIymB,GAChC,OAAOt7D,EAAKxD,KAAI,CAACwpC,EAAGr6B,IACTmqL,GAAkB9vJ,EAAG6O,EAAGlpC,GAAI2vD,IAE3C,CAiBA,MAAMrrD,GAUF,WAAAtU,CAAYipC,EAAG/I,EAAG9qB,EAAGuzB,EAAQ,EAAG0xJ,GAAgB,GAC5Cz/L,KAAKquC,EAAIA,EACTruC,KAAKslC,EAAIA,EACTtlC,KAAKwa,EAAIA,EACTxa,KAAKua,EAAIwzB,EACJ0xJ,IACDz/L,KAAKquC,GAAKN,EACV/tC,KAAKslC,GAAKyI,EACV/tC,KAAKwa,GAAKuzB,EACLA,GAID/tC,KAAK0/L,gBAAgB,MAAO,CAACrxJ,EAAG/I,EAAG9qB,EAAGuzB,IAGlD,CAYA,YAAOtqC,CAAMmR,GAET,GAAIA,aAAiB8E,GACjB,OAAO9E,EAEX,GAAqB,iBAAVA,EACP,OAEJ,MAAMs5B,EAAO8mJ,GAAcpgL,GAC3B,OAAIs5B,EACO,IAAIx0B,MAASw0B,GAAM,QAD9B,CAGJ,CAMA,OAAII,GACA,MAAM,EAAED,EAAC,EAAE/I,EAAC,EAAE9qB,EAAC,EAAED,GAAMva,KACjBs6B,EAAI/f,GAAK++B,IACf,OAAOt5C,KAAK0/L,gBAAgB,MAAO,CAACrxJ,EAAI/T,EAAGgL,EAAIhL,EAAG9f,EAAI8f,EAAG/f,GAC7D,CAMA,OAAI02K,GACA,OAAOjxL,KAAK0/L,gBAAgB,MAtapC,SAAkBC,GACd,MAAOj8K,EAAGnJ,EAAGC,EAAGuzB,GAAS2mJ,GAASiL,GAC5BxoK,EAAII,KAAKsjB,KAAKtgC,EAAIA,EAAIC,EAAIA,GAEhC,MAAO,CADG+c,KAAKC,MAAU,IAAJL,GAAas9J,GAAel9J,KAAKqoK,MAAMplL,EAAGD,GAAKi6K,IAAWqL,IACpE1oK,EAAGzT,EAAGqqB,EACrB,CAia2C+xJ,CAAS9/L,KAAKsuC,KACrD,CAMA,OAAI0iJ,GACA,OAAOhxL,KAAK0/L,gBAAgB,MAAOhL,GAAS10L,KAAKsuC,KACrD,CAoBA,eAAAoxJ,CAAgBK,EAAWC,GAEvB,OADA9+L,OAAO+wC,eAAejyC,KAAM+/L,EAAW,CAAEh5L,MAAOi5L,IACzCA,CACX,CAaA,QAAAxyJ,GACI,MAAOa,EAAG/I,EAAG9qB,EAAGD,GAAKva,KAAKsuC,IAC1B,MAAO,QAAQ,CAACD,EAAG/I,EAAG9qB,GAAGvU,KAAI0jB,GAAK4N,KAAKC,MAAU,IAAJ7N,KAAU7jB,KAAK,QAAQyU,IACxE,CACA,kBAAO4uE,CAAY1/E,EAAM60C,EAAIymB,EAAGk7H,EAAW,OACvC,OAAQA,GACJ,IAAK,MAAO,CACR,MAAO5xJ,EAAG/I,EAAG9qB,EAAGuzB,GAASyxJ,GAAiB/1L,EAAK6kC,IAAKgQ,EAAGhQ,IAAKy2B,GAC5D,OAAO,IAAIrrD,GAAM20B,EAAG/I,EAAG9qB,EAAGuzB,GAAO,EACrC,CACA,IAAK,MAAO,CACR,MAAOmyJ,EAAMC,EAASC,EAAQC,GAAU52L,EAAKwnL,KACtCqP,EAAMC,EAASC,EAAQC,GAAUniJ,EAAG2yI,IAE3C,IAAIyP,EAAKC,EACT,GAAKjwJ,MAAMwvJ,IAAUxvJ,MAAM4vJ,GAUjB5vJ,MAAMwvJ,GAKNxvJ,MAAM4vJ,GAMZI,EAAMb,KALNa,EAAMJ,EACS,IAAXF,GAA2B,IAAXA,IAChBO,EAASJ,KAPbG,EAAMR,EACS,IAAXM,GAA2B,IAAXA,IAChBG,EAASR,QAbiB,CAC9B,IAAIS,EAAKN,EAAOJ,EACZI,EAAOJ,GAAQU,EAAK,IACpBA,GAAM,IAEDN,EAAOJ,GAAQA,EAAOI,EAAO,MAClCM,GAAM,KAEVF,EAAMR,EAAOn7H,EAAI67H,CACrB,CAcA,MAAOvyJ,EAAG/I,EAAG9qB,EAAGuzB,GAnfhC,UAAmBj0B,EAAGqd,EAAGzT,EAAGqqB,IAExB,OADAj0B,EAAI42B,MAAM52B,GAAK,EAAIA,EAAIy6K,GAChBM,GAAS,CAACnxK,EAAG6T,KAAKspK,IAAI/mL,GAAKqd,EAAGI,KAAKupK,IAAIhnL,GAAKqd,EAAG4W,GAC1D,CAgfyCgzJ,CAAS,CAC9BL,EACAC,QAA0CA,EAASpB,GAAkBY,EAASI,EAASx7H,GACvFw6H,GAAkBa,EAAQI,EAAQz7H,GAClCw6H,GAAkBc,EAAQI,EAAQ17H,KAEtC,OAAO,IAAIrrD,GAAM20B,EAAG/I,EAAG9qB,EAAGuzB,GAAO,EACrC,CACA,IAAK,MAAO,CACR,MAAOM,EAAG/I,EAAG9qB,EAAGuzB,GAAS8mJ,GAAS2K,GAAiB/1L,EAAKunL,IAAK1yI,EAAG0yI,IAAKjsH,IACrE,OAAO,IAAIrrD,GAAM20B,EAAG/I,EAAG9qB,EAAGuzB,GAAO,EACrC,EAER,EAEJr0B,GAAMm9K,MAAQ,IAAIn9K,GAAM,EAAG,EAAG,EAAG,GACjCA,GAAMylL,MAAQ,IAAIzlL,GAAM,EAAG,EAAG,EAAG,GACjCA,GAAMsnL,YAAc,IAAItnL,GAAM,EAAG,EAAG,EAAG,GACvCA,GAAMk0B,IAAM,IAAIl0B,GAAM,EAAG,EAAG,EAAG,GAI/B,MAAMunL,GACF,WAAA77L,CAAY87L,EAAeC,EAAoBC,GAEvCphM,KAAKqhM,YADLH,EACmBC,EAAqB,UAAY,OAEjCA,EAAqB,SAAW,OACvDnhM,KAAKohM,OAASA,EACdphM,KAAKshM,SAAW,IAAIC,KAAKN,SAASjhM,KAAKohM,OAASphM,KAAKohM,OAAS,GAAI,CAAEC,YAAarhM,KAAKqhM,YAAaG,MAAO,UAC9G,CACA,OAAAC,CAAQC,EAAKC,GACT,OAAO3hM,KAAKshM,SAASG,QAAQC,EAAKC,EACtC,CACA,cAAAC,GAGI,OAAO,IAAIL,KAAKN,SAASjhM,KAAKohM,OAASphM,KAAKohM,OAAS,IAChDS,kBAAkBT,MAC3B,EAGJ,MAAMU,GAAyB,CAAC,SAAU,SAAU,OACpD,MAAMC,GACF,WAAA38L,CAAYvD,EAAMkT,EAAOzF,EAAO0yL,EAAWC,EAAWC,GAClDliM,KAAK6B,KAAOA,EACZ7B,KAAK+U,MAAQA,EACb/U,KAAKsP,MAAQA,EACbtP,KAAKgiM,UAAYA,EACjBhiM,KAAKiiM,UAAYA,EACjBjiM,KAAKkiM,cAAgBA,CACzB,EAEJ,MAAMC,GACF,WAAA/8L,CAAYg9L,GACRpiM,KAAKoiM,SAAWA,CACpB,CACA,iBAAOC,CAAWC,GACd,OAAO,IAAIH,GAAU,CAAC,IAAIJ,GAAiBO,EAAa,KAAM,KAAM,KAAM,KAAM,OACpF,CACA,OAAAC,GACI,OAA6B,IAAzBviM,KAAKoiM,SAAShhM,SAEVpB,KAAKoiM,SAAS7+I,MAAKi/I,GAAmC,IAAxBA,EAAQ3gM,KAAKT,QAC9CohM,EAAQztL,OAAuC,IAA9BytL,EAAQztL,MAAM1M,KAAKjH,QAC7C,CACA,cAAOkiC,CAAQzhC,GACX,OAAIA,aAAgBsgM,GACTtgM,EAGAsgM,GAAUE,WAAWxgM,EAEpC,CACA,QAAA2rC,GACI,OAA6B,IAAzBxtC,KAAKoiM,SAAShhM,OACP,GACJpB,KAAKoiM,SAASn8L,KAAIu8L,GAAWA,EAAQ3gM,OAAMiE,KAAK,GAC3D,EAQJ,MAAM28L,GACF,WAAAr9L,CAAYyS,GACR7X,KAAK6X,OAASA,EAAO5J,OACzB,CAMA,YAAOxK,CAAMmR,GACT,GAAIA,aAAiB6tL,GACjB,OAAO7tL,EAIX,GAAqB,iBAAVA,EACP,OAAO,IAAI6tL,GAAQ,CAAC7tL,EAAOA,EAAOA,EAAOA,IAE7C,GAAKpL,MAAM4E,QAAQwG,MAGfA,EAAMxT,OAAS,GAAKwT,EAAMxT,OAAS,GAAvC,CAGA,IAAK,MAAMgY,KAAOxE,EACd,GAAmB,iBAARwE,EACP,OAIR,OAAQxE,EAAMxT,QACV,KAAK,EACDwT,EAAQ,CAACA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAC7C,MACJ,KAAK,EACDA,EAAQ,CAACA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAC7C,MACJ,KAAK,EACDA,EAAQ,CAACA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAGrD,OAAO,IAAI6tL,GAAQ7tL,EAlBnB,CAmBJ,CACA,QAAA44B,GACI,OAAOhqC,KAAKqC,UAAU7F,KAAK6X,OAC/B,CACA,kBAAOsxE,CAAY1/E,EAAM60C,EAAIymB,GACzB,OAAO,IAAI09H,GAAQjD,GAAiB/1L,EAAKoO,OAAQymC,EAAGzmC,OAAQktD,GAChE,EAGJ,MAAM29H,GACF,WAAAt9L,CAAYtD,GACR9B,KAAKqI,KAAO,4BACZrI,KAAK8B,QAAUA,CACnB,CACA,MAAA6gM,GACI,OAAO3iM,KAAK8B,OAChB,EAIJ,MAAM,GAAU,IAAI8gM,IAAI,CAAC,SAAU,OAAQ,QAAS,MAAO,SAAU,WAAY,YAAa,cAAe,iBAM7G,MAAMC,GACF,WAAAz9L,CAAYyS,GACR7X,KAAK6X,OAASA,EAAO5J,OACzB,CACA,YAAOxK,CAAMmR,GACT,GAAIA,aAAiBiuL,GACjB,OAAOjuL,EAEX,GAAKpL,MAAM4E,QAAQwG,MACfA,EAAMxT,OAAS,IACfwT,EAAMxT,OAAS,GAAM,EAFzB,CAKA,IAAK,IAAIgU,EAAI,EAAGA,EAAIR,EAAMxT,OAAQgU,GAAK,EAAG,CAEtC,MAAM0tL,EAAcluL,EAAMQ,GACpB2tL,EAAcnuL,EAAMQ,EAAI,GAC9B,GAA2B,iBAAhB0tL,IAA6B,GAAQrS,IAAIqS,GAChD,OAEJ,IAAKt5L,MAAM4E,QAAQ20L,IAAuC,IAAvBA,EAAY3hM,QAA0C,iBAAnB2hM,EAAY,IAA6C,iBAAnBA,EAAY,GACpH,MAER,CACA,OAAO,IAAIF,GAA+BjuL,EAZ1C,CAaJ,CACA,QAAA44B,GACI,OAAOhqC,KAAKqC,UAAU7F,KAAK6X,OAC/B,CACA,kBAAOsxE,CAAY1/E,EAAM60C,EAAIymB,GACzB,MAAMi+H,EAAav5L,EAAKoO,OAClBorL,EAAW3kJ,EAAGzmC,OACpB,GAAImrL,EAAW5hM,SAAW6hM,EAAS7hM,OAC/B,MAAM,IAAIshM,GAAa,wDAAwDj5L,EAAK+jC,mBAAmB8Q,EAAG9Q,cAE9G,MAAM6wC,EAAS,GACf,IAAK,IAAIjpE,EAAI,EAAGA,EAAI4tL,EAAW5hM,OAAQgU,GAAK,EAAG,CAE3C,GAAI4tL,EAAW5tL,KAAO6tL,EAAS7tL,GAC3B,MAAM,IAAIstL,GAAa,iEAAiEttL,OAAO4tL,EAAW5tL,UAAUA,OAAO6tL,EAAS7tL,MAExIipE,EAAOz4E,KAAKo9L,EAAW5tL,IAEvB,MAAO8tL,EAAIC,GAAMH,EAAW5tL,EAAI,IACzBguL,EAAIC,GAAMJ,EAAS7tL,EAAI,GAC9BipE,EAAOz4E,KAAK,CAAC25L,GAAkB2D,EAAIE,EAAIr+H,GAAIw6H,GAAkB4D,EAAIE,EAAIt+H,IACzE,CACA,OAAO,IAAI89H,GAA+BxkH,EAC9C,EAGJ,MAAMilH,GACF,WAAAl+L,CAAYxF,GACRI,KAAKqI,KAAOzI,EAAQyI,KACpBrI,KAAKujM,UAAY3jM,EAAQ2jM,SAC7B,CACA,QAAA/1J,GACI,OAAOxtC,KAAKqI,IAChB,CACA,iBAAOg6L,CAAWh6L,GACd,OAAKA,EAEE,IAAIi7L,GAAc,CAAEj7L,OAAMk7L,WAAW,IADjC,IAEf,EAGJ,MAAMC,GACF,WAAAp+L,CAAYqE,EAAM60C,EAAI4rC,GAClBlqF,KAAKyJ,KAAOA,EACZzJ,KAAKs+C,GAAKA,EACVt+C,KAAKkqF,WAAaA,CACtB,CACA,kBAAOf,CAAY1/E,EAAM60C,EAAIymB,GACzB,OAAO,IAAIy+H,GAAqB/5L,EAAM60C,EAAIymB,EAC9C,CACA,YAAOthE,CAAMmR,GACT,OAAIA,aAAiB4uL,GACV5uL,EAEPpL,MAAM4E,QAAQwG,IAA2B,IAAjBA,EAAMxT,QAAoC,iBAAbwT,EAAM,IAAuC,iBAAbA,EAAM,IAAuC,iBAAbA,EAAM,GACpH,IAAI4uL,GAAqB5uL,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAEzC,iBAAVA,GAA4C,iBAAfA,EAAMnL,MAAyC,iBAAbmL,EAAM0pC,IAA+C,iBAArB1pC,EAAMs1E,WACrG,IAAIs5G,GAAqB5uL,EAAMnL,KAAMmL,EAAM0pC,GAAI1pC,EAAMs1E,YAE3C,iBAAVt1E,EACA,IAAI4uL,GAAqB5uL,EAAOA,EAAO,QADlD,CAIJ,EAGJ,SAAS6uL,GAAap1J,EAAG/I,EAAG9qB,EAAGD,GAC3B,KAAmB,iBAAN8zB,GAAkBA,GAAK,GAAKA,GAAK,KAC7B,iBAAN/I,GAAkBA,GAAK,GAAKA,GAAK,KAC3B,iBAAN9qB,GAAkBA,GAAK,GAAKA,GAAK,KAAM,CAE9C,MAAO,wBADoB,iBAAND,EAAiB,CAAC8zB,EAAG/I,EAAG9qB,EAAGD,GAAK,CAAC8zB,EAAG/I,EAAG9qB,IACxB1U,KAAK,sDAC7C,CACA,YAAmB,IAANyU,GAAmC,iBAANA,GAAkBA,GAAK,GAAKA,GAAK,EAGpE,KAFI,uBAAuB,CAAC8zB,EAAG/I,EAAG9qB,EAAGD,GAAGzU,KAAK,sCAGxD,CACA,SAAS49L,GAAQC,GACb,GAAc,OAAVA,GACiB,iBAAVA,GACU,kBAAVA,GACU,iBAAVA,GACPA,aAAiBH,IACjBG,aAAiBjqL,IACjBiqL,aAAiB1C,IACjB0C,aAAiBxB,IACjBwB,aAAiBlB,IACjBkB,aAAiBd,IACjBc,aAAiBL,GACjB,OAAO,EAEN,GAAI95L,MAAM4E,QAAQu1L,GAAQ,CAC3B,IAAK,MAAMplJ,KAAQolJ,EACf,IAAKD,GAAQnlJ,GACT,OAAO,EAGf,OAAO,CACX,CACK,GAAqB,iBAAVolJ,EAAoB,CAChC,IAAK,MAAM78L,KAAO68L,EACd,IAAKD,GAAQC,EAAM78L,IACf,OAAO,EAGf,OAAO,CACX,CAEI,OAAO,CAEf,CACA,SAAS88L,GAAO78L,GACZ,GAAc,OAAVA,EACA,OAAOwrL,EAEN,GAAqB,iBAAVxrL,EACZ,OAAO0rL,EAEN,GAAqB,kBAAV1rL,EACZ,OAAO2rL,EAEN,GAAqB,iBAAV3rL,EACZ,OAAOyrL,EAEN,GAAIzrL,aAAiB2S,GACtB,OAAOi5K,EAEN,GAAI5rL,aAAiBy8L,GACtB,OAAO5Q,EAEN,GAAI7rL,aAAiBk6L,GACtB,OAAOlO,EAEN,GAAIhsL,aAAiBo7L,GACtB,OAAOnP,EAEN,GAAIjsL,aAAiB07L,GACtB,OAAOxP,EAEN,GAAIlsL,aAAiB87L,GACtB,OAAO1P,GAEN,GAAIpsL,aAAiBu8L,GACtB,OAAOpQ,EAEN,GAAI1pL,MAAM4E,QAAQrH,GAAQ,CAC3B,MAAM3F,EAAS2F,EAAM3F,OACrB,IAAIgyL,EACJ,IAAK,MAAM70I,KAAQx3C,EAAO,CACtB,MAAMg+D,EAAI6+H,GAAOrlJ,GACjB,GAAK60I,EAGA,IAAIA,IAAaruH,EAClB,SAGAquH,EAAWN,EACX,KACJ,CARIM,EAAWruH,CASnB,CACA,OAAOjwC,GAAMs+J,GAAYN,EAAW1xL,EACxC,CAEI,OAAOyxL,CAEf,CACA,SAASgR,GAAc98L,GACnB,MAAMmF,SAAcnF,EACpB,OAAc,OAAVA,EACO,GAEO,WAATmF,GAA8B,WAATA,GAA8B,YAATA,EACxCg2D,OAAOn7D,GAETA,aAAiB2S,IAAS3S,aAAiBy8L,IAAwBz8L,aAAiBo7L,IAAap7L,aAAiB07L,IAAW17L,aAAiB87L,IAAkC97L,aAAiBu8L,GAC/Lv8L,EAAMymC,WAGNhqC,KAAKqC,UAAUkB,EAE9B,CAEA,MAAM+8L,GACF,WAAA1+L,CAAY8G,EAAMnF,GACd/G,KAAKkM,KAAOA,EACZlM,KAAK+G,MAAQA,CACjB,CACA,YAAOtD,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,iEAAiEyN,EAAK/M,OAAS,cACxG,IAAKsiM,GAAQv1L,EAAK,IACd,OAAOpD,EAAQrK,MAAM,iBACzB,MAAMqG,EAAQoH,EAAK,GACnB,IAAIjC,EAAO03L,GAAO78L,GAElB,MAAM0sL,EAAW1oL,EAAQg5L,aAQzB,MAPkB,UAAd73L,EAAK67B,MACM,IAAX77B,EAAKmnL,IACLI,GACkB,UAAlBA,EAAS1rJ,MACc,iBAAf0rJ,EAASJ,GAAiC,IAAfI,EAASJ,IAC5CnnL,EAAOunL,GAEJ,IAAIqQ,GAAQ53L,EAAMnF,EAC7B,CACA,QAAAi9L,GACI,OAAOhkM,KAAK+G,KAChB,CACA,SAAAk9L,GAAc,CACd,aAAAC,GACI,OAAO,CACX,EAGJ,MAAMC,GAAU,CACZC,OAAQ3R,EACRnlJ,OAAQklJ,EACR6R,QAAS3R,EACTlhJ,OAAQqhJ,GAEZ,MAAMyR,GACF,WAAAl/L,CAAY8G,EAAMiC,GACdnO,KAAKkM,KAAOA,EACZlM,KAAKmO,KAAOA,CAChB,CACA,YAAO1K,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,mCACzB,IACIwL,EADAkJ,EAAI,EAER,MAAM/M,EAAO8F,EAAK,GAClB,GAAa,UAAT9F,EAAkB,CAClB,IAAI+qL,EAWAC,EAVJ,GAAIllL,EAAK/M,OAAS,EAAG,CACjB,MAAM8K,EAAOiC,EAAK,GAClB,GAAoB,iBAATjC,KAAuBA,KAAQi4L,KAAqB,WAATj4L,EAClD,OAAOnB,EAAQrK,MAAM,2EAA4E,GACrG0yL,EAAW+Q,GAAQj4L,GACnBkJ,GACJ,MAEIg+K,EAAWN,EAGf,GAAI3kL,EAAK/M,OAAS,EAAG,CACjB,GAAgB,OAAZ+M,EAAK,KACe,iBAAZA,EAAK,IACTA,EAAK,GAAK,GACVA,EAAK,KAAOopB,KAAKyR,MAAM76B,EAAK,KAChC,OAAOpD,EAAQrK,MAAM,oEAAqE,GAE9F2yL,EAAIllL,EAAK,GACTiH,GACJ,CACAlJ,EAAO4oB,GAAMs+J,EAAUC,EAC3B,KACK,CACD,IAAK8Q,GAAQ97L,GACT,MAAM,IAAI5I,MAAM,gCAAgC4I,KACpD6D,EAAOi4L,GAAQ97L,EACnB,CACA,MAAM8lC,EAAS,GACf,KAAO/4B,EAAIjH,EAAK/M,OAAQgU,IAAK,CACzB,MAAMR,EAAQ7J,EAAQtH,MAAM0K,EAAKiH,GAAIA,EAAG09K,GACxC,IAAKl+K,EACD,OAAO,KACXu5B,EAAOvoC,KAAKgP,EAChB,CACA,OAAO,IAAI0vL,GAAUp4L,EAAMiiC,EAC/B,CACA,QAAA61J,CAASpjL,GACL,IAAK,IAAIxL,EAAI,EAAGA,EAAIpV,KAAKmO,KAAK/M,OAAQgU,IAAK,CACvC,MAAMrO,EAAQ/G,KAAKmO,KAAKiH,GAAG4uL,SAASpjL,GAEpC,IADc4yK,GAAaxzL,KAAKkM,KAAM03L,GAAO78L,IAEzC,OAAOA,EAEN,GAAIqO,IAAMpV,KAAKmO,KAAK/M,OAAS,EAC9B,MAAM,IAAIshM,GAAa,gCAAgCpP,GAAatzL,KAAKkM,oBAAoBonL,GAAasQ,GAAO78L,eAEzH,CACA,MAAM,IAAItH,KACd,CACA,SAAAwkM,CAAU5wJ,GACNrzC,KAAKmO,KAAKvE,QAAQypC,EACtB,CACA,aAAA6wJ,GACI,OAAOlkM,KAAKmO,KAAKopE,OAAM27F,GAAOA,EAAIgxB,iBACtC,EAGJ,MAAMxsG,GAAQ,CACV,aAAcg7F,EACd,WAAYC,EACZ,YAAaH,EACb,YAAaC,GASjB,MAAM8R,GACF,WAAAn/L,CAAY8G,EAAMiC,GACdnO,KAAKkM,KAAOA,EACZlM,KAAKmO,KAAOA,CAChB,CACA,YAAO1K,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,mCACzB,MAAM2H,EAAO8F,EAAK,GAClB,IAAKupF,GAAMrvF,GACP,MAAM,IAAI5I,MAAM,eAAe4I,0CACnC,IAAc,eAATA,GAAkC,cAATA,IAAyC,IAAhB8F,EAAK/M,OACxD,OAAO2J,EAAQrK,MAAM,0BACzB,MAAMwL,EAAOwrF,GAAMrvF,GACb8lC,EAAS,GACf,IAAK,IAAI/4B,EAAI,EAAGA,EAAIjH,EAAK/M,OAAQgU,IAAK,CAClC,MAAMR,EAAQ7J,EAAQtH,MAAM0K,EAAKiH,GAAIA,EAAG09K,GACxC,IAAKl+K,EACD,OAAO,KACXu5B,EAAOvoC,KAAKgP,EAChB,CACA,OAAO,IAAI2vL,GAASr4L,EAAMiiC,EAC9B,CACA,QAAA61J,CAASpjL,GACL,OAAQ5gB,KAAKkM,KAAK67B,MACd,IAAK,UACD,OAAOs/I,QAAQrnL,KAAKmO,KAAK,GAAG61L,SAASpjL,IACzC,IAAK,QAAS,CACV,IAAIhM,EACAlU,EACJ,IAAK,MAAMwyK,KAAOlzK,KAAKmO,KAAM,CAGzB,GAFAyG,EAAQs+J,EAAI8wB,SAASpjL,GACrBlgB,EAAQ,KACJkU,aAAiB8E,GACjB,OAAO9E,EAEN,GAAqB,iBAAVA,EAAoB,CAChC,MAAMuiB,EAAIvW,EAAI4jL,WAAW5vL,GACzB,GAAIuiB,EACA,OAAOA,CACf,MACK,GAAI3tB,MAAM4E,QAAQwG,KAEflU,EADAkU,EAAMxT,OAAS,GAAKwT,EAAMxT,OAAS,EAC3B,sBAAsBoC,KAAKqC,UAAU+O,wEAGrC6uL,GAAa7uL,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,KAExDlU,GACD,OAAO,IAAIgZ,GAAM9E,EAAM,GAAK,IAAKA,EAAM,GAAK,IAAKA,EAAM,GAAK,IAAKA,EAAM,GAGnF,CACA,MAAM,IAAI8tL,GAAahiM,GAAS,qCAAsD,iBAAVkU,EAAqBA,EAAQpR,KAAKqC,UAAU+O,MAC5H,CACA,IAAK,UAAW,CACZ,IAAIA,EACJ,IAAK,MAAMs+J,KAAOlzK,KAAKmO,KAAM,CACzByG,EAAQs+J,EAAI8wB,SAASpjL,GACrB,MAAM6jL,EAAMhC,GAAQh/L,MAAMmR,GAC1B,GAAI6vL,EACA,OAAOA,CAEf,CACA,MAAM,IAAI/B,GAAa,uCAAwD,iBAAV9tL,EAAqBA,EAAQpR,KAAKqC,UAAU+O,MACrH,CACA,IAAK,iCAAkC,CACnC,IAAIA,EACJ,IAAK,MAAMs+J,KAAOlzK,KAAKmO,KAAM,CACzByG,EAAQs+J,EAAI8wB,SAASpjL,GACrB,MAAM8jL,EAAO7B,GAA+Bp/L,MAAMmR,GAClD,GAAI8vL,EACA,OAAOA,CAEf,CACA,MAAM,IAAIhC,GAAa,8DAA+E,iBAAV9tL,EAAqBA,EAAQpR,KAAKqC,UAAU+O,MAC5I,CACA,IAAK,SAAU,CACX,IAAI7N,EAAQ,KACZ,IAAK,MAAMmsK,KAAOlzK,KAAKmO,KAAM,CAEzB,GADApH,EAAQmsK,EAAI8wB,SAASpjL,GACP,OAAV7Z,EACA,OAAO,EACX,MAAM0mC,EAAMF,OAAOxmC,GACnB,IAAI2pC,MAAMjD,GAEV,OAAOA,CACX,CACA,MAAM,IAAIi1J,GAAa,qBAAqBl/L,KAAKqC,UAAUkB,gBAC/D,CACA,IAAK,YAGD,OAAOo7L,GAAUE,WAAWwB,GAAc7jM,KAAKmO,KAAK,GAAG61L,SAASpjL,KACpE,IAAK,gBACD,OAAO0iL,GAAcjB,WAAWwB,GAAc7jM,KAAKmO,KAAK,GAAG61L,SAASpjL,KACxE,IAAK,uBACD,OAAO5gB,KAAKmO,KAAK,GAAG61L,SAASpjL,GACjC,QACI,OAAOijL,GAAc7jM,KAAKmO,KAAK,GAAG61L,SAASpjL,IAEvD,CACA,SAAAqjL,CAAU5wJ,GACNrzC,KAAKmO,KAAKvE,QAAQypC,EACtB,CACA,aAAA6wJ,GACI,OAAOlkM,KAAKmO,KAAKopE,OAAM27F,GAAOA,EAAIgxB,iBACtC,EAGJ,MAAMS,GAAgB,CAAC,UAAW,QAAS,aAAc,WACzD,MAAMC,GACF,WAAAx/L,GACIpF,KAAK6kM,QAAU,KACf7kM,KAAK84B,QAAU,KACf94B,KAAK8kM,aAAe,KACpB9kM,KAAK+kM,iBAAmB,KACxB/kM,KAAKglM,iBAAmB,CAAC,EACzBhlM,KAAKilM,gBAAkB,KACvBjlM,KAAKklM,UAAY,IACrB,CACA,EAAAhhM,GACI,OAAOlE,KAAK84B,SAAW,OAAQ94B,KAAK84B,QAAU94B,KAAK84B,QAAQ50B,GAAK,IACpE,CACA,YAAAihM,GACI,OAAOnlM,KAAK84B,QAAuC,iBAAtB94B,KAAK84B,QAAQ5sB,KAAoBy4L,GAAc3kM,KAAK84B,QAAQ5sB,MAAQlM,KAAK84B,QAAQ5sB,KAAO,IACzH,CACA,QAAAyC,GACI,OAAO3O,KAAK84B,SAAW,aAAc94B,KAAK84B,QAAU94B,KAAK84B,QAAQnqB,SAAW,IAChF,CACA,WAAAy2L,GACI,OAAOplM,KAAKklM,SAChB,CACA,UAAAh0B,GACI,OAAOlxK,KAAK84B,SAAW94B,KAAK84B,QAAQo4I,YAAc,CAAC,CACvD,CACA,UAAAszB,CAAW5vL,GACP,IAAIywL,EAASrlM,KAAKglM,iBAAiBpwL,GAInC,OAHKywL,IACDA,EAASrlM,KAAKglM,iBAAiBpwL,GAAS8E,GAAMjW,MAAMmR,IAEjDywL,CACX,EAOJ,MAAMC,GACF,WAAAlgM,CAAYmgM,EAAUC,EAAgBp+I,EAAO,GAAI28I,EAAchkM,EAAQ,IAAIsyL,EAASvxH,EAAS,IACzF9gE,KAAKulM,SAAWA,EAChBvlM,KAAKonD,KAAOA,EACZpnD,KAAK8G,IAAMsgD,EAAKnhD,KAAImqB,GAAQ,IAAIA,OAAStqB,KAAK,IAC9C9F,KAAKD,MAAQA,EACbC,KAAK8gE,OAASA,EACd9gE,KAAK+jM,aAAeA,EACpB/jM,KAAKylM,YAAcD,CACvB,CAQA,KAAA/hM,CAAMiiM,EAAMz8L,EAAO86L,EAAczR,EAAU1yL,EAAU,CAAC,GAClD,OAAIqJ,EACOjJ,KAAKuwB,OAAOtnB,EAAO86L,EAAczR,GAAUqT,OAAOD,EAAM9lM,GAE5DI,KAAK2lM,OAAOD,EAAM9lM,EAC7B,CACA,MAAA+lM,CAAOD,EAAM9lM,GAIT,SAASgmM,EAASz3J,EAAQjiC,EAAM25L,GAC5B,MAAuB,WAAnBA,EACO,IAAIvB,GAAUp4L,EAAM,CAACiiC,IAEJ,WAAnB03J,EACE,IAAItB,GAASr4L,EAAM,CAACiiC,IAGpBA,CAEf,CACA,GAda,OAATu3J,GAAiC,iBAATA,GAAqC,kBAATA,GAAsC,iBAATA,IACjFA,EAAO,CAAC,UAAWA,IAanBl8L,MAAM4E,QAAQs3L,GAAO,CACrB,GAAoB,IAAhBA,EAAKtkM,OACL,OAAOpB,KAAKU,MAAM,oGAEtB,MAAMolM,EAAKJ,EAAK,GAChB,GAAkB,iBAAPI,EAEP,OADA9lM,KAAKU,MAAM,sDAAsDolM,oEAAsE,GAChI,KAEX,MAAMC,EAAO/lM,KAAKulM,SAASO,GAC3B,GAAIC,EAAM,CACN,IAAI53J,EAAS43J,EAAKtiM,MAAMiiM,EAAM1lM,MAC9B,IAAKmuC,EACD,OAAO,KACX,GAAInuC,KAAK+jM,aAAc,CACnB,MAAMtQ,EAAWzzL,KAAK+jM,aAChBiC,EAAS73J,EAAOjiC,KAStB,GAAuB,WAAlBunL,EAAS1rJ,MAAuC,WAAlB0rJ,EAAS1rJ,MAAuC,YAAlB0rJ,EAAS1rJ,MAAwC,WAAlB0rJ,EAAS1rJ,MAAuC,UAAlB0rJ,EAAS1rJ,MAAqC,UAAhBi+J,EAAOj+J,KAG9J,GAAuB,yBAAlB0rJ,EAAS1rJ,MAAqD,WAAhBi+J,EAAOj+J,MAAqC,UAAhBi+J,EAAOj+J,KAGtF,GAAuB,UAAlB0rJ,EAAS1rJ,MAAsC,cAAlB0rJ,EAAS1rJ,MAA0C,kBAAlB0rJ,EAAS1rJ,MAA8C,UAAhBi+J,EAAOj+J,MAAoC,WAAhBi+J,EAAOj+J,KAG5I,GAAsB,YAAlB0rJ,EAAS1rJ,MAAuC,UAAhBi+J,EAAOj+J,MAAoC,WAAhBi+J,EAAOj+J,MAAqC,UAAhBi+J,EAAOj+J,KAGlG,GAAsB,mCAAlB0rJ,EAAS1rJ,MAA8D,UAAhBi+J,EAAOj+J,MAAoC,UAAhBi+J,EAAOj+J,MAG7F,GAAI/nC,KAAKwzL,aAAaC,EAAUuS,GACjC,OAAO,UAHP73J,EAASy3J,EAASz3J,EAAQslJ,EAAU7zL,EAAQimM,gBAAkB,eAH9D13J,EAASy3J,EAASz3J,EAAQslJ,EAAU7zL,EAAQimM,gBAAkB,eAH9D13J,EAASy3J,EAASz3J,EAAQslJ,EAAU7zL,EAAQimM,gBAAkB,eAH9D13J,EAASy3J,EAASz3J,EAAQslJ,EAAU7zL,EAAQimM,gBAAkB,eAH9D13J,EAASy3J,EAASz3J,EAAQslJ,EAAU7zL,EAAQimM,gBAAkB,SAiBtE,CAKA,KAAM13J,aAAkB21J,KAAkC,kBAArB31J,EAAOjiC,KAAK67B,MAA6B/nC,KAAKylM,YAAYt3J,GAAS,CACpG,MAAM83J,EAAK,IAAIrB,GACf,IACIz2J,EAAS,IAAI21J,GAAQ31J,EAAOjiC,KAAMiiC,EAAO61J,SAASiC,GACtD,CACA,MAAOhkM,GAEH,OADAjC,KAAKU,MAAMuB,EAAEH,SACN,IACX,CACJ,CACA,OAAOqsC,CACX,CACA,OAAOnuC,KAAKU,MAAM,uBAAuBolM,6DAA+D,EAC5G,CACK,YAAoB,IAATJ,EACL1lM,KAAKU,MAAM,gDAEG,iBAATglM,EACL1lM,KAAKU,MAAM,yDAGXV,KAAKU,MAAM,uCAAuCglM,aAEjE,CASA,MAAAn1K,CAAOtnB,EAAO86L,EAAczR,GACxB,MAAMlrI,EAAwB,iBAAVn+C,EAAqBjJ,KAAKonD,KAAK72B,OAAOtnB,GAASjJ,KAAKonD,KAClErnD,EAAQuyL,EAAWtyL,KAAKD,MAAMwwB,OAAO+hK,GAAYtyL,KAAKD,MAC5D,OAAO,IAAIulM,GAAetlM,KAAKulM,SAAUvlM,KAAKylM,YAAar+I,EAAM28I,GAAgB,KAAMhkM,EAAOC,KAAK8gE,OACvG,CAQA,KAAApgE,CAAMA,KAAUS,GACZ,MAAM2F,EAAM,GAAG9G,KAAK8G,MAAM3F,EAAK8E,KAAIN,GAAK,IAAIA,OAAMG,KAAK,MACvD9F,KAAK8gE,OAAOl7D,KAAK,IAAIusL,EAAuBrrL,EAAKpG,GACrD,CAQA,YAAA8yL,CAAaC,EAAU1uH,GACnB,MAAMrkE,EAAQ8yL,GAAaC,EAAU1uH,GAGrC,OAFIrkE,GACAV,KAAKU,MAAMA,GACRA,CACX,EAGJ,MAAMwlM,GACF,WAAA9gM,CAAYktL,EAAUrnL,GAClBjL,KAAKkM,KAAOjB,EAAOiB,KACnBlM,KAAKsyL,SAAW,GAAG/hK,OAAO+hK,GAC1BtyL,KAAKiL,OAASA,CAClB,CACA,QAAA+4L,CAASpjL,GACL,OAAO5gB,KAAKiL,OAAO+4L,SAASpjL,EAChC,CACA,SAAAqjL,CAAU5wJ,GACN,IAAK,MAAM8yJ,KAAWnmM,KAAKsyL,SACvBj/I,EAAG8yJ,EAAQ,IAEf9yJ,EAAGrzC,KAAKiL,OACZ,CACA,YAAOxH,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,4CAA4CyN,EAAK/M,OAAS,cACnF,MAAMkxL,EAAW,GACjB,IAAK,IAAIl9K,EAAI,EAAGA,EAAIjH,EAAK/M,OAAS,EAAGgU,GAAK,EAAG,CACzC,MAAM/M,EAAO8F,EAAKiH,GAClB,GAAoB,iBAAT/M,EACP,OAAO0C,EAAQrK,MAAM,qCAAqC2H,aAAiB+M,GAE/E,GAAI,gBAAgBxB,KAAKvL,GACrB,OAAO0C,EAAQrK,MAAM,mEAAsE0U,GAE/F,MAAMrO,EAAQgE,EAAQtH,MAAM0K,EAAKiH,EAAI,GAAIA,EAAI,GAC7C,IAAKrO,EACD,OAAO,KACXurL,EAAS1sL,KAAK,CAACyC,EAAMtB,GACzB,CACA,MAAMkE,EAASF,EAAQtH,MAAM0K,EAAKA,EAAK/M,OAAS,GAAI+M,EAAK/M,OAAS,EAAG2J,EAAQg5L,aAAczR,GAC3F,OAAKrnL,EAEE,IAAIi7L,GAAI5T,EAAUrnL,GADd,IAEf,CACA,aAAAi5L,GACI,OAAOlkM,KAAKiL,OAAOi5L,eACvB,EAGJ,MAAMkC,GACF,WAAAhhM,CAAYiD,EAAMg+L,GACdrmM,KAAKkM,KAAOm6L,EAAgBn6L,KAC5BlM,KAAKqI,KAAOA,EACZrI,KAAKqmM,gBAAkBA,CAC3B,CACA,YAAO5iM,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,QAAmC,iBAAZ+M,EAAK,GACjC,OAAOpD,EAAQrK,MAAM,kEACzB,MAAM2H,EAAO8F,EAAK,GAClB,OAAKpD,EAAQhL,MAAM0wL,IAAIpoL,GAGhB,IAAI+9L,GAAI/9L,EAAM0C,EAAQhL,MAAMy2B,IAAInuB,IAF5B0C,EAAQrK,MAAM,qBAAqB2H,kBAAqBA,sEAA0E,EAGjJ,CACA,QAAA27L,CAASpjL,GACL,OAAO5gB,KAAKqmM,gBAAgBrC,SAASpjL,EACzC,CACA,SAAAqjL,GAAc,CACd,aAAAC,GACI,OAAO,CACX,EAGJ,MAAMoC,GACF,WAAAlhM,CAAY8G,EAAMjD,EAAO2L,GACrB5U,KAAKkM,KAAOA,EACZlM,KAAKiJ,MAAQA,EACbjJ,KAAK4U,MAAQA,CACjB,CACA,YAAOnR,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,mCAAmCyN,EAAK/M,OAAS,cAC1E,MAAM6H,EAAQ8B,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GAClC59K,EAAQ7J,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2mB,GAAM/pB,EAAQg5L,cAAgBjR,IACtE,IAAK7pL,IAAU2L,EACX,OAAO,KACX,MAAMmwD,EAAInwD,EAAM1I,KAChB,OAAO,IAAIo6L,GAAGvhI,EAAEquH,SAAUnqL,EAAO2L,EACrC,CACA,QAAAovL,CAASpjL,GACL,MAAM3X,EAAQjJ,KAAKiJ,MAAM+6L,SAASpjL,GAC5BkU,EAAQ90B,KAAK4U,MAAMovL,SAASpjL,GAClC,GAAI3X,EAAQ,EACR,MAAM,IAAIy5L,GAAa,8BAA8Bz5L,UAEzD,GAAIA,GAAS6rB,EAAM1zB,OACf,MAAM,IAAIshM,GAAa,8BAA8Bz5L,OAAW6rB,EAAM1zB,OAAS,MAEnF,GAAI6H,IAAUsuB,KAAKyR,MAAM//B,GACrB,MAAM,IAAIy5L,GAAa,6CAA6Cz5L,cAExE,OAAO6rB,EAAM7rB,EACjB,CACA,SAAAg7L,CAAU5wJ,GACNA,EAAGrzC,KAAKiJ,OACRoqC,EAAGrzC,KAAK4U,MACZ,CACA,aAAAsvL,GACI,OAAO,CACX,EAGJ,MAAMqC,GACF,WAAAnhM,CAAYohM,EAAQC,GAChBzmM,KAAKkM,KAAOwmL,EACZ1yL,KAAKwmM,OAASA,EACdxmM,KAAKymM,SAAWA,CACpB,CACA,YAAOhjM,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,mCAAmCyN,EAAK/M,OAAS,cAE1E,MAAMolM,EAASz7L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GACnC2T,EAAW17L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GAC3C,OAAK0T,GAAWC,EAEX9S,GAAY6S,EAAOt6L,KAAM,CAACwmL,EAAaD,EAAYD,EAAYD,EAAUO,IAGvE,IAAIyT,GAAGC,EAAQC,GAFX17L,EAAQrK,MAAM,oFAAoF4yL,GAAakT,EAAOt6L,iBAFtH,IAKf,CACA,QAAA83L,CAASpjL,GACL,MAAM4lL,EAASxmM,KAAKwmM,OAAOxC,SAASpjL,GAC9B6lL,EAAWzmM,KAAKymM,SAASzC,SAASpjL,GACxC,IAAK6lL,EACD,OAAO,EACX,IAAK3S,GAAkB0S,EAAQ,CAAC,UAAW,SAAU,SAAU,SAC3D,MAAM,IAAI9D,GAAa,oFAAoFpP,GAAasQ,GAAO4C,gBAEnI,IAAK1S,GAAkB2S,EAAU,CAAC,SAAU,UACxC,MAAM,IAAI/D,GAAa,qEAAqEpP,GAAasQ,GAAO6C,gBAEpH,OAAOA,EAAShtL,QAAQ+sL,IAAW,CACvC,CACA,SAAAvC,CAAU5wJ,GACNA,EAAGrzC,KAAKwmM,QACRnzJ,EAAGrzC,KAAKymM,SACZ,CACA,aAAAvC,GACI,OAAO,CACX,EAGJ,MAAMwC,GACF,WAAAthM,CAAYohM,EAAQC,EAAUE,GAC1B3mM,KAAKkM,KAAOsmL,EACZxyL,KAAKwmM,OAASA,EACdxmM,KAAKymM,SAAWA,EAChBzmM,KAAK2mM,UAAYA,CACrB,CACA,YAAOljM,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,QAAU,GAAK+M,EAAK/M,QAAU,EACnC,OAAO2J,EAAQrK,MAAM,wCAAwCyN,EAAK/M,OAAS,cAE/E,MAAMolM,EAASz7L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GACnC2T,EAAW17L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GAC3C,IAAK0T,IAAWC,EACZ,OAAO,KACX,IAAK9S,GAAY6S,EAAOt6L,KAAM,CAACwmL,EAAaD,EAAYD,EAAYD,EAAUO,IAC1E,OAAO/nL,EAAQrK,MAAM,oFAAoF4yL,GAAakT,EAAOt6L,iBAEjI,GAAoB,IAAhBiC,EAAK/M,OAAc,CACnB,MAAMulM,EAAY57L,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GAC5C,OAAKmU,EAEE,IAAID,GAAQF,EAAQC,EAAUE,GAD1B,IAEf,CAEI,OAAO,IAAID,GAAQF,EAAQC,EAEnC,CACA,QAAAzC,CAASpjL,GACL,MAAM4lL,EAASxmM,KAAKwmM,OAAOxC,SAASpjL,GAC9B6lL,EAAWzmM,KAAKymM,SAASzC,SAASpjL,GACxC,IAAKkzK,GAAkB0S,EAAQ,CAAC,UAAW,SAAU,SAAU,SAC3D,MAAM,IAAI9D,GAAa,oFAAoFpP,GAAasQ,GAAO4C,gBAEnI,IAAIG,EAIJ,GAHI3mM,KAAK2mM,YACLA,EAAY3mM,KAAK2mM,UAAU3C,SAASpjL,IAEpCkzK,GAAkB2S,EAAU,CAAC,WAAY,CACzC,MAAMG,EAAWH,EAAShtL,QAAQ+sL,EAAQG,GAC1C,OAAkB,IAAdC,GACQ,EAID,IAAIH,EAASx4L,MAAM,EAAG24L,IAAWxlM,MAEhD,CACK,GAAI0yL,GAAkB2S,EAAU,CAAC,UAClC,OAAOA,EAAShtL,QAAQ+sL,EAAQG,GAGhC,MAAM,IAAIjE,GAAa,qEAAqEpP,GAAasQ,GAAO6C,eAExH,CACA,SAAAxC,CAAU5wJ,GACNA,EAAGrzC,KAAKwmM,QACRnzJ,EAAGrzC,KAAKymM,UACJzmM,KAAK2mM,WACLtzJ,EAAGrzC,KAAK2mM,UAEhB,CACA,aAAAzC,GACI,OAAO,CACX,EAGJ,MAAM2C,GACF,WAAAzhM,CAAY0hM,EAAWC,EAAYnyL,EAAOoyL,EAAOC,EAASC,GACtDlnM,KAAK8mM,UAAYA,EACjB9mM,KAAKkM,KAAO66L,EACZ/mM,KAAK4U,MAAQA,EACb5U,KAAKgnM,MAAQA,EACbhnM,KAAKinM,QAAUA,EACfjnM,KAAKknM,UAAYA,CACrB,CACA,YAAOzjM,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,iDAAiDyN,EAAK/M,OAAS,MACxF,GAAI+M,EAAK/M,OAAS,GAAM,EACpB,OAAO2J,EAAQrK,MAAM,yCACzB,IAAIomM,EACAC,EACAh8L,EAAQg5L,cAA8C,UAA9Bh5L,EAAQg5L,aAAah8J,OAC7Cg/J,EAAah8L,EAAQg5L,cAEzB,MAAMiD,EAAQ,CAAC,EACTC,EAAU,GAChB,IAAK,IAAI7xL,EAAI,EAAGA,EAAIjH,EAAK/M,OAAS,EAAGgU,GAAK,EAAG,CACzC,IAAIqD,EAAStK,EAAKiH,GAClB,MAAMrO,EAAQoH,EAAKiH,EAAI,GAClB5L,MAAM4E,QAAQqK,KACfA,EAAS,CAACA,IAEd,MAAM0uL,EAAep8L,EAAQwlB,OAAOnb,GACpC,GAAsB,IAAlBqD,EAAOrX,OACP,OAAO+lM,EAAazmM,MAAM,uCAE9B,IAAK,MAAMwR,KAASuG,EAAQ,CACxB,GAAqB,iBAAVvG,GAAuC,iBAAVA,EACpC,OAAOi1L,EAAazmM,MAAM,6CAEzB,GAAqB,iBAAVwR,GAAsBqlB,KAAK2X,IAAIh9B,GAASq7B,OAAO65J,iBAC3D,OAAOD,EAAazmM,MAAM,iDAAiD6sC,OAAO65J,qBAEjF,GAAqB,iBAAVl1L,GAAsBqlB,KAAKyR,MAAM92B,KAAWA,EACxD,OAAOi1L,EAAazmM,MAAM,iDAEzB,GAAKomM,GAGL,GAAIK,EAAa3T,aAAasT,EAAWlD,GAAO1xL,IACjD,OAAO,UAHP40L,EAAYlD,GAAO1xL,GAKvB,QAAoC,IAAzB80L,EAAM9kI,OAAOhwD,IACpB,OAAOi1L,EAAazmM,MAAM,iCAE9BsmM,EAAM9kI,OAAOhwD,IAAU+0L,EAAQ7lM,MACnC,CACA,MAAM6J,EAASF,EAAQtH,MAAMsD,EAAOqO,EAAG2xL,GACvC,IAAK97L,EACD,OAAO,KACX87L,EAAaA,GAAc97L,EAAOiB,KAClC+6L,EAAQrhM,KAAKqF,EACjB,CACA,MAAM2J,EAAQ7J,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GACxC,IAAKl+K,EACD,OAAO,KACX,MAAMsyL,EAAYn8L,EAAQtH,MAAM0K,EAAKA,EAAK/M,OAAS,GAAI+M,EAAK/M,OAAS,EAAG2lM,GACxE,OAAKG,EAEmB,UAApBtyL,EAAM1I,KAAK67B,MAAoBh9B,EAAQwlB,OAAO,GAAGijK,aAAasT,EAAWlyL,EAAM1I,MACxE,KAEJ,IAAI26L,GAAMC,EAAWC,EAAYnyL,EAAOoyL,EAAOC,EAASC,GAJpD,IAKf,CACA,QAAAlD,CAASpjL,GACL,MAAMhM,EAAQ5U,KAAK4U,MAAMovL,SAASpjL,GAElC,OADgBgjL,GAAOhvL,KAAW5U,KAAK8mM,WAAa9mM,KAAKinM,QAAQjnM,KAAKgnM,MAAMpyL,KAAY5U,KAAKknM,WAC/ElD,SAASpjL,EAC3B,CACA,SAAAqjL,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,OACR5U,KAAKinM,QAAQr9L,QAAQypC,GACrBA,EAAGrzC,KAAKknM,UACZ,CACA,aAAAhD,GACI,OAAOlkM,KAAKinM,QAAQ1vH,OAAM8vH,GAAOA,EAAInD,mBAAoBlkM,KAAKknM,UAAUhD,eAC5E,EAGJ,MAAMoD,GACF,WAAAliM,CAAY8G,EAAMq7L,EAAUL,GACxBlnM,KAAKkM,KAAOA,EACZlM,KAAKunM,SAAWA,EAChBvnM,KAAKknM,UAAYA,CACrB,CACA,YAAOzjM,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,iDAAiDyN,EAAK/M,OAAS,MACxF,GAAI+M,EAAK/M,OAAS,GAAM,EACpB,OAAO2J,EAAQrK,MAAM,wCACzB,IAAIqmM,EACAh8L,EAAQg5L,cAA8C,UAA9Bh5L,EAAQg5L,aAAah8J,OAC7Cg/J,EAAah8L,EAAQg5L,cAEzB,MAAMwD,EAAW,GACjB,IAAK,IAAInyL,EAAI,EAAGA,EAAIjH,EAAK/M,OAAS,EAAGgU,GAAK,EAAG,CACzC,MAAMxB,EAAO7I,EAAQtH,MAAM0K,EAAKiH,GAAIA,EAAGs9K,GACvC,IAAK9+K,EACD,OAAO,KACX,MAAM3I,EAASF,EAAQtH,MAAM0K,EAAKiH,EAAI,GAAIA,EAAI,EAAG2xL,GACjD,IAAK97L,EACD,OAAO,KACXs8L,EAAS3hM,KAAK,CAACgO,EAAM3I,IACrB87L,EAAaA,GAAc97L,EAAOiB,IACtC,CACA,MAAMg7L,EAAYn8L,EAAQtH,MAAM0K,EAAKA,EAAK/M,OAAS,GAAI+M,EAAK/M,OAAS,EAAG2lM,GACxE,IAAKG,EACD,OAAO,KACX,IAAKH,EACD,MAAM,IAAItnM,MAAM,2BACpB,OAAO,IAAI6nM,GAAKP,EAAYQ,EAAUL,EAC1C,CACA,QAAAlD,CAASpjL,GACL,IAAK,MAAOhN,EAAMq7K,KAAejvL,KAAKunM,SAClC,GAAI3zL,EAAKowL,SAASpjL,GACd,OAAOquK,EAAW+U,SAASpjL,GAGnC,OAAO5gB,KAAKknM,UAAUlD,SAASpjL,EACnC,CACA,SAAAqjL,CAAU5wJ,GACN,IAAK,MAAOz/B,EAAMq7K,KAAejvL,KAAKunM,SAClCl0J,EAAGz/B,GACHy/B,EAAG47I,GAEP57I,EAAGrzC,KAAKknM,UACZ,CACA,aAAAhD,GACI,OAAOlkM,KAAKunM,SAAShwH,OAAM,EAAE5jC,EAAG0zJ,KAASA,EAAInD,mBAAoBlkM,KAAKknM,UAAUhD,eACpF,EAGJ,MAAMsD,GACF,WAAApiM,CAAY8G,EAAM0I,EAAO6yL,EAAYC,GACjC1nM,KAAKkM,KAAOA,EACZlM,KAAK4U,MAAQA,EACb5U,KAAKynM,WAAaA,EAClBznM,KAAK0nM,SAAWA,CACpB,CACA,YAAOjkM,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,QAAU,GAAK+M,EAAK/M,QAAU,EACnC,OAAO2J,EAAQrK,MAAM,wCAAwCyN,EAAK/M,OAAS,cAE/E,MAAMwT,EAAQ7J,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GAClC2U,EAAa18L,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GAC7C,IAAK59K,IAAU6yL,EACX,OAAO,KACX,IAAK9T,GAAY/+K,EAAM1I,KAAM,CAAC4oB,GAAMg+J,GAAYL,EAAYK,IACxD,OAAO/nL,EAAQrK,MAAM,oEAAoE4yL,GAAa1+K,EAAM1I,iBAEhH,GAAoB,IAAhBiC,EAAK/M,OAAc,CACnB,MAAMsmM,EAAW38L,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GAC3C,OAAKkV,EAEE,IAAIF,GAAM5yL,EAAM1I,KAAM0I,EAAO6yL,EAAYC,GADrC,IAEf,CAEI,OAAO,IAAIF,GAAM5yL,EAAM1I,KAAM0I,EAAO6yL,EAE5C,CACA,QAAAzD,CAASpjL,GACL,MAAMhM,EAAQ5U,KAAK4U,MAAMovL,SAASpjL,GAC5B6mL,EAAaznM,KAAKynM,WAAWzD,SAASpjL,GAC5C,IAAI8mL,EAIJ,GAHI1nM,KAAK0nM,WACLA,EAAW1nM,KAAK0nM,SAAS1D,SAASpjL,IAElCkzK,GAAkBl/K,EAAO,CAAC,WAE1B,MAAO,IAAIA,GAAO3G,MAAMw5L,EAAYC,GAAU5hM,KAAK,IAElD,GAAIguL,GAAkBl/K,EAAO,CAAC,UAC/B,OAAOA,EAAM3G,MAAMw5L,EAAYC,GAG/B,MAAM,IAAIhF,GAAa,oEAAoEpP,GAAasQ,GAAOhvL,eAEvH,CACA,SAAAqvL,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,OACRy+B,EAAGrzC,KAAKynM,YACJznM,KAAK0nM,UACLr0J,EAAGrzC,KAAK0nM,SAEhB,CACA,aAAAxD,GACI,OAAO,CACX,EAOJ,SAASyD,GAA0BttL,EAAOzF,GACtC,MAAMg6D,EAAYv0D,EAAMjZ,OAAS,EACjC,IAGIwmM,EAAcC,EAHdC,EAAa,EACbC,EAAan5H,EACbo5H,EAAe,EAEnB,KAAOF,GAAcC,GAIjB,GAHAC,EAAezwK,KAAKyR,OAAO8+J,EAAaC,GAAc,GACtDH,EAAevtL,EAAM2tL,GACrBH,EAAYxtL,EAAM2tL,EAAe,GAC7BJ,GAAgBhzL,EAAO,CACvB,GAAIozL,IAAiBp5H,GAAah6D,EAAQizL,EACtC,OAAOG,EAEXF,EAAaE,EAAe,CAChC,KACK,MAAIJ,EAAehzL,GAIpB,MAAM,IAAI8tL,GAAa,0BAHvBqF,EAAaC,EAAe,CAIhC,CAEJ,OAAO,CACX,CAEA,MAAMC,GACF,WAAA7iM,CAAY8G,EAAM0I,EAAOyF,GACrBra,KAAKkM,KAAOA,EACZlM,KAAK4U,MAAQA,EACb5U,KAAKyY,OAAS,GACdzY,KAAKinM,QAAU,GACf,IAAK,MAAO/0L,EAAO+8K,KAAe50K,EAC9Bra,KAAKyY,OAAO7S,KAAKsM,GACjBlS,KAAKinM,QAAQrhM,KAAKqpL,EAE1B,CACA,YAAOxrL,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EAAI,EAClB,OAAO2J,EAAQrK,MAAM,iDAAiDyN,EAAK/M,OAAS,MAExF,IAAK+M,EAAK/M,OAAS,GAAK,GAAM,EAC1B,OAAO2J,EAAQrK,MAAM,yCAEzB,MAAMkU,EAAQ7J,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GACxC,IAAK59K,EACD,OAAO,KACX,MAAMyF,EAAQ,GACd,IAAI0sL,EAAa,KACbh8L,EAAQg5L,cAA8C,UAA9Bh5L,EAAQg5L,aAAah8J,OAC7Cg/J,EAAah8L,EAAQg5L,cAEzB,IAAK,IAAI3uL,EAAI,EAAGA,EAAIjH,EAAK/M,OAAQgU,GAAK,EAAG,CACrC,MAAMlD,EAAc,IAANkD,GAAWkkC,IAAWnrC,EAAKiH,GACnCrO,EAAQoH,EAAKiH,EAAI,GACjB8yL,EAAW9yL,EACX+yL,EAAW/yL,EAAI,EACrB,GAAqB,iBAAVlD,EACP,OAAOnH,EAAQrK,MAAM,0IAA2IwnM,GAEpK,GAAI7tL,EAAMjZ,QAAUiZ,EAAMA,EAAMjZ,OAAS,GAAG,IAAM8Q,EAC9C,OAAOnH,EAAQrK,MAAM,4GAA6GwnM,GAEtI,MAAM/5J,EAASpjC,EAAQtH,MAAMsD,EAAOohM,EAAUpB,GAC9C,IAAK54J,EACD,OAAO,KACX44J,EAAaA,GAAc54J,EAAOjiC,KAClCmO,EAAMzU,KAAK,CAACsM,EAAOi8B,GACvB,CACA,OAAO,IAAI85J,GAAKlB,EAAYnyL,EAAOyF,EACvC,CACA,QAAA2pL,CAASpjL,GACL,MAAMnI,EAASzY,KAAKyY,OACdwuL,EAAUjnM,KAAKinM,QACrB,GAAsB,IAAlBxuL,EAAOrX,OACP,OAAO6lM,EAAQ,GAAGjD,SAASpjL,GAE/B,MAAM7Z,EAAQ/G,KAAK4U,MAAMovL,SAASpjL,GAClC,GAAI7Z,GAAS0R,EAAO,GAChB,OAAOwuL,EAAQ,GAAGjD,SAASpjL,GAE/B,MAAMwnL,EAAY3vL,EAAOrX,OACzB,GAAI2F,GAAS0R,EAAO2vL,EAAY,GAC5B,OAAOnB,EAAQmB,EAAY,GAAGpE,SAASpjL,GAG3C,OAAOqmL,EADOU,GAA0BlvL,EAAQ1R,IAC1Bi9L,SAASpjL,EACnC,CACA,SAAAqjL,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,OACR,IAAK,MAAMq6K,KAAcjvL,KAAKinM,QAC1B5zJ,EAAG47I,EAEX,CACA,aAAAiV,GACI,OAAOlkM,KAAKinM,QAAQ1vH,OAAM8vH,GAAOA,EAAInD,iBACzC,EAGJ,SAASmE,GAAyB/iM,GACjC,OAAOA,GAAKA,EAAE0lL,YAAc9pL,OAAOiE,UAAUuF,eAAevL,KAAKmG,EAAG,WAAaA,EAAW,QAAIA,CACjG,CAEA,IAAIgjM,GACAC,GAqFJ,IAAIC,GAnFJ,WACC,GAAID,GAAuB,OAAOD,GAKlC,SAASG,EAAWC,EAAKC,EAAKC,EAAKC,GAE/B7oM,KAAK8oM,GAAK,EAAMJ,EAChB1oM,KAAK+oM,GAAK,GAAOH,EAAMF,GAAO1oM,KAAK8oM,GACnC9oM,KAAKgpM,GAAK,EAAMhpM,KAAK8oM,GAAK9oM,KAAK+oM,GAE/B/oM,KAAKipM,GAAK,EAAMN,EAChB3oM,KAAKkpM,GAAK,GAAOL,EAAMF,GAAO3oM,KAAKipM,GACnCjpM,KAAKmpM,GAAK,EAAMnpM,KAAKipM,GAAKjpM,KAAKkpM,GAE/BlpM,KAAK0oM,IAAMA,EACX1oM,KAAK2oM,IAAMA,EACX3oM,KAAK4oM,IAAMA,EACX5oM,KAAK6oM,IAAMA,CACf,CA4DA,OA9EAN,GAAwB,EAExBD,GAAaG,EAkBbA,EAAWtjM,UAAY,CACnBikM,aAAc,SAAUrkI,GAEpB,QAAS/kE,KAAKgpM,GAAKjkI,EAAI/kE,KAAK+oM,IAAMhkI,EAAI/kE,KAAK8oM,IAAM/jI,CACrD,EAEAskI,aAAc,SAAUtkI,GACpB,QAAS/kE,KAAKmpM,GAAKpkI,EAAI/kE,KAAKkpM,IAAMnkI,EAAI/kE,KAAKipM,IAAMlkI,CACrD,EAEAukI,uBAAwB,SAAUvkI,GAC9B,OAAQ,EAAM/kE,KAAKgpM,GAAKjkI,EAAI,EAAM/kE,KAAK+oM,IAAMhkI,EAAI/kE,KAAK8oM,EAC1D,EAEAS,YAAa,SAAUjkM,EAAG47G,GAGtB,QAFgB/gG,IAAZ+gG,IAAuBA,EAAU,MAEjC57G,EAAI,EAAK,OAAO,EACpB,GAAIA,EAAI,EAAK,OAAO,EAKpB,IAHA,IAAIy/D,EAAIz/D,EAGC8P,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIo0L,EAAKxpM,KAAKopM,aAAarkI,GAAKz/D,EAChC,GAAIiyB,KAAK2X,IAAIs6J,GAAMtoF,EAAS,OAAOn8C,EAEnC,IAAI0kI,EAAKzpM,KAAKspM,uBAAuBvkI,GACrC,GAAIxtC,KAAK2X,IAAIu6J,GAAM,KAAM,MAEzB1kI,GAAQykI,EAAKC,CACjB,CAGA,IAAItV,EAAK,EACLC,EAAK,EAGT,IAFArvH,EAAIz/D,EAEC8P,EAAI,EAAGA,EAAI,KACZo0L,EAAKxpM,KAAKopM,aAAarkI,KACnBxtC,KAAK2X,IAAIs6J,EAAKlkM,GAAK47G,IAFP9rG,IAIZ9P,EAAIkkM,EACJrV,EAAKpvH,EAELqvH,EAAKrvH,EAGTA,EAAgB,IAAXqvH,EAAKD,GAAYA,EAG1B,OAAOpvH,CACX,EAEA2kI,MAAO,SAAUpkM,EAAG47G,GAChB,OAAOlhH,KAAKqpM,aAAarpM,KAAKupM,YAAYjkM,EAAG47G,GACjD,GAEGonF,EACR,CAEwBqB,GACpBlB,GAA0BJ,GAAwBG,IAEtD,MAAMoB,GACF,WAAAxkM,CAAY8G,EAAM8tK,EAAU6vB,EAAej1L,EAAOyF,GAC9Cra,KAAKkM,KAAOA,EACZlM,KAAKg6K,SAAWA,EAChBh6K,KAAK6pM,cAAgBA,EACrB7pM,KAAK4U,MAAQA,EACb5U,KAAKyY,OAAS,GACdzY,KAAKinM,QAAU,GACf,IAAK,MAAO/0L,EAAO+8K,KAAe50K,EAC9Bra,KAAKyY,OAAO7S,KAAKsM,GACjBlS,KAAKinM,QAAQrhM,KAAKqpL,EAE1B,CACA,0BAAO6a,CAAoBD,EAAej1L,EAAOm1L,EAAOC,GACpD,IAAIjlI,EAAI,EACR,GAA2B,gBAAvB8kI,EAAcxhM,KACd08D,EAAIklI,GAAyBr1L,EAAOi1L,EAAcp5J,KAAMs5J,EAAOC,QAE9D,GAA2B,WAAvBH,EAAcxhM,KACnB08D,EAAIklI,GAAyBr1L,EAAO,EAAGm1L,EAAOC,QAE7C,GAA2B,iBAAvBH,EAAcxhM,KAAyB,CAC5C,MAAM8uB,EAAI0yK,EAAcK,cAExBnlI,EADW,IAAI0jI,GAAWtxK,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IACvCuyK,MAAMO,GAAyBr1L,EAAO,EAAGm1L,EAAOC,GAC3D,CACA,OAAOjlI,CACX,CACA,YAAOthE,CAAM0K,EAAMpD,GACf,IAAKivK,EAAU6vB,EAAej1L,KAAUu1L,GAAQh8L,EAChD,IAAK3E,MAAM4E,QAAQy7L,IAA2C,IAAzBA,EAAczoM,OAC/C,OAAO2J,EAAQrK,MAAM,6CAA8C,GAEvE,GAAyB,WAArBmpM,EAAc,GACdA,EAAgB,CAAExhM,KAAM,eAEvB,GAAyB,gBAArBwhM,EAAc,GAAsB,CACzC,MAAMp5J,EAAOo5J,EAAc,GAC3B,GAAoB,iBAATp5J,EACP,OAAO1lC,EAAQrK,MAAM,qDAAsD,EAAG,GAClFmpM,EAAgB,CACZxhM,KAAM,cACNooC,OAER,KACK,IAAyB,iBAArBo5J,EAAc,GAYnB,OAAO9+L,EAAQrK,MAAM,8BAA8BwhE,OAAO2nI,EAAc,MAAO,EAAG,GAZxC,CAC1C,MAAMK,EAAgBL,EAAc57L,MAAM,GAC1C,GAA6B,IAAzBi8L,EAAc9oM,QACd8oM,EAAc3mJ,MAAKwhB,GAAkB,iBAANA,GAAkBA,EAAI,GAAKA,EAAI,IAC9D,OAAOh6D,EAAQrK,MAAM,0FAA2F,GAEpHmpM,EAAgB,CACZxhM,KAAM,eACN6hM,cAAeA,EAEvB,CAGA,CACA,GAAI/7L,EAAK/M,OAAS,EAAI,EAClB,OAAO2J,EAAQrK,MAAM,iDAAiDyN,EAAK/M,OAAS,MAExF,IAAK+M,EAAK/M,OAAS,GAAK,GAAM,EAC1B,OAAO2J,EAAQrK,MAAM,yCAGzB,GADAkU,EAAQ7J,EAAQtH,MAAMmR,EAAO,EAAG49K,IAC3B59K,EACD,OAAO,KACX,MAAMyF,EAAQ,GACd,IAAI0sL,EAAa,KACA,oBAAb/sB,GAA+C,oBAAbA,EAClC+sB,EAAapU,EAER5nL,EAAQg5L,cAA8C,UAA9Bh5L,EAAQg5L,aAAah8J,OAClDg/J,EAAah8L,EAAQg5L,cAEzB,IAAK,IAAI3uL,EAAI,EAAGA,EAAI+0L,EAAK/oM,OAAQgU,GAAK,EAAG,CACrC,MAAMlD,EAAQi4L,EAAK/0L,GACbrO,EAAQojM,EAAK/0L,EAAI,GACjB8yL,EAAW9yL,EAAI,EACf+yL,EAAW/yL,EAAI,EACrB,GAAqB,iBAAVlD,EACP,OAAOnH,EAAQrK,MAAM,iJAAkJwnM,GAE3K,GAAI7tL,EAAMjZ,QAAUiZ,EAAMA,EAAMjZ,OAAS,GAAG,IAAM8Q,EAC9C,OAAOnH,EAAQrK,MAAM,mHAAoHwnM,GAE7I,MAAM/5J,EAASpjC,EAAQtH,MAAMsD,EAAOohM,EAAUpB,GAC9C,IAAK54J,EACD,OAAO,KACX44J,EAAaA,GAAc54J,EAAOjiC,KAClCmO,EAAMzU,KAAK,CAACsM,EAAOi8B,GACvB,CACA,OAAK4lJ,GAAWgT,EAAYvU,IACvBuB,GAAWgT,EAAYnU,IACvBmB,GAAWgT,EAAYpU,IACvBoB,GAAWgT,EAAY9T,IACvBc,GAAWgT,EAAY5T,KACvBY,GAAWgT,EAAYjyK,GAAM09J,IAG3B,IAAIoX,GAAY7C,EAAY/sB,EAAU6vB,EAAej1L,EAAOyF,GAFxDtP,EAAQrK,MAAM,QAAQ4yL,GAAayT,4BAGlD,CACA,QAAA/C,CAASpjL,GACL,MAAMnI,EAASzY,KAAKyY,OACdwuL,EAAUjnM,KAAKinM,QACrB,GAAsB,IAAlBxuL,EAAOrX,OACP,OAAO6lM,EAAQ,GAAGjD,SAASpjL,GAE/B,MAAM7Z,EAAQ/G,KAAK4U,MAAMovL,SAASpjL,GAClC,GAAI7Z,GAAS0R,EAAO,GAChB,OAAOwuL,EAAQ,GAAGjD,SAASpjL,GAE/B,MAAMwnL,EAAY3vL,EAAOrX,OACzB,GAAI2F,GAAS0R,EAAO2vL,EAAY,GAC5B,OAAOnB,EAAQmB,EAAY,GAAGpE,SAASpjL,GAE3C,MAAM3X,EAAQ0+L,GAA0BlvL,EAAQ1R,GAC1CgjM,EAAQtxL,EAAOxP,GACf+gM,EAAQvxL,EAAOxP,EAAQ,GACvB87D,EAAI6kI,GAAYE,oBAAoB9pM,KAAK6pM,cAAe9iM,EAAOgjM,EAAOC,GACtEI,EAAcnD,EAAQh+L,GAAO+6L,SAASpjL,GACtCypL,EAAcpD,EAAQh+L,EAAQ,GAAG+6L,SAASpjL,GAChD,OAAQ5gB,KAAKg6K,UACT,IAAK,cACD,OAAQh6K,KAAKkM,KAAK67B,MACd,IAAK,SACD,OAAOw3J,GAAkB6K,EAAaC,EAAatlI,GACvD,IAAK,QACD,OAAOrrD,GAAMyvE,YAAYihH,EAAaC,EAAatlI,GACvD,IAAK,UACD,OAAO09H,GAAQt5G,YAAYihH,EAAaC,EAAatlI,GACzD,IAAK,iCACD,OAAO89H,GAA+B15G,YAAYihH,EAAaC,EAAatlI,GAChF,IAAK,QACD,OAAOy6H,GAAiB4K,EAAaC,EAAatlI,GACtD,IAAK,uBACD,OAAOy+H,GAAqBr6G,YAAYihH,EAAaC,EAAatlI,GAE9E,IAAK,kBACD,OAAOrrD,GAAMyvE,YAAYihH,EAAaC,EAAatlI,EAAG,OAC1D,IAAK,kBACD,OAAOrrD,GAAMyvE,YAAYihH,EAAaC,EAAatlI,EAAG,OAElE,CACA,SAAAk/H,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,OACR,IAAK,MAAMq6K,KAAcjvL,KAAKinM,QAC1B5zJ,EAAG47I,EAEX,CACA,aAAAiV,GACI,OAAOlkM,KAAKinM,QAAQ1vH,OAAM8vH,GAAOA,EAAInD,iBACzC,EAqCJ,SAAS+F,GAAyBr1L,EAAO67B,EAAM65J,EAAYC,GACvD,MAAMC,EAAaD,EAAaD,EAC1BG,EAAW71L,EAAQ01L,EACzB,OAAmB,IAAfE,EACO,EAEO,IAAT/5J,EACEg6J,EAAWD,GAGVjzK,KAAK8X,IAAIoB,EAAMg6J,GAAY,IAAMlzK,KAAK8X,IAAIoB,EAAM+5J,GAAc,EAE9E,CAEW9wL,GAAMyvE,YAEJs5G,GAAQt5G,YACe05G,GAA+B15G,YAInE,MAAMuhH,GACF,WAAAtlM,CAAY8G,EAAMiC,GACdnO,KAAKkM,KAAOA,EACZlM,KAAKmO,KAAOA,CAChB,CACA,YAAO1K,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,mCAEzB,IAAIqmM,EAAa,KACjB,MAAMhD,EAAeh5L,EAAQg5L,aACzBA,GAAsC,UAAtBA,EAAah8J,OAC7Bg/J,EAAahD,GAEjB,MAAM4G,EAAa,GACnB,IAAK,MAAMz3B,KAAO/kK,EAAKF,MAAM,GAAI,CAC7B,MAAMkgC,EAASpjC,EAAQtH,MAAMyvK,EAAK,EAAIy3B,EAAWvpM,OAAQ2lM,OAAY5mL,EAAW,CAAE0lL,eAAgB,SAClG,IAAK13J,EACD,OAAO,KACX44J,EAAaA,GAAc54J,EAAOjiC,KAClCy+L,EAAW/kM,KAAKuoC,EACpB,CACA,IAAK44J,EACD,MAAM,IAAItnM,MAAM,kBAMpB,MAAMmrM,EAAkB7G,GACpB4G,EAAWpnJ,MAAK2vH,GAAOsgB,GAAauQ,EAAc7wB,EAAIhnK,QAC1D,OACI,IAAIw+L,GADDE,EACU9X,EACAiU,EADW4D,EAEhC,CACA,QAAA3G,CAASpjL,GACL,IAEIiqL,EAFA5/L,EAAS,KACT6/L,EAAW,EAEf,IAAK,MAAM53B,KAAOlzK,KAAKmO,KAcnB,GAbA28L,IACA7/L,EAASioK,EAAI8wB,SAASpjL,GAGlB3V,GAAUA,aAAkBq4L,KAAkBr4L,EAAOs4L,YAChDsH,IACDA,EAAqB5/L,EAAO5C,MAEhC4C,EAAS,KACL6/L,IAAa9qM,KAAKmO,KAAK/M,SACvB6J,EAAS4/L,IAGF,OAAX5/L,EACA,MAER,OAAOA,CACX,CACA,SAAAg5L,CAAU5wJ,GACNrzC,KAAKmO,KAAKvE,QAAQypC,EACtB,CACA,aAAA6wJ,GACI,OAAOlkM,KAAKmO,KAAKopE,OAAM27F,GAAOA,EAAIgxB,iBACtC,EAGJ,SAAS6G,GAAiBjF,EAAI55L,GAC1B,MAAW,OAAP45L,GAAsB,OAAPA,EAEM,YAAd55L,EAAK67B,MACM,WAAd77B,EAAK67B,MACS,WAAd77B,EAAK67B,MACS,SAAd77B,EAAK67B,MACS,UAAd77B,EAAK67B,KAIY,WAAd77B,EAAK67B,MACM,WAAd77B,EAAK67B,MACS,UAAd77B,EAAK67B,IAEjB,CAOA,SAASijK,GAAUpqL,EAAKrG,EAAGC,EAAG2c,GAAK,OAA2B,IAApBA,EAAEsqK,QAAQlnL,EAAGC,EAAU,CAuBjE,SAASywL,GAAenF,EAAIoF,EAAcC,GACtC,MAAMC,EAA2B,OAAPtF,GAAsB,OAAPA,EACzC,OAAO,MAAMuF,EACT,WAAAjmM,CAAYs8L,EAAKC,EAAKL,GAClBthM,KAAKkM,KAAOwmL,EACZ1yL,KAAK0hM,IAAMA,EACX1hM,KAAK2hM,IAAMA,EACX3hM,KAAKshM,SAAWA,EAChBthM,KAAKsrM,mBAAuC,UAAlB5J,EAAIx1L,KAAK67B,MAAsC,UAAlB45J,EAAIz1L,KAAK67B,IACpE,CACA,YAAOtkC,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,QAAgC,IAAhB+M,EAAK/M,OAC1B,OAAO2J,EAAQrK,MAAM,oCACzB,MAAMolM,EAAK33L,EAAK,GAChB,IAAIuzL,EAAM32L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GACpC,IAAK4O,EACD,OAAO,KACX,IAAKqJ,GAAiBjF,EAAIpE,EAAIx1L,MAC1B,OAAOnB,EAAQwlB,OAAO,GAAG7vB,MAAM,IAAIolM,8CAA+CxS,GAAaoO,EAAIx1L,WAEvG,IAAIy1L,EAAM52L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG2kL,GACpC,IAAK6O,EACD,OAAO,KACX,IAAKoJ,GAAiBjF,EAAInE,EAAIz1L,MAC1B,OAAOnB,EAAQwlB,OAAO,GAAG7vB,MAAM,IAAIolM,8CAA+CxS,GAAaqO,EAAIz1L,WAEvG,GAAIw1L,EAAIx1L,KAAK67B,OAAS45J,EAAIz1L,KAAK67B,MACT,UAAlB25J,EAAIx1L,KAAK67B,MACS,UAAlB45J,EAAIz1L,KAAK67B,KACT,OAAOh9B,EAAQrK,MAAM,yBAAyB4yL,GAAaoO,EAAIx1L,eAAeonL,GAAaqO,EAAIz1L,WAE/Fk/L,IAEsB,UAAlB1J,EAAIx1L,KAAK67B,MAAsC,UAAlB45J,EAAIz1L,KAAK67B,KAEtC25J,EAAM,IAAI4C,GAAU3C,EAAIz1L,KAAM,CAACw1L,IAER,UAAlBA,EAAIx1L,KAAK67B,MAAsC,UAAlB45J,EAAIz1L,KAAK67B,OAE3C45J,EAAM,IAAI2C,GAAU5C,EAAIx1L,KAAM,CAACy1L,MAGvC,IAAIL,EAAW,KACf,GAAoB,IAAhBnzL,EAAK/M,OAAc,CACnB,GAAsB,WAAlBsgM,EAAIx1L,KAAK67B,MACS,WAAlB45J,EAAIz1L,KAAK67B,MACS,UAAlB25J,EAAIx1L,KAAK67B,MACS,UAAlB45J,EAAIz1L,KAAK67B,KACT,OAAOh9B,EAAQrK,MAAM,oDAGzB,GADA4gM,EAAWv2L,EAAQtH,MAAM0K,EAAK,GAAI,EAAG4kL,IAChCuO,EACD,OAAO,IACf,CACA,OAAO,IAAI+J,EAAW3J,EAAKC,EAAKL,EACpC,CACA,QAAA0C,CAASpjL,GACL,MAAM8gL,EAAM1hM,KAAK0hM,IAAIsC,SAASpjL,GACxB+gL,EAAM3hM,KAAK2hM,IAAIqC,SAASpjL,GAC9B,GAAIwqL,GAAqBprM,KAAKsrM,mBAAoB,CAC9C,MAAMhpG,EAAKshG,GAAOlC,GACZ6J,EAAK3H,GAAOjC,GAElB,GAAIr/F,EAAGv6D,OAASwjK,EAAGxjK,MAAsB,WAAZu6D,EAAGv6D,MAAiC,WAAZu6D,EAAGv6D,KACpD,MAAM,IAAI26J,GAAa,2BAA2BoD,6DAA8DxjG,EAAGv6D,SAASwjK,EAAGxjK,iBAEvI,CACA,GAAI/nC,KAAKshM,WAAa8J,GAAqBprM,KAAKsrM,mBAAoB,CAChE,MAAMhpG,EAAKshG,GAAOlC,GACZ6J,EAAK3H,GAAOjC,GAClB,GAAgB,WAAZr/F,EAAGv6D,MAAiC,WAAZwjK,EAAGxjK,KAC3B,OAAOmjK,EAAatqL,EAAK8gL,EAAKC,EAEtC,CACA,OAAO3hM,KAAKshM,SACR6J,EAAoBvqL,EAAK8gL,EAAKC,EAAK3hM,KAAKshM,SAAS0C,SAASpjL,IAC1DsqL,EAAatqL,EAAK8gL,EAAKC,EAC/B,CACA,SAAAsC,CAAU5wJ,GACNA,EAAGrzC,KAAK0hM,KACRruJ,EAAGrzC,KAAK2hM,KACJ3hM,KAAKshM,UACLjuJ,EAAGrzC,KAAKshM,SAEhB,CACA,aAAA4C,GACI,OAAO,CACX,EAER,CACA,MAAMsH,GAASP,GAAe,MAvH9B,SAAYrqL,EAAKrG,EAAGC,GAAK,OAAOD,IAAMC,CAAG,GAuHDwwL,IAClCS,GAAYR,GAAe,MAvHjC,SAAarqL,EAAKrG,EAAGC,GAAK,OAAOD,IAAMC,CAAG,IAM1C,SAAoBoG,EAAKrG,EAAGC,EAAG2c,GAAK,OAAQ6zK,GAAUpqL,EAAKrG,EAAGC,EAAG2c,EAAI,IAkH/Du0K,GAAWT,GAAe,KAvHhC,SAAYrqL,EAAKrG,EAAGC,GAAK,OAAOD,EAAIC,CAAG,IAMvC,SAAmBoG,EAAKrG,EAAGC,EAAG2c,GAAK,OAAOA,EAAEsqK,QAAQlnL,EAAGC,GAAK,CAAG,IAkHzDmxL,GAAcV,GAAe,KAvHnC,SAAYrqL,EAAKrG,EAAGC,GAAK,OAAOD,EAAIC,CAAG,IAMvC,SAAmBoG,EAAKrG,EAAGC,EAAG2c,GAAK,OAAOA,EAAEsqK,QAAQlnL,EAAGC,GAAK,CAAG,IAkHzDoxL,GAAkBX,GAAe,MAvHvC,SAAcrqL,EAAKrG,EAAGC,GAAK,OAAOD,GAAKC,CAAG,IAM1C,SAAqBoG,EAAKrG,EAAGC,EAAG2c,GAAK,OAAOA,EAAEsqK,QAAQlnL,EAAGC,IAAM,CAAG,IAkH5DqxL,GAAqBZ,GAAe,MAvH1C,SAAcrqL,EAAKrG,EAAGC,GAAK,OAAOD,GAAKC,CAAG,IAM1C,SAAqBoG,EAAKrG,EAAGC,EAAG2c,GAAK,OAAOA,EAAEsqK,QAAQlnL,EAAGC,IAAM,CAAG,IAmHlE,MAAMsxL,GACF,WAAA1mM,CAAY87L,EAAeC,EAAoBC,GAC3CphM,KAAKkM,KAAO6mL,EACZ/yL,KAAKohM,OAASA,EACdphM,KAAKkhM,cAAgBA,EACrBlhM,KAAKmhM,mBAAqBA,CAC9B,CACA,YAAO19L,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,0BACzB,MAAMd,EAAUuO,EAAK,GACrB,GAAuB,iBAAZvO,GAAwB4J,MAAM4E,QAAQxO,GAC7C,OAAOmL,EAAQrK,MAAM,gDACzB,MAAMwgM,EAAgBn2L,EAAQtH,WAAoC0c,IAA9BvgB,EAAQ,mBAA0CA,EAAQ,kBAAmB,EAAG8yL,GACpH,IAAKwO,EACD,OAAO,KACX,MAAMC,EAAqBp2L,EAAQtH,WAAyC0c,IAAnCvgB,EAAQ,wBAA+CA,EAAQ,uBAAwB,EAAG8yL,GACnI,IAAKyO,EACD,OAAO,KACX,IAAIC,EAAS,KACb,OAAIxhM,EAAgB,SAChBwhM,EAASr2L,EAAQtH,MAAM7D,EAAgB,OAAG,EAAG6yL,IACxC2O,GACM,KAER,IAAI0K,GAAmB5K,EAAeC,EAAoBC,EACrE,CACA,QAAA4C,CAASpjL,GACL,OAAO,IAAIqgL,GAASjhM,KAAKkhM,cAAc8C,SAASpjL,GAAM5gB,KAAKmhM,mBAAmB6C,SAASpjL,GAAM5gB,KAAKohM,OAASphM,KAAKohM,OAAO4C,SAASpjL,GAAO,KAC3I,CACA,SAAAqjL,CAAU5wJ,GACNA,EAAGrzC,KAAKkhM,eACR7tJ,EAAGrzC,KAAKmhM,oBACJnhM,KAAKohM,QACL/tJ,EAAGrzC,KAAKohM,OAEhB,CACA,aAAA8C,GAKI,OAAO,CACX,EAGJ,MAAM6H,GACF,WAAA3mM,CAAYkoC,EAAQ8zJ,EAAQ4K,EAAUC,EAAmBC,GACrDlsM,KAAKkM,KAAOumL,EACZzyL,KAAKstC,OAASA,EACdttC,KAAKohM,OAASA,EACdphM,KAAKgsM,SAAWA,EAChBhsM,KAAKisM,kBAAoBA,EACzBjsM,KAAKksM,kBAAoBA,CAC7B,CACA,YAAOzoM,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,2BACzB,MAAM4sC,EAASviC,EAAQtH,MAAM0K,EAAK,GAAI,EAAGqkL,GACzC,IAAKllJ,EACD,OAAO,KACX,MAAM1tC,EAAUuO,EAAK,GACrB,GAAuB,iBAAZvO,GAAwB4J,MAAM4E,QAAQxO,GAC7C,OAAOmL,EAAQrK,MAAM,oDACzB,IAAI0gM,EAAS,KACb,GAAIxhM,EAAgB,SAChBwhM,EAASr2L,EAAQtH,MAAM7D,EAAgB,OAAG,EAAG6yL,IACxC2O,GACD,OAAO,KAEf,IAAI4K,EAAW,KACf,GAAIpsM,EAAkB,WAClBosM,EAAWjhM,EAAQtH,MAAM7D,EAAkB,SAAG,EAAG6yL,IAC5CuZ,GACD,OAAO,KAEf,IAAIC,EAAoB,KACxB,GAAIrsM,EAAQ,yBACRqsM,EAAoBlhM,EAAQtH,MAAM7D,EAAQ,uBAAwB,EAAG4yL,IAChEyZ,GACD,OAAO,KAEf,IAAIC,EAAoB,KACxB,OAAItsM,EAAQ,yBACRssM,EAAoBnhM,EAAQtH,MAAM7D,EAAQ,uBAAwB,EAAG4yL,IAChE0Z,GACM,KAER,IAAIH,GAAaz+J,EAAQ8zJ,EAAQ4K,EAAUC,EAAmBC,EACzE,CACA,QAAAlI,CAASpjL,GACL,OAAO,IAAI2gL,KAAKwK,aAAa/rM,KAAKohM,OAASphM,KAAKohM,OAAO4C,SAASpjL,GAAO,GAAI,CACvE3hB,MAAOe,KAAKgsM,SAAW,WAAa,UACpCA,SAAUhsM,KAAKgsM,SAAWhsM,KAAKgsM,SAAShI,SAASpjL,QAAOT,EACxDgsL,sBAAuBnsM,KAAKisM,kBAAoBjsM,KAAKisM,kBAAkBjI,SAASpjL,QAAOT,EACvFisL,sBAAuBpsM,KAAKksM,kBAAoBlsM,KAAKksM,kBAAkBlI,SAASpjL,QAAOT,IACxFxgB,OAAOK,KAAKstC,OAAO02J,SAASpjL,GACnC,CACA,SAAAqjL,CAAU5wJ,GACNA,EAAGrzC,KAAKstC,QACJttC,KAAKohM,QACL/tJ,EAAGrzC,KAAKohM,QAERphM,KAAKgsM,UACL34J,EAAGrzC,KAAKgsM,UAERhsM,KAAKisM,mBACL54J,EAAGrzC,KAAKisM,mBAERjsM,KAAKksM,mBACL74J,EAAGrzC,KAAKksM,kBAEhB,CACA,aAAAhI,GACI,OAAO,CACX,EAGJ,MAAMmI,GACF,WAAAjnM,CAAYg9L,GACRpiM,KAAKkM,KAAO8mL,EACZhzL,KAAKoiM,SAAWA,CACpB,CACA,YAAO3+L,CAAM0K,EAAMpD,GACf,GAAIoD,EAAK/M,OAAS,EACd,OAAO2J,EAAQrK,MAAM,mCAEzB,MAAM4rM,EAAWn+L,EAAK,GACtB,IAAK3E,MAAM4E,QAAQk+L,IAAiC,iBAAbA,EACnC,OAAOvhM,EAAQrK,MAAM,oDAEzB,MAAM0hM,EAAW,GACjB,IAAImK,GAAuB,EAC3B,IAAK,IAAIn3L,EAAI,EAAGA,GAAKjH,EAAK/M,OAAS,IAAKgU,EAAG,CACvC,MAAM89J,EAAM/kK,EAAKiH,GACjB,GAAIm3L,GAAuC,iBAARr5B,IAAqB1pK,MAAM4E,QAAQ8kK,GAAM,CACxEq5B,GAAuB,EACvB,IAAIj9L,EAAQ,KACZ,GAAI4jK,EAAI,gBACJ5jK,EAAQvE,EAAQtH,MAAMyvK,EAAI,cAAe,EAAGsf,IACvCljL,GACD,OAAO,KAEf,IAAIunB,EAAO,KACX,GAAIq8I,EAAI,eACJr8I,EAAO9rB,EAAQtH,MAAMyvK,EAAI,aAAc,EAAGp+I,GAAM29J,KAC3C57J,GACD,OAAO,KAEf,IAAIorK,EAAY,KAChB,GAAI/uB,EAAI,gBACJ+uB,EAAYl3L,EAAQtH,MAAMyvK,EAAI,cAAe,EAAGyf,IAC3CsP,GACD,OAAO,KAEf,IAAIC,EAAgB,KACpB,GAAIhvB,EAAI,kBAAmB,CACvB,GAAqC,iBAA1BA,EAAI,oBAAmC4uB,GAAuBh6L,SAASorK,EAAI,mBAClF,OAAOnoK,EAAQrK,MAAM,yEAAyEwyK,EAAI,+BAGtG,GADAgvB,EAAgBn3L,EAAQtH,MAAMyvK,EAAI,kBAAmB,EAAGuf,IACnDyP,EACD,OAAO,IACf,CACA,MAAMsK,EAAiBpK,EAASA,EAAShhM,OAAS,GAClDorM,EAAel9L,MAAQA,EACvBk9L,EAAe31K,KAAOA,EACtB21K,EAAevK,UAAYA,EAC3BuK,EAAetK,cAAgBA,CACnC,KACK,CACD,MAAMhiM,EAAU6K,EAAQtH,MAAM0K,EAAKiH,GAAI,EAAG09K,GAC1C,IAAK5yL,EACD,OAAO,KACX,MAAM6nC,EAAO7nC,EAAQgM,KAAK67B,KAC1B,GAAa,WAATA,GAA8B,UAATA,GAA6B,SAATA,GAA4B,kBAATA,EAC5D,OAAOh9B,EAAQrK,MAAM,qEACzB6rM,GAAuB,EACvBnK,EAASx8L,KAAK,CAAE1F,UAASoP,MAAO,KAAMunB,KAAM,KAAMorK,UAAW,KAAMC,cAAe,MACtF,CACJ,CACA,OAAO,IAAImK,GAAiBjK,EAChC,CACA,QAAA4B,CAASpjL,GAQL,OAAO,IAAIuhL,GAAUniM,KAAKoiM,SAASn8L,KAPXu8L,IACpB,MAAMiK,EAAmBjK,EAAQtiM,QAAQ8jM,SAASpjL,GAClD,OAAIgjL,GAAO6I,KAAsBvZ,EACtB,IAAI6O,GAAiB,GAAI0K,EAAkB,KAAM,KAAM,KAAMjK,EAAQN,cAAgBM,EAAQN,cAAc8B,SAASpjL,GAAO,MAE/H,IAAImhL,GAAiB8B,GAAc4I,GAAmB,KAAMjK,EAAQlzL,MAAQkzL,EAAQlzL,MAAM00L,SAASpjL,GAAO,KAAM4hL,EAAQ3rK,KAAO2rK,EAAQ3rK,KAAKmtK,SAASpjL,GAAK9a,KAAK,KAAO,KAAM08L,EAAQP,UAAYO,EAAQP,UAAU+B,SAASpjL,GAAO,KAAM4hL,EAAQN,cAAgBM,EAAQN,cAAc8B,SAASpjL,GAAO,KAAK,IAG1T,CACA,SAAAqjL,CAAU5wJ,GACN,IAAK,MAAMmvJ,KAAWxiM,KAAKoiM,SACvB/uJ,EAAGmvJ,EAAQtiM,SACPsiM,EAAQlzL,OACR+jC,EAAGmvJ,EAAQlzL,OAEXkzL,EAAQ3rK,MACRwc,EAAGmvJ,EAAQ3rK,MAEX2rK,EAAQP,WACR5uJ,EAAGmvJ,EAAQP,WAEXO,EAAQN,eACR7uJ,EAAGmvJ,EAAQN,cAGvB,CACA,aAAAgC,GAGI,OAAO,CACX,EAGJ,MAAMwI,GACF,WAAAtnM,CAAYwP,GACR5U,KAAKkM,KAAOgnL,EACZlzL,KAAK4U,MAAQA,CACjB,CACA,YAAOnR,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,2BAEzB,MAAM2H,EAAO0C,EAAQtH,MAAM0K,EAAK,GAAI,EAAGskL,GACvC,OAAKpqL,EAEE,IAAIqkM,GAAgBrkM,GADhB0C,EAAQrK,MAAM,0BAE7B,CACA,QAAAsjM,CAASpjL,GACL,MAAM+rL,EAAqB3sM,KAAK4U,MAAMovL,SAASpjL,GACzC7Z,EAAQu8L,GAAcjB,WAAWsK,GAGvC,OAFI5lM,GAAS6Z,EAAIqkL,kBACbl+L,EAAMw8L,UAAY3iL,EAAIqkL,gBAAgBxrL,QAAQkzL,IAAuB,GAClE5lM,CACX,CACA,SAAAk9L,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,MACZ,CACA,aAAAsvL,GAEI,OAAO,CACX,EAGJ,MAAM0I,GACF,WAAAxnM,CAAYwP,GACR5U,KAAKkM,KAAOsmL,EACZxyL,KAAK4U,MAAQA,CACjB,CACA,YAAOnR,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,kCAAkCyN,EAAK/M,OAAS,cACzE,MAAMwT,EAAQ7J,EAAQtH,MAAM0K,EAAK,GAAI,GACrC,OAAKyG,EAEmB,UAApBA,EAAM1I,KAAK67B,MAAwC,WAApBnzB,EAAM1I,KAAK67B,MAAyC,UAApBnzB,EAAM1I,KAAK67B,KACnEh9B,EAAQrK,MAAM,wDAAwD4yL,GAAa1+K,EAAM1I,kBAC7F,IAAI0gM,GAAOh4L,GAHP,IAIf,CACA,QAAAovL,CAASpjL,GACL,MAAMhM,EAAQ5U,KAAK4U,MAAMovL,SAASpjL,GAClC,GAAqB,iBAAVhM,EAEP,MAAO,IAAIA,GAAOxT,OAEjB,GAAIoI,MAAM4E,QAAQwG,GACnB,OAAOA,EAAMxT,OAGb,MAAM,IAAIshM,GAAa,2DAA2DpP,GAAasQ,GAAOhvL,eAE9G,CACA,SAAAqvL,CAAU5wJ,GACNA,EAAGrzC,KAAK4U,MACZ,CACA,aAAAsvL,GACI,OAAO,CACX,EAGJ,MAAM2I,GAAS,KACf,SAASC,GAAmB9wJ,EAAGkpJ,GAC3B,MAAM5/L,GAYE,IAZmB02C,EAAE,IAYR,IAXrB,MAAMz2C,GAgBgBkf,EAhBKu3B,EAAE,IAiBrB,IAAO,IAAMzkB,KAAK3F,GAAK2F,KAAK70B,IAAI60B,KAAKqnK,IAAIrnK,KAAK3F,GAAK,EAAInN,EAAM8S,KAAK3F,GAAK,OAAU,KAD7F,IAA0BnN,EAftB,MAAMsoL,EAAcx1K,KAAK8X,IAAI,EAAG61J,EAAUpjK,GAC1C,MAAO,CAACvK,KAAKC,MAAMlyB,EAAIynM,EAAcF,IAASt1K,KAAKC,MAAMjyB,EAAIwnM,EAAcF,IAC/E,CACA,SAASG,GAAuBC,EAAO/H,GACnC,MAAM6H,EAAcx1K,KAAK8X,IAAI,EAAG61J,EAAUpjK,GACpCx8B,GAAK2nM,EAAM,GAAKJ,GAAS3H,EAAU5/L,GAAKynM,EACxCxnM,GAAK0nM,EAAM,GAAKJ,GAAS3H,EAAU3/L,GAAKwnM,EAC9C,MAAO,EAKsBG,EALG5nM,EAMb,IAAZ4nM,EAAkB,MAKHC,EAX+B5nM,EAY9C,IAAMgyB,KAAK3F,GAAK2F,KAAK61K,KAAK71K,KAAK81K,KAAK,IAAkB,IAAZF,GAAmB51K,KAAK3F,GAAK,MAAQ,KAD1F,IAA0Bu7K,EANOD,CAJjC,CAaA,SAASI,GAAW/oL,EAAM0oL,GACtB1oL,EAAK,GAAKgT,KAAK9kB,IAAI8R,EAAK,GAAI0oL,EAAM,IAClC1oL,EAAK,GAAKgT,KAAK9kB,IAAI8R,EAAK,GAAI0oL,EAAM,IAClC1oL,EAAK,GAAKgT,KAAK5kB,IAAI4R,EAAK,GAAI0oL,EAAM,IAClC1oL,EAAK,GAAKgT,KAAK5kB,IAAI4R,EAAK,GAAI0oL,EAAM,GACtC,CACA,SAASM,GAAaC,EAAOC,GACzB,QAAID,EAAM,IAAMC,EAAM,QAElBD,EAAM,IAAMC,EAAM,QAElBD,EAAM,IAAMC,EAAM,OAElBD,EAAM,IAAMC,EAAM,KAG1B,CAIA,SAASC,GAAgB1xJ,EAAG2xJ,EAAIC,GAC5B,MAAMC,EAAK7xJ,EAAE,GAAK2xJ,EAAG,GACftkH,EAAKrtC,EAAE,GAAK2xJ,EAAG,GACfnE,EAAKxtJ,EAAE,GAAK4xJ,EAAG,GACfE,EAAK9xJ,EAAE,GAAK4xJ,EAAG,GACrB,OAAQC,EAAKC,EAAKtE,EAAKngH,GAAO,GAAOwkH,EAAKrE,GAAM,GAAOngH,EAAKykH,GAAM,CACtE,CAEA,SAASC,GAAwBxzL,EAAGC,EAAG2c,EAAGsY,GAItC,MAAMu+J,EAAU,CAACxzL,EAAE,GAAKD,EAAE,GAAIC,EAAE,GAAKD,EAAE,IACjC0zL,EAAU,CAACx+J,EAAE,GAAKtY,EAAE,GAAIsY,EAAE,GAAKtY,EAAE,IACvC,OAA+B,IA8DrB+2K,EA9DDD,GA+DE,IADGE,EA9DIH,GA+DC,GAAKE,EAAG,GAAKC,EAAG,OA1D/BC,GAAS7zL,EAAGC,EAAG2c,EAAGsY,KAAM2+J,GAASj3K,EAAGsY,EAAGl1B,EAAGC,IAyDlD,IAAc0zL,EAAIC,CAtDlB,CACA,SAASE,GAAqBV,EAAIC,EAAI1tG,GAClC,IAAK,MAAMwjD,KAAQxjD,EAEf,IAAK,IAAIt5E,EAAI,EAAGA,EAAI88H,EAAKtiJ,OAAS,IAAKwlB,EACnC,GAAImnL,GAAwBJ,EAAIC,EAAIlqD,EAAK98H,GAAI88H,EAAK98H,EAAI,IAClD,OAAO,EAInB,OAAO,CACX,CAEA,SAAS0nL,GAAmBlqM,EAAOmqM,EAAOC,GAAmB,GACzD,IAAIC,GAAS,EACb,IAAK,MAAM/qD,KAAQ6qD,EACf,IAAK,IAAI3nL,EAAI,EAAGA,EAAI88H,EAAKtiJ,OAAS,EAAGwlB,IAAK,CACtC,GAAI8mL,GAAgBtpM,EAAOs/I,EAAK98H,GAAI88H,EAAK98H,EAAI,IACzC,OAAO4nL,EA3CDxyJ,EA4CO53C,EA5CJupM,EA4CWjqD,EAAK98H,GA5CZgnL,EA4CgBlqD,EAAK98H,EAAI,GA3CzC+mL,EAAG,GAAK3xJ,EAAE,IAAS4xJ,EAAG,GAAK5xJ,EAAE,IAASA,EAAE,IAAM4xJ,EAAG,GAAKD,EAAG,KAAO3xJ,EAAE,GAAK2xJ,EAAG,KAAOC,EAAG,GAAKD,EAAG,IAAMA,EAAG,KA4ClGc,GAAUA,EAClB,CA9CR,IAAsBzyJ,EAAG2xJ,EAAIC,EAgDzB,OAAOa,CACX,CACA,SAASC,GAAoBtqM,EAAOuqM,GAChC,IAAK,MAAMzuG,KAAWyuG,EAClB,GAAIL,GAAmBlqM,EAAO87F,GAC1B,OAAO,EAEf,OAAO,CACX,CACA,SAAS0uG,GAAwB3yL,EAAMikF,GAEnC,IAAK,MAAM97F,KAAS6X,EAChB,IAAKqyL,GAAmBlqM,EAAO87F,GAC3B,OAAO,EAIf,IAAK,IAAI9qF,EAAI,EAAGA,EAAI6G,EAAK7a,OAAS,IAAKgU,EACnC,GAAIi5L,GAAqBpyL,EAAK7G,GAAI6G,EAAK7G,EAAI,GAAI8qF,GAC3C,OAAO,EAGf,OAAO,CACX,CACA,SAAS2uG,GAAyB5yL,EAAM0yL,GACpC,IAAK,MAAMzuG,KAAWyuG,EAClB,GAAIC,GAAwB3yL,EAAMikF,GAC9B,OAAO,EAEf,OAAO,CACX,CAKA,SAASkuG,GAAST,EAAIC,EAAIkB,EAAIC,GAE1B,MAAMlB,EAAKF,EAAG,GAAKmB,EAAG,GAChBzlH,EAAKskH,EAAG,GAAKmB,EAAG,GAChBtF,EAAKoE,EAAG,GAAKkB,EAAG,GAChBhB,EAAKF,EAAG,GAAKkB,EAAG,GAChBE,EAAKD,EAAG,GAAKD,EAAG,GAChBG,EAAKF,EAAG,GAAKD,EAAG,GAChBI,EAAQrB,EAAKoB,EAAKD,EAAK3lH,EACvB8lH,EAAQ3F,EAAKyF,EAAKD,EAAKlB,EAC7B,OAAKoB,EAAO,GAAKC,EAAO,GAAOD,EAAO,GAAKC,EAAO,CAGtD,CAEA,SAASC,GAAel9G,EAAa3tE,EAAM2gL,GACvC,MAAMhlG,EAAU,GAChB,IAAK,IAAI9qF,EAAI,EAAGA,EAAI88E,EAAY9wF,OAAQgU,IAAK,CACzC,MAAMsuI,EAAO,GACb,IAAK,IAAI98H,EAAI,EAAGA,EAAIsrE,EAAY98E,GAAGhU,OAAQwlB,IAAK,CAC5C,MAAMqmL,EAAQH,GAAmB56G,EAAY98E,GAAGwR,GAAIs+K,GACpDoI,GAAW/oL,EAAM0oL,GACjBvpD,EAAK99I,KAAKqnM,EACd,CACA/sG,EAAQt6F,KAAK89I,EACjB,CACA,OAAOxjD,CACX,CACA,SAASmvG,GAAgBn9G,EAAa3tE,EAAM2gL,GACxC,MAAMyJ,EAAW,GACjB,IAAK,IAAIv5L,EAAI,EAAGA,EAAI88E,EAAY9wF,OAAQgU,IAAK,CACzC,MAAM8qF,EAAUkvG,GAAel9G,EAAY98E,GAAImP,EAAM2gL,GACrDyJ,EAAS/oM,KAAKs6F,EAClB,CACA,OAAOyuG,CACX,CACA,SAASW,GAAYtzJ,EAAGz3B,EAAMgrL,EAAUC,GACpC,GAAIxzJ,EAAE,GAAKuzJ,EAAS,IAAMvzJ,EAAE,GAAKuzJ,EAAS,GAAI,CAC1C,MAAME,EAA4B,GAAZD,EACtB,IAAIthM,EAAS8tC,EAAE,GAAKuzJ,EAAS,GAAKE,GAAkBD,EAAaD,EAAS,GAAKvzJ,EAAE,GAAKyzJ,EAAiBD,EAAY,EACrG,IAAVthM,IACAA,EAAS8tC,EAAE,GAAKuzJ,EAAS,GAAKE,GAAkBD,EAAaD,EAAS,GAAKvzJ,EAAE,GAAKyzJ,EAAiBD,EAAY,GAEnHxzJ,EAAE,IAAM9tC,CACZ,CACAo/L,GAAW/oL,EAAMy3B,EACrB,CAKA,SAAS0zJ,GAAc/gM,EAAUghM,EAAWJ,EAAUrK,GAClD,MAAMsK,EAAYj4K,KAAK8X,IAAI,EAAG61J,EAAUpjK,GAAK+qK,GACvC+C,EAAS,CAAC1K,EAAU5/L,EAAIunM,GAAQ3H,EAAU3/L,EAAIsnM,IAC9CgD,EAAa,GACnB,IAAK,MAAMlpL,KAAUhY,EACjB,IAAK,MAAMvK,KAASuiB,EAAQ,CACxB,MAAMq1B,EAAI,CAAC53C,EAAMkB,EAAIsqM,EAAO,GAAIxrM,EAAMmB,EAAIqqM,EAAO,IACjDN,GAAYtzJ,EAAG2zJ,EAAWJ,EAAUC,GACpCK,EAAWjqM,KAAKo2C,EACpB,CAEJ,OAAO6zJ,CACX,CACA,SAASC,GAAanhM,EAAUohM,EAAUR,EAAUrK,GAChD,MAAMsK,EAAYj4K,KAAK8X,IAAI,EAAG61J,EAAUpjK,GAAK+qK,GACvC+C,EAAS,CAAC1K,EAAU5/L,EAAIunM,GAAQ3H,EAAU3/L,EAAIsnM,IAC9CmD,EAAY,GAClB,IAAK,MAAM/zL,KAAQtN,EAAU,CACzB,MAAMshM,EAAW,GACjB,IAAK,MAAM7rM,KAAS6X,EAAM,CACtB,MAAM+/B,EAAI,CAAC53C,EAAMkB,EAAIsqM,EAAO,GAAIxrM,EAAMmB,EAAIqqM,EAAO,IACjDtC,GAAWyC,EAAU/zJ,GACrBi0J,EAASrqM,KAAKo2C,EAClB,CACAg0J,EAAUpqM,KAAKqqM,EACnB,CACA,GAAIF,EAAS,GAAKA,EAAS,IAAMP,EAAY,EAAG,EA9BjCjrL,EA+BDwrL,GA9BT,GAAKxrL,EAAK,GAAK+0B,IACpB/0B,EAAK,GAAKA,EAAK,IAAK,IA8BhB,IAAK,MAAMtI,KAAQ+zL,EACf,IAAK,MAAMh0J,KAAK//B,EACZqzL,GAAYtzJ,EAAG+zJ,EAAUR,EAAUC,EAG/C,CArCJ,IAAmBjrL,EAsCf,OAAOyrL,CACX,CAqDA,MAAME,GACF,WAAA9qM,CAAY0mK,EAASqkC,GACjBnwM,KAAKkM,KAAOwmL,EACZ1yL,KAAK8rK,QAAUA,EACf9rK,KAAKmwM,WAAaA,CACtB,CACA,YAAO1sM,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,gEAAgEyN,EAAK/M,OAAS,cACvG,GAAIsiM,GAAQv1L,EAAK,IAAK,CAClB,MAAM29J,EAAU39J,EAAK,GACrB,GAAqB,sBAAjB29J,EAAQ5/J,KAA8B,CACtC,MAAMkkM,EAAiB,GACvB,IAAK,MAAMlwG,KAAW4rE,EAAQj8E,SAAU,CACpC,MAAM,KAAE3jF,EAAI,YAAEgmF,GAAgBgO,EAAQvxF,SACzB,YAATzC,GACAkkM,EAAexqM,KAAKssF,GAEX,iBAAThmF,GACAkkM,EAAexqM,QAAQssF,EAE/B,CACA,GAAIk+G,EAAehvM,OAAQ,CAKvB,OAAO,IAAI8uM,GAAOpkC,EAJU,CACxB5/J,KAAM,eACNgmF,YAAak+G,GAGrB,CACJ,MACK,GAAqB,YAAjBtkC,EAAQ5/J,KAAoB,CACjC,MAAMA,EAAO4/J,EAAQn9J,SAASzC,KAC9B,GAAa,YAATA,GAA+B,iBAATA,EACtB,OAAO,IAAIgkM,GAAOpkC,EAASA,EAAQn9J,SAE3C,MACK,GAAqB,YAAjBm9J,EAAQ5/J,MAAuC,iBAAjB4/J,EAAQ5/J,KAC3C,OAAO,IAAIgkM,GAAOpkC,EAASA,EAEnC,CACA,OAAO/gK,EAAQrK,MAAM,yFACzB,CACA,QAAAsjM,CAASpjL,GACL,GAAsB,MAAlBA,EAAIjS,YAA2C,MAArBiS,EAAIwkL,cAAuB,CACrD,GAA2B,UAAvBxkL,EAAIukL,eACJ,OAjGhB,SAA8BvkL,EAAKyvL,GAC/B,MAAMV,EAAY,CAACr2J,IAAUA,KAAU,KAAW,KAC5Ci2J,EAAW,CAACj2J,IAAUA,KAAU,KAAW,KAC3C4rJ,EAAYtkL,EAAIwkL,cACtB,GAA6B,YAAzBiL,EAAgBnkM,KAAoB,CACpC,MAAMokM,EAAclB,GAAeiB,EAAgBn+G,YAAaq9G,EAAUrK,GACpE2K,EAAaH,GAAc9uL,EAAIjS,WAAYghM,EAAWJ,EAAUrK,GACtE,IAAKqI,GAAaoC,EAAWJ,GACzB,OAAO,EACX,IAAK,MAAMnrM,KAASyrM,EAChB,IAAKvB,GAAmBlqM,EAAOksM,GAC3B,OAAO,CAEnB,CACA,GAA6B,iBAAzBD,EAAgBnkM,KAAyB,CACzC,MAAMqkM,EAAelB,GAAgBgB,EAAgBn+G,YAAaq9G,EAAUrK,GACtE2K,EAAaH,GAAc9uL,EAAIjS,WAAYghM,EAAWJ,EAAUrK,GACtE,IAAKqI,GAAaoC,EAAWJ,GACzB,OAAO,EACX,IAAK,MAAMnrM,KAASyrM,EAChB,IAAKnB,GAAoBtqM,EAAOmsM,GAC5B,OAAO,CAEnB,CACA,OAAO,CACX,CAwEuBC,CAAqB5vL,EAAK5gB,KAAKmwM,YAErC,GAA2B,eAAvBvvL,EAAIukL,eACT,OA1EhB,SAA6BvkL,EAAKyvL,GAC9B,MAAMN,EAAW,CAACz2J,IAAUA,KAAU,KAAW,KAC3Ci2J,EAAW,CAACj2J,IAAUA,KAAU,KAAW,KAC3C4rJ,EAAYtkL,EAAIwkL,cACtB,GAA6B,YAAzBiL,EAAgBnkM,KAAoB,CACpC,MAAMokM,EAAclB,GAAeiB,EAAgBn+G,YAAaq9G,EAAUrK,GACpE8K,EAAYF,GAAalvL,EAAIjS,WAAYohM,EAAUR,EAAUrK,GACnE,IAAKqI,GAAawC,EAAUR,GACxB,OAAO,EACX,IAAK,MAAMtzL,KAAQ+zL,EACf,IAAKpB,GAAwB3yL,EAAMq0L,GAC/B,OAAO,CAEnB,CACA,GAA6B,iBAAzBD,EAAgBnkM,KAAyB,CACzC,MAAMqkM,EAAelB,GAAgBgB,EAAgBn+G,YAAaq9G,EAAUrK,GACtE8K,EAAYF,GAAalvL,EAAIjS,WAAYohM,EAAUR,EAAUrK,GACnE,IAAKqI,GAAawC,EAAUR,GACxB,OAAO,EACX,IAAK,MAAMtzL,KAAQ+zL,EACf,IAAKnB,GAAyB5yL,EAAMs0L,GAChC,OAAO,CAEnB,CACA,OAAO,CACX,CAiDuBE,CAAoB7vL,EAAK5gB,KAAKmwM,WAE7C,CACA,OAAO,CACX,CACA,SAAAlM,GAAc,CACd,aAAAC,GACI,OAAO,CACX,EAGJ,MAAMwM,GACF,WAAAtrM,CAAYvF,EAAO,GAAI4hM,EAAU,CAAClnL,EAAGC,IAAOD,EAAIC,GAAK,EAAID,EAAIC,EAAI,EAAI,GAKjE,GAJAxa,KAAKH,KAAOA,EACZG,KAAKoB,OAASpB,KAAKH,KAAKuB,OACxBpB,KAAKyhM,QAAUA,EAEXzhM,KAAKoB,OAAS,EACd,IAAK,IAAIgU,GAAKpV,KAAKoB,QAAU,GAAK,EAAGgU,GAAK,EAAGA,IAAKpV,KAAK2wM,MAAMv7L,EAErE,CAEA,IAAAxP,CAAK24C,GACDv+C,KAAKH,KAAK+F,KAAK24C,GACfv+C,KAAK4wM,IAAI5wM,KAAKoB,SAClB,CAEA,GAAAwiE,GACI,GAAoB,IAAhB5jE,KAAKoB,OAAc,OAEvB,MAAM+H,EAAMnJ,KAAKH,KAAK,GAChBuJ,EAASpJ,KAAKH,KAAK+jE,MAOzB,QALM5jE,KAAKoB,OAAS,IAChBpB,KAAKH,KAAK,GAAKuJ,EACfpJ,KAAK2wM,MAAM,IAGRxnM,CACX,CAEA,IAAA0nM,GACI,OAAO7wM,KAAKH,KAAK,EACrB,CAEA,GAAA+wM,CAAI5pM,GACA,MAAM,KAACnH,EAAI,QAAE4hM,GAAWzhM,KAClBu+C,EAAO1+C,EAAKmH,GAElB,KAAOA,EAAM,GAAG,CACZ,MAAMkvC,EAAUlvC,EAAM,GAAM,EACtB0gB,EAAU7nB,EAAKq2C,GACrB,GAAIurJ,EAAQljJ,EAAM72B,IAAY,EAAG,MACjC7nB,EAAKmH,GAAO0gB,EACZ1gB,EAAMkvC,CACV,CAEAr2C,EAAKmH,GAAOu3C,CAChB,CAEA,KAAAoyJ,CAAM3pM,GACF,MAAM,KAACnH,EAAI,QAAE4hM,GAAWzhM,KAClB8wM,EAAa9wM,KAAKoB,QAAU,EAC5Bm9C,EAAO1+C,EAAKmH,GAElB,KAAOA,EAAM8pM,GAAY,CACrB,IAAIC,EAAyB,GAAZ/pM,GAAO,GACxB,MAAMsC,EAAQynM,EAAY,EAK1B,GAHIznM,EAAQtJ,KAAKoB,QAAUqgM,EAAQ5hM,EAAKyJ,GAAQzJ,EAAKkxM,IAAc,IAC/DA,EAAYznM,GAEZm4L,EAAQ5hM,EAAKkxM,GAAYxyJ,IAAS,EAAG,MAEzC1+C,EAAKmH,GAAOnH,EAAKkxM,GACjB/pM,EAAM+pM,CACV,CAEAlxM,EAAKmH,GAAOu3C,CAChB,EAcJ,SAASyyJ,GAAY72J,EAAKx0C,EAAG0D,EAAO,EAAGC,EAAQ6wC,EAAI/4C,OAAS,EAAGqgM,EAAUwP,IAErE,KAAO3nM,EAAQD,GAAM,CACjB,GAAIC,EAAQD,EAAO,IAAK,CACpB,MAAMsgB,EAAIrgB,EAAQD,EAAO,EACnB+kC,EAAIzoC,EAAI0D,EAAO,EACfy4B,EAAIvK,KAAK70B,IAAIinB,GACb+lB,EAAI,GAAMnY,KAAK81K,IAAI,EAAIvrK,EAAI,GAC3BovK,EAAK,GAAM35K,KAAKsjB,KAAK/Y,EAAI4N,GAAK/lB,EAAI+lB,GAAK/lB,IAAMykB,EAAIzkB,EAAI,EAAI,GAAK,EAAI,GAGxEqnL,GAAY72J,EAAKx0C,EAFD4xB,KAAK5kB,IAAItJ,EAAMkuB,KAAKyR,MAAMrjC,EAAIyoC,EAAIsB,EAAI/lB,EAAIunL,IACzC35K,KAAK9kB,IAAInJ,EAAOiuB,KAAKyR,MAAMrjC,GAAKgkB,EAAIykB,GAAKsB,EAAI/lB,EAAIunL,IAC3BzP,EAC3C,CAEA,MAAM18H,EAAI5qB,EAAIx0C,GACd,IAAIyP,EAAI/L,EAEJud,EAAItd,EAKR,IAHA6nM,GAAKh3J,EAAK9wC,EAAM1D,GACZ87L,EAAQtnJ,EAAI7wC,GAAQy7D,GAAK,GAAGosI,GAAKh3J,EAAK9wC,EAAMC,GAEzC8L,EAAIwR,GAAG,CAIV,IAHAuqL,GAAKh3J,EAAK/kC,EAAGwR,GACbxR,IACAwR,IACO66K,EAAQtnJ,EAAI/kC,GAAI2vD,GAAK,GAAG3vD,IAC/B,KAAOqsL,EAAQtnJ,EAAIvzB,GAAIm+C,GAAK,GAAGn+C,GACnC,CAE8B,IAA1B66K,EAAQtnJ,EAAI9wC,GAAO07D,GAAUosI,GAAKh3J,EAAK9wC,EAAMud,IAE7CA,IACAuqL,GAAKh3J,EAAKvzB,EAAGtd,IAGbsd,GAAKjhB,IAAG0D,EAAOud,EAAI,GACnBjhB,GAAKihB,IAAGtd,EAAQsd,EAAI,EAC5B,CACJ,CAQA,SAASuqL,GAAKh3J,EAAK/kC,EAAGwR,GAClB,MAAMuyD,EAAMh/B,EAAI/kC,GAChB+kC,EAAI/kC,GAAK+kC,EAAIvzB,GACbuzB,EAAIvzB,GAAKuyD,CACb,CAQA,SAAS83H,GAAe12L,EAAGC,GACvB,OAAOD,EAAIC,GAAK,EAAID,EAAIC,EAAI,EAAI,CACpC,CA6CA,SAAS42L,GAAa72L,EAAGC,GACrB,OAAOA,EAAE6uD,KAAO9uD,EAAE8uD,IACtB,CASA,SAASgoI,GAAoB3tD,GACzB,IAAIh9F,EAAM,EACV,IAAK,IAA2CinJ,EAAIC,EAA3Cx4L,EAAI,EAAGkvD,EAAMo/E,EAAKtiJ,OAAQwlB,EAAI09C,EAAM,EAAWlvD,EAAIkvD,EAAK19C,EAAIxR,IACjEu4L,EAAKjqD,EAAKtuI,GACVw4L,EAAKlqD,EAAK98H,GACV8/B,IAAQknJ,EAAGtoM,EAAIqoM,EAAGroM,IAAMqoM,EAAGpoM,EAAIqoM,EAAGroM,GAEtC,OAAOmhD,CACX,CAIA,MACM4qJ,GAAK,EAAI,cACTC,GAAKD,IAAM,EAAIA,IACfE,GAAMj6K,KAAK3F,GAAK,IACtB,MAAM6/K,GACF,WAAArsM,CAAYqf,GAER,MAAM2pB,EAPH,SAOOojK,GAAW,IACfE,EAASn6K,KAAKspK,IAAIp8K,EAAM+sL,IACxBG,EAAK,GAAK,EAAIJ,IAAM,EAAIG,EAASA,IACjC73L,EAAI0d,KAAKsjB,KAAK82J,GAEpB3xM,KAAK4xM,GAAKxjK,EAAIv0B,EAAI63L,EAClB1xM,KAAK6xM,GAAKzjK,EAAIv0B,EAAI83L,GAAM,EAAIJ,GAChC,CAWA,QAAAvsM,CAASuV,EAAGC,GACR,MAAM4uC,EAAKppD,KAAK+L,KAAKwO,EAAE,GAAKC,EAAE,IAAMxa,KAAK4xM,GACnCvoJ,GAAM9uC,EAAE,GAAKC,EAAE,IAAMxa,KAAK6xM,GAChC,OAAOt6K,KAAKsjB,KAAKuO,EAAKA,EAAKC,EAAKA,EACpC,CAaA,WAAAyoJ,CAAY71L,EAAM+/B,GACd,IACI+1J,EAAMC,EAAMC,EAAMC,EADlBC,EAAU74J,IAEd,IAAK,IAAIlkC,EAAI,EAAGA,EAAI6G,EAAK7a,OAAS,EAAGgU,IAAK,CACtC,IAAI9P,EAAI2W,EAAK7G,GAAG,GACZ7P,EAAI0W,EAAK7G,GAAG,GACZg0C,EAAKppD,KAAK+L,KAAKkQ,EAAK7G,EAAI,GAAG,GAAK9P,GAAKtF,KAAK4xM,GAC1CvoJ,GAAMptC,EAAK7G,EAAI,GAAG,GAAK7P,GAAKvF,KAAK6xM,GACjC9sI,EAAI,EACG,IAAP3b,GAAmB,IAAPC,IACZ0b,GAAK/kE,KAAK+L,KAAKiwC,EAAE,GAAK12C,GAAKtF,KAAK4xM,GAAKxoJ,GAAMpN,EAAE,GAAKz2C,GAAKvF,KAAK6xM,GAAKxoJ,IAAOD,EAAKA,EAAKC,EAAKA,GACnF0b,EAAI,GACJz/D,EAAI2W,EAAK7G,EAAI,GAAG,GAChB7P,EAAI0W,EAAK7G,EAAI,GAAG,IAEX2vD,EAAI,IACTz/D,GAAM8jD,EAAKppD,KAAK4xM,GAAM7sI,EACtBx/D,GAAM8jD,EAAKrpD,KAAK6xM,GAAM9sI,IAG9B3b,EAAKppD,KAAK+L,KAAKiwC,EAAE,GAAK12C,GAAKtF,KAAK4xM,GAChCvoJ,GAAMrN,EAAE,GAAKz2C,GAAKvF,KAAK6xM,GACvB,MAAMO,EAAShpJ,EAAKA,EAAKC,EAAKA,EAC1B+oJ,EAASD,IACTA,EAAUC,EACVL,EAAOzsM,EACP0sM,EAAOzsM,EACP0sM,EAAO78L,EACP88L,EAAOntI,EAEf,CACA,MAAO,CACH3gE,MAAO,CAAC2tM,EAAMC,GACd/oM,MAAOgpM,EACPltI,EAAGxtC,KAAK5kB,IAAI,EAAG4kB,KAAK9kB,IAAI,EAAGy/L,IAEnC,CACA,IAAAnmM,CAAKujC,GACD,KAAOA,GAAO,KACVA,GAAO,IACX,KAAOA,EAAM,KACTA,GAAO,IACX,OAAOA,CACX,EAKJ,SAAS+iK,GAAgB93L,EAAGC,GACxB,OAAOA,EAAE,GAAKD,EAAE,EACpB,CACA,SAAS+3L,GAAaxpH,GAClB,OAAOA,EAAM,GAAKA,EAAM,GAAK,CACjC,CACA,SAASypH,GAAYzpH,EAAOtlC,GACxB,OAAOslC,EAAM,IAAMA,EAAM,IAAMA,EAAM,GAAKtlC,CAC9C,CACA,SAASgvJ,GAAW1pH,EAAO2pH,GACvB,GAAI3pH,EAAM,GAAKA,EAAM,GACjB,MAAO,CAAC,KAAM,MAElB,MAAMlvE,EAAO04L,GAAaxpH,GAC1B,GAAI2pH,EAAQ,CACR,GAAa,IAAT74L,EACA,MAAO,CAACkvE,EAAO,MAEnB,MAAM4pH,EAAQn7K,KAAKyR,MAAMpvB,EAAO,GAChC,MAAO,CAAC,CAACkvE,EAAM,GAAIA,EAAM,GAAK4pH,GAC1B,CAAC5pH,EAAM,GAAK4pH,EAAO5pH,EAAM,IACjC,CACA,GAAa,IAATlvE,EACA,MAAO,CAACkvE,EAAO,MAEnB,MAAM4pH,EAAQn7K,KAAKyR,MAAMpvB,EAAO,GAAK,EACrC,MAAO,CAAC,CAACkvE,EAAM,GAAIA,EAAM,GAAK4pH,GAC1B,CAAC5pH,EAAM,GAAK4pH,EAAQ,EAAG5pH,EAAM,IACrC,CACA,SAAS6pH,GAAQthC,EAAQvoF,GACrB,IAAKypH,GAAYzpH,EAAOuoF,EAAOjwK,QAC3B,MAAO,CAACk4C,IAAUA,KAAWA,KAAWA,KAE5C,MAAM/0B,EAAO,CAAC+0B,IAAUA,KAAWA,KAAWA,KAC9C,IAAK,IAAIlkC,EAAI0zE,EAAM,GAAI1zE,GAAK0zE,EAAM,KAAM1zE,EACpCk4L,GAAW/oL,EAAM8sJ,EAAOj8J,IAE5B,OAAOmP,CACX,CACA,SAASquL,GAAe1yG,GACpB,MAAM37E,EAAO,CAAC+0B,IAAUA,KAAWA,KAAWA,KAC9C,IAAK,MAAMoqG,KAAQxjD,EACf,IAAK,MAAM+sG,KAASvpD,EAChB4pD,GAAW/oL,EAAM0oL,GAGzB,OAAO1oL,CACX,CACA,SAASsuL,GAAYtuL,GACjB,OAAOA,EAAK,MAAQ+0B,KAAY/0B,EAAK,MAAQ+0B,KAAY/0B,EAAK,KAAO+0B,KAAY/0B,EAAK,KAAO+0B,GACjG,CAIA,SAASw5J,GAAmBtF,EAAOC,EAAOsF,GACtC,IAAKF,GAAYrF,KAAWqF,GAAYpF,GACpC,OAAO5N,IAEX,IAAIz2I,EAAK,EACLC,EAAK,EAiBT,OAfImkJ,EAAM,GAAKC,EAAM,KACjBrkJ,EAAKqkJ,EAAM,GAAKD,EAAM,IAGtBA,EAAM,GAAKC,EAAM,KACjBrkJ,EAAKokJ,EAAM,GAAKC,EAAM,IAGtBD,EAAM,GAAKC,EAAM,KACjBpkJ,EAAKmkJ,EAAM,GAAKC,EAAM,IAGtBD,EAAM,GAAKC,EAAM,KACjBpkJ,EAAKokJ,EAAM,GAAKD,EAAM,IAEnBuF,EAAM/tM,SAAS,CAAC,EAAK,GAAM,CAACokD,EAAIC,GAC3C,CACA,SAAS2pJ,GAAoB5uM,EAAO6X,EAAM82L,GACtC,MAAME,EAAeF,EAAMjB,YAAY71L,EAAM7X,GAC7C,OAAO2uM,EAAM/tM,SAASZ,EAAO6uM,EAAa7uM,MAC9C,CACA,SAAS8uM,GAAyBvF,EAAIC,EAAIkB,EAAIC,EAAIgE,GAC9C,MAAMI,EAAQ57K,KAAK9kB,IAAIugM,GAAoBrF,EAAI,CAACmB,EAAIC,GAAKgE,GAAQC,GAAoBpF,EAAI,CAACkB,EAAIC,GAAKgE,IAC7FK,EAAQ77K,KAAK9kB,IAAIugM,GAAoBlE,EAAI,CAACnB,EAAIC,GAAKmF,GAAQC,GAAoBjE,EAAI,CAACpB,EAAIC,GAAKmF,IACnG,OAAOx7K,KAAK9kB,IAAI0gM,EAAOC,EAC3B,CACA,SAASC,GAAmBC,EAAOC,EAAQC,EAAOC,EAAQV,GAEtD,KADkBR,GAAYgB,EAAQD,EAAMlyM,SAAWmxM,GAAYkB,EAAQD,EAAMpyM,SAE7E,OAAOk4C,IAEX,IAAI2oC,EAAO3oC,IACX,IAAK,IAAIlkC,EAAIm+L,EAAO,GAAIn+L,EAAIm+L,EAAO,KAAMn+L,EAAG,CACxC,MAAMu4L,EAAK2F,EAAMl+L,GACXw4L,EAAK0F,EAAMl+L,EAAI,GACrB,IAAK,IAAIwR,EAAI6sL,EAAO,GAAI7sL,EAAI6sL,EAAO,KAAM7sL,EAAG,CACxC,MAAMkoL,EAAK0E,EAAM5sL,GACXmoL,EAAKyE,EAAM5sL,EAAI,GACrB,GAAImnL,GAAwBJ,EAAIC,EAAIkB,EAAIC,GACpC,OAAO,EAEX9sH,EAAO1qD,KAAK9kB,IAAIwvE,EAAMixH,GAAyBvF,EAAIC,EAAIkB,EAAIC,EAAIgE,GACnE,CACJ,CACA,OAAO9wH,CACX,CACA,SAASyxH,GAAuBC,EAASJ,EAAQK,EAASH,EAAQV,GAE9D,KADkBR,GAAYgB,EAAQI,EAAQvyM,SAAWmxM,GAAYkB,EAAQG,EAAQxyM,SAEjF,OAAOy+L,IAEX,IAAI59G,EAAO3oC,IACX,IAAK,IAAIlkC,EAAIm+L,EAAO,GAAIn+L,GAAKm+L,EAAO,KAAMn+L,EACtC,IAAK,IAAIwR,EAAI6sL,EAAO,GAAI7sL,GAAK6sL,EAAO,KAAM7sL,EAEtC,GADAq7D,EAAO1qD,KAAK9kB,IAAIwvE,EAAM8wH,EAAM/tM,SAAS2uM,EAAQv+L,GAAIw+L,EAAQhtL,KAC5C,IAATq7D,EACA,OAAOA,EAInB,OAAOA,CACX,CACA,SAAS4xH,GAAuBzvM,EAAO87F,EAAS6yG,GAC5C,GAAIzE,GAAmBlqM,EAAO87F,GAAS,GACnC,OAAO,EAEX,IAAIje,EAAO3oC,IACX,IAAK,MAAMoqG,KAAQxjD,EAAS,CACxB,MAAM4zG,EAAQpwD,EAAK,GACbqwD,EAAOrwD,EAAKA,EAAKtiJ,OAAS,GAChC,GAAI0yM,IAAUC,IACV9xH,EAAO1qD,KAAK9kB,IAAIwvE,EAAM+wH,GAAoB5uM,EAAO,CAAC2vM,EAAMD,GAAQf,IACnD,IAAT9wH,GACA,OAAOA,EAGf,MAAMgxH,EAAeF,EAAMjB,YAAYpuD,EAAMt/I,GAE7C,GADA69E,EAAO1qD,KAAK9kB,IAAIwvE,EAAM8wH,EAAM/tM,SAASZ,EAAO6uM,EAAa7uM,QAC5C,IAAT69E,EACA,OAAOA,CAEf,CACA,OAAOA,CACX,CACA,SAAS+xH,GAAsB/3L,EAAM6sE,EAAOoX,EAAS6yG,GACjD,IAAKR,GAAYzpH,EAAO7sE,EAAK7a,QACzB,OAAOy+L,IAEX,IAAK,IAAIzqL,EAAI0zE,EAAM,GAAI1zE,GAAK0zE,EAAM,KAAM1zE,EACpC,GAAIk5L,GAAmBryL,EAAK7G,GAAI8qF,GAAS,GACrC,OAAO,EAGf,IAAIje,EAAO3oC,IACX,IAAK,IAAIlkC,EAAI0zE,EAAM,GAAI1zE,EAAI0zE,EAAM,KAAM1zE,EAAG,CACtC,MAAMu4L,EAAK1xL,EAAK7G,GACVw4L,EAAK3xL,EAAK7G,EAAI,GACpB,IAAK,MAAMsuI,KAAQxjD,EACf,IAAK,IAAIt5E,EAAI,EAAG09C,EAAMo/E,EAAKtiJ,OAAQuE,EAAI2+D,EAAM,EAAG19C,EAAI09C,EAAK3+D,EAAIihB,IAAK,CAC9D,MAAMkoL,EAAKprD,EAAK/9I,GACVopM,EAAKrrD,EAAK98H,GAChB,GAAImnL,GAAwBJ,EAAIC,EAAIkB,EAAIC,GACpC,OAAO,EAEX9sH,EAAO1qD,KAAK9kB,IAAIwvE,EAAMixH,GAAyBvF,EAAIC,EAAIkB,EAAIC,EAAIgE,GACnE,CAER,CACA,OAAO9wH,CACX,CACA,SAASgyH,GAAiBC,EAAOC,GAC7B,IAAK,MAAMzwD,KAAQwwD,EACf,IAAK,MAAM9vM,KAASs/I,EAChB,GAAI4qD,GAAmBlqM,EAAO+vM,GAAO,GACjC,OAAO,EAInB,OAAO,CACX,CACA,SAASC,GAAyBC,EAAUC,EAAUvB,EAAOwB,EAAkBj7J,KAC3E,MAAMk0J,EAAQoF,GAAeyB,GACvB5G,EAAQmF,GAAe0B,GAC7B,GAAIC,IAAoBj7J,KAAYw5J,GAAmBtF,EAAOC,EAAOsF,IAAUwB,EAC3E,OAAOA,EAEX,GAAIhH,GAAaC,EAAOC,IACpB,GAAIwG,GAAiBI,EAAUC,GAC3B,OAAO,OAGV,GAAIL,GAAiBK,EAAUD,GAChC,OAAO,EAEX,IAAIpyH,EAAO3oC,IACX,IAAK,MAAMk7J,KAASH,EAChB,IAAK,IAAIj/L,EAAI,EAAGq/L,EAAOD,EAAMpzM,OAAQsiB,EAAI+wL,EAAO,EAAGr/L,EAAIq/L,EAAM/wL,EAAItO,IAAK,CAClE,MAAMu4L,EAAK6G,EAAM9wL,GACXkqL,EAAK4G,EAAMp/L,GACjB,IAAK,MAAMs/L,KAASJ,EAChB,IAAK,IAAI1tL,EAAI,EAAG+tL,EAAOD,EAAMtzM,OAAQuE,EAAIgvM,EAAO,EAAG/tL,EAAI+tL,EAAMhvM,EAAIihB,IAAK,CAClE,MAAMkoL,EAAK4F,EAAM/uM,GACXopM,EAAK2F,EAAM9tL,GACjB,GAAImnL,GAAwBJ,EAAIC,EAAIkB,EAAIC,GACpC,OAAO,EAEX9sH,EAAO1qD,KAAK9kB,IAAIwvE,EAAMixH,GAAyBvF,EAAIC,EAAIkB,EAAIC,EAAIgE,GACnE,CAER,CAEJ,OAAO9wH,CACX,CACA,SAAS2yH,GAAYC,EAAWC,EAAU/B,EAAOpsL,EAAQ4oL,EAAUwF,GAC/D,IAAKA,EACD,OAEJ,MAAMC,EAAWlC,GAAmBH,GAAQhsL,EAAQouL,GAASxF,EAAUwD,GAGnEiC,EAAWF,GACXD,EAAUjvM,KAAK,CAACovM,EAAUD,EAAQ,CAAC,EAAG,IAE9C,CACA,SAASE,GAAmBJ,EAAWC,EAAU/B,EAAOmC,EAAWC,EAAW5B,EAAQE,GAClF,IAAKF,IAAWE,EACZ,OAEJ,MAAMuB,EAAWlC,GAAmBH,GAAQuC,EAAW3B,GAASZ,GAAQwC,EAAW1B,GAASV,GAGxFiC,EAAWF,GACXD,EAAUjvM,KAAK,CAACovM,EAAUzB,EAAQE,GAE1C,CAGA,SAAS2B,GAAwBzuL,EAAQ8rL,EAAQvyG,EAAS6yG,EAAOwB,EAAkBj7J,KAC/E,IAAIw7J,EAAWv9K,KAAK9kB,IAAIsgM,EAAM/tM,SAAS2hB,EAAO,GAAIu5E,EAAQ,GAAG,IAAKq0G,GAClE,GAAiB,IAAbO,EACA,OAAOA,EAEX,MAAMD,EAAY,IAAInE,GAAU,CAAC,CAAC,EAAG,CAAC,EAAG/pL,EAAOvlB,OAAS,GAAI,CAAC,EAAG,KAAMixM,IACjE9C,EAAWqD,GAAe1yG,GAChC,KAAO20G,EAAUzzM,OAAS,GAAG,CACzB,MAAMi0M,EAAWR,EAAUjxI,MAC3B,GAAIyxI,EAAS,IAAMP,EACf,SAEJ,MAAMhsH,EAAQusH,EAAS,GAEjB7xJ,EAAYivJ,EA7PA,GADJ,IA+Pd,GAAIH,GAAaxpH,IAAUtlC,EAAW,CAClC,IAAK+uJ,GAAYzpH,EAAOniE,EAAOvlB,QAC3B,OAAOy+L,IAEX,GAAI4S,EAAQ,CACR,MAAMuC,EAAWhB,GAAsBrtL,EAAQmiE,EAAOoX,EAAS6yG,GAC/D,GAAIriK,MAAMskK,IAA0B,IAAbA,EACnB,OAAOA,EAEXF,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,EAClC,MAEI,IAAK,IAAI5/L,EAAI0zE,EAAM,GAAI1zE,GAAK0zE,EAAM,KAAM1zE,EAAG,CACvC,MAAM4/L,EAAWnB,GAAuBltL,EAAOvR,GAAI8qF,EAAS6yG,GAE5D,GADA+B,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,GACb,IAAbF,EACA,OAAO,CAEf,CAER,KACK,CACD,MAAMQ,EAAa9C,GAAW1pH,EAAO2pH,GACrCmC,GAAYC,EAAWC,EAAU/B,EAAOpsL,EAAQ4oL,EAAU+F,EAAW,IACrEV,GAAYC,EAAWC,EAAU/B,EAAOpsL,EAAQ4oL,EAAU+F,EAAW,GACzE,CACJ,CACA,OAAOR,CACX,CACA,SAASS,GAA2BL,EAAWM,EAASL,EAAWM,EAAS1C,EAAOwB,EAAkBj7J,KACjG,IAAIw7J,EAAWv9K,KAAK9kB,IAAI8hM,EAAiBxB,EAAM/tM,SAASkwM,EAAU,GAAIC,EAAU,KAChF,GAAiB,IAAbL,EACA,OAAOA,EAEX,MAAMD,EAAY,IAAInE,GAAU,CAAC,CAAC,EAAG,CAAC,EAAGwE,EAAU9zM,OAAS,GAAI,CAAC,EAAG+zM,EAAU/zM,OAAS,KAAMixM,IAC7F,KAAOwC,EAAUzzM,OAAS,GAAG,CACzB,MAAMi0M,EAAWR,EAAUjxI,MAC3B,GAAIyxI,EAAS,IAAMP,EACf,SAEJ,MAAMC,EAASM,EAAS,GAClBK,EAASL,EAAS,GAClBM,EAAaH,EAxSD,GADJ,IA0SRI,EAAaH,EAzSD,GADJ,IA4Sd,GAAInD,GAAayC,IAAWY,GAAcrD,GAAaoD,IAAWE,EAAY,CAC1E,IAAKrD,GAAYwC,EAAQG,EAAU9zM,SAAWmxM,GAAYmD,EAAQP,EAAU/zM,QACxE,OAAOy+L,IAEX,IAAImV,EACJ,GAAIQ,GAAWC,EACXT,EAAW3B,GAAmB6B,EAAWH,EAAQI,EAAWO,EAAQ3C,GACpE+B,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,QAE7B,GAAIQ,IAAYC,EAAS,CAC1B,MAAMI,EAAUX,EAAUjnM,MAAM8mM,EAAO,GAAIA,EAAO,GAAK,GACvD,IAAK,IAAI3/L,EAAIsgM,EAAO,GAAItgM,GAAKsgM,EAAO,KAAMtgM,EAGtC,GAFA4/L,EAAWhC,GAAoBmC,EAAU//L,GAAIygM,EAAS9C,GACtD+B,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,GACb,IAAbF,EACA,OAAOA,CAGnB,MACK,IAAKU,GAAWC,EAAS,CAC1B,MAAMI,EAAUV,EAAUlnM,MAAMynM,EAAO,GAAIA,EAAO,GAAK,GACvD,IAAK,IAAItgM,EAAI2/L,EAAO,GAAI3/L,GAAK2/L,EAAO,KAAM3/L,EAGtC,GAFA4/L,EAAWhC,GAAoBkC,EAAU9/L,GAAIygM,EAAS9C,GACtD+B,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,GACb,IAAbF,EACA,OAAOA,CAGnB,MAEIE,EAAWtB,GAAuBwB,EAAWH,EAAQI,EAAWO,EAAQ3C,GACxE+B,EAAWv9K,KAAK9kB,IAAIqiM,EAAUE,EAEtC,KACK,CACD,MAAMM,EAAa9C,GAAWuC,EAAQS,GAChCM,EAAatD,GAAWkD,EAAQD,GACtCR,GAAmBJ,EAAWC,EAAU/B,EAAOmC,EAAWC,EAAWG,EAAW,GAAIQ,EAAW,IAC/Fb,GAAmBJ,EAAWC,EAAU/B,EAAOmC,EAAWC,EAAWG,EAAW,GAAIQ,EAAW,IAC/Fb,GAAmBJ,EAAWC,EAAU/B,EAAOmC,EAAWC,EAAWG,EAAW,GAAIQ,EAAW,IAC/Fb,GAAmBJ,EAAWC,EAAU/B,EAAOmC,EAAWC,EAAWG,EAAW,GAAIQ,EAAW,GACnG,CACJ,CACA,OAAOhB,CACX,CAqDA,SAASiB,GAA0Bn1L,EAAKuvL,GACpC,MAAMG,EAAc1vL,EAAIjS,WACxB,GAA2B,IAAvB2hM,EAAYlvM,QAA0C,IAA1BkvM,EAAY,GAAGlvM,OAC3C,OAAOy+L,IAEX,MAAM8O,EAtiBV,SAAuBJ,EAAOyH,GAE1B,GADYzH,EAAMntM,QACP,EACP,MAAO,CAACmtM,GACZ,MAAMI,EAAW,GACjB,IAAIzuG,EACA+1G,EACJ,IAAK,MAAMvyD,KAAQ6qD,EAAO,CACtB,MAAMllI,EAAOgoI,GAAoB3tD,GACpB,IAATr6E,IAEJq6E,EAAKr6E,KAAO9xC,KAAK2X,IAAIm6B,QACTlpD,IAAR81L,IACAA,EAAM5sI,EAAO,GACb4sI,IAAQ5sI,EAAO,GACX62B,GACAyuG,EAAS/oM,KAAKs6F,GAClBA,EAAU,CAACwjD,IAGXxjD,EAAQt6F,KAAK89I,GAErB,CAKA,GAJIxjD,GACAyuG,EAAS/oM,KAAKs6F,GAGd81G,EAAW,EACX,IAAK,IAAIpvL,EAAI,EAAGA,EAAI+nL,EAASvtM,OAAQwlB,IAC7B+nL,EAAS/nL,GAAGxlB,QAAU40M,IAE1BhF,GAAYrC,EAAS/nL,GAAIovL,EAAU,EAAGrH,EAAS/nL,GAAGxlB,OAAS,EAAGgwM,IAC9DzC,EAAS/nL,GAAK+nL,EAAS/nL,GAAG3Y,MAAM,EAAG+nM,IAG3C,OAAOrH,CACX,CAkgBqBuH,CAAc5F,EAAa,GAAGrqM,KAAIi6F,GACxCA,EAAQj6F,KAAIy9I,GACRA,EAAKz9I,KAAI+1C,GAAKgxJ,GAAuB,CAAChxJ,EAAE12C,EAAG02C,EAAEz2C,GAAIqb,EAAIskL,iBAG9D6N,EAAQ,IAAItB,GAAW9C,EAAS,GAAG,GAAG,GAAG,IAC/C,IAAI1sH,EAAO3oC,IACX,IAAK,MAAM3qC,KAAYwhM,EACnB,IAAK,MAAMjwG,KAAWyuG,EAAU,CAC5B,OAAQhgM,EAASzC,MACb,IAAK,QACD+1E,EAAO1qD,KAAK9kB,IAAIwvE,EAAMmzH,GAAwB,CAACzmM,EAASujF,cAAc,EAAOgO,EAAS6yG,EAAO9wH,IAC7F,MACJ,IAAK,aACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMmzH,GAAwBzmM,EAASujF,aAAa,EAAMgO,EAAS6yG,EAAO9wH,IAC1F,MACJ,IAAK,UACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMmyH,GAAyBl0G,EAASvxF,EAASujF,YAAa6gH,EAAO9wH,IAG7F,GAAa,IAATA,EACA,OAAOA,CAEf,CAEJ,OAAOA,CACX,CACA,SAASk0H,GAAiBxnM,GACtB,MAAsB,iBAAlBA,EAASzC,KACFyC,EAASujF,YAAYjsF,KAAIi6F,IACrB,CACHh0F,KAAM,UACNgmF,YAAagO,MAIH,oBAAlBvxF,EAASzC,KACFyC,EAASujF,YAAYjsF,KAAImwM,IACrB,CACHlqM,KAAM,aACNgmF,YAAakkH,MAIH,eAAlBznM,EAASzC,KACFyC,EAASujF,YAAYjsF,KAAI7B,IACrB,CACH8H,KAAM,QACNgmF,YAAa9tF,MAIlB,CAACuK,EACZ,CACA,MAAM0nM,GACF,WAAAjxM,CAAY0mK,EAASqkC,GACjBnwM,KAAKkM,KAAOsmL,EACZxyL,KAAK8rK,QAAUA,EACf9rK,KAAKmwM,WAAaA,CACtB,CACA,YAAO1sM,CAAM0K,EAAMpD,GACf,GAAoB,IAAhBoD,EAAK/M,OACL,OAAO2J,EAAQrK,MAAM,kEAAkEyN,EAAK/M,OAAS,cACzG,GAAIsiM,GAAQv1L,EAAK,IAAK,CAClB,MAAM29J,EAAU39J,EAAK,GACrB,GAAqB,sBAAjB29J,EAAQ5/J,KACR,OAAO,IAAImqM,GAASvqC,EAASA,EAAQj8E,SAAS5pF,KAAI6yB,GAAWq9K,GAAiBr9K,EAAQnqB,YAAWu1G,QAEhG,GAAqB,YAAjB4nD,EAAQ5/J,KACb,OAAO,IAAImqM,GAASvqC,EAASqqC,GAAiBrqC,EAAQn9J,WAErD,GAAI,SAAUm9J,GAAW,gBAAiBA,EAC3C,OAAO,IAAIuqC,GAASvqC,EAASqqC,GAAiBrqC,GAEtD,CACA,OAAO/gK,EAAQrK,MAAM,2FACzB,CACA,QAAAsjM,CAASpjL,GACL,GAAsB,MAAlBA,EAAIjS,YAA2C,MAArBiS,EAAIwkL,cAAuB,CACrD,GAA2B,UAAvBxkL,EAAIukL,eACJ,OAzIhB,SAAiCvkL,EAAKuvL,GAClC,MAAMN,EAAajvL,EAAIjS,WACjB2nM,EAAgBzG,EAAW3rF,OAAOj+G,KAAI+1C,GAAKgxJ,GAAuB,CAAChxJ,EAAE12C,EAAG02C,EAAEz2C,GAAIqb,EAAIskL,aACxF,GAA0B,IAAtB2K,EAAWzuM,OACX,OAAOy+L,IAEX,MAAMkT,EAAQ,IAAItB,GAAW6E,EAAc,GAAG,IAC9C,IAAIr0H,EAAO3oC,IACX,IAAK,MAAM3qC,KAAYwhM,EAAY,CAC/B,OAAQxhM,EAASzC,MACb,IAAK,QACD+1E,EAAO1qD,KAAK9kB,IAAIwvE,EAAMszH,GAA2Be,GAAe,EAAO,CAAC3nM,EAASujF,cAAc,EAAO6gH,EAAO9wH,IAC7G,MACJ,IAAK,aACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMszH,GAA2Be,GAAe,EAAO3nM,EAASujF,aAAa,EAAM6gH,EAAO9wH,IAC1G,MACJ,IAAK,UACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMmzH,GAAwBkB,GAAe,EAAO3nM,EAASujF,YAAa6gH,EAAO9wH,IAGzG,GAAa,IAATA,EACA,OAAOA,CAEf,CACA,OAAOA,CACX,CAgHuBs0H,CAAwB31L,EAAK5gB,KAAKmwM,YAExC,GAA2B,eAAvBvvL,EAAIukL,eACT,OAlHhB,SAAsCvkL,EAAKuvL,GACvC,MAAMF,EAAWrvL,EAAIjS,WACf6nM,EAAgBvG,EAAS/rF,OAAOj+G,KAAI+1C,GAAKgxJ,GAAuB,CAAChxJ,EAAE12C,EAAG02C,EAAEz2C,GAAIqb,EAAIskL,aACtF,GAAwB,IAApB+K,EAAS7uM,OACT,OAAOy+L,IAEX,MAAMkT,EAAQ,IAAItB,GAAW+E,EAAc,GAAG,IAC9C,IAAIv0H,EAAO3oC,IACX,IAAK,MAAM3qC,KAAYwhM,EAAY,CAC/B,OAAQxhM,EAASzC,MACb,IAAK,QACD+1E,EAAO1qD,KAAK9kB,IAAIwvE,EAAMszH,GAA2BiB,GAAe,EAAM,CAAC7nM,EAASujF,cAAc,EAAO6gH,EAAO9wH,IAC5G,MACJ,IAAK,aACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMszH,GAA2BiB,GAAe,EAAM7nM,EAASujF,aAAa,EAAM6gH,EAAO9wH,IACzG,MACJ,IAAK,UACDA,EAAO1qD,KAAK9kB,IAAIwvE,EAAMmzH,GAAwBoB,GAAe,EAAM7nM,EAASujF,YAAa6gH,EAAO9wH,IAGxG,GAAa,IAATA,EACA,OAAOA,CAEf,CACA,OAAOA,CACX,CAyFuBw0H,CAA6B71L,EAAK5gB,KAAKmwM,YAE7C,GAA2B,YAAvBvvL,EAAIukL,eACT,OAAO4Q,GAA0Bn1L,EAAK5gB,KAAKmwM,WAEnD,CACA,OAAOtQ,GACX,CACA,SAAAoE,GAAc,CACd,aAAAC,GACI,OAAO,CACX,EAGJ,MAAMwS,GAAgB,CAElB,KAAMlL,GACN,KAAMC,GACN,IAAKE,GACL,IAAKD,GACL,KAAMG,GACN,KAAMD,GACN,MAAStH,GACT,GAAMgC,GACN,QAAWhC,GACX,KAAQgD,GACR,SAAYoD,GACZ,SAAYoB,GACZ,OAAUO,GACV,MAASK,GACT,GAAMnG,GACN,WAAYG,GACZ,YAAekD,GACf,kBAAmBA,GACnB,kBAAmBA,GACnB,OAAUgD,GACV,IAAO1G,GACP,QAAWpC,GACX,MAAS+C,GACT,OAAUvC,GACV,gBAAiByH,GACjB,OAAUzH,GACV,MAASkD,GACT,KAAQS,GACR,OAAU3D,GACV,aAAcC,GACd,WAAYA,GACZ,YAAaA,GACb,YAAaA,GACb,IAAO6B,GACP,OAAU8J,GACV,SAAYmG,IAGhB,MAAMM,GACF,WAAAvxM,CAAYiD,EAAM6D,EAAM83L,EAAU71L,GAC9BnO,KAAKqI,KAAOA,EACZrI,KAAKkM,KAAOA,EACZlM,KAAK42M,UAAY5S,EACjBhkM,KAAKmO,KAAOA,CAChB,CACA,QAAA61L,CAASpjL,GACL,OAAO5gB,KAAK42M,UAAUh2L,EAAK5gB,KAAKmO,KACpC,CACA,SAAA81L,CAAU5wJ,GACNrzC,KAAKmO,KAAKvE,QAAQypC,EACtB,CACA,aAAA6wJ,GACI,OAAO,CACX,CACA,YAAOzgM,CAAM0K,EAAMpD,GACf,MAAM+6L,EAAK33L,EAAK,GACV88K,EAAa0rB,GAAmBE,YAAY/Q,GAClD,IAAK7a,EACD,OAAOlgL,EAAQrK,MAAM,uBAAuBolM,6DAA+D,GAG/G,MAAM55L,EAAO1C,MAAM4E,QAAQ68K,GACvBA,EAAW,GAAKA,EAAW/+K,KACzB4qM,EAAqBttM,MAAM4E,QAAQ68K,GACrC,CAAC,CAACA,EAAW,GAAIA,EAAW,KAC5BA,EAAW8rB,UACTA,EAAYD,EAAmBrnM,QAAO,EAAEunM,MAAiBxtM,MAAM4E,QAAQ4oM,IACzEA,EAAU51M,SAAW+M,EAAK/M,OAAS,IAEvC,IAAI61M,EAAmB,KACvB,IAAK,MAAOjpM,EAAQg2L,KAAa+S,EAAW,CAGxCE,EAAmB,IAAI3R,GAAev6L,EAAQw6L,SAAU2R,GAAsBnsM,EAAQq8C,KAAM,KAAMr8C,EAAQhL,OAG1G,MAAM4qM,EAAa,GACnB,IAAIwM,GAAiB,EACrB,IAAK,IAAI/hM,EAAI,EAAGA,EAAIjH,EAAK/M,OAAQgU,IAAK,CAClC,MAAM89J,EAAM/kK,EAAKiH,GACX2uL,EAAev6L,MAAM4E,QAAQJ,GAC/BA,EAAOoH,EAAI,GACXpH,EAAO9B,KACLiiC,EAAS8oK,EAAiBxzM,MAAMyvK,EAAK,EAAIy3B,EAAWvpM,OAAQ2iM,GAClE,IAAK51J,EAAQ,CACTgpK,GAAiB,EACjB,KACJ,CACAxM,EAAW/kM,KAAKuoC,EACpB,CACA,IAAIgpK,EAKJ,GAAI3tM,MAAM4E,QAAQJ,IACVA,EAAO5M,SAAWupM,EAAWvpM,OAC7B61M,EAAiBv2M,MAAM,YAAYsN,EAAO5M,+BAA+BupM,EAAWvpM,uBAF5F,CAMA,IAAK,IAAIgU,EAAI,EAAGA,EAAIu1L,EAAWvpM,OAAQgU,IAAK,CACxC,MAAMq+K,EAAWjqL,MAAM4E,QAAQJ,GAAUA,EAAOoH,GAAKpH,EAAO9B,KACtDgnK,EAAMy3B,EAAWv1L,GACvB6hM,EAAiB1mL,OAAOnb,EAAI,GAAGo+K,aAAaC,EAAUvgB,EAAIhnK,KAC9D,CACA,GAAuC,IAAnC+qM,EAAiBn2I,OAAO1/D,OACxB,OAAO,IAAIu1M,GAAmB7Q,EAAI55L,EAAM83L,EAAU2G,EAPtD,CASJ,CACA,GAAyB,IAArBoM,EAAU31M,OACV2J,EAAQ+1D,OAAOl7D,QAAQqxM,EAAiBn2I,YAEvC,CACD,MACMs2I,GADWL,EAAU31M,OAAS21M,EAAYD,GAE3C7wM,KAAI,EAAE+H,MAAYqpM,OA4ePL,EA5e0BhpM,EA6e9CxE,MAAM4E,QAAQ4oM,GACP,IAAIA,EAAU/wM,IAAIqtL,IAAcxtL,KAAK,SAGrC,IAAIwtL,GAAa0jB,EAAU9qM,YAL1C,IAA4B8qM,CA5eiC,IAC5ClxM,KAAK,OACJwxM,EAAc,GAGpB,IAAK,IAAIliM,EAAI,EAAGA,EAAIjH,EAAK/M,OAAQgU,IAAK,CAClC,MAAM+4B,EAASpjC,EAAQtH,MAAM0K,EAAKiH,GAAI,EAAIkiM,EAAYl2M,QACtD,IAAK+sC,EACD,OAAO,KACXmpK,EAAY1xM,KAAK0tL,GAAanlJ,EAAOjiC,MACzC,CACAnB,EAAQrK,MAAM,8BAA8B02M,iBAA0BE,EAAYxxM,KAAK,kBAC3F,CACA,OAAO,IACX,CACA,eAAOyxM,CAAShS,EAAUsR,GACtBF,GAAmBE,YAAcA,EACjC,IAAK,MAAMxuM,KAAQwuM,EACftR,EAASl9L,GAAQsuM,EAEzB,EAEJ,SAASzoK,GAAKttB,GAAMytB,EAAG/I,EAAG9qB,EAAGD,IACzB8zB,EAAIA,EAAE21J,SAASpjL,GACf0kB,EAAIA,EAAE0+J,SAASpjL,GACfpG,EAAIA,EAAEwpL,SAASpjL,GACf,MAAMmtB,EAAQxzB,EAAIA,EAAEypL,SAASpjL,GAAO,EAC9BlgB,EAAQ+iM,GAAap1J,EAAG/I,EAAG9qB,EAAGuzB,GACpC,GAAIrtC,EACA,MAAM,IAAIgiM,GAAahiM,GAC3B,OAAO,IAAIgZ,GAAM20B,EAAI,IAAK/I,EAAI,IAAK9qB,EAAI,IAAKuzB,GAAO,EACvD,CACA,SAAS0iJ,GAAI3pL,EAAKsJ,GACd,OAAOtJ,KAAOsJ,CAClB,CACA,SAASomB,GAAI1vB,EAAKsJ,GACd,MAAMlK,EAAIkK,EAAItJ,GACd,YAAoB,IAANZ,EAAoB,KAAOA,CAC7C,CAaA,SAASsxM,GAAQtrM,GACb,MAAO,CAAEA,OACb,CA+bA,SAASgrM,GAAqBjoB,GAC1B,GAAIA,aAAsBmX,GACtB,OAAO8Q,GAAqBjoB,EAAWoX,iBAEtC,GAAIpX,aAAsB0nB,IAA0C,UAApB1nB,EAAW5mL,KAC5D,OAAO,EAEN,GAAI4mL,aAAsB6c,GAI3B,OAAO,EAEN,GAAI7c,aAAsBihB,GAC3B,OAAO,EAEN,GAAIjhB,aAAsBonB,GAC3B,OAAO,EAEX,MAAMoB,EAAmBxoB,aAAsBsV,IAC3CtV,aAAsBqV,GAC1B,IAAIoT,GAAmB,EAevB,OAdAzoB,EAAWgV,WAAU/4J,IAQbwsK,EADAD,EACmBC,GAAoBR,GAAqBhsK,GAGzCwsK,GAAoBxsK,aAAiB44J,EAC5D,MAEC4T,IAGEC,GAAkB1oB,IACrB2oB,GAAyB3oB,EAAY,CAAC,OAAQ,kBAAmB,gBAAiB,cAAe,wBACzG,CACA,SAAS0oB,GAAkB11M,GACvB,GAAIA,aAAa00M,GAAoB,CACjC,GAAe,QAAX10M,EAAEoG,MAAoC,IAAlBpG,EAAEkM,KAAK/M,OAC3B,OAAO,EAEN,GAAe,kBAAXa,EAAEoG,KACP,OAAO,EAEN,GAAe,QAAXpG,EAAEoG,MAAoC,IAAlBpG,EAAEkM,KAAK/M,OAChC,OAAO,EAEN,GAAe,eAAXa,EAAEoG,MACI,kBAAXpG,EAAEoG,MACS,OAAXpG,EAAEoG,KACF,OAAO,EAEN,GAAI,WAAWuL,KAAK3R,EAAEoG,MACvB,OAAO,CAEf,CACA,GAAIpG,aAAaiuM,GACb,OAAO,EAEX,GAAIjuM,aAAao0M,GACb,OAAO,EAEX,IAAIprM,GAAS,EAMb,OALAhJ,EAAEgiM,WAAU/wB,IACJjoK,IAAW0sM,GAAkBzkC,KAC7BjoK,GAAS,EACb,IAEGA,CACX,CACA,SAAS4sM,GAAgB51M,GACrB,GAAIA,aAAa00M,IACE,kBAAX10M,EAAEoG,KACF,OAAO,EAGf,IAAI4C,GAAS,EAMb,OALAhJ,EAAEgiM,WAAU/wB,IACJjoK,IAAW4sM,GAAgB3kC,KAC3BjoK,GAAS,EACb,IAEGA,CACX,CACA,SAAS2sM,GAAyB31M,EAAGivK,GACjC,GAAIjvK,aAAa00M,IAAsBzlC,EAAWz3J,QAAQxX,EAAEoG,OAAS,EACjE,OAAO,EAEX,IAAI4C,GAAS,EAMb,OALAhJ,EAAEgiM,WAAW/wB,IACLjoK,IAAW2sM,GAAyB1kC,EAAKhC,KACzCjmK,GAAS,EACb,IAEGA,CACX,CAEA,SAASO,GAAQzE,GACb,MAAO,CAAEkE,OAAQ,UAAWlE,QAChC,CACA,SAASrG,GAAMqG,GACX,MAAO,CAAEkE,OAAQ,QAASlE,QAC9B,CAEA,SAAS+wM,GAA2BC,GAChC,MAAiC,gBAA1BA,EAAK,kBAAgE,4BAA1BA,EAAK,gBAC3D,CACA,SAASC,GAAuBD,GAC5B,QAASA,EAAK9oB,YAAc8oB,EAAK9oB,WAAWE,WAAW11K,QAAQ,SAAW,CAC9E,CACA,SAASw+L,GAAsBF,GAC3B,QAASA,EAAK9oB,YAAc8oB,EAAK9oB,WAAWC,YAChD,CAEA,SAASx1J,GAAQtgB,GACb,OAAIA,aAAem0B,OACR,SAEFn0B,aAAe8oD,OACb,SAEF9oD,aAAeiuK,QACb,UAEF79K,MAAM4E,QAAQgL,GACZ,QAEM,OAARA,EACE,cAGOA,CAEtB,CAEA,SAAS8+L,GAAanxM,GAClB,MAAwB,iBAAVA,GAAgC,OAAVA,IAAmByC,MAAM4E,QAAQrH,EACzE,CA7kBA4vM,GAAmBY,SAASb,GAAe,CACvC,MAAS,CAn9HK,CAAE3uK,KAAM,SAq9HlB,CAAC0qJ,GACD,CAAC7xK,GAAM1a,MAAS,MAAM,IAAIw8L,GAAax8L,EAAE89L,SAASpjL,GAAK,GAE3D,OAAU,CACN6xK,EACA,CAACK,GACD,CAAClyK,GAAM1a,KAAOotL,GAAasQ,GAAO19L,EAAE89L,SAASpjL,MAEjD,UAAW,CACPkU,GAAM09J,EAAY,GAClB,CAACG,GACD,CAAC/xK,GAAM1a,MACH,MAAOmoC,EAAG/I,EAAG9qB,EAAGD,GAAKrU,EAAE89L,SAASpjL,GAAK0tB,IACrC,MAAO,CAAK,IAAJD,EAAa,IAAJ/I,EAAa,IAAJ9qB,EAASD,EAAE,GAG7C,IAAO,CACHo4K,EACA,CAACH,EAAYA,EAAYA,GACzBtkJ,IAEJ,KAAQ,CACJykJ,EACA,CAACH,EAAYA,EAAYA,EAAYA,GACrCtkJ,IAEJ,IAAO,CACHhiC,KAAMwmL,EACNqkB,UAAW,CACP,CACI,CAACtkB,GACD,CAAC7xK,GAAM9Z,KAAS2pL,GAAI3pL,EAAIk9L,SAASpjL,GAAMA,EAAIswJ,eAC5C,CACC,CAACuhB,EAAYI,GACb,CAACjyK,GAAM9Z,EAAKsJ,KAASqgL,GAAI3pL,EAAIk9L,SAASpjL,GAAMxQ,EAAI4zL,SAASpjL,OAIrE,IAAO,CACH1U,KAAM4mL,EACNikB,UAAW,CACP,CACI,CAACtkB,GACD,CAAC7xK,GAAM9Z,KAAS0vB,GAAI1vB,EAAIk9L,SAASpjL,GAAMA,EAAIswJ,eAC5C,CACC,CAACuhB,EAAYI,GACb,CAACjyK,GAAM9Z,EAAKsJ,KAASomB,GAAI1vB,EAAIk9L,SAASpjL,GAAMxQ,EAAI4zL,SAASpjL,OAIrE,gBAAiB,CACbkyK,EACA,CAACL,GACD,CAAC7xK,GAAM9Z,KAAS0vB,GAAI1vB,EAAIk9L,SAASpjL,GAAMA,EAAIkkL,cAAgB,CAAC,IAEhE,WAAc,CACVjS,EACA,GACCjyK,GAAQA,EAAIswJ,cAEjB,gBAAiB,CACbuhB,EACA,GACC7xK,GAAQA,EAAIukL,gBAEjB,GAAM,CACFrS,EACA,GACClyK,GAAQA,EAAI1c,MAEjB,KAAQ,CACJsuL,EACA,GACC5xK,GAAQA,EAAIikL,QAAQ9Y,MAEzB,kBAAmB,CACfyG,EACA,GACC5xK,GAAQA,EAAIikL,QAAQsT,gBAAkB,GAE3C,gBAAiB,CACb3lB,EACA,GACC5xK,GAAQA,EAAIikL,QAAQuT,cAAgB,GAEzC,YAAe,CACXtlB,EACA,GACClyK,QAAoCT,IAA5BS,EAAIikL,QAAQwT,YAA4B,KAAOz3L,EAAIikL,QAAQwT,aAExE,IAAK,CACD7lB,EACAglB,GAAQhlB,GACR,CAAC5xK,EAAKzS,KACF,IAAIlD,EAAS,EACb,IAAK,MAAMioK,KAAO/kK,EACdlD,GAAUioK,EAAI8wB,SAASpjL,GAE3B,OAAO3V,CAAM,GAGrB,IAAK,CACDunL,EACAglB,GAAQhlB,GACR,CAAC5xK,EAAKzS,KACF,IAAIlD,EAAS,EACb,IAAK,MAAMioK,KAAO/kK,EACdlD,GAAUioK,EAAI8wB,SAASpjL,GAE3B,OAAO3V,CAAM,GAGrB,IAAK,CACDiB,KAAMsmL,EACNukB,UAAW,CACP,CACI,CAACvkB,EAAYA,GACb,CAAC5xK,GAAMrG,EAAGC,KAAOD,EAAEypL,SAASpjL,GAAOpG,EAAEwpL,SAASpjL,IAC/C,CACC,CAAC4xK,GACD,CAAC5xK,GAAMrG,MAAQA,EAAEypL,SAASpjL,MAItC,IAAK,CACD4xK,EACA,CAACA,EAAYA,GACb,CAAC5xK,GAAMrG,EAAGC,KAAOD,EAAEypL,SAASpjL,GAAOpG,EAAEwpL,SAASpjL,IAElD,IAAK,CACD4xK,EACA,CAACA,EAAYA,GACb,CAAC5xK,GAAMrG,EAAGC,KAAOD,EAAEypL,SAASpjL,GAAOpG,EAAEwpL,SAASpjL,IAElD,IAAO,CACH4xK,EACA,GACA,IAAMj7J,KAAK+gL,KAEf,GAAM,CACF9lB,EACA,GACA,IAAMj7J,KAAK3F,IAEf,EAAK,CACD4gK,EACA,GACA,IAAMj7J,KAAKghL,GAEf,IAAK,CACD/lB,EACA,CAACA,EAAYA,GACb,CAAC5xK,GAAMpG,EAAGvY,KAAOs1B,KAAK8X,IAAI70B,EAAEwpL,SAASpjL,GAAM3e,EAAE+hM,SAASpjL,KAE1D,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAMtb,KAAOiyB,KAAKsjB,KAAKv1C,EAAE0+L,SAASpjL,KAEvC,MAAS,CACL4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAK70B,IAAIinB,EAAEq6K,SAASpjL,IAAQ2W,KAAKihL,MAEnD,GAAM,CACFhmB,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAK70B,IAAIinB,EAAEq6K,SAASpjL,KAEtC,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAK70B,IAAIinB,EAAEq6K,SAASpjL,IAAQ2W,KAAK+gL,KAEnD,IAAO,CACH9lB,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKupK,IAAIn3K,EAAEq6K,SAASpjL,KAEtC,IAAO,CACH4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKspK,IAAIl3K,EAAEq6K,SAASpjL,KAEtC,IAAO,CACH4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKqnK,IAAIj1K,EAAEq6K,SAASpjL,KAEtC,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKkhL,KAAK9uL,EAAEq6K,SAASpjL,KAEvC,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKmhL,KAAK/uL,EAAEq6K,SAASpjL,KAEvC,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAK61K,KAAKzjL,EAAEq6K,SAASpjL,KAEvC,IAAO,CACH4xK,EACAglB,GAAQhlB,GACR,CAAC5xK,EAAKzS,IAASopB,KAAK9kB,OAAOtE,EAAKlI,KAAIitK,GAAOA,EAAI8wB,SAASpjL,OAE5D,IAAO,CACH4xK,EACAglB,GAAQhlB,GACR,CAAC5xK,EAAKzS,IAASopB,KAAK5kB,OAAOxE,EAAKlI,KAAIitK,GAAOA,EAAI8wB,SAASpjL,OAE5D,IAAO,CACH4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAK2X,IAAIvlB,EAAEq6K,SAASpjL,KAEtC,MAAS,CACL4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,MACH,MAAMzjB,EAAIyjB,EAAEq6K,SAASpjL,GAIrB,OAAO1a,EAAI,GAAKqxB,KAAKC,OAAOtxB,GAAKqxB,KAAKC,MAAMtxB,EAAE,GAGtD,MAAS,CACLssL,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKyR,MAAMrf,EAAEq6K,SAASpjL,KAExC,KAAQ,CACJ4xK,EACA,CAACA,GACD,CAAC5xK,GAAM+I,KAAO4N,KAAKiY,KAAK7lB,EAAEq6K,SAASpjL,KAEvC,YAAa,CACT8xK,EACA,CAACD,EAAYK,GACb,CAAClyK,GAAMjb,EAAGO,KAAO0a,EAAIswJ,aAAavrK,EAAEoB,SAAWb,EAAEa,OAErD,eAAgB,CACZ2rL,EACA,CAACI,GACD,CAAClyK,GAAM1a,KAAO0a,EAAI1c,OAASgC,EAAEa,OAEjC,iBAAkB,CACd2rL,EACA,CAACD,GACD,CAAC7xK,GAAM1a,KAAO0a,EAAIukL,iBAAmBj/L,EAAEa,OAE3C,WAAY,CACR2rL,EACA,CAACD,EAAYK,GACb,CAAClyK,GAAMjb,EAAGO,MACN,MAAMqU,EAAIqG,EAAIswJ,aAAavrK,EAAEoB,OACvByT,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,EAAIC,CAAC,GAG7C,cAAe,CACXk4K,EACA,CAACI,GACD,CAAClyK,GAAM1a,MACH,MAAMqU,EAAIqG,EAAI1c,KACRsW,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,EAAIC,CAAC,GAG7C,WAAY,CACRk4K,EACA,CAACD,EAAYK,GACb,CAAClyK,GAAMjb,EAAGO,MACN,MAAMqU,EAAIqG,EAAIswJ,aAAavrK,EAAEoB,OACvByT,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,EAAIC,CAAC,GAG7C,cAAe,CACXk4K,EACA,CAACI,GACD,CAAClyK,GAAM1a,MACH,MAAMqU,EAAIqG,EAAI1c,KACRsW,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,EAAIC,CAAC,GAG7C,YAAa,CACTk4K,EACA,CAACD,EAAYK,GACb,CAAClyK,GAAMjb,EAAGO,MACN,MAAMqU,EAAIqG,EAAIswJ,aAAavrK,EAAEoB,OACvByT,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,GAAKC,CAAC,GAG9C,eAAgB,CACZk4K,EACA,CAACI,GACD,CAAClyK,GAAM1a,MACH,MAAMqU,EAAIqG,EAAI1c,KACRsW,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,GAAKC,CAAC,GAG9C,YAAa,CACTk4K,EACA,CAACD,EAAYK,GACb,CAAClyK,GAAMjb,EAAGO,MACN,MAAMqU,EAAIqG,EAAIswJ,aAAavrK,EAAEoB,OACvByT,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,GAAKC,CAAC,GAG9C,eAAgB,CACZk4K,EACA,CAACI,GACD,CAAClyK,GAAM1a,MACH,MAAMqU,EAAIqG,EAAI1c,KACRsW,EAAItU,EAAEa,MACZ,cAAcwT,UAAaC,GAAKD,GAAKC,CAAC,GAG9C,aAAc,CACVk4K,EACA,CAACI,GACD,CAAClyK,GAAMjb,KAAOA,EAAEoB,SAAS6Z,EAAIswJ,cAEjC,gBAAiB,CACbwhB,EACA,GACC9xK,GAAsB,OAAbA,EAAI1c,WAA8Bic,IAAbS,EAAI1c,MAEvC,iBAAkB,CACdwuL,EACA,CAAC59J,GAAM29J,IACP,CAAC7xK,GAAM1a,KAAOA,EAAEa,MAAM0S,QAAQmH,EAAIukL,iBAAmB,GAEzD,eAAgB,CACZzS,EACA,CAAC59J,GAAMg+J,IACP,CAAClyK,GAAM1a,KAAOA,EAAEa,MAAM0S,QAAQmH,EAAI1c,OAAS,GAE/C,kBAAmB,CACfwuL,EACA,CAACD,EAAY39J,GAAMg+J,IAEnB,CAAClyK,GAAMjb,EAAGO,KAAOA,EAAEa,MAAM0S,QAAQmH,EAAIswJ,aAAavrK,EAAEoB,SAAW,GAEnE,kBAAmB,CACf2rL,EACA,CAACD,EAAY39J,GAAMg+J,IAEnB,CAAClyK,GAAMjb,EAAGO,KAvXlB,SAAsBA,EAAGqU,EAAGnF,EAAGwR,GAC3B,KAAOxR,GAAKwR,GAAG,CACX,MAAMwnB,EAAKh5B,EAAIwR,GAAM,EACrB,GAAIrM,EAAE6zB,KAAOloC,EACT,OAAO,EACPqU,EAAE6zB,GAAKloC,EACP0gB,EAAIwnB,EAAI,EAERh5B,EAAIg5B,EAAI,CAChB,CACA,OAAO,CACX,CA4WyBuqK,CAAa/3L,EAAIswJ,aAAavrK,EAAEoB,OAAQb,EAAEa,MAAO,EAAGb,EAAEa,MAAM3F,OAAS,IAE1F,IAAO,CACH8K,KAAMwmL,EACNqkB,UAAW,CACP,CACI,CAACrkB,EAAaA,GACd,CAAC9xK,GAAMrG,EAAGC,KAAOD,EAAEypL,SAASpjL,IAAQpG,EAAEwpL,SAASpjL,IAEnD,CACI42L,GAAQ9kB,GACR,CAAC9xK,EAAKzS,KACF,IAAK,MAAM+kK,KAAO/kK,EACd,IAAK+kK,EAAI8wB,SAASpjL,GACd,OAAO,EAEf,OAAO,CAAI,KAK3B,IAAO,CACH1U,KAAMwmL,EACNqkB,UAAW,CACP,CACI,CAACrkB,EAAaA,GACd,CAAC9xK,GAAMrG,EAAGC,KAAOD,EAAEypL,SAASpjL,IAAQpG,EAAEwpL,SAASpjL,IAEnD,CACI42L,GAAQ9kB,GACR,CAAC9xK,EAAKzS,KACF,IAAK,MAAM+kK,KAAO/kK,EACd,GAAI+kK,EAAI8wB,SAASpjL,GACb,OAAO,EAEf,OAAO,CAAK,KAK5B,IAAK,CACD8xK,EACA,CAACA,GACD,CAAC9xK,GAAMpG,MAAQA,EAAEwpL,SAASpjL,IAE9B,sBAAuB,CACnB8xK,EACA,CAACD,GAED,CAAC7xK,GAAM8uB,MACH,MAAMkpK,EAAoBh4L,EAAIikL,SAAWjkL,EAAIikL,QAAQ+T,kBACrD,OAAIA,GACOA,EAAkBlpK,EAAEs0J,SAASpjL,GAE7B,GAGnB,OAAU,CACN6xK,EACA,CAACA,GACD,CAAC7xK,GAAM8uB,KAAOA,EAAEs0J,SAASpjL,GAAKjW,eAElC,SAAY,CACR8nL,EACA,CAACA,GACD,CAAC7xK,GAAM8uB,KAAOA,EAAEs0J,SAASpjL,GAAK7Y,eAElC,OAAU,CACN0qL,EACA+kB,GAAQ1kB,GACR,CAAClyK,EAAKzS,IAASA,EAAKlI,KAAIitK,GAAO2wB,GAAc3wB,EAAI8wB,SAASpjL,MAAO9a,KAAK,KAE1E,kBAAmB,CACf2sL,EACA,CAACM,GACD,CAACnyK,GAAM0gL,KAAcA,EAAS0C,SAASpjL,GAAKghL,oBA8YpD,MAAMiX,GACF,WAAAzzM,CAAY6pL,EAAY6pB,GAqP5B,IAAyBf,EApPjB/3M,KAAKivL,WAAaA,EAClBjvL,KAAK+4M,gBAAkB,CAAC,EACxB/4M,KAAKg5M,WAAa,IAAIpU,GACtB5kM,KAAKi5M,cAAgBH,EAkPP,WADGf,EAjPmCe,GAkP/C5sM,MAAoBgsM,GAAaH,EAAK1vI,SAIpC,IAAI3uD,GAAM,EAAG,EAAG,EAAG,GAEP,UAAdq+L,EAAK7rM,KACHwN,GAAMjW,MAAMs0M,EAAK1vI,UAAY,KAEjB,YAAd0vI,EAAK7rM,KACHu2L,GAAQh/L,MAAMs0M,EAAK1vI,UAAY,KAEnB,mCAAd0vI,EAAK7rM,KACH22L,GAA+Bp/L,MAAMs0M,EAAK1vI,UAAY,KAE1C,yBAAd0vI,EAAK7rM,KACHs3L,GAAqB//L,MAAMs0M,EAAK1vI,UAAY,UAE7BloD,IAAjB43L,EAAK1vI,QACH,KAGA0vI,EAAK1vI,QAxQwD,KACpEroE,KAAKk5M,YAAcJ,GAAsC,SAAtBA,EAAa5sM,KAAkB4sM,EAAajhM,OAAS,IAC5F,CACA,4BAAAshM,CAA6BtU,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GAOrF,OANA/kM,KAAKg5M,WAAWnU,QAAUA,EAC1B7kM,KAAKg5M,WAAWlgL,QAAUA,EAC1B94B,KAAKg5M,WAAWlU,aAAeA,EAC/B9kM,KAAKg5M,WAAW9T,UAAYA,EAC5BllM,KAAKg5M,WAAW/T,gBAAkBA,GAAmB,KACrDjlM,KAAKg5M,WAAWjU,iBAAmBA,EAC5B/kM,KAAKivL,WAAW+U,SAAShkM,KAAKg5M,WACzC,CACA,QAAAhV,CAASa,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GACjE/kM,KAAKg5M,WAAWnU,QAAUA,EAC1B7kM,KAAKg5M,WAAWlgL,QAAUA,GAAW,KACrC94B,KAAKg5M,WAAWlU,aAAeA,GAAgB,KAC/C9kM,KAAKg5M,WAAW9T,UAAYA,EAC5BllM,KAAKg5M,WAAW/T,gBAAkBA,GAAmB,KACrDjlM,KAAKg5M,WAAWjU,iBAAmBA,GAAoB,KACvD,IACI,MAAM3rL,EAAMpZ,KAAKivL,WAAW+U,SAAShkM,KAAKg5M,YAC1C,GAAI5/L,SAAqD,iBAARA,GAAoBA,GAAQA,EACzE,OAAOpZ,KAAKi5M,cAEhB,GAAIj5M,KAAKk5M,eAAiB9/L,KAAOpZ,KAAKk5M,aAClC,MAAM,IAAIxW,GAAa,+BAA+BxhM,OAAOC,KAAKnB,KAAKk5M,aAAajzM,KAAIC,GAAK1C,KAAKqC,UAAUK,KAAIJ,KAAK,oBAAoBtC,KAAKqC,UAAUuT,eAE5J,OAAOA,CACX,CACA,MAAOnX,GAOH,OANKjC,KAAK+4M,gBAAgB92M,EAAEH,WACxB9B,KAAK+4M,gBAAgB92M,EAAEH,UAAW,EACX,oBAAZW,SACPA,QAAQ+Q,KAAKvR,EAAEH,UAGhB9B,KAAKi5M,aAChB,CACJ,EAEJ,SAASG,GAAanqB,GAClB,OAAOzlL,MAAM4E,QAAQ6gL,IAAeA,EAAW7tL,OAAS,GAC3B,iBAAlB6tL,EAAW,IAAmBA,EAAW,KAAMynB,EAC9D,CAUA,SAAS2C,GAAiBpqB,EAAY6pB,GAClC,MAAM9+H,EAAS,IAAIsrH,GAAeoR,GAAeQ,GAAsB,GAAI4B,EAyK/E,SAAyBf,GACrB,MAAMrgH,EAAQ,CACV1/E,MAAO26K,EACPyR,OAAQ3R,EACRnlJ,OAAQklJ,EACR8mB,KAAM7mB,EACN4R,QAAS3R,EACT3L,UAAWiM,EACXvL,QAASwL,EACTsmB,qBAAsB3mB,EACtB4mB,cAAetmB,EACfumB,+BAAgCtmB,IAEpC,GAAkB,UAAd4kB,EAAK7rM,KACL,OAAO4oB,GAAM4iE,EAAMqgH,EAAKhxM,QAAU+rL,EAAWilB,EAAK32M,QAEtD,OAAOs2F,EAAMqgH,EAAK7rM,KACtB,CA1L8FwtM,CAAgBZ,QAAgB34L,GAEpHguB,EAAS6rC,EAAOv2E,MAAMwrL,OAAY9uK,OAAWA,OAAWA,EAAW24L,GAAsC,WAAtBA,EAAa5sM,KAAoB,CAAE25L,eAAgB,eAAa1lL,GACzJ,OAAKguB,EAGE3iC,GAAQ,IAAIqtM,GAAgB1qK,EAAQ2qK,IAFhCp4M,GAAMs5E,EAAOlZ,OAG5B,CACA,MAAM64I,GACF,WAAAv0M,CAAY2iC,EAAMknJ,GACdjvL,KAAK+nC,KAAOA,EACZ/nC,KAAK45M,iBAAmB3qB,EACxBjvL,KAAK65M,iBAA4B,aAAT9xK,IAAwB8vK,GAAgB5oB,EAAWA,WAC/E,CACA,4BAAAkqB,CAA6BtU,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GACrF,OAAO/kM,KAAK45M,iBAAiBT,6BAA6BtU,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,EAC1H,CACA,QAAAf,CAASa,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GACjE,OAAO/kM,KAAK45M,iBAAiB5V,SAASa,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,EACtG,EAEJ,MAAM+U,GACF,WAAA10M,CAAY2iC,EAAMknJ,EAAY8qB,EAAWC,GACrCh6M,KAAK+nC,KAAOA,EACZ/nC,KAAK+5M,UAAYA,EACjB/5M,KAAK45M,iBAAmB3qB,EACxBjvL,KAAK65M,iBAA4B,WAAT9xK,IAAsB8vK,GAAgB5oB,EAAWA,YACzEjvL,KAAKg6M,kBAAoBA,CAC7B,CACA,4BAAAb,CAA6BtU,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GACrF,OAAO/kM,KAAK45M,iBAAiBT,6BAA6BtU,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,EAC1H,CACA,QAAAf,CAASa,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,GACjE,OAAO/kM,KAAK45M,iBAAiB5V,SAASa,EAAS/rK,EAASgsK,EAAcI,EAAWD,EAAiBF,EACtG,CACA,mBAAA+E,CAAoBl1L,EAAOm1L,EAAOC,GAC9B,OAAIhqM,KAAKg6M,kBACEpQ,GAAYE,oBAAoB9pM,KAAKg6M,kBAAmBplM,EAAOm1L,EAAOC,GAGtE,CAEf,EAKJ,SAASiQ,GAAyBC,EAAiBpB,GAC/C,MAAM7pB,EAAaoqB,GAAiBa,EAAiBpB,GACrD,GAA0B,UAAtB7pB,EAAWhkL,OACX,OAAOgkL,EAEX,MAAM9gJ,EAAS8gJ,EAAWloL,MAAMkoL,WAC1BkrB,EAA0BxC,GAAkBxpK,GAClD,IAAKgsK,IAA4BrC,GAA2BgB,GACxD,OAAOp4M,GAAM,CAAC,IAAIyxL,EAAuB,GAAI,oCAEjD,MAAMioB,EAAiBxC,GAAyBzpK,EAAQ,CAAC,SACzD,IAAKisK,IAAmBpC,GAAuBc,GAC3C,OAAOp4M,GAAM,CAAC,IAAIyxL,EAAuB,GAAI,oCAEjD,MAAMkoB,EAAYC,GAAcnsK,GAChC,IAAKksK,IAAcD,EACf,OAAO15M,GAAM,CAAC,IAAIyxL,EAAuB,GAAI,oGAE5C,GAAIkoB,aAAqBloB,EAC1B,OAAOzxL,GAAM,CAAC25M,IAEb,GAAIA,aAAqBzQ,KAAgBqO,GAAsBa,GAChE,OAAOp4M,GAAM,CAAC,IAAIyxL,EAAuB,GAAI,iEAEjD,IAAKkoB,EACD,OAAO7uM,GACH,IAAImuM,GADOQ,EACgB,WACA,SADYlrB,EAAWloL,QAG1D,MAAMizM,EAAoBK,aAAqBzQ,GAAcyQ,EAAUxQ,mBAAgB1pL,EACvF,OAAO3U,GACH,IAAIsuM,GADOK,EACiB,SACA,YADUlrB,EAAWloL,MAAOszM,EAAU5hM,OAAQuhM,GAElF,CAsDA,SAASM,GAAcrrB,GACnB,IAAIhkL,EAAS,KACb,GAAIgkL,aAAsBiX,GACtBj7L,EAASqvM,GAAcrrB,EAAWhkL,aAEjC,GAAIgkL,aAAsByb,IAC3B,IAAK,MAAMx3B,KAAO+b,EAAW9gL,KAEzB,GADAlD,EAASqvM,GAAcpnC,GACnBjoK,EACA,WAIFgkL,aAAsBgZ,IAAQhZ,aAAsB2a,KAC1D3a,EAAWr6K,iBAAiB+hM,IACF,SAA1B1nB,EAAWr6K,MAAMvM,OACjB4C,EAASgkL,GAEb,OAAIhkL,aAAkBknL,GAGtBlD,EAAWgV,WAAW/4J,IAClB,MAAMqvK,EAAcD,GAAcpvK,GAC9BqvK,aAAuBpoB,EACvBlnL,EAASsvM,GAEHtvM,GAAUsvM,EAChBtvM,EAAS,IAAIknL,EAAuB,GAAI,kGAEnClnL,GAAUsvM,GAAetvM,IAAWsvM,IACzCtvM,EAAS,IAAIknL,EAAuB,GAAI,2FAC5C,IAZOlnL,CAef,CA8CA,SAASuvM,GAAmB/qM,GACxB,IAAe,IAAXA,IAA8B,IAAXA,EACnB,OAAO,EAEX,IAAKjG,MAAM4E,QAAQqB,IAA6B,IAAlBA,EAAOrO,OACjC,OAAO,EAEX,OAAQqO,EAAO,IACX,IAAK,MACD,OAAOA,EAAOrO,QAAU,GAAmB,QAAdqO,EAAO,IAA8B,UAAdA,EAAO,GAC/D,IAAK,KACD,OAAOA,EAAOrO,QAAU,IAA2B,iBAAdqO,EAAO,IAAmBjG,MAAM4E,QAAQqB,EAAO,KACxF,IAAK,MACL,IAAK,OACL,IAAK,OACD,OAAO,EACX,IAAK,KACL,IAAK,KACL,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,KACD,OAAyB,IAAlBA,EAAOrO,QAAiBoI,MAAM4E,QAAQqB,EAAO,KAAOjG,MAAM4E,QAAQqB,EAAO,IACpF,IAAK,MACL,IAAK,MACD,IAAK,MAAM6qB,KAAK7qB,EAAOxB,MAAM,GACzB,IAAKusM,GAAmBlgL,IAAmB,kBAANA,EACjC,OAAO,EAGf,OAAO,EACX,QACI,OAAO,EAEnB,CACA,MAAMmgL,GAAa,CACf,KAAQ,UACR,SAAW,EACX,YAAc,EACd,gBAAiB,cACjB,WAAc,CACV,cAAgB,EAChB,WAAc,CAAC,OAAQ,aAY/B,SAASC,GAAcjrM,GACnB,GAAIA,QACA,MAAO,CAAEA,OAAQ,KAAM,EAAMkrM,cAAc,GAE1CH,GAAmB/qM,KACpBA,EAASmrM,GAAgBnrM,IAE7B,MAAMorM,EAAWxB,GAAiB5pM,EAAQgrM,IAC1C,GAAwB,UAApBI,EAAS5vM,OACT,MAAM,IAAIxL,MAAMo7M,EAAS9zM,MAAMd,KAAI0iD,GAAO,GAAGA,EAAI7hD,QAAQ6hD,EAAI7mD,YAAWgE,KAAK,OAI7E,MAAO,CAAE2J,OAAQ,CAACqrM,EAAkBhiL,EAASosK,IAAc2V,EAAS9zM,MAAMi9L,SAAS8W,EAAkBhiL,EAAS,CAAC,EAAGosK,GAC9GyV,aAFiBI,GAAetrM,GAI5C,CAEA,SAASgyL,GAAQlnL,EAAGC,GAChB,OAAOD,EAAIC,GAAK,EAAID,EAAIC,EAAI,EAAI,CACpC,CACA,SAASugM,GAAetrM,GACpB,IAAKjG,MAAM4E,QAAQqB,GACf,OAAO,EACX,GAAkB,WAAdA,EAAO,IAAiC,aAAdA,EAAO,GACjC,OAAO,EACX,IAAK,IAAIxG,EAAQ,EAAGA,EAAQwG,EAAOrO,OAAQ6H,IACvC,GAAI8xM,GAAetrM,EAAOxG,IACtB,OAAO,EAEf,OAAO,CACX,CACA,SAAS2xM,GAAgBnrM,GACrB,IAAKA,EACD,OAAO,EACX,MAAMq2L,EAAKr2L,EAAO,GAClB,GAAIA,EAAOrO,QAAU,EACjB,MAAe,QAAP0kM,EA2BhB,IAA8B3hL,EAZ1B,MAdyB,OAAP2hL,EAAckV,GAAsBvrM,EAAO,GAAIA,EAAO,GAAI,MACjE,OAAPq2L,EAAcmV,GAAgBD,GAAsBvrM,EAAO,GAAIA,EAAO,GAAI,OAC/D,MAAPq2L,GACW,MAAPA,GACO,OAAPA,GACO,OAAPA,EAAckV,GAAsBvrM,EAAO,GAAIA,EAAO,GAAIq2L,GACnD,QAAPA,GAoBc3hL,EApBsB1U,EAAOxB,MAAM,GAqBtD,CAAC,OAAOsiB,OAAOpM,EAAQle,IAAI20M,MApBX,QAAP9U,EAAe,CAAC,OAAOv1K,OAAO9gB,EAAOxB,MAAM,GAAGhI,IAAI20M,KACvC,SAAP9U,EAAgB,CAAC,OAAOv1K,OAAO9gB,EAAOxB,MAAM,GAAGhI,IAAI20M,IAAiB30M,IAAIg1M,KAC7D,OAAPnV,EAAcoV,GAAczrM,EAAO,GAAIA,EAAOxB,MAAM,IACzC,QAAP63L,EAAemV,GAAgBC,GAAczrM,EAAO,GAAIA,EAAOxB,MAAM,KAC1D,QAAP63L,EAAeqV,GAAe1rM,EAAO,IAC1B,SAAPq2L,GAAgBmV,GAAgBE,GAAe1rM,EAAO,IAG9F,CACA,SAASurM,GAAsBv6I,EAAU15D,EAAO++L,GAC5C,OAAQrlI,GACJ,IAAK,QACD,MAAO,CAAC,eAAeqlI,IAAM/+L,GACjC,IAAK,MACD,MAAO,CAAC,aAAa++L,IAAM/+L,GAC/B,QACI,MAAO,CAAC,UAAU++L,IAAMrlI,EAAU15D,GAE9C,CAIA,SAASm0M,GAAcz6I,EAAU5oD,GAC7B,GAAsB,IAAlBA,EAAOzW,OACP,OAAO,EAEX,OAAQq/D,GACJ,IAAK,QACD,MAAO,CAAC,iBAAkB,CAAC,UAAW5oD,IAC1C,IAAK,MACD,MAAO,CAAC,eAAgB,CAAC,UAAWA,IACxC,QACI,OAAIA,EAAOzW,OAAS,MAAQyW,EAAO0rC,MAAKr9C,UAAYA,UAAa2R,EAAO,KAC7D,CAAC,kBAAmB4oD,EAAU,CAAC,UAAW5oD,EAAOyC,KAAKmnL,MAGtD,CAAC,kBAAmBhhI,EAAU,CAAC,UAAW5oD,IAGjE,CACA,SAASsjM,GAAe16I,GACpB,OAAQA,GACJ,IAAK,QACD,OAAO,EACX,IAAK,MACD,MAAO,CAAC,iBACZ,QACI,MAAO,CAAC,aAAcA,GAElC,CACA,SAASw6I,GAAgBxrM,GACrB,MAAO,CAAC,IAAKA,EACjB,CA4MA,SAAS2rM,GAAer0M,GACpB,MAAwB,iBAAVA,EAAqB,CAAC,UAAWA,GAASA,CAC5D,CACA,SAASs0M,GAAgBlsB,EAAY2pB,GACjC,IAAIz+L,EAAQ80K,EAAW90K,MACvB,IAAKA,EAED,OAqBR,SAAiC80K,EAAY2pB,GACzC,MAAMtiL,EAAM,CAAC,MAAO24J,EAAW1uH,UAC/B,QAA2BtgD,IAAvBgvK,EAAW9mH,QAGX,MAA6B,WAAtBywI,EAAa5sM,KAAoB,CAAC,SAAUsqB,GAAOA,EAEzD,GAA0B,SAAtBsiL,EAAa5sM,KAClB,MAAO,CACH,QACAsqB,EACAt1B,OAAOC,KAAK23M,EAAajhM,QACzB2e,EACA24J,EAAW9mH,SAGd,CACD,MAAM4mH,EAAa,CAAuB,UAAtB6pB,EAAa5sM,KAAmB,WAAa4sM,EAAa5sM,KAAMsqB,EAAK4kL,GAAejsB,EAAW9mH,UAInH,MAH0B,UAAtBywI,EAAa5sM,MACb+iL,EAAWlpJ,OAAO,EAAG,EAAG+yK,EAAa/xM,MAAO+xM,EAAa13M,QAAU,MAEhE6tL,CACX,CACJ,CA5CeqsB,CAAwBnsB,EAAY2pB,GAE/C,MAAMyC,EAA0BlhM,GAAgC,iBAAhBA,EAAM,GAAG,GACnDmhM,EAAmBD,QAAmDp7L,IAAxBgvK,EAAW1uH,SACzDg7I,EAAgBF,IAA4BC,EAOlD,OANAnhM,EAAQA,EAAMpU,KAAKy1M,IACVF,GAAoB1C,EAAa7oB,QAA6B,iBAAZyrB,EAAK,GACjD,CAACA,EAAK,GAAIC,GAAmBD,EAAK,KAEtC,CAACA,EAAK,GAAIN,GAAeM,EAAK,OAErCH,EAyCR,SAAwCpsB,EAAY2pB,EAAcz+L,GAC9D,MAAMuhM,EAA4B,CAAC,EAC7BC,EAAuB,CAAC,EACxB9B,EAAY,GAClB,IAAK,IAAIrqK,EAAI,EAAGA,EAAIr1B,EAAMjZ,OAAQsuC,IAAK,CACnC,MAAMgsK,EAAOrhM,EAAMq1B,GACbq8I,EAAO2vB,EAAK,GAAG3vB,UACmB5rK,IAApCy7L,EAA0B7vB,KAC1B6vB,EAA0B7vB,GAAQ,CAC9BA,OACA7/K,KAAMijL,EAAWjjL,KACjBu0D,SAAU0uH,EAAW1uH,SACrB4H,QAAS8mH,EAAW9mH,SAExBwzI,EAAqB9vB,GAAQ,GAC7BguB,EAAUn0M,KAAKmmL,IAEnB8vB,EAAqB9vB,GAAMnmL,KAAK,CAAC81M,EAAK,GAAG30M,MAAO20M,EAAK,IACzD,CAKA,MAAMI,EAAeC,GAAgB,CAAC,EAAGjD,GACzC,GAAqB,gBAAjBgD,EAAgC,CAChC,MAAM7sB,EAAa,CAAC+sB,GAAuB7sB,GAAa,CAAC,UAAW,CAAC,SACrE,IAAK,MAAMrtJ,KAAKi4K,EAAW,CAEvBkC,GAAehtB,EAAYntJ,EADZo6K,GAAwBN,EAA0B95K,GAAIg3K,EAAc+C,EAAqB/5K,KAClE,EAC1C,CACA,OAAOmtJ,CACX,CACK,CACD,MAAMA,EAAa,CAAC,OAAQ,CAAC,SAC7B,IAAK,MAAMntJ,KAAKi4K,EAAW,CAEvBkC,GAAehtB,EAAYntJ,EADZo6K,GAAwBN,EAA0B95K,GAAIg3K,EAAc+C,EAAqB/5K,KAClE,EAC1C,CAEA,OADAq6K,GAAyBltB,GAClBA,CACX,CACJ,CAjFemtB,CAA+BjtB,EAAY2pB,EAAcz+L,GAE3DohM,EAwJb,SAA6BtsB,EAAY2pB,EAAcz+L,EAAOzF,EAAQ,CAAC,SACnE,MAAM1I,EAAO6vM,GAAgB5sB,EAAY2pB,GACzC,IAAI7pB,EACAotB,GAAS,EACb,GAAa,aAATnwM,EACA+iL,EAAa,CAAC,OAAQr6K,GACtBynM,GAAS,MAER,IAAa,gBAATnwM,EAKL,MAAM,IAAIzM,MAAM,+BAA+ByM,MALlB,CAC7B,MAAMukC,OAA2BtwB,IAApBgvK,EAAW1+I,KAAqB0+I,EAAW1+I,KAAO,EAC/Dw+I,EAAa,CAAC+sB,GAAuB7sB,GAAsB,IAAT1+I,EAAa,CAAC,UAAY,CAAC,cAAeA,GAAO77B,EACvG,CAGA,CACA,IAAK,MAAM8mM,KAAQrhM,EACf4hM,GAAehtB,EAAYysB,EAAK,GAAIA,EAAK,GAAIW,GAGjD,OADAF,GAAyBltB,GAClBA,CACX,CA3KeqtB,CAAoBntB,EAAY2pB,EAAcz+L,GAG9C6hM,GAAwB/sB,EAAY2pB,EAAcz+L,EAEjE,CAyBA,SAAS2hM,GAAuB7sB,GAC5B,OAAQA,EAAW4B,YACf,IAAK,MAAO,MAAO,kBACnB,IAAK,MAAO,MAAO,kBACnB,QAAS,MAAO,cAExB,CAiDA,SAASwrB,GAAYptB,EAAY2pB,GAC7B,MAAMv9L,EAAe6/L,IAPP7gM,EAO+B40K,EAAW9mH,QAPvC7tD,EAOgDs+L,EAAazwI,aANpEloD,IAAN5F,EACOA,OACD4F,IAAN3F,EACOA,OADX,IAHJ,IAAkBD,EAAGC,EAcjB,YAAqB2F,IAAjB5E,GAAoD,kBAAtBu9L,EAAa5sM,KACpC,GAEJqP,CACX,CACA,SAAS2gM,GAAwB/sB,EAAY2pB,EAAcz+L,GACvD,MAAMnO,EAAO6vM,GAAgB5sB,EAAY2pB,GACnCtiL,EAAM,CAAC,MAAO24J,EAAW1uH,UAC/B,GAAa,gBAATv0D,GAAiD,kBAAhBmO,EAAM,GAAG,GAAkB,CAC5D,MAAM40K,EAAa,CAAC,QACpB,IAAK,MAAMysB,KAAQrhM,EACf40K,EAAWrpL,KAAK,CAAC,KAAM4wB,EAAKklL,EAAK,IAAKA,EAAK,IAG/C,OADAzsB,EAAWrpL,KAAK22M,GAAYptB,EAAY2pB,IACjC7pB,CACX,CACK,GAAa,gBAAT/iL,EAAwB,CAC7B,MAAM+iL,EAAa,CAAC,QAASz4J,GAC7B,IAAK,MAAMklL,KAAQrhM,EACf4hM,GAAehtB,EAAYysB,EAAK,GAAIA,EAAK,IAAI,GAGjD,OADAzsB,EAAWrpL,KAAK22M,GAAYptB,EAAY2pB,IACjC7pB,CACX,CACK,GAAa,aAAT/iL,EAAqB,CAC1B,MAAM+iL,EAAa,CAAC,OAAQ,CAAC,SAAUz4J,IACvC,IAAK,MAAMklL,KAAQrhM,EACf4hM,GAAehtB,EAAYysB,EAAK,GAAIA,EAAK,IAAI,GAGjD,OADAS,GAAyBltB,QACK9uK,IAAvBgvK,EAAW9mH,QAAwB4mH,EAAa,CACnD,OACA,CAAC,KAAM,CAAC,SAAUz4J,GAAM,UACxBy4J,EACAmsB,GAAejsB,EAAW9mH,SAElC,CACK,GAAa,gBAATn8D,EAAwB,CAC7B,MAAMukC,OAA2BtwB,IAApBgvK,EAAW1+I,KAAqB0+I,EAAW1+I,KAAO,EACzDw+I,EAAa,CACf+sB,GAAuB7sB,GACd,IAAT1+I,EAAa,CAAC,UAAY,CAAC,cAAeA,GAC1C,CAAC,SAAUja,IAEf,IAAK,MAAMklL,KAAQrhM,EACf4hM,GAAehtB,EAAYysB,EAAK,GAAIA,EAAK,IAAI,GAEjD,YAA8Bv7L,IAAvBgvK,EAAW9mH,QAAwB4mH,EAAa,CACnD,OACA,CAAC,KAAM,CAAC,SAAUz4J,GAAM,UACxBy4J,EACAmsB,GAAejsB,EAAW9mH,SAElC,CAEI,MAAM,IAAI5oE,MAAM,kCAAkCyM,IAE1D,CAsBA,SAASiwM,GAAyBltB,GAER,SAAlBA,EAAW,IAAuC,IAAtBA,EAAW7tL,SACvC6tL,EAAWrpL,KAAK,GAChBqpL,EAAWrpL,KAAKqpL,EAAW,IAEnC,CACA,SAASgtB,GAAeO,EAAO5nM,EAAOypE,EAAQg+H,GAGtCG,EAAMp7M,OAAS,GAAKwT,IAAU4nM,EAAMA,EAAMp7M,OAAS,KAIjDi7M,GAA2B,IAAjBG,EAAMp7M,QAClBo7M,EAAM52M,KAAKgP,GAEf4nM,EAAM52M,KAAKy4E,GACf,CACA,SAAS09H,GAAgB5sB,EAAY2pB,GACjC,OAAI3pB,EAAWjjL,KACJijL,EAAWjjL,KAGX4sM,EAAa7pB,WAAWC,aAAe,cAAgB,UAEtE,CAEA,SAASysB,GAAmBjsK,GACxB,MAAMzkC,EAAS,CAAC,UACVwxM,EAAK,cACX,IAAIz1M,EAAM,EACV,IAAK,IAAI0M,EAAQ+oM,EAAG3sL,KAAK4f,GAAc,OAAVh8B,EAAgBA,EAAQ+oM,EAAG3sL,KAAK4f,GAAI,CAC7D,MAAMgtK,EAAUhtK,EAAEzhC,MAAMjH,EAAKy1M,EAAG7tI,UAAYl7D,EAAM,GAAGtS,QACrD4F,EAAMy1M,EAAG7tI,UACL8tI,EAAQt7M,OAAS,GACjB6J,EAAOrF,KAAK82M,GAChBzxM,EAAOrF,KAAK,CAAC,MAAO8N,EAAM,IAC9B,CACA,GAAsB,IAAlBzI,EAAO7J,OACP,OAAOsuC,EAEX,GAAI1oC,EAAM0oC,EAAEtuC,OACR6J,EAAOrF,KAAK8pC,EAAEzhC,MAAMjH,SAEnB,GAAsB,IAAlBiE,EAAO7J,OACZ,MAAO,CAAC,YAAa6J,EAAO,IAEhC,OAAOA,CACX,CA4IA,SAAS0xM,GAAkB/8M,GACvB,MAAMkH,EAAMlH,EAAQkH,IACd81M,EAAYh9M,EAAQmH,MAC1B,OAAI61M,EACO,CAAC,IAAI5/K,EAAgBl2B,EAAK81M,EAAW,4CAGrC,EAEf,CAGA,SAASC,GAAS91M,GACd,OAAIA,aAAiBwmC,QAAUxmC,aAAiBm7D,QAAUn7D,aAAiBsgL,QAChEtgL,EAAM+1M,UAGN/1M,CAEf,CACA,SAASg2M,GAAah2M,GAClB,GAAIyC,MAAM4E,QAAQrH,GACd,OAAOA,EAAMd,IAAI82M,IAEhB,GAAIh2M,aAAiB7F,UAAY6F,aAAiBwmC,QAAUxmC,aAAiBm7D,QAAUn7D,aAAiBsgL,SAAU,CACnH,MAAM21B,EAAiB,CAAC,EACxB,IAAK,MAAMl2M,KAAOC,EACdi2M,EAAel2M,GAAOi2M,GAAah2M,EAAMD,IAE7C,OAAOk2M,CACX,CACA,OAAOH,GAAS91M,EACpB,CAEA,SAASk2M,GAAer9M,GACpB,MAAMkH,EAAMlH,EAAQkH,IACd0qC,EAAS5xC,EAAQmH,MACjBm2M,EAAet9M,EAAQu9M,WAAa,CAAC,EACrCC,EAAoBx9M,EAAQy9M,yBAA2B,CAAC,EACxDp+M,EAAQW,EAAQX,MAChBq+M,EAAY19M,EAAQ09M,UACpBC,EAAe39M,EAAQ29M,aAC7B,IAAIz8I,EAAS,GACb,MAAM50D,EAAOwtB,GAAQ8X,GACrB,GAAa,WAATtlC,EACA,MAAO,CAAC,IAAI8wB,EAAgBl2B,EAAK0qC,EAAQ,oBAAoBtlC,YAEjE,IAAK,MAAMsxM,KAAahsK,EAAQ,CAC5B,MAAMisK,EAAiBD,EAAU5kM,MAAM,KAAK,GACtC8kM,EAAcR,EAAaO,IAAmBP,EAAa,KACjE,IAAIS,EACJ,GAAIP,EAAkBK,GAClBE,EAAkBP,EAAkBK,QAEnC,GAAIP,EAAaO,GAClBE,EAAkBJ,OAEjB,GAAIH,EAAkB,KACvBO,EAAkBP,EAAkB,SAEnC,KAAIF,EAAa,KAGjB,CACDp8I,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0qC,EAAOgsK,GAAY,qBAAqBA,OAC7E,QACJ,CALIG,EAAkBJ,CAKtB,CACAz8I,EAASA,EAAOvwC,OAAOotL,EAAgB,CACnC72M,KAAMA,EAAM,GAAGA,KAASA,GAAO02M,EAC/Bz2M,MAAOyqC,EAAOgsK,GACdL,UAAWO,EACXz+M,QACAq+M,YACA9rK,SACAgsK,YACAD,gBACD/rK,GACP,CACA,IAAK,MAAMisK,KAAkBP,EAErBE,EAAkBK,IAGlBP,EAAaO,GAAgBv0I,eAAwD/oD,IAA5C+8L,EAAaO,GAAyB,cAA8Ct9L,IAA3BqxB,EAAOisK,IACzG38I,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0qC,EAAQ,8BAA8BisK,OAGnF,OAAO38I,CACX,CAEA,SAAS88I,GAAch+M,GACnB,MAAMk1B,EAAQl1B,EAAQmH,MAChB82M,EAAYj+M,EAAQu9M,UACpBI,EAAe39M,EAAQ29M,aACvBt+M,EAAQW,EAAQX,MAChBq+M,EAAY19M,EAAQ09M,UACpBx2M,EAAMlH,EAAQkH,IACdg3M,EAAuBl+M,EAAQm+M,uBAAyBR,EAC9D,GAAuB,UAAnB7jL,GAAQ5E,GACR,MAAO,CAAC,IAAIkI,EAAgBl2B,EAAKguB,EAAO,mBAAmB4E,GAAQ5E,aAEvE,GAAI+oL,EAAUz8M,QAAU0zB,EAAM1zB,SAAWy8M,EAAUz8M,OAC/C,MAAO,CAAC,IAAI47B,EAAgBl2B,EAAKguB,EAAO,gBAAgB+oL,EAAUz8M,2BAA2B0zB,EAAM1zB,iBAEvG,GAAIy8M,EAAU,eAAiB/oL,EAAM1zB,OAASy8M,EAAU,cACpD,MAAO,CAAC,IAAI7gL,EAAgBl2B,EAAKguB,EAAO,yBAAyB+oL,EAAU,kCAAkC/oL,EAAM1zB,iBAEvH,IAAI48M,EAAmB,CACnB,KAAQH,EAAU92M,MAClB,OAAU82M,EAAUhmM,QAEpBylM,EAAU3xB,SAAW,IACrBqyB,EAA2B,SAAIH,EAAUI,UAEZ,WAA7BvkL,GAAQmkL,EAAU92M,SAClBi3M,EAAmBH,EAAU92M,OAEjC,IAAI+5D,EAAS,GACb,IAAK,IAAI1rD,EAAI,EAAGA,EAAI0f,EAAM1zB,OAAQgU,IAC9B0rD,EAASA,EAAOvwC,OAAOutL,EAAqB,CACxChpL,QACAopL,WAAY9oM,EACZrO,MAAO+tB,EAAM1f,GACb+nM,UAAWa,EACXT,aAAc39M,EAAQ29M,aACtBt+M,QACAq+M,YACAx2M,IAAK,GAAGA,KAAOsO,QAGvB,OAAO0rD,CACX,CAEA,SAASq9I,GAAev+M,GACpB,MAAMkH,EAAMlH,EAAQkH,IACdC,EAAQnH,EAAQmH,MAChBo2M,EAAYv9M,EAAQu9M,UAC1B,IAAIjxM,EAAOwtB,GAAQ3yB,GAInB,MAHa,WAATmF,GAAqBnF,GAAUA,IAC/BmF,EAAO,OAEE,WAATA,EACO,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,oBAAoBmF,YAE5D,YAAaixM,GAAap2M,EAAQo2M,EAAUpvB,QACrC,CAAC,IAAI/wJ,EAAgBl2B,EAAKC,EAAO,GAAGA,oCAAwCo2M,EAAUpvB,YAE7F,YAAaovB,GAAap2M,EAAQo2M,EAAUrvB,QACrC,CAAC,IAAI9wJ,EAAgBl2B,EAAKC,EAAO,GAAGA,uCAA2Co2M,EAAUrvB,YAE7F,EACX,CAEA,SAASswB,GAAiBx+M,GACtB,MAAMy+M,EAAoBz+M,EAAQu9M,UAC5BrB,EAAee,GAASj9M,EAAQmH,MAAMmF,MAC5C,IAAIoyM,EAEAC,EACAC,EAFAC,EAAmB,CAAC,EAGxB,MAAMC,EAAkC,gBAAjB5C,QAA6D37L,IAA3BvgB,EAAQmH,MAAM05D,SACjEk+I,GAAsBD,EACtBE,EAA6D,UAAjCllL,GAAQ95B,EAAQmH,MAAMsT,QAChB,UAApCqf,GAAQ95B,EAAQmH,MAAMsT,MAAM,KACW,WAAvCqf,GAAQ95B,EAAQmH,MAAMsT,MAAM,GAAG,IAC7BymD,EAASm8I,GAAe,CAC1Bn2M,IAAKlH,EAAQkH,IACbC,MAAOnH,EAAQmH,MACfo2M,UAAWv9M,EAAQ09M,UAAUW,SAC7BV,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBD,wBAAyB,CACrBhjM,MAyBR,SAA+Bza,GAC3B,GAAqB,aAAjBk8M,EACA,MAAO,CAAC,IAAI9+K,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,sDAE5D,IAAI+5D,EAAS,GACb,MAAM/5D,EAAQnH,EAAQmH,MACtB+5D,EAASA,EAAOvwC,OAAOqtL,GAAc,CACjC92M,IAAKlH,EAAQkH,IACbC,QACAo2M,UAAWv9M,EAAQu9M,UACnBI,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBS,sBAAuBc,KAEJ,UAAnBnlL,GAAQ3yB,IAAuC,IAAjBA,EAAM3F,QACpC0/D,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKC,EAAO,sCAExD,OAAO+5D,CACX,EA3CQuH,QA6IR,SAAiCzoE,GAC7B,OAAOA,EAAQ29M,aAAa,CACxBz2M,IAAKlH,EAAQkH,IACbC,MAAOnH,EAAQmH,MACfo2M,UAAWkB,EACXd,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,WAE3B,KA/HA,MApBqB,aAAjBxB,GAA+B4C,GAC/B59I,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,yCAE3C,aAAjB+0M,GAAgCl8M,EAAQmH,MAAMsT,OAC9CymD,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,sCAE3C,gBAAjB+0M,GAAkCl8M,EAAQu9M,UAAUluB,aAAegpB,GAAsBr4M,EAAQu9M,YACjGr8I,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,wCAE5DnH,EAAQ09M,UAAU3xB,UAAY,IAC1BgzB,IAAuB7G,GAA2Bl4M,EAAQu9M,WAC1Dr8I,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,qCAEvD23M,IAAmB1G,GAAuBp4M,EAAQu9M,YACvDr8I,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,kCAG9C,gBAAjB+0M,IAAkC8C,QAAyDz+L,IAA3BvgB,EAAQmH,MAAM05D,UAC/EK,EAAOl7D,KAAK,IAAIo3B,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,oCAEzD+5D,EAqBP,SAAS+9I,EAAqBj/M,GAC1B,IAAIkhE,EAAS,GACb,MAAM/5D,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACpB,GAAuB,UAAnB4yB,GAAQ3yB,GACR,MAAO,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,mBAAmB2yB,GAAQ3yB,aAEvE,GAAqB,IAAjBA,EAAM3F,OACN,MAAO,CAAC,IAAI47B,EAAgBl2B,EAAKC,EAAO,mCAAmCA,EAAM3F,iBAErF,GAAIw9M,EAA2B,CAC3B,GAA0B,WAAtBllL,GAAQ3yB,EAAM,IACd,MAAO,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,oBAAoB2yB,GAAQ3yB,EAAM,cAE9E,QAAsBoZ,IAAlBpZ,EAAM,GAAGglL,KACT,MAAO,CAAC,IAAI/uJ,EAAgBl2B,EAAKC,EAAO,mCAE5C,QAAuBoZ,IAAnBpZ,EAAM,GAAGA,MACT,MAAO,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,oCAE5C,GAAIy3M,GAA0BA,EAAyB3B,GAAS91M,EAAM,GAAGglL,MACrE,MAAO,CAAC,IAAI/uJ,EAAgBl2B,EAAKC,EAAM,GAAGglL,KAAM,oDAEhD8wB,GAAS91M,EAAM,GAAGglL,QAAUyyB,IAC5BA,EAAyB3B,GAAS91M,EAAM,GAAGglL,MAC3CwyB,OAA0Bp+L,EAC1Bs+L,EAAmB,CAAC,GAExB39I,EAASA,EAAOvwC,OAAO0sL,GAAe,CAClCn2M,IAAK,GAAGA,OACRC,MAAOA,EAAM,GACbo2M,UAAW,CAAEpxB,KAAM,CAAC,GACpBwxB,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBD,wBAAyB,CAAEtxB,KAAMoyB,GAAgBp3M,MAAO+3M,KAEhE,MAEIh+I,EAASA,EAAOvwC,OAAOuuL,EAAwB,CAC3Ch4M,IAAK,GAAGA,OACRC,MAAOA,EAAM,GACbo2M,UAAW,CAAC,EACZI,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,WACpBv2M,IAEP,OAAIqyM,GAAa2D,GAAah2M,EAAM,KACzB+5D,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgB,GAAGl2B,OAAUC,EAAM,GAAI,oDAE9D+5D,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACtCz2M,IAAK,GAAGA,OACRC,MAAOA,EAAM,GACbo2M,UAAWkB,EACXd,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,YAE3B,CACA,SAASwB,EAAwBl/M,EAAS87M,GACtC,MAAMxvM,EAAOwtB,GAAQ95B,EAAQmH,OACvBA,EAAQ81M,GAASj9M,EAAQmH,OACzBg4M,EAAgC,OAAlBn/M,EAAQmH,MAAiBnH,EAAQmH,MAAQ20M,EAC7D,GAAK4C,GAGA,GAAIpyM,IAASoyM,EACd,MAAO,CAAC,IAAIthL,EAAgBp9B,EAAQkH,IAAKi4M,EAAa,GAAG7yM,2DAA8DoyM,WAHvHA,EAAcpyM,EAKlB,GAAa,WAATA,GAA8B,WAATA,GAA8B,YAATA,EAC1C,MAAO,CAAC,IAAI8wB,EAAgBp9B,EAAQkH,IAAKi4M,EAAa,2DAE1D,GAAa,WAAT7yM,GAAsC,gBAAjB4vM,EAAgC,CACrD,IAAIh6M,EAAU,oBAAoBoK,UAIlC,OAHI4rM,GAA2BuG,SAAuCl+L,IAAjB27L,IACjDh6M,GAAW,qFAER,CAAC,IAAIk7B,EAAgBp9B,EAAQkH,IAAKi4M,EAAaj9M,GAC1D,CACA,MAAqB,gBAAjBg6M,GAA2C,WAAT5vM,GAAuBykC,SAAS5pC,IAAUwwB,KAAKyR,MAAMjiC,KAAWA,EAGjF,gBAAjB+0M,GAA2C,WAAT5vM,QAAiDiU,IAA5Bo+L,GAAyCx3M,EAAQw3M,EACjG,CAAC,IAAIvhL,EAAgBp9B,EAAQkH,IAAKi4M,EAAa,uDAGtDR,EAA0Bx3M,EAET,gBAAjB+0M,GAAkC/0M,KAAS03M,EACpC,CAAC,IAAIzhL,EAAgBp9B,EAAQkH,IAAKi4M,EAAa,uCAGtDN,EAAiB13M,IAAS,EAEvB,KAdI,CAAC,IAAIi2B,EAAgBp9B,EAAQkH,IAAKi4M,EAAa,2BAA2Bh4M,KAezF,CAWJ,CAEA,SAASi4M,GAAmBp/M,GACxB,MAAMqvL,GAA4C,aAA9BrvL,EAAQq/M,kBAAmChF,GAA2BZ,IAAkB0D,GAAan9M,EAAQmH,OAAQnH,EAAQu9M,WACjJ,GAA0B,UAAtBluB,EAAWhkL,OACX,OAAOgkL,EAAWloL,MAAMd,KAAKvF,GAClB,IAAIs8B,EAAgB,GAAGp9B,EAAQkH,MAAMpG,EAAMoG,MAAOlH,EAAQmH,MAAOrG,EAAMoB,WAGtF,MAAMo9M,EAAgBjwB,EAAWloL,MAAMkoL,YAAcA,EAAWloL,MAAM6yM,iBAAiB3qB,WACvF,GAAkC,aAA9BrvL,EAAQq/M,mBAA6D,cAAxBr/M,EAAQu/M,cACpDD,EAAchb,gBACf,MAAO,CAAC,IAAIlnK,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,gCAAgCnH,EAAQu/M,qFAEpG,GAAkC,aAA9Bv/M,EAAQq/M,mBAA6D,WAAzBr/M,EAAQw/M,eAClDvH,GAAgBqH,GAClB,MAAO,CAAC,IAAIliL,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,+EAE5D,GAAkC,WAA9BnH,EAAQq/M,oBAAmCpH,GAAgBqH,GAC3D,MAAO,CAAC,IAAIliL,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,qEAE5D,GAAInH,EAAQq/M,mBAAsE,IAAjDr/M,EAAQq/M,kBAAkBxlM,QAAQ,WAAkB,CACjF,IAAKm+L,GAAyBsH,EAAe,CAAC,OAAQ,kBAClD,MAAO,CAAC,IAAIliL,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,sFAE5D,GAAkC,oBAA9BnH,EAAQq/M,oBAA4CtH,GAAkBuH,GACtE,MAAO,CAAC,IAAIliL,EAAgBp9B,EAAQkH,IAAKlH,EAAQmH,MAAO,kGAEhE,CACA,MAAO,EACX,CAyBA,SAASs4M,GAAaz/M,GAClB,MAAMkH,EAAMlH,EAAQkH,IACdC,EAAQnH,EAAQmH,MAChBo2M,EAAYv9M,EAAQu9M,UACpBr8I,EAAS,GAWf,OAVIt3D,MAAM4E,QAAQ+uM,EAAUtlM,SAC2B,IAA/CslM,EAAUtlM,OAAO4B,QAAQojM,GAAS91M,KAClC+5D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,oBAAoBo2M,EAAUtlM,OAAO/R,KAAK,WAAWtC,KAAKqC,UAAUkB,cAIpD,IAA5D7F,OAAOC,KAAKg8M,EAAUtlM,QAAQ4B,QAAQojM,GAAS91M,KAC/C+5D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,oBAAoB7F,OAAOC,KAAKg8M,EAAUtlM,QAAQ/R,KAAK,WAAWtC,KAAKqC,UAAUkB,aAG9H+5D,CACX,CAEA,SAASw+I,GAAe1/M,GACpB,OAAI46M,GAAmBuC,GAAan9M,EAAQmH,QACjCi4M,GAAmB9sB,EAAS,CAAC,EAAGtyL,EAAS,CAC5Cq/M,kBAAmB,SACnB9B,UAAW,CAAEp2M,MAAO,cAIjBw4M,GAA4B3/M,EAE3C,CACA,SAAS2/M,GAA4B3/M,GACjC,MAAMmH,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACpB,GAAuB,UAAnB4yB,GAAQ3yB,GACR,MAAO,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,mBAAmB2yB,GAAQ3yB,aAEvE,MAAMu2M,EAAY19M,EAAQ09M,UAC1B,IAAIpxM,EACA40D,EAAS,GACb,GAAI/5D,EAAM3F,OAAS,EACf,MAAO,CAAC,IAAI47B,EAAgBl2B,EAAKC,EAAO,8CAS5C,OAPA+5D,EAASA,EAAOvwC,OAAO8uL,GAAa,CAChCv4M,IAAK,GAAGA,OACRC,MAAOA,EAAM,GACbo2M,UAAWG,EAAU/sB,gBACrBtxL,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,aAEfT,GAAS91M,EAAM,KACnB,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,KACGA,EAAM3F,QAAU,GAA4B,UAAvBy7M,GAAS91M,EAAM,KACpC+5D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,wCAAwCA,EAAM,QAGlG,IAAK,KACL,IAAK,KACoB,IAAjBA,EAAM3F,QACN0/D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,8BAA8BA,EAAM,6BAGxF,IAAK,KACL,IAAK,MACGA,EAAM3F,QAAU,IAChB8K,EAAOwtB,GAAQ3yB,EAAM,IACR,WAATmF,GACA40D,EAAOl7D,KAAK,IAAIo3B,EAAgB,GAAGl2B,OAAUC,EAAM,GAAI,oBAAoBmF,aAGnF,IAAK,IAAIkJ,EAAI,EAAGA,EAAIrO,EAAM3F,OAAQgU,IAC9BlJ,EAAOwtB,GAAQ3yB,EAAMqO,IACM,UAAvBynM,GAAS91M,EAAM,IACf+5D,EAASA,EAAOvwC,OAAO8uL,GAAa,CAChCv4M,IAAK,GAAGA,KAAOsO,KACfrO,MAAOA,EAAMqO,GACb+nM,UAAWG,EAAU5sB,cACrBzxL,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,aAGT,WAATpxM,GAA8B,WAATA,GAA8B,YAATA,GAC/C40D,EAAOl7D,KAAK,IAAIo3B,EAAgB,GAAGl2B,KAAOsO,KAAMrO,EAAMqO,GAAI,wCAAwClJ,YAG1G,MACJ,IAAK,MACL,IAAK,MACL,IAAK,OACD,IAAK,IAAIkJ,EAAI,EAAGA,EAAIrO,EAAM3F,OAAQgU,IAC9B0rD,EAASA,EAAOvwC,OAAOgvL,GAA4B,CAC/Cz4M,IAAK,GAAGA,KAAOsO,KACfrO,MAAOA,EAAMqO,GACbnW,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,aAG3B,MACJ,IAAK,MACL,IAAK,OACDpxM,EAAOwtB,GAAQ3yB,EAAM,IACA,IAAjBA,EAAM3F,OACN0/D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,qBAAqBA,EAAM,sCAEzD,WAATmF,GACL40D,EAAOl7D,KAAK,IAAIo3B,EAAgB,GAAGl2B,OAAUC,EAAM,GAAI,oBAAoBmF,YAIvF,OAAO40D,CACX,CAEA,SAAS0+I,GAAiB5/M,EAASw/M,GAC/B,MAAMt4M,EAAMlH,EAAQkH,IACdy2M,EAAe39M,EAAQ29M,aACvBt+M,EAAQW,EAAQX,MAChBq+M,EAAY19M,EAAQ09M,UACpBv2M,EAAQnH,EAAQmH,MAChBo4M,EAAcv/M,EAAQ49M,UACtBiC,EAAYnC,EAAU,GAAG8B,KAAgBx/M,EAAQ8/M,aACvD,IAAKD,EACD,MAAO,GACX,MAAME,EAAkBR,EAAYzrM,MAAM,qBAC1C,GAAqB,UAAjB0rM,GAA4BO,GAAmBF,EAAUE,EAAgB,KAAOF,EAAUE,EAAgB,IAAIz1H,WAC9G,OAAOqzH,EAAa,CAChBz2M,MACAC,QACAo2M,UAAWG,EAAUpzH,WACrBjrF,QACAq+M,cAGR,MAAMH,EAAYv9M,EAAQu9M,WAAasC,EAAUN,GACjD,IAAKhC,EACD,MAAO,CAAC,IAAIngL,EAAgBl2B,EAAKC,EAAO,qBAAqBo4M,OAEjE,IAAIS,EACJ,GAAuB,WAAnBlmL,GAAQ3yB,IAAuB+wM,GAA2BqF,KAAeA,EAAUltB,SAAW2vB,EAAa,cAAc9vL,KAAK/oB,IAC9H,MAAO,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,IAAIo4M,4HAC8C37M,KAAKqC,UAAU+5M,EAAW,aAExH,MAAM9+I,EAAS,GASf,MAR0B,WAAtBlhE,EAAQ8/M,YACY,eAAhBP,GAAgClgN,IAAUA,EAAMstL,QAChDzrH,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,2DAE5B,cAAhBo4M,GAA+BjH,GAAa6E,GAAah2M,KAAoC,aAAzB81M,GAAS91M,EAAMmF,OACnF40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,qDAG7C+5D,EAAOvwC,OAAOgtL,EAAa,CAC9Bz2M,IAAKlH,EAAQkH,IACbC,QACAo2M,YACAl+M,QACAq+M,YACA2B,kBAAmB,WACnBG,eACAD,gBAER,CAEA,SAASU,GAAsBjgN,GAC3B,OAAO4/M,GAAiB5/M,EAAS,QACrC,CAEA,SAASkgN,GAAuBlgN,GAC5B,OAAO4/M,GAAiB5/M,EAAS,SACrC,CAEA,SAASmgN,GAAcngN,GACnB,IAAIkhE,EAAS,GACb,MAAMt0D,EAAQ5M,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACd7H,EAAQW,EAAQX,MAChBq+M,EAAY19M,EAAQ09M,UACrB9wM,EAAMN,MAASM,EAAMwzM,KACtBl/I,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAO,uCAEhD,IAAIN,EAAO2wM,GAASrwM,EAAMN,MAC1B,MAAM8zM,EAAMnD,GAASrwM,EAAMwzM,KAC3B,GAAIxzM,EAAMtI,GAAI,CACV,MAAM4vD,EAAU+oJ,GAASrwM,EAAMtI,IAC/B,IAAK,IAAIkR,EAAI,EAAGA,EAAIxV,EAAQs+M,WAAY9oM,IAAK,CACzC,MAAM6qM,EAAahhN,EAAMygB,OAAOtK,GAC5BynM,GAASoD,EAAW/7M,MAAQ4vD,GAC5BgN,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMtI,GAAI,uBAAuBsI,EAAMtI,gCAAgC+7M,EAAW/7M,GAAG+tL,YAElI,CACJ,CACA,GAAI,QAASzlL,EAAO,CAMhB,IAAI0pC,EALJ,CAAC,OAAQ,SAAU,eAAgB,SAAU,UAAUtsC,SAASoyC,IACxDA,KAAKxvC,GACLs0D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMwvC,GAAI,IAAIA,mCACvD,IAGJ/8C,EAAMygB,OAAO9V,SAAS4C,IACdqwM,GAASrwM,EAAMtI,MAAQ87M,IACvB9pK,EAAS1pC,EAAK,IAEjB0pC,EAGIA,EAAO8pK,IACZl/I,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMwzM,IAAK,2CAGhD9zM,EAAO2wM,GAAS3mK,EAAOhqC,MANvB40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMwzM,IAAK,cAAcA,gBAQtE,MACK,GAAa,eAAT9zM,EACL,GAAKM,EAAMoQ,OAGN,CACD,MAAMA,EAAS3d,EAAMgiB,SAAWhiB,EAAMgiB,QAAQzU,EAAMoQ,QAC9CsjM,EAAatjM,GAAUigM,GAASjgM,EAAO1Q,MACxC0Q,EAGmB,WAAfsjM,GAAoC,WAATh0M,EAChC40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMoQ,OAAQ,UAAUpQ,EAAMtI,iCAE/C,eAAfg8M,GAAwC,cAATh0M,EACpC40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMoQ,OAAQ,UAAUpQ,EAAMtI,qCAE/C,WAAfg8M,GAAoC,WAATh0M,EAChC40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMoQ,OAAQ,UAAUpQ,EAAMtI,iCAE/C,WAAfg8M,GAA4B1zM,EAAM,gBAGnB,eAAf0zM,GAAwC,cAATh0M,EACpC40D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMoQ,OAAQ,oEAErC,SAAT1Q,IAAmBM,EAAMmE,QAASnE,EAAMmE,MAAM,kBACnC,YAAfuvM,GAA6BtjM,EAAO0xK,aACrCxtH,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAO,UAAUA,EAAMtI,iGAP5D48D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAO,UAAUA,EAAMtI,sCAZ5D48D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAMoQ,OAAQ,WAAWpQ,EAAMoQ,qBAqB5E,MA3BIkkD,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0F,EAAO,uCAuFpD,OA1DAs0D,EAASA,EAAOvwC,OAAO0sL,GAAe,CAClCn2M,MACAC,MAAOyF,EACP2wM,UAAWG,EAAU9wM,MACrBvN,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBC,aAAc39M,EAAQ29M,aACtBF,wBAAyB,CACrB,IAAG,IACQ,GAIXnxM,KAAI,IACOtM,EAAQ29M,aAAa,CACxBz2M,IAAK,GAAGA,SACRC,MAAOyF,EAAMN,KACbixM,UAAWG,EAAU9wM,MAAMN,KAC3BjN,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBC,aAAc39M,EAAQ29M,aACtB/rK,OAAQhlC,EACRgxM,UAAW,SAGnB/tM,OAAQ6vM,GACR1uM,OAAOhR,GACIq9M,GAAe,CAClBzwM,QACA1F,IAAKlH,EAAQkH,IACbC,MAAOnH,EAAQmH,MACf9H,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBC,aAAc39M,EAAQ29M,aACtBF,wBAAyB,CACrB,IAAIz9M,GACOkgN,GAAuB5tB,EAAS,CAAEwtB,UAAWxzM,GAAQtM,OAK5E+Q,MAAM/Q,GACKq9M,GAAe,CAClBzwM,QACA1F,IAAKlH,EAAQkH,IACbC,MAAOnH,EAAQmH,MACf9H,MAAOW,EAAQX,MACfq+M,UAAW19M,EAAQ09M,UACnBC,aAAc39M,EAAQ29M,aACtBF,wBAAyB,CACrB,IAAIz9M,GACOigN,GAAsB3tB,EAAS,CAAEwtB,UAAWxzM,GAAQtM,WAO5EkhE,CACX,CAEA,SAASq/I,GAAevgN,GACpB,MAAMmH,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACdoF,EAAOwtB,GAAQ3yB,GACrB,MAAa,WAATmF,EACO,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,oBAAoBmF,YAEzD,EACX,CA2CA,MAAMmxM,GAA0B,CAC5BtwB,UA+FJ,UAA2B,IAAEjmL,EAAG,MAAEC,IAC9B,GAAuB,WAAnB2yB,GAAQ3yB,GACR,OAAOo5M,GAAe,CAAEr5M,MAAKC,UAE5B,CACD,MAAM+5D,EAAS,GACf,IAAK,MAAMxnD,KAAQvS,EACf+5D,EAAOl7D,QAAQu6M,GAAe,CAAEr5M,IAAK,GAAGA,KAAOwS,IAAQvS,MAAOA,EAAMuS,MAExE,OAAOwnD,CACX,CACJ,GAxGA,SAASs/I,GAAexgN,GACpB,MAAMmH,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACdw2M,EAAY19M,EAAQ09M,UACpBr+M,EAAQW,EAAQX,MAChBs+M,EAAe39M,EAAQ29M,aAC7B,IAAKx2M,EAAMmF,KACP,MAAO,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,uBAE5C,MAAMmF,EAAO2wM,GAAS91M,EAAMmF,MAC5B,IAAI40D,EACJ,OAAQ50D,GACJ,IAAK,SACL,IAAK,SAUD,OATA40D,EAASm8I,GAAe,CACpBn2M,MACAC,QACAo2M,UAAWG,EAAU,UAAUpxM,EAAKmC,QAAQ,IAAK,QACjDpP,MAAOW,EAAQX,MACfq+M,YACAD,2BACAE,iBAEGz8I,EACX,IAAK,aAQD,OAPAA,EArEZ,SAAiClhE,GAC7B,IAAIygN,EACJ,MAAMC,EAA2C,QAA7BD,EAAKzgN,EAAQ0gN,kBAA+BngM,IAAPkgM,EAAmBA,EAAK,GAC3EE,EAAY3gN,EAAQmH,MACpBu2M,EAAY19M,EAAQ09M,UACpBkD,EAAgBlD,EAAUlwB,kBAC1BnuL,EAAQW,EAAQX,MACtB,IAAI6hE,EAAS,GACb,MAAM2/I,EAAW/mL,GAAQ6mL,GACzB,QAAkBpgM,IAAdogM,EACA,OAAOz/I,EAEN,GAAiB,WAAb2/I,EAEL,OADA3/I,EAAOl7D,KAAK,IAAIo3B,EAAgB,oBAAqBujL,EAAW,oBAAoBE,YAC7E3/I,EAEX,MACM4/I,EAAgC,WADrB7D,GAAS0D,EAAUlzB,UAE9BszB,EAAqB,CAAC,YAAa,cAAe,aAAc,aAChEC,EAAehhN,EAAQmH,MAAMsmL,SAAW,IAAIztL,EAAQmH,MAAMsmL,YAAc,UAC9E,IAAK,MAAMvmL,KAAOy5M,GACTG,GAAoBC,EAAmB74M,SAAShB,GACjDg6D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKy5M,EAAUz5M,GAAM,OAAOw5M,QAAiBx5M,wDAA0D85M,qBAElIJ,EAAc15M,GACnBg6D,EAASA,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOw5M,EAAUz5M,GACjBq2M,UAAWqD,EAAc15M,GACzBy2M,aAAc39M,EAAQ29M,aACtBt+M,QACAq+M,eAIJx8I,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKy5M,EAAUz5M,GAAM,qBAAqBA,OAGlF,OAAOg6D,CACX,CA8BqB+/I,CAAwB,CAC7BP,WAAYx5M,EACZC,QACA9H,MAAOW,EAAQX,MACfq+M,YACAC,iBAEGz8I,EACX,IAAK,UAUD,GATAA,EAASm8I,GAAe,CACpBn2M,MACAC,QACAo2M,UAAWG,EAAU1vB,eACrB3uL,QACAq+M,YACAC,eACAF,6BAEAt2M,EAAMknL,QACN,IAAK,MAAM30K,KAAQvS,EAAMsnL,kBAAmB,CACxC,MAAOrU,EAAU8mC,GAAW/5M,EAAMsnL,kBAAkB/0K,GAC9CynM,EAAiC,iBAAb/mC,EAAwB,CAACA,EAAU,CAAC,eAAgB,CAAC,MAAO1gK,IAAS0gK,EAC/Fl5G,EAAOl7D,QAAQo5M,GAAmB,CAC9Bl4M,IAAK,GAAGA,KAAOwS,QACfvS,MAAO+5M,EACPvD,eACA0B,kBAAmB,iBAEvBn+I,EAAOl7D,QAAQo5M,GAAmB,CAC9Bl4M,IAAK,GAAGA,KAAOwS,WACfvS,MAAOg6M,EACPxD,eACA0B,kBAAmB,mBAE3B,CAEJ,OAAOn+I,EACX,IAAK,QACD,OAAOm8I,GAAe,CAClBn2M,MACAC,QACAo2M,UAAWG,EAAU9uB,aACrBvvL,QACAs+M,eACAD,cAER,IAAK,QACD,OAAOL,GAAe,CAClBn2M,MACAC,QACAo2M,UAAWG,EAAU3uB,aACrB1vL,QACAs+M,eACAD,cAER,IAAK,SACD,MAAO,CAAC,IAAItgL,EAAgBl2B,EAAK,KAAM,4FAA6F,kBACxI,QACI,OAAOu4M,GAAa,CAChBv4M,IAAK,GAAGA,SACRC,MAAOA,EAAMmF,KACbixM,UAAW,CAAEtlM,OAAQ,CAAC,SAAU,SAAU,aAAc,UAAW,QAAS,UAC5E5Y,QACAs+M,eACAD,cAGhB,CAcA,SAAS0D,GAAcphN,GACnB,MAAMwsL,EAAQxsL,EAAQmH,MAChBu2M,EAAY19M,EAAQ09M,UACpB2D,EAAY3D,EAAUlxB,MACtBntL,EAAQW,EAAQX,MACtB,IAAI6hE,EAAS,GACb,MAAM2/I,EAAW/mL,GAAQ0yJ,GACzB,QAAcjsK,IAAVisK,EACA,OAAOtrH,EAEN,GAAiB,WAAb2/I,EAEL,OADA3/I,EAASA,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgB,QAASovJ,EAAO,oBAAoBq0B,aACzE3/I,EAEX,IAAK,MAAMh6D,KAAOslL,EAAO,CACrB,MAAMuzB,EAAkB74M,EAAI4M,MAAM,qBAE9BotD,EADA6+I,GAAmBsB,EAAUtB,EAAgB,KAAOsB,EAAUtB,EAAgB,IAAIz1H,WACzEppB,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOqlL,EAAMtlL,GACbq2M,UAAWG,EAAUpzH,WACrBqzH,aAAc39M,EAAQ29M,aACtBt+M,QACAq+M,eAGC2D,EAAUn6M,GACNg6D,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOqlL,EAAMtlL,GACbq2M,UAAW8D,EAAUn6M,GACrBy2M,aAAc39M,EAAQ29M,aACtBt+M,QACAq+M,eAIKx8I,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgBl2B,EAAKslL,EAAMtlL,GAAM,qBAAqBA,OAE1F,CACA,OAAOg6D,CACX,CAEA,SAASogJ,GAAYthN,GACjB,MAAMysL,EAAMzsL,EAAQmH,MACdu2M,EAAY19M,EAAQ09M,UACpB6D,EAAU7D,EAAUjxB,IACpBptL,EAAQW,EAAQX,MAChBwhN,EAAW/mL,GAAQ2yJ,GACzB,QAAYlsK,IAARksK,EACA,MAAO,GAEN,GAAiB,WAAbo0B,EACL,MAAO,CAAC,IAAIzjL,EAAgB,MAAOqvJ,EAAK,oBAAoBo0B,YAEhE,IAAI3/I,EAAS,GACb,IAAK,MAAMh6D,KAAOulL,EAEVvrH,EADAqgJ,EAAQr6M,GACCg6D,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOslL,EAAIvlL,GACXq2M,UAAWgE,EAAQr6M,GACnB7H,QACAq+M,eAIKx8I,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgBl2B,EAAKulL,EAAIvlL,GAAM,qBAAqBA,QAGxF,OAAOg6D,CACX,CAEA,SAASsgJ,GAAgBxhN,GACrB,MAAM0sL,EAAU1sL,EAAQmH,MAClBu2M,EAAY19M,EAAQ09M,UACpB+D,EAAc/D,EAAUhxB,QACxBrtL,EAAQW,EAAQX,MACtB,IAAI6hE,EAAS,GACb,MAAM2/I,EAAW/mL,GAAQ4yJ,GACzB,QAAgBnsK,IAAZmsK,EACA,OAAOxrH,EAEN,GAAiB,WAAb2/I,EAEL,OADA3/I,EAASA,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgB,UAAWsvJ,EAAS,oBAAoBm0B,aAC7E3/I,EAEX,IAAK,MAAMh6D,KAAOwlL,EAEVxrH,EADAugJ,EAAYv6M,GACHg6D,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOulL,EAAQxlL,GACfq2M,UAAWkE,EAAYv6M,GACvBy2M,aAAc39M,EAAQ29M,aACtBt+M,QACAq+M,eAIKx8I,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgBl2B,EAAKwlL,EAAQxlL,GAAM,qBAAqBA,QAG5F,OAAOg6D,CACX,CA+EA,SAASwgJ,GAAe1hN,GACpB,IAAIkhE,EAAS,GACb,MAAMt9C,EAAS5jB,EAAQmH,MACjBD,EAAMlH,EAAQkH,IACpB,GAAK0C,MAAM4E,QAAQoV,GAMd,CACD,MAAM+9L,EAAe,GACfC,EAAgB,GACtB,IAAK,MAAMpsM,KAAKoO,EAAQ,CAChBA,EAAOpO,GAAGlR,IAAMq9M,EAAaz5M,SAAS0b,EAAOpO,GAAGlR,KAChD48D,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0c,EAAQ,4CAA4CA,EAAOpO,GAAGlR,qBACvGq9M,EAAa37M,KAAK4d,EAAOpO,GAAGlR,IACxBsf,EAAOpO,GAAG5V,KAAOgiN,EAAc15M,SAAS0b,EAAOpO,GAAG5V,MAClDshE,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAK0c,EAAQ,6CAA6CA,EAAOpO,GAAG5V,sBACxGgiN,EAAc57M,KAAK4d,EAAOpO,GAAG5V,KAC7B,MAAMiiN,EAAW,CACbv9M,GAAI,CACAgI,KAAM,SACNg9D,UAAU,GAEd1pE,IAAK,CACD0M,KAAM,SACNg9D,UAAU,IAGlBpI,EAASA,EAAOvwC,OAAO0sL,GAAe,CAClCn2M,IAAK,GAAGA,KAAOsO,KACfrO,MAAOyc,EAAOpO,GACd+nM,UAAWsE,EACXlE,aAAc39M,EAAQ29M,eAE9B,CACA,OAAOz8I,CACX,CAjCI,OAAOq/I,GAAe,CAClBr5M,MACAC,MAAOyc,GAgCnB,CA2DA,MAAMk+L,GAAa,CACf,IAAG,IACQ,GAEX,MAAS9D,GACT,QApwBJ,SAAyBh+M,GACrB,MAAMmH,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACdoF,EAAOwtB,GAAQ3yB,GACrB,MAAa,YAATmF,EACO,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,qBAAqBmF,YAE1D,EACX,EA6vBI,OAAUiyM,GACV,MA5vBJ,SAAuBv+M,GACnB,MAAMkH,EAAMlH,EAAQkH,IACdC,EAAQnH,EAAQmH,MAChBmF,EAAOwtB,GAAQ3yB,GACrB,MAAa,WAATmF,EACO,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,mBAAmBmF,YAE1DwN,GAAMjW,MAAMy+D,OAAOn7D,IAGjB,GAFI,CAAC,IAAIi2B,EAAgBl2B,EAAKC,EAAO,oBAAoBA,YAGpE,EAkvBI,UAAa41M,GACb,KAAQ0C,GACR,OAAUC,GACV,SAAYlB,GACZ,MAAS2B,GACT,OAAU9C,GACV,OAAUmD,GACV,MAASY,GACT,IAAOE,GACP,QAAWE,GACX,WA3EJ,SAA4BxhN,GACxB,MAAM0pL,EAAa1pL,EAAQmH,MACrBu2M,EAAY19M,EAAQ09M,UACpBqE,EAAiBrE,EAAUh0B,WAC3BrqL,EAAQW,EAAQX,MAChBwhN,EAAW/mL,GAAQ4vJ,GACzB,QAAmBnpK,IAAfmpK,EACA,MAAO,GAEN,GAAiB,WAAbm3B,EACL,MAAO,CAAC,IAAIzjL,EAAgB,aAAcssJ,EAAY,oBAAoBm3B,YAE9E,IAAI3/I,EAAS,GACb,IAAK,MAAMh6D,KAAOwiL,EAEVxoH,EADA6gJ,EAAe76M,GACNg6D,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,MACAC,MAAOuiL,EAAWxiL,GAClBq2M,UAAWwE,EAAe76M,GAC1B7H,QACAq+M,eAIKx8I,EAAOvwC,OAAO,CAAC,IAAIyM,EAAgBl2B,EAAKwiL,EAAWxiL,GAAM,qBAAqBA,QAG/F,OAAOg6D,CACX,EAgDI,qBA9CJ,SAAsClhE,GAClC,MAAMkH,EAAMlH,EAAQkH,IACpB,IAAIC,EAAQnH,EAAQmH,MACpBA,EAAQA,aAAiBm7D,OAASn7D,EAAM+1M,UAAY/1M,EACpD,MAAMmF,EAAOwtB,GAAQ3yB,GACrB,MAAa,UAATmF,GAcR,SAAqCnF,GACjC,OAAOyC,MAAM4E,QAAQrH,IACA,IAAjBA,EAAM3F,QACc,iBAAb2F,EAAM,IACO,iBAAbA,EAAM,IACO,iBAAbA,EAAM,EACrB,CApB6B66M,CAA4B76M,IAQzD,SAAsCA,GAClC,GAAI,CAAC,cAAe,OAAQ,WAAWe,SAASf,EAAM,IAClD,OAAO,EAEX,OAAO,CACX,CAboE86M,CAA6B96M,GAGnF,CAAC,QAAS,UAAUe,SAASoE,GAGhC,GAFI,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,sCAAsCmF,aAHvE,CAAC,IAAI8wB,EAAgBl2B,EAAKC,EAAO,sCAAsCvD,KAAKqC,UAAUkB,YAMrG,EAmCI,OAAUo5M,GACV,UApMJ,SAA2BvgN,GACvB,OAAuC,IAAnCugN,GAAevgN,GAASwB,OACjB,GAEJ49M,GAAmBp/M,EAC9B,EAgMI,cA9LJ,SAAuBA,GACnB,OAAuC,IAAnCugN,GAAevgN,GAASwB,OACjB,GAEJ49M,GAAmBp/M,EAC9B,EA0LI,QAxLJ,SAAyBA,GACrB,MAAMkH,EAAMlH,EAAQkH,IACdC,EAAQnH,EAAQmH,MAEtB,GAAa,UADA2yB,GAAQ3yB,GACC,CAClB,GAAIA,EAAM3F,OAAS,GAAK2F,EAAM3F,OAAS,EACnC,MAAO,CAAC,IAAI47B,EAAgBl2B,EAAKC,EAAO,mCAAmCA,EAAM3F,wBAErF,MAAM48M,EAAmB,CACrB9xM,KAAM,UAEV,IAAI40D,EAAS,GACb,IAAK,IAAI1rD,EAAI,EAAGA,EAAIrO,EAAM3F,OAAQgU,IAC9B0rD,EAASA,EAAOvwC,OAAO3wB,EAAQ29M,aAAa,CACxCz2M,IAAK,GAAGA,KAAOsO,KACfrO,MAAOA,EAAMqO,GACbmoM,aAAc39M,EAAQ29M,aACtBJ,UAAWa,KAGnB,OAAOl9I,CACX,CAEI,OAAOq9I,GAAe,CAClBr3M,MACAC,QACAo2M,UAAW,CAAC,GAGxB,EA4JI,+BA1JJ,SAAgDv9M,GAC5C,MAAMkH,EAAMlH,EAAQkH,IACdC,EAAQnH,EAAQmH,MAChBmF,EAAOwtB,GAAQ3yB,GACfu2M,EAAY19M,EAAQ09M,UAC1B,GAAa,UAATpxM,GAAoBnF,EAAM3F,OAAS,GAAK2F,EAAM3F,OAAS,GAAM,EAC7D,MAAO,CAAC,IAAI47B,EAAgBl2B,EAAKC,EAAO,6EAE5C,IAAI+5D,EAAS,GACb,IAAK,IAAI1rD,EAAI,EAAGA,EAAIrO,EAAM3F,OAAQgU,GAAK,EAEnC0rD,EAASA,EAAOvwC,OAAO8uL,GAAa,CAChCv4M,IAAK,GAAGA,KAAOsO,KACfrO,MAAOA,EAAMqO,GACb+nM,UAAWG,EAAyB,cAAE,kBAG1Cx8I,EAASA,EAAOvwC,OAAOqtL,GAAc,CACjC92M,IAAK,GAAGA,KAAOsO,EAAI,KACnBrO,MAAOA,EAAMqO,EAAI,GACjB+nM,UAAW,CACP/7M,OAAQ,EACR2F,MAAO,UAEXw2M,aAAc39M,EAAQ29M,aACtBt+M,MAAOW,EAAQX,MACfq+M,eAGR,OAAOx8I,CACX,EA6HI,OAAUwgJ,IAkBd,SAASQ,GAASliN,GACd,MAAMmH,EAAQnH,EAAQmH,MAChBo2M,EAAYv9M,EAAQu9M,UACpBG,EAAY19M,EAAQ09M,UAE1B,GADA19M,EAAQ29M,aAAeuE,GACnB3E,EAAUluB,YAAcipB,GAAa2E,GAAS91M,IAC9C,OAAOq3M,GAAiBx+M,GAEvB,GAAIu9M,EAAUluB,YAAcmqB,GAAa2D,GAAah2M,IACvD,OAAOi4M,GAAmBp/M,GAEzB,GAAIu9M,EAAUjxM,MAAQw1M,GAAWvE,EAAUjxM,MAC5C,OAAOw1M,GAAWvE,EAAUjxM,MAAMtM,GAMlC,OAHcq9M,GAAe/qB,EAAS,CAAC,EAAGtyL,EAAS,CAC/Cu9M,UAAWA,EAAUjxM,KAAOoxM,EAAUH,EAAUjxM,MAAQixM,IAIpE,CAEA,SAAS4E,GAAkBniN,GACvB,MAAMmH,EAAQnH,EAAQmH,MAChBD,EAAMlH,EAAQkH,IACdg6D,EAASq/I,GAAevgN,GAC9B,OAAIkhE,EAAO1/D,UAE2B,IAAlC2F,EAAM0S,QAAQ,gBACdqnD,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,qDAEd,IAA9BA,EAAM0S,QAAQ,YACdqnD,EAAOl7D,KAAK,IAAIo3B,EAAgBl2B,EAAKC,EAAO,iDALrC+5D,CAQf,CAcA,SAASkhJ,GAAiB/iN,EAAOq+M,EAAY5xB,GACzC,IAAI5qH,EAAS,GAwBb,OAvBAA,EAASA,EAAOvwC,OAAOuxL,GAAS,CAC5Bh7M,IAAK,GACLC,MAAO9H,EACPk+M,UAAWG,EAAU1xB,MACrB0xB,YACAr+M,QACAs+M,aAAcuE,GACdzE,wBAAyB,CACrB9wB,OAAQw1B,GACR,IAAG,IACQ,OAIf9iN,EAAiB,YACjB6hE,EAASA,EAAOvwC,OAAOosL,GAAkB,CACrC71M,IAAK,YACLC,MAAO9H,EAAiB,UACxBA,QACAq+M,YACAC,aAAcuE,OAGfG,GAAWnhJ,EACtB,CAWA,SAASohJ,GAAmBC,GACxB,OAAO,SAAUviN,GACb,OAAOuiN,EAAU,IACVviN,EACH29M,aAAcuE,IAEtB,CACJ,CACA,SAASG,GAAWnhJ,GAChB,MAAO,GAAGvwC,OAAOuwC,GAAQxmD,MAAK,CAACC,EAAGC,IACvBD,EAAE0B,KAAOzB,EAAEyB,MAE1B,CACA,SAASmmM,GAAgBC,GACrB,OAAO,YAAal0M,GAChB,OAAO8zM,GAAWI,EAAM7jM,MAAMxe,KAAMmO,GACxC,CACJ,CA3BA6zM,GAAiBplM,OAASwlM,GAAgBF,GAAmB9B,KAC7D4B,GAAiBx+L,OAAS4+L,GAAgBF,GAAmBZ,KAC7DU,GAAiBz1B,OAAS61B,GAAgBF,GAAmBH,KAC7DC,GAAiB51B,MAAQg2B,GAAgBF,GAAmBlB,KAC5DgB,GAAiB31B,IAAM+1B,GAAgBF,GAAmBhB,KAC1Dc,GAAiB11B,QAAU81B,GAAgBF,GAAmBd,KAC9DY,GAAiBx1M,MAAQ41M,GAAgBF,GAAmBnC,KAC5DiC,GAAiBvyM,OAAS2yM,GAAgBF,GAAmB5C,KAC7D0C,GAAiBM,cAAgBF,GAAgBF,GAAmBrC,KACpEmC,GAAiBO,eAAiBH,GAAgBF,GAAmBpC,KAuZrE,MAAM0C,GAAK92B,ECn7VX,IAAI+2B,GAAc,CAChBC,KAAM,IACNC,SAAU,IACV,cAAe,IACf,cAAe,IACfv2B,MAAO,IACPw2B,KAAM,IACNC,QAAS,IACTC,OAAQ,IACRC,MAAO,IACPC,MAAO,IACPC,SAAU,IACVC,OAAQ,IACR,YAAa,IACb,YAAa,IACbC,KAAM,IACN,aAAc,IACd,aAAc,IACdC,MAAO,IACPvsB,MAAO,IACP,cAAe,IACfwsB,IAAK,IACLC,OAAQ,IACR,cAAe,IACf,cAAe,KAEbC,GAAK,IACLC,GAAW,qBAEXC,GAAY,CAAC,EAQF,YAASC,EAAO9pM,EAAM+pM,GACnC,IAAIC,EAAUH,GAAUC,GACxB,IAAKE,EAAS,CACPp6M,MAAM4E,QAAQs1M,KACjBA,EAAQ,CAACA,IAMX,IAJA,IAGIG,EAAYC,EAHZC,EAAS,IACT9kN,EAAQ,SACR+kN,EAAe,GAEV5uM,EAAI,EAAG8M,EAAKwhM,EAAMtiN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC9C,IACIuzK,EADO+6B,EAAMtuM,GACAwD,MAAM,KACnBqrM,EAAct7B,EAAMA,EAAMvnL,OAAS,GAAG2G,cAW1C,IAAK,IAAI8R,IAVU,UAAfoqM,GAA0C,UAAfA,GAA0C,WAAfA,GACxDhlN,EAAQ6kN,EAAY7kN,EAAQglN,EAC5BH,GAAY,EACZn7B,EAAM/kH,MACNqgJ,EAAct7B,EAAMA,EAAMvnL,OAAS,GAAG2G,eAC7By7M,GAAS5vM,KAAKqwM,KACvBA,EAAcA,EAAY51M,QAAQm1M,GAAU,IAC5CvkN,EAAQ6kN,EAAY7kN,EAAQ0pL,EAAMA,EAAMvnL,OAAS,GAAGiN,QAAQ41M,EAAa,IACzEH,GAAY,GAEArB,GAAa,CACzB,IAAIyB,EAAev7B,EAAMvnL,OAAS,EAAIunL,EAAMA,EAAMvnL,OAAS,GAAG2G,cAAgB,GAC9E,GAAIk8M,GAAepqM,GAAKoqM,GAAepqM,EAAExL,QAAQ,IAAK,KAAO61M,EAAe,IAAMD,GAAepqM,EAAG,CAClGkqM,EAASF,EAAaE,EAAStB,GAAY5oM,GAC3C8uK,EAAM/kH,MACFsgJ,GAAgBrqM,EAAEkJ,WAAWmhM,IAC/Bv7B,EAAM/kH,MAER,KACF,CACF,CACKigJ,GAAoC,iBAAfI,IACxBF,EAASE,EACTJ,GAAa,GAEf,IAAIphI,EAAakmG,EAAM7iL,KAAKy9M,IACzBl1M,QAAQ,uBAAwB,cACH,IAA5Bo0E,EAAWhpE,QAAQ8pM,MACrB9gI,EAAa,IAAMA,EAAa,KAElCuhI,EAAap+M,KAAK68E,EACpB,CAEAmhI,EAAUH,GAAUC,GAAS,CAACzkN,EAAO8kN,EAAQC,EAC/C,CACA,OAAOJ,EAAQ,GAAKL,GAAKK,EAAQ,GAAKL,GAAK3pM,EAAO,MAAQ+pM,EAAa,IAAMA,EAAa,IAAMJ,GAAKK,EAAQ,EAC/G,CCvFA,MAAM,GAA+B5kN,GAAGmlN,UC+CjC,SAASC,GAAU7pM,EAAGC,GAC3B,OAAOD,EAAIC,EAAI,EAAID,EAAIC,GAAK,EAAI,CAClC,CAkHO,SAASozC,GAAOzT,EAAKt6C,GAC1B,MAAM4lB,EAAYjc,MAAM4E,QAAQvO,GAAQA,EAAO,CAACA,GAC1CuB,EAASqkB,EAAUrkB,OACzB,IAAK,IAAIgU,EAAI,EAAGA,EAAIhU,EAAQgU,IAC1B+kC,EAAIA,EAAI/4C,QAAUqkB,EAAUrQ,EAEhC,CCuCO,SAASivM,GAAetS,EAAMC,EAAMsS,EAAMC,EAAMv+L,GACrD,OAAIA,GACFA,EAAK,GAAK+rL,EACV/rL,EAAK,GAAKgsL,EACVhsL,EAAK,GAAKs+L,EACVt+L,EAAK,GAAKu+L,EACHv+L,GAEF,CAAC+rL,EAAMC,EAAMsS,EAAMC,EAC5B,CAOO,SAASC,GAAoBx+L,GAClC,OAAOq+L,GAAe/qK,IAAUA,KAAWA,KAAWA,IAAUtzB,EAClE,CA+BO,SAASy+L,GACdC,EACA/6M,EACAkf,EACA87L,EACA3+L,GAGA,OA2GK,SACLwV,EACAkpL,EACA/6M,EACAkf,EACA87L,GAEA,KAAOh7M,EAASkf,EAAKlf,GAAUg7M,EAC7BC,GAASppL,EAAQkpL,EAAgB/6M,GAAS+6M,EAAgB/6M,EAAS,IAErE,OAAO6xB,CACT,CAtHSqpL,CADQL,GAAoBx+L,GACE0+L,EAAiB/6M,EAAQkf,EAAK87L,EACrE,CAwIO,SAASC,GAASppL,EAAQl2B,EAAGC,GAClCi2B,EAAO,GAAKjE,KAAK9kB,IAAI+oB,EAAO,GAAIl2B,GAChCk2B,EAAO,GAAKjE,KAAK9kB,IAAI+oB,EAAO,GAAIj2B,GAChCi2B,EAAO,GAAKjE,KAAK5kB,IAAI6oB,EAAO,GAAIl2B,GAChCk2B,EAAO,GAAKjE,KAAK5kB,IAAI6oB,EAAO,GAAIj2B,EAClC,CAwEO,SAAS,GAAUi2B,GACxB,MAAO,EAAEA,EAAO,GAAKA,EAAO,IAAM,GAAIA,EAAO,GAAKA,EAAO,IAAM,EACjE,CAmGO,SAASspL,GAAUtpL,GACxB,OAAOA,EAAO,GAAKA,EAAO,EAC5B,CCrhBO,SAASupL,GACdL,EACA/6M,EACAkf,EACA87L,EACAr/M,EACAC,GASA,IAAIy/M,EAAK,EACLnX,EAAK6W,EAAgB77L,EAAM87L,GAC3Bt7H,EAAKq7H,EAAgB77L,EAAM87L,EAAS,GACxC,KAAOh7M,EAASkf,EAAKlf,GAAUg7M,EAAQ,CACrC,MAAMnb,EAAKkb,EAAgB/6M,GACrBmkM,EAAK4W,EAAgB/6M,EAAS,GAChC0/E,GAAM9jF,EACJuoM,EAAKvoM,IAAMikM,EAAKqE,IAAOtoM,EAAI8jF,IAAO/jF,EAAIuoM,IAAOC,EAAKzkH,GAAM,GAC1D27H,IAEOlX,GAAMvoM,IAAMikM,EAAKqE,IAAOtoM,EAAI8jF,IAAO/jF,EAAIuoM,IAAOC,EAAKzkH,GAAM,GAClE27H,IAEFnX,EAAKrE,EACLngH,EAAKykH,CACP,CACA,OAAc,IAAPkX,CACT,CAWO,SAASC,GACdP,EACA/6M,EACAu7M,EACAP,EACAr/M,EACAC,GAEA,GAAoB,IAAhB2/M,EAAK9jN,OACP,OAAO,EAET,IAAK2jN,GAAqBL,EAAiB/6M,EAAQu7M,EAAK,GAAIP,EAAQr/M,EAAGC,GACrE,OAAO,EAET,IAAK,IAAI6P,EAAI,EAAG8M,EAAKgjM,EAAK9jN,OAAQgU,EAAI8M,IAAM9M,EAC1C,GACE2vM,GAAqBL,EAAiBQ,EAAK9vM,EAAI,GAAI8vM,EAAK9vM,GAAIuvM,EAAQr/M,EAAGC,GAEvE,OAAO,EAGX,OAAO,CACT,CC/FO,SAAS4/M,GACdT,EACA/6M,EACAu7M,EACAP,EACAS,EACAC,EACAr/L,GAEA,IAAI5Q,EAAG8M,EAAI5c,EAAGuoM,EAAIrE,EAAIngH,EAAIykH,EAC1B,MAAMvoM,EAAI6/M,EAAYC,EAAoB,GAEpCC,EAAgB,GAEtB,IAAK,IAAIj3K,EAAI,EAAGk3K,EAAKL,EAAK9jN,OAAQitC,EAAIk3K,IAAMl3K,EAAG,CAC7C,MAAMxlB,EAAMq8L,EAAK72K,GAGjB,IAFAw/J,EAAK6W,EAAgB77L,EAAM87L,GAC3Bt7H,EAAKq7H,EAAgB77L,EAAM87L,EAAS,GAC/BvvM,EAAIzL,EAAQyL,EAAIyT,EAAKzT,GAAKuvM,EAC7Bnb,EAAKkb,EAAgBtvM,GACrB04L,EAAK4W,EAAgBtvM,EAAI,IACpB7P,GAAK8jF,GAAMykH,GAAMvoM,GAAO8jF,GAAM9jF,GAAKA,GAAKuoM,KAC3CxoM,GAAMC,EAAI8jF,IAAOykH,EAAKzkH,IAAQmgH,EAAKqE,GAAMA,EACzCyX,EAAc1/M,KAAKN,IAErBuoM,EAAKrE,EACLngH,EAAKykH,CAET,CAGA,IAAI/nH,EAAS85G,IACT2lB,GAAoBlsK,IAGxB,IAFAgsK,EAAchrM,KAAK8pM,IACnBvW,EAAKyX,EAAc,GACdlwM,EAAI,EAAG8M,EAAKojM,EAAclkN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAClDo0L,EAAK8b,EAAclwM,GACnB,MAAMqwM,EAAgBluL,KAAK2X,IAAIs6J,EAAKqE,GAChC4X,EAAgBD,IAClBlgN,GAAKuoM,EAAKrE,GAAM,EACZyb,GAAsBP,EAAiB/6M,EAAQu7M,EAAMP,EAAQr/M,EAAGC,KAClEwgF,EAASzgF,EACTkgN,EAAmBC,IAGvB5X,EAAKrE,CACP,CAMA,OALI94J,MAAMq1C,KAGRA,EAASq/H,EAAYC,IAEnBr/L,GACFA,EAAKpgB,KAAKmgF,EAAQxgF,EAAGigN,GACdx/L,GAEF,CAAC+/D,EAAQxgF,EAAGigN,EACrB,CCjDO,SAASE,GAAuBpgN,EAAGC,EAAGsoM,EAAIxkH,EAAImgH,EAAIsE,GACvD,MAAM1kJ,EAAKogJ,EAAKqE,EACVxkJ,EAAKykJ,EAAKzkH,EAChB,GAAW,IAAPjgC,GAAmB,IAAPC,EAAU,CACxB,MAAM0b,IAAMz/D,EAAIuoM,GAAMzkJ,GAAM7jD,EAAI8jF,GAAMhgC,IAAOD,EAAKA,EAAKC,EAAKA,GACxD0b,EAAI,GACN8oI,EAAKrE,EACLngH,EAAKykH,GACI/oI,EAAI,IACb8oI,GAAMzkJ,EAAK2b,EACXskB,GAAMhgC,EAAK0b,EAEf,CACA,OAWK,SAAyB8oI,EAAIxkH,EAAImgH,EAAIsE,GAC1C,MAAM1kJ,EAAKogJ,EAAKqE,EACVxkJ,EAAKykJ,EAAKzkH,EAChB,OAAOjgC,EAAKA,EAAKC,EAAKA,CACxB,CAfS,CAAgB/jD,EAAGC,EAAGsoM,EAAIxkH,EACnC,CCzBO,SAASs8H,GACdjB,EACA/6M,EACAkf,EACA87L,EACAiB,EACA5/L,EACA6/L,GAEA,IAAIjiM,EAAGmhD,EACP,MAAMp7C,GAAKd,EAAMlf,GAAUg7M,EAC3B,GAAU,IAANh7L,EACF/F,EAAIja,OACC,GAAU,IAANggB,EACT/F,EAAIja,EACJo7D,EAAI6gJ,OACC,GAAU,IAANj8L,EAAS,CAClB,IAAIkkL,EAAK6W,EAAgB/6M,GACrB0/E,EAAKq7H,EAAgB/6M,EAAS,GAC9BvI,EAAS,EACb,MAAM0kN,EAAoB,CAAC,GAC3B,IAAK,IAAI1wM,EAAIzL,EAASg7M,EAAQvvM,EAAIyT,EAAKzT,GAAKuvM,EAAQ,CAClD,MAAMnb,EAAKkb,EAAgBtvM,GACrB04L,EAAK4W,EAAgBtvM,EAAI,GAC/BhU,GAAUm2B,KAAKsjB,MAAM2uJ,EAAKqE,IAAOrE,EAAKqE,IAAOC,EAAKzkH,IAAOykH,EAAKzkH,IAC9Dy8H,EAAkBlgN,KAAKxE,GACvBysM,EAAKrE,EACLngH,EAAKykH,CACP,CACA,MAAM/qM,EAAS6iN,EAAWxkN,EACpB6H,ELjCH,SAAsBw9L,EAAUD,EAAQuf,GAC7C,IAAIzjF,EAAK0jF,EACTD,EAAaA,GAAc3B,GAC3B,IAAI6B,EAAM,EACNC,EAAOzf,EAASrlM,OAChB+kN,GAAQ,EAEZ,KAAOF,EAAMC,GAGX5jF,EAAM2jF,GAAQC,EAAOD,GAAQ,GAC7BD,GAAOD,EAAWtf,EAASnkE,GAAMkkE,GAE7Bwf,EAAM,EAERC,EAAM3jF,EAAM,GAGZ4jF,EAAO5jF,EACP6jF,GAASH,GAKb,OAAOG,EAAQF,GAAOA,CACxB,CKQkB,CAAaH,EAAmB/iN,GAC1CkG,EAAQ,GACV87D,GACGhiE,EAAS+iN,GAAmB78M,EAAQ,KACpC68M,GAAmB78M,EAAQ,GAAK68M,GAAmB78M,EAAQ,IAC9D2a,EAAIja,IAAWV,EAAQ,GAAK07M,GAE5B/gM,EAAIja,EAASV,EAAQ07M,CAEzB,CACAkB,EAAYA,EAAY,EAAIA,EAAY,EACxC7/L,EAAOA,GAAc,IAAIxc,MAAMq8M,GAC/B,IAAK,IAAIzwM,EAAI,EAAGA,EAAIywM,IAAazwM,EAC/B4Q,EAAK5Q,QACG+K,IAANyD,EACIi8K,SACM1/K,IAAN4kD,EACE2/I,EAAgB9gM,EAAIxO,IDyFXmF,ECxFJmqM,EAAgB9gM,EAAIxO,GDwFboF,ECxFiBkqM,EAAgB9gM,EAAI+gM,EAASvvM,GDyF7DmF,ECzFiEwqD,GDyFxDvqD,EAAID,IADf,IAAcA,EAAGC,ECtFtB,OAAOwL,CACT,CCpDO,SAASogM,GAAsB1B,EAAiB/6M,EAAQkf,EAAK87L,GAGlE,IAAI0B,EAAO,EACPxY,EAAK6W,EAAgB77L,EAAM87L,GAC3Bt7H,EAAKq7H,EAAgB77L,EAAM87L,EAAS,GACxC,KAAOh7M,EAASkf,EAAKlf,GAAUg7M,EAAQ,CACrC,MAAMnb,EAAKkb,EAAgB/6M,GACrBmkM,EAAK4W,EAAgB/6M,EAAS,GACpC08M,IAAS7c,EAAKqE,IAAOC,EAAKzkH,GAC1BwkH,EAAKrE,EACLngH,EAAKykH,CACP,CACA,OAAgB,IAATuY,OAAalmM,EAAYkmM,EAAO,CACzC,CC6DO,SAASC,GACd5B,EACA/6M,EACAkf,EACA87L,EACA4B,EACAC,EACAC,GAEA,MAAM98L,GAAKd,EAAMlf,GAAUg7M,EAC3B,GAAIh7L,EAAI,EAAG,CACT,KAAOhgB,EAASkf,EAAKlf,GAAUg7M,EAC7B6B,EAA0BC,KAAsB/B,EAAgB/6M,GAChE68M,EAA0BC,KACxB/B,EAAgB/6M,EAAS,GAE7B,OAAO88M,CACT,CAEA,MAAMC,EAAU,IAAIl9M,MAAMmgB,GAC1B+8L,EAAQ,GAAK,EACbA,EAAQ/8L,EAAI,GAAK,EAEjB,MAAM6yJ,EAAQ,CAAC7yK,EAAQkf,EAAM87L,GAC7B,IAAI17M,EAAQ,EACZ,KAAOuzK,EAAMp7K,OAAS,GAAG,CACvB,MAAMunB,EAAO6zJ,EAAM54G,MACb+iJ,EAAQnqC,EAAM54G,MACpB,IAAIgjJ,EAAqB,EACzB,MAAM/Y,EAAK6W,EAAgBiC,GACrBt9H,EAAKq7H,EAAgBiC,EAAQ,GAC7Bnd,EAAKkb,EAAgB/7L,GACrBmlL,EAAK4W,EAAgB/7L,EAAO,GAClC,IAAK,IAAIvT,EAAIuxM,EAAQhC,EAAQvvM,EAAIuT,EAAMvT,GAAKuvM,EAAQ,CAClD,MAEMkC,EAAkBnB,GAFdhB,EAAgBtvM,GAChBsvM,EAAgBtvM,EAAI,GACuBy4L,EAAIxkH,EAAImgH,EAAIsE,GAC7D+Y,EAAkBD,IACpB39M,EAAQmM,EACRwxM,EAAqBC,EAEzB,CACID,EAAqBL,IACvBG,GAASz9M,EAAQU,GAAUg7M,GAAU,EACjCgC,EAAQhC,EAAS17M,GACnBuzK,EAAM52K,KAAK+gN,EAAO19M,GAEhBA,EAAQ07M,EAASh8L,GACnB6zJ,EAAM52K,KAAKqD,EAAO0f,GAGxB,CACA,IAAK,IAAIvT,EAAI,EAAGA,EAAIuU,IAAKvU,EACnBsxM,EAAQtxM,KACVoxM,EAA0BC,KACxB/B,EAAgB/6M,EAASyL,EAAIuvM,GAC/B6B,EAA0BC,KACxB/B,EAAgB/6M,EAASyL,EAAIuvM,EAAS,IAG5C,OAAO8B,CACT,CAcO,SAASK,GACdpC,EACA/6M,EACAu7M,EACAP,EACA4B,EACAC,EACAC,EACAM,GAEA,IAAK,IAAI3xM,EAAI,EAAG8M,EAAKgjM,EAAK9jN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC7C,MAAMyT,EAAMq8L,EAAK9vM,GACjBqxM,EAAmBH,GACjB5B,EACA/6M,EACAkf,EACA87L,EACA4B,EACAC,EACAC,GAEFM,EAAenhN,KAAK6gN,GACpB98M,EAASkf,CACX,CACA,OAAO49L,CACT,CAwGO,SAASO,GAAKjgN,EAAOinL,GAC1B,OAAOA,EAAYz2J,KAAKC,MAAMzwB,EAAQinL,EACxC,CAqBO,SAASi5B,GACdvC,EACA/6M,EACAkf,EACA87L,EACA32B,EACAw4B,EACAC,GAGA,GAAI98M,GAAUkf,EACZ,OAAO49L,EAGT,IAQIjd,EAAIsE,EARJD,EAAKmZ,GAAKtC,EAAgB/6M,GAASqkL,GACnC3kG,EAAK29H,GAAKtC,EAAgB/6M,EAAS,GAAIqkL,GAC3CrkL,GAAUg7M,EAEV6B,EAA0BC,KAAsB5Y,EAChD2Y,EAA0BC,KAAsBp9H,EAIhD,GAIE,GAHAmgH,EAAKwd,GAAKtC,EAAgB/6M,GAASqkL,GACnC8f,EAAKkZ,GAAKtC,EAAgB/6M,EAAS,GAAIqkL,IACvCrkL,GAAUg7M,IACI97L,EAOZ,OAFA29L,EAA0BC,KAAsBjd,EAChDgd,EAA0BC,KAAsB3Y,EACzC2Y,QAEFjd,GAAMqE,GAAMC,GAAMzkH,GAC3B,KAAO1/E,EAASkf,GAAK,CAEnB,MAAMmmL,EAAKgY,GAAKtC,EAAgB/6M,GAASqkL,GACnCihB,EAAK+X,GAAKtC,EAAgB/6M,EAAS,GAAIqkL,GAG7C,GAFArkL,GAAUg7M,EAEN3V,GAAMxF,GAAMyF,GAAMnB,EACpB,SAGF,MAAMoZ,EAAM1d,EAAKqE,EACXsZ,EAAMrZ,EAAKzkH,EAEX+9H,EAAMpY,EAAKnB,EACXwZ,EAAMpY,EAAK5lH,EAKf69H,EAAMG,GAAOF,EAAMC,IACjBF,EAAM,GAAKE,EAAMF,GAAQA,GAAOE,GAAQF,EAAM,GAAKE,EAAMF,KACzDC,EAAM,GAAKE,EAAMF,GAAQA,GAAOE,GAAQF,EAAM,GAAKE,EAAMF,IAG3D3d,EAAKwF,EACLlB,EAAKmB,IAMPuX,EAA0BC,KAAsBjd,EAChDgd,EAA0BC,KAAsB3Y,EAChDD,EAAKrE,EACLngH,EAAKykH,EACLtE,EAAKwF,EACLlB,EAAKmB,EACP,CAIA,OAFAuX,EAA0BC,KAAsBjd,EAChDgd,EAA0BC,KAAsB3Y,EACzC2Y,CACT,CAcO,SAASa,GACd5C,EACA/6M,EACAu7M,EACAP,EACA32B,EACAw4B,EACAC,EACAM,GAEA,IAAK,IAAI3xM,EAAI,EAAG8M,EAAKgjM,EAAK9jN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC7C,MAAMyT,EAAMq8L,EAAK9vM,GACjBqxM,EAAmBQ,GACjBvC,EACA/6M,EACAkf,EACA87L,EACA32B,EACAw4B,EACAC,GAEFM,EAAenhN,KAAK6gN,GACpB98M,EAASkf,CACX,CACA,OAAO49L,CACT,CCvYO,MAAM,GAAkB,CAE7B,QAAW,SAAW,EAAIlvL,KAAK3F,IAC/B,QAAY,EAAI2F,KAAK3F,GAAK,QAAW,IACrC,GAAM,MACN,EAAK,EACL,QAAS,KAAO,MCsOlB,SA3NA,MAIE,WAAAxsB,CAAYxF,GAKVI,KAAKunN,MAAQ3nN,EAAQg/B,KASrB5+B,KAAKwnN,OAAoD5nN,EAAa,MAStEI,KAAKynN,aAA6BtnM,IAAnBvgB,EAAQ47B,OAAuB57B,EAAQ47B,OAAS,KAS/Dx7B,KAAK0nN,kBACqBvnM,IAAxBvgB,EAAQ+nN,YAA4B/nN,EAAQ+nN,YAAc,KAM5D3nN,KAAK4nN,sBACyBznM,IAA5BvgB,EAAQioN,gBAAgCjoN,EAAQioN,gBAAkB,MAMpE7nN,KAAK8nN,aAA6B3nM,IAAnBvgB,EAAQ0xC,QAAuB1xC,EAAQ0xC,OAMtDtxC,KAAK+nN,aAAe/nN,KAAK8nN,UAAW9nN,KAAKynN,SAMzCznN,KAAKgoN,wBAA0BpoN,EAAQqoN,mBAMvCjoN,KAAKkoN,iBAAmB,KAMxBloN,KAAKmoN,eAAiBvoN,EAAQwoN,aAChC,CAKA,QAAAC,GACE,OAAOroN,KAAK+nN,SACd,CAOA,OAAAz7L,GACE,OAAOtsB,KAAKunN,KACd,CAOA,SAAAjpJ,GACE,OAAOt+D,KAAKynN,OACd,CAOA,QAAAa,GACE,OAAOtoN,KAAKwnN,MACd,CASA,gBAAAe,GACE,OAAOvoN,KAAKmoN,gBAAkB,GAAgBnoN,KAAKwnN,OACrD,CAOA,cAAAgB,GACE,OAAOxoN,KAAK0nN,YACd,CAaA,kBAAAe,GACE,OAAOzoN,KAAK4nN,gBACd,CAOA,QAAAc,GACE,OAAO1oN,KAAK8nN,OACd,CAOA,SAAAa,CAAUr3K,GACRtxC,KAAK8nN,QAAUx2K,EACftxC,KAAK+nN,aAAez2K,IAAUtxC,KAAKynN,QACrC,CAKA,kBAAAmB,GACE,OAAO5oN,KAAKkoN,gBACd,CAKA,kBAAAW,CAAmBC,GACjB9oN,KAAKkoN,iBAAmBY,CAC1B,CAOA,SAAAC,CAAUvtL,GACRx7B,KAAKynN,QAAUjsL,EACfx7B,KAAK+nN,aAAe/nN,KAAK8nN,UAAWtsL,EACtC,CAQA,cAAAwtL,CAAerB,GACb3nN,KAAK0nN,aAAeC,CACtB,CAQA,qBAAAsB,CAAsBC,GACpBlpN,KAAKgoN,wBAA0BkB,CACjC,CAOA,sBAAAC,GACE,OAAOnpN,KAAKgoN,uBACd,GC1QWoB,GAAS,QAMTC,GAAY9xL,KAAK3F,GAAKw3L,GAMtB,GAAS,EAAEC,IAAYA,GAAWA,GAAWA,IAM7CC,GAAe,EAAE,KAAM,GAAI,IAAK,IAOhCC,GAAaH,GAAS7xL,KAAK70B,IAAI60B,KAAKqnK,IAAIrnK,KAAK3F,GAAK,IAM/D,MAAM43L,WAA2B,GAI/B,WAAApkN,CAAYw5B,GACVwzJ,MAAM,CACJxzJ,KAAMA,EACNqtJ,MAAO,IACPzwJ,OAAQ,GACR8V,QAAQ,EACRq2K,YAAa2B,GACbrB,mBAAoB,SAAUrtL,EAAYx2B,GACxC,OAAOw2B,EAAarD,KAAKkyL,KAAKrlN,EAAM,GAAKglN,GAC3C,GAEJ,EASK,MAAMM,GAAc,CACzB,IAAIF,GAAmB,aACvB,IAAIA,GAAmB,eACvB,IAAIA,GAAmB,eACvB,IAAIA,GAAmB,eACvB,IAAIA,GAAmB,8CACvB,IAAIA,GAAmB,iDAYlB,SAASG,GAAa/0M,EAAOypE,EAAQwnI,EAAWlB,GACrD,MAAMvjN,EAASwT,EAAMxT,OACrBykN,EAAYA,EAAY,EAAIA,EAAY,EACxClB,EAASA,GAAUkB,OACJ1lM,IAAXk+D,IAGAA,EAFEwnI,EAAY,EAELjxM,EAAM3G,QAEN,IAAIzE,MAAMpI,IAGvB,IAAK,IAAIgU,EAAI,EAAGA,EAAIhU,EAAQgU,GAAKuvM,EAAQ,CACvCtmI,EAAOjpE,GAAMi0M,GAAYz0M,EAAMQ,GAAM,IACrC,IAAI7P,EAAI6jN,GAAS7xL,KAAK70B,IAAI60B,KAAKqnK,IAAKrnK,KAAK3F,KAAOhd,EAAMQ,EAAI,GAAK,IAAO,MAClE7P,EAAIgkN,GACNhkN,EAAIgkN,GACKhkN,GAAKgkN,KACdhkN,GAAKgkN,IAEPlrI,EAAOjpE,EAAI,GAAK7P,CAClB,CACA,OAAO84E,CACT,CAWO,SAASurI,GAAWh1M,EAAOypE,EAAQwnI,EAAWlB,GACnD,MAAMvjN,EAASwT,EAAMxT,OACrBykN,EAAYA,EAAY,EAAIA,EAAY,EACxClB,EAASA,GAAUkB,OACJ1lM,IAAXk+D,IAGAA,EAFEwnI,EAAY,EAELjxM,EAAM3G,QAEN,IAAIzE,MAAMpI,IAGvB,IAAK,IAAIgU,EAAI,EAAGA,EAAIhU,EAAQgU,GAAKuvM,EAC/BtmI,EAAOjpE,GAAM,IAAMR,EAAMQ,GAAMi0M,GAC/BhrI,EAAOjpE,EAAI,GACR,IAAMmiB,KAAK61K,KAAK71K,KAAK81K,IAAIz4L,EAAMQ,EAAI,GAAKg0M,KAAY7xL,KAAK3F,GAAK,GAEnE,OAAOysD,CACT,CC7HO,MAQM,GAAS,EAAE,KAAM,GAAI,IAAK,IAM1B,GAdS,QAcU9mD,KAAK3F,GAAe,IAUpD,MAAMi4L,WAA2B,GAK/B,WAAAzkN,CAAYw5B,EAAMipL,GAChBz1B,MAAM,CACJxzJ,KAAMA,EACNqtJ,MAAO,UACPzwJ,OAAQ,GACRqsL,gBAAiBA,EACjBv2K,QAAQ,EACR82K,cAAe,GACfT,YAAa,IAEjB,EASK,MAAM,GAAc,CACzB,IAAIkC,GAAmB,UACvB,IAAIA,GAAmB,YAAa,OACpC,IAAIA,GAAmB,iCACvB,IAAIA,GAAmB,4BACvB,IAAIA,GAAmB,gDACvB,IAAIA,GAAmB,+CAAgD,OACvE,IAAIA,GAAmB,6CAA8C,QC3DvE,IAAIC,GAAQ,CAAC,ECEb,IAAIC,GAAa,CAAC,EAiBX,SAAS,GAAIntM,EAAQotM,EAAaC,GACvC,MAAMC,EAAattM,EAAO0P,UACpB69L,EAAkBH,EAAY19L,UAC9B49L,KAAcH,KAClBA,GAAWG,GAAc,CAAC,GAE5BH,GAAWG,GAAYC,GAAmBF,CAC5C,CCVA,MAEM1R,GAAI,UAKKhhL,KAAKsjB,KAAK,EAAI09J,IAyK7B,MAAM6R,GAAc,CAClB,eACA,gCACA,0DAOK,SAASC,GAAazrL,GAC3B,IAAI0rL,EAAS,EACb,IAAK,MAAM7N,KAAM2N,GAAa,CAC5B,MAAM12M,EAAQkrB,EAAKlrB,MAAM+oM,GACzB,GAAI/oM,EAAO,CACT42M,EAAS3iM,SAASjU,EAAM,IACxB,KACF,CACF,CACA,IAAK42M,EACH,OAAO,KAGT,IAAIh9K,EAAS,EACTi9K,GAAQ,EAOZ,OANID,EAAS,OAASA,EAAS,MAC7Bh9K,EAASg9K,EAAS,MACTA,EAAS,OAASA,EAAS,QACpCC,GAAQ,EACRj9K,EAASg9K,EAAS,OAEfh9K,EAIE,CAACA,SAAQi9K,SAHP,IAIX,CCxIA,MAKMC,GAAsB,CDqKrB,SAAwB5rL,GAE7B,OADayrL,GAAazrL,GAInB,IAAI,GAAW,CAACA,OAAMqtJ,MAAO,MAF3B,IAGX,GCrIO,SAASw+B,GAAe71M,EAAOypE,GACpC,QAAel+D,IAAXk+D,EACF,IAAK,IAAIjpE,EAAI,EAAG8M,EAAKtN,EAAMxT,OAAQgU,EAAI8M,IAAM9M,EAC3CipE,EAAOjpE,GAAKR,EAAMQ,QAIpBipE,EAASzpE,EAAM3G,QAEjB,OAAOowE,CACT,CAwBO,SAASqsI,GAAcphC,IH9IvB,SAAa1qJ,EAAM0qJ,GACxBwgC,GAAMlrL,GAAQ0qJ,CAChB,CG6IEtoK,CAAQsoK,EAAWh9J,UAAWg9J,GAC9B,GAAiBA,EAAYA,EAAYmhC,GAC3C,CAkBO,SAAS,GAAIE,GAClB,GAAgC,iBAAnBA,EACX,OAAOA,EAET,MAAMrhC,EHlLJwgC,GAFgBlrL,EGoLS+rL,IHjLzBb,GAAMlrL,EAAKvwB,QAAQ,yCAA0C,aAC7D,KAJG,IAAauwB,EGqLlB,GAAI0qJ,EACF,OAAOA,EAET,IAAK,MAAMshC,KAAkBJ,GAAqB,CAChD,MAAMlhC,EAAashC,EAAeD,GAClC,GAAIrhC,EACF,OAAOA,CAEX,CACA,OAAO,IACT,CAoFO,SAASuhC,GAAyBC,IAhHlC,SAAwBA,GAC7BA,EAAYlhN,QAAQ8gN,GACtB,CA+GEK,CAAeD,GACfA,EAAYlhN,SAAQ,SAAUgT,GAC5BkuM,EAAYlhN,SAAQ,SAAUogN,GACxBptM,IAAWotM,GACb,GAAiBptM,EAAQotM,EAAaS,GAE1C,GACF,GACF,CA8hBO,IA7gBLO,GACAC,GACAC,GA8gBAL,GAAyB,IACzBA,GAAyB,IAjhBzBG,GAshBE,GArhBFC,GAshBEtB,GArhBFuB,GAshBEtB,GAHA,GAjhBWhgN,SAAQ,SAAUuhN,GAC7BH,GAAaphN,SAAQ,SAAUwhN,GAC7B,GAAiBD,EAAaC,EAAaH,IAC3C,GAAiBG,EAAaD,EAAaD,GAC7C,GACF,IC/SW,IAAI1hN,MAAM,GAkKhB,SAAS6hN,GAAQ32K,EAAWwyK,EAAKC,EAAKmE,EAAIC,EAAI9mH,EAAO2iH,EAAKC,GAC/D,MAAMvmB,EAAMvpK,KAAKupK,IAAIr8F,GACfo8F,EAAMtpK,KAAKspK,IAAIp8F,GAOrB,OANA/vD,EAAU,GAAK42K,EAAKzqB,EACpBnsJ,EAAU,GAAK62K,EAAKzqB,EACpBpsJ,EAAU,IAAM42K,EAAKxqB,EACrBpsJ,EAAU,GAAK62K,EAAK1qB,EACpBnsJ,EAAU,GAAK0yK,EAAMkE,EAAKzqB,EAAMwmB,EAAMiE,EAAKxqB,EAAMomB,EACjDxyK,EAAU,GAAK0yK,EAAMmE,EAAKzqB,EAAMumB,EAAMkE,EAAK1qB,EAAMsmB,EAC1CzyK,CACT,CCxJA,MAAM82K,GDbG,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GCoBzB,MAAMC,GAUJ,WAAArmN,CAAY8G,EAAMw4M,EAAiBQ,EAAMP,EAAQzzC,EAAYhtK,GAI3DlE,KAAKy6K,cAMLz6K,KAAKynN,QAMLznN,KAAK0rN,IAAMxnN,EAMXlE,KAAK2rN,MAAQz/M,EAMblM,KAAK4rN,iBAAmBlH,EAMxB1kN,KAAK6rN,oBAAsB,KAM3B7rN,KAAK8rN,eAAiB,KAMtB9rN,KAAK+rN,MAAQ7G,GAAQ,KAMrBllN,KAAKgsN,YAAc96C,EAMnBlxK,KAAKisN,kBAMLjsN,KAAKksN,QAAUvH,EAMf3kN,KAAKmsN,mBACP,CAQA,GAAA31L,CAAI1vB,GACF,OAAO9G,KAAKgsN,YAAYllN,EAC1B,CAOA,SAAAw3D,GAYE,OAXKt+D,KAAKynN,UACRznN,KAAKynN,QACY,UAAfznN,KAAK2rN,MhB6EN,SAAsCz/L,EAAYlG,GACvD,MAAM1gB,EAAI4mB,EAAW,GACf3mB,EAAI2mB,EAAW,GACrB,OAAOm4L,GAAe/+M,EAAGC,EAAGD,EAAGC,EAAGygB,EACpC,CgBhFYomM,CAA6BpsN,KAAK4rN,kBAClCnH,GACEzkN,KAAK4rN,iBACL,EACA5rN,KAAK4rN,iBAAiBxqN,OACtB,IAGHpB,KAAKynN,OACd,CAKA,oBAAA4E,GACE,IAAKrsN,KAAK6rN,oBAAqB,CAC7B,MAAMS,EAAa,GAAUtsN,KAAKs+D,aAClCt+D,KAAK6rN,oBAAsB1G,GACzBnlN,KAAK4rN,iBACL,EACA5rN,KAAK+rN,MACL,EACAO,EACA,EAEJ,CACA,OAAOtsN,KAAK6rN,mBACd,CAKA,qBAAAU,GACE,IAAKvsN,KAAK6rN,oBAAqB,CAC7B,MAAM3G,EXLL,SAAqBR,EAAiBQ,GAC3C,MAAMsH,EAAQ,GACd,IAEIC,EAFA9iN,EAAS,EACT+iN,EAAe,EAEnB,IAAK,IAAIt3M,EAAI,EAAG8M,EAAKgjM,EAAK9jN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC7C,MAAMyT,EAAMq8L,EAAK9vM,GAEXu3M,EAAcvG,GAAsB1B,EAAiB/6M,EAAQkf,EAAK,GAIxE,QAHyB1I,IAArBssM,IACFA,EAAmBE,GAEjBA,IAAgBF,EAClBD,EAAM5mN,KAAKs/M,EAAKj3M,MAAMy+M,EAAct3M,EAAI,QACnC,CACL,GAAqB,IAAjBo3M,EAAMprN,OACR,SAEForN,EAAMA,EAAMprN,OAAS,GAAGwE,KAAKs/M,EAAKwH,GACpC,CACAA,EAAet3M,EAAI,EACnBzL,EAASkf,CACX,CACA,OAAO2jM,CACT,CWnBmB,CAAYxsN,KAAK4rN,iBAAkB5rN,KAAK+rN,OAC/C3G,ECpLL,SAAsBV,EAAiB/6M,EAAQ6iN,EAAO7H,GAC3D,MAAMS,EAAc,GACpB,IAAI5pL,EjBsLG,CAAC8d,IAAUA,KAAU,KAAW,KiBrLvC,IAAK,IAAIlkC,EAAI,EAAG8M,EAAKsqM,EAAMprN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC9C,MAAM8vM,EAAOsH,EAAMp3M,GACnBomB,EAASipL,GACPC,EACA/6M,EACAu7M,EAAK,GACLP,GAEFS,EAAYx/M,MAAM41B,EAAO,GAAKA,EAAO,IAAM,GAAIA,EAAO,GAAKA,EAAO,IAAM,GACxE7xB,EAASu7M,EAAKA,EAAK9jN,OAAS,EAC9B,CACA,OAAOgkN,CACT,CDqK0BwH,CAAmB5sN,KAAK4rN,iBAAkB,EAAG1G,EAAM,GACvEllN,KAAK6rN,oBd1GJ,SACLnH,EACA/6M,EACA6iN,EACA7H,EACAS,GAGA,IAAIyH,EAAiB,GACrB,IAAK,IAAIz3M,EAAI,EAAG8M,EAAKsqM,EAAMprN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC9C,MAAM8vM,EAAOsH,EAAMp3M,GACnBy3M,EAAiB1H,GACfT,EACA/6M,EACAu7M,EACAP,EACAS,EACA,EAAIhwM,EACJy3M,GAEFljN,EAASu7M,EAAKA,EAAK9jN,OAAS,EAC9B,CACA,OAAOyrN,CACT,CcmFiCC,CACzB9sN,KAAK4rN,iBACL,EACA1G,EACA,EACAE,EAEJ,CACA,OAAOplN,KAAK6rN,mBACd,CAKA,eAAAkB,GAUE,OATK/sN,KAAK8rN,iBACR9rN,KAAK8rN,eAAiBnG,GACpB3lN,KAAK4rN,iBACL,EACA5rN,KAAK4rN,iBAAiBxqN,OACtB,EACA,KAGGpB,KAAK8rN,cACd,CAKA,gBAAAkB,GACE,IAAKhtN,KAAK8rN,eAAgB,CACxB9rN,KAAK8rN,eAAiB,GACtB,MAAMpH,EAAkB1kN,KAAK4rN,iBAC7B,IAAIjiN,EAAS,EACb,MAAMu7M,EAAqCllN,KAAU,MACrD,IAAK,IAAIoV,EAAI,EAAG8M,EAAKgjM,EAAK9jN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC7C,MAAMyT,EAAMq8L,EAAK9vM,GACX63M,EAAWtH,GAAiBjB,EAAiB/6M,EAAQkf,EAAK,EAAG,IACnE+kC,GAAO5tD,KAAK8rN,eAAgBmB,GAC5BtjN,EAASkf,CACX,CACF,CACA,OAAO7oB,KAAK8rN,cACd,CAQA,KAAAl6C,GACE,OAAO5xK,KAAK0rN,GACd,CAKA,0BAAAwB,GACE,OAAOltN,KAAK4rN,gBACd,CAQA,WAAAnyL,GACE,OAAOz5B,IACT,CAMA,qBAAAmtN,CAAsB5G,GACpB,OAAOvmN,IACT,CAQA,mBAAAotN,CAAoB7G,EAAkB7xK,GACpC,OAAO10C,IACT,CAOA,aAAA0qC,GACE,OAAO1qC,KAAKgsN,WACd,CAOA,qBAAAqB,GACE,OAAOrtN,KAAKgsN,WACd,CAKA,SAAAsB,GACE,OAAOttN,KAAKksN,OACd,CAKA,gBAAA9wL,GACE,OAAOp7B,KAAKy6K,aACd,CAOA,OAAA/gJ,GACE,OAAO15B,KAAK2rN,KACd,CAOA,SAAAj3K,CAAU40I,GAER,MAAMikC,GADNjkC,EAAa,GAAcA,IACIhrH,YACzBkvJ,EAAkBlkC,EAAWk/B,iBACnC,GAAI+E,GAAeC,EAAiB,CAClC,MAAMl+M,EAAQw1M,GAAU0I,GAAmB1I,GAAUyI,GACrDlC,GACEG,GACAgC,EAAgB,GAChBA,EAAgB,GAChBl+M,GACCA,EACD,EACA,EACA,GE1UD,SACLo1M,EACA/6M,EACAkf,EACA87L,EACAjwK,EACA1uB,EACAynM,GAEAznM,EAAOA,GAAc,GACrBynM,EAAoBA,GAAwC,EAC5D,IAAIr4M,EAAI,EACR,IAAK,IAAIwR,EAAIjd,EAAQid,EAAIiC,EAAKjC,GAAK+9L,EAAQ,CACzC,MAAMr/M,EAAIo/M,EAAgB99L,GACpBrhB,EAAIm/M,EAAgB99L,EAAI,GAC9BZ,EAAK5Q,KAAOs/B,EAAU,GAAKpvC,EAAIovC,EAAU,GAAKnvC,EAAImvC,EAAU,GAC5D1uB,EAAK5Q,KAAOs/B,EAAU,GAAKpvC,EAAIovC,EAAU,GAAKnvC,EAAImvC,EAAU,GAE5D,IAAK,IAAI/uC,EAAI,EAAGA,EAAI8nN,EAAmB9nN,IACrCqgB,EAAK5Q,KAAOsvM,EAAgB99L,EAAIjhB,EAEpC,CAEIqgB,GAAQA,EAAK5kB,QAAUgU,IACzB4Q,EAAK5kB,OAASgU,EAGlB,CFiTMs4M,CACE1tN,KAAK4rN,iBACL,EACA5rN,KAAK4rN,iBAAiBxqN,OACtB,EACAoqN,GACAxrN,KAAK4rN,iBAET,CACF,CASA,cAAA+B,CAAe1D,GACbA,EAAYjqN,KAAK4rN,iBAAkB5rN,KAAK4rN,iBAAkB5rN,KAAKksN,QACjE,CAKA,KAAAxvM,GACE,OAAO,IAAI+uM,GACTzrN,KAAK2rN,MACL3rN,KAAK4rN,iBAAiB39M,QACtBjO,KAAK+rN,OAAO99M,QACZjO,KAAKksN,QACLhrN,OAAOwX,OAAO,CAAC,EAAG1Y,KAAKgsN,aACvBhsN,KAAK0rN,IAET,CAKA,OAAAkC,GACE,OAAO5tN,KAAK+rN,KACd,CAMA,yBAAA8B,GAkEE,OAjEA7tN,KAAKotN,oBGpWF,SAAoB/5K,GAEzB,IAAIy6K,EAGAC,EAEAC,EAMJ,OAAO,WACL,MAAMC,EAAWzkN,MAAMrE,UAAU8I,MAAM9O,KAAK4O,WAM5C,OALKggN,GAAY/tN,OAASguN,GpB0IvB,SAAgBE,EAAMC,GAC3B,MAAM1Z,EAAOyZ,EAAK9sN,OAClB,GAAIqzM,IAAS0Z,EAAK/sN,OAChB,OAAO,EAET,IAAK,IAAIgU,EAAI,EAAGA,EAAIq/L,EAAMr/L,IACxB,GAAI84M,EAAK94M,KAAO+4M,EAAK/4M,GACnB,OAAO,EAGX,OAAO,CACT,CoBrJ2C,CAAY64M,EAAUF,KAC3DC,EAAWhuN,KACX+tN,EAAWE,EACXH,EAAaz6K,EAAG70B,MAAMxe,KAAM+N,YAEvB+/M,CACT,CACF,CH8U+BM,EAAW,CAAC7H,EAAkB7xK,KACvD,GAAI6xK,IAAqBvmN,KAAKisN,kBAC5B,OAAOjsN,KAAKmsN,oBAEdnsN,KAAKmsN,oBAAsBnsN,KAAK0c,QAC5Bg4B,GACF10C,KAAKmsN,oBAAoBwB,eAAej5K,GAE1C,MAAM8xK,EACJxmN,KAAKmsN,oBAAoBkC,qBAC3B,IAAItH,EACJ,OAAQ/mN,KAAK2rN,OACX,IAAK,aACHnF,EAA0BplN,OAASklN,GACjCE,EACA,EACAxmN,KAAKmsN,oBAAoBP,iBAAiBxqN,OAC1CpB,KAAKmsN,oBAAoBD,QACzB3F,EACAC,EACA,GAEFO,EAAiB,CAACP,EAA0BplN,QAC5C,MACF,IAAK,kBACH2lN,EAAiB,GACjBP,EAA0BplN,OAAS0lN,GACjCN,EACA,EACAxmN,KAAKmsN,oBAAoBJ,MACzB/rN,KAAKmsN,oBAAoBD,QACzB3F,EACAC,EACA,EACAO,GAEF,MACF,IAAK,UACHA,EAAiB,GACjBP,EAA0BplN,OAASkmN,GACjCd,EACA,EACAxmN,KAAKmsN,oBAAoBJ,MACzB/rN,KAAKmsN,oBAAoBD,QACzB30L,KAAKsjB,KAAK0rK,GACVC,EACA,EACAO,GAgBN,OAXIA,IACF/mN,KAAKmsN,oBAAsB,IAAIV,GAC7BzrN,KAAK2rN,MACLnF,EACAO,EACA,EACA/mN,KAAKgsN,YACLhsN,KAAK0rN,MAGT1rN,KAAKisN,kBAAoB1F,EAClBvmN,KAAKmsN,mBAAmB,IAE1BnsN,IACT,EAMFyrN,GAActmN,UAAUkpN,mBACtB5C,GAActmN,UAAU+nN,2BA8D1B,Y,oEIjhBA,MAAM,GAA+BluN,GAAGyH,OAAO61D,OCAzC,GAA+Bt9D,GAAGsvN,UCAlC,GAA+BtvN,GAAGuvN,KCAlCC,GAAgB,yBAQf,SAASC,GAAcjvN,GAC5B,MAAMujB,EAAa,YACnB,OAAgC,IAA5BvjB,EAAIia,QAAQsJ,GACP,GAEFvjB,EAAIyO,MAAM8U,EACnB,CA+BO,SAAS,GAAkBvjB,EAAKkvN,GACrC,MAAMC,EAAaF,GAAcjvN,GACjC,IAAKmvN,EACH,OAAOC,UAAU,IAAIC,IAAIrvN,EAAKkP,SAAS+3C,MAAMA,MAE/C,MAAM1jC,EAAa,UACnB,GAAuC,IAAnC4rM,EAAWl1M,QAAQsJ,GACrB,MAAM,IAAItjB,MAAM,yBAAyBD,KAE3C,MAAMP,EAAQ0vN,EAAW1gN,MAAM8U,GAE/B,MAAO,GAAGyrM,gBAA2BvvN,mBAAuByvN,GAC9D,CAEA,MAAMI,GAAmB,CAAC,IAAK,IAAK,IAAK,KAWlC,SAASC,GAAmBvvN,EAAKkvN,EAAOM,EAAYC,GACzD,MAAMC,EAAY,IAAIL,IAAIrvN,EAAKyvN,GAAYvgN,SAAS+3C,MAC9CkoK,EAAaF,GAAcjvN,GACjC,IAAKmvN,EACH,OAAKD,GAGAQ,EAAUC,aAAa1+B,IAAIu+B,IAC9BE,EAAUC,aAAahoN,IAAI6nN,EAAYN,GAElC,CAACE,UAAUM,EAAUzoK,QALnB,CAACmoK,UAAUM,EAAUzoK,OAQhC,GAAmB,qBAAfkoK,EAAmC,CACrC,MAAMS,EAAa7tN,OAAO4jD,kBAAoB,IAAM,MAAQ,GAC5D,MAAO,CACL,6BAA6BwpK,gBAAyBS,uBAAgCV,IAE1F,CACA,OAAOI,GAAiB7oN,KACrB0nJ,GACC,WAAWA,yBAA2BghE,yCAAkDD,KAE9F,CC9EA,MAAMW,GAAyB,CAAC,EAC1BC,GAAuB,CAAC,EAE9B,IAAIC,GAAU,EACP,SAASC,GAAWC,GAIzB,OAHKA,EAAQvrN,KACXurN,EAAQvrN,GAAKqrN,MAERE,EAAQvrN,EACjB,CAsCO,SAAS,GAAQ4qC,GACtB,OAAQA,EAAUvX,KAAK3F,GAAM,GAC/B,CAEO,MAAM,GAAqB,WAChC,MAAM89L,EAAc,GACpB,IAAK,IAAIC,EAAM,kBAAmBD,EAAYtuN,QAAU,GAAIuuN,GAAO,EACjED,EAAY9pN,KAAK+pN,GAEnB,OAAOD,CACR,CANiC,GAa3B,SAASE,GAAa93M,EAAO/O,GAClC,GAAiC,oBAAtB8mN,mBAAqClnN,gBAAgBknN,mBAAgD,oBAApBC,gBAC1F,OAAwB,IAAKA,gBAAgBh4M,EAAO/O,GAEtD,MAAMuzD,EAAS9zD,SAASC,cAAc,UAGtC,OAFA6zD,EAAOxkD,MAAQA,EACfwkD,EAAOvzD,OAASA,EACTuzD,CACT,CAEO,SAAS,GAAqB1hC,EAAY80L,GAC/C,IAAIt6M,EAAI,EACR,MAAM8M,EAAKwtM,EAAYtuN,OACvB,KAAOgU,EAAI8M,IAAM9M,EAAG,CAElB,GADkBs6M,EAAYt6M,GACdwlB,GAAcxlB,EAAI,EAAI8M,EAAI,CACxC,MAAM6tM,EAAaL,EAAYt6M,GAAKs6M,EAAYt6M,EAAI,GACpD,OAAOA,EAAImiB,KAAK70B,IAAIgtN,EAAYt6M,GAAKwlB,GAAcrD,KAAK70B,IAAIqtN,EAC9D,CACF,CACA,OAAO7tM,EAAK,CACd,CAQA,MAAM8tM,GAAkB,CAAC,EAUlB,SAASC,GAAcC,EAAc1wN,EAAKI,EAAU,CAAC,EAAGuiB,GAC7D,GAAI3iB,KAAOwwN,GAIT,OAHI7tM,IACFA,EAAS3iB,IAAMwwN,GAAgBxwN,GAAK,GAAGA,KAElCwwN,GAAgBxwN,GAAK,GAE9B,MAAM2wN,EAAqBvwN,EAAQwwN,kBAC/BxwN,EAAQwwN,iBAAiB5wN,EAAK0wN,IAC9B1wN,EACE6wN,EAAc,SAAU3vN,GAE5B,cADOsvN,GAAgBxwN,GAChBsB,QAAQE,OAAO,IAAIvB,MAAM,yBAA2BD,GAC7D,EACM8wN,EAAiB,SAAU/vN,GAE/B,cADOyvN,GAAgBxwN,GAChBe,EAASqB,GACZrB,EAASuR,OACThR,QAAQE,OAAO,IAAIvB,MAAM,yBAA2BD,GAC1D,EACM+wN,GAAiB,KAAAC,YAAU,IAAML,IACpC7vN,MAAM6vN,GACDA,aAA8BzqL,UAC5BvjB,IACFA,EAAS3iB,IAAM2wN,EAAmB3wN,KAE7B8wN,EAAeH,KAElBA,aAA8B1qL,UAClC0qL,EAAqB,IAAI1qL,QAAQ0qL,IAE9BA,EAAmBhwN,QAAQq2B,IAAI,WAClC25L,EAAmBhwN,QAAQgH,IAAI,SAAU,oBAEvCgb,IACFA,EAAS3iB,IAAM2wN,EAAmB3wN,KAE7ByjB,MAAMktM,GAAoB7vN,KAAKgwN,GAAgB7vN,MAAM4vN,MAE7D5vN,MAAM4vN,GAET,OADAL,GAAgBxwN,GAAO,CAAC2wN,EAAoBI,GACrCA,CACT,CAEO,SAAS,GAAWE,EAAc7wN,GACvC,GAA4B,iBAAjB6wN,EAaT,OAAO3vN,QAAQC,QAAQ0vN,GAZvB,IAAIA,EAAazuM,OAAOe,WAAW,KASjC,OAAOktM,GAAc,QADrBQ,EAAe,GAAkBA,EAAc7wN,EAAQ8wN,aACX9wN,GAR5C,IACE,MAAM6vN,EAAUjsN,KAAKC,MAAMgtN,GAC3B,OAAO3vN,QAAQC,QAAQ0uN,EACzB,CAAE,MAAO/uN,GACP,OAAOI,QAAQE,OAAON,EACxB,CAQN,CAEA,MAAMiwN,GAAgB,CAAC,EAwIhB,SAASC,GACdC,EACAC,EACAC,EACAC,GAEA,MAAMC,EAAU,CACd,EAAIF,EAAYD,EAAgBI,WAAaJ,EAAgBh5M,MAC7D,EAAIi5M,EAAYD,EAAgBI,WAAaJ,EAAgB/nN,QAEzDooN,EAAcvB,GAAaqB,EAAQ,GAAIA,EAAQ,IAC/CG,EAAeD,EAAY50J,WAAW,MAC5C60J,EAAa50J,UACXq0J,EACAC,EAAgBxrN,EAChBwrN,EAAgBvrN,EAChBurN,EAAgBh5M,MAChBg5M,EAAgB/nN,OAChBgoN,EAAYD,EAAgBI,WAC5BH,EAAYD,EAAgBI,WAC5BJ,EAAgBh5M,MAChBg5M,EAAgB/nN,QAElB,MAAM0zD,EAAY20J,EAAa10J,aAAa,EAAG,EAAGu0J,EAAQ,GAAIA,EAAQ,IACtEG,EAAaC,yBAA2B,mBACxCD,EAAaE,UAAY,QAAsB,IAAdN,EAAU3iL,KAAyB,IAAd2iL,EAAU1rL,KAChD,IAAd0rL,EAAUx2M,KACRw2M,EAAUz2M,KACd,MAAM1a,EAAO48D,EAAU58D,KACvB,IAAK,IAAIuV,EAAI,EAAG8M,EAAKu6C,EAAU3kD,MAAO1C,EAAI8M,IAAM9M,EAC9C,IAAK,IAAIwR,EAAI,EAAG2qM,EAAK90J,EAAU1zD,OAAQ6d,EAAI2qM,IAAM3qM,EAAG,CAEpC/mB,EADe,GAAd+mB,EAAI1E,EAAK9M,GACG,GACf,GACVg8M,EAAaI,IACXp8M,EACAwR,EACAmqM,EAAYD,EAAgBI,WAC5B,EACA,EAAI35L,KAAK3F,GAGf,CAGF,OADAw/L,EAAal1M,OACNi1M,CACT,CAEA,SAASM,GAAWh/M,EAAKE,EAAK5L,GAC5B,MAAMzB,EAAIiyB,KAAK5kB,IAAI,EAAG4kB,KAAK9kB,IAAI,GAAI1L,EAAQ0L,IAAQE,EAAMF,KACzD,OAAOnN,EAAIA,GAAK,EAAI,EAAIA,EAC1B,CAQO,SAASosN,GAAQ38M,EAAOs0D,EAAMrxD,GACnC,MAAMm5M,EAAcvB,GAAavmJ,EAAKvxD,MAAOuxD,EAAKtgE,QAC5CqoN,EAAeD,EAAY50J,WAAW,MAC5C60J,EAAa50J,UACXznD,EACAs0D,EAAK/jE,EACL+jE,EAAK9jE,EACL8jE,EAAKvxD,MACLuxD,EAAKtgE,OACL,EACA,EACAsgE,EAAKvxD,MACLuxD,EAAKtgE,QAEP,MAAM0zD,EAAY20J,EAAa10J,aAAa,EAAG,EAAG2M,EAAKvxD,MAAOuxD,EAAKtgE,QAC7DlJ,EAAO48D,EAAU58D,KACvB,IAAK,IAAIuV,EAAI,EAAG8M,EAAKu6C,EAAU3kD,MAAO1C,EAAI8M,IAAM9M,EAC9C,IAAK,IAAIwR,EAAI,EAAG2qM,EAAK90J,EAAU1zD,OAAQ6d,EAAI2qM,IAAM3qM,EAAG,CAClD,MAAM3d,EAAuB,GAAd2d,EAAI1E,EAAK9M,GAGlBy4K,EAAS,IACT1nE,EAAQ,GAERp4E,EAAQ0jL,GAAW5jC,EAAS1nE,EAAO0nE,EAAS1nE,EALrCtmH,EAAKoJ,EAAQ,GAAK,KAM3B8kC,EAAQ,GACVluC,EAAKoJ,EAAQ,GAAKsuB,KAAKC,MAAM,IAAMxf,EAAMq2B,EAAIN,GAC7CluC,EAAKoJ,EAAQ,GAAKsuB,KAAKC,MAAM,IAAMxf,EAAMstB,EAAIyI,GAC7CluC,EAAKoJ,EAAQ,GAAKsuB,KAAKC,MAAM,IAAMxf,EAAMwC,EAAIuzB,GAC7CluC,EAAKoJ,EAAQ,GAAKsuB,KAAKC,MAAM,IAAMuW,IAEnCluC,EAAKoJ,EAAQ,GAAK,CAEtB,CAGF,OADAmoN,EAAax0J,aAAaH,EAAW,EAAG,GACjC00J,CACT,CCxZA,MAAMQ,GAAgBnoN,MAAM,KAAK1D,KAAK,KAC/B,SAAS8rN,GAAmB/vN,EAAMgwN,GACvC,GAAIA,GAAiB,IAAM,CACzB,IAAIC,EAAwB,GAC5B,MAAM9qC,EAAQnlL,EAAK+W,MAAM,MACnBm5M,EAAkBJ,GAAc1jN,MACpC,EACAspB,KAAKC,MAAMq6L,EAAgB,KAE7B,IAAK,IAAInuM,EAAI,EAAG0uE,EAAK40F,EAAM5lL,OAAQsiB,EAAI0uE,IAAM1uE,EACvCA,EAAI,IACNouM,GAAyB,MAE3BA,GAAyB9qC,EAAMtjK,GAAG9K,MAAM,IAAI9S,KAAKisN,GAEnD,OAAOD,CACT,CACA,OAAOjwN,CACT,CAEA,IAAImwN,GACJ,SAASC,KAIP,OAHKD,KACHA,GAAiBpC,GAAa,EAAG,GAAGrzJ,WAAW,OAE1Cy1J,EACT,CAEA,SAASrwI,GAAY9/E,EAAMgwN,GACzB,OACEI,KAAoBtwI,YAAY9/E,GAAMiW,OACrCjW,EAAKT,OAAS,GAAKywN,CAExB,CAEA,MAAMK,GAAe,CAAC,EACf,SAASC,GAAStwN,EAAMg1B,EAAMu7L,EAAIP,GACvC,IAA4B,IAAxBhwN,EAAK4X,QAAQ,MAAc,CAC7B,MAAM44M,EAAYxwN,EAAK+W,MAAM,MACvBouK,EAAQ,GACd,IAAK,IAAI5xK,EAAI,EAAG8M,EAAKmwM,EAAUjxN,OAAQgU,EAAI8M,IAAM9M,EAC/C4xK,EAAMphL,KAAKusN,GAASE,EAAUj9M,GAAIyhB,EAAMu7L,EAAIP,IAE9C,OAAO7qC,EAAMlhL,KAAK,KACpB,CACA,MAAMgB,EAAMsrN,EAAK,IAAMv7L,EAAO,IAAMh1B,EAAO,IAAMgwN,EACjD,IAAIS,EAAcJ,GAAaprN,GAC/B,IAAKwrN,EAAa,CAChB,MAAMC,EAAQ1wN,EAAK+W,MAAM,KACzB,GAAI25M,EAAMnxN,OAAS,EAAG,CACpB,MAAMwf,EAAMqxM,KACZrxM,EAAIiW,KAAOA,EACX,MACM27L,EADQ5xM,EAAI+gE,YAAY,KAAK7pE,MACVs6M,EACzB,IAAIn2M,EAAO,GACX,MAAM+qK,EAAQ,GAEd,IAAK,IAAI5xK,EAAI,EAAG8M,EAAKqwM,EAAMnxN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC9C,MAAMq9M,EAAOF,EAAMn9M,GACbs9M,EAAWz2M,GAAQA,EAAO,IAAM,IAAMw2M,EACxC9wI,GAAY+wI,EAAUb,IAAkBW,EAC1Cv2M,EAAOy2M,GAEHz2M,GACF+qK,EAAMphL,KAAKqW,GAEbA,EAAOw2M,EAEX,CACIx2M,GACF+qK,EAAMphL,KAAKqW,GAGb,IAAK,IAAI7G,EAAI,EAAG8M,EAAK8kK,EAAM5lL,OAAQgU,EAAI8M,GAAMA,EAAK,IAAK9M,EAAG,CACxD,MAAM6G,EAAO+qK,EAAM5xK,GACnB,GAAIusE,GAAY1lE,EAAM41M,GAA4B,IAAXW,EAAiB,CACtD,MAAMG,EACJv9M,EAAI,EAAIusE,GAAYqlG,EAAM5xK,EAAI,GAAIy8M,GAAiBv4K,IAC/Cs5K,EACJx9M,EAAI8M,EAAK,EAAIy/D,GAAYqlG,EAAM5xK,EAAI,GAAIy8M,GAAiBv4K,IAC1D0tI,EAAMjhJ,OAAO3wB,EAAG,GAChB8M,GAAM,EACFywM,EAAYC,GACd5rC,EAAM5xK,EAAI,IAAM,IAAM6G,EACtB7G,GAAK,GAEL4xK,EAAM5xK,GAAK6G,EAAO,IAAM+qK,EAAM5xK,EAElC,CACF,CAEA,IAAK,IAAIA,EAAI,EAAG8M,EAAK8kK,EAAM5lL,OAAS,EAAGgU,EAAI8M,IAAM9M,EAAG,CAClD,MAAM6G,EAAO+qK,EAAM5xK,GACbwS,EAAOo/J,EAAM5xK,EAAI,GACvB,GACEusE,GAAY1lE,EAAM41M,GAA4B,GAAXW,GACnC7wI,GAAY/5D,EAAMiqM,GAA4B,GAAXW,EACnC,CACA,MAAMK,EAAY52M,EAAKrD,MAAM,KACvBk6M,EAAWD,EAAUjvJ,MACvB+d,GAAYmxI,EAAUjB,GAA4B,GAAXW,IACzCxrC,EAAM5xK,GAAKy9M,EAAU/sN,KAAK,KAC1BkhL,EAAM5xK,EAAI,GAAK09M,EAAW,IAAMlrM,GAElC1F,GAAM,CACR,CACF,CACAowM,EAActrC,EAAMlhL,KAAK,KAC3B,MACEwsN,EAAczwN,EAEhBywN,EAAcV,GAAmBU,EAAaT,GAC9CK,GAAaprN,GAAOwrN,CACtB,CACA,OAAOA,CACT,CAEA,MAAMS,GAAkB,yBAClBC,GAAmB,SACzB,IAAIC,GACJ,SAASC,GAAcC,GACrB,IAAKF,GAAoB,CACvBA,GAAqB,CAAC,EACtB,MAAMG,EAAc5qN,SAAS4qN,YAC7B,IAAK,IAAIh+M,EAAI,EAAG8M,EAAKkxM,EAAYhyN,OAAQgU,EAAI8M,IAAM9M,EAAG,CACpD,MAAMi+M,EAA2CD,EAAYh+M,GAC7D,IACE,MAAMk+M,EAAWD,EAAWE,OAASF,EAAWC,SAChD,GAAIA,EACF,IAAK,IAAI1sM,EAAI,EAAG2qM,EAAK+B,EAASlyN,OAAQwlB,EAAI2qM,IAAM3qM,EAAG,CACjD,MAAM4sM,EAAUF,EAAS1sM,GACzB,GAAoB,GAAhB4sM,EAAQtnN,KAAW,CACrB,MAAMwH,EAAQ8/M,EAAQhtM,QAAQ9S,MAAMq/M,IACpCE,GAAmBv/M,EAAM,GAAGrF,QAAQ2kN,GAAkB,MAAO,CAC/D,CACF,CAEJ,CAAE,MAEF,CACF,CACF,CACA,OAAOG,KAAUF,EACnB,CAEA,MAAMQ,GAAwB,CAAC,ECtG/B,MAAM,GAAQ,CACZ,MAAS,EACT,WAAc,EACd,WAAc,EACd,gBAAmB,EACnB,QAAW,EACX,aAAgB,GAEZ,GAAS,CACb,OAAU,CAAC,GAAK,IAChB,KAAQ,CAAC,EAAG,IACZ,MAAS,CAAC,EAAG,IACb,IAAO,CAAC,GAAK,GACb,OAAU,CAAC,GAAK,GAChB,WAAY,CAAC,EAAG,GAChB,YAAa,CAAC,EAAG,GACjB,cAAe,CAAC,EAAG,GACnB,eAAgB,CAAC,EAAG,IAkBhBC,GAAW,CAAC,EACZC,GAAU,CAAC5nC,KAAM,GACvB,IAAI6nC,GAA0BC,GAavB,SAAS,GACdrnN,EACAsnN,EACArzJ,EACAsrH,EACAjzJ,EACAi7L,EACAjvB,GAEA,MAAMhxI,EAAUtnD,EAAMtI,GACjB6vN,IACHA,EAAgB,CAAC,EACjBtxN,QAAQ+Q,KAAK,4CAEVugN,EAAcjgK,KACjBigK,EAAcjgK,GAAW,CAAC,GAE5B,MAAMqwJ,EAAY4P,EAAcjgK,GAChC,IAAKqwJ,EAAU1jJ,GAAW,CACxB,IAAI15D,GAASyF,EAAMsnN,IAAkBJ,IAAUjzJ,GAC/C,MAAMq4I,EAAe,GAAK,GAAGgb,KAAiBtnN,EAAMN,QAAQu0D,QAC9CtgD,IAAVpZ,IACFA,EAAQ+xM,EAAazwI,SAEvB,IAAI2rJ,EAAS5a,GAAaryM,GAK1B,IAJKitN,GAAU,GAAWjtN,KACxBA,EAAQs0M,GAAgBt0M,EAAO+xM,GAC/Bkb,GAAS,GAEPA,EAAQ,CACV,MAAMC,EA5DW,SAAUC,EAAepb,GAC9C,MAAMmb,EAAqBha,GACzBia,EACApb,GAEF,GAAkC,UAA9Bmb,EAAmBhpN,OACrB,MAAM,IAAIxL,MACRw0N,EAAmBltN,MAChBd,KAAK0iD,GAAQ,GAAGA,EAAI7hD,QAAQ6hD,EAAI7mD,YAChCgE,KAAK,OAGZ,OAAOmuN,EAAmBltN,KAC5B,CA+CiCotN,CAAeptN,EAAO+xM,GACjDqL,EAAU1jJ,GACRwzJ,EAAmBjwB,SAASzhK,KAAK0xL,EACrC,KAC2B,SAArBnb,EAAa5sM,OACfnF,EAAQ2S,GAAMjW,MAAMsD,IAEtBo9M,EAAU1jJ,GAAY,WACpB,OAAO15D,CACT,CAEJ,CAEA,OADA4sN,GAAQ5nC,KAAOA,EACRo4B,EAAU1jJ,GAAUkzJ,GAAS76L,EAASgsK,EAC/C,CAWA,SAASsvB,GAAiB5nN,EAAOu/K,EAAMjzJ,EAASmrC,EAAQ8vJ,GAStD,IARqB,GACnBvnN,EACA,SACA,GAAGy3D,kBACH8nH,EACAjzJ,EACAi7L,GAGA,MAAO,YAUT,OARwB,GACtBvnN,EACA,SACA,GAAGy3D,qBACH8nH,EACAjzJ,EACAi7L,GAKK,OAFE,UAGX,CAWA,SAASM,GAAevgK,EAASrkD,EAAQqpB,EAASizJ,EAAMuoC,GAQtD,OAPKA,GACH7xN,QAAQ+Q,KAAK,+CAETsgD,KAAWwgK,IACfA,EAAYxgK,GAAW,GAAarkD,GAAQA,QAE9CkkN,GAAQ5nC,KAAOA,EACRuoC,EAAYxgK,GAAS6/J,GAAS76L,EACvC,CAEA,IAAIy7L,IAA2B,EAuB/B,SAASC,GAAiBx8M,EAAOC,GAC/B,GAAID,EAAO,CACT,IAAKu8M,KAAyC,IAAZv8M,EAAMuC,GAAuB,IAAZtC,GACjD,OAEF,MAAMsC,EAAIvC,EAAMuC,EAEhB,OADAtC,OAAsBkI,IAAZlI,EAAwB,EAAIA,EACzB,IAANsC,EACH,cACA,QACEgd,KAAKC,MAAiB,IAAVxf,EAAMq2B,EAAW9zB,GAC7B,IACAgd,KAAKC,MAAiB,IAAVxf,EAAMstB,EAAW/qB,GAC7B,IACAgd,KAAKC,MAAiB,IAAVxf,EAAMwC,EAAWD,GAC7B,IACAA,EAAItC,EACJ,GACR,CACA,OAAOD,CACT,CAEA,MAAMy8M,GAAgB,eAQtB,SAASC,GAAa7yN,EAAMqvK,GAC1B,OAAOrvK,EAAKwM,QAAQomN,IAAe,SAAU/gN,GAC3C,OAAOw9J,EAAWx9J,EAAMzF,MAAM,GAAI,KAAO,EAC3C,GACF,CAEA,IAAI0mN,IAAc,EAYX,MAAM,GAAoB,CAAC,EAsE3B,SAASC,GACdn2J,EACAgxJ,EACAoF,EACAnF,EAAc,GACdoF,OAAa30M,EACb40M,OAAiB50M,EACjB60M,OAAW70M,EACX8W,OAAW9W,GAKX,GAHsB,iBAAXsvM,IACTA,EAAUjsN,KAAKC,MAAMgsN,IAEA,GAAnBA,EAAQthK,QACV,MAAM,IAAI1uD,MAAM,+BAKlB,IAAIoxN,EAAaoE,EACbC,EAJJ,GFzUK,SAA6BzF,EAAShxJ,GAC3C,OAAO+wJ,GAAWC,GAAW,KAAM,KAAA0F,QAAO12J,EAC5C,CEuUoB,CAAoBgxJ,EAAShxJ,IAC7Cj1D,MAAMC,KAAKsE,WAKTgnN,IACF,KAAAvE,YAAU,IAAMuE,IAAgBz0N,MAAKwD,MAAOixN,IAC1C,IAAIK,EACJ,GAAqB,oBAAV/xM,MAAuB,CAChC,MAAM+4C,EAAM,IAAI/4C,MAChB,GAA8B,iBAAnB0xM,EACT34J,EAAIC,YAAc,YAClBD,EAAInmD,IAAM8+M,MACL,CACL,IAAIx0N,EACAw0N,aAA0BtvL,QAC5BllC,QAAiB0iB,MAAM8xM,GACdA,aAA0BrvL,WACnCnlC,EAAWw0N,GAEb,MAAM5xM,QAAa5iB,EAAS4iB,OAC5BiyM,EAAUvG,IAAIwG,gBAAgBlyM,GAC9Bi5C,EAAInmD,IAAMm/M,CACZ,CACAh5J,EAAI/pD,iBAAiB,QAAQ,SAASijN,IACpCl5J,EAAIp2B,oBAAoB,OAAQsvL,GAChCzE,EAAcz0J,EACd64J,EAAkB,CAAC74J,EAAItkD,MAAOskD,EAAIrzD,QAClC01D,EAAQ5T,UACJuqK,GACFvG,IAAI0G,gBAAgBH,EAExB,IACAh5J,EAAI/pD,iBAAiB,SAAS,SAAS3R,IACrCmuN,IAAI0G,gBAAgBH,GACpBh5J,EAAIp2B,oBAAoB,QAAStlC,EACnC,GACF,MAAO,GACwB,oBAAtBmvN,mBACPlnN,gBAAgBknN,kBAChB,CACA,MAAM2F,EAA0B,KAEhCA,EAAOvgD,YAAY,CACjBrqI,OAAQ,YACR30B,IAAK8+M,IAEPS,EAAOnjN,iBAAiB,WAAW,SAAiBwO,GAE1B,gBAAtBA,EAAMhhB,KAAK+qC,QACX/pB,EAAMhhB,KAAKoW,MAAQ8+M,IAEnBlE,EAAchwM,EAAMhhB,KAAKkV,MACzBkgN,EAAkB,CAACpE,EAAY/4M,MAAO+4M,EAAY9nN,QAEtD,GACF,KAIJ,MAAM0sN,E9B4uFR,SAAqB/1M,GACjBA,EAASA,EAAOzR,QAChB,MAAMhI,EAAM/E,OAAOmjB,OAAO,MAC1B,IAAK,IAAIjP,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC/BnP,EAAIyZ,EAAOtK,GAAGlR,IAAMwb,EAAOtK,GAE/B,IAAK,IAAIA,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC3B,QAASsK,EAAOtK,KAChBsK,EAAOtK,GAAK48K,EAAMtyK,EAAOtK,GAAInP,EAAIyZ,EAAOtK,GAAG4qM,OAGnD,OAAOtgM,CACX,C8BxvFoB,CAAY+vM,EAAQ/vM,QAEhCg2M,EAAsB,CAAC,EACvBC,EAAe,GAEfC,EAAiB,CAAC,EAClBC,EAAe,CAAC,EAChB9B,EFrYD,SAA0BtE,GAC/B,IAAIsE,EAAgB1E,GAAuBI,EAAQvrN,IAKnD,OAJK6vN,IACHA,EAAgB,CAAC,EACjB1E,GAAuBG,GAAWC,IAAYsE,GAEzCA,CACT,CE8XwB,CAAiBtE,GACjC6E,EFnXD,SAAwB7E,GAC7B,IAAI6E,EAAchF,GAAqBG,EAAQvrN,IAK/C,OAJKowN,IACHA,EAAc,CAAC,EACfhF,GAAqBE,GAAWC,IAAY6E,GAEvCA,CACT,CE4WsB,CAAe7E,GAEnC,IAAIqG,EACJ,IAAK,IAAI1gN,EAAI,EAAG8M,EAAKuzM,EAAUr0N,OAAQgU,EAAI8M,IAAM9M,EAAG,CAClD,MAAM5I,EAAQipN,EAAUrgN,GAClB0+C,EAAUtnD,EAAMtI,GACtB,GAC4B,iBAAlB2wN,GAA8BroN,EAAMoQ,QAAUi4M,GACrDrrN,MAAM4E,QAAQymN,KAAwD,IAArCA,EAAep7M,QAAQq6C,GACzD,CACA,MAAMiiK,EAAcvpN,EAAM,gBAC1B,GAAKspN,GAYE,GAAItpN,EAAMoQ,SAAWk5M,EAC1B,MAAM,IAAIr2N,MACR,UAAUq0D,2BAAiCgiK,SAd5B,CACjBA,EAAetpN,EAAMoQ,OACrB,MAAMA,EAAS6yM,EAAQxuM,QAAQ60M,GAC/B,IAAKl5M,EACH,MAAM,IAAInd,MAAM,WAAWq2N,qBAE7B,MAAM5pN,EAAO0Q,EAAO1Q,KACpB,GAAa,WAATA,GAA8B,YAATA,EACvB,MAAM,IAAIzM,MACR,WAAWq2N,iDAA4D5pN,KAG7E,CAKA,IAAIwT,EAASg2M,EAAoBK,GAC5Br2M,IACHA,EAAS,GACTg2M,EAAoBK,GAAer2M,GAErCA,EAAO9Z,KAAK,CACV4G,MAAOA,EACPvD,MAAOmM,IAETugN,EAAa/vN,KAAKkuD,EACpB,CACF,CAEA,MAAMkiK,EAAW,IAAI,GACf/zB,EAAY,IAAI,GAEhB5mK,EAAS,GAQTo/I,EAAgB,SAAU3hJ,EAAS8B,EAAYq7L,GACnD,MAAM/kD,EAAap4I,EAAQ4R,gBACrBhrB,EAASg2M,EAAoBxkD,EAAW1kK,OAC9C,IAAKkT,EACH,OAEF,IAAIqsK,EAAO2jC,EAAYj2M,QAAQmhB,IAClB,GAATmxJ,IACFA,EAAO,GAAqBnxJ,EAAY80L,IAE1C,MAAMxjN,EAAO,GAAM4sB,EAAQW,cAAcC,WACnCY,EAAI,CACRp2B,GAAI40B,EAAQ84I,QACZV,WAAYA,EACZhlK,KAAMA,GAEF44L,EAAermI,EAAQjoC,IAAI,uBAAuBsC,EAAQ84I,SAChE,IACIskD,EADAC,GAAgB,EAEpB,IAAK,IAAI/gN,EAAI,EAAG8M,EAAKxC,EAAOte,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC/C,MAAMghN,EAAY12M,EAAOtK,GACnB5I,EAAQ4pN,EAAU5pN,MAClBsnD,EAAUtnD,EAAMtI,GACtB,QAAkBic,IAAd81M,GAA2BA,IAAcniK,EAC3C,SAGF,MAAMljD,EAASpE,EAAMoE,QAAU8iN,GACzB/iN,EAAQnE,EAAMmE,OAAS+iN,GAC7B,GACwB,SAAtB9iN,EAAOiB,YACN,YAAarF,GAASu/K,EAAOv/K,EAAMkG,SACnC,YAAalG,GAASu/K,GAAQv/K,EAAMoG,QAErC,SAEF,MAAMnD,EAASjD,EAAMiD,OACrB,IAAKA,GAAU4kN,GAAevgK,EAASrkD,EAAQ6qB,EAAGyxJ,EAAMuoC,GAAc,CAEpE,IAAIt8M,EAAOC,EAASiE,EAAMnE,EAAQ2qE,EAAazjF,EAD/Ci3N,EAAwB1pN,EAExB,MAAMvD,EAAQmtN,EAAUntN,MACxB,GACU,GAARiD,IACe,QAAdM,EAAMN,MAAgC,kBAAdM,EAAMN,MAW/B,GATA+L,EAAU,GACRzL,EACA,QACAA,EAAMN,KAAO,WACb6/K,EACAzxJ,EACAy5L,EACAjvB,GAEEt4L,EAAMN,KAAO,aAAcyE,EAAO,CACpC,MAAM0lN,EAAW,GACf7pN,EACA,QACAA,EAAMN,KAAO,WACb6/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GAAIuxB,EAAU,CACZ,MAAMh6M,EACgB,iBAAbg6M,EACH3B,GAAa2B,EAAUnlD,GACvBmlD,EAAS7oL,WACf,GAAIqjL,GAAeiE,GAAcA,EAAWz4M,GAAO,GAC/C85M,EACFl3N,EAAQo8B,EAAO86L,GAEZl3N,GACAA,EAAMu2B,YACPv2B,EAAMg3B,cACNh3B,EAAMw3B,YAENx3B,EAAQ,IAAI,GAAM,CAChBid,KAAM,IAAI,KAEZmf,EAAO86L,GAAgBl3N,GAEzBid,EAAOjd,EAAMu2B,UACbv2B,EAAM25D,UAAU3vD,GAChB,MAAMqtN,EAAiBj6M,EAAO,IAAMpE,EACpC,IAAIgC,EAAU47M,EAAaS,GAC3B,IAAKr8M,EAAS,CACZ,MAAM62M,EAAkBgE,EAAWz4M,GAC7BigD,EAASszJ,GACbkB,EAAgBh5M,MAChBg5M,EAAgB/nN,QAEZ6X,EACJ07C,EAAOC,WAAW,MAEpB37C,EAAI21M,YAAct+M,EAClB2I,EAAI47C,UACFq0J,EACAC,EAAgBxrN,EAChBwrN,EAAgBvrN,EAChBurN,EAAgBh5M,MAChBg5M,EAAgB/nN,OAChB,EACA,EACA+nN,EAAgBh5M,MAChBg5M,EAAgB/nN,QAElBkR,EAAU2G,EAAI41M,cAAcl6J,EAAQ,UACpCu5J,EAAaS,GAAkBr8M,CACjC,CACAiC,EAAKu6M,SAASx8M,EAChB,CACF,CACF,MACEjC,EAAQw8M,GACN,GACEhoN,EACA,QACAA,EAAMN,KAAO,SACb6/K,EACAzxJ,EACAy5L,EACAjvB,GAEF7sL,GAEEzL,EAAMN,KAAO,mBAAoByE,IACnC+xE,EAAc8xI,GACZ,GACEhoN,EACA,QACAA,EAAMN,KAAO,iBACb6/K,EACAzxJ,EACAy5L,EACAjvB,GAEF7sL,IAGCyqE,IACHA,EAAc1qE,IAEZA,GAAS0qE,OACTyzI,EACFl3N,EAAQo8B,EAAO86L,KAEZl3N,GACA+Y,IAAU/Y,EAAMu2B,YACfxd,GAAS/Y,EAAMu2B,WAChBktD,IAAgBzjF,EAAMg3B,cACrBysD,GAAezjF,EAAMg3B,aACvBh3B,EAAMw3B,aAENx3B,EAAQ,IAAI,GAAM,CAChBid,KAAMlE,EAAQ,IAAI,QAASmI,EAC3BpI,OAAQ2qE,EAAc,IAAI,QAAWviE,IAEvCkb,EAAO86L,GAAgBl3N,GAErB+Y,IACFkE,EAAOjd,EAAMu2B,UACbtZ,EAAKu6M,SAASz+M,IAEZ0qE,IACF3qE,EAAS9Y,EAAMg3B,YACfle,EAAO0+M,SAAS/zI,GAChB3qE,EAAO2+M,SAAS,KAElBz3N,EAAM25D,UAAU3vD,IAItB,GAAY,GAARiD,GAA2B,QAAdM,EAAMN,KAAgB,CAuBnC8L,EAtBI,iBAAkBrH,OAsBdwP,EArBAq0M,GACN,GACEhoN,EACA,QACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GACEt4L,EACA,QACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAMN,MAAMhtL,EAAQ,GACZtL,EACA,QACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEE9sL,GAASF,EAAQ,MACjBq+M,EACFl3N,EAAQo8B,EAAO86L,GAEZl3N,GACAA,EAAMg3B,cACPh3B,EAAMu2B,YACNv2B,EAAMw3B,YAENx3B,EAAQ,IAAI,GAAM,CAChB8Y,OAAQ,IAAI,KAEdsjB,EAAO86L,GAAgBl3N,GAEzB8Y,EAAS9Y,EAAMg3B,YACfle,EAAO4+M,WACL,GACEnqN,EACA,SACA,WACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGJ/sL,EAAO6+M,YACL,GACEpqN,EACA,SACA,YACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGJ/sL,EAAO8+M,cACL,GACErqN,EACA,SACA,mBACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGJ/sL,EAAO0+M,SAASz+M,GAChBD,EAAO2+M,SAAS5+M,GAChBC,EAAO++M,YACLnmN,EAAM,kBACF,GACEnE,EACA,QACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GACA7+L,KAAI,SAAUX,GACd,OAAOA,EAAIwS,CACb,IACA,MAEN7Y,EAAM25D,UAAU3vD,GAEpB,CAEA,IAGIoT,EAAM06M,EAASC,EAycf9kN,EAAO2kB,EAAMogM,EAAgBC,EAAUrF,EAAesF,EA5ctDC,GAAW,EACXv1N,EAAO,KACPw1N,EAAiB,EAErB,IAAa,GAARnrN,GAAqB,GAARA,IAAc,eAAgB0E,EAAQ,CACtD,MAAM0mN,EAAY,GAChB9qN,EACA,SACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GAAIwyB,EAAW,CAKb,IAAIC,EAJJl7M,EACuB,iBAAdi7M,EACH5C,GAAa4C,EAAWpmD,GACxBomD,EAAU9pL,WAEhB,MAAMgqL,EAAevgM,EAAWA,EAASwnC,EAASpiD,QAAQ8D,EAC1D,GACG0wM,GAAeiE,GAAcA,EAAWz4M,IACzCm7M,EACA,CACA,MAAMC,EAAwB,GAC5BjrN,EACA,SACA,0BACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GAAY,GAAR54L,EAAW,CACb,MAAMgpB,EAAyB4D,EAAQW,cAEvC,GAAIvE,EAAK63L,iBAAmB73L,EAAK83L,iBAAkB,CACjD,MAAMxxL,EAAStG,EAAKopC,YAOpB,GANa/mC,KAAKsjB,KAChBtjB,KAAK5kB,IACH4kB,KAAK8X,KAAK7T,EAAO,GAAKA,EAAO,IAAMZ,EAAY,GAC/CrD,KAAK8X,KAAK7T,EAAO,GAAKA,EAAO,IAAMZ,EAAY,KAGxC,IAAK,CAEd,MAAMqyL,EACe,oBAAnB/3L,EAAKwE,UACDxE,EAAK83L,mBACL93L,EAAK63L,kBACN8G,KACHD,GAA2B,CAAC/zB,IAAKA,KACjCg0B,GAAgB,IAAI,GAClB,QACAD,GACA,GACA,EACA,CAAC,OACDzzM,IAGJo3M,EAAY1D,GACZD,GAAyB,GAAK3G,EAAS,GACvC2G,GAAyB,GAAK3G,EAAS,GAUvC,GACgB,SAVE,GAChBzgN,EACA,SACA,mBACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAI0B,QAA1B2yB,EACA,CACA,MAAM9S,EAASzvL,EAAKo4L,YACdp7H,EAAch9D,EAAKm5L,qBACzB,IACE,IAAIj5M,EAAI,EAAG8M,EAAKgwE,EAAY9wF,OAASujN,EACrCvvM,EAAI8M,EACJ9M,GAAKuvM,EACL,CACA,MAAM9W,EAAK37G,EAAY98E,GACjBi0E,EAAK6I,EAAY98E,EAAI,GACrBo0L,EAAKt3G,EAAY98E,EAAIuvM,GACrB7W,EAAK57G,EAAY98E,EAAIuvM,EAAS,GAC9B5S,EAAOx6K,KAAK9kB,IAAIo7L,EAAIrE,GACpB8a,EAAO/sL,KAAK5kB,IAAIk7L,EAAIrE,GACpBkuB,EAAKzK,EAAS,GAEd0K,GACH7pB,EAAKzkH,IAAOquI,EAAK7pB,IAAOrE,EAAKqE,IAFrBof,EAAS,GAEwB5jI,GAC5C,GACE9xD,KAAK2X,IAAIyoL,GAAc,MACvBD,GAAMpT,GACNoT,GAAM3lB,EACN,CACAslB,EAAiB9/L,KAAKqoK,MAAMv2G,EAAKykH,EAAItE,EAAKqE,GAC1C,KACF,CACF,CACF,CACF,CACF,CACF,CACA,GAAa,IAAT3hM,GAAcqrN,EAAW,CAC3B,MAAMK,EAAW,GACfprN,EACA,SACA,YACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEI+yB,OACoB13M,IAAxBxP,EAAM,cACF,GACEnE,EACA,QACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,KACN,IAAK+yB,GAA6B,IAAhBA,EAAUt9M,EAAS,CACnC,MAAMy2M,EAAY,GAChBxkN,EACA,QACA,kBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEIisB,EAAY,GAChBvkN,EACA,QACA,kBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,IAAIgzB,EAAe,GAAGz7M,KAAQu7M,KAAY7G,KAAaC,IAKvD,GAJkB,OAAd6G,IACFC,GAAgB,IAAID,KAEtBd,EAAUnB,EAAekC,IACpBf,EAAS,CACZ,MAAMgB,EAAgB3D,GACpB5nN,EACAu/K,EACAzxJ,EACA,OACAy5L,GAEF,IAAIiE,EACA,gBAAiBpnN,IACnBonN,EAAe,GACbxrN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,GACA72L,MAAM,GACR+pN,EAAa,IAAMJ,EACnBI,EAAa,KAAOJ,GAEtB,IAAI5/M,EAAQ6/M,EACR,CACgB,IAAdA,EAAUxpL,EACI,IAAdwpL,EAAUvyL,EACI,IAAduyL,EAAUr9M,EACVq9M,EAAUt9M,QAEZ4F,EACJ,GAAIq3M,EAAc,CAChB,MAAMS,EAAc,CAClBjgN,MAAOA,EACPkgN,eAA0C,QAA1BT,EAChBO,aAAcA,EACdD,cAAeA,EACfzoN,MAAOsoN,GAEmB,iBAAjBJ,EAETS,EAAYhiN,IAAMuhN,GAElBS,EAAY77J,IAAMo7J,EAClBS,EAAYhH,QAAU,CACpBuG,EAAa1/M,MACb0/M,EAAazuN,SAGjBguN,EAAU,IAAI,GAAKkB,EACrB,KAAO,CACL,MAAMnH,EAAkBgE,EAAWz4M,GACnC,IAAI+/C,EAAKxiD,EAAMjQ,EACXonN,EACED,EAAgBqH,KAClB/7J,EAAMw0J,GACJc,GACEb,EACAC,EACA+G,GAAa,CAAC,EAAG,EAAG,EAAG,IAEzB,CACEvyN,EAAG,EACHC,EAAG,EACHuS,MAAOg5M,EAAgBh5M,MACvB/O,OAAQ+nN,EAAgB/nN,OACxBmoN,WAAYJ,EAAgBI,YAE9BH,EACAC,GAEFh5M,OAAQmI,GAERi8C,EAAMw0J,GACJC,EACAC,EACAC,EACAC,IAIAF,EAAgBqH,KACbjD,IACHA,EAAqBxD,GACnBb,EACA,CACEvrN,EAAG,EACHC,EAAG,EACHuS,MAAOm9M,EAAgB,GACvBlsN,OAAQksN,EAAgB,IAE1B,CAAC5mL,EAAG,EAAG/I,EAAG,EAAG9qB,EAAG,EAAGD,EAAG,KAG1B6hD,EAAM84J,GAEN94J,EAAMy0J,EAERj3M,EAAO,CAACk3M,EAAgBh5M,MAAOg5M,EAAgB/nN,QAC/CY,EAAS,CAACmnN,EAAgBxrN,EAAGwrN,EAAgBvrN,IAE/CwxN,EAAU,IAAI,GAAK,CACjB/+M,MAAOA,EACPokD,IAAKA,EAEL60J,QAASgE,EACTr7M,KAAMA,EACNjQ,OAAQA,EACRuuN,eAA0C,QAA1BT,EAChBnoN,MAAOsoN,EAAW9G,EAAgBI,WAClC8G,aAAcA,EACdD,cAAeA,GAEnB,CACAnC,EAAekC,GAAgBf,CACjC,CACF,CACIA,MACAZ,EACFl3N,EAAQo8B,EAAO86L,GAEZl3N,GACAA,EAAMg4B,aACPh4B,EAAMu2B,YACNv2B,EAAMg3B,cAENh3B,EAAQ,IAAI,GACZo8B,EAAO86L,GAAgBl3N,GAEzBA,EAAMu7B,YAAY+8L,GAClBR,EAAQqB,YACNf,EACE,GACE,GACE7qN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,KAIRiyB,EAAQ37J,WACN,GACE5uD,EACA,QACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGJiyB,EAAQsB,UACN,GACE,GACE7rN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,KAIN7lM,EAAMq5N,SAASvB,GACfl1N,EAAO5C,EAAMw3B,UACbx3B,EAAMm7B,aAAQja,GACdlhB,EAAM25D,UAAU3vD,GAChBmuN,GAAW,EACXJ,GAAY,EAEhB,MACEA,GAAY,CAEhB,CACF,CACF,CAEA,GAAY,GAAR9qN,GAA4B,WAAfM,EAAMN,KAAmB,GACtCiqN,EACFl3N,EAAQo8B,EAAO86L,GAEZl3N,GACAA,EAAMg4B,aACPh4B,EAAMu2B,YACNv2B,EAAMg3B,cAENh3B,EAAQ,IAAI,GACZo8B,EAAO86L,GAAgBl3N,GAEzB,MAAMq6B,EACJ,kBAAmB3oB,EACf,GACEnE,EACA,QACA,gBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,EACAyzB,EAAoB/D,GACxB,GACEhoN,EACA,QACA,sBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GACEt4L,EACA,QACA,wBACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAIE0zB,EAAkB,GACtBhsN,EACA,QACA,mBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEI2zB,EAAcjE,GAClB,GACEhoN,EACA,QACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,GACEt4L,EACA,QACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGE4zB,EAAoB,GACxBlsN,EACA,QACA,sBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEI6zB,EACJr/L,EACA,IACAi/L,EACA,IACAE,EACA,IACAC,EACA,IACAF,EAAgB,GAChB,IACAA,EAAgB,GAElBzB,EAAUnB,EAAe+C,GACpB5B,IACHA,EAAU,IAAI,GAAO,CACnB3+L,OAAQkB,EACR0+L,aAAc,CAACQ,EAAgB,IAAKA,EAAgB,IACpDzgN,OACEwgN,GAAqBG,EAAoB,EACrC,IAAI,GAAO,CACT5gN,MAAO4gN,EACP1gN,MAAOugN,SAETp4M,EACNjE,KAAMu8M,EACF,IAAI,GAAK,CACPzgN,MAAOygN,SAETt4M,EACJ43M,cAAe,SAEjBnC,EAAe+C,GAAa5B,GAE9B93N,EAAMq5N,SAASvB,GACfl1N,EAAO5C,EAAMw3B,UACbx3B,EAAMm7B,aAAQja,GACdlhB,EAAMu7B,iBAAYra,GAClBlhB,EAAM25D,UAAU3vD,GAChBmuN,GAAW,CACb,CAGA,GAAI,eAAgBxmN,EAAQ,CAC1BsmN,EAAW3/L,KAAKC,MACd,GACEhrB,EACA,SACA,YACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGJ,MAAM8zB,EAAY,GAChBpsN,EACA,SACA,YACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFmyB,EAAiB,GACfzqN,EACA,SACA,mBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFjuK,EAAO,GACLm+L,EACIA,EACE4D,EACAnJ,EAAQttM,SACJstM,EAAQttM,SAAS,oBACjBhC,GAENy4M,EACJ1B,EACAD,GAEGpgM,EAAK/uB,SAAS,gBACjB+uB,GAAQ,eAEVg7L,EAAgB,GACdrlN,EACA,SACA,sBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFqyB,EAAe,GACb3qN,EACA,SACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,MAAM+zB,EAAY,GAChBrsN,EACA,SACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAIE5yL,EAFqB,iBAAd2mN,GAA0BA,EAAUz2B,SACX,IAA9By2B,EAAUz2B,SAAShhM,OACby3N,EAAUrrL,WAEVqrL,EAAUz2B,SAASh3H,QAAO,CAAC3/B,EAAKqtL,EAAO1jN,KAC7C,MAAMsuM,EAAQoV,EAAM92B,UAChB82B,EAAM92B,UAAUppL,MAAM,KACtBggN,EACEG,EAAY,GAChB/D,EAAWA,EAAStR,GAASA,EAC7BwT,GAAY4B,EAAMxpN,OAAS,GAC3B2nN,GAEF,IAAIp1N,EAAOi3N,EAAMj3N,KACjB,GAAa,OAATA,EAEF,OADA4pC,EAAI7lC,KAAK,KAAM,IACR6lC,EAET,GAAY,GAARv/B,EAEF,OADAu/B,EAAI7lC,KAAKgsN,GAAmB/vN,EAAMgwN,GAAgBkH,GAC3CttL,EAET5pC,EAAOswN,GACLtwN,EACAk3N,EACA5B,EACAtF,GACAj5M,MAAM,MACR,IAAK,IAAIxD,EAAI,EAAG8M,EAAKrgB,EAAKT,OAAQgU,EAAI8M,IAAM9M,EACtCA,EAAI,GACNq2B,EAAI7lC,KAAK,KAAM,IAEjB6lC,EAAI7lC,KAAK/D,EAAKuT,GAAI2jN,GAEpB,OAAOttL,CAAG,GACT,IAGGipL,GAAamE,EAAW3nD,GAAYlvJ,OAE9C/J,EAAU,GACRzL,EACA,QACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,EAEJ,CACA,GAAI5yL,GAAS+F,IAAY++M,EAAW,CAC7BI,MACDjB,EACFl3N,EAAQo8B,EAAO86L,GAEZl3N,GACAA,EAAMw3B,YACPx3B,EAAMu2B,YACNv2B,EAAMg3B,cAENh3B,EAAQ,IAAI,GACZo8B,EAAO86L,GAAgBl3N,GAEzBA,EAAMq5N,cAASn4M,GACflhB,EAAMu7B,iBAAYra,IAEpB,MAAM43M,EAAgB3D,GACpB5nN,EACAu/K,EACAzxJ,EACA,OACAy5L,GAEG90N,EAAMw3B,WACTx3B,EAAMm7B,QAAQv4B,GAEhBA,EAAO5C,EAAMw3B,YAEV50B,GACA,qBAAsBA,GACrBA,EAAKuyN,qBAAuB2D,KAE9Bl2N,EAAO,IAAI,GAAK,CACd4lL,QAAS,CAAC,EAAG,EAAG,EAAG,GAEnBswC,cAAeA,IAEjB94N,EAAMm7B,QAAQv4B,IAEhB,MAAMm3N,EAAgB,GACpBxsN,EACA,SACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEmB,aAAjBk0B,EACF9mN,EAAQ1I,MAAM4E,QAAQ8D,GAClBA,EAAMjM,KAAI,CAAC8+D,EAAG3vD,IAAOA,EAAI,EAAI2vD,EAAIA,EAAEp6D,gBACnCuH,EAAMvH,cACgB,aAAjBquN,IACT9mN,EAAQ1I,MAAM4E,QAAQ8D,GAClBA,EAAMjM,KAAI,CAAC8+D,EAAG3vD,IAAOA,EAAI,EAAI2vD,EAAIA,EAAEh9D,gBACnCmK,EAAMnK,eAEZ,MAAMkxN,EAAezvN,MAAM4E,QAAQ8D,GAC/BA,EACQ,GAARhG,EACE0lN,GAAmB1/M,EAAO2/M,GAC1BM,GAASjgN,EAAO2kB,EAAMsgM,EAActF,GAgB1C,GAfAhwN,EAAKu4B,QAAQ6+L,GACbp3N,EAAKq3N,QAAQriM,GACbh1B,EAAKu2N,YACH,GACE,GACE5rN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,KAI6B,mBAAxBjjM,EAAKs3N,eAA+B,CAC7C,MAAMC,EAAc,GAClB5sN,EACA,SACA,oBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFjjM,EAAKs3N,eAAeC,EACtB,CACA,MAAMC,EAAa,GACjB7sN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEIw0B,EACJlC,GAAoB,GAARlrN,EACR,QACA,GACEM,EACA,SACA,mBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAER,IAAI/tK,EAOJ,GANkB,gBAAduiM,GACFz3N,EAAK03N,aAAa,QAClBxiM,EAAY,UAEZl1B,EAAK03N,aAAaD,GAEF,SAAdA,GAAkD,mBAAnBz3N,EAAK23N,UAA0B,CAChE,MAAMC,EAAgB,GACpBjtN,EACA,SACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFjjM,EAAK23N,UAA0B,EAAhBC,EACjB,CACA53N,EAAK63N,YAA0B,UAAdJ,GACjB,IAAIK,EAAgB,GAClBntN,EACA,QACA,kBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF,MAAM80B,EAAa,GACjBptN,EACA,SACA,cACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEI+0B,EAAgB,GACpBrtN,EACA,QACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAGF,IAAIg1B,EAAU,EACVC,EAAU,EACd,GAAiB,SAAbT,EAAsB,CACxBviM,EAAY,UACwB,IAAhCsiM,EAAW5/M,QAAQ,SACrBsd,EAAY,OACZgjM,EAAUJ,IACgC,IAAjCN,EAAW5/M,QAAQ,WAC5Bsd,EAAY,QACZgjM,GAAWJ,GAEb,MAAMK,EAAwB,GAC5BxtN,EACA,SACA,0BACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFjjM,EAAKo4N,kBAA2C,OAAzBD,EACzB,MACEn4N,EAAKq4N,YACF,GACC,GACE1tN,EACA,SACA,iBACAu/K,EACAzxJ,EACAy5L,EACAjvB,IAGF5yL,EAAM9Q,OACN63N,EAAa73N,QAEjBS,EAAKo4N,mBAAkB,GAEzBp4N,EAAKs4N,aAAapjM,GAClB,IAAIqjM,EAAe,SACiB,GAAhCf,EAAW5/M,QAAQ,WACrB2gN,EAAe,SACfN,GAAWH,EAAgB,IAAO1C,EAAiB,GAAKC,GAClB,GAA7BmC,EAAW5/M,QAAQ,SAC5B2gN,EAAe,MACfN,EAAUH,EAAgB,IAAO1C,EAAiB,GAAKC,GAEzDr1N,EAAKw4N,gBAAgBD,GACrB,MAAME,EAAc,GAClB9tN,EACA,SACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEFjjM,EAAK04N,WAA2B,SAAhBD,OAAyBn6M,EAAYm6M,GACrDz4N,EAAK24N,WACHZ,EAAW,GAAK1C,EAAW6C,EAAUF,EAAc,IAErDh4N,EAAK44N,WACHb,EAAW,GAAK1C,EAAW4C,EAAUD,EAAc,IAErD53B,EAAUw0B,SACRjC,GACE,GACEhoN,EACA,QACA,aACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF7sL,IAGJpW,EAAK64N,QAAQz4B,GACb,MAAM+uB,EAAYwD,GAChB,GACEhoN,EACA,QACA,kBACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEF7sL,GAEF,GAAI+4M,GAAa2I,EAAgB,EAAG,CAClC3D,EAASS,SAASzF,GAGlB2I,GAAiB,EAEjB,MAAMgB,EAAe,GAAMzD,EAC3BlB,EAASU,SACPiD,GAAiBgB,EAAehB,EAAgBgB,GAElD94N,EAAK+4N,UAAU5E,EACjB,MACEn0N,EAAK+4N,eAAUz6M,GAEjB,MAAM06M,EAAc,GAClBruN,EACA,SACA,eACAu/K,EACAzxJ,EACAy5L,EACAjvB,GAEIrd,EAAU5lL,EAAKi5N,aACjBD,IAAgBpzC,EAAQ,KAC1BA,EAAQ,GAAKozC,EACbpzC,EAAQ,GAAKozC,EACbpzC,EAAQ,GAAKozC,EACbpzC,EAAQ,GAAKozC,GAEf57N,EAAM25D,UAAU3vD,EAClB,CACF,CACF,CAEA,OAAIktN,GAAgB,GAClB96L,EAAOj6B,OAAS+0N,EAAe,EAC3BxB,KACE,QAAS77L,EAEXA,EAAQ3xB,IAAI,eAAgB+uN,GAG5Bp9L,EAAQ4R,gBAAgB,gBAAkBwrL,GAGvC76L,QAXT,CAcF,EAMA,OAJAojC,EAAQnjC,SAASm/I,GACjBh8G,EAAQt3D,IAAI,gBAAiB2uN,GAC7Br3J,EAAQt3D,IAAI,gBAAiBwuN,GAC7Bl3J,EAAQt3D,IAAI,sBAAuBs3D,EAAQjoC,IAAI,wBAA0B,CAAC,GACnEikJ,CACT,CC1mDqCz7K,GAAGqiI,ICAHriI,GAAG+7N,K,0BCAH/7N,GAAGwN,MAAM4S,MCATpgB,GAAGwN,MAAM6W,MCATrkB,GAAGwN,MAAM8P,MFA9C,MGAM,GAA+Btd,GAAGg8N,gBCAlC,GAA+Bh8N,GAAGmtB,KAAK8uM,MCAvC,ICA+Bj8N,GAAG4d,OAAOs+M,OCAVl8N,GAAG4d,OAAOu+M,OFAVn8N,GAAGosL,SAASgwC,UGA3C,GAA+Bp8N,GAAGosL,SC4GxC,SAASiwC,GAAmB/xC,EAAY6D,EAAW,KACjD,OAAO7D,EAAWhrH,aACd,KAAAg9J,WAAU,CACR9/L,OAAQ8tJ,EAAWhrH,YACnB6uH,SAAUA,EACVouC,QAAS,KACRC,iBACH,EACN,CAOA,SAASC,GAAgBxM,EAAUrvN,GACjC,IAAKA,EAAQ8wN,YAAa,CACxB9wN,EAAUsB,OAAOwX,OAAO,CAAC,EAAG9Y,GACP,IAAIivN,IAAII,GAAUE,aAE1BvlN,SAAQ,CAAC7C,EAAOD,KAC3BlH,EAAQ8wN,YAAc3pN,EACtBnH,EAAQ87N,iBAAmB50N,CAAG,GAElC,CACA,OAAOlH,CACT,CAkDO,SAAS+7N,GACdnvN,EACAijN,EACAmM,EAA0B,GAC1BC,EAAgB,CAAC,EACjBnM,OAAcvvM,GAEd,IAAI8uM,EAAU6M,EAEVl8N,EACAi1N,EACAkH,GAAe,EAsCnB,MApCqC,iBAA5BH,GACNpyN,MAAM4E,QAAQwtN,GAMf/G,EAAiB+G,GAJjBh8N,EAAUg8N,EACV/G,EAAiBj1N,EAAQgd,QAAUhd,EAAQ8f,OAC3Cm8M,EAAgBj8N,GAIW,iBAAlBi8N,GACT5M,EAAW4M,EACXj8N,EAAU,CAAC,IAEXqvN,EAAW4M,EAAc5M,SACzBrvN,EAAUi8N,IAEiB,IAAzBj8N,EAAQm8N,eACVA,GAAe,GAEZrM,IACHA,EAAc9vN,EAAQ8vN,aAGrBT,GACkB,iBAAZQ,GACNA,EAAQztM,OAAOe,WAAW,OAE3BksM,EAAWQ,GAETR,IACFA,EAAWA,EAASlsM,WAAW,SAC3BrU,SAAS+3C,KACT,GAAkBwoK,EAAUrvN,EAAQ8wN,aACxC9wN,EAAU67N,GAAgBxM,EAAUrvN,IAG/B,IAAIkB,SAAQ,SAAUC,EAASC,GAIpC,GAAWyuN,EAAS7vN,GACjBU,MAAK,SAAUmvN,GACd,GAAuB,GAAnBA,EAAQthK,QACV,OAAOntD,EAAO,IAAIvB,MAAM,gCAE1B,KACI+M,aAAiB,GAAeA,aAAiB,GAEnD,OAAOxL,EACL,IAAIvB,MAAM,qDAId,MAAMyM,EAAOM,aAAiB,EAAkB,SAAW,UAa3D,GAZKqoN,EAMHiH,EADStyN,MAAM4E,QAAQymN,GACZpF,EAAQ/vM,OAAOs1B,MAAK,SAAUxoC,GACvC,OAAOA,EAAMtI,KAAO2wN,EAAe,EACrC,IAAGj4M,OAEQi4M,GATXiH,EAAW56N,OAAOC,KAAKsuN,EAAQxuM,SAAS+zB,MAAK,SAAUluC,GACrD,OAAO2oN,EAAQxuM,QAAQna,GAAKoF,OAASA,CACvC,IACA2oN,EAAiBiH,IAQdA,EACH,OAAO96N,EAAO,IAAIvB,MAAM,MAAMyM,mCAGhC,SAAS8vN,IACP,IAAKD,EACH,OAAOj7N,QAAQC,UAEjB,GAAIyL,aAAiB,EACnB,OAAOyvN,GACLxM,EAAQxuM,QAAQ66M,GAChB7M,EACArvN,GACAU,MAAK,SAAUsc,GACf,MAAMs/M,EAAe1vN,EAAMuwD,YACtBm/J,EAEMt/M,IAAWs/M,IACpBA,EAAaC,mBAAmBv/M,EAAOw/M,sBAEL,mBAAzBF,EAAaG,SACM,mBAAnBz/M,EAAO0/M,SAGdJ,EAAaG,QAAQz/M,EAAO0/M,WAGzBJ,EAAaK,UAEhBL,EAAaK,QAAU3/M,EAAO2/M,SAE3BL,EAAaM,mBAChBN,EAAaO,gBAAgB7/M,EAAO4/M,mBAGpCN,EAAaQ,wBAA0B,EAAAC,qBAEvCT,EAAaU,oBACXhgN,EAAO8/M,wBAIT,IAAAG,YACEX,EAAa7vM,gBACbzP,EAAOyP,mBAIT6vM,EAAapT,SAAWlsM,EAAO2hD,gBAhCjC/xD,EAAMswN,UAAUlgN,GAmClB,MAAMksM,EAAWt8M,EAAMuwD,YAAYwB,eAEhC5tB,SAASnkC,EAAMmvD,sBACfhrB,SAASnkC,EAAMuwN,eAChBjU,EAASiU,aAAe,GAExBvwN,EAAMwwN,iBd1Nf,SAA8BjxC,EAAM2jC,GACzC,MAAMj/K,EAAOlZ,KAAKyR,MAAM+iJ,GAClBjmG,EAASvuD,KAAK8X,IAAI,EAAG08I,EAAOt7I,GAClC,OAAOi/K,EAAYj/K,GAAQq1C,CAC7B,CcuNkB,CACEvuD,KAAK5kB,IAAI,EAAGm2M,EAASiU,aAAe,OACpCjU,EAAS0S,kBAIjB,IAEF,MAAMyB,EAAWxN,EAAQxuM,QAAQ66M,GACjC,IAAIl/M,EAASpQ,EAAMuwD,YACdngD,GAAUA,EAAO4Z,IAAI,mBAAqBymM,IAC7CrgN,EAASsgN,GAAmBD,EAAUhO,EAAUrvN,IAElD,MAAMs8N,EAA4C1vN,EAAMuwD,YAexD,OAdKm/J,EAEMt/M,IAAWs/M,IACfA,EAAaM,mBAChBN,EAAaO,gBAAgB7/M,EAAO4/M,mBAGjCN,EAAaK,UAEhBL,EAAaK,QAAU3/M,EAAOugN,aAGhCjB,EAAakB,KAAOxgN,EAAOygN,UAX3B7wN,EAAMswN,UAAUlgN,GAaX9b,QAAQC,SACjB,CAEA,IAAIu8N,EAAaxI,EAAYC,EAAgB91N,EAC7C,SAASs+N,IACP,GAAKt+N,GAAWwwN,EAAQjsM,SAAUsxM,EA0BvB71N,GACTuN,EAAM8uB,SAASr8B,GACf+8N,IAAe17N,KAAKS,GAASN,MAAMO,IAEnCA,EAAO,IAAIvB,MAAM,oDA9B4B,CAC7C,GAAIG,EAAQ0pL,aAAeomC,EAAa,CACtC,MACMzjC,GADa,IAAAz1J,KAAc52B,EAAQ0pL,YAChBg/B,WACX,MAAVr8B,IACFyjC,EAAc,GAAmBzpN,KAC9B20B,GAAeA,EAAa,GAAA4iM,gBAAgBvxC,KAGnD,CACAhtL,EAAQ,GACNuN,EACAijN,EACAoF,EACAnF,EACAoF,EACAC,GACA,CAACrR,EAAO+Z,EAAc79N,EAAQ89N,WbtNrC,SACLha,EACA+Z,EAAc,uFAEd,MAAME,EAAWja,EAAMl2K,WACvB,GAAImwL,KAAYlK,GACd,OAAOA,GAAsBkK,GAE/B,MAAMC,EAAmB,GACzB,IAAK,IAAIxoN,EAAI,EAAG8M,EAAKwhM,EAAMtiN,OAAQgU,EAAI8M,IAAM9M,EAAG,CAC9CsuM,EAAMtuM,GAAKsuM,EAAMtuM,GAAG/G,QAAQ,mBAAoB,SAChD,MACMwvN,EAAU,GADHna,EAAMtuM,GACU,IAC7B,KAAA0oN,cAAaD,GACb,MAAMl1C,EAAQk1C,EAAQjlN,MAAM,KAC5BglN,EAAiBh4N,KAAK,CACpB+iL,EAAM16K,MAAM,GAAGnI,KAAK,KAAKuI,QAAQ,KAAM,IACvCs6K,EAAM,GACNA,EAAM,IAEV,CACA,IAAK,IAAIvzK,EAAI,EAAG8M,EAAK07M,EAAiBx8N,OAAQgU,EAAI8M,IAAM9M,EAAG,CACzD,MAAM2oN,EAAkBH,EAAiBxoN,GACnC+9M,EAAS4K,EAAgB,GAC/B,IAAK7K,GAAcC,IAIT,MAFN,GAAA6K,aAAaxnM,IACX,GAAGunM,EAAgB,OAAOA,EAAgB,QAAQ5K,KAEpD,CACA,MAAM8K,EAAUR,EACbpvN,QAAQ,gBAAiB8kN,EAAO9kN,QAAQ,KAAM,KAAKtG,eACnDsG,QAAQ,gBAAiB8kN,EAAO9kN,QAAQ,KAAM,MAC9CA,QAAQ,eAAgB0vN,EAAgB,IACxC1vN,QACC,eACA0vN,EAAgB,GAAG1vN,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,QAE1DA,QAAQ,cAAe0vN,EAAgB,IAC1C,IAAKv1N,SAASiyD,cAAc,cAAgBwjK,EAAU,MAAO,CAC3D,MAAMC,EAAS11N,SAASC,cAAc,QACtCy1N,EAAOz3K,KAAOw3K,EACdC,EAAOC,IAAM,aACb31N,SAAS41N,KAAKj2N,YAAY+1N,EAC5B,CACF,CAEJ,CAEA,OADAzK,GAAsBkK,GAAYja,EAC3BA,CACT,CaqKgBsR,CAAStR,EAAO+Z,IAClB79N,EAAQq3B,UAELzqB,EAAM+oB,WAGTymM,IAAe17N,KAAKS,GAASN,MAAMO,GAFnCA,EAAO,IAAIvB,MAAM,+BAA+Bq8N,MAIpD,CAMF,CAEA,GAAIrM,EAAQjsM,OAAQ,CAClB,MAAMA,EAAS,IAAIqrM,If7WtB,SAA4BrvN,EAAKkvN,EAAOO,GAC7C,MAAMN,EAAaF,GAAcjvN,GACjC,IAAKmvN,EACH,OAAOC,UAAU,IAAIC,IAAIrvN,EAAKyvN,GAAUxoK,MAE1C,MAAM1jC,EAAa,WACnB,GAAuC,IAAnC4rM,EAAWl1M,QAAQsJ,GACrB,MAAM,IAAItjB,MAAM,2BAA2BD,KAE7C,MAAMgkB,EAASmrM,EAAW1gN,MAAM8U,GAEhC,MAAO,GAAGyrM,gBAA2BhrM,yBAA8BkrM,GACrE,CekWY2P,CACE5O,EAAQjsM,OACR5jB,EAAQ8wN,YACRzB,GAAYvgN,SAAS+3C,OAGzB62K,EAAc/7N,OAAO4jD,kBAAoB,IAAM,GAAM,EACrD,MAAMiqK,EAA4B,IAAfkO,EAAqB,MAAQ,GAChD,IAAIgB,EACF96M,EAAO49J,OACP59J,EAAO+6M,SACPnP,EACA,QACA5rM,EAAO3T,OAET,IAAI/O,SAAQ,SAAUC,EAASC,GAC7BivN,GAAc,SAAUqO,EAAW1+N,GAChCU,KAAKS,GACLN,OAAM,SAAUC,GACf49N,EACE96M,EAAO49J,OAAS59J,EAAO+6M,SAAW,QAAU/6M,EAAO3T,OACrDogN,GAAc,SAAUqO,EAAW1+N,GAChCU,KAAKS,GACLN,MAAMO,EACX,GACJ,IACGV,MAAK,SAAUk+N,GAWd,QAVoBr+M,IAAhBq+M,GACFx9N,EAAO,IAAIvB,MAAM,sBAEnBq1N,EAAa0J,EACbzJ,EACEvxM,EAAO49J,OACP59J,EAAO+6M,SACPnP,EACA,OACA5rM,EAAO3T,OACLjQ,EAAQwwN,iBAAkB,CAC5B,MAAMqO,EACJ7+N,EAAQwwN,iBAAiB2E,EAAgB,gBACzCA,GAEA0J,aAAuBh5L,SACvBg5L,aAAuB39N,WAEvBi0N,EAAiB0J,EAErB,CACAlB,GACF,IACC98N,OAAM,SAAUkoD,GACf3nD,EACE,IAAIvB,MACF,6BAA6B6+N,MAAc31K,EAAI7mD,WAGrD,GACJ,MACEy7N,GAEJ,IACC98N,MAAMO,EACX,GACF,CAmEA,SAAS09N,GAA0BzB,EAAU0B,EAAU/+N,GACrD,MAAMg/N,EAAiB,IAAI,EAAS,CAClCD,SAAUA,EACVxxC,SAAU8vC,EAAS9vC,UAAYwxC,EAASxxC,UAAY,MAEhD0xC,EAAcD,EAAeE,cAC7BhW,EAAW8V,EAAergK,cAC1B+qH,GAAa,IAAA9yJ,KAAc52B,EAAQ0pL,YAAc,aACjD9tJ,EAlBR,SAA4BmjM,EAAUr1C,GACpC,MAAMxY,EAAS6tD,EAAS7tD,OACxB,GAAIA,EAAQ,CACV,MAAM1+E,GAAK,IAAA2sI,YAAW,CAACjuD,EAAO,GAAIA,EAAO,IAAKwY,GACxC01C,GAAK,IAAAD,YAAW,CAACjuD,EAAO,GAAIA,EAAO,IAAKwY,GAC9C,MAAO,CAACl3F,EAAG,GAAIA,EAAG,GAAI4sI,EAAG,GAAIA,EAAG,GAClC,CACA,OAAO,IAAAxoM,KAAc8yJ,GAAYhrH,WACnC,CAUiB2gK,CAAmBJ,EAAav1C,GACzC41C,EAAmB51C,EAAWhrH,YAC9B6gK,EAAUN,EAAYnsN,SAAW,EACjC6oN,EAAUsD,EAAYjsN,SAAW,GAEjCwsN,EAAgB,CACpBC,aAAcT,EAAepC,kBAC7BlzC,WAAYA,EACZw/B,SAAU,IAAI,GAAS,CACrB1nC,OAAQ89C,GACJ,KAAAI,YAAWJ,GACXpW,EAASyW,UAAU,GACvB/jM,OAAQA,GAAUstL,EAASxqJ,YAC3B6gK,QAASA,EACTzP,YAAa2L,GAAmB/xC,EAAYq1C,EAASxxC,UAAUl/K,MAC7D,EACAstN,EAAU,GAEZpuC,SAAU27B,EAAS0W,YAAY,MAQnC,OALIh2N,MAAM4E,QAAQywN,EAAYnyC,OAC5B0yC,EAAc1wC,KAAOmwC,EAAYnyC,MAEjC0yC,EAAc5/N,IAAMq/N,EAAYnyC,MAE3B0yC,CACT,CA0EO,SAASnD,GAAkBgB,EAAUhO,EAAUrvN,GACpD,OAAO,IAAIkB,SAAQ,SAAUC,EAASC,Id3bjC,SAAqBi8N,EAAUhO,EAAUrvN,EAAU,CAAC,GACzD,MAAM6/N,EAAW,CAACxQ,EAAUzrN,KAAKqC,UAAUo3N,IAAWzvL,WACtD,IAAI0oI,EAAUy6C,GAAc8O,GAC5B,IAAKvpD,GAAWt2K,EAAQwwN,iBAAkB,CACxC,IAAIsP,EACA9/N,EAAQwwN,mBACVsP,EAAmB,CAACriK,EAAMpnD,KACxB,MAAMk6M,EAAqBvwN,EAAQwwN,kBAC/BxwN,EAAQwwN,iBAAiBn6M,EAAK,UAC9BA,EACJ,GAAIonD,kBerMyBl9C,GfqMTm1E,WAClBj4B,EAAKsiK,WAAU,CAACnkM,EAAQZ,EAAY0uJ,KAClC,MAAMgnC,EAAiB,SAAU/vN,GAC/BA,EAASq/N,cAAct/N,MAAMT,IAC3B,MACMgwF,EADSxyB,EAAK8/J,YACI/rD,aAAavxK,EAAM,CACzC27B,OAAQA,EACR00D,kBAAmBo5F,IAGrBjsH,EAAKwiK,YAAYhwI,EAAS,GAE9B,GACA,KAAA2gI,YAAU,IAAML,IACb7vN,MAAM6vN,IACL,GAAIA,aAA8BzqL,SAChC,OAAO4qL,EAAeH,GAExBltM,MAAMktM,GACH7vN,KAAKgwN,GACL7vN,OAAOwB,GAAMo7D,EAAKyiK,SAAS,WAAiB,IAEhDr/N,OAAOwB,GAAMo7D,EAAKyiK,SAAS,WAAiB,QAE5C,CACL,MAAM1jK,EAAMiB,EAAKpmC,YACjB,KAAAu5L,YAAU,IAAML,IACb7vN,MAAM6vN,IACL,GAAkC,iBAAvBA,EAET,YADA/zJ,EAAInmD,IAAMk6M,GAGZ,MAAMG,EAAkB/vN,GACtBA,EAAS4iB,OAAO7iB,MAAM6iB,IACpB,MAAM3jB,EAAMqvN,IAAIwG,gBAAgBlyM,GAChCi5C,EAAI/pD,iBAAiB,QAAQ,IAAMw8M,IAAI0G,gBAAgB/1N,KACvD48D,EAAI/pD,iBAAiB,SAAS,IAAMw8M,IAAI0G,gBAAgB/1N,KACxD48D,EAAInmD,IAAMzW,CAAG,IAEjB,GAAI2wN,aAA8BzqL,SAChC,OAAO4qL,EAAeH,GAExBltM,MAAMktM,GACH7vN,KAAKgwN,GACL7vN,OAAOwB,GAAMo7D,EAAKyiK,SAAS,WAAiB,IAEhDr/N,OAAOwB,GAAMo7D,EAAKyiK,SAAS,WAChC,IAGJ,MAAMtgO,EAAMy9N,EAASz9N,IACrB,GAAIA,IAAQy9N,EAASvwC,MAAO,CAC1B,MAAMqzC,EAAsBhR,GAC1BvvN,EACAI,EAAQ8wN,YACR9wN,EAAQ87N,kBAAoB,eAC5BzM,GAAYvgN,SAAS+3C,MAEvB,GAAIjnD,EAAIujB,WAAW,aACjBmzJ,EAAUp1K,QAAQC,QAAQ,CACxBi/N,SAAU9+N,OAAOwX,OAAO,CAAC,EAAGukN,EAAU,CACpCz9N,SAAK2gB,EACLusK,MAAOqzC,IAETL,yBAEG,CACL,MAAMv9M,EAAW,CAAC,EAClB+zJ,EAAU+5C,GACR,SACA8P,EAAoB,GACpBngO,EACAuiB,GACA7hB,MAAK,SAAU0/N,GAYf,OAXAA,EAAStzC,MAAQszC,EAAStzC,MAAMzmL,KAAI,SAAUg6N,GAI5C,MAHwB,QAApBD,EAASrzC,SACXszC,EAAUA,EAAQ5xN,QAAQ,MAAO,SAE5B0gN,GACLkR,EACArgO,EAAQ8wN,YACR9wN,EAAQ87N,kBAAoB,eAC5Bv5M,EAAS3iB,KACT,EACJ,IACOsB,QAAQC,QAAQ,CAACi/N,WAAUN,oBACpC,GACF,CACF,MACEzC,EAAW/7N,OAAOwX,OAAO,CAAC,EAAGukN,EAAU,CACrCvwC,MAAOuwC,EAASvwC,MAAMzmL,KAAI,SAAUg6N,GAIlC,MAHwB,QAApBhD,EAAStwC,SACXszC,EAAUA,EAAQ5xN,QAAQ,MAAO,SAE5B0gN,GACLkR,EACArgO,EAAQ8wN,YACR9wN,EAAQ87N,kBAAoB,eAC5BzM,GAAYvgN,SAAS+3C,MACrB,EACJ,MAEFyvH,EAAUp1K,QAAQC,QAAQ,CACxBi/N,SAAU9+N,OAAOwX,OAAO,CAAC,EAAGukN,GAC5ByC,qBAGJ/O,GAAc8O,GAAYvpD,CAC5B,CACA,OAAOA,CACT,EcoUI,CAAY+mD,EAAUhO,EAAUrvN,GAC7BU,MAAK,UAAU,SAAC0/N,EAAQ,iBAAEN,IACzB,MAAMN,EAAgBV,GACpBzB,EACA+C,EACApgO,GAEFw/N,EAAcM,iBAAmBA,EACjCN,EAAcz/N,OAAS,IAAI,EAC3BoB,EAAQ,IAAI,EAAiBq+N,GAC/B,IACC3+N,MAAMO,EACX,GACF,CAkBA,SAASk/N,GAAgB52C,GAEvB,MAAO,UADUA,EAAaA,EAAWh9J,UAAY,aAC5BvkB,cAAcsG,QAAQ,aAAc,OAC/D,CAmFA,SAAS6uN,GAAmBD,EAAUhO,EAAUrvN,GAC9C,MAAMugO,EAAgBvgO,EAAQ0pL,WAC1B,IAAI,GAAQ,CAACr5F,eAAgBrwF,EAAQ0pL,aACrC,IAAI,GACFzpL,EAAOo9N,EAASp9N,KAChBu/N,EAAgB,CAAC,EACvB,GAAmB,iBAARv/N,EAAkB,CAC3B,MAAOugO,GAAcrR,GACnBlvN,EACAD,EAAQ8wN,YACR9wN,EAAQ87N,kBAAoB,eAC5BzM,GAAYvgN,SAAS+3C,MAEvB,GAAI,sBAAsB7yC,KAAKwsN,GAAa,CAC1C,MAAMC,EAAY,CAAC7kM,EAAQZ,EAAY0uJ,KACrC,MAAMg3C,EAAeJ,GAAgB52C,GACrC,OAAO82C,EAAW/xN,QAAQiyN,EAAc,GAAG9kM,EAAO11B,KAAK,OAAO,EAE1D8W,EAAS,IAAI,EAAa,CAC9ByiN,aAAcpC,EAASnwC,YACvBntL,OAAQwgO,EACRI,OAAQ,CAAC/kM,EAAQZ,EAAY0uJ,EAAY99K,EAASg1N,KAKhDvQ,GAAc,UAHS,mBAAdoQ,EACHA,EAAU7kM,EAAQZ,EAAY0uJ,GAC9B+2C,EACwBzgO,GAC3BU,MAAMwR,IACL,MAAM+9E,EACJjzE,EACGugN,YACA/rD,aAAat/J,EAAM,CAACo+E,kBAAmBo5F,IAE5C1sK,EAAO6jN,YAAY5wI,GACnBrkF,EAAQqkF,EAAS,IAElBpvF,OAAOF,IACNqc,EAAO8jN,mBAAmBllM,GAC1BglM,GAAS,GACT,EAENG,SAAU,GAAAp8M,OAGZ,OADA3H,EAAOzV,IAAI,gBAAiB81N,GACrBrgN,CACT,CACA,MAAMA,EAAS,IAAI,EAAa,CAC9ByiN,aAAcpC,EAASnwC,YACvBntL,OAAQwgO,EACR3gO,IAAK4gO,EACLG,OAAQ,CAAC/kM,EAAQZ,EAAY0uJ,EAAY99K,EAASg1N,KAChDvQ,GAAc,UAAWmQ,EAAYxgO,GAClCU,MAAMwR,IACL,MAAM+9E,EACJjzE,EACGugN,YACA/rD,aAAat/J,EAAM,CAACo+E,kBAAmBo5F,IAE5C1sK,EAAO6jN,YAAY5wI,GACnBrkF,EAAQqkF,EAAS,IAElBpvF,OAAOF,IACNqc,EAAO8jN,mBAAmBllM,GAC1BglM,GAAS,GACT,IAGR,OAAO5jN,CACT,CACAwiN,EAAcvvI,SAAWswI,EAAc/uD,aAAavxK,EAAM,CACxDqwF,mBAAmB,IAAA0wI,sBAAuB,cAG5C,MAAMhkN,EAAS,IAAI,EACjB1b,OAAOwX,OACL,CACE2mN,aAAcpC,EAASnwC,YACvBntL,OAAQwgO,GAEVf,IAIJ,OADAxiN,EAAOzV,IAAI,gBAAiB81N,GACO,CACrC,CEh0BqCj+N,GAAG8gB,OAAO+C,M,4FCW3Cg+M,GAAa,CAYbC,WAAa,SAAUthO,EAAKuhO,GAGxB,IAAI1hO,EAAS2Q,GAAAA,EAAO1Q,UAAU,cAE9B,IAAKyhO,IACAA,EAAar2N,eAAe,aACH,OAA1Bq2N,EAAaC,UAC2B,IAAxCD,EAAaC,SAASh/M,OAAO5gB,OAC7B,OAAO5B,EAGX,GAAIuhO,EAAaE,gBACbz3N,MAAM4E,QAAQ2yN,EAAaE,iBAC3BF,EAAaE,eAAe7/N,OAAS,EACrC,IAAK,IAAIgU,KAAK2rN,EAAaE,eAEvB,GADA5hO,EAAOE,MAAM,uCAAyCwhO,EAAaE,eAAe7rN,KAC7B,IAAjD5V,EAAIia,QAAQsnN,EAAaE,eAAe7rN,IAExC,OADA/V,EAAOuS,KAAK,6BAA+BpS,EAAM,kCAAoCuhO,EAAaE,eAAe7rN,GAAK,MAC/G5V,EAInB,OAAOuhO,EAAaC,SAAW/8L,mBAAmBzkC,EACtD,GAGJ,Y,eC/CI0hO,GAAiB,CAOjBvhN,QAAU,SAAUzb,GAEhB,OADWlE,KAAK4f,KAAQ1b,EAAK,IAAMlE,KAAK4f,KAAO1b,CAEnD,EAOAi9N,sBAAwB,WACpB,IAAI54N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAK,eACTqE,EAAIG,UAAY,GACTH,CACX,EAOA+d,4BAA8B,WAC1B,IAAI3e,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUzD,GAAKlE,KAAK2f,QAAQ,YAC5BhY,EAAUe,UAAY,8DACff,CACX,EAYAy5N,8BAAgC,WAE5B,IAAIz4N,EAAO3I,KAEPuU,EAAS/L,SAASC,cAAc,UAEhCoS,EAAOrS,SAASC,cAAc,QAwBlC,OAvBA8L,EAAOpM,YAAY0S,GACnBtG,EAAOrQ,GAAKlE,KAAK2f,QAAQ,qBACzBpL,EAAO7L,UAAY,0IACnB6L,EAAO0G,aAAa,aAAc,8BAClC1G,EAAO0G,aAAa,WAAY,KAChC1G,EAAO0G,aAAa,gBAAgB,GACpC1G,EAAO0G,aAAa,OAAQ,UAGxB1G,EAAOlC,iBACPkC,EAAOlC,iBAAiB,SAAS,SAAUpQ,GACvC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAK04N,mBAAmBp/N,EAC5B,IACOsS,EAAOhC,aACdgC,EAAOhC,YAAY,WAAW,SAAUtQ,GACpC,IAAID,EAAmC,SAAzBC,EAAEc,OAAO2lB,YACvBzmB,EAAEc,OAAOkY,aAAa,gBAAiBjZ,GACvC2G,EAAK04N,mBAAmBp/N,EAC5B,IAGGsS,CACX,EAWA+sN,0BAA4B,WACxB,IAAItvK,EAASxpD,SAASC,cAAc,UAIpC,OAHAupD,EAAO9tD,GAAKlE,KAAK2f,QAAQ,iBACzBqyC,EAAOtpD,UAAY,6BAEZspD,CACX,EAEAuvK,6BAA+B,WAC3B,IAAIh5N,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,iCACTH,CACX,EAOAi5N,gCAAkC,WAC9B,IAAI75N,EAAYa,SAASC,cAAc,OAEvC,OADAd,EAAUe,UAAY,gFACff,CACX,EAOA85N,qCAAuC,WACnC,IAAI94N,EAAO3I,KAEP0hO,EAAYl5N,SAASC,cAAc,UAKvC,GAJAi5N,EAAUx9N,GAAKlE,KAAK2f,QAAQ,4BAC5B+hN,EAAUvxN,MAAQ,qBAClBuxN,EAAUh5N,UAAY,kJAElBqB,EAAAA,GAAAA,KAAa,CACb,IAAI43N,EAAan5N,SAASC,cAAc,QACxCk5N,EAAWj5N,UAAY,kBACvBi5N,EAAWxvN,UAAY,SACvBuvN,EAAUv5N,YAAYw5N,EAC1B,CAiBA,OAhBID,EAAUrvN,iBACVqvN,EAAUrvN,iBAAiB,SAAS,SAAUpQ,GAE1CuG,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,QAE3DtW,EAAKi5N,oBAAoB3/N,GAEzBuG,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,OAC/D,IACOyiN,EAAUnvN,aACjBmvN,EAAUnvN,YAAY,WAAW,SAAUtQ,GACvCuG,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,QAC3DtW,EAAKi5N,oBAAoB3/N,GACzBuG,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,OAC/D,IAEGyiN,CACX,EAOAG,+BAAiC,WAC7B,IAAIt5N,EAAMC,SAASC,cAAc,OAIjC,OAHAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,uBACtBpX,EAAIG,UAAY,yDAChBH,EAAI4J,UAAY,oBACT5J,CACX,EAOAu5N,+BAAiC,WAE7B,IAAIn5N,EAAO3I,KAEPulK,EAAW/8J,SAASC,cAAc,UACtC88J,EAASrhK,GAAKlE,KAAK2f,QAAQ,sBAC3B4lJ,EAAS78J,UAAY,8GACrB68J,EAASp1J,MAAQ,oBAGbo1J,EAASlzJ,iBACTkzJ,EAASlzJ,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,OAC/D,IAAG,GACIsmJ,EAAShzJ,aAChBgzJ,EAAShzJ,YAAY,WAAW,WAC5B/J,SAASqL,eAAelL,EAAKgX,QAAQ,sBAAsBV,OAC/D,IAGJ,IAAIpE,EAAOrS,SAASC,cAAc,QAMlC,OALAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjBo8I,EAASp9J,YAAY0S,GAEd0qJ,CACX,EAYAw8D,8BAAgC,WAE5B,IAAIp5N,EAAO3I,KAEP4lK,EAAOp9J,SAASC,cAAc,QAiBlC,OAhBAm9J,EAAK1hK,GAAKlE,KAAK2f,QAAQ,gBACvBimJ,EAAKl9J,UAAY,2FAGbk9J,EAAKvzJ,iBACLuzJ,EAAKvzJ,iBAAiB,UAAU,SAAUpQ,GACtCA,EAAEomB,iBACF1f,EAAKq5N,iBACT,IACOp8D,EAAKrzJ,aACZqzJ,EAAKrzJ,YAAY,YAAY,SAAUtQ,GACnCA,EAAEomB,iBACF1f,EAAKq5N,iBACT,IAGGp8D,CACX,EAQAq8D,6BAA+B,SAAUC,GAErC,IAAIn3N,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,oBACtBpX,EAAIG,UAAY,oBAEhB,IAAIwJ,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMhO,GAAKlE,KAAK2f,QAAQ,qBACxBzN,EAAMxJ,UAAY,6BAClBwJ,EAAMC,UAAY,iBAClBD,EAAM/B,MAAQ,iBACd5H,EAAIJ,YAAY+J,GAEhB,IA6CI6pC,EA7CAutC,EAAS9gF,SAASC,cAAc,UACpC6gF,EAAOruE,aAAa,kBAAmBjb,KAAK2f,QAAQ,sBACpD2pE,EAAO5gF,UAAY,gCAEf4gF,EAAOj3E,iBACPi3E,EAAOj3E,iBAAiB,UAAU,SAAUpQ,GACrB,QAAfjC,KAAK+G,OAAkC,QAAf/G,KAAK+G,OAAkC,YAAf/G,KAAK+G,OAAsC,WAAf/G,KAAK+G,OAEjFyB,SAASqL,eAAe9I,EAAQ4U,QAAQ,yBAAyBjX,UAAY,wCAC7EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,0BAA0BjX,UAAY,8BACxD,QAAf1I,KAAK+G,OAAkC,SAAf/G,KAAK+G,OAAmC,QAAf/G,KAAK+G,QAE7DyB,SAASqL,eAAe9I,EAAQ4U,QAAQ,0BAA0BjX,UAAY,wCAC9EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,yBAAyBjX,UAAY,8BAEjFqC,EAAQo3N,oBAAoBlgO,EAChC,IACOqnF,EAAO/2E,aACd+2E,EAAO/2E,YAAY,YAAY,WACR,QAAfvS,KAAK+G,OAAkC,QAAf/G,KAAK+G,OAAkC,YAAf/G,KAAK+G,OAAsC,WAAf/G,KAAK+G,OAEjFyB,SAASqL,eAAe9I,EAAQ4U,QAAQ,yBAAyBjX,UAAY,wCAC7EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,0BAA0BjX,UAAY,8BACxD,QAAf1I,KAAK+G,OAAkC,SAAf/G,KAAK+G,OAAmC,QAAf/G,KAAK+G,QAE7DyB,SAASqL,eAAe9I,EAAQ4U,QAAQ,0BAA0BjX,UAAY,wCAC9EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,yBAAyBjX,UAAY,8BAEjFqC,EAAQo3N,qBACZ,IAEJ74I,EAAOplF,GAAKlE,KAAK2f,QAAQ,sBAGpBuiN,GAAgB14N,MAAM4E,QAAQ8zN,KAC/BA,EAAc,CACV,MACA,MACA,UACA,SACA,MACA,OACA,QAIR,IAAK,IAAI9sN,EAAI,EAAGA,EAAI8sN,EAAY9gO,OAAQgU,KACpC2mC,EAASvzC,SAASC,cAAc,WACzB1B,MAAQm7N,EAAY9sN,GAC3B2mC,EAAOl6C,KAA2B,WAAnBqgO,EAAY9sN,GAAmB,sBAAwB8sN,EAAY9sN,GAClFk0E,EAAOnhF,YAAY4zC,GAKvB,OAFAxzC,EAAIJ,YAAYmhF,GAET/gF,CACX,EAOA65N,4BAA8B,WAC1B,IAAI75N,EAAMC,SAASC,cAAc,OACjCF,EAAIrE,GAAKlE,KAAK2f,QAAQ,4BACtBpX,EAAIG,UAAY,8EAEhB,IAAIszC,EAAIxzC,SAASC,cAAc,KAK/B,OAJAuzC,EAAEtzC,UAAY,0CACdszC,EAAE7pC,UAAY,wBACd5J,EAAIJ,YAAY6zC,GAETzzC,CACX,EAWA85N,mCAAqC,SAAUC,GAC3C,IAAI/5N,EAAMC,SAASC,cAAc,OAQjC,OAPAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,wBAElBpX,EAAIG,UADY,QAAhB45N,GAAyC,QAAhBA,GAAyC,YAAhBA,GAA6C,WAAhBA,EAC/D,wCAEA,6BAGb/5N,CACX,EAOAg6N,uBAAyB,WACrB,IAAIh6N,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,6BAEhB,IAAIwJ,EAAQ1J,SAASC,cAAc,SACnCyJ,EAAMxJ,UAAY,6BAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,gBAC7BzN,EAAMC,UAAY,MAClBD,EAAM/B,MAAQ,MACd5H,EAAIJ,YAAY+J,GAEhB,IAAI0C,EAAQpM,SAASC,cAAc,SAMnC,OALAmM,EAAM1I,KAAO,OACb0I,EAAM1Q,GAAKlE,KAAK2f,QAAQ,gBACxB/K,EAAMlM,UAAY,6BAClBH,EAAIJ,YAAYyM,GAETrM,CACX,EAOAi6N,2BAA6B,WACzB,IAAIj6N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,kBACtBpX,EAAIG,UAAY,WACTH,CACX,EAOAk6N,4BAA8B,WAC1B,IAAI13N,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,mDAEhB,IAAIkM,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1I,KAAO,QACT0I,EAAMvC,iBACNuC,EAAMvC,iBAAiB,UAAU,SAAUpQ,GACvCuG,SAASqL,eAAe9I,EAAQ4U,QAAQ,uBAAuBjX,UAAY,6BAC3EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,qBAAqBjX,UAAY,6BACzEqC,EAAQ23N,0BAA0BzgO,EACtC,IACO2S,EAAMzM,aACbyM,EAAMzM,YAAY,YAAY,WAC1BK,SAASqL,eAAe9I,EAAQ4U,QAAQ,uBAAuBjX,UAAY,6BAC3EF,SAASqL,eAAe9I,EAAQ4U,QAAQ,qBAAqBjX,UAAY,6BACzEqC,EAAQ23N,2BACZ,IAEJ9tN,EAAMvM,KAAO,qBACbuM,EAAM7N,MAAQ,QACd6N,EAAMiB,SAAU,EAChBjB,EAAM1Q,GAAKlE,KAAK2f,QAAQ,0BACxBpX,EAAIJ,YAAYyM,GAEhB,IAAI1C,EAAQ1J,SAASC,cAAc,SAOnC,OANAyJ,EAAMxJ,UAAY,0CAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,0BAC7BzN,EAAMC,UAAY,oBAClBD,EAAM/B,MAAQ,oBACd5H,EAAIJ,YAAY+J,GAET3J,CACX,EAOAo6N,0BAA4B,WACxB,IAAI53N,EAAU/K,KAEVuI,EAAMC,SAASC,cAAc,OACjCF,EAAIG,UAAY,mDAEhB,IAAIkM,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1I,KAAO,QACT0I,EAAMvC,iBACNuC,EAAMvC,iBAAiB,UAAU,SAAUpQ,GACvCuG,SAASqL,eAAe9I,EAAQ4U,QAAQ,qBAAqBjX,UAAY,oBACzEF,SAASqL,eAAe9I,EAAQ4U,QAAQ,uBAAuBjX,UAAY,6BAC3EqC,EAAQ23N,0BAA0BzgO,EACtC,IACO2S,EAAMzM,aACbyM,EAAMzM,YAAY,YAAY,WAC1BK,SAASqL,eAAe9I,EAAQ4U,QAAQ,qBAAqBjX,UAAY,oBACzEF,SAASqL,eAAe9I,EAAQ4U,QAAQ,uBAAuBjX,UAAY,6BAC3EqC,EAAQ23N,2BACZ,IAEJ9tN,EAAM1Q,GAAKlE,KAAK2f,QAAQ,wBACxB/K,EAAMvM,KAAO,qBACbuM,EAAM7N,MAAQ,MACd6N,EAAMiB,SAAU,EAChBtN,EAAIJ,YAAYyM,GAEhB,IAAI1C,EAAQ1J,SAASC,cAAc,SAOnC,OANAyJ,EAAMxJ,UAAY,0CAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,wBAC7BzN,EAAMC,UAAY,UAClBD,EAAM/B,MAAQ,UACd5H,EAAIJ,YAAY+J,GAET3J,CACX,EAOAq6N,2BAA6B,WACzB,IAAIr6N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,sBACtBpX,EAAIG,UAAY,oBACTH,CACX,EAOAs6N,6BAA+B,WAC3B,IAAI3wN,EAAQ1J,SAASC,cAAc,SAKnC,OAJAyJ,EAAMxJ,UAAY,sCAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,gBAC7BzN,EAAMC,UAAY,gBAClBD,EAAM/B,MAAQ,gBACP+B,CACX,EAOA4wN,wBAA0B,WACtB,IAAIluN,EAAQpM,SAASC,cAAc,SAInC,OAHAmM,EAAM1I,KAAO,OACb0I,EAAM1Q,GAAKlE,KAAK2f,QAAQ,gBACxB/K,EAAMlM,UAAY,yCACXkM,CACX,EAOAmuN,yBAA2B,WACvB,IAAIx6N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,oBACtBpX,EAAIG,UAAY,6BACTH,CACX,EAOAy6N,2BAA6B,WACzB,IAAI9wN,EAAQ1J,SAASC,cAAc,SAKnC,OAJAyJ,EAAMxJ,UAAY,6BAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,eAC7BzN,EAAMC,UAAY,MAClBD,EAAM/B,MAAQ,MACP+B,CACX,EAOA+wN,sBAAwB,WACpB,IAAIruN,EAAQpM,SAASC,cAAc,SAInC,OAHAmM,EAAM1I,KAAO,OACb0I,EAAM1Q,GAAKlE,KAAK2f,QAAQ,eACxB/K,EAAMlM,UAAY,6BACXkM,CACX,EAWAsuN,8BAAgC,SAAUZ,GACtC,IAAI/5N,EAAMC,SAASC,cAAc,OAQjC,OAPAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,yBAElBpX,EAAIG,UADY,QAAhB45N,GAAyC,SAAhBA,GAA0C,QAAhBA,EACnC,+BAEA,6BAGb/5N,CACX,EAOA46N,qBAAuB,WACnB,IAAI56N,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAY,oBACTH,CACX,EAOA66N,4BAA8B,WAC1B,IAAIlxN,EAAQ1J,SAASC,cAAc,SAKnC,OAJAyJ,EAAMxJ,UAAY,6BAClBwJ,EAAMwE,QAAU1W,KAAK2f,QAAQ,sBAC7BzN,EAAMC,UAAY,iBAClBD,EAAM/B,MAAQ,iBACP+B,CACX,EAOAmxN,uBAAyB,WACrB,IAAIzuN,EAAQpM,SAASC,cAAc,SAInC,OAHAmM,EAAM1I,KAAO,OACb0I,EAAM1Q,GAAKlE,KAAK2f,QAAQ,sBACxB/K,EAAMlM,UAAY,6BACXkM,CACX,EAWA0uN,+BAAiC,WAC7B,IAAI1uN,EAAQpM,SAASC,cAAc,SAMnC,OALAmM,EAAM1Q,GAAKlE,KAAK2f,QAAQ,kBACxB/K,EAAMlM,UAAY,0BAClBkM,EAAM1I,KAAO,SACb0I,EAAM7N,MAAQ,WAEP6N,CACX,EAWA2uN,gCAAkC,WAC9B,IAAIh7N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,uBACtBpX,EAAIG,UAAY,wDACTH,CACX,EAOAi7N,sCAAwC,WAEpC,IAAIz4N,EAAU/K,KAEV2H,EAAYa,SAASC,cAAc,OACvCd,EAAUe,UAAY,mDAGtB,IAAI0xD,EAAa5xD,SAASC,cAAc,OACxC2xD,EAAW1xD,UAAY,yDACvB0xD,EAAWjoD,UAAY,sBACvBioD,EAAWjqD,MAAQ,sBACnBxI,EAAUQ,YAAYiyD,GAGtB,IAAIqpK,EAAWj7N,SAASC,cAAc,UACtCg7N,EAAS/6N,UAAY,4HACrB+6N,EAAStzN,MAAQ,oBACjBszN,EAASv/N,GAAKlE,KAAK2f,QAAQ,4BACvB8jN,EAASpxN,iBACToxN,EAASpxN,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DzW,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB2H,UAAUjZ,QAAQ,mBAAoB,mBACtG7F,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB2H,UAAUjZ,QAAQ,cAAe,cACjGtD,EAAQ24N,qBACZ,IACOD,EAASlxN,aAChBkxN,EAASlxN,YAAY,SAAS,WAC1B/J,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DzW,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB2H,UAAUjZ,QAAQ,mBAAoB,mBACtG7F,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB2H,UAAUjZ,QAAQ,cAAe,cACjGtD,EAAQ24N,qBACZ,IAGJ,IAAI7oN,EAAOrS,SAASC,cAAc,QAQlC,OAPAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjBs6M,EAASt7N,YAAY0S,GAErBlT,EAAUQ,YAAYs7N,GAEf97N,CACX,EAOAg8N,oCAAsC,WAClC,IAAIh8N,EAAYa,SAASC,cAAc,OAIvC,OAHAd,EAAUe,UAAY,qCACtBf,EAAUzD,GAAKlE,KAAK2f,QAAQ,yBAErBhY,CACX,EAEAi8N,mCAAqC,SAAUzzN,EAAOxI,GAClD,IAAIk8N,EAAKr7N,SAASC,cAAc,MAKhC,OAJAo7N,EAAGn7N,UAAY,6BACfm7N,EAAG1zN,MAAQA,EAEXxI,EAAUQ,YAAY07N,GACfl8N,CACX,EAEAm8N,+BAAiC,SAAU3zN,EAAOxI,GAC9C,IAAIo8N,EAAKv7N,SAASC,cAAc,MAChCs7N,EAAGr7N,UAAY,sDAGf,IAAIkM,EAAQpM,SAASC,cAAc,SACnCmM,EAAM1Q,GAAK,0BAA4BwmB,GAAAA,EAAWxV,WAClDN,EAAMlM,UAAY,yBAClBkM,EAAM1I,KAAO,WACb63N,EAAG57N,YAAYyM,GAGf,IAAI1C,EAAQ1J,SAASC,cAAc,SAQnC,OAPAyJ,EAAMxJ,UAAY,iEAClBwJ,EAAMwE,QAAU9B,EAAM1Q,GACtBgO,EAAMC,UAAYhC,EAClB+B,EAAM/B,MAAQA,EACd4zN,EAAG57N,YAAY+J,GAEfvK,EAAUQ,YAAY47N,GACfp8N,CACX,EAEAq8N,gCAAkC,SAAUr8N,GACxC,IAAIk8N,EAAKr7N,SAASC,cAAc,MAIhC,OAHAo7N,EAAGn7N,UAAY,0BAEff,EAAUQ,YAAY07N,GACfl8N,CACX,EAEAs8N,4BAA8B,SAAUt9N,EAAazC,EAAIyD,GACrD,IAAIo8N,EAAKv7N,SAASC,cAAc,MAChCs7N,EAAGr7N,UAAY,uEACfq7N,EAAG5xN,UAAYxL,EAAYzG,QAC3B6jO,EAAG5zN,MAAQxJ,EAAYwJ,MACvB4zN,EAAG7/N,GAAK,0BAA4BA,EAEpC,IAAI6G,EAAU/K,KAYd,OAXI+jO,EAAG1xN,iBACH0xN,EAAG1xN,iBAAiB,SAAS,SAAUpQ,GACnC8I,EAAQm5N,4BAA4BjiO,EACxC,IACO8hO,EAAGxxN,aACVwxN,EAAGxxN,YAAY,WAAW,WACtBxH,EAAQm5N,6BACZ,IAGJv8N,EAAUQ,YAAY47N,GACfp8N,CACX,EAWAw8N,gCAAkC,WAC9B,IAAI57N,EAAMC,SAASC,cAAc,OAGjC,OAFAF,EAAIrE,GAAKlE,KAAK2f,QAAQ,uBACtBpX,EAAIG,UAAY,wDACTH,CACX,EAOA67N,sCAAwC,WAEpC,IAAIr5N,EAAU/K,KAEV2H,EAAYa,SAASC,cAAc,OACvCd,EAAUe,UAAY,mDAGtB,IAAIg5N,EAAYl5N,SAASC,cAAc,UACvCi5N,EAAUx9N,GAAKlE,KAAK2f,QAAQ,kCAC5B+hN,EAAUvxN,MAAQ,gBAClBuxN,EAAUh5N,UAAY,uHAClBg5N,EAAUrvN,iBACVqvN,EAAUrvN,iBAAiB,SAAS,SAAUpQ,GAC1CuG,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DlU,EAAQs5N,0BAA0BpiO,EACtC,IACOy/N,EAAUnvN,aACjBmvN,EAAUnvN,YAAY,WAAW,SAAUtQ,GACvCuG,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DlU,EAAQs5N,0BAA0BpiO,EACtC,IAEJ0F,EAAUQ,YAAYu5N,GAGtB,IAAItnK,EAAa5xD,SAASC,cAAc,OACxC2xD,EAAW1xD,UAAY,yDACvB0xD,EAAWjoD,UAAY,qBACvBioD,EAAWjqD,MAAQ,qBACnBxI,EAAUQ,YAAYiyD,GAGtB,IAAIqpK,EAAWj7N,SAASC,cAAc,UACtCg7N,EAAS/6N,UAAY,4HACrB+6N,EAAStzN,MAAQ,oBACjBszN,EAASv/N,GAAKlE,KAAK2f,QAAQ,4BACvB8jN,EAASpxN,iBACToxN,EAASpxN,iBAAiB,SAAS,WAC/B7J,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DzW,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB1gB,MAAM+U,QAAU,OAChFjJ,EAAQu5N,qBACZ,IACOb,EAASlxN,aAChBkxN,EAASlxN,YAAY,SAAS,WAC1B/J,SAASqL,eAAe9I,EAAQ4U,QAAQ,sBAAsBV,QAC9DzW,SAASqL,eAAe9I,EAAQ4U,QAAQ,wBAAwB1gB,MAAM+U,QAAU,OAChFjJ,EAAQu5N,qBACZ,IAGJ,IAAIzpN,EAAOrS,SAASC,cAAc,QAQlC,OAPAoS,EAAKnS,UAAY,8BACjBmS,EAAKsO,UAAY,SAEjBs6M,EAASt7N,YAAY0S,GAErBlT,EAAUQ,YAAYs7N,GAEf97N,CACX,EAOA48N,oCAAsC,WAClC,IAAI58N,EAAYa,SAASC,cAAc,OAGvC,OAFAd,EAAUe,UAAY,sBACtBf,EAAUzD,GAAKlE,KAAK2f,QAAQ,yBACrBhY,CACX,GA0PJ,Y,yyDC9hCA,I,SAAItI,GAAS2Q,GAAAA,EAAO1Q,UAAU,eA0F1BklO,IAAWC,GAAA,SAAAt+N,GAYX,SAAAq+N,EAAa5kO,GAAS,IAAAyG,E,MAYlB,G,4FAZkBC,CAAA,KAAAk+N,G,EAIlB,K,EAAA,CAHA5kO,EAAUA,GAAW,CAAC,G,OAGtB4kO,IAAAn+N,E,sEAMKnB,UAAY,gBAEXmB,aAAgBm+N,GAClB,MAAM,IAAIvgO,UAAU,2BAWxB,OARAoC,EAAKgK,YAAYzQ,GAGjByG,EAAK8jB,WAAa9jB,EAAKiK,eAAe1Q,GAGrCyG,EAAKG,QAAWH,EAAKG,QAAQ2B,YAAY9B,EAAK8jB,YAAc9jB,EAAKG,QAAUH,EAAK8jB,WAEjFC,GAAA/jB,EAAAA,EACJ,CAAC,O,sRAAAO,CAAA49N,EAAAr+N,G,EAAAq+N,E,EAAA,EAAA19N,IAAA,SAAAC,MA4CD,SAAQd,GAEJ,GAAIA,EAAK,CAKL,IAAI0C,EAAO3I,KACXiG,EAAI0d,YAAYoK,GACZ,UACA,SAAU9rB,GAE4B,uBAA9BA,EAAEuE,QAAQi3D,iBAENx7D,EAAEuE,QAAQk+N,YAEN/7N,EAAKg8N,cAAgBh8N,EAAKi8N,eAC1Bj8N,EAAKk8N,mBAAmB5iO,EAAEuE,QAAQk+N,YAClC/7N,EAAKg8N,aAAar9M,UAAUjZ,QAAQ,mBAAoB,mBACxD1F,EAAKg8N,aAAar9M,UAAUjZ,QAAQ,cAAe,cAInE,GACA1F,GAIA3I,KAAK62C,WACL00H,GAAAA,EAAUhrE,YACNvgG,KAAK4kO,aACL5kO,KAAK8kO,mBACL7+N,EAAIuoB,oBAiBPxuB,KAAKq2D,WACNr2D,KAAK+kO,kBAAkB9pN,aAAa,gBAAgB,EAE5D,C,iBAGAupN,E,EAAA,S,EAAA,K,aAAA,G,kFAAA,CAAav+N,IAGTjG,KAAKJ,QAAQyE,UACbrE,KAAKi3D,YAAYj3D,KAAKJ,QAAQyE,WAIN,IAAxBrE,KAAKJ,QAAQs3D,QACbl3D,KAAKsiB,eAAegF,UAAUtG,IAAI,uBAE1C,GAEA,CAAAla,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKq2D,SAChB,GAEA,CAAAvvD,IAAA,eAAAC,MAKA,SAAcsvD,QACQl2C,IAAdk2C,EAICA,GAAar2D,KAAKq2D,YAAgBA,IAAcr2D,KAAKq2D,YAGtDA,EACAr2D,KAAKglO,kBAAkB/lN,QAEvBjf,KAAK+kO,kBAAkB9lN,QAE3Bjf,KAAKq2D,UAAYA,GAXbh3D,GAAOqB,MAAM,iEAYrB,GAEA,CAAAoG,IAAA,yBAAAC,MAKA,WACI,OAAO/G,KAAKilO,aAChB,GAEA,CAAAn+N,IAAA,0BAAAC,MAKA,WACI,OAAO/G,KAAKklO,cAChB,GAEA,CAAAp+N,IAAA,UAAAC,MAKA,WACI,OAAO/G,KAAKmlO,KAChB,GAEA,CAAAr+N,IAAA,eAAAC,MAKA,WACI,OAAO/G,KAAKmqB,UAChB,GAKA,CAAArjB,IAAA,cAAAC,MAMA,SAAanH,GAqHT,GAhHAI,KAAKmtK,mBAAmBvtK,GAGxBI,KAAKJ,QAAU,CACXy2D,WAAY,EACZxf,WAAY,EACZuuL,WAAa,CAAC,MAAO,MAAO,UAAW,MAAO,OAAQ,UACtDC,mBAAqB,CAAC,EACtBC,mBAAqB,CACjBpuI,IAAM,CACFquI,eAAgB,EAChBrmD,gBAAiB,EACjBvkJ,aAAe,CAAC,GAEpBu/I,IAAM,CACFv/I,aAAe,CAAC,GAEpBshJ,QAAU,CACNthJ,aAAe,CAAC,GAEpB6qM,OAAS,CACL7qM,aAAe,CAAC,EAChBvmB,OAAS,CAAC,KAQlBxU,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBpuI,KAAOt3F,EAAQ0lO,mBAAmBpuI,IAAIquI,gBAC/FvlO,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIquI,cAAgB3lO,EAAQ0lO,mBAAmBpuI,IAAIquI,eAGnF3lO,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBpuI,KAAOt3F,EAAQ0lO,mBAAmBpuI,IAAIgoF,iBAC/Fl/K,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIgoF,eAAiBt/K,EAAQ0lO,mBAAmBpuI,IAAIgoF,gBAIpFt/K,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBpuI,KAAOt3F,EAAQ0lO,mBAAmBpuI,IAAIv8D,aAE/F36B,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIv8D,aAAe/6B,EAAQ0lO,mBAAmBpuI,IAAIv8D,aAGlF36B,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIv8D,aAAe,IAAI1qB,EAAAA,MAAM,CACzD8E,MAAQyvN,EAAYiB,cAAc1wN,MAClCgD,OAASysN,EAAYiB,cAAc1tN,OACnCmE,KAAOsoN,EAAYiB,cAAcvpN,KACjCra,KAAO2iO,EAAYiB,cAAc5jO,OAGrCjC,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBprD,KAAOt6K,EAAQ0lO,mBAAmBprD,IAAIv/I,aAE/F36B,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,aAAe/6B,EAAQ0lO,mBAAmBprD,IAAIv/I,aAGlF36B,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,aAAe,IAAI1qB,EAAAA,MAAM,CACzD8E,MAAQyvN,EAAYiB,cAAc1wN,MAClCgD,OAASysN,EAAYiB,cAAc1tN,OACnCmE,KAAOsoN,EAAYiB,cAAcvpN,KACjCra,KAAO2iO,EAAYiB,cAAc5jO,OAGrCjC,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBrpD,SAAWr8K,EAAQ0lO,mBAAmBrpD,QAAQthJ,aAEvG36B,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,aAAe/6B,EAAQ0lO,mBAAmBrpD,QAAQthJ,aAG1F36B,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,aAAe,IAAI1qB,EAAAA,MAAM,CAC7D8E,MAAQyvN,EAAYiB,cAAc1wN,MAClCgD,OAASysN,EAAYiB,cAAc1tN,OACnCmE,KAAOsoN,EAAYiB,cAAcvpN,KACjCra,KAAO2iO,EAAYiB,cAAc5jO,OAIrCjC,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBE,QAAU5lO,EAAQ0lO,mBAAmBE,OAAO7qM,aAErG36B,KAAKJ,QAAQ0lO,mBAAmBE,OAAO7qM,aAAe/6B,EAAQ0lO,mBAAmBE,OAAO7qM,aAGxF36B,KAAKJ,QAAQ0lO,mBAAmBE,OAAO7qM,aAAe,IAAI1qB,EAAAA,MAAM,CAC5D8E,MAAQyvN,EAAYiB,cAAc1wN,MAClCgD,OAASysN,EAAYiB,cAAc1tN,OACnCmE,KAAOsoN,EAAYiB,cAAcvpN,KACjCra,KAAO2iO,EAAYiB,cAAc5jO,OAIrCjC,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBE,QAAU5lO,EAAQ0lO,mBAAmBE,OAAOpxN,OAErGpU,KAAKJ,QAAQ0lO,mBAAmBE,OAAOpxN,OAASxU,EAAQ0lO,mBAAmBE,OAAOpxN,OAElFpU,KAAKJ,QAAQ0lO,mBAAmBE,OAAOpxN,OAAS,CAC5CjE,OAAQ,EACRkP,UAAW,EACX3P,QAAS,EACTgQ,QAAS,EACTzgB,OAAQ,EACRwQ,QAAS,EACTT,QAAS,EACTG,OAAQ,GAIZvP,EAAQ0lO,oBAAsB1lO,EAAQ0lO,mBAAmBE,QAAU5lO,EAAQ0lO,mBAAmBE,OAAO96N,eAAe,WACpH1K,KAAKJ,QAAQ0lO,mBAAmBE,OAAOxxN,QAAUpU,EAAQ0lO,mBAAmBE,OAAOxxN,QAEnFhU,KAAKJ,QAAQ0lO,mBAAmBE,OAAOxxN,SAAU,EAIjDxK,MAAM4E,QAAQxO,EAAQwlO,YAAa,CAEnC,IADA,IAAIA,EAAa,GACRhwN,EAAI,EAAGA,EAAIxV,EAAQwlO,WAAWhkO,OAAQgU,IAC3CgwN,EAAWx/N,KAAKhG,EAAQwlO,WAAWhwN,IAEvCpV,KAAKJ,QAAQwlO,WAAaA,CAC9B,CAGA30N,GAAAA,EAAMC,YAAY1Q,KAAKJ,QAASA,GAGhCI,KAAKq2D,UAAYr2D,KAAKJ,QAAQy2D,UAG9Br2D,KAAK62C,UAAY72C,KAAKJ,QAAQi3C,UAG9B72C,KAAK4f,KAAO5f,KAAKJ,QAAQsE,IAAMwmB,GAAAA,EAAWxV,WAG1ClV,KAAK6yF,UAAW,EAEhB7yF,KAAKiuK,OAAS,KAGdjuK,KAAK0lO,mBAEL1lO,KAAK2lO,qBAML3lO,KAAK+kO,kBAAoB,KACzB/kO,KAAK4kO,aAAe,KACpB5kO,KAAKglO,kBAAoB,KACzBhlO,KAAK8kO,mBAAqB,KAC1B9kO,KAAK4lO,kBAAoB,KACzB5lO,KAAK6lO,wBAA0B,KAC/B7lO,KAAKqlL,eAAiB,KACtBrlL,KAAK8lO,wBAA0B,KAC/B9lO,KAAK+lO,sBAAwB,KAC7B/lO,KAAKgmO,uBAAyB,KAC9BhmO,KAAKimO,aAAe,KACpBjmO,KAAKkmO,mBAAqB,KAC1BlmO,KAAKmmO,4BAA8B,KACnCnmO,KAAK2kO,aAAe,KACpB3kO,KAAKomO,mBAAqB,KAC1BpmO,KAAKqmO,4BAA8B,KAEnCrmO,KAAK4uF,kBAAoB,KACzB5uF,KAAKsmO,kBAAoB,KAIzBtmO,KAAKumO,mBAAoB,EACzBvmO,KAAKwmO,kBAAoB,KACzBxmO,KAAKymO,mBAAqB,KAC1BzmO,KAAK0mO,yBAA2B,GAChC1mO,KAAK2mO,oBAAsB,KAC3B3mO,KAAK4mO,0BAA4B,GAIjC5mO,KAAK6mO,mBAAoB,EAIzB7mO,KAAKilO,cAAgB,KACrBjlO,KAAKwV,KAAO,KACZxV,KAAK8mO,MAAQ,KACb9mO,KAAKmlO,MAAQ,IACjB,GAEA,CAAAr+N,IAAA,qBAAAC,MAOA,SAAoBnH,GAEhB,GAAIA,EAAQwlO,WAAY,CACpB,IAAIA,EAAaxlO,EAAQwlO,WAEzB,GAAK57N,MAAM4E,QAAQg3N,GAUZ,CAWH,IAVA,IAAI2B,EAAY,CACZ,MACA,MACA,UACA,MACA,OACA,MACA,UAEAC,EAAoB,GACf5xN,EAAI,EAAGA,EAAIgwN,EAAWhkO,OAAQgU,IACN,iBAAlBgwN,EAAWhwN,IAElB4xN,EAAkBphO,KAAKwP,GACvB/V,GAAOmU,KAAK,oFAAsF4xN,EAAWhwN,GAAK,OAGlHgwN,EAAWhwN,GAAKgwN,EAAWhwN,GAAGzK,eACY,IAAtCo8N,EAAUttN,QAAQ2rN,EAAWhwN,MAE7B4xN,EAAkBphO,KAAKwP,GACvB/V,GAAOqD,IAAI,iDAAmD0iO,EAAWhwN,GAAK,6BAG5D,YAAlBgwN,EAAWhwN,KACXgwN,EAAWhwN,GAAK,WAEE,WAAlBgwN,EAAWhwN,KACXgwN,EAAWhwN,GAAK,WAK5B,GAAiC,IAA7B4xN,EAAkB5lO,OAClB,IAAK,IAAIwlB,EAAIogN,EAAkB5lO,OAAS,EAAGwlB,GAAK,EAAGA,IAC/Cw+M,EAAWr/L,OAAOihM,EAAkBpgN,GAAI,EAGpD,MAhDIvnB,GAAOmU,KAAK,6IACZ5T,EAAQwlO,WAAa,CACjB,MACA,MACA,UACA,MACA,OACA,SA0CZ,CACJ,GAEA,CAAAt+N,IAAA,qBAAAC,MAMA,WACI,IAAIkgO,EAAmBjnO,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIv8D,aAC3D36B,KAAKknO,iBAAmB,IAAIj3N,EAAAA,MAAM,CAC9B8E,MAAQkyN,EAAiBlyN,MACzBgD,OAASkvN,EAAiBlvN,OAC1BmE,KAAO+qN,EAAiB/qN,KACxBra,KAAOolO,EAAiBplO,OAE5B,IAAIslO,EAAmBnnO,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,aAC3D36B,KAAKonO,iBAAmB,IAAIn3N,EAAAA,MAAM,CAC9B8E,MAAQoyN,EAAiBpyN,MACzBgD,OAASovN,EAAiBpvN,OAC1BmE,KAAOirN,EAAiBjrN,KACxBra,KAAOslO,EAAiBtlO,OAE5B,IAAIwlO,EAAuBrnO,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,aACnE36B,KAAKsnO,qBAAuB,IAAIr3N,EAAAA,MAAM,CAClC8E,MAAQsyN,EAAqBtyN,MAC7BgD,OAASsvN,EAAqBtvN,OAC9BmE,KAAOmrN,EAAqBnrN,KAC5Bra,KAAOwlO,EAAqBxlO,OAEhC,IAAI0lO,EAAsBvnO,KAAKJ,QAAQ0lO,mBAAmBE,OAAO7qM,aACjE36B,KAAKwnO,oBAAsB,IAAIv3N,EAAAA,MAAM,CACjC8E,MAAQwyN,EAAoBxyN,MAC5BgD,OAASwvN,EAAoBxvN,OAC7BmE,KAAOqrN,EAAoBrrN,KAC3Bra,KAAO0lO,EAAoB1lO,MAEnC,GAEA,CAAAiF,IAAA,mBAAAC,MAMA,WACI/G,KAAKynO,mBAAqBznO,KAAKJ,QAAQwlO,WAAW,IAAM,MACxB,QAA5BplO,KAAKynO,oBAA4D,QAA5BznO,KAAKynO,oBAA4D,YAA5BznO,KAAKynO,oBAAgE,WAA5BznO,KAAKynO,mBACxHznO,KAAK0nO,4BAA6B,EACC,QAA5B1nO,KAAKynO,oBAA4D,SAA5BznO,KAAKynO,oBAA6D,QAA5BznO,KAAKynO,qBACvFznO,KAAK0nO,4BAA6B,GAEtC1nO,KAAK2nO,yBAA2B,OACpC,GAEA,CAAA7gO,IAAA,iBAAAC,MAMA,WAEI,IAAIY,EAAY3H,KAAKsmB,8BAGjByzC,EAAQ/5D,KAAK+kO,kBAAoB/kO,KAAKohO,gCAC1Cz5N,EAAUQ,YAAY4xD,GAGtB,IAAI6tK,EAAc5nO,KAAK4kO,aAAe5kO,KAAKshO,4BACvCuG,EAAsB7nO,KAAKuhO,+BAC/BqG,EAAYz/N,YAAY0/N,GAGxB,IAAI3tK,EAAcl6D,KAAK8kO,mBAAqB9kO,KAAKwhO,kCAE7CsG,EAAc9nO,KAAK6lO,wBAA0B7lO,KAAKyhO,uCACtDvnK,EAAY/xD,YAAY2/N,GAGxB,IAAI1tK,EAAap6D,KAAK4lO,kBAAoB5lO,KAAK6hO,iCAC/C3nK,EAAY/xD,YAAYiyD,GAExB,IAAIC,EAAar6D,KAAKglO,kBAAoBhlO,KAAK8hO,iCAC/C5nK,EAAY/xD,YAAYkyD,GACxBwtK,EAAoB1/N,YAAY+xD,GAGhC,IAAI6tK,EAAa/nO,KAAKqlL,eAAiBrlL,KAAKgoO,wBAC5CH,EAAoB1/N,YAAY4/N,GAGhC,IAAIE,EAAcjoO,KAAKimO,aAAejmO,KAAKujO,kCAGvC2E,EAA0BloO,KAAKmmO,4BAA8BnmO,KAAK2jO,sCACtEsE,EAAY9/N,YAAY+/N,GACxBL,EAAoB1/N,YAAY8/N,GAGhC,IAAIE,EAAcnoO,KAAK2kO,aAAe3kO,KAAKmkO,kCAGvCiE,EAA0BpoO,KAAKqmO,4BAA8BrmO,KAAKukO,sCACtE4D,EAAYhgO,YAAYigO,GAGxB,IAAIC,EAAUroO,KAAKsmO,kBAAoBtmO,KAAKmhO,wBAC5CgH,EAAYhgO,YAAYkgO,GAExBR,EAAoB1/N,YAAYggO,GAGhC,IAAI72I,EAAUtxF,KAAK4uF,kBAAoB5uF,KAAKoiO,8BAK5C,OAJAyF,EAAoB1/N,YAAYmpF,GAEhC3pF,EAAUQ,YAAYy/N,GAEfjgO,CACX,GAEA,CAAAb,IAAA,wBAAAC,MAMA,WAEI,IAAIghO,EAAa/nO,KAAK+hO,gCAGlBuG,EAAsBtoO,KAAKiiO,6BAA6BjiO,KAAKJ,QAAQwlO,YACzE2C,EAAW5/N,YAAYmgO,GAIvB,IAAIC,EAA8BvoO,KAAKqiO,mCAAmCriO,KAAKJ,QAAQwlO,WAAW,IAE9FoD,EAAkBxoO,KAAKuiO,yBAC3BgG,EAA4BpgO,YAAYqgO,GAExC,IAAIC,EAAqBzoO,KAAKwiO,6BAE1BkG,EAA0B1oO,KAAKyiO,8BACnCgG,EAAmBtgO,YAAYugO,GAC/B,IAAIC,EAAwB3oO,KAAK2iO,4BACjC8F,EAAmBtgO,YAAYwgO,GAC/BJ,EAA4BpgO,YAAYsgO,GAGxC,IAAIG,EAAsB5oO,KAAK4iO,6BAE/BgG,EAAoBzgO,YAAYnI,KAAK6iO,gCAErC7iO,KAAK8lO,wBAA0B9lO,KAAK8iO,0BACpC8F,EAAoBzgO,YAAYnI,KAAK8lO,yBAErCyC,EAA4BpgO,YAAYygO,GAGxC,IAAIC,EAAoB7oO,KAAK+iO,2BAE7B8F,EAAkB1gO,YAAYnI,KAAKgjO,8BAEnChjO,KAAK+lO,sBAAwB/lO,KAAKijO,wBAClC4F,EAAkB1gO,YAAYnI,KAAK+lO,uBAEnCwC,EAA4BpgO,YAAY0gO,GAGxCd,EAAW5/N,YAAYogO,GAIvB,IAAIO,EAA+B9oO,KAAKkjO,8BAA8BljO,KAAKJ,QAAQwlO,WAAW,IAE1F2D,EAAsB/oO,KAAKmjO,uBAE/B4F,EAAoB5gO,YAAYnI,KAAKojO,+BAErCpjO,KAAKgmO,uBAAyBhmO,KAAKqjO,yBACnC0F,EAAoB5gO,YAAYnI,KAAKgmO,wBAErC8C,EAA6B3gO,YAAY4gO,GAEzChB,EAAW5/N,YAAY2gO,GAGvB,IAAIE,EAAShpO,KAAKsjO,iCAGlB,OAFAyE,EAAW5/N,YAAY6gO,GAEhBjB,CACX,GAMA,CAAAjhO,IAAA,qBAAAC,MAQA,SAAoB9E,GAChB,IAAI+4D,EAASh7D,KAAK+kO,kBAAkBr8M,YACrB,SAAXsyC,GACAh7D,KAAKgoC,cAET,IAAI/hC,EAAMjG,KAAKiH,SAEf43E,GAAAA,EAAalnD,MAAM1xB,GAGnBjG,KAAKq2D,YAAyB,SAAX2E,GACnBh7D,KAAKi9C,cAAc,oBAEfj9C,KAAKJ,QAAQyE,WAAarE,KAAKq2D,WAC/Br2D,KAAKi7D,eAAej7D,KAAKJ,QAAQyE,UAIjCrE,KAAK6mO,mBACL7mO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,kBAAmB,oBACvDrO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,aAAc,eAClDrO,KAAKipO,sBACEjpO,KAAKumO,mBACZvmO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,kBAAmB,oBACvDrO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,aAAc,eAClDrO,KAAKipO,uBAELjpO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,mBAAoB,mBACxDrO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,cAAe,cACnDrO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,mBAAoB,mBACxDrO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,cAAe,cACnDrO,KAAKkpO,wBAEb,GAEA,CAAApiO,IAAA,sBAAAC,MAQA,SAAqB9E,GACjBjC,KAAKynO,mBAAqBxlO,EAAEc,OAAOgE,MACH,QAA5B/G,KAAKynO,oBAA4D,QAA5BznO,KAAKynO,oBAA4D,YAA5BznO,KAAKynO,oBAAgE,WAA5BznO,KAAKynO,mBACxHznO,KAAK0nO,4BAA6B,EACC,QAA5B1nO,KAAKynO,oBAA4D,SAA5BznO,KAAKynO,oBAA6D,QAA5BznO,KAAKynO,qBACvFznO,KAAK0nO,4BAA6B,EAE1C,GAEA,CAAA5gO,IAAA,4BAAAC,MAQA,SAA2B9E,GACvBjC,KAAK2nO,yBAA2B1lO,EAAEc,OAAOgE,KAC7C,GAEA,CAAAD,IAAA,sBAAAC,MAOA,WAEoC,QAA5B/G,KAAKynO,oBACmB,SAA5BznO,KAAKynO,oBACuB,QAA5BznO,KAAKynO,oBACDznO,KAAKmpO,wBAEb,GAEA,CAAAriO,IAAA,sBAAAC,MAOA,WACI/G,KAAKopO,yBACLppO,KAAKsmO,kBAAkB59N,UAAY,GACnC1I,KAAK6lO,wBAAwBv+M,UAAUjZ,QAAQ,mBAAoB,mBACnErO,KAAK6lO,wBAAwBv+M,UAAUjZ,QAAQ,cAAe,cAC9DrO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,mBAAoB,mBACxDrO,KAAK2kO,aAAar9M,UAAUjZ,QAAQ,cAAe,aACvD,GAEA,CAAAvH,IAAA,sBAAAC,MAQA,SAAqB9E,GAEjBjC,KAAK0jO,sBACL1jO,KAAKskO,sBACLtkO,KAAKsmO,kBAAkB59N,UAAY,EACvC,GAMA,CAAA5B,IAAA,kBAAAC,MAOA,WACI1H,GAAOqD,IAAI,iCAAmC1C,KAAKynO,oBAInDznO,KAAKilO,cAAgB,KAErBjlO,KAAKklO,eAAiB,KAElBllO,KAAK0nO,4BAEL1nO,KAAKqpO,cAAa,GAClBrpO,KAAKspO,sBAELtpO,KAAKupO,sBAEb,GAMA,CAAAziO,IAAA,qBAAAC,MAMA,WACI,IAAI22D,EACA8rK,EAAwBhhO,SAASqL,eAAe7T,KAAK2f,QAAQ,iBAC7D6pN,IACA9rK,EAAY8rK,EAAsBziO,OAAS,GAC3C1H,GAAOqD,IAAI,uBAAyBg7D,IAGF,UAAlC19D,KAAK2nO,0BACLtoO,GAAOqD,IAAI,uCACX1C,KAAKypO,gCAAgC/rK,IACI,QAAlC19D,KAAK2nO,2BACZtoO,GAAOqD,IAAI,gCACX1C,KAAK0pO,0BAA0BhsK,GAEvC,GAEA,CAAA52D,IAAA,4BAAAC,MAOA,SAA2B22D,GAEvB,IAAIl+D,EAAMQ,KAAK+lO,sBAAsBh/N,MAErC,GADA1H,GAAOqD,IAAI,SAAUlD,GACF,IAAfA,EAAI4B,OAAR,CAKI5B,EAAIwiB,OACJxiB,EAAMA,EAAIwiB,QAIdhiB,KAAKwV,KAAOhW,EAGPk+D,IACDA,EAAY19D,KAAKwV,KAAKsB,UAAU9W,KAAKwV,KAAKuB,YAAY,KAAO,EAAG/W,KAAKwV,KAAKuB,YAAY,OAI1F/W,KAAKmlO,MAAQznK,EAGT19D,KAAKJ,QAAQylO,oBAAsBrlO,KAAKJ,QAAQylO,mBAAmBrE,WACnExhO,EAAMqhO,GAAWC,WAAWthO,EAAKQ,KAAKJ,QAAQylO,qBAOlD,IAAIt6N,EAAU/K,KACdqvB,GAAAA,GAAGuR,UAAUC,IAAI1hC,KAAK,CAClBK,IAAMA,EACNE,OAAS,MACTI,QAAU,KAEVU,WAAa,SAAUD,GACnBwK,EAAQ+hK,wBACR/hK,EAAQ4+N,kCAAkCppO,EAAUm9D,EACxD,EAEA/8D,UAAY,SAAUD,GAElBqK,EAAQ+hK,wBACRztK,GAAOqB,MAAM,oEAAqEA,EACtF,GAzCJ,MAFIrB,GAAOqB,MAAM,sDA6CrB,GAEA,CAAAoG,IAAA,kCAAAC,MAOA,SAAiC22D,GAC7B,IAAIksK,EAAO5pO,KAAK8lO,wBAAwB+D,MAAM,GAC9C,GAAKD,EAAL,CAMA5pO,KAAK8mO,MAAQ8C,EAGRlsK,IACDA,EAAY19D,KAAK8mO,MAAMz+N,KAAKyO,UAAU9W,KAAK8mO,MAAMz+N,KAAK0O,YAAY,KAAO,EAAG/W,KAAK8mO,MAAMz+N,KAAK0O,YAAY,OAI5G/W,KAAKmlO,MAAQznK,EAGb,IAAIosK,EAAU,IAAIC,WAIdh/N,EAAU/K,KAEd8pO,EAAQtnO,QAAU,SAACP,GAEf8I,EAAQ+hK,wBACRztK,GAAOqB,MAAM,sBAAuBuB,EACxC,EAEA6nO,EAAQE,WAAa,WACjB3qO,GAAOqD,IAAI,aACf,EAEAonO,EAAQG,YAAc,WAElBl/N,EAAQ4lK,2BACRtxK,GAAOqD,IAAI,cACf,EAEAonO,EAAQI,QAAU,WAEdn/N,EAAQ+hK,wBACRztK,GAAOqD,IAAI,UACf,EAEAonO,EAAQK,UAAY,SAACloO,GAKjB5C,GAAOqD,IAAI,eAAgBT,EAC/B,EAEA6nO,EAAQzmO,OAAS,SAACpB,GACd5C,GAAOqD,IAAI,sCAAuCT,EAAEc,OAAOkI,QAG3DF,EAAQ+hK,wBACR/hK,EAAQ4+N,kCAAkC1nO,EAAEc,OAAOkI,OAAQyyD,EAC/D,EAGAosK,EAAQM,WAAWR,EA3DnB,MAFIvqO,GAAOmU,KAAK,wCA8DpB,GAEA,CAAA1M,IAAA,oCAAAC,MAQA,SAAmCsjO,EAAa3sK,GAE5C,IAAIz3D,EAAMjG,KAAKiH,SACf,GAAKhB,GAAQokO,EAAb,CAIA,IAAIC,EAAc,KACdC,EAAe,KACfC,EAAe,KACfC,EAAc,KAKlB,GAFAzqO,KAAKilO,cAAgBoF,EAEW,WAA5BrqO,KAAKynO,mBAAiC,CAKtCznO,KAAK6mO,mBAAoB,EAGzB,IAAIl+N,EAAO3I,KAGP0qO,EAAYlnO,KAAKC,MAAM4mO,GAGvBM,EAAaD,EAAUzpN,QAKvB2pN,EAAiB1pO,OAAOC,KAAKwpO,GAAYvpO,OAAS,EAAK,EAAI,EAE/D,IAAK,IAAIypO,KAAeF,EACpB,GAAIA,EAAWjgO,eAAemgO,GAAc,CACxC,IAAI5yK,EAAS,GACTC,EAAe,GACfE,EAAgB,KAChBD,EAAW,KACX72C,EAAY,KACZwpN,EAAe,KAMnB,GAAIJ,EAAUvoN,SACV,IAAK,IAAIyjD,KAAM8kK,EAAUvoN,SACrB,GAAIuoN,EAAUvoN,SAASzX,eAAek7D,GAAK,CACvC,IAAImlK,EAAQnlK,EAAGhtD,MAAM,KACrB,GAAiB,eAAbmyN,EAAM,GAAqB,CAC3B,IAAIjkO,EAAMikO,EAAM,GAChB,GAAY,UAARjkO,EAAiB,CACjBmxD,EAASyyK,EAAUvoN,SAASyjD,GAC5B,QACJ,CACA,GAAY,gBAAR9+D,EAAuB,CACvBoxD,EAAewyK,EAAUvoN,SAASyjD,GAClC,QACJ,CACA,GAAY,iBAAR9+D,EAAwB,CACxBsxD,EAAgBsyK,EAAUvoN,SAASyjD,GACnC,QACJ,CACA,GAAY,YAAR9+D,EAAmB,CACnBqxD,EAAWuyK,EAAUvoN,SAASyjD,GAC9B,QACJ,CACA,GAAY,aAAR9+D,EAAoB,CACpBwa,EAAYopN,EAAUvoN,SAASyjD,GAC/B,QACJ,CACA,GAAY,gBAAR9+D,EAAuB,CACvBgkO,EAAeJ,EAAUvoN,SAASyjD,GAClC,QACJ,CACJ,CACJ,CAKH3N,IACDA,EAAS,iBAGRC,IACDA,EAAe,iBAGnBD,EAAU2yK,EAAiB3yK,EAAS,IAAM4yK,EAAc,IAAM5yK,EAG9D,IAAI+yK,EAAYL,EAAWE,GAGvBI,EAAUD,EAAU9+N,KAExB,GAAgB,WAAZ++N,EAAsB,CAEtB,IAAIC,EAASF,EAAUxrO,IAEnB2rO,EAAWH,EAAUt+C,MAErB0+C,EAAYV,EAAUlnN,OAK1B,GAAI0nN,GAA0C,IAAhCA,EAAOzxN,QAAQ,aAAoB,CAC7C,IAAI4xN,EAAcrrO,KAAKwV,KACvB,GAAI61N,GAUA,GATAF,EAAW,CAAC,IAAK,IAAK,IAAK,KAAKllO,KAAI,SAAU4tC,GAG1C,MAAO,WACPA,EAAO,wBAHIq3L,EAAO78N,QAAQ,YAAa,IAIhC,2BAHWg9N,EAAYzyN,MAAM,KAAK,EAK7C,IAEuC,IAAnCwyN,EAAU3xN,QAAQ,aAAoB,CACtC,IAAIi2B,EAAI27L,EAAYzyN,MAAM,KAC1B8xN,EAAUlnN,OAASksB,EAAE,GAAFA,WAAyBA,EAAE,EAClD,OAEArwC,GAAOmU,KAAK,0FAEpB,CAEA,GAAI23N,EAEAX,EAAe,IAAIn/C,IAAJ,CAAQ,CACnBigD,aAAej2M,OAEnBk1M,EAAe,IAAIgB,IAAJ,CAAqB,CAChClM,aAAe2L,EAAUl+C,YACzBntL,OAAS6qO,EAUT97C,KAAOy8C,KAEElzK,OAASA,EACtBsyK,EAAaryK,aAAeA,EAC5BqyK,EAAanyK,cAAgBA,EAC7BmyK,EAAajpN,UAAYA,EACzBipN,EAAapyK,SAAWA,EACxBoyK,EAAaO,aAAeA,EAE5BP,EAAax8M,GAAG,iBAAiB,SAAU9rB,GACvC0G,EAAK29N,kBAAkB59N,UAAY,qBACvC,IACA6hO,EAAax8M,GAAG,eAAe,SAAU9rB,GACrC0G,EAAK29N,kBAAkB59N,UAAY,EACvC,IACA6hO,EAAax8M,GAAG,iBAAiB,SAAU9rB,GACvC0G,EAAK29N,kBAAkB59N,UAAY,EACvC,KACA4hO,EAAc,IAAIvvK,IAAJ,CAAoB,CAC9Bn+C,OAAS2tN,EACT/1N,SAAU,EAEVg3N,WAAY,KAEJtnO,GAAK2mO,EACjBP,EAAY7sK,gBAAkB,eAAiBz9D,KAAKynO,wBACjD,GAAIyD,EAAQ,CAEfV,EAAe,IAAIn/C,IAAJ,CAAQ,CACnBigD,aAAej2M,OAEnBi1M,EAAc,IAAIvvK,IAAJ,CAAoB,CAC9BvmD,SAAU,EAEVg3N,WAAY,KAEJtnO,GAAK2mO,EACjBP,EAAY7sK,gBAAkB,eAAiBz9D,KAAKynO,mBACpD,IAAIgE,EAAiB,IAAIC,IAAJ,CAAmB,CACpClsO,IAAM0rO,IAMNh9K,EAAOu9K,EAAe19M,GAAG,UAAU,WACnC,GAAkC,UAA9B09M,EAAeE,WAAwB,CAIvC,IAHA,IAAIC,EAAeH,EAAe3M,cAE9BpyC,EAAQljL,MAAM4E,QAAQw9N,EAAal/C,OAASk/C,EAAal/C,MAAQ,CAACk/C,EAAal/C,OAC1Et3K,EAAI,EAAGA,EAAIs3K,EAAMtrL,OAAQgU,IAAK,CACnC,IAAIioD,EAAOqvH,EAAMt3K,GACY,IAAzBioD,EAAK5jD,QAAQ,UACbizK,EAAMt3K,GAAK81N,EAAS7tK,EAE5B,EACAktK,EAAe,IAAIgB,IAAJ,CAAqB,CAChClM,aAAeoM,EAAejP,mBAAqBoP,EAAa9+C,YAChEntL,OAAS6qO,EAOT97C,KAAOhC,KAEEz0H,OAASA,EACtBsyK,EAAaryK,aAAeA,EAC5BqyK,EAAanyK,cAAgBA,EAC7BmyK,EAAajpN,UAAYA,EACzBipN,EAAapyK,SAAWA,EACxBoyK,EAAaO,aAAeA,EAE5BP,EAAax8M,GAAG,iBAAiB,SAAU9rB,GACvC0G,EAAK29N,kBAAkB59N,UAAY,qBACvC,IACA6hO,EAAax8M,GAAG,eAAe,SAAU9rB,GACrC0G,EAAK29N,kBAAkB59N,UAAY,EACvC,IACA4hO,EAAYxN,UAAUyN,GACtBD,EAAYnjO,IAAI,mBAAoBykO,EAA4B,gBAChE/+M,EAAAA,EAAAA,SAAoBqhC,EACxB,CACJ,GACJ,CACJ,KAAO,IAAgB,YAAZ+8K,EA4BP,YADA5rO,GAAOmU,KAAK,gCAvBZ,IAAIq4N,EAAUb,EAAUnrO,KAExB2qO,EAAe,IAAIz6I,GAAAA,GACnBw6I,EAAe,IAAIgB,IAAJ,CAAqB,CAChClM,aAAe2L,EAAUl+C,YACzBntL,OAAS6qO,EACThrO,IAAMqsO,KAEG5zK,OAASA,EACtBsyK,EAAaryK,aAAeA,EAC5BqyK,EAAanyK,cAAgBA,EAC7BmyK,EAAajpN,UAAYA,EACzBipN,EAAapyK,SAAWA,EACxBoyK,EAAaO,aAAeA,GAC5BR,EAAc,IAAIvvK,IAAJ,CAAoB,CAC9Bn+C,OAAS2tN,EACT/1N,SAAU,EAEVg3N,WAAY,KAEJtnO,GAAK2mO,EACjBP,EAAY7sK,gBAAkB,eAAiBz9D,KAAKynO,kBAIxD,CAGA,IAAIqE,EAAWtoO,KAAKC,MAAMD,KAAKqC,UAAU6kO,IAEzC,GAAIE,EAAe,CAGf,IADA,IAAImB,EAAYD,EAASpsN,OAChBwC,EAAK,EAAGA,EAAK6pN,EAAU3qO,OAAQ8gB,IACrB6pN,EAAU7pN,GACZtF,SAAWiuN,GACpBkB,EAAUhmM,OAAO7jB,EAAI,GAK7B,IAAK,IAAI8pN,KAAaF,EAAS7qN,QACvB6qN,EAAS7qN,QAAQvW,eAAeshO,IAC5BA,IAAcnB,UACPiB,EAAS7qN,QAAQ+qN,EAIxC,EAiBA,SAAWhwL,GAGP,IAAI1gB,EAAW,WACX2wM,GAAejwL,EAAExvC,MAAOwvC,EAAE3gB,OAAQ,CAAEze,OAASo/B,EAAE93C,KAC1C5D,MAAK,WAEF07C,EAAExvC,MAAM+uD,YADS,GAGjBvf,EAAExvC,MAAM4uD,WADM,EAElB,IACC96D,MAAK,WAEF,IAAI4rO,EAAWjmO,EAAImmB,UAAUC,gBAAgBC,UACzCrmB,EAAImmB,WAAa4vB,EAAE3gB,OAAOwwJ,QAAU7vI,EAAE3gB,OAAOwwJ,OAAOzqL,QACpD6E,EAAImmB,UAAUuC,WAAUnC,EAAAA,EAAAA,WAAgBwvB,EAAE3gB,OAAOwwJ,OAAQ,YAAaqgD,IAItEjmO,EAAImmB,YAAc4vB,EAAE3gB,OAAO0wJ,MAA0B,IAAlB/vI,EAAE3gB,OAAO0wJ,OAC5C9lL,EAAImmB,UAAU+/M,QAAQnwL,EAAE3gB,OAAO0wJ,MAKnC,IAAInvK,EAASo/B,EAAExvC,MAAMuwD,YACrB,GAAI92D,EAAImmB,WAAanmB,EAAIm4D,UAAW,CAChC,IAAIC,EAAe,MAEfA,EADAzhD,GAAUA,EAAO0hD,UACF1hD,EAAO0hD,YAEP1hD,EAAO2hD,cAAcD,cAGpBD,EAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,EAAcp4D,EAAIm4D,UAE5C,CACJ,IACC99D,MAAK,WAEFqI,EAAKsgO,qBACLtgO,EAAKm8N,mBAAmBx9M,UAAUjZ,QAAQ,mBAAoB,mBAC9D1F,EAAKm8N,mBAAmBx9M,UAAUjZ,QAAQ,cAAe,cACzD1F,EAAKi9N,kBAAkBzzN,UAAY,qBAGnC,IAAIiC,EAAS,IAAIyL,GAAAA,QAAO,CACpB9c,OAAS4F,EAAK09N,4BACdpnO,MAAQuE,KAAKC,MAAMD,KAAKqC,UAAUm2C,EAAE3gB,SACpCt7B,MAAQC,KACR8f,OAAS,CACL,kBAAoBnX,EAAKyjO,gBACzB,iCAAmCzjO,EAAK0jO,gCACxC,iCAAmC1jO,EAAK2jO,8BACxC,iCAAmC3jO,EAAK4jO,8BACxC,8BAAgC5jO,EAAK6jO,iCACrC,+BAAiC7jO,EAAK8jO,6BAE1Cv8N,MAAQvH,EAAK/I,QAAQ0lO,mBAAmBE,OAAOpxN,SAKnD,OAHAA,EAAOs4N,WAAW,MAAOzmO,GACzBmO,EAAOs4N,WAAW,QAAS1wL,EAAExvC,OAEtB4H,EAAO3L,gBACTnI,MAAK,WAEF,GAAkC,IAA9B8T,EAAOuP,YAAYviB,OACnB,MAAM,IAAI3B,MAAM,uDAExB,IACCa,MAAK,WAEEqI,EAAK/I,QAAQ0lO,mBAAmBE,OAAOxxN,UACvCrL,EAAKm8N,mBAAmBx9M,UAAUjZ,QAAQ,kBAAmB,oBAC7D1F,EAAKm8N,mBAAmBx9M,UAAUjZ,QAAQ,aAAc,eACxD1F,EAAKg8N,aAAar9M,UAAUjZ,QAAQ,kBAAmB,oBACvD1F,EAAKg8N,aAAar9M,UAAUjZ,QAAQ,aAAc,eAClD1F,EAAKk9N,wBAAwBv+M,UAAUjZ,QAAQ,kBAAmB,oBAClE1F,EAAKk9N,wBAAwBv+M,UAAUjZ,QAAQ,aAAc,eAErE,IACC/N,MAAK,WAGF,IADA,IAAIqsO,EAAWhkO,EAAK09N,4BAA4B38N,uBAAuB,iCAC9DT,EAAQ,EAAGA,EAAQ0jO,EAASvrO,OAAQ6H,IAAS,CAClD,IAAMzC,EAAUmmO,EAAS1jO,GACG,WAAxBzC,EAAQo+C,cACRp+C,EAAQo+C,YAAc,yBAE9B,CACJ,IACCtkD,MAAK,WAEF07C,EAAExvC,MAAMrF,IAAI,gBAAiBiN,EAAOw4N,SAGpCtqO,YAAW,WACP2D,EAAIg3C,cAAc,CACd/4C,GAAKkQ,EAAOw4N,QACZ1gO,KAAO,gBACPjN,MAAQ+8C,EAAE3gB,OACV7uB,MAAQwvC,EAAExvC,OAElB,GAAG,IACP,IAAE,OACK,SAAUvK,GAEb,MAAMA,CACV,GACR,IACC3B,MAAK,WAEF2F,EAAIg3C,cAAc,CACd/4C,GAAK83C,EAAE93C,GACPgI,KAAO,iBACPjN,MAAQ+8C,EAAE3gB,QAElB,IAAE,OACK,SAAUp5B,GACb5C,GAAOqB,MAAMuB,GAEbgE,EAAIg3C,cAAc,CACd/4C,GAAK83C,EAAE93C,GACPgI,KAAO,iBACPxL,MAAQuB,GAEhB,GACR,EAGA5C,GAAOmU,KAAKwoC,EAAExvC,OAKd,IAAI6uB,EAASp1B,EAAIuwB,IAAI,kBAAoB,CAAC,EAE1C6E,EADS2gB,EAAE93C,IACE83C,EAAE3gB,OACfp1B,EAAIkB,IAAI,gBAAiBk0B,GAKzB2gB,EAAExvC,MAAMrF,IAAI,gBAAiB60C,EAAE3gB,QAG/Bp1B,EAAI4wD,SAAS7a,EAAExvC,OAiBf7D,EAAKs0C,cAAc,CACf/wC,KAAO,2BACP7D,KAAOq1D,EACP79D,KAAOwqO,EACP79N,MAAQwvC,EAAExvC,MACV7M,OAASgJ,EAAK8+N,mBAAmB1/N,eAAiB,WAIlDi0C,EAAExvC,MAAMuwD,YACRzhC,IAEA0gB,EAAExvC,MAAMqgO,KAAK,gBAAiBvxM,GAIlCr1B,EAAIk6E,cAAcv2E,SACd,SAAC8lB,GACOA,aAAmBymC,GAAAA,SACnBzmC,EAAQmnC,SACJ7a,EAAExvC,MACFwvC,EAAEp8C,QAGd,GAEP,CA9LD,CAda,CACTsE,GAAK2mO,EACLxvM,OAASywM,EACTt/N,MAAQ89N,EACR1qO,QAAU,CACNuQ,MAAQutD,GAAazF,EACrBtxD,YAAcuxD,EACdlD,aAAeoD,EACfj2C,SAAWb,EACXm0C,QAAU0C,EACV20K,YAAchC,IAmM1B,CAQR,KAAO,CAC6B,QAA5B9qO,KAAKynO,oBAELgD,EAAczqO,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIv8D,aAClD6vM,EAAe,IAAInrI,GAAAA,EAAY,CAC3B6/E,eAAiBl/K,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIgoF,eACrDqmD,cAAgBvlO,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIquI,cACpD5qM,aAAe,CACX8vM,MAG2B,QAA5BzqO,KAAKynO,oBAEZgD,EAAczqO,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,aAClD6vM,EAAe,IAAIxuD,GAAAA,QAAY,CAC3BrhJ,aAAe8vM,KAEgB,YAA5BzqO,KAAKynO,qBAEZgD,EAAczqO,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,aACtD6vM,EAAe,IAAIz6I,GAAAA,EAAgB,CAC/Bp1D,aAAe8vM,KAKvB,IAKI56I,EALAk9I,EAAWvC,EAAawC,eAAe3C,GAEvCn8M,EAAUluB,KAAKitO,wBAInBp9I,EAAW26I,EAAap5D,aACpBi5D,EAAa,CACTp6I,eAAiB88I,EACjB78I,kBAAoBhiE,IAI5B7uB,GAAOqD,IAAI,qBAAsBmtF,IAGjC06I,EAAe,IAAIrqJ,IAAJ,CAAiB,CAC5B2P,SAAW,IAAIs7F,QAENs1C,YAAY5wI,GAEzBxwF,GAAOE,MAAMgrO,GAGbA,EAAatyK,OAASsyK,EAAaryK,aAAewF,GAElD4sK,EAAc,IAAIxvK,IAAJ,CAAgB,CAC1Bl+C,OAAS2tN,EACTtrO,MAAQwrO,KAIAhtK,gBAAkB,eAAiBz9D,KAAKynO,mBAGpD,IAAIyF,EAAgB1C,EAAa2C,mBAAmB,sBACpD,GAAID,GAAuD,IAAtChsO,OAAOC,KAAK+rO,GAAe9rO,OAAc,CAK1D,IAAIgsO,EAAqB,CACrBvmM,MAAQ,CAAEwmM,MAAQ9rM,GAAAA,QAAOl5B,KAAO,cAChCilO,SAAW,CAAED,MAAQlpD,GAAAA,QAAU97K,KAAO,YACtCklO,cAAgB,CAAEF,MAAQ/+I,GAAAA,QAAejmF,KAAO,wBAGhDmlO,EAAcN,EAAchhO,KAC5BuhO,EAAeP,EAAc9mE,UACjC,GAAIonE,EAAa,CAEb,IAAIE,EAAcN,EAAmBI,GAAanlO,KAC9CslO,EAAgBF,EAAgBC,EAAc,KAAOD,EAAe,IAAMC,EAC1EE,GAAeR,EAAmBI,GAAY,MAClD,GAAII,GAAc,CAEdtD,EAAY7sK,gBAAkB,sBAE9B6sK,EAAYnjO,IAAI,UAAWqmO,GAC3BlD,EAAYnjO,IAAI,OAAQumO,GACxBpD,EAAYnjO,IAAI,QAASsmO,GACzBnD,EAAYnjO,IAAI,OAAQ+lO,GACxB5C,EAAYnjO,IAAI,QAASwmO,GACzB,IAGI7hE,GAHgB,IAAI/7E,GAAAA,EAAgB,CACpCp1D,aAAe8vM,IAESz6I,cAAcH,EAAU,CAChDI,eAAiB,YACjBC,kBAAoB,cAExBo6I,EAAYnjO,IAAI,UAAW2kK,IAE3B9rK,KAAKiH,SAASk5E,cAAcv2E,SAAQ,SAAC8lB,GAC7BA,aAAmBk+M,KACnBl+M,EAAQg1B,QAAQwoL,GAChBx9M,EAAQ2gE,SAASi6I,GACjB56M,EAAQm+M,OAEhB,GACJ,CACJ,CACJ,CAMA,GAJA5nO,EAAI4wD,SAASyzK,GAITrkO,EAAImmB,WAAanmB,EAAIm4D,WAAamsK,EAAajsK,UAAW,CAC1D,IAAID,GAAeksK,EAAajsK,YAC5BD,IAAgBA,GAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,GAAcp4D,EAAIm4D,UAE5C,CAiBAp+D,KAAKi9C,cAAc,CACf/wC,KAAO,2BACP7D,KAAOq1D,EACP79D,KAAOwqO,EACP79N,MAAQ89N,EACR3qO,OAASK,KAAKynO,mBAAmB1/N,eAEzC,CAjoBA,CAkoBJ,GAEA,CAAAjB,IAAA,uCAAAC,MAQA,SAAsCvH,EAAKk+D,GAEvC,IAAIz3D,EAAMjG,KAAKiH,SACf,GAAKhB,GAAQzG,EAAb,CAIA,IAAI+qO,EACAD,EACAE,EAyEJ,GAxEgC,WAA5BxqO,KAAKynO,mBAELpoO,GAAOE,MAAM,0BAEmB,QAA5BS,KAAKynO,mBAEL+C,EAAe,IAAInrI,GAAAA,EAAY,CAC3B6/E,gBAAiB,EACjBqmD,cAAgBvlO,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIquI,cACpD5qM,aAAe,CACX36B,KAAKJ,QAAQ0lO,mBAAmBpuI,IAAIv8D,gBAGT,QAA5B36B,KAAKynO,mBAEZ+C,EAAe,IAAIxuD,GAAAA,QAAY,CAC3BrhJ,aAAe36B,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,eAEpB,YAA5B36B,KAAKynO,qBAEZ+C,EAAe,IAAIz6I,GAAAA,EAAgB,CAC/Bp1D,aAAe36B,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,gBAK/D4vM,EAAe,IAAIrqJ,IAAJ,CAAiB,CAC5B1gF,IAAMA,EACNG,OAAS6qO,IAGmB,QAA5BxqO,KAAKynO,oBACL8C,EAAauD,gBACT,SAAUh1M,GAEoB,MAAtBA,EAAQvD,aACRl2B,GAAOqD,IAAI,8DACXo2B,EAAQwC,SACJt7B,KAAKJ,QAAQ0lO,mBAAmBprD,IAAIv/I,cAGhD,IAGwB,YAA5B36B,KAAKynO,oBACL8C,EAAauD,gBACT,SAAUh1M,GAEoB,MAAtBA,EAAQvD,aACRl2B,GAAOqD,IAAI,kEACXo2B,EAAQwC,SACJt7B,KAAKJ,QAAQ0lO,mBAAmBrpD,QAAQthJ,cAGpD,IAKR4vM,EAAatyK,OAASsyK,EAAaryK,aAAewF,EAElD4sK,EAAc,IAAIxvK,IAAJ,CAAgB,CAC1Bl+C,OAAS2tN,KAKjBD,EAAY7sK,gBAAkB,eAAiBz9D,KAAKynO,mBACpDxhO,EAAI4wD,SAASyzK,GAITrkO,EAAImmB,WAAanmB,EAAIm4D,WAAamsK,EAAajsK,UAAW,CAC1D,IAAID,EAAeksK,EAAajsK,YAC5BD,GAAgBA,EAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,EAAcp4D,EAAIm4D,UAE5C,CAiBAp+D,KAAKi9C,cAAc,CACf/wC,KAAO,2BACP7D,KAAOq1D,EACPl+D,IAAMA,EACNgN,MAAQ89N,EACR3qO,OAASK,KAAKynO,mBAAmB1/N,eAxGrC,CA0GJ,GAIA,CAAAjB,IAAA,kBAAAC,MAKA,SAAiB9E,GACb,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrB5D,EAAQxM,KAAKu8D,WAAW,SACxB/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,SAAUpQ,EAAMgqB,IAAI,iBAAqBv0B,EAAEc,OAAOkR,SAG9F,GAEA,CAAAnN,IAAA,kCAAAC,MAOA,SAAiC9E,GAC7B,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrBrN,EAASd,EAAEc,OAAOgrO,WAClBvhO,EAAQxM,KAAKu8D,WAAW,SAG5B,GAAI/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,QAAUpQ,EAAMgqB,IAAI,mBAAqBv0B,EAAEc,OAAOkR,SAAU,CAIhG,IAFA,IAAIonB,EAAS7uB,EAAMgqB,IAAI,iBACnB9W,EAAS2b,EAAO3b,OACXtK,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC/B,GAAIsK,EAAOtK,GAAGlR,KAAOrE,EAAKqE,GAAI,CAC1B,IAAI0M,EAAS8O,EAAOtK,GAAGxE,OACnBA,EACAA,EAAOiB,WAAc9O,EAAO8S,QAAW,UAAY,OAEnD6J,EAAOtK,GAAGxE,OAAS,CACfiB,WAAc9O,EAAO8S,QAAW,UAAY,QAGpD,KACJ,CAEJo2N,GAAez/N,EAAO6uB,EAAQ,CAAEze,OAAS/c,EAAK+c,SACzCtc,MAAK,WAAa,IAAE,OACd,SAAUI,GACbrB,GAAOqB,MAAMA,EACjB,GACR,CACJ,GAEA,CAAAoG,IAAA,gCAAAC,MAOA,SAA+B9E,GAC3B,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrBrN,EAASd,EAAEc,OAAOgrO,WAClBvhO,EAAQxM,KAAKu8D,WAAW,SAE5B,GAAI/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,QAAUpQ,EAAMgqB,IAAI,mBAAqBv0B,EAAEc,OAAOkR,SAAU,CAIhG,IAFA,IAAIonB,EAAS7uB,EAAMgqB,IAAI,iBACnB9W,EAAS2b,EAAO3b,OACXtK,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC/B,GAAIsK,EAAOtK,GAAGlR,KAAOrE,EAAKqE,GAAI,CAC1Bwb,EAAOtK,GAAG1C,QAAU3P,EAAOgE,MAC3BhE,EAAOoN,MAAQpN,EAAOgE,MACtB,KACJ,CAEJklO,GAAez/N,EAAO6uB,EAAS,CAAEze,OAAS/c,EAAK+c,SAC1Ctc,MAAK,WAAa,IAAE,OACd,SAAUI,GACbrB,GAAOqB,MAAMA,EACjB,GACR,CACJ,GAEA,CAAAoG,IAAA,gCAAAC,MAOA,SAA+B9E,GAC3B,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrBrN,EAASd,EAAEc,OAAOgrO,WAClBvhO,EAAQxM,KAAKu8D,WAAW,SAG5B,GAAI/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,QAAUpQ,EAAMgqB,IAAI,mBAAqBv0B,EAAEc,OAAOkR,SAAU,CAIhG,IAFA,IAAIonB,EAAS7uB,EAAMgqB,IAAI,iBACnB9W,EAAS2b,EAAO3b,OACXtK,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC/B,GAAIsK,EAAOtK,GAAGlR,KAAOrE,EAAKqE,GAAI,CAC1Bwb,EAAOtK,GAAGxC,QAAU7P,EAAOgE,MAC3BhE,EAAOoN,MAAQpN,EAAOgE,MACtB,KACJ,CAEJklO,GAAez/N,EAAO6uB,EAAS,CAAEze,OAAS/c,EAAK+c,SAC1Ctc,MAAK,WAAa,IAAE,OACd,SAAUI,GACbrB,GAAOqB,MAAMA,EACjB,GACR,CACJ,GAEA,CAAAoG,IAAA,mCAAAC,MAOA,SAAkC9E,GAC9B,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrBrN,EAASd,EAAEc,OAAOgrO,WAClBvhO,EAAQxM,KAAKu8D,WAAW,SAG5B,GAAI/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,QAAUpQ,EAAMgqB,IAAI,mBAAqBv0B,EAAEc,OAAOkR,SAAU,CAIhG,IAFA,IAAIonB,EAAS7uB,EAAMgqB,IAAI,iBACnB9W,EAAS2b,EAAO3b,OACXtK,EAAI,EAAGA,EAAIsK,EAAOte,OAAQgU,IAC/B,GAAIsK,EAAOtK,GAAGlR,KAAOrE,EAAKqE,GAAI,CAC1B,IAAIyM,EAAQ+O,EAAOtK,GAAGzE,MAClBA,IACAA,EAAM5N,EAAOuxD,QAAQpwD,IAAMnB,EAAOgE,OAEtC,KACJ,CAEJklO,GAAez/N,EAAO6uB,EAAS,CAAEze,OAAS/c,EAAK+c,OAAQm/M,cAAe,IACjEz7N,MAAK,WAAa,IAAE,OACd,SAAUI,GACbrB,GAAOqB,MAAMA,EACjB,GACR,CACJ,GAEA,CAAAoG,IAAA,8BAAAC,MAOA,SAA6B9E,GACzB,IAAIpC,EAAOoC,EAAEc,OAAOlD,KAAKuQ,IACrB5D,EAAQxM,KAAKu8D,WAAW,SAE5B,GAAI/vD,EAAMgqB,IAAI,mBAAqB32B,EAAK+c,QAAUpQ,EAAMgqB,IAAI,mBAAqBv0B,EAAEc,OAAOkR,SAAU,CAChG,IAAI+5N,EAAQ/rO,EAAEc,OAAOkrO,cAAcnkM,WAAW5lC,GAC1CA,EAAK8pO,EAAMl3N,UAAUk3N,EAAMv0N,QAAQ,KAAO,EAAGu0N,EAAMv0N,QAAQ,MACvDzZ,KAAKyjB,SAASvf,GACpBmb,UACN,CACJ,GAMA,CAAAvY,IAAA,uBAAAC,MAMA,WACI,GAAgC,QAA5B/G,KAAKynO,mBAAT,CAMAznO,KAAKmpO,yBAGL,IAAI3pO,EAAMQ,KAAKwmO,kBAAoBxmO,KAAKgmO,uBAAuBj/N,MAC/D,GAAKvH,EAAL,CAIAH,GAAOqD,IAAI,SAAUlD,GAGjBA,EAAIwiB,OACJxiB,EAAMA,EAAIwiB,QAGd,IAAIksN,EAAoB1uO,EAAIia,QAAQ,KAChCy0N,EAAoB,EAEpB1uO,GAAO,YAAcQ,KAAKynO,mBAAqB,2BACxCyG,IAAuB1uO,EAAI4B,OAAS,IAE3C5B,GAAO,WAAaQ,KAAKynO,mBAAqB,4BAK9CznO,KAAKJ,QAAQylO,oBAAsBrlO,KAAKJ,QAAQylO,mBAAmBrE,WACnExhO,EAAMqhO,GAAWC,WAAWthO,EAAKQ,KAAKJ,QAAQylO,qBAIlDrlO,KAAK2wK,2BAGL,IAAI5lK,EAAU/K,KACdqvB,GAAAA,GAAGuR,UAAUC,IAAI1hC,KAAK,CAClBK,IAAMA,EACNE,OAAS,MACTI,QAAU,KAEVU,WAAa,SAAUD,GACnBwK,EAAQ+hK,wBACR/hK,EAAQojO,6BAA6B5tO,EACzC,EAEAI,UAAY,SAAUD,GAElBqK,EAAQ+hK,wBACRztK,GAAOqB,MAAM,6DAA8DA,EAC/E,GA1CJ,MAFIrB,GAAOqB,MAAM,sDARjB,MAFIrB,GAAOmU,KAAK,mEAwDpB,GAEA,CAAA1M,IAAA,+BAAAC,MAOA,SAA8BqnO,GAC1B,IAAIp0J,EACAt6D,EAKA4pK,EAJAlpG,EAAmB,CACnBlgF,QAAU,KACViQ,MAAQ,MAiBZ,GAdAnQ,KAAK0mO,yBAA2B,GAGhC1mO,KAAKklO,eAAiBkJ,EAGtBpuO,KAAKipO,qBACLjpO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,kBAAmB,oBACvDrO,KAAKimO,aAAa3+M,UAAUjZ,QAAQ,aAAc,eAClDrO,KAAK4lO,kBAAkBzzN,UAAY,sBACnCnS,KAAK6lO,wBAAwBv+M,UAAUjZ,QAAQ,kBAAmB,oBAClErO,KAAK6lO,wBAAwBv+M,UAAUjZ,QAAQ,aAAc,eAC7DrO,KAAKumO,mBAAoB,EAEO,QAA5BvmO,KAAKynO,mBAA8B,CACnCztJ,EAAS,IAAIsxG,KACb,IAAI+iD,EAAoBruO,KAAKymO,mBAAqBzsJ,EAAO7tC,KAAKiiM,GAG9D,GAFA/uO,GAAOqD,IAAI,8BAA+B2rO,GAEtCA,GAAqBA,EAAkBC,YAAcD,EAAkBC,WAAWhyN,MAAO,CAIzF,IAAIiyN,EAAcF,EAAkBC,WAAWhyN,MAE/C,GAAI9S,MAAM4E,QAAQmgO,GAEd,IAAK,IAAIn5N,EAAI,EAAGA,EAAIm5N,EAAYntO,OAAQgU,IACpCpV,KAAKwuO,+BAA+BD,EAAYn5N,SAIpDpV,KAAKwuO,+BAA+BD,EAE5C,CACJ,MAAO,GAAgC,SAA5BvuO,KAAKynO,mBAA+B,CAC3CztJ,EAAS,IAAIuxG,KACb,IAAIkjD,EAAqBzuO,KAAK2mO,oBAAsB3sJ,EAAO7tC,KAAKiiM,GAGhE,GAFA/uO,GAAOqD,IAAI,8BAA+B+rO,GAEtCA,GAAsBA,EAAmBC,UAAYD,EAAmBC,SAASpyN,QACjFoD,EAAS+uN,EAAmBC,SAASpyN,MAEjC9S,MAAM4E,QAAQsR,IAAS,CAEvB1f,KAAK4mO,0BAA4BlnN,EAEjC,IAAK,IAAIkH,EAAI,EAAGA,EAAIlH,EAAOte,OAAQwlB,IAI/B,IADA0iK,EAAatpL,KAAK2uO,wBAAwBjvN,EAAOkH,GAAI6nN,KACb,iBAAfnlD,EAAyB,CAC9C,KAAIslD,EAAAA,EAAAA,KAAUtlD,MAAeslD,EAAAA,EAAAA,KAAUtlD,EAAW3+K,eAU3C,CAGHtL,GAAOmU,KAAK,kFAAmFkM,EAAOkH,IACtG,QACJ,CAZIw5D,EAAmB,CACflgF,QAAUwf,EAAOkH,GAAGioN,MACpB1+N,MAAQuP,EAAOkH,GAAGkoN,UAAYpvN,EAAOkH,GAAGioN,OAExC7uO,KAAKmmO,6BACLnmO,KAAKikO,4BAA4B7jJ,EAAkBx5D,EAAG5mB,KAAKmmO,4BAQvE,CAER,CAER,CACJ,GAEA,CAAAr/N,IAAA,iCAAAC,MAQA,SAAgCgoO,EAAUC,GACtC,GAAKD,EAAL,CAKA1vO,GAAOqD,IAAI,wEAAyEqsO,GAGpF,IACIzlD,EADA2lD,EAAcjvO,KAAKitO,wBAEnB7sJ,EAAmB,CACnBlgF,QAAU,KACViQ,MAAQ,MAIZ,GAAI6+N,EAAmB,CACnB,IAAIloO,EACAsO,EAGA85N,EAAU,CACV,MACA,SAGJ,IAAK95N,EAAI,EAAGA,EAAI85N,EAAQ9tO,OAAQgU,IAE5B,GADAtO,EAAMooO,EAAQ95N,GACV5L,MAAM4E,QAAQ4gO,EAAkBloO,KAA2C,IAAlCkoO,EAAkBloO,GAAK1F,OAChE,GAAIoI,MAAM4E,QAAQ2gO,EAASjoO,KAAkC,IAAzBioO,EAASjoO,GAAK1F,OAE9C,IAAK,IAAIuoB,EAAI,EAAGA,EAAIqlN,EAAkBloO,GAAK1F,OAAQuoB,KACW,IAAtDolN,EAASjoO,GAAK2S,QAAQu1N,EAAkBloO,GAAK6iB,KAE7ColN,EAASjoO,GAAKlB,KAAKopO,EAAkBloO,GAAK6iB,SAKlDolN,EAASjoO,GAAOkoO,EAAkBloO,GAO9C,IAAIqoO,EAAc,CACd,cACA,2BACA,sBACA,sBACA,cACA,YACA,YACA,WACA,SACA,YACA,aACA,eAEJ,IAAK/5N,EAAI,EAAGA,EAAI+5N,EAAY/tO,OAAQgU,IAE5B45N,EADJloO,EAAMqoO,EAAY/5N,MACa25N,EAASjoO,KACpCioO,EAASjoO,GAAOkoO,EAAkBloO,GAG9C,MAEIioO,EAASK,cAAe,EACxBL,EAAS5kN,WAAanqB,KAAKmmO,4BACtB4I,EAASF,QACVE,EAASF,MAAQ,qBAKzB,GAAIE,EAASzyN,OACT,GAAI9S,MAAM4E,QAAQ2gO,EAASzyN,OAAQ,CAC/B,IAAI6N,EAAc4kN,EAAYA,EAAS5kN,WAAa6kN,EAAkB7kN,WAClE8tC,EAAU82K,EAAYA,EAASF,MAAQG,EAAkBH,MAC7DE,EAAS5kN,WAAanqB,KAAK4jO,mCAAmC3rK,EAAQ9tC,GAAY2sB,UAClF,IAAK,IAAIlwB,EAAI,EAAGA,EAAImoN,EAASzyN,MAAMlb,OAAQwlB,IAAK,CAI5C,IAFA,IAAIyoN,GAAiB,EACjBC,EAAcP,EAAS5kN,WAAWzgB,uBAAuB,+BACpDwY,EAAK,EAAGA,EAAKotN,EAAYluO,OAAQ8gB,IAClCotN,EAAYptN,GAAI/R,QAAU4+N,EAASF,QACnCQ,GAAiB,EACjBN,EAASzyN,MAAMsK,GAAGuD,WAAamlN,EAAYptN,GAAI7L,eAGlDg5N,IACDN,EAASzyN,MAAMsK,GAAGuD,WAAanqB,KAAK8jO,+BAA+BiL,EAASF,MAAOE,EAAS5kN,YAAY2sB,WAE5G92C,KAAKwuO,+BAA+BO,EAASzyN,MAAMsK,GAAImoN,EAC3D,CACJ,MACG,CAEH,IAAIngK,EAAY5uE,KAAK0mO,yBAAyBtlO,OAM9C,GAFAkoL,EAAatpL,KAAKuvO,uBAAuBR,EAAUE,GAM5C,CAEHF,EAASS,YAAclmD,EAEvBlpG,EAAmB,CACflgF,QAAU6uO,EAASF,MACnB1+N,MAAQ4+N,EAASD,UAAYC,EAASF,OAG1C,IAAIY,EAAmBV,EAAS5kN,WACG,OAA/BslN,EAAiBzrK,YACjByrK,EAAmBA,EAAiB34L,WAExC92C,KAAKikO,4BAA4B7jJ,EAAkBxR,EAAW6gK,GAG9DzvO,KAAK0mO,yBAAyB93J,GAAamgK,CAC/C,MAlBI1vO,GAAOmU,KAAK,iFAAkFu7N,EAmBtG,CA5HA,MAFI1vO,GAAOmU,KAAK,mGA+HpB,GAEA,CAAA1M,IAAA,8BAAAC,MAOA,SAA6B9E,GACzB,GAAIA,EAAEc,QAAUd,EAAEc,OAAOmB,GAAI,CACzB,IAMIg7D,EANAwwK,EAAa/nN,SAAS1lB,EAAEc,OAAOmB,GAAG85C,OAAO,IAAK,IAElD,GAAItN,MAAMg/L,GACN,OAK4B,QAA5B1vO,KAAKynO,oBAELvoK,EAAYl/D,KAAK0mO,yBAAyBgJ,GAE1C1vO,KAAK2vO,mBAAmBzwK,IACW,SAA5Bl/D,KAAKynO,qBAEZvoK,EAAYl/D,KAAK4mO,0BAA0B8I,GAE3C1vO,KAAK4vO,oBAAoB1wK,GAEjC,CACJ,GAMA,CAAAp4D,IAAA,qBAAAC,MAOA,SAAoBm4D,GAChB,IAAIj5D,EAAMjG,KAAKiH,SACf,GAAKhB,EAIL,GAAKi5D,EAAL,CAMA,IAAI+vK,EAAcjvO,KAAKitO,wBAEnB4C,EAAmB,CAAC,EAGpBC,EAAY9vO,KAAK+vO,wBAErB,GAAID,EACAD,EAAiBrwO,IAAMswO,MACpB,CAEH,IAAI5B,EAAoBluO,KAAKwmO,kBAAkB/sN,QAAQ,KAEnDo2N,EAAiBrwO,KADM,IAAvB0uO,EACuBluO,KAAKwmO,kBAAkB1vN,UAAU,EAAGo3N,GAEpCluO,KAAKwmO,iBAEpC,CAGA,GADAqJ,EAAiB7hO,OAAS,CAAC,EACvBkxD,EAAUnuC,KAAd,CACI8+M,EAAiB7hO,OAAe,OAAIkxD,EAAUnuC,KAKlD8+M,EAAiB7hO,OAAgB,QAAI,MACjChO,KAAKymO,mBAAmBt4K,UACxB0hL,EAAiB7hO,OAAgB,QAAIhO,KAAKymO,mBAAmBt4K,SAMjE,IAAIm7H,EAAapqH,EAAUswK,YAC3B,GAAKlmD,EAAL,CAUA,IAAIt6K,EACJ,GARWs6K,IAAe2lD,IAGtBY,EAAiBvmD,WAAaA,GAK9BpqH,EAAUjvD,OAASzG,MAAM4E,QAAQ8wD,EAAUjvD,OAAQ,CACnD,IAAIhR,EAAQigE,EAAUjvD,MAAM,GAC5B4/N,EAAiB7hO,OAAe,OAAI/O,EAAM8xB,KACtC9xB,EAAM+wO,WAAaxmO,MAAM4E,QAAQnP,EAAM+wO,YAAyC,IAA3B/wO,EAAM+wO,UAAU5uO,SACrE4N,EAAS/P,EAAM+wO,UAAU,GAAGC,eAEpC,CAGA,IAAIC,EAAY,IAAIlzK,IAAJ,CAAkB6yK,GAElC7vO,KAAKmwO,iCAAiCjxK,EAAWlwD,EAAQkhO,GAEzD,IAAIE,EAAmB,CAAC,EACxBA,EAAyB,OAAIF,EAE7BlwO,KAAKqwO,6BAA6BnxK,EAAW+vK,EAAamB,GAE1DpwO,KAAKswO,mBAAmBpxK,EAAW+vK,EAAamB,GAGhD,IAAIG,EAAW,IAAIC,IAAJ,CAAcJ,GAkB7B,GAjBAG,EAASxnB,UAAUqnB,EAAiB50M,QAEpC+0M,EAAS9yK,gBAAkB,kBAEvByB,EAAUuxK,YACVF,EAASG,YAAc,CACnBD,WAAY,GAGZzwO,KAAKymO,oBAAsBzmO,KAAKymO,mBAAmB6H,YAActuO,KAAKymO,mBAAmB6H,WAAW7oM,SAAWzlC,KAAKymO,mBAAmB6H,WAAW7oM,QAAQkrM,gBAAkB3wO,KAAKymO,mBAAmB6H,WAAW7oM,QAAQkrM,eAAeC,QAAUpnO,MAAM4E,QAAQpO,KAAKymO,mBAAmB6H,WAAW7oM,QAAQkrM,eAAeC,UACxTL,EAASG,YAAYrnD,QAAUrpL,KAAKymO,mBAAmB6H,WAAW7oM,QAAQkrM,eAAeC,SAIjG3qO,EAAI4wD,SAAS05K,GAGTtqO,EAAImmB,WAAanmB,EAAIm4D,WAAamyK,EAASjyK,UAAW,CACtD,IAAID,EAAekyK,EAASjyK,YACxBD,GAAgBA,EAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,EAAcp4D,EAAIm4D,UAE5C,CAiBAp+D,KAAKi9C,cAAc,CACf/wC,KAAO,4BACP7D,KAAO62D,EAAUnuC,KACjBlxB,KAAOq/D,EACP1yD,MAAQ+jO,EACR5wO,OAAS,OAtEb,MANIN,GAAOmU,KAAK,iFAXhB,MAFInU,GAAOmU,KAAK,sGAAuG0rD,EA1BvH,MAFI7/D,GAAOmU,KAAK,qFAJZnU,GAAOmU,KAAK,yEA2HpB,GAEA,CAAA1M,IAAA,wBAAAC,MAOA,WACI,IAAI8pO,EACJ,GAAI7wO,KAAKymO,oBAAsBzmO,KAAKymO,mBAAmB6H,YAActuO,KAAKymO,mBAAmB6H,WAAW7oM,SAAWzlC,KAAKymO,mBAAmB6H,WAAW7oM,QAAQqrM,OAAQ,CAClK,IAAIC,EAAS/wO,KAAKymO,mBAAmB6H,WAAW7oM,QAAQqrM,OACxD,GAAIC,EAAOC,SAAWxnO,MAAM4E,QAAQ2iO,EAAOC,UAAsC,IAA1BD,EAAOC,QAAQ5vO,OAAc,CAChF,IAAI5B,EAAMuxO,EAAOC,QAAQ,GACrBxxO,GAAOA,EAAIyxO,MAAQzxO,EAAIyxO,KAAKC,MAC5BL,EAAYrxO,EAAIyxO,KAAKC,IAAIjB,eAEjC,CACJ,CACA,OAAOY,CACX,GAEA,CAAA/pO,IAAA,yBAAAC,MAUA,SAAwBm4D,EAAW+vK,GAC/B,IAAI3lD,EAEJ,GAAKpqH,GAAkC,WAArB9kD,GAAO8kD,GAAzB,CAQA,IAAIiyK,EAAUjyK,EAAUkyK,IACxB,GAAI5nO,MAAM4E,QAAQ+iO,GAAU,CAGxB,GAAIA,EAAQrpO,SAASmnO,GAEjB,OADA3lD,EAAa2lD,EAGjB,IAAIoC,EAAUj8N,EAGd,IAAKA,EAAI,EAAGA,EAAI+7N,EAAQ/vO,OAAQgU,IAE5B,IADAi8N,EAAWF,EAAQ/7N,KACiB,iBAAbi8N,KACfzC,EAAAA,EAAAA,KAAUyC,KAAazC,EAAAA,EAAAA,KAAUyC,EAAS1mO,gBAG1C,OAFA2+K,EAAa+nD,CAM7B,CAGA,OAAO/nD,CA7BP,CAFIjqL,GAAOmU,KAAK,mDAgCpB,GAEA,CAAA1M,IAAA,+BAAAC,MASA,SAA8Bm4D,EAAW+vK,EAAamB,GAElD,IAAIkB,GAAW1C,EAAAA,EAAAA,KAAUK,GAAa3mB,WACtC,GAAiB,MAAbgpB,EAEIpyK,EAAUqyK,sBACVnB,EAAiBoB,cAAgD,MAAhCtyK,EAAUqyK,qBAE3CryK,EAAUuyK,sBACVrB,EAAiB10K,cAAgD,MAAhCwD,EAAUuyK,0BAE5C,GAAiB,YAAbH,EAAwB,CAE/B,IAAII,EAAO,MAAU,KAAiB,QAAVn6M,KAAK3F,IAC7BstC,EAAUqyK,sBACVnB,EAAiBoB,cAAgBtyK,EAAUqyK,oBAAsBG,GAEjExyK,EAAUuyK,sBACVrB,EAAiB10K,cAAgBwD,EAAUuyK,oBAAsBC,EAEzE,CACJ,GAEA,CAAA5qO,IAAA,qBAAAC,MASA,SAAoBm4D,EAAW+vK,EAAamB,GACxC,GAAKlxK,EAAL,CAOA,IAAIyyK,EAA0BzyK,EAAoC,yBAG9D0yK,EAAc1yK,EAAU2yK,YAE5B,GAAIF,GAA2BnoO,MAAM4E,QAAQujO,GAGrCvB,EAAiB50M,OAFD,cAAhByzM,EAE0B0C,GAEAzzK,EAAAA,EAAAA,iBAAsByzK,EAAyB,YAAa1C,QAIvF,GAAI2C,GAAepoO,MAAM4E,QAAQwjO,GAGpC,IAFA,IAAIttO,EACAk3B,EACKpmB,EAAI,EAAGA,EAAIw8N,EAAYxwO,OAAQgU,IAGpC,GAFA9Q,EAAMstO,EAAYx8N,GAAG9Q,IACrBk3B,EAASo2M,EAAYx8N,GAAGomB,OACpBl3B,EAAK,CACL,GAAIA,IAAQ2qO,EAAa,CAErBmB,EAAiB50M,OAASA,EAC1B,KACJ,CACI,GAAmB,iBAARl3B,EAAkB,CACzB,IAAIwtO,GAASlD,EAAAA,EAAAA,KAAUtqO,IAAOsqO,EAAAA,EAAAA,KAAUtqO,IAAOsqO,EAAAA,EAAAA,KAAUtqO,EAAIqG,eAE7D,GAAImnO,EAAQ,CAGR,GAA0B,YAAtBA,EAAOxpB,YAAkE,IAAtChkN,EAAIqG,cAAc8O,QAAQ,QAAe,CAE5E,IAAIs4N,EAAiB,CAACv2M,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,IAC9D40M,EAAiB50M,QAAS0iC,EAAAA,EAAAA,iBAAsB6zK,EAAgBD,EAAQ7C,EAC5E,MAEImB,EAAiB50M,QAAS0iC,EAAAA,EAAAA,iBAAsB1iC,EAAQs2M,EAAQ7C,GAEpE,KACJ,CACJ,CAER,CAhDR,MAFI5vO,GAAOmU,KAAK,+EAqDpB,GAEA,CAAA1M,IAAA,mCAAAC,MASA,SAAkCm4D,EAAWlwD,EAAQkhO,GAgBjD,GAdIhxK,EAAU2vK,OACVqB,EAAUj4K,OAASiH,EAAU2vK,MAC7BqB,EAAUh4K,aAAegH,EAAU4vK,SAAW5vK,EAAU4vK,SAAW5vK,EAAU2vK,QAE7EqB,EAAUj4K,OAASiH,EAAUnuC,KAC7Bm/M,EAAUh4K,aAAegH,EAAU4vK,SAAW5vK,EAAU4vK,SAAW5vK,EAAUnuC,MAG7E/hB,IACAkhO,EAAU/3K,SAAW,CAAC,CAClB34D,IAAMwP,KAIVkwD,EAAU8yK,aAAexoO,MAAM4E,QAAQ8wD,EAAU8yK,aAAc,CAC/D9B,EAAU5uN,UAAY,GACtB,IAAK,IAAIlM,EAAI,EAAGA,EAAI8pD,EAAU8yK,YAAY5wO,OAAQgU,IAAK,CACnD,IAAI+M,EAAW+8C,EAAU8yK,YAAY58N,GAAG66N,eACpC9tN,GACA+tN,EAAU5uN,UAAU1b,KAAK,CACrBpG,IAAM2iB,GAGlB,CACJ,CAEA,GAAI+8C,EAAU+yK,YAAa,CACvB,IAAInlD,EAAc5tH,EAAU+yK,YAC5B/B,EAAUpF,aAAe,CAAC,EACtBh+C,EAAYmjD,iBACZC,EAAUpF,aAAatrO,IAAMstL,EAAYmjD,gBAEzCnjD,EAAY+hD,QACZqB,EAAUpF,aAAaziO,KAAO6nO,EAAUpF,aAAah+C,YAAcA,EAAY+hD,OAE/E/hD,EAAYolD,SAAWplD,EAAYolD,QAAQjC,iBAC3CC,EAAUpF,aAAaqH,KAAOrlD,EAAYolD,QAAQjC,eAE1D,CACJ,GAMA,CAAAnpO,IAAA,sBAAAC,MAOA,SAAqBm4D,GACjB,GAAKA,GAAcA,EAAUkzK,WAA7B,CAKA,IAAInsO,EAAMjG,KAAKiH,SACf,GAAKhB,EAAL,CAIA,IAAIosO,EAAoB,CAAC,EACzBA,EAAkB7lO,MAAQ0yD,EAAUkzK,WAEhCpyO,KAAK2mO,oBAAoBx4K,UACzBkkL,EAAkBlkL,QAAUnuD,KAAK2mO,oBAAoBx4K,SAGzD,IAAI2hL,EAAY9vO,KAAKsyO,0BAErB,GAAIxC,EACAuC,EAAkB7yO,IAAMswO,MACrB,CAEH,IAAI5B,EAAoBluO,KAAKwmO,kBAAkB/sN,QAAQ,KAEnD44N,EAAkB7yO,KADK,IAAvB0uO,EACwBluO,KAAKwmO,kBAAkB1vN,UAAU,EAAGo3N,GAEpCluO,KAAKwmO,iBAErC,CAGA,IAUI7rM,EACA3rB,EAuBArP,EAlCA4yO,EAAavyO,KAAKwyO,cAActzK,GAYpC,GAXAmzK,EAAkBI,UAAYF,EAAW1lD,IACzCwlD,EAAkB/oD,WAAaipD,EAAWrG,SAC1CmG,EAAkBvpB,SAAW,IAAI4pB,IAAJ,CAAiB,CAC1ChjB,YAAc6iB,EAAW7iB,YACzB3lC,UAAYwoD,EAAWxoD,UACvB3I,OAASmxD,EAAWnxD,SAMpBliH,EAAUjvD,OAASzG,MAAM4E,QAAQ8wD,EAAUjvD,OAE3C,IADA,IAAIhR,EACKywC,EAAI,EAAGA,EAAIwvB,EAAUjvD,MAAM7O,SAGhCu5B,GAFA17B,EAAQigE,EAAUjvD,MAAMy/B,IAEH0iM,YACjBnzO,EAAM0zO,WAJ8BjjM,IASpCzwC,EAAM+wO,WAAaxmO,MAAM4E,QAAQnP,EAAM+wO,YAAyC,IAA3B/wO,EAAM+wO,UAAU5uO,SACrE4N,EAAS/P,EAAM+wO,UAAU,GAAGvpL,MAIpB,MAAhB9rB,GACAt7B,GAAOmU,KAAK,8FAAgG0rD,EAAUkzK,YAE1HC,EAAkBpzO,MAAQ07B,EAItBukC,EAAU0xK,QAAUpnO,MAAM4E,QAAQ8wD,EAAU0xK,UAC5CjxO,EAASu/D,EAAU0xK,OAAO,IAEhB,MAAVjxO,GACAN,GAAOmU,KAAK,+FAAiG0rD,EAAUkzK,YAE3HC,EAAkB1yO,OAASA,EAG3B,IAAIizO,EAAa,IAAI31K,IAAJ,CAAeo1K,GAG5BnzK,EAAU2vK,OACV+D,EAAW36K,OAASiH,EAAU2vK,MAC9B+D,EAAW16K,aAAegH,EAAU4vK,SAAW5vK,EAAU4vK,SAAW5vK,EAAU2vK,QAE9E+D,EAAW36K,OAASiH,EAAUkzK,WAC9BQ,EAAW16K,aAAegH,EAAU4vK,SAAW5vK,EAAU4vK,SAAW5vK,EAAUkzK,YAG9EpjO,IACA4jO,EAAWz6K,SAAW,CAAC,CACnB34D,IAAMwP,KAId,IAII6jO,EAJAzC,EAAmB,CAAC,EACxBA,EAAiBxzN,OAASg2N,EAE1BxC,EAAiB50M,OAASx7B,KAAK8yO,oBAAoB5zK,GAEnD,KACI2zK,EAAY,IAAIrC,IAAJ,CAAcJ,IAChBrnB,UAAUqnB,EAAiB50M,OACzC,CAAE,MAAOv5B,GAEL,YADA5C,GAAOmU,KAAK,4HAA6HvR,EAE7I,CAOA,GALA4wO,EAAUp1K,gBAAkB,mBAE5Bx3D,EAAI4wD,SAASg8K,GAGT5sO,EAAImmB,WAAanmB,EAAIm4D,WAAay0K,EAAUv0K,UAAW,CACvD,IAAID,EAAew0K,EAAUv0K,YACzBD,GAAgBA,EAAa,KAAO/kB,KACpCrzC,EAAImmB,UAAU+xC,IAAIE,EAAcp4D,EAAIm4D,UAE5C,CAiBAp+D,KAAKi9C,cAAc,CACf/wC,KAAO,4BACP7D,KAAO62D,EAAUkzK,WACjBvyO,KAAOq/D,EACP1yD,MAAQqmO,EACRlzO,OAAS,QAlIb,CALA,MAFIN,GAAOmU,KAAK,8FA2IpB,GAEA,CAAA1M,IAAA,0BAAAC,MAOA,WACI,IAAIgsO,EACJ,GAAI/yO,KAAK2mO,qBAAuB3mO,KAAK2mO,oBAAoBqM,oBAAsBhzO,KAAK2mO,oBAAoBqM,mBAAmBC,QAAS,CAChI,IAAIC,EAAUlzO,KAAK2mO,oBAAoBqM,mBAAmBC,QACtDC,EAAQC,KAAOD,EAAQC,IAAIlC,MAAQiC,EAAQC,IAAIlC,KAAKC,KAAO1nO,MAAM4E,QAAQ8kO,EAAQC,IAAIlC,KAAKC,MAAwC,IAAhCgC,EAAQC,IAAIlC,KAAKC,IAAI9vO,SACvH2xO,EAAaG,EAAQC,IAAIlC,KAAKC,IAAI,GAAGzqL,KAE7C,CACA,OAAOssL,CACX,GAEA,CAAAjsO,IAAA,0BAAAC,MASA,SAAyBm4D,EAAWuvK,GAChC,IAAInlD,EAEJ,GAAKpqH,GAAkC,WAArB9kD,GAAO8kD,GAAzB,CAKA,GAAKuvK,GAAoD,WAA9Br0N,GAAOq0N,GAAlC,CAKA,GAAIvvK,EAAUk0K,mBAAqB5pO,MAAM4E,QAAQ8wD,EAAUk0K,mBAAoB,CAC3E,IACI9uO,EADAuoL,EAAM3tH,EAAUk0K,kBAAkB,GAAGC,cAEzC,GAAI5E,EAAmBC,UAAYllO,MAAM4E,QAAQqgO,EAAmBC,SAAS2E,eAEzE,IADA,IAAI/yK,EAAiBmuK,EAAmBC,SAAS2E,cACxCj+N,EAAI,EAAGA,EAAIkrD,EAAel/D,OAAQgU,IACvC,GAAIkrD,EAAelrD,GAAGg9N,aAAevlD,GAAOvsH,EAAelrD,GAAGk+N,WAAY,EAGtEhvO,EADoBg8D,EAAelrD,GACfm+N,eACM,iBAARjvO,KACVsqO,EAAAA,EAAAA,KAAUtqO,KAAQsqO,EAAAA,EAAAA,KAAUtqO,EAAIqG,kBAChC2+K,EAAahlL,GAGrB,KACJ,CAGZ,CAEA,OAAOglL,CAvBP,CAFIjqL,GAAOmU,KAAK,mCAHhB,MAFInU,GAAOmU,KAAK,mDA+BpB,GAEA,CAAA1M,IAAA,gBAAAC,MAQA,SAAem4D,GACX,IAKI2tH,EACAq/C,EACA5iD,EAPAipD,EAAa,CAAC,EAEdxoD,EAAY,GACZ2lC,EAAc,GACdtuC,EAAS,GAQb,GADUphL,KAAKiH,UAMXi4D,EAAUk0K,mBAAqB5pO,MAAM4E,QAAQ8wD,EAAUk0K,mBAA3D,CAGI,GAFAvmD,EAAM3tH,EAAUk0K,kBAAkB,GAAGC,cAEjCrzO,KAAK2mO,oBAAoB+H,UAAYllO,MAAM4E,QAAQpO,KAAK2mO,oBAAoB+H,SAAS2E,gBAErF,IADA,IAAI/yK,EAAiBtgE,KAAK2mO,oBAAoB+H,SAAS2E,cAC9Cj+N,EAAI,EAAGA,EAAIkrD,EAAel/D,OAAQgU,IACvC,GAAIkrD,EAAelrD,GAAGg9N,aAAevlD,GAAOvsH,EAAelrD,GAAGk+N,WAAY,CAEtE,IAEIE,EACAtvO,EACAuvO,EACA74M,EACAqxJ,EANAynD,EAAgBpzK,EAAelrD,GAgBnC,GARIs+N,EAAcH,eACdrH,EAAWwH,EAAcH,aACzBjqD,GAAaslD,EAAAA,EAAAA,KAAU1C,IAEvB5iD,GAAcA,EAAWg/B,WACzBr8B,EAAQ3C,EAAWg/B,YAGnB9+M,MAAM4E,QAAQslO,EAAcJ,YAC5B,IAAK,IAAI1sN,EAAI,EAAGA,EAAI8sN,EAAcJ,WAAWlyO,OAAQwlB,IAGpB,OAD7B4sN,EAAaE,EAAcJ,WAAW1sN,IACvBwrN,aACXluO,EAAKyjB,SAAS6rN,EAAWpB,WAAY,IACrCroD,EAAUnkL,KAAK1B,IAInBuvO,EAAmBD,EAAWG,iBAI1B/4M,EAFU,YAAVqxJ,EAEgC,MAAnBwnD,EAA6B,KAAiB,QAAVl8M,KAAK3F,IAGtB,MAAnB6hN,EAEjB/jB,EAAY9pN,KAAKg1B,GAEjBwmJ,EAASoyD,EAAWI,mBAKHzzN,IAArBuvM,EAAYp1M,MACZo1M,EAAYp1M,MACR,SAAUhV,EAAGC,GACT,OAAOA,EAAID,CACf,SAIe6a,IAAnB4pK,EAAUzvK,MACVyvK,EAAUzvK,MACN,SAAUhV,EAAGC,GACT,OAAOD,EAAIC,CACf,GAGZ,OAGJlG,GAAOmU,KAAK,+FAAiG0rD,EAAUkzK,YAY/H,OANAG,EAAW1lD,IAAMA,EACjB0lD,EAAWrG,SAAWA,EACtBqG,EAAWxoD,UAAYA,EACvBwoD,EAAW7iB,YAAcA,EACzB6iB,EAAWnxD,OAASA,EAEbmxD,CARP,CASJ,GAEA,CAAAzrO,IAAA,sBAAAC,MAQA,SAAqBm4D,GACjB,IAAI1jC,EACAyzM,EAAcjvO,KAAKitO,wBAOvB,OAJI/tK,EAAU20K,kBAAoBrqO,MAAM4E,QAAQ8wD,EAAU20K,oBACtDr4M,GAAS0iC,EAAAA,EAAAA,iBAAsBgB,EAAU20K,iBAAkB,YAAa5E,IAGrEzzM,CACX,GAMA,CAAA10B,IAAA,wBAAAC,MAMA,WACI,IAAId,EAAMjG,KAAKiH,SACf,GAAKhB,GAAQA,EAAImmB,SAAYnmB,EAAImmB,UAAUC,cAK3C,OADkBpmB,EAAImmB,UAAUC,gBAAgBC,UAH5CjtB,GAAOmU,KAAK,kCAKpB,GAMA,CAAA1M,IAAA,2BAAAC,MAKA,WACI/G,KAAK4uF,kBAAkBlmF,UAAY,gFACnC1I,KAAK6yF,UAAW,EAIZ7yF,KAAKiuK,SACLnrK,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,MAElB,IAAIljK,EAAU/K,KACdA,KAAKiuK,OAAS3rK,YAAW,YACI,IAArByI,EAAQ8nF,SACR9nF,EAAQ+hK,wBAEJ/hK,EAAQkjK,QACRnrK,aAAaiI,EAAQkjK,OAGjC,GAAG,KACP,GAEA,CAAAnnK,IAAA,wBAAAC,MAKA,WACQ/G,KAAK6yF,WACL7yF,KAAK4uF,kBAAkBlmF,UAAY,8EACnC1I,KAAK6yF,UAAW,EAChB/vF,aAAa9C,KAAKiuK,QAClBjuK,KAAKiuK,OAAS,KAEtB,GAAC,CAAAnnK,IAAA,wBAAAC,MAED,WACI/G,KAAKqlL,eAAe/9J,UAAUjZ,QAAQ,kBAAmB,oBACzDrO,KAAKqlL,eAAe/9J,UAAUjZ,QAAQ,aAAc,eACpDrO,KAAK4lO,kBAAkBzzN,UAAY,mBAGvC,GAAC,CAAArL,IAAA,qBAAAC,MACD,WACI/G,KAAKqlL,eAAe/9J,UAAUjZ,QAAQ,mBAAoB,mBAC1DrO,KAAKqlL,eAAe/9J,UAAUjZ,QAAQ,cAAe,aAGzD,GACA,CAAAvH,IAAA,yBAAAC,MAKA,WAOI,GANA/G,KAAKumO,mBAAoB,EACzBvmO,KAAKwmO,kBAAoB,KACzBxmO,KAAKymO,mBAAqB,KAC1BzmO,KAAK2mO,oBAAsB,KAC3B3mO,KAAK0mO,yBAA2B,KAChC1mO,KAAK4mO,0BAA4B,KAC7B5mO,KAAKmmO,4BACL,KAAOnmO,KAAKmmO,4BAA4Bj3M,YACpClvB,KAAKmmO,4BAA4Bh3M,YAAYnvB,KAAKmmO,4BAA4Bj3M,WAG1F,GAEA,CAAApoB,IAAA,yBAAAC,MAKA,WAEI,GADA/G,KAAK6mO,mBAAoB,EACrB7mO,KAAKqmO,4BACL,KAAOrmO,KAAKqmO,4BAA4Bn3M,YACpClvB,KAAKqmO,4BAA4Bl3M,YAAYnvB,KAAKqmO,4BAA4Bn3M,WAG1F,GAEA,CAAApoB,IAAA,qBAAAC,MAMA,SAAoB7C,GAEhB,GADAlE,KAAK6mO,mBAAoB,EACrB7mO,KAAKqmO,4BAEL,IADA,IAAIjwN,EAAQpW,KAAKqmO,4BAA4B/vN,WACpCrN,EAAQ,EAAGA,EAAQmN,EAAMhV,OAAQ6H,IAAS,CAC/C,IAAMzC,EAAU4P,EAAMnN,GAClBzC,EAAQtC,KAAO,8BAAgCA,GAC/CsC,EAAQiW,QAEhB,CAER,I,8FAAC,CAzhGU,CAA6BpV,EAAAA,G,GAAOo9N,G,GAAA,gB,GA4CxB,CACnB1vN,MAAQ,IAAI7V,EAAAA,KAAK,CACb+W,IAAM+V,GAAAA,EAAqB,YAC3BzP,OAAS,CAAC,KAAM,IAChBohF,aAAe,WACfC,aAAe,SACfC,aAAe,WAEnB9lF,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,oBACRF,MAAQ,IAEZoE,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,2BAEZnW,KAAO,IAAIkvE,EAAAA,KAAK,CACZl6C,KAAO,YACPE,UAAY,OACZ7a,KAAO,IAAI2gE,EAAAA,KAAK,CACZ7kE,MAAQ,2BAEZD,OAAS,IAAI6kE,EAAAA,OAAO,CAChB5kE,MAAQ,mBACRF,MAAQ,Q,4GAGnB2sN,IAw9FLvjO,OAAOwX,OAAO8rN,GAAYr/N,UAAW+7N,IACrChgO,OAAOwX,OAAO8rN,GAAYr/N,UAAWk6D,EAAAA,GAErC,YAGI99D,OAAOvC,IAAMuC,OAAOvC,GAAG0wB,UACvBnuB,OAAOvC,GAAG0wB,QAAQ80M,YAAcA,G","sources":["webpack://geopf-extensions-openlayers/external assign \"ol.style.Icon\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Protocols/XHR.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/ProcessIsoCurve/Request/model/ProcessIsoCurveParam.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Control.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/CommonService.js","webpack://geopf-extensions-openlayers/external assign \"ol.layer.Vector\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Utils/MessagesResources.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Response/model/GeocodeResponse.js","webpack://geopf-extensions-openlayers/external assign \"ol.Observable\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/ProcessIsoCurve/Response/model/ProcessIsoCurveResponse.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Event.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Style.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Themes.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Filter.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Legend.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Layer.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Group.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Search.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/EditorDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Editor.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Geocode.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Alti.js","webpack://geopf-extensions-openlayers/external assign \"ol.style.Circle\"","webpack://geopf-extensions-openlayers/./src/packages/Utils/Helper.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Utils/LoggerByDefault.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LocationSelector/LocationSelectorDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LocationSelector/LocationSelector.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/grammar.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Request/model/RouteParamREST.js","webpack://geopf-extensions-openlayers/external assign \"ol.geom.Polygon\"","webpack://geopf-extensions-openlayers/external assign \"ol.geom.MultiPolygon\"","webpack://geopf-extensions-openlayers/./src/packages/Formats/Styling.js","webpack://geopf-extensions-openlayers/external assign \"ol.extent\"","webpack://geopf-extensions-openlayers/./src/packages/Controls/Utils/CheckDsfr.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/errors.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Gp.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Response/model/RouteResponse.js","webpack://geopf-extensions-openlayers/external assign \"ol.style\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Response/model/Elevation.js","webpack://geopf-extensions-openlayers/./node_modules/loglevel/lib/loglevel.js","webpack://geopf-extensions-openlayers/./node_modules/node-fetch/browser.js","webpack://geopf-extensions-openlayers/./node_modules/eventbusjs/lib/eventbus.min.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Services.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/GeocodeUtils.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Widget.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/model/AltiProfilRequest.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Utils/Helper.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Protocols/JSONP.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Response/model/AltiResponse.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Utils/Interactions.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Formats/AltiResponseReader.js","webpack://geopf-extensions-openlayers/external assign \"ol.source.Vector\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Response/RouteResponseFactory.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Request/model/GeocodeParamREST.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/ColorUtils.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Request/GeocodeRequestREST.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/MathUtils.js","webpack://geopf-extensions-openlayers/external assign \"ol.source.ImageWMS\"","webpack://geopf-extensions-openlayers/./src/packages/Utils/Config.js","webpack://geopf-extensions-openlayers/./node_modules/sortablejs/modular/sortable.esm.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LayerSwitcher/LayerSwitcherDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LayerSwitcher/LayerSwitcher.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Config/Config.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/AltiRequestWPS.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/sax.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/conventions.js","webpack://geopf-extensions-openlayers/external assign \"ol.source.TileWMS\"","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/dom.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Formats/WPS.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/AutoComplete/Response/AutoCompleteResponseFactory.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Formats/XML.js","webpack://geopf-extensions-openlayers/external assign \"ol.geom\"","webpack://geopf-extensions-openlayers/external assign \"ol.sphere\"","webpack://geopf-extensions-openlayers/./src/packages/Controls/ToolBoxMeasure/MeasureToolBoxDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/ToolBoxMeasure/MeasureToolBox.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Measures/Measures.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/ElevationPath/ElevationPathDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/ElevationPath/ProfileElevationPathDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/ElevationPath/ElevationPath.js","webpack://geopf-extensions-openlayers/external assign \"ol.interaction\"","webpack://geopf-extensions-openlayers/external assign \"ol.layer.VectorTile\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Response/AltiResponseFactory.js","webpack://geopf-extensions-openlayers/external assign \"ol.Overlay\"","webpack://geopf-extensions-openlayers/external assign \"ol.style.Style\"","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/dom-parser.js","webpack://geopf-extensions-openlayers/external assign \"ol.format.KML\"","webpack://geopf-extensions-openlayers/./src/packages/Formats/KML.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/LoggerByDefault.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Request/RouteRequestREST.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/AutoComplete/Response/model/AutoCompleteResponse.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/model/AltiElevationRequest.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Response/model/GeocodedLocation.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/ReverseGeocode.js","webpack://geopf-extensions-openlayers/external assign \"ol.source.WMTS\"","webpack://geopf-extensions-openlayers/./src/packages/Utils/Draggable.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/model/AltiRequest.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Protocols/Protocol.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/entities.js","webpack://geopf-extensions-openlayers/external assign \"ol.events.condition\"","webpack://geopf-extensions-openlayers/./src/packages/Controls/Route/RouteDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Route/Route.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/SelectorID.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Request/RouteRequestFactory.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Request/GeocodeRequestFactory.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/AltiRequestREST.js","webpack://geopf-extensions-openlayers/./node_modules/es6-promise/dist/es6-promise.js","webpack://geopf-extensions-openlayers/external assign \"ol.style.Fill\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/ProcessIsoCurve/ProcessIsoCurve.js","webpack://geopf-extensions-openlayers/external assign \"ol.style.Stroke\"","webpack://geopf-extensions-openlayers/external assign \"ol.format.GPX\"","webpack://geopf-extensions-openlayers/external assign \"ol.geom.MultiLineString\"","webpack://geopf-extensions-openlayers/external assign \"ol.geom.LineString\"","webpack://geopf-extensions-openlayers/./src/packages/Formats/GPX.js","webpack://geopf-extensions-openlayers/external assign \"ol.format.GeoJSON\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Route.js","webpack://geopf-extensions-openlayers/external assign \"ol.control.Control\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Route/Response/model/RouteInstruction.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/DefaultUrlService.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Exceptions/ErrorService.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/ProcessIsoCurve/Response/ProcessIsoCurveResponseFactory.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Export/ExportDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Export/Export.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Request/AltiRequestFactory.js","webpack://geopf-extensions-openlayers/./node_modules/@xmldom/xmldom/lib/index.js","webpack://geopf-extensions-openlayers/external assign \"ol.proj\"","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Alti/Response/model/Measure.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/PanelManager.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Isocurve/IsocurveDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Isocurve/Isocurve.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/Parser.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/AutoComplete/AutoComplete.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Response/GeocodeResponseFactory.js","webpack://geopf-extensions-openlayers/external assign \"ol.style.Text\"","webpack://geopf-extensions-openlayers/./src/packages/Formats/GeoJSON.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/ProcessIsoCurve/Request/ProcessIsoCurveRequest.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Geocode/Formats/GeocodeResponseParser.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/AutoComplete/Response/model/SuggestedLocation.js","webpack://geopf-extensions-openlayers/./node_modules/geoportal-access-lib/src/Services/Config/ConfigInterface.js","webpack://geopf-extensions-openlayers/external assign \"ol.Feature\"","webpack://geopf-extensions-openlayers/./src/packages/Controls/Utils/Markers.js","webpack://geopf-extensions-openlayers/webpack/bootstrap","webpack://geopf-extensions-openlayers/webpack/runtime/compat get default export","webpack://geopf-extensions-openlayers/webpack/runtime/define property getters","webpack://geopf-extensions-openlayers/webpack/runtime/global","webpack://geopf-extensions-openlayers/webpack/runtime/hasOwnProperty shorthand","webpack://geopf-extensions-openlayers/external assign \"ol.Collection\"","webpack://geopf-extensions-openlayers/external assign \"ol.tilegrid.WMTS\"","webpack://geopf-extensions-openlayers/external assign \"ol.format.MVT\"","webpack://geopf-extensions-openlayers/external assign \"ol.format.WMSCapabilities\"","webpack://geopf-extensions-openlayers/external assign \"ol.format.WMTSCapabilities\"","webpack://geopf-extensions-openlayers/external assign \"ol.layer.Tile\"","webpack://geopf-extensions-openlayers/external assign \"ol.source.VectorTile\"","webpack://geopf-extensions-openlayers/external assign \"ol.source.TileJSON\"","webpack://geopf-extensions-openlayers/./node_modules/@maplibre/maplibre-gl-style-spec/dist/index.mjs","webpack://geopf-extensions-openlayers/./node_modules/mapbox-to-css-font/index.js","webpack://geopf-extensions-openlayers/external assign \"ol.functions\"","webpack://geopf-extensions-openlayers/./node_modules/ol/array.js","webpack://geopf-extensions-openlayers/./node_modules/ol/extent.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/contains.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/interiorpoint.js","webpack://geopf-extensions-openlayers/./node_modules/ol/math.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/interpolate.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/orient.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/simplify.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/Units.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/Projection.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/epsg3857.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/epsg4326.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/projections.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/transforms.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj/utm.js","webpack://geopf-extensions-openlayers/./node_modules/ol/proj.js","webpack://geopf-extensions-openlayers/./node_modules/ol/transform.js","webpack://geopf-extensions-openlayers/./node_modules/ol/render/Feature.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/center.js","webpack://geopf-extensions-openlayers/./node_modules/ol/geom/flat/transform.js","webpack://geopf-extensions-openlayers/./node_modules/ol/functions.js","webpack://geopf-extensions-openlayers/external assign \"ol.render.canvas\"","webpack://geopf-extensions-openlayers/external assign \"ol.TileState\"","webpack://geopf-extensions-openlayers/external assign \"ol.util\"","webpack://geopf-extensions-openlayers/./node_modules/ol-mapbox-style/src/mapbox.js","webpack://geopf-extensions-openlayers/./node_modules/ol-mapbox-style/src/util.js","webpack://geopf-extensions-openlayers/./node_modules/ol-mapbox-style/src/text.js","webpack://geopf-extensions-openlayers/./node_modules/ol-mapbox-style/src/stylefunction.js","webpack://geopf-extensions-openlayers/external assign \"ol.Map\"","webpack://geopf-extensions-openlayers/external assign \"ol.View\"","webpack://geopf-extensions-openlayers/external assign \"ol.layer.Group\"","webpack://geopf-extensions-openlayers/external assign \"ol.layer.Image\"","webpack://geopf-extensions-openlayers/external assign \"ol.layer.Layer\"","webpack://geopf-extensions-openlayers/external assign \"ol.loadingstrategy\"","webpack://geopf-extensions-openlayers/external assign \"ol.proj.Units\"","webpack://geopf-extensions-openlayers/external assign \"ol.tilegrid.TileGrid\"","webpack://geopf-extensions-openlayers/external assign \"ol.source.Raster\"","webpack://geopf-extensions-openlayers/external assign \"ol.source.Source\"","webpack://geopf-extensions-openlayers/external assign \"ol.tilegrid\"","webpack://geopf-extensions-openlayers/./node_modules/ol-mapbox-style/src/apply.js","webpack://geopf-extensions-openlayers/external assign {\"commonjs\":\"ol\",\"commonjs2\":\"ol\",\"amd\":\"ol\",\"root\":\"ol\"}","webpack://geopf-extensions-openlayers/external assign \"ol.events.Event\"","webpack://geopf-extensions-openlayers/./src/packages/Utils/ProxyUtils.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LayerImport/LayerImportDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/LayerImport/LayerImport.js"],"sourcesContent":["module.exports = ol.style.Icon;","/* global Promise, require, XDomainRequest */\n\nimport Logger from \"../Utils/LoggerByDefault\";\nimport Helper from \"../Utils/Helper\";\nimport ES6Promise from \"es6-promise\";\n// import __request from \"request\";\n// import __xmldom from \"xmldom\";\n\n/**\n * Ajax Request (use of Promises)\n *\n * @module XHR\n * @alias Gp.Protocols.XHR\n * @see dependance 'es6-promise'\n */\n\n// cf. https://xhr.spec.whatwg.org/\n// cf. https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n\nvar XHR = {\n\n    /**\n     * Interface unique d'envoi d'une requête.\n     *\n     * @method call\n     * @static\n     * @param {Object} settings - options generales\n     * @param {String} settings.url    - url du service\n     * @param {String} settings.method - GET, POST, PUT, DELETE\n     * @param {String} settings.format - format de la reponse du service : json, xml ou null (brute)\n     * @param {String} settings.data   - content (post) ou param (get)\n     * @param {String} settings.proxy  - proxy url\n     * @param {Object|String} settings.headers - (post) ex. referer\n     * @param {Object|String} settings.content - (post) ex. 'application/json'\n     * @param {String} settings.timeOut - timeout = 0 par defaut\n     * @param {String} settings.scope - this\n     * @param {Function} settings.onResponse - callback\n     * @param {Function} settings.onFailure  - callback\n     */\n    call : function (settings) {\n        // logger\n        var logger = Logger.getLogger(\"XHR\");\n        logger.trace(\"[XHR::call()]\");\n\n        // FIXME\n        // To polyfill the global environment\n        ES6Promise.polyfill();\n\n        // test sur les settings obligatoires\n        if (!settings.url) {\n            throw new Error(\"missing parameter : url is not defined !\");\n        }\n\n        if (!settings.method) {\n            throw new Error(\"missing parameter : method is not defined !\");\n        }\n\n        if (!settings.format) {\n            settings.format = \"text\"; // reponse brute !\n        }\n\n        var options = {};\n        options.url = settings.url;\n        options.data = settings.data ? settings.data : null;\n        options.method = settings.method;\n        options.timeOut = settings.timeOut || 0;\n        options.scope = settings.scope || this;\n        options.proxy = settings.proxy || null;\n        options.content = settings.content || null;\n        options.headers = settings.headers || {\n            referer : \"http://localhost\"\n        };\n\n        // test sur les valeurs de 'settings.method'\n        switch (settings.method) {\n            case \"DELETE\":\n            case \"GET\":\n                break;\n            case \"PUT\":\n            case \"POST\":\n                // on force sur ces params spécifiques au mode POST\n                options.content = settings.content ? settings.content : \"application/x-www-form-urlencoded\"; // FIXME en attente des services : bascule en \"application/xml\" ou \"application/json\"\n                options.headers = settings.headers ? settings.headers : { referer : \"http://localhost\" }; // FIXME parametrable...\n                break;\n            case \"HEAD\":\n            case \"OPTIONS\":\n                throw new Error(\"HTTP method not yet supported !\");\n            default:\n                throw new Error(\"HTTP method unknown !\");\n        }\n\n        // test sur les valeurs de 'settings.format'\n        switch (settings.format) {\n            case \"text\":\n                this.__call(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            case \"json\":\n                this.__callJSON(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            case \"xml\":\n                this.__callXML(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            default:\n                throw new Error(\"This output Format is not yet supported !\");\n        }\n    },\n\n    /**\n     * Requete\n     *\n     * @method __call\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __call : function (options) {\n        var logger = Logger.getLogger(\"XHR\");\n        logger.trace(\"[XHR::__call()]\");\n\n        var promise = new Promise(\n            function (resolve, reject) {\n                // traitement du corps de la requête\n                var corps = (options.method === \"POST\" || options.method === \"PUT\") ? 1 : 0;\n\n                // seulement si options.data n'est pas vide (peut être un objet ou une chaine de caractères)\n                if (options.data && ((typeof options.data === \"object\" && Object.keys(options.data).length) || (typeof options.data === \"string\" && options.data.length)) && !corps) {\n                    options.url = Helper.normalyzeUrl(options.url, options.data);\n                }\n\n                logger.trace(\"URL = \", options.url);\n\n                var hXHR = null;\n\n                // test on env. nodejs or browser\n                if (typeof window === \"undefined\") {\n                    var nodefetch = require(\"node-fetch\");\n\n                    var opts = {\n                        headers : {\n                            Referer : \"https://localhost\"\n                        }\n                    };\n\n                    if (options.data && typeof options.data === \"string\" && corps) {\n                        opts = {\n                            method : options.method,\n                            body : options.data,\n                            headers : {\n                                \"Content-Type\" : options.content,\n                                Referer : \"https://localhost\"\n                            }\n                        };\n                    }\n\n                    return nodefetch(options.url, opts)\n                        .then(function (response) {\n                            if (response.ok) { // res.status >= 200 && res.status < 300\n                                resolve(response.text());\n                            } else {\n                                var message = \"Errors Occured on Http Request (status : '\" + response.statusText + \"' | url : '\" + response.url + \"')\";\n                                var status = response.status;\n                                reject({\n                                    message : message,\n                                    status : status\n                                });\n                            }\n                        })\n                        .catch(function (e) {\n                            reject({\n                                message : e,\n                                status : -1\n                            });\n                        });\n                } else {\n                    if (window.XMLHttpRequest) {\n                        logger.trace(\"XMLHttpRequest\");\n\n                        hXHR = new XMLHttpRequest();\n                        hXHR.open(options.method, options.url, true); // async\n                        hXHR.overrideMimeType = options.content;\n\n                        // gestion du timeout\n                        var onTimeOutTrigger = null;\n                        if (options.timeOut > 0) {\n                            // FIXME le timeout interne ne me permet pas de declencher le bon message...\n                            // hXHR.timeout = options.timeOut;\n                            logger.trace(\"XHR - TimeOut actif !\");\n                            /**\n                             * Description\n                             *\n                             * @method onTimeOutTrigger\n                             * @private\n                             */\n                            onTimeOutTrigger = window.setTimeout(\n                                function () {\n                                    var message = \"TimeOut Occured on Http Request with XMLHttpRequest !\";\n                                    reject({\n                                        message : message,\n                                        status : -1\n                                    });\n                                }, options.timeOut);\n                        }\n\n                        if (corps) {\n                            // headers, data, content of data\n                            // cf. https://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#dom-xmlhttprequest-setrequestheader\n                            logger.trace(\"data = \", options.data);\n                            hXHR.setRequestHeader(\"Content-type\", options.content);\n                            // FIXME refused to set unsafe header content-length javascript\n                            // hXHR.setRequestHeader (\"Content-length\", options.data.length);\n                            // hXHR.setRequestHeader (\"Referer\", options.headers.referer);\n                        }\n\n                        /**\n                         * On Error\n                         * FIXME ne se declenche pas !?\n                         *\n                         * @param {Object} e - Event\n                         * @method onerror\n                         * @private\n                         */\n                        hXHR.onerror = function (e) {\n                            console.log(e);\n                            reject(new Error(\"Errors Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * On Timeout\n                         * FIXME ne se declenche pas !?\n                         *\n                         * @param {Object} e - Event\n                         * @method ontimeout\n                         * @private\n                         */\n                        hXHR.ontimeout = function (e) {\n                            console.log(e);\n                            reject(new Error(\"TimeOut Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         *\n                         * @method onreadystatechange\n                         * @private\n                         */\n                        hXHR.onreadystatechange = function (e) {\n                            if (hXHR.readyState === 4) { // DONE\n                                if (hXHR.status === 200) {\n                                    window.clearTimeout(onTimeOutTrigger);\n                                    resolve(hXHR.response);\n                                } else {\n                                    var message = \"Errors Occured on Http Request (status : '\" + e.target.statusText + \"' | url : '\" + e.target.responseURL + \"' | response : '\" + e.target.response + \"')\";\n                                    var status = e.target.status;\n                                    reject({\n                                        message : message,\n                                        status : status\n                                    });\n                                }\n                            }\n                        };\n\n                        // gestion du content data\n                        var data4xhr = (options.data && corps) ? options.data : null;\n\n                        hXHR.send(data4xhr);\n                    } else if (window.XDomainRequest) {\n                        // worked in Internet Explorer 8–10 only !\n                        logger.trace(\"XDomainRequest\");\n\n                        hXHR = new XDomainRequest();\n                        hXHR.open(options.method, options.url);\n\n                        hXHR.overrideMimeType = options.content;\n\n                        if (options.timeOut > 0) {\n                            hXHR.timeout = options.timeout;\n                            logger.trace(\"XHR - TimeOut actif !\");\n                        }\n\n                        if (corps) {\n                            // headers, data, content of data\n                            // cf. https://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#dom-xmlhttprequest-setrequestheader\n                            hXHR.setRequestHeader(\"Content-type\", options.content);\n                            // FIXME refused to set unsafe header content-length javascript\n                            // hXHR.setRequestHeader (\"Content-length\", options.data.length);\n                            // hXHR.setRequestHeader (\"Referer\", options.headers.referer);\n                        }\n\n                        /**\n                         * Description\n                         *\n                         * @method onerror\n                         * @private\n                         */\n                        hXHR.onerror = function () {\n                            reject(new Error(\"Errors Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         *\n                         * @method ontimeout\n                         * @private\n                         */\n                        hXHR.ontimeout = function () {\n                            reject(new Error(\"TimeOut Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * On Load\n                         *\n                         * @method onload\n                         * @private\n                         */\n                        hXHR.onload = function (e) {\n                            if (hXHR.status === 200) {\n                                resolve(hXHR.responseText);\n                            } else {\n                                var message = \"Errors Occured on Http Request (status : '\" + e.target.statusText + \"' | url : '\" + e.target.responseURL + \"')\";\n                                var status = e.target.status;\n                                reject({\n                                    message : message,\n                                    status : status\n                                });\n                            }\n                        };\n\n                        var data4xdr = (options.data && corps) ? options.data : null;\n\n                        hXHR.send(data4xdr);\n                    } else {\n                        throw new Error(\"CORS not supported\");\n                    }\n                }\n            }\n        );\n\n        return promise;\n    },\n\n    /**\n     * Requete avec parser JSON\n     *\n     * @method __callJSON\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __callJSON : function (options) {\n        return this.__call(options)\n            .then(JSON.parse)\n            .catch(function (error) {\n                console.log(\"_callJSON failed on : \", options.url, error);\n                // FIXME pas d'exception, laissons le fil se derouler...\n                // throw error;\n            });\n    },\n\n    /**\n     * Requete avec parser XML\n     *\n     * @method __callXML\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __callXML : function (options) {\n        return this.__call(options)\n            .then(function (response) {\n                var xmlDoc;\n\n                // test on env. nodejs or browser\n                if (typeof window === \"undefined\") {\n                    var DOMParser = require(\"@xmldom/xmldom\").DOMParser; // __xmldom.DOMParser\n                    xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n                } else {\n                    if (window.DOMParser) {\n                        var parser = new window.DOMParser();\n                        xmlDoc = parser.parseFromString(response, \"text/xml\");\n                    } else { // IE\n                        xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n                        xmlDoc.async = false;\n                        xmlDoc.loadXML(response);\n                    }\n                }\n\n                return xmlDoc;\n            })\n            .catch(function (error) {\n                console.log(\"__callXML failed on : \", options.url, error);\n                // FIXME pas d'exception, laissons le fil se derouler...\n                // throw error;\n            });\n    }\n\n};\n\nexport default XHR;\n","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\n\n/**\n * @classdesc\n *\n * Classe de gestion des param. des requêtes du service de calcul des iso.\n * Permet le mapping avec les options du service.\n *\n * @constructor\n * @alias Gp.Services.ProcessIsoCurve.Request.ProcessIsoCurveParam\n * @param {Object} options - options\n * @private\n *\n */\nfunction ProcessIsoCurveParam (options) {\n    if (!(this instanceof ProcessIsoCurveParam)) {\n        throw new TypeError(\"ProcessIsoCurveParam constructor cannot be called as a function.\");\n    }\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur ProcessIsoCurveParam ()]\");\n\n    /**\n     * Options en paramêtres du constructeur.\n     */\n    this.options = options || {};\n\n    // mapping des options avec l'API REST\n\n    /** Identifiant de l’isochrone */\n    this.id = this.options.id;\n\n    /** Resource */\n    this.resource = this.options.resource;\n\n    /** Coordonnées de départ (ou arrivée si le reverse est à true). */\n    this.point = this.options.position;\n\n    /** projection (code EPSG comme epsg:4326 ou wgs84) */\n    this.crs = this.options.srs;\n\n    /**\n     * Profil de véhicule à utiliser pour le calcul.\n     * Voiture ou Pieton\n     */\n    this.profile = this.options.graph;\n\n    /** Liste des règles de restrictions à utiliser */\n    this.constraints = this.options.constraints;\n\n    this.reverse = this.options.reverse;\n\n    this.timeUnit = this.options.timeUnit;\n\n    this.distanceUnit = this.options.distanceUnit;\n\n    /**\n     * \"time\" pour isochrone ou \"distance\" for isodistance.\n     * Par defaut, time...\n     */\n    if (this.options.method === \"distance\") {\n        this.costType = \"distance\";\n        this.costValue = this.options.distance;\n        if (this.distanceUnit === \"m\" && this.costValue >= 50000) {\n            this.distanceUnit = \"km\";\n            this.costValue /= 1000;\n        }\n    } else {\n        this.costType = \"time\";\n        this.costValue = this.options.time;\n    }\n}\n\n/**\n * CLASSNAME\n */\nProcessIsoCurveParam.CLASSNAME = \"ProcessIsoCurveParam\";\n\nProcessIsoCurveParam.prototype = {\n\n    /**\n     * @lends module:ProcessIsoCurveParam#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : ProcessIsoCurveParam,\n\n    /**\n     * Retourne le point\n     * @returns {String} x,y\n     */\n    getLocation : function () {\n        return this.point.x + \",\" + this.point.y;\n    },\n\n    /**\n     * Retourne l'unité de la distance\n     * @returns {String}\n     */\n    getDistanceUnit : function () {\n        if (this.distanceUnit === \"m\") {\n            return \"meter\";\n        }\n        if (this.distanceUnit === \"km\") {\n            return \"kilometer\";\n        }\n        return \"\";\n    },\n\n    /**\n     * Retourne la liste des contraintes\n     * @returns {String}\n     */\n    getConstraints : function () {\n        var constraintArray = [];\n\n        if (this.constraints.length !== 0) {\n            for (var k = 0; k < this.constraints.length; k++) {\n                constraintArray.push(JSON.stringify(this.constraints[k]));\n            }\n        }\n        return constraintArray.join(\"|\");\n    },\n\n    /**\n     * Retourne la direction\n     * @returns {String}\n     */\n    getDirection : function () {\n        if (this.reverse) {\n            return \"arrival\";\n        } else {\n            return \"departure\";\n        }\n    }\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]} KVP\n */\nProcessIsoCurveParam.prototype.getParams = function () {\n    var map = [];\n\n    map.push({\n        k : \"resource\",\n        v : this.resource\n    });\n\n    map.push({\n        k : \"point\",\n        v : this.getLocation()\n    });\n\n    map.push({\n        k : \"direction\",\n        v : this.getDirection()\n    });\n\n    map.push({\n        k : \"costType\",\n        v : this.costType\n    });\n\n    map.push({\n        k : \"costValue\",\n        v : this.costValue\n    });\n\n    map.push({\n        k : \"profile\",\n        v : this.profile\n    });\n\n    map.push({\n        k : \"timeUnit\",\n        v : this.timeUnit\n    });\n\n    map.push({\n        k : \"distanceUnit\",\n        v : this.getDistanceUnit()\n    });\n\n    if (this.crs) {\n        map.push({\n            k : \"crs\",\n            v : this.crs\n        });\n    }\n\n    if (this.constraints) {\n        map.push({\n            k : \"constraints\",\n            v : this.getConstraints()\n        });\n    }\n\n    return map;\n};\n\nexport default ProcessIsoCurveParam;\n","import Control from \"ol/control/Control\";\nimport checkDsfr from \"./Utils/CheckDsfr\";\n\nvar ControlExtended = class ControlExtended extends Control {\n\n    constructor (options) {\n        options = options || {};\n        super({\n            element : options.element,\n            target : options.target,\n            render : options.render\n        });\n        // Can the control appear in the ControlList control\n        if (options && options.listable) {\n            this.listable = true;\n        } else {\n            this.listable = false;\n        }\n        // Set the control desctiption\n        if (options && options.description) {\n            this.description = options.description;\n        } else {\n            this.description = \"\";\n        }\n    }\n\n    setPosition (pos) {\n        if (this.getMap()) {\n            var instance = new PositionFactory(this);\n            instance.set(pos);\n        }\n    }\n\n    updatePosition (pos) {\n        if (this.getMap()) {\n            var instance = new PositionFactory(this);\n            instance.update(pos);\n        }\n    }\n\n};\n\nexport default ControlExtended;\n\n/**\n * gestion des anchors\n */\nconst ANCHORS = [\n    \"top-left\",\n    \"top-right\",\n    \"bottom-left\",\n    \"bottom-right\"\n];\n\n/**\n * Position\n * @private\n */\nclass PositionFactory {\n\n    /**\n     * constructor\n     * @param {*} caller - ...\n     */\n    constructor (caller) {\n        this.caller = caller;\n        this.container = null;\n\n        this.#createContainer(\"top-left\");\n        this.#createContainer(\"top-right\");\n        this.#createContainer(\"bottom-left\");\n        this.#createContainer(\"bottom-right\");\n\n        return this;\n    }\n\n    /**\n     * ...\n     * @param {*} name  - ...\n     * @returns {Boolean} ...\n     */\n    #existContainer (name) {\n        var div = this.container.children[\"position-container-\" + name];\n        if (div) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * ...\n     * @param {*} name - ...\n     * @private\n     */\n    #createContainer (name) {\n        this.container = this.caller.getMap().getOverlayContainerStopEvent();\n\n        if (this.#existContainer(name)) {\n            return;\n        }\n        // INFO\n        // positionner les classes position-container-[left|right|top|bottom]\n        // ex. { position:relative; height:50px; width:100%; }\n        var div = document.createElement(\"div\");\n        div.id = \"position-container-\" + name;\n        div.className = \"position position-container-\" + name ;\n\n        this.container.appendChild(div);\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @param {*} update - ...\n     * @todo fonctionnement à tester !\n     */\n    #setAnchor (pos, update) {\n        var self = this;\n        const position = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            return element.children.length;\n        };\n        const sizeW = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            var width = element.offsetWidth;\n            return width;\n        };\n        const sizeH = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            var height = element.offsetHeight;\n            if (update) {\n                if (pos.includes(\"top\")) {\n                    height = 0;\n                }\n                // on recalcule la position en hauteur\n                for (let index = 0; index < element.children.length; index++) {\n                    const id = element.children[index].id;\n                    if (id === self.caller.element.id) {\n                        height = (pos.includes(\"bottom\")) ? height - self.caller.element.offsetHeight : height * (-1);\n                        break;\n                    }\n                    height -= element.children[index].offsetHeight;\n                }\n            }\n            return height;\n        };\n        const clear = (element) => {\n            element.style.top = \"unset\";\n            element.style.bottom = \"unset\";\n            element.style.left = \"unset\";\n            element.style.right = \"unset\";\n        };\n\n        // on supprime le style de positionnement (top, left...)\n        // car on souhaite une nouvelle position\n        clear(this.caller.element);\n        this.caller.element.style.position = \"unset\"; // div.GPwidget\n\n        // on recherche les panneaux (panel) :\n        // * panel de formulaire\n        // * panel de resultats (?)\n        var panels = Array.from(this.caller.element.getElementsByClassName(\"GPpanel\"));\n        if (panels.length === 0) {\n            return;\n        }\n        var offset = 0;\n        panels.forEach((panel) => {\n            // INFO\n            // on va eviter de modifier les panneaux de resultats\n            // car leurs positions sont souvent relative aux panneaux\n            // des formulaires\n            if (panel.nodeName.toLowerCase() !== \"dialog\") {\n                return;\n            }\n            clear(panel);\n            // on modifie le positionnement du menu (dialog ou div : panel)\n            // en fonction du bouton\n            // ex. bouton : bottom-left, menu : bottom:0px; left:50px\n            switch (pos.toLowerCase()) {\n                case \"top-left\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.top = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.left = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"bottom-left\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.bottom = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.left = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"top-right\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.top = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.right = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"bottom-right\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.bottom = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.right = sizeW(pos) + offset + \"px\";\n                    break;\n                default:\n                    break;\n            }\n            offset += panel.offsetWidth;\n        });\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @public\n     */\n    set (pos) {\n        if (!ANCHORS.includes(pos.toLowerCase())) {\n            return;\n        }\n        // positionnement de l'element\n        this.#setAnchor(pos, false);\n\n        if (pos.includes(\"bottom\")) {\n            this.container.children[\"position-container-\" + pos].prepend(this.caller.element);\n        } else {\n            this.container.children[\"position-container-\" + pos].appendChild(this.caller.element);\n        }\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @public\n     */\n    update (pos) {\n        if (!ANCHORS.includes(pos.toLowerCase())) {\n            return;\n        }\n        // positionnement de l'element\n        // mais, il faut prendre en compte la position !\n        this.#setAnchor(pos, true);\n    }\n\n};\n","import Logger from \"../Utils/LoggerByDefault\";\nimport Helper from \"../Utils/Helper\";\nimport _ from \"../Utils/MessagesResources\";\nimport Protocol from \"../Protocols/Protocol\";\nimport ErrorService from \"../Exceptions/ErrorService\";\n// import DefaultUrlService from \"./DefaultUrlService\";\n// package.json (extract version)\nimport Pkg from \"../../package.json\";\n\n/**\n * @classdesc\n * Composant Service\n *\n * @constructor\n * @alias Gp.Services.CommonService\n * @param {Object} options - options communes à tous les services\n *\n * @param {String} [options.serverUrl] - URL d'accès au service. Par défaut \"https://data.geopf.fr/SERVICE/\".\n *      Permet de forcer l'utilisation d'un service équivalent déployé derrière une éventuelle autre URL d'accès.\n *      Si ce paramètre est renseigné alors, le paramètre par défaut est ignoré.\n *\n * @param {String} [options.protocol] - Le protocole à utiliser pour récupérer les informations du service :\n *      peut valoir 'JSONP' ou 'XHR'.\n *      Par défaut, c'est le protocole XHR qui sera utilisé.\n *      Attention, le protocole JSONP n'est pas valide dans un environnement NodeJS (Utilisation du mode XHR).\n *\n * @param {Boolean} [options.ssl] - Indique si l'on souhaite intérroger les services en https.\n *      Ce paramètre ne fonctionne que pour une utilisation hors navigateur (ex. NodeJS).\n *      Sur un navigateur, le protocole est automatiquement extrait de l'url du site...\n *      Par défaut, on utilise le protocole http (ssl=false).\n *\n * @param {String} [options.proxyURL] - Le proxy à utiliser pour pallier au problème de cross-domain dans le cas d'une requête XHR.\n *      Utile si le paramètre 'protocol' vaut 'XHR', il ne sera pas pris en compte si protocol vaut JSONP.\n *\n * @param {String} [options.callbackSuffix] - Suffixe de la fonction de callback à utiliser, dans le cas du protocole JSONP.\n *      Par défaut, la fonction de callback portera un nom du type \"callback\"+ID, où ID est soit un identifiant unique généré à chaque requête,\n *      soit le paramètre callbackSuffix s'il est spécifié. Par exemple, si callbackSuffix=\"_2\", la fonction sera \"callback_2 ()\".\n *      Utile pour utiliser une réponse déjà encapsulée dans une fonction de callback, dont le nom est connu\n *      Utile seulement si le paramètre 'protocol' vaut 'JSONP', il ne sera pas pris en compte si protocol vaut 'XHR'.\n *\n * @param {String} [options.httpMethod] - La méthode HTTP\n *      à utiliser dans le cas d'une requête XHR : peut valoir 'GET' ou 'POST'.\n *      Non pris en compte si 'protocol' vaut JSONP qui fonctionne obligatoirement en GET.\n *      Par défaut, c'est la méthode GET qui est utilisée.\n *\n * @param {String} [options.contentType] - Content-Type de la requete\n *      à utiliser dans le cas d'une requête XHR en mode POST.\n *      Non pris en compte si 'protocol' vaut JSONP et/ou la méthode HTTP vaut GET.\n *      Par défaut, c'est la méthode GET qui est utilisée donc on n'utilise pas de Content-Type.\n *\n * @param {Number} [options.timeOut] - Délai d'attente maximal (en ms) de la réponse du service (à partir de l'envoi de la requête).\n *      Par défaut, aucun timeOut n'est pris en compte (timeoutDelay= 0).\n *\n * @param {Boolean} [options.rawResponse] - Indique si l'on souhaite que la réponse du service ne soit pas parsée par l'API avant d'être restituée.\n *      (Cf. paramètre « onSuccess » pour plus de détails).\n *\n * @param {Function} [options.onSuccess] - Fonction appelée lorsque le service répond correctement à la requête\n *      (code HTTP 200, sans message d'erreur).\n *      Cette fonction prend en paramètre la réponse du service,\n *      soit sous la forme d'un Object Javascript formaté par le parseur dédié à la syntaxe du service (comportement par défaut) ;\n *      soit brute au format String non prétraité si le paramètre « rawResponse » a été précisé avec la valeur « true ».\n *\n * @param {Function} [options.onFailure] - Fonction appelée lorsque le service ne répond pas correctement\n *      (code HTTP de retour différent de 200 ou pas de réponse).\n *\n * @param {Function} [options.onBeforeParse] - Fonction appelée avant le parsing de la réponse\n *      Permet de modifier la réponse avant parsing et la fonction doit retourner une String.\n *      Cette fonction prend en paramètre la réponse telle que renvoyée par le service\n *      (cad au format json ou xml).\n *      Pour le JSONP, si le paramètre \"rawResponse\" a été précisé avec la valeur \"true\",\n *      la fonction prend en paramètre un Object JavaScript contenant la réponse XML.\n *\n * @example\n *   var options = {\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      ssl : false,\n *      proxyURL : null,\n *      callbackName : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      onBeforeParse : function (rawResponse) {}\n *   };\n */\nfunction CommonService (options) {\n    if (!(this instanceof CommonService)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\"));\n    }\n\n    this.logger = Logger.getLogger(\"CommonService\");\n    this.logger.trace(\"[Constructeur CommonService (options)]\");\n\n    // #####################\n    // récupération des options par défaut pour les paramètres optionnels\n    // #####################\n\n    /**\n     * Options du service\n     * @type {Object}\n     */\n    this.options = {\n        // protocol : \"JSONP\",\n        protocol : \"XHR\",\n        ssl : true,\n        proxyURL : \"\",\n        // callbackName : \"\",\n        callbackSuffix : null,\n        httpMethod : \"GET\",\n        timeOut : 0,\n        rawResponse : false,\n        scope : this,\n        /**\n        * callback par defaut pour la reponse\n        * @param {Object} response - response\n        * @private\n        */\n        onSuccess : function (response) {\n            console.log(\"onSuccess - la reponse est la suivante : \", response);\n        },\n        /**\n        * callback par defaut pour les erreurs\n        * @param {Object} error - error\n        * @private\n        */\n        onFailure : function (error) {\n            if (error.status === 200 || !error.status) {\n                console.log(\"onFailure : \", error.message);\n            } else {\n                console.log(\"onFailure - Erreur (\", error.status, \") : \", error.message);\n            }\n        }\n    };\n\n    // et on ajoute les options en paramètre aux options par défaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    // modification de la fonction de callback onSuccess dans le cas où la réponse brute est demandée\n    if (this.options.rawResponse && !this.options.onSuccess) {\n        /**\n        * callback par defaut pour la reponse\n        * @param {Object} response - response\n        * @private\n        */\n        this.options.onSuccess = function (response) {\n            console.log(\"onSuccess - la réponse brute du service est la suivante : \", response);\n        };\n    }\n\n    // gestion du callback onSuccess\n    var bOnSuccess = !!(this.options.onSuccess !== null && typeof this.options.onSuccess === \"function\");\n    if (!bOnSuccess) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"onSuccess()\"));\n    }\n\n    // gestion de la methode HTTP\n    this.options.httpMethod = (typeof options.httpMethod === \"string\") ? options.httpMethod.toUpperCase() : \"GET\";\n\n    switch (this.options.httpMethod) {\n        case \"POST\":\n        case \"GET\":\n            break;\n        case \"PUT\":\n        case \"DELETE\":\n        case \"HEAD\":\n        case \"OPTIONS\":\n            throw new Error(_.getMessage(\"PARAM_NOT_SUPPORT\", \"httpMethod\"));\n        default:\n            throw new Error(_.getMessage(\"PARAM_UNKNOWN\", \"httpMethod\"));\n    }\n\n    // gestion du protocole\n    // this.options.protocol = (typeof options.protocol === \"string\" ) ? options.protocol.toUpperCase() : \"JSONP\";\n    this.options.protocol = (typeof options.protocol === \"string\") ? options.protocol.toUpperCase() : \"XHR\";\n\n    switch (this.options.protocol) {\n        case \"JSONP\":\n        case \"XHR\":\n            break;\n        default:\n            throw new Error(_.getMessage(\"PARAM_UNKNOWN\", \"protocol\"));\n    }\n\n    // on determine l'environnement d'execution : browser ou non ?\n    // et on lance une exception sur l'utilisation du protocole JSONP pour nodeJS...\n    if (typeof window === \"undefined\" && this.options.protocol === \"JSONP\") {\n        throw new Error(_.getMessage(\"PARAM_NOT_SUPPORT_NODEJS\", \"protocol=JSONP (instead use XHR)\"));\n    }\n\n    // le protocole JSONP ne fonctionne qu'en GET.\n    if (this.options.protocol === \"JSONP\") {\n        this.options.httpMethod = \"GET\";\n    }\n\n    // gestion du cache\n    this.options.nocache = options.nocache || false;\n\n    // #####################\n    // attributs d'instances\n    // #####################\n\n    /**\n     * Format de réponse du service\n     */\n    this.options.outputFormat = null;\n    /**\n     * Requête envoyée au service\n     */\n    this.request = null;\n    /**\n     * Reponse du service\n     */\n    this.response = null;\n}\n\n/**\n * @lends module:CommonService\n */\nCommonService.prototype = {\n\n    /*\n     * Constructeur (alias)\n     */\n    constructor : CommonService,\n\n    /**\n     * Appel du service Géoportail\n     */\n    call : function () {\n        /* jshint validthis : true */\n        this.logger.trace(\"CommonService::call ()\");\n\n        var context = this;\n        /** fonction d'execution */\n        function run () {\n            this.logger.trace(\"CommonService::run ()\");\n            this.buildRequest.call(context, onError, onBuildRequest);\n        }\n\n        run.call(context);\n\n        // callback de fin de construction de la requête\n        function onBuildRequest (result) {\n            this.logger.trace(\"CommonService::onBuildRequest : \", result);\n            this.callService.call(context, onError, onCallService);\n        }\n\n        // callback de fin d'appel au service\n        function onCallService (result) {\n            this.logger.trace(\"CommonService::onCallService : \", result);\n            this.analyzeResponse.call(context, onError, onAnalyzeResponse);\n        }\n\n        // callback de fin de lecture de la reponse\n        function onAnalyzeResponse (result) {\n            this.logger.trace(\"CommonService::onAnalyzeResponse : \", result);\n            if (result) {\n                this.options.onSuccess.call(this, result);\n            } else {\n                return onError.call(this, new ErrorService(\"Analyse de la reponse en échec !?\"));\n            }\n        }\n\n        // callback de gestion des erreurs : renvoit un objet de type ErrorService\n        function onError (error) {\n            this.logger.trace(\"CommonService::onError()\");\n            // error : l'objet est du type ErrorService ou Error\n            var e = error;\n            if (!(e instanceof ErrorService)) {\n                e = new ErrorService(error.message);\n            }\n            this.options.onFailure.call(this, e);\n        }\n    },\n\n    /**\n     * Création de la requête\n     * @param {Function} error - callback\n     * @param {Function} success - callback\n     */\n    buildRequest : function (error, success) {\n        // INFO\n        this.logger.error(\"overwritten method !\");\n        // retourne l'objet 'this.request'\n        if (error) {\n            error.call(this, \"This method must be overwritten !\");\n        }\n        success.call(this, \"This method must be overwritten !\");\n    },\n\n    /**\n     * Appel du service\n     * @param {Function} error - callback\n     * @param {Function} success - callback\n     */\n    callService : function (error, success) {\n        // INFO\n        // retourne l'objet 'this.response'\n\n        // NOTES\n        //  Pour le mode XHR, on recupère une reponse sous forme d'un json ou xml (#document).\n        //  Pour le mode JSONP, on a toujours un objet JSON mais sous 2 formes :\n        //      - natif\n        //      - XML encapsulé :\n        //          {http : {status:200, error:null},xml :'réponse du service'}\n        //          {http : {status:400, error:'reponse du service'},xml :null}\n        //  En XHR, la reponse est directement sauvegardée dans 'this.response'.\n        //  Par contre, en JSONP, on doit analyser la reponse (status ou non vide),\n        //  et ne renvoyer que le contenu (xml ou l'objet)\n\n        // gestion de la proxification du service\n        var strUrlProxified = null;\n        var strData = this.request;\n\n        // a t on mis en place un proxy ?\n        // la proxyfication est valable uniquement en mode XHR !\n        var bUrlProxified = !!(this.options.proxyURL && this.options.protocol === \"XHR\");\n\n        // rajout de l'option gpbibaccess\n        // INFO : acces au numero de version de package.conf aprés compilation !\n        var requestMetaOptions = {\n            \"gp-access-lib\" : Pkg.version\n        };\n\n        if (this.options.apiKey) {\n            requestMetaOptions.apiKey = this.options.apiKey;\n        }\n\n        this.options.serverUrl = Helper.normalyzeUrl(this.options.serverUrl, requestMetaOptions, false);\n\n        // si le proxy est renseigné, on proxifie l'url du service\n        if (bUrlProxified) {\n            if (this.options.httpMethod === \"GET\") {\n                strUrlProxified = this.options.proxyURL + Helper.normalyzeUrl(this.options.serverUrl, this.request, true);\n                strData = null;\n            }\n\n            if (this.options.httpMethod === \"POST\") {\n                strUrlProxified = this.options.proxyURL + Helper.normalyzeUrl(this.options.serverUrl, null, true);\n                strData = this.request;\n            }\n        }\n\n        // contexte du composant spécifique !\n        var self = this;\n\n        var options = {\n            url : strUrlProxified || this.options.serverUrl,\n            method : this.options.httpMethod,\n            protocol : this.options.protocol,\n            timeOut : this.options.timeOut || 0,\n            format : this.options.outputFormat, // ceci declenche le parsing de la reponse du service, mais on souhaite toujours une reponse brute (string) !\n            nocache : this.options.nocache || false, // ceci permet d'ajouter un timestamp dans la requête\n            wrap : this.options.protocol !== \"XHR\", // ceci declenche l'encapsulation de la reponse XML du service dans du JSON, mais pas en mode XHR !\n            callbackSuffix : this.options.callbackSuffix,\n            // callbackName : this.options.callbackName || null,\n            data : strData,\n            headers : null, // TODO...\n            content : this.options.contentType || \"application/xml\",\n            scope : this.options.scope || this,\n            // callback de reponse\n            onResponse : function (response) {\n                self.logger.trace(\"callService::onResponse()\");\n\n                // le contenu de la reponse à renvoyer !\n                var content = null;\n\n                // XHR : on renvoie toujours la reponse brute du service (json ou xml)\n                // au parser du composant...\n                if (self.options.protocol === \"XHR\") {\n                    self.logger.trace(\"Response XHR\", response);\n                    content = response; // par defaut, la reponse du service  !\n                }\n\n                // JSONP : on pre-analyse la reponse brute du service (encapsuler ou pas)\n                // avant de l'envoyer au parser du composant...\n                if (self.options.protocol === \"JSONP\") {\n                    self.logger.trace(\"Response JSON\", response);\n                    if (response) {\n                        if (response.http) {\n                            // reponse encapsulée :\n                            // ex. reponse du service en xml\n                            // > {http : {status:200, error:null},xml :'réponse du service'}\n                            if (response.http.status !== 200) {\n                                error.call(self, new ErrorService({\n                                    status : response.http.status,\n                                    message : response.http.error,\n                                    type : ErrorService.TYPE_SRVERR\n                                }));\n                                return;\n                            } else {\n                                content = response.xml; // par defaut !\n                                if (self.options.rawResponse) {\n                                    content = response;\n                                }\n                            }\n                        } else {\n                            // reponse non encapsulée :\n                            // ex. reponse du service en json ou xml\n                            content = response;\n                        }\n                    } else {\n                        error.call(self, new ErrorService(\"Le contenu de la reponse est vide !?\"));\n                        return;\n                    }\n                }\n\n                // si on souhaite parser la reponse du service\n                if (typeof self.options.onBeforeParse === \"function\") {\n                    var newResponse = self.options.onBeforeParse(content);\n                    if (typeof newResponse === \"string\") {\n                        // la reponse parsée par l'utilisateur est retournée sous\n                        // forme de string !\n                        content = newResponse;\n                    }\n                }\n                // sauvegarde de la reponse dans l'objet parent (CommonService)\n                self.response = content;\n                // on renvoie la reponse...\n                success.call(self, content);\n            },\n            // callback des erreurs\n            onFailure : function (e) {\n                self.logger.trace(\"callService::onFailure()\");\n                // on est forcement sur une erreur levée par un service !\n                e.type = ErrorService.TYPE_SRVERR;\n                error.call(self, new ErrorService(e));\n            },\n            // callback de timeOut\n            onTimeOut : function () {\n                self.logger.trace(\"callService::onTimeOut()\");\n                error.call(self, new ErrorService(\"TimeOut!\"));\n            }\n        };\n\n        Protocol.send(options);\n    },\n\n    /**\n     * Analyse de la réponse\n     * @param {Function} error - callback\n     * @param {Function} success - callback\n     */\n    analyzeResponse : function (error, success) {\n        // INFO\n        this.logger.error(\"overwritten method !\");\n        // retourne l'objet spécifique au type de composant (json)\n        if (error) {\n            error.call(this, \"This method must be overwritten !\");\n        }\n        success.call(this, \"This method must be overwritten !\");\n    }\n\n};\n\nexport default CommonService;\n","module.exports = ol.layer.Vector;","/**\n * Classe de gestion des erreurs qui permer d'associer un message d'erreur à l'exception lancée.\n *\n * @example\n * MessagesResources.getMessage(\"ERROR_PARAM_MISSING\", \"x\", \"y\", \"z\")));\n * // --> output : Parameter(s) 'x - y - z' missing\n *\n * @module MessagesResources\n * @alias Gp.Utils.MessagesResources\n * @private\n */\nvar MessagesResources = {\n\n    // Paramètres\n    PARAM_MISSING : \"Parameter(s) '%var%' missing\",\n    PARAM_EMPTY : \"Parameter(s) '%var%' empty\",\n    PARAM_TYPE : \"Wrong type(s) for parameter(s) '%var%'\",\n    PARAM_FORMAT : \"Parameter(s) '%var%' not correctly formatted\",\n    PARAM_NOT_SUPPORT : \"Value(s) for parameter(s) '%var%' not supported\",\n    PARAM_NOT_SUPPORT_NODEJS : \"Value(s) for parameter(s) '%var%' not supported to NodeJS\",\n    PARAM_UNKNOWN : \"Value(s) for parameter(s) '%var%' unknown\",\n\n    // Services\n    // Requête\n    SERVICE_REQUEST_BUILD : \"An error occurred during the request building of the service\",\n    SERVICE_REQUEST_EMPTY : \"The request sent to the service is empty\",\n\n    // Réponse\n    SERVICE_RESPONSE_EXCEPTION : \"The service returned an exception : '%var%'\",\n    SERVICE_RESPONSE_EXCEPTION_2 : \"The service returned an exception\",\n    SERVICE_RESPONSE_ANALYSE : \"An error occurred while parsing the response '%var%' of the service\",\n    SERVICE_RESPONSE_ANALYSE_2 : \"An unknown error occurred while parsing the response\",\n    SERVICE_RESPONSE_EMPTY : \"The response of the service is empty\",\n    SERVICE_RESPONSE_EMPTY_2 : \"The response from the service could not be analyzed or is empty\",\n    SERVICE_RESPONSE_FORMAT : \"The format of the service response is not supported (handled format(s) : '%var%')\",\n    SERVICE_RESPONSE_FORMAT_2 : \"The format of the service response is not supported\",\n    SERVICE_RESPONSE_FORMAT_3 : \"No suggestion matching the search\",\n\n    // Classes\n    CLASS_CONSTRUCTOR : \"'%var%' constructor cannot be called as a function.\",\n\n    /**\n     * Fonction qui va retourner le message d'erreur associé à la clé donnée\n     *\n     * @method getMessage\n     * @param {String} clef - Clef de l'erreur (ex : ERROR_PARAM)\n     * @param {String[]} parametres - Paramètres/variables concernés par le message d'erreur associé à la clef donnée\n     * @return {String} message - String contenant le message de l'exception\n     */\n    getMessage : function (clef, parametres) {\n        // param de la fonction uniquement pour la documentation...\n\n        if (Object.keys(arguments).length === 0) {\n            return \"Message indefined !\";\n        }\n\n        var params = Array.prototype.slice.call(arguments);\n        var key = params.shift();\n        var args = params;\n\n        var message = this[key];\n\n        try {\n            if (Array.isArray(args) && args.length > 0) {\n                message = message.replace(\"%var%\", args.join(\" - \"));\n            } else {\n                message = message.replace(\"%var%\", \"%var% (not specified)\");\n            }\n        } catch (e) {\n            // error de string.replace()\n\n        }\n\n        return message;\n    }\n};\n\nexport default MessagesResources;\n","\n/**\n * Response object for {@link module:Services~geocode Gp.Services.geocode ()} or {@link module:Services~reverseGeocode Gp.Services.reverseGeocode ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.Geocode.GeocodedLocation>} locations - locations array.\n *\n * @namespace\n * @alias Gp.Services.GeocodeResponse\n */\nfunction GeocodeResponse () {\n    if (!(this instanceof GeocodeResponse)) {\n        throw new TypeError(\"GeocodeResponse constructor cannot be called as a function.\");\n    }\n\n    this.locations = [];\n}\n\nGeocodeResponse.prototype = {\n\n    constructor : GeocodeResponse\n\n};\n\nexport default GeocodeResponse;\n","module.exports = ol.Observable;","\n/**\n * Response object for {@link module:Services~isoCurve Gp.Services.isoCurve ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Float} distance - distance (expressed in meters) used for the request.\n * @property {Float} time - time (expressed in seconds) used for the request.\n * @property {Object} geometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the isocurve.\n * @property {String} id - request id (used by underlying webservice).\n * @property {Gp.Point} location - Position of the start or end point used for the request (expressed in \"srs\" coordinates system).\n * @property {String} message - message\n * @property {String} srs - Identifier of the coordinates system used for the isocurve.\n *\n * @namespace\n * @alias Gp.Services.IsoCurveResponse\n *\n */\nfunction ProcessIsoCurveResponse () {\n    if (!(this instanceof ProcessIsoCurveResponse)) {\n        throw new TypeError(\"ProcessIsoCurveResponse constructor cannot be called as a function.\");\n    }\n\n    this.message = null;\n\n    this.id = null;\n\n    this.location = {};\n    this.location.x = null;\n    this.location.y = null;\n\n    this.srs = null;\n\n    this.geometry = null;\n\n    this.time = null;\n\n    this.distance = null;\n}\n\nProcessIsoCurveResponse.prototype = {\n\n    constructor : ProcessIsoCurveResponse\n\n};\n\nexport default ProcessIsoCurveResponse;\n","/**\n* managing events\n*\n* See {@link http://krasimirtsonev.com/blog/article/javascript-managing-events-dispatch-listen}\n* See {@link https://github.com/krasimir/EventBus}\n*\n* @property {Event} \"editor:layer:onclickvisibility\" - event ...\n* @property {Event} \"editor:layer:onclickclone\" - event ...\n* @property {Event} \"editor:layer:onclickremove\" - event ...\n* @property {Event} \"editor:style:oneditjson\" - event ...\n* @property {Event} \"editor:style:scale:onchangemin\" - event ...\n* @property {Event} \"editor:style:scale:onchangemax\" - event ...\n* @property {Event} \"editor:legend:onclickedition\" - event ...\n* @property {Event} \"editor:legend:onchangevalue\" - event ...\n* @property {Event} \"editor:filter:oneditjson\" - event ...\n* @property {Event} \"editor:themes:onclickimage\" - event ...\n* @property {Event} \"editor:themes:onclicktitle\" - event ...\n* @property {Event} \"editor:search:onsubmit\" - event ...\n* @property {Event} \"editor:search:onautocomplete\" - event ...\n* @property {Event} \"editor:group:oncollapse\" - event ...\n* @property {Event} \"editor:onloaded\" - event ...\n*\n* @mixin\n*\n* @example\n* // dispatch event\n* EventBus.dispatch(EventEditor.layer.visibility, e);\n* // listener\n* EventBus.addEventListener(EventEditor.layer.visibility, function (e) {...}, this);\n*/\nvar EventEditor = {\n    /** evenement sur la fin de chargement de l'editeur */\n    onloaded : \"editor:onloaded\",\n    layer : {\n        /** evenement sur la visibilité : clic sur le bouton 'oeil' */\n        onclickvisibility : \"editor:layer:onclickvisibility\",\n        /** evenement sur la duplication : clic sur le bouton\n        (not yet implemented !) */\n        onclickclone : \"editor:layer:onclickclone\",\n        /** evenement sur la suppression : clic sur le bouton\n        (not yet implemented !) */\n        onclickremove : \"editor:layer:onclickremove\"\n    },\n    legend : {\n        /** evenement sur l'affichage du mode edition */\n        onclickedition : \"editor:legend:onclickedition\",\n        /** evenement sur la modification d'une valeur */\n        onchangevalue : \"editor:legend:onchangevalue\"\n    },\n    group : {\n        /**  evenement pour deplier/plier le groupe\n        (not yet implemented !) */\n        oncollapse : \"editor:group:oncollapse\"\n    },\n    style : {\n        /** evenement sur l'édition du style\n        (not yet implemented !) */\n        oneditjson : \"editor:style:oneditjson\",\n        /** evenement sur la modification de l'echelle d'affichage */\n        scale : {\n            onchangemin : \"editor:style:scale:onchangemin\",\n            onchangemax : \"editor:style:scale:onchangemax\"\n        }\n    },\n    filter : {\n        /** evenement sur l'édition du filtre\n        (not yet implemented !) */\n        oneditjson : \"editor:filter:oneditjson\"\n    },\n    themes : {\n        /** evenement sur le clic de l'image */\n        onclickimage : \"editor:themes:onclickimage\",\n        /** evenement sur le clic du titre */\n        onclicktitle : \"editor:themes:onclicktitle\"\n    },\n    search : {\n        /** evenement sur la recherche */\n        onsubmit : \"editor:search:onsubmit\",\n        onautocomplete : \"editor:search:onautocomplete\"\n    }\n};\n\nexport default EventEditor;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-style\");\n\n/**\n * @classdesc\n *\n * MapBox styles management\n *\n * @constructor\n * @alias ol.style.editor.Style\n * @param {Object} options - options for function call.\n * @example\n *   var style = new Style ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false,\n *          scale : true\n *      },\n *      title : \"Styles (JSON)\",\n *      obj : {\n *          paint : {},\n *          layout : {}\n *      }\n *   });\n *  style.add();\n *  style.display(true);\n *  style.getContainer();\n */\nclass Style {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Style\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Style)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            scale : true,\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                paint : {},\n                layout : {}\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Styles :\";\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxStyleTarget\",\n            container : \"GPEditorMapBoxStyleContainer\",\n            containerjson : \"GPEditorMapBoxStyleJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxStyleJsonTitle\",\n            jsondisplay : \"GPEditorMapBoxStyleJsonDisplay\",\n            containertoolsscale : \"GPEditorMapBoxStyleToolsScaleContainer\",\n            scaletitle : \"GPEditorMapBoxStyleScaleTitle\",\n            containertoolsminscale : \"GPEditorMapBoxStyleToolsScaleMinContainer\",\n            scalelabelmin : \"GPEditorMapBoxStyleScaleLabelMin\",\n            scaleinputmin : \"GPEditorMapBoxStyleScaleInputMin\",\n            containertoolsmaxscale : \"GPEditorMapBoxStyleToolsScaleMaxContainer\",\n            scalelabelmax : \"GPEditorMapBoxStyleScaleLabelMax\",\n            scaleinputmax : \"GPEditorMapBoxStyleScaleInputMax\",\n            containertoolsedit : \"GPEditorMapBoxStyleToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * ie. this.container\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxStyleContainer\">\n     *   <div class =\"GPEditorMapBoxStyleJsonContainer\">\n     *      <label class=\"GPEditorMapBoxStyleJsonTitle\">JSON Styles :</label>\n     *      <pre class=\"GPEditorMapBoxStyleJsonDisplay\">...</pre>\n     *   </div>\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     *   <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _obj = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n        var _style = {};\n\n        // styles into tag 'paint' ?\n        if (_obj.paint) {\n            _found = true;\n            _style.paint = _obj.paint;\n            if (Object.keys(_obj.paint).length === 0) {\n                logger.info(\"tag 'paint' is empty !\");\n            }\n        }\n\n        // if not, search into tag 'layout' !\n        if (_obj.layout) {\n            _found = true;\n            _style.layout = _obj.layout;\n            // FIXME delete visibility from display ?\n            if (_obj.layout.visibility) {\n                delete _style.visibility;\n            }\n            if (Object.keys(_obj.layout).length === 0) {\n                logger.info(\"tag 'layout' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            var strJson = JSON.stringify(_style, null, 4);\n            json = this._syntaxHighlight(strJson);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var label = document.createElement(\"label\");\n        label.className = this.name.jsonlabel;\n        label.innerHTML = this.options.title;\n        divJson.appendChild(label);\n\n        var pre = document.createElement(\"pre\");\n        pre.className = this.name.jsondisplay;\n        pre.innerHTML = json;\n        if (pre.addEventListener) {\n            pre.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        } else if (pre.attachEvent) {\n            pre.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(pre);\n        div.appendChild(divJson);\n\n        // scale\n        if (this.options.tools.scale) {\n            div.appendChild(this._createElementToolsScale({\n                min : (_style.layout) ? _style.layout.minzoom : 0,\n                max : (_style.layout) ? _style.layout.maxzoom : 21\n            }));\n        }\n\n        // TODO menu d'edition\n        if (this.options.tools.edition) {\n            div.appendChild(this._createElementToolsEdition());\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    /**\n     * Graphical rendering of the scale tools\n     *\n     * @param {Object} scale - {min,max} or 0|21\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsScale (scale) {\n        logger.trace(\"_createElementToolsScale\");\n\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var divToolsScale = document.createElement(\"div\");\n        divToolsScale.className = this.name.containertoolsscale;\n\n        // FIXME Titre ?\n        // var label = document.createElement(\"label\");\n        // label.className = this.name.scaletitle;\n        // label.innerHTML = \"Scale :\";\n        // divToolsScale.appendChild(label);\n        var divMin = document.createElement(\"div\");\n        divMin.className = this.name.containertoolsminscale;\n\n        var labelMin = document.createElement(\"label\");\n        labelMin.className = this.name.scalelabelmin;\n        labelMin.innerHTML = \"min :\";\n        divMin.appendChild(labelMin);\n\n        var inputMin = document.createElement(\"input\");\n        inputMin.className = this.name.scaleinputmin;\n        inputMin.type = \"range\";\n        inputMin.value = scale.min || 0;\n        inputMin.title = scale.min || 0;\n        inputMin.disabled = false;\n        inputMin.min = 0;\n        inputMin.max = 21;\n        inputMin.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMin.addEventListener) {\n            inputMin.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        } else if (inputMin.appendChild) {\n            inputMin.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        }\n        divMin.appendChild(inputMin);\n\n        divToolsScale.appendChild(divMin);\n\n        var divMax = document.createElement(\"div\");\n        divMax.className = this.name.containertoolsmaxscale;\n\n        var labelMax = document.createElement(\"label\");\n        labelMax.className = this.name.scalelabelmax;\n        labelMax.innerHTML = \"max :\";\n        divMax.appendChild(labelMax);\n\n        var inputMax = document.createElement(\"input\");\n        inputMax.className = this.name.scaleinputmin;\n        inputMax.type = \"range\";\n        inputMax.value = scale.max || 21;\n        inputMax.title = scale.max || 21;\n        inputMax.disabled = false;\n        inputMax.min = 0;\n        inputMax.max = 21;\n        inputMax.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMax.addEventListener) {\n            inputMax.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        } else if (inputMax.appendChild) {\n            inputMax.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        }\n        divMax.appendChild(inputMax);\n\n        divToolsScale.appendChild(divMax);\n\n        return divToolsScale;\n    }\n\n    /**\n     * Graphical rendering of the edition tools\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsEdition () {\n        logger.warn(\"_createElementToolsEdition, it's not yet implemented !\");\n\n        var divToolsEdit = document.createElement(\"div\");\n        divToolsEdit.className = this.name.containertoolsedit;\n\n        return divToolsEdit;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Transform a JSON into a DOM with a syntax in color\n     *\n     * @private\n     * @param {Object} json - json.\n     * @returns {DOMElement} dom element\n     */\n    _syntaxHighlight (json) {\n        json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n        return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function (match) {\n            var cls = \"gp-json-number\";\n            if (/^\"/.test(match)) {\n                if (/:$/.test(match)) {\n                    cls = \"gp-json-key\";\n                } else {\n                    cls = \"gp-json-string\";\n                }\n            } else if (/true|false/.test(match)) {\n                cls = \"gp-json-boolean\";\n            } else if (/null/.test(match)) {\n                cls = \"gp-json-null\";\n            }\n            return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n        });\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:oneditjson\n     */\n    onEditJsonStyleMapBox (e) {\n        logger.trace(\"onEditJsonStyleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.oneditjson, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemin\n     */\n    onChangeStyleScaleMinMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMinMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemin, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemax\n     */\n    onChangeStyleScaleMaxMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMaxMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemax, e);\n    }\n\n};\n\nexport default Style;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Style = Style;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-themes\");\n\n/**\n * @classdesc\n *\n * Mapbox Themes management\n *\n * @constructor\n * @alias ol.style.editor.Theme\n * @param {Object} options - options for function call.\n * @example\n *   var theme = new Themes ({\n *        \"target\": \"\",\n *        \"tools\": {\n *          \"thumbnails\": true,\n *          \"button\" : {\n *              \"visible\" : true,\n *              \"type\" : \"radio\" (par defaut) | \"checkbox\"\n *          }\n *        },\n *        \"obj\": {\n *          \"themesSummary\": \"\", // Titre du composant (non graphique !)\n *          \"themes\": [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *        }\n *   });\n *  theme.add();\n *  theme.display(true);\n *  theme.getContainer();\n */\nclass Themes {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Themes\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Themes)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {\n            thumbnails : true,\n            button : {\n                visible : true,\n                type : \"radio\"\n            }\n        };\n\n        if (!this.options.tools || Object.keys(this.options.tools).length === 0) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (typeof this.options.obj === \"undefined\" ||\n            this.options.obj === null ||\n            !this.options.obj) {\n            // vide par defaut ?\n            this.options.obj = {\n                themesSummary : \"\",\n                themes : []\n            };\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxThemeTarget\",\n            container : \"GPEditorMapBoxThemesContainer\",\n            containertheme : \"GPEditorMapBoxThemeContainer\",\n            containerthemeID : \"GPEditorMapBoxThemeContainer_ID_\",\n            input : \"GPEditorMapBoxThemeInput\",\n            inputID : \"GPEditorMapBoxThemeInput_ID_\",\n            label : \"GPEditorMapBoxThemeTitle\",\n            labelID : \"GPEditorMapBoxThemeTitle_ID_\",\n            image : \"GPEditorMapBoxThemeImage\",\n            imageID : \"GPEditorMapBoxThemeImage_ID_\",\n            message : \"GPEditorMapBoxThemeMessage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     *  <div class=\"GPEditorMapBoxThemesContainer\">\n     *      <div id=\"GPEditorMapBoxThemeContainer-1\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176933\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image1.png\" alt=\"Description1\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeTitle\">Titre1</label>\n     *      </div>\n     *      <div id=\"GPEditorMapBoxThemeContainer-2\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176934\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image2.png\" alt=\"Description2\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeTitle\">Titre2</label>\n     *      </div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var id = this.id || ID.generate();\n\n        // div principale\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n        div.title = obj.themesSummary || \"\";\n\n        var _lstThemes = obj.themes;\n        if (_lstThemes) {\n            for (var i = 0; i < _lstThemes.length; i++) {\n                var _theme = _lstThemes[i];\n\n                // div pour chaque theme\n                var divTheme = document.createElement(\"div\");\n                divTheme.id = this.name.containerthemeID + i + \"_\" + id;\n                divTheme.className = this.name.containertheme;\n                divTheme.tabIndex = i;\n\n                // url du style est obligatoire !\n                var _url = _theme.url;\n                // style selectionné par defaut (uniquement en mode radio-button !?)\n                var _selected = _theme.selected || false;\n                if (_url) {\n                    // bouton\n                    var button = this.options.tools.button;\n                    if (button.visible) {\n                        var _type = (button.type === \"checkbox\") ? \"checkbox\" : \"radio\";\n                        var _button = document.createElement(\"input\");\n                        _button.type = _type;\n                        _button.id = this.name.inputID + i + \"_\" + id;\n                        _button.className = this.name.input;\n                        _button.name = id;\n                        _button.checked = _selected;\n                        _button.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (_button.addEventListener) {\n                            _button.addEventListener(\"click\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        } else if (_button.attachEvent) {\n                            _button.attachEvent(\"onclick\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        }\n                        divTheme.appendChild(_button);\n                    }\n                    // vignette\n                    if (this.options.tools.thumbnails) {\n                        if (_theme.thumbnail) {\n                            var _img = document.createElement(\"img\");\n                            _img.id = this.name.imageID + i + \"_\" + id;\n                            _img.className = this.name.image;\n                            _img.src = _theme.thumbnail;\n                            _img.alt = _theme.thumbnail;\n                            _img.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                            _img.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                            if (_img.addEventListener) {\n                                _img.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    // maj du radio button\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            } else if (_img.attachEvent) {\n                                _img.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            }\n                            divTheme.appendChild(_img);\n                        }\n                    }\n                    // label\n                    if (_theme.name) {\n                        var _label = document.createElement(\"label\");\n                        _label.id = this.name.labelID + i + \"_\" + id;\n                        if (this.options.tools.button.visible) {\n                            _label.htmlFor = _button.id;\n                        }\n                        _label.className = this.name.label;\n                        _label.innerHTML = _theme.name;\n                        _label.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                        _label.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (!this.options.tools.button.visible) {\n                            if (_label.addEventListener) {\n                                _label.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            } else if (_label.attachEvent) {\n                                _label.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            }\n                        }\n                        divTheme.appendChild(_label);\n                    }\n                } else {\n                    var _msg = document.createElement(\"label\");\n                    _msg.className = this.name.message;\n                    _msg.innerHTML = \"Thème non disponible...\";\n                    divTheme.appendChild(_msg);\n                }\n\n                div.appendChild(divTheme);\n            }\n        }\n\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:image\n     */\n    onClickThemeImageMapBox (e) {\n        logger.trace(\"onClickThemeImageMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.previousSibling.id.substring(\n                e.target.previousSibling.id.lastIndexOf(\"_\") + 1\n            );\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.previousSibling.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclickimage, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:title\n     */\n    onClickThemeTitleMapBox (e) {\n        logger.trace(\"onClickThemeTitleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.id.substring(e.target.id.lastIndexOf(\"_\") + 1);\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclicktitle, e);\n    }\n\n};\n\nexport default Themes;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Themes = Themes;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-filter\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Filter\n * @param {Object} options - options for function call.\n * @example\n *   var filter = new Filter ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false\n *      },\n *      title : \"Filtres (JSON)\",\n *      obj : {\n *          filter : []\n *      }\n *   });\n *  filter.add();\n *  filter.display(true);\n *  filter.getContainer();\n */\nclass Filter {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Filter\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Filter)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                filter : []\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Filtres :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxFilterTarget\",\n            container : \"GPEditorMapBoxFilterContainer\",\n            containerjson : \"GPEditorMapBoxFilterJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxFilterTitleJson\",\n            jsondisplay : \"GPEditorMapBoxFilterDisplayJson\",\n            containertoolsedit : \"GPEditorMapBoxFilterToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxFilterContainer\">\n     *  <div class =\"GPEditorMapBoxFilterJsonontainer\">\n     *     <label class=\"GPEditorMapBoxFilterTitleJson\">JSON Filtres :</label>\n     *     <pre class=\"GPEditorMapBoxFilterDisplayJson\">...</pre>\n     *  </div>\n     *  <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _filter = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        // FIXME tag filter est obselete !\n        // on doit utiliser les expressions dans \"paint\" ou \"layout\" !\n        if (_filter.filter) {\n            _found = true;\n            if (_filter.filter.length === 0) {\n                logger.info(\"tag 'filter' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            json = JSON.stringify(_filter.filter, null, 4);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var labelJson = document.createElement(\"label\");\n        labelJson.className = this.name.jsonlabel;\n        labelJson.innerHTML = this.options.title;\n        divJson.appendChild(labelJson);\n\n        var preJson = document.createElement(\"pre\");\n        preJson.className = this.name.jsondisplay;\n        preJson.innerHTML = json;\n        if (preJson.addEventListener) {\n            preJson.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        } else if (preJson.attachEvent) {\n            preJson.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(preJson);\n        div.appendChild(divJson);\n\n        if (this.options.tools.edition) {\n            var divEdit = document.createElement(\"div\");\n            divEdit.className = this.name.containertoolsedit;\n            div.appendChild(divEdit);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Filter#editor:style:oneditjson\n     */\n    onEditJsonFilterMapBox (e) {\n        logger.trace(\"onEditJsonFilterMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.filter.oneditjson, e);\n    }\n\n};\n\nexport default Filter;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Filter = Filter;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Color from \"../../Utils/ColorUtils\";\n\nvar logger = Logger.getLogger(\"editor-legend\");\n\n/**\n * @classdesc\n *\n * MapBox Legend management\n *\n * @constructor\n * @alias ol.style.editor.Legend\n * @param {Object} options - options for function call.\n * @param {Object} [options.target = null] - ...\n * @param {Number} [options.position = 0] -  ...\n * @param {Number} [options.id = null] - (internal) ...\n * @param {Object} [options.sprites = null] - ...\n * @param {String} [options.sprites.url] - ...\n * @param {Object} [options.sprites.size] - {h:, w:} ...\n * @param {Object} [options.sprites.json] - ...\n * @param {Object} options.obj - ...\n * @param {String} [options.obj.title] - ...\n * @param {Boolean} [options.obj.editable = true] - ...\n * @param {Object} options.obj.paint - ...\n * @param {Object} options.obj.layout - ...\n * @example\n *   var legend = new Legend ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      sprites : {\n *          url : \"http://localhost/sprites.png\",\n *          size : { w : 450, h : 550 },\n *          json : {\n *              icon-1 : {x:,y:,height:,width:,pixelRatio:},\n *              icon-2 : {x:,y:,height:,width:,pixelRatio:}\n *          }\n *      },\n *      obj : {\n *          title : \"\",\n *          editable : true, // tag non standard issue du style json dédié à l'edition\n *          paint : {\"fill-color\": \"#2BB3E1\"},\n *          layout : {visibility:\"none\"}\n *      }\n *   });\n *  legend.add();\n *  legend.display(true);\n *  legend.isEditable();\n *  legend.getRenderContainer();\n *  legend.getToolsContainer();\n *  legend.getContainer();\n */\nclass Legend {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Legend\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            sprites : null,\n            obj : null\n        };\n\n        if (!(this instanceof Legend)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ########################## init methods ########################### //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        // permet d'avoir un identifiant de position dans la liste des layers\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition...\n            this.options.obj = {\n                title : \"vide...\",\n                editable : true,\n                paint : {\n                    \"fill-color\" : \"#FFFFFF\"\n                }\n            };\n        }\n\n        // la legende est elle editable ?\n        // le tag 'editable' est à placer dans le fichier de style (dans le layer)...\n        var _editable = this.options.obj.editable;\n        this.editable = (typeof _editable !== \"undefined\") ? _editable : false;\n\n        // liste des caractéristiques de la legende par defaut\n        this.legendRender = {\n            type : \"fill\",\n            values : {\n                width : 1,\n                stroke : \"#FFFFFF\",\n                color : \"#000000\",\n                opacity : 1\n            }\n        };\n\n        // DOM : pointer\n        this.container = null;\n        this.rendercontainer = null;\n        this.toolscontainer = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLegendTarget\",\n            container : \"GPEditorMapBoxLegendContainer\",\n            containerlegendrender : \"GPEditorMapBoxLegendRenderContainer\",\n            legendrender : \"GPEditorMapBoxLegendRender\",\n            legendeditable : \"GPEditorMapBoxLegendEditable\",\n            legendtitle : \"GPEditorMapBoxLegendTitle\",\n            containerlegendtools : \"GPEditorMapBoxLegendToolsContainer\"\n        };\n\n        // DOM : Label menu Edition\n        this.labels = {\n            \"line-color\" : \"Couleur du trait\",\n            \"line-width\" : \"Epaisseur du trait\",\n            \"line-opacity\" : \"Opacité du trait\",\n            \"fill-color\" : \"Couleur de remplissage\",\n            \"fill-opacity\" : \"Opacité du remplissage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxLegendContainer\">\n     *  <div class=\"GPEditorMapBoxLegendRenderContainer\">\n     *      <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-circle\" style=\"...\"></div>\n     *      <span class=\"GPEditorMapBoxLegendTitle\">test circle editable...</span>\n     *  </div>\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     * </div>\n     */\n    _initContainer () {\n        var _obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // INFO\n        // on recherche les informations dans le tag 'paint' en priorité, mais pour\n        // les icones ou textes, les informations peuvent se trouver aussi dans le tag 'layout'...\n        // on fusionnne paint et layout par facilité\n        var style = Object.assign({}, _obj.paint, _obj.layout);\n\n        // liste des properties mapbox\n        // ex. fill-color\n        var keys = Object.keys(style);\n        if (keys.length === 0) {\n            logger.info(\"tag 'paint' or 'layout' is empty !\");\n            return;\n        }\n\n        // FIXME\n        // - gestion de type plus complexe : texte avec/sans symbole ou symbole !\n        // - pour les textes ou icones, les info peuvent être aussi dans le tag 'layout' !\n        var params = {};\n        var bFound = false;\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            // recherche du type\n            // ex. fill\n            if (/fill-/.test(key) ||\n                /line-/.test(key) ||\n                /circle-/.test(key) ||\n                /background-/.test(key) ||\n                /text-/.test(key) ||\n                /icon-/.test(key)) {\n                // style geré & trouvé\n                bFound = true;\n\n                var title = _obj.title || \"\";\n\n                // INFO\n                // le type texte ou icone est difficile à trouver car les 2 types cohabitent,\n                // on le gère en symbole...\n                var type = key.split(\"-\")[0];\n                if (type === \"text\" || type === \"icon\") {\n                    type = \"symbol\";\n                }\n\n                this.legendRender = this._getProperties(type, style);\n                params = {\n                    edit : this.editable,\n                    title : title,\n                    type : this.legendRender.type,\n                    values : this.legendRender.values\n                };\n                div.appendChild(this._createElementIconLegend(params));\n\n                // on stoppe la recherche\n                break;\n            }\n        }\n\n        // legende avec un style indeterminé ou non géré !?\n        if (!bFound) {\n            // on prend la legende par defaut\n            params = {\n                edit : this.editable,\n                title : \"\",\n                type : this.legendRender.type,\n                values : this.legendRender.values\n            };\n            div.appendChild(this._createElementIconLegend(params));\n            logger.warn(\"legend type unknown, default legend used...\");\n        }\n\n        // ajout mode edition graphique de la legende\n        this.toolscontainer = this._createElementEditionLegend(params);\n        div.appendChild(this.toolscontainer);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n    * Get properties supported\n    *\n    * @param {Object} type - fill, line, circle, text, icon...\n    * @param {Object} values - raw values from the JSON file\n    * @returns {Object} - { type : (fill | line | circle | symbol), values : valuesSupported }\n    *\n    * @private\n    * @example\n    *\n    * // TODO\n    * // symbol with text (1) / symbol without text (2) / text (3)\n    * // \"layout\":{\n    * //      \"icon-image\":\"{maki}-11\",          <!--- IT'S A SYMBOL (1) (2)-->\n    * //      \"text-font\":[\n    * //           \"Open Sans Semibold\",\n    * //           \"Arial Unicode MS Bold\"\n    * //       ],\n    * //       \"text-field\":\"{name_en}\",         <!--- IT'S A TEXT (1) (3)-->\n    * //       \"text-max-width\":9,\n    * //       \"text-padding\":2,\n    * //       \"text-offset\":[\n    * //            0,\n    * //            0.6\n    * //       ],\n    * //       \"text-anchor\":\"top\",\n    * //       \"text-size\":12\n    * // },\n    * // \"paint\":{\n    * //     \"text-color\":\"#666\",\n    * //     \"text-halo-color\":\"#ffffff\",\n    * //     \"text-halo-width\":1,\n    * //     \"text-halo-blur\":0.5\n    * // },\n    *\n    */\n    _getProperties (type, values) {\n        // cas particulier du symbole complexe\n        // il existe plusieurs types pour un symbole :\n        // - text\n        // - icon\n        // - icon with text\n        if (type === \"symbol\") {\n            var isTextValue = values[\"text-field\"];\n            var isIconValue = values[\"icon-image\"];\n            type = (isTextValue && isIconValue) ? \"icon\" : (isTextValue) ? \"text\" : (isIconValue) ? \"icon\" : \"unknow\";\n            if (type === \"unknow\") {\n                logger.warn(\"type unknow !?\");\n                return;\n            }\n        }\n\n        var valuesSupported = {};\n        for (const key in values) {\n            if (Object.hasOwnProperty.call(values, key)) {\n                const val = values[key];\n                if (Legend.PROPERTIES[type].includes(key)) {\n                    var prop = key.replace(type, \"\").slice(1);\n                    var value = this._getValue(val);\n                    if (value) {\n                        // cas particulier des sprites\n                        if (prop === \"pattern\" || prop === \"image\") {\n                            if (!this.options.sprites ||\n                                !this.options.sprites.json ||\n                                !this.options.sprites.json[value]) {\n                                var k = type + \":\" + prop;\n                                logger.warn(\"sprites mandatory for key \", k);\n                                break;\n                            }\n                        }\n                        valuesSupported[prop] = value;\n                    }\n                } else {\n                    logger.warn(\"property not supported : \", key);\n                }\n            }\n        }\n\n        return {\n            type : type,\n            values : valuesSupported\n        };\n    }\n\n    /**\n    * Render thumbnail (SVG)\n    *\n    * @param {Object} type - fill, line, circle, text, ...\n    * @param {Object} values - {\"color\":..., \"width\":..., \"stroke\":...., \"opacity\":...}\n    * @returns {Boolean} true/false\n    *\n    * @private\n    * @example\n    * (...)\n    */\n    _renderThumbnail (type, values) {\n        // div de rendu de la legende\n        var div = this.rendercontainer;\n\n        if (!div) {\n            return false;\n        }\n\n        // SVG\n        var svg = null;\n        // facteur grossissement (x10) pour le trait\n        var factor = 3;\n\n        // valeur par defaut\n        if (!values.color) {\n            values.color = \"#FFFFFF\";\n        }\n        // en fonction du type, on y ajoute le style\n        switch (type) {\n            case \"text\":\n                var styleText = \"font-size: 5em;font-weight: bold;\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%style%\", styleText);\n                break;\n            case \"icon\":\n                if (values.image) {\n                    // FIXME on reste dans le paradigme d'utilisation du SVG...,\n                    // mais probleme de ratio de l'image !?\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.image].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.image].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.image].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.image].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var styleTextIcon = \"fill: transparent;stroke-width: 10;\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%style%\", styleTextIcon);\n                }\n                break;\n            case \"line\":\n                var lstrockedasharray = (Array.isArray(values[\"dasharray\"])) ? values[\"dasharray\"].join(\" \") : 0;\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>\\\")\";\n                // svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M0 99 L99 0 L100 1 L1 100' stroke='%color%' stroke-width='%width%' stroke-opacity='%opacity%' stroke-dasharray='%dasharray%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%stroke-opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-dasharray%\", lstrockedasharray)\n                    .replace(\"%stroke-width%\", (values.width || 0) * factor);\n                break;\n            case \"circle\":\n                var cstrockcolor = values[\"stroke-color\"] || \"#FFFFFF\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-color%\", (cstrockcolor.indexOf(\"rgb\") === 0) ? cstrockcolor : Color.hexToRgba(cstrockcolor, 1))\n                    .replace(\"%stroke-opacity%\", values[\"stroke-opacity\"] || 1)\n                    .replace(\"%stroke-width%\", (values[\"stroke-width\"] || 0) * factor);\n                break;\n            case \"background\":\n            case \"fill\":\n                if (values.pattern) {\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.pattern].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.pattern].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.pattern].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.pattern].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var fstrokecolor = values[\"outline-color\"] || \"#FFFFFF\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%opacity%\", values.opacity || 1)\n                        .replace(\"%stroke-color%\", (fstrokecolor.indexOf(\"rgb\") === 0) ? fstrokecolor : Color.hexToRgba(fstrokecolor, 1));\n                }\n                break;\n            default:\n                logger.warn(\"type not found, no thumbnail...\");\n                return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Get value\n     *\n     * @param {*} value - value of a property (ex. \"#2BB3E1\")\n     * @returns {*} return a verified value (ex. color\": \"#2BB3E1\")\n     *\n     * @private\n     * @example\n     * // type simple for fill, line or circle type with string :\n     * // \"paint\": {\n     * //     \"fill-color\": \"#2BB3E1\"\n     * // }\n     *\n     * // type simple for fill, line or circle type with array :\n     * // \"paint\": {\n     * //     \"line-dasharray\": [2,10]\n     * // }\n     *\n     * // TODO type complexe : not yet implemented !\n     * // \"paint\": {\n     * //     \"fill-color\": [\n     * //          \"match\",\n     * //          [\"get\",\"symbo\"],\n     * //          \"ZONE_BOISEE\",\"#A7DA81\",\n     * //          \"ZONE_MANGROVE\",\"#7E8AB5\",\n     * //          \"#A7DA81\"\n     * //      ]\n     * // }\n     *\n     * // other type complexe :\n     * // \"paint\": {\n     * //     \"fill-color\": {\n     * //        \"base\": 1,\n     * //        \"stops\": [\n     * //        [\n     * //          15.5,\n     * //         \"#f2eae2\"\n     * //        ],\n     * //        [\n     * //          16,\n     * //          \"#dfdbd7\"\n     * //        ]\n     * //        ]\n     * //     }\n     * // }\n     */\n    _getValue (value) {\n        var result = null;\n        if (typeof value === \"string\") {\n            result = value;\n        } else if (typeof value === \"number\") {\n            result = value;\n        } else if (Array.isArray(value)) {\n            // cas d'un tableau de valeurs numériques : [1,2,3]\n            var isNumber = true;\n            value.forEach(v => {\n                if (typeof v !== \"number\") {\n                    isNumber = false;\n                }\n            });\n            if (isNumber) {\n                result = value;\n            }\n        } else if (typeof value === \"object\") {\n            result = null;\n            if (\"stops\" in value) {\n                // on realise un ordre inversé sur les zooms\n                value.stops.sort((a, b) => {\n                    var numA = a[0];\n                    var numB = b[0];\n                    if (numA > numB) {\n                        return -1;\n                    }\n                    if (numA < numB) {\n                        return 1;\n                    }\n                    return 0;\n                });\n                // et, on prend le plus petit zoom\n                var lastStopsValue = value.stops.slice(-1);\n                result = lastStopsValue[0][1];\n            }\n        } else {\n            logger.warn(\"value not supported !\");\n        }\n        return result;\n    }\n\n    // ################################################################### //\n    // ######################### DOM methods ############################# //\n    // ################################################################### //\n    /**\n    * Create a Graphical Legend Icon\n    *\n    * @param {Object} params - param\n    * @param {String} params.title - title\n    * @param {String} params.type - fill, line, circle, text, icon, ...\n    * @param {String} params.values - {\"color\": \"#2BB3E1\", \"width\": 10, \"opacity\": 0.5, \"stroke\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line, fill and circle legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendRenderContainer\">\n    *       <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-fill\"\n    *           style=\"background: url(&quot;data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' fill='rgba(255, 255, 255, 1)' fill-opacity='1' /></svg>&quot;);\">\n    *       </div>\n    *       <span class=\"GPEditorMapBoxLegendTitle\">vide...</span>\n    * </div>\n    */\n    _createElementIconLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendrender;\n\n        var div = this.rendercontainer = document.createElement(\"div\");\n        div.className = this.name.legendrender;\n        if (params.edit) {\n            div.className += \" \";\n            div.className += this.name.legendeditable;\n            if (div.addEventListener) {\n                div.addEventListener(\"click\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            } else if (div.attachEvent) {\n                div.attachEvent(\"onclick\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            }\n        }\n\n        // type de legende\n        var type = params.type;\n\n        // TODO className\n        // div.className += \" legend-not-implemented\";\n        // ajout du style sur la div de rendu\n        if (this._renderThumbnail(type, params.values)) {\n            // className possibles :\n            // \" legend-text\"\n            // \" legend-icon\"\n            // \" legend-background\"\n            // \" legend-line\"\n            // \" legend-line-not-editable\"\n            // \" legend-circle\"\n            // \" legend-circle-not-editable\"\n            // \" legend-fill\"\n            // \" legend-fill-not-editable\"\n            div.className += (params.edit) ? \" legend-\" + type : \" legend-\" + type + \"-not-editable\";\n        } else {\n            div.className += \" legend-unknow\";\n        }\n\n        container.appendChild(div);\n\n        var span = document.createElement(\"span\");\n        span.className = this.name.legendtitle;\n        span.innerHTML = params.title || \"\";\n        container.appendChild(span);\n\n        return container;\n    }\n\n    /**\n    * Create a Graphical Legend Edition\n    *\n    * @param {Object} params - param\n    * @param {String} params.type - fill, line, (TODO : circle, icon or text)\n    * @param {String} params.values - {\"fill-color\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line and fill legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendToolsContainer\">\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-color\">Couleur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-width\">Epaisseur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-width\" title=\"\" type=\"range\" min=\"0\" max=\"10\" step=\"1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-opacity\">Opacité du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-color\">Couleur de remplissage</label>\n    *        <input class=\"legend-styling\" id=\"fill-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-opacity\">Opacité du remplissage</label>\n    *           <input class=\"legend-styling\" id=\"fill-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *   </div>\n    */\n    _createElementEditionLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendtools;\n\n        // uniquement les elements editables !\n        if (!params.edit) {\n            return container;\n        }\n\n        // on ne traite que l'edition du mode 'traits' ou 'surfaciques'\n        // mode 'line'\n        switch (params.type) {\n            case \"line\":\n                createLineColor.call(self);\n                createLineWidth.call(self);\n                createLineOpacity.call(self);\n                break;\n            case \"background\":\n            case \"fill\":\n                createFillColor.call(self);\n                createFillOpacity.call(self);\n                break;\n            default:\n                break;\n        }\n\n        // couleur du trait\n        function createLineColor () {\n            var linecolor = document.createElement(\"div\");\n            linecolor.className = \"legend-styling-div\";\n            var lLineColor = document.createElement(\"label\");\n            lLineColor.className = \"legend-line\";\n            lLineColor.htmlFor = this.id ? \"line-color-\" + this.id : \"line-color\";\n            lLineColor.innerHTML = this.labels[\"line-color\"];\n            var inputLineColor = document.createElement(\"input\");\n            inputLineColor.className = \"legend-styling\";\n            inputLineColor.id = this.id ? \"line-color-\" + this.id : \"line-color\";\n            inputLineColor.title = \"Selectionner une couleur de trait\";\n            inputLineColor.type = \"color\";\n            inputLineColor.value = params.values.color;\n            inputLineColor.setAttribute(\"data-id\", \"line-color\");\n            if (inputLineColor.addEventListener) {\n                inputLineColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineColor.attachEvent) {\n                inputLineColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linecolor.appendChild(lLineColor);\n            linecolor.appendChild(inputLineColor);\n            container.appendChild(linecolor);\n        }\n\n        // epaisseur du trait\n        function createLineWidth () {\n            var linewidth = document.createElement(\"div\");\n            linewidth.className = \"legend-styling-div\";\n            var lLineWidth = document.createElement(\"label\");\n            lLineWidth.className = \"legend-line\";\n            lLineWidth.htmlFor = this.id ? \"line-width-\" + this.id : \"line-width\";\n            lLineWidth.innerHTML = this.labels[\"line-width\"];\n            var inputLineWidth = document.createElement(\"input\");\n            inputLineWidth.className = \"legend-styling\";\n            inputLineWidth.id = this.id ? \"line-width-\" + this.id : \"line-width\";\n            inputLineWidth.title = params.values.width;\n            inputLineWidth.type = \"range\";\n            inputLineWidth.min = \"0\";\n            inputLineWidth.max = \"10\";\n            inputLineWidth.step = \"1\";\n            inputLineWidth.defaultValue = params.values.width;\n            inputLineWidth.setAttribute(\"data-id\", \"line-width\");\n            if (inputLineWidth.addEventListener) {\n                inputLineWidth.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineWidth.attachEvent) {\n                inputLineWidth.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linewidth.appendChild(lLineWidth);\n            linewidth.appendChild(inputLineWidth);\n            container.appendChild(linewidth);\n        }\n\n        // opacité du trait\n        function createLineOpacity () {\n            var lineopacity = document.createElement(\"div\");\n            lineopacity.className = \"legend-styling-div\";\n            var lLineOpacity = document.createElement(\"label\");\n            lLineOpacity.className = \"legend-line\";\n            lLineOpacity.htmlFor = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            lLineOpacity.innerHTML = this.labels[\"line-opacity\"];\n            var inputLineOpacity = document.createElement(\"input\");\n            inputLineOpacity.className = \"legend-styling\";\n            inputLineOpacity.id = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            inputLineOpacity.title = params.values.opacity;\n            inputLineOpacity.type = \"range\";\n            inputLineOpacity.min = \"0\";\n            inputLineOpacity.max = \"1\";\n            inputLineOpacity.step = \"0.1\";\n            inputLineOpacity.defaultValue = params.values.opacity;\n            inputLineOpacity.setAttribute(\"data-id\", \"line-opacity\");\n            if (inputLineOpacity.addEventListener) {\n                inputLineOpacity.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineOpacity.attachEvent) {\n                inputLineOpacity.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            lineopacity.appendChild(lLineOpacity);\n            lineopacity.appendChild(inputLineOpacity);\n            container.appendChild(lineopacity);\n        }\n\n        // couleur de remplissage\n        function createFillColor () {\n            var fillcolor = document.createElement(\"div\");\n            fillcolor.className = \"legend-styling-div\";\n            var lFillColor = document.createElement(\"label\");\n            lFillColor.className = \"legend-fill\";\n            lFillColor.htmlFor = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            lFillColor.innerHTML = this.labels[\"fill-color\"];\n            var inputFillColor = document.createElement(\"input\");\n            inputFillColor.className = \"legend-styling\";\n            inputFillColor.id = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            inputFillColor.title = \"Selectionner une couleur de remplissage\";\n            inputFillColor.type = \"color\";\n            inputFillColor.value = params.values.color;\n            inputFillColor.setAttribute(\"data-id\", \"fill-color\");\n            if (inputFillColor.addEventListener) {\n                inputFillColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillColor.attachEvent) {\n                inputFillColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillcolor.appendChild(lFillColor);\n            fillcolor.appendChild(inputFillColor);\n            container.appendChild(fillcolor);\n        }\n\n        // opacité du remplissage\n        function createFillOpacity () {\n            var fillopacity = document.createElement(\"div\");\n            fillopacity.className = \"legend-styling-div\";\n            var lFillOpacity = document.createElement(\"label\");\n            lFillOpacity.className = \"legend-fill\";\n            lFillOpacity.htmlFor = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            lFillOpacity.innerHTML = this.labels[\"fill-opacity\"];\n            var inputFillOpacity = document.createElement(\"input\");\n            inputFillOpacity.className = \"legend-styling\";\n            inputFillOpacity.id = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            inputFillOpacity.title = params.values.opacity;\n            inputFillOpacity.type = \"range\";\n            inputFillOpacity.min = \"0\";\n            inputFillOpacity.max = \"1\";\n            inputFillOpacity.step = \"0.1\";\n            inputFillOpacity.defaultValue = params.values.opacity;\n            inputFillOpacity.setAttribute(\"data-id\", \"fill-opacity\");\n            if (inputFillOpacity.addEventListener) {\n                inputFillOpacity.addEventListener(\"change\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillOpacity.attachEvent) {\n                inputFillOpacity.attachEvent(\"onchange\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillopacity.appendChild(lFillOpacity);\n            fillopacity.appendChild(inputFillOpacity);\n            container.appendChild(fillopacity);\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     *\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Is editable\n     *\n     * @returns {Boolean} - true/false\n     */\n    isEditable () {\n        return this.editable;\n    }\n\n    /**\n     * Get container Legend Render (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendRender legend-(line|fill|background|text|icon|circle|unknow)\" style=\"...\"></div>\n     */\n    getRenderContainer () {\n        return this.rendercontainer;\n    }\n\n    /**\n     * Get container Legend Tools (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     */\n    getToolsContainer () {\n        return this.toolscontainer;\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onclickedition\n     */\n    onEditionLegendMapBox (e) {\n        logger.trace(\"onEditionLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onclickedition, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onchangevalue\n     */\n    onChangeValueLegendMapBox (e) {\n        logger.trace(\"onChangeValueLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onchangevalue, e);\n    }\n\n};\n\n// ################################################################### //\n// ########################## CONSTANTES ############################# //\n// ################################################################### //\n\n/**\n * List of supported properties\n */\nLegend.PROPERTIES = {\n    line : [\n        \"line-color\",\n        \"line-dasharray\",\n        \"line-opacity\",\n        \"line-width\"\n    ],\n    fill : [\n        \"fill-color\",\n        \"fill-opacity\",\n        \"fill-outline-color\",\n        \"fill-pattern\"\n    ],\n    background : [\n        \"background-color\",\n        \"background-opacity\",\n        \"background-pattern\"\n    ],\n    circle : [\n        \"circle-color\",\n        \"circle-opacity\",\n        \"circle-stroke-color\",\n        \"circle-stroke-opacity\",\n        \"circle-stroke-width\"\n    ],\n    icon : [\n        \"icon-color\",\n        \"icon-image\",\n        \"icon-opacity\",\n        \"__icon-size\"\n    ],\n    text : [\n        \"__text-anchor\",\n        \"text-color\",\n        \"text-field\",\n        \"__text-font\",\n        \"__text-opacity\",\n        \"__text-size\"\n    ]\n};\n\nexport default Legend;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Legend = Legend;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Style from \"./Style\";\nimport Legend from \"./Legend\";\nimport Filter from \"./Filter\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-layer\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Layer\n * @param {Object} options - options for function call.\n * @example\n *   var layers = new Layer ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          \"visibility\" : true, // afficher l'icone de visibilité\n *          \"icon\" : {\n *              \"image\" : true, // afficher l'icone \"oeil\" (defaut) ou une checkbox\n *              \"anchor\" : \"start\" | \"end\"  // afficher l'icone au debut ou à la fin (defaut)\n *          },\n *          \"type\" : true,       // afficher l'icone du type de geometrie\n *          \"pin\" : true,        // afficher l'icone de puce\n *          \"remove\" : false,    // TODO afficher l'icone de suppression\n *          \"clone\" : false      // TODO afficher l'icone de duplication\n *      },\n *      obj : {\n *          \"id\": \"ocs - vegetation\", // MANDATORY\n *          \"type\": \"fill\", // OPTIONAL\n *          \"source\": \"pyramide_proto\", // OPTIONAL\n *          \"source-layer\": \"ocs_vegetation_surf\" // OPTIONAL\n *      }\n *   });\n *  layers.addLegend(oLegend);\n *  layers.slotLegend();\n *  layers.addStyle(oStyle);\n *  layers.addFilter(oFilter);\n *  layers.add();\n *  layers.active(false);\n *  layers.visibility(false);\n *  layers.display(false);\n *  layers.collapse();\n *  EventBus.addEventListener(\"editor:layer:onclickvisibility\", function (e) {\n *     // e.target.data : options !\n *     // e.target.editorID : id or null\n *   }, this);\n */\nclass Layer {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Layer\", options);\n\n        // options\n        this.options = options || {};\n\n        if (!(this instanceof Layer)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null; // null si le layer n'appartient pas à un editeur !\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            type : true,\n            pin : true,\n            remove : false, // TODO\n            clone : false // TODO\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        var _objDefault = {\n            id : \"\",\n            type : \"\", // icone sur le type de geometrie\n            source : \"\",\n            \"source-layer\" : \"\"\n        };\n\n        if (!this.options.obj) {\n            this.options.obj = _objDefault;\n        }\n\n        Utils.mergeParams(this.options.obj, _objDefault, false);\n\n        // legende intégrée\n        this.bSlotLegend = false;\n\n        // obj\n        this.oFilter = null;\n        this.oStyle = null;\n        this.oLegend = null;\n\n        // dom\n        this.container = null;\n        this.DomVisibility = null;\n        this.DomToggle = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLayerTarget\",\n            container : \"GPEditorMapBoxLayerContainer\",\n            containerlegend : \"GPEditorMapBoxLayerLegendContainer\",\n            containertitle : \"GPEditorMapBoxLayerTitleContainer\",\n            imagelabelinput : \"GPEditorMapBoxLayerImageInput\",\n            imagelabel : \"GPEditorMapBoxLayerImageLabel\",\n            typeimg : \"GPEditorMapBoxLayerTypeImage\",\n            titleinput : \"GPEditorMapBoxLayerTitleInput\",\n            titlelabel : \"GPEditorMapBoxLayerTitleLabel\",\n            containertools : \"GPEditorMapBoxToolsContainer\",\n            visibilityinput : \"GPEditorMapBoxToolsVisibilityInput\",\n            visibilitylabel : \"GPEditorMapBoxToolsVisibilityLabel\",\n            visibilityinputdisable : \"GPEditorMapBoxToolsVisibilityInputDisable\",\n            visibilitylabeldisable : \"GPEditorMapBoxToolsVisibilityLabelDisable\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * // >> Titre 1          |OOO| <- menu tools : visibility, clone, remove\n     * // >> Titre 2          |OXX| <- affichage configurable (cf. options.tools)\n     * // Event : clic sur le titre -> ex. affiche le menu des styles / filtres\n     * //       : clic visibility, clone, remove\n     * // DOM :\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-45\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <input id=\"GPEditorMapBoxLayerImageInput-45\" class=\"GPEditorMapBoxLayerImageInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\" for=\"GPEditorMapBoxLayerImageInput-45\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-45\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-45\" title=\"...\">...</label>\n     *          </div>\n     *          <div id=\"GPEditorMapBoxToolsContainer-45\" class=\"GPEditorMapBoxToolsContainer\">\n     *              <input id=\"GPEditorMapBoxToolsVisibilityInput-45\" type=\"checkbox\" class=\"GPEditorMapBoxToolsVisibilityInput\">\n     *              <label for=\"GPEditorMapBoxToolsVisibilityInput-45\" id=\"GPEditorMapBoxToolsVisibilityLabel-45\" class=\"GPEditorMapBoxToolsVisibilityLabel\" title=\"Afficher/masquer la couche\"></label>\n     *          </div>\n     *      </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // title\n        var divTitle = document.createElement(\"div\");\n        divTitle.id = this.name.containertitle + \"-\" + this.options.position;\n        divTitle.className = this.name.containertitle;\n\n        // puce\n        if (this.options.tools.pin) { // Optionnel !\n            // input\n            var inputImage = document.createElement(\"input\");\n            inputImage.id = this.name.imagelabelinput + \"-\" + this.options.position;\n            inputImage.className = this.name.imagelabelinput;\n            inputImage.type = \"checkbox\";\n            divTitle.appendChild(inputImage);\n            // puce\n            var labelImage = document.createElement(\"label\");\n            labelImage.className = this.name.imagelabel;\n            labelImage.htmlFor = inputImage.id;\n            if (labelImage.addEventListener) {\n                labelImage.addEventListener(\"click\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            } else if (labelImage.attachEvent) {\n                labelImage.attachEvent(\"onclick\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            }\n            divTitle.appendChild(labelImage);\n        }\n\n        // tools :\n        // visibility, (remove, clone)\n        var _addTools = function () {\n            var divTools = document.createElement(\"div\");\n            divTools.id = this.name.containertools + \"-\" + this.options.position;\n            divTools.className = this.name.containertools;\n\n            // visibility\n            if (this.options.tools.visibility) {\n                var inputTools = document.createElement(\"input\");\n                inputTools.id = this.name.visibilityinput + \"-\" + this.options.position;\n                inputTools.className = (this.options.tools.icon.image) ? this.name.visibilityinput : this.name.visibilityinputdisable;\n                inputTools.type = \"checkbox\";\n                inputTools.checked = \"checked\"; // par défaut, à modifier via visibility(true|false) !\n\n                // event for visibility change\n                if (inputTools.addEventListener) {\n                    inputTools.addEventListener(\"click\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                } else if (inputTools.attachEvent) {\n                    // internet explorer\n                    inputTools.attachEvent(\"onclick\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                }\n                divTools.appendChild(inputTools);\n                // enregistrement utile pour la méthode : visibility()\n                this.DomVisibility = inputTools;\n\n                var labelTools = document.createElement(\"label\");\n                labelTools.htmlFor = this.name.visibilityinput + \"-\" + this.options.position;\n                labelTools.id = this.name.visibilitylabel + \"-\" + this.options.position;\n                labelTools.className = (this.options.tools.icon.image) ? this.name.visibilitylabel : this.name.visibilitylabeldisable;\n                labelTools.title = \"Afficher/masquer la couche\";\n                divTools.appendChild(labelTools);\n\n                div.appendChild(divTools);\n            }\n\n            // clone\n            if (this.options.tools.clone) {\n                // TODO...\n                logger.warn(\"Dom for tools clone, it's not yet implemented !\");\n            }\n\n            // remove\n            if (this.options.tools.remove) {\n                // TODO...\n                logger.warn(\"Dom for tools remove, it's not yet implemented !\");\n            }\n        };\n\n        // ajout des outils au debut du composant\n        if (this.options.tools.icon.anchor === \"start\") {\n            _addTools.apply(this);\n        }\n\n        // type\n        if (this.options.tools.type && obj.type) { // Optionnel !\n            var imgType = document.createElement(\"img\");\n            imgType.className = this.name.typeimg;\n            // FIXME il faudrait faire la difference entre :\n            // - icone uniquement : SYMBOL-ICON\n            // - texte uniquement : SYMBOL-TEXT\n            // - les 2 : SYMBOL\n            // Mais il nous faut les styles complets (paint & layout)\n            // pour determiner les 3 types !\n            switch (obj.type.toUpperCase()) {\n                case \"SYMBOL-ICON\": // not used !\n                    imgType.style[\"background-position\"] = \"0px 0\";\n                    break;\n                case \"SYMBOL-TEXT\": // not used !\n                    imgType.style[\"background-position\"] = \"-194px 0\";\n                    break;\n                case \"SYMBOL\":\n                    imgType.style[\"background-position\"] = \"-84px 0\";\n                    break;\n                case \"LINE\":\n                    imgType.style[\"background-position\"] = \"-28px 0\";\n                    break;\n                case \"FILL\":\n                    imgType.style[\"background-position\"] = \"-56px 0\";\n                    break;\n                case \"BACKGROUND\":\n                    imgType.style[\"background-position\"] = \"-140px 0\";\n                    break;\n                case \"CIRCLE\":\n                    imgType.style[\"background-position\"] = \"-168px 0\";\n                    break;\n                default:\n                    // type inconnu ou non pris en charge ou par defaut\n                    imgType.style[\"background-position\"] = \"-112px 0\";\n            }\n            divTitle.appendChild(imgType);\n        }\n\n        // container legend (empty)\n        var divLegend = document.createElement(\"div\");\n        divLegend.id = this.name.containerlegend + \"-\" + this.options.position;\n        divLegend.className = this.name.containerlegend;\n        divTitle.appendChild(divLegend);\n\n        // input\n        var inputTitle = document.createElement(\"input\");\n        inputTitle.id = this.name.titleinput + \"-\" + this.options.position;\n        inputTitle.className = this.name.titleinput;\n        inputTitle.type = \"checkbox\";\n        divTitle.appendChild(inputTitle);\n\n        // label for\n        var labelTitle = document.createElement(\"label\");\n        labelTitle.className = this.name.titlelabel;\n        labelTitle.htmlFor = inputTitle.id;\n        labelTitle.innerHTML = obj[\"id\"] || obj[\"source-layer\"] || obj[\"source\"];\n        labelTitle.title = obj[\"source-layer\"] || obj[\"source\"] || obj[\"id\"];\n        if (labelTitle.addEventListener) {\n            labelTitle.addEventListener(\"click\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        } else if (labelTitle.attachEvent) {\n            labelTitle.attachEvent(\"onclick\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        }\n        divTitle.appendChild(labelTitle);\n        // enregistrement utile pour la méthode : collapse()\n        this.DomToggle = labelTitle;\n\n        div.appendChild(divTitle);\n\n        // ajout des outils au fin du composant\n        if (this.options.tools.icon.anchor === \"end\") {\n            _addTools.apply(this);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Layer instance\n     */\n    add () {\n        logger.trace(\"add()\");\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Add style in the submenu\n     *\n     * @param {Object} style - style object\n     */\n    addStyle (style) {\n        logger.trace(\"addStyle()\", style);\n        if (style && typeof style === \"object\" && style instanceof Style) {\n            this.oStyle = style;\n            this.oStyle.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add filter in the submenu\n     *\n     * @param {Object} filter - filter object\n     */\n    addFilter (filter) {\n        logger.trace(\"addFilter()\", filter);\n        if (filter && typeof filter === \"object\" && filter instanceof Filter) {\n            this.oFilter = filter;\n            this.oFilter.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add Legend in the submenu\n     *\n     * @param {Object} legend - legend object\n     */\n    addLegend (legend) {\n        logger.trace(\"addLegend()\", legend);\n        if (legend && typeof legend === \"object\" && legend instanceof Legend) {\n            this.oLegend = legend;\n            this.oLegend.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Integrate Legend to the layer container\n     */\n    slotLegend () {\n        // cas particulier :\n        // on souhaite intégrer une partie de la legende dans le container du layer.\n        var legend = this.oLegend;\n        if (legend) {\n            // FIXME c'est pourri...\n            var node = null;\n            var nodesLvl1 = this.container.childNodes;\n            if (nodesLvl1.length) {\n                // selon où se situe l'icone de visibilité : au debut ou à la fin...\n                var idx = (this.options.tools.icon.anchor === \"start\") ? 1 : 0;\n                var nodesLvl2 = nodesLvl1[idx].childNodes;\n                // on recherche le container de la legende\n                for (var i = 0; i < nodesLvl2.length; i++) {\n                    var curnode = nodesLvl2[i];\n                    if (curnode.id.indexOf(this.name.containerlegend) !== -1) {\n                        node = curnode;\n                    }\n                }\n            }\n            if (node) {\n                var render = legend.getRenderContainer();\n                if (render) {\n                    node.appendChild(render);\n                    // legende intégrée\n                    this.bSlotLegend = true;\n                }\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Set visibility or get\n     *\n     * @param {Boolean} display - set visibility or undefined to get status\n     * @returns {Boolean} - true/false\n     */\n    visibility (display) {\n        logger.trace(\"visibility()\", display);\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        if (typeof display !== \"undefined\") {\n            this.DomVisibility.checked = (display) ? \"checked\" : \"\";\n        }\n        return this.DomVisibility.checked;\n    }\n\n    /**\n    * Collapse a layer panel (event)\n    */\n    collapse () {\n        logger.trace(\"collapse()\");\n        this.DomToggle.click();\n    }\n\n    /**\n    * Click on visibility icon (event)\n    */\n    visible () {\n        logger.trace(\"visible()\");\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        this.DomVisibility.click();\n    }\n\n    /**\n     * Set collapse or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        var checked = document.getElementById(this.DomToggle.htmlFor).checked;\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"inline-flex\" : \"none\";\n            if (this.oStyle) {\n                this.oStyle.display(display && checked);\n            }\n            if (this.oFilter) {\n                this.oFilter.display(display && checked);\n            }\n            if (this.oLegend) {\n                this.oLegend.display(display && checked);\n            }\n        }\n        return checked;\n    }\n\n    /**\n     * Set disabled/enabled status or get\n     *\n     * @param {Boolean} active - disable/enable layer interaction or get status\n     * @returns {Boolean} - true/false\n     */\n    active (active) {\n        logger.trace(\"active()\", active);\n        if (typeof active !== \"undefined\") {\n            this.container.className = (active)\n                ? this.name.container\n                : this.name.container + \" disabled\";\n        }\n        return (this.container.className === this.name.container);\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onClickLayerMapBox (e) {\n        logger.trace(\"onClickLayerMapBox\", e);\n\n        var id = e.target.htmlFor.substring(e.target.htmlFor.indexOf(\"-\"));\n        var checked = document.getElementById(e.target.htmlFor).checked;\n\n        // gestion des inputs\n        if (e.target.htmlFor === this.name.imagelabelinput + id) {\n            document.getElementById(this.name.titleinput + id).checked = !checked;\n        }\n        if (e.target.htmlFor === this.name.titleinput + id) {\n            // si options.pin:false, ce DOM n'existe pas !\n            if (document.getElementById(this.name.imagelabelinput + id)) {\n                document.getElementById(this.name.imagelabelinput + id).checked = !checked;\n            }\n        }\n\n        // ouverture du panneau des styles / filtres\n        if (this.oStyle) {\n            this.oStyle.display(!checked);\n        }\n        if (this.oFilter) {\n            this.oFilter.display(!checked);\n        }\n        // attention,\n        // si la legende est non editable, elle ne se trouve pas dans le sous menu !\n        if (this.oLegend && this.oLegend.isEditable()) {\n            this.oLegend.display(!checked);\n        }\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickvisibility\n     */\n    onVisibilityLayerMapBox (e) {\n        logger.trace(\"onVisibilityLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickvisibility, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickclone\n     */\n    onCloneLayerMapBox (e) {\n        logger.trace(\"onCloneLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickclone, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickremove\n     */\n    onRemoveLayerMapBox (e) {\n        logger.trace(\"onRemoveLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickremove, e);\n    }\n\n};\n\nexport default Layer;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Layer = Layer;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-group\");\n\n/**\n * @classdesc\n *\n * MapBox group management\n *\n * @constructor\n * @alias ol.style.editor.Group\n * @param {Object} options - options for function call.\n * @example\n *   var group = new Group ({\n *      title : \"MyGroup\",\n *      collapse : true, // plier/deplier\n *      target : ...\n *   });\n *   group.add();\n *   group.add();\n */\nclass Group {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Group\", options);\n\n        // options\n        this.options = options || {\n            // default...\n        };\n\n        if (!(this instanceof Group)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.title) {\n            // cf. summary\n            this.options.title = \"Détails du groupe...\";\n        }\n\n        // plier par defaut\n        if (typeof this.options.collapse === \"undefined\") {\n            this.options.collapse = true;\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxGroupTarget\",\n            container : \"GPEditorMapBoxGroupContainer\",\n            details : \"GPEditorMapBoxGroupDetails\",\n            summary : \"GPEditorMapBoxGroupSummary\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxGroupContainer\">...</div>\n     */\n    _initContainer () {\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // FIXME pas compatible IE !\n        // https://caniuse.com/#search=details\n        // cf. https://css-tricks.com/quick-reminder-that-details-summary-is-the-easiest-way-ever-to-make-an-accordion/\n        var details = document.createElement(\"details\");\n        details.className = this.name.details;\n        details.open = !this.options.collapse;\n        div.appendChild(details);\n\n        var summary = document.createElement(\"summary\");\n        summary.className = this.name.summary;\n        summary.innerHTML = this.options.title;\n        details.appendChild(summary);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"flex\" : \"none\";\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        var nodes = this.container.childNodes;\n        if (nodes.length) {\n            // retourne le noeud \"details\" !\n            return nodes[0];\n        }\n        // sinon le container principal\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * NOT USED !\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Group#editor:group:oncollapse\n     */\n    onCollapseGroupMapBox (e) {\n        logger.trace(\"onCollapseGroupMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.group.oncollapse, e);\n    }\n\n};\n\nexport default Group;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-search\");\n\n/**\n * @classdesc\n *\n * TODO MapBox search management\n *\n * @constructor\n * @alias ol.style.editor.Search\n * @param {Object} options - options for function call.\n * @todo\n * @example\n *   var Search = new Search ({\n *      target : ...,\n *      tools : {\n *          // ...\n *      }\n *      title : \"Filtres de recherche :\",\n *      obj : {}\n *   });\n *  Search.add();\n *  Search.display(true);\n *  Search.getContainer();\n */\nclass Search {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Search\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Search)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {};\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {};\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"Recherche de couches :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxSearchTarget\",\n            container : \"GPEditorMapBoxSearchContainer\"\n            // TODO ...\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxSearchContainer\">\n     *  // ...\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        // var self = this;\n        var _search = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        if (_search.layers) {\n            if (_search.layers.length === 0) {\n                logger.info(\"tag 'layers' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // TODO...\n        // outil de recherche des couches mapbox.\n        // 2 modes de recherches : exact ou par autocompletion\n        // affichage des resultats directement dans la liste des couches\n        // la recherche porte sur les champs suiavnts (options):\n        // * id (par defaut)\n        // * source-layer (par defaut)\n        // * type (ex. Symbol)\n        // * field (ex. HOPITAL_PONC) > recherche dans le champs filtre\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Search instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onsubmit\n     */\n    onSubmitSearchLayersMapBox (e) {\n        logger.trace(\"onSubmitSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onsubmit, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onautocomplete\n     */\n    onAutocompleteSearchLayersMapBox (e) {\n        logger.trace(\"onAutocompleteSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onautocomplete, e);\n    }\n\n};\n\nexport default Search;\n","var EditorDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    }\n};\n\nexport default EditorDOM;\n","// import CSS\nimport \"../../CSS/Controls/Editor/GPFeditor.css\";\n// import \"../../CSS/Controls/Editor/GPFeditorStyle.css\";\n// import library\nimport EventBus from \"eventbusjs\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Style from \"./Style\";\nimport Themes from \"./Themes\";\nimport Filter from \"./Filter\";\nimport Legend from \"./Legend\";\nimport Layer from \"./Layer\";\nimport Group from \"./Group\";\nimport Event from \"./Event\";\nimport Search from \"./Search\";\n\n// DOM\nimport EditorDOM from \"./EditorDOM\";\n\nvar logger = Logger.getLogger(\"editor\");\n\n/**\n * @classdesc\n *\n * Editor Styles MapBox...\n *\n * @constructor\n * @alias ol.style.Editor\n * @param {Object} options - options for function call.\n * @fires editor:layer:onclickvisibility\n * @fires editor:layer:onclickclone\n * @fires editor:layer:onclickremove\n * @fires editor:style:oneditjson\n * @fires editor:style:scale:onchangemin\n * @fires editor:style:scale:onchangemax\n * @fires editor:legend:onclickedition\n * @fires editor:legend:onchangevalue\n * @fires editor:filter:oneditjson\n * @fires editor:themes:onclickimage\n * @fires editor:themes:onclicktitle\n * @fires editor:group:oncollapse\n * @fires editor:onloaded\n * @example\n *   var editor = new Editor ({\n *      target : \"\",\n *      style : \"data/styles/layer.json\",\n *      themes: {\n *          themesSummary : \"\",\n *          themes : [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *      },\n *      scope : this,\n *      events : {\n *          \"editor:layer:onclickvisibility\" : ...,\n *          \"editor:layer:onclickclone\" : ...,\n *          \"editor:layer:onclickremove\" : ...,\n *          \"editor:style:oneditjson\" : ...,\n *          \"editor:style:scale:onchangemin\" : ...,\n *          \"editor:style:scale:onchangemax\" : ...,\n *          \"editor:filter:oneditjson\" : ...,\n *          \"editor:themes:onclickimage\" : this._onClickEventImageTheme(),\n *          \"editor:themes:onclicktitle\" : function(e) {...}\n *      },\n *      tools : {\n *          // afficher/cacher les themes (par defaut) ou utiliser les options\n *          themes : true | false | {\n *              target : \"...\",\n *              tools : {\n *                  \"thumbnails\": true,\n *                  \"button\": { visible : true, type : \"checkbox\" }\n *              },\n *          },\n *          layers : true | false,     // afficher les couches (layers)\n *          search : true | false,     // TODO : afficher l'outil de recheche de couches\n *          style : true | false,      // afficher les styles (sous menu layers)\n *          filter : true | false,     // afficher les filtres (sous menu layers)\n *          legend : true | false,     // afficher les legendes (layers)\n *          group : true | false,      // grouper les couches, l'option 'sort' doit être activée (layers)\n *          groupAuto : true | false,  // definir la construction automatiques des groupes\n *          sort : true | false,       // trier les couches (layers)\n *          sortBy : \"id|class|geom\",  // definir le type de tri (layers)\n *          sortOrder : \"asc, desc\",   // definir l'ordre de tri (layers)\n *          title : true | false       // afficher les titres des rubriques,\n *          collapse : true | false | undefined // afficher et/ou plier les couches ou ne pas afficher l'option,\n *          type : true | false,       // afficher le type de geometrie (layers)\n *          pin : true | false,        // afficher la puce pour chaque couche (layers)\n *          visibility : true | false, // afficher l'icone de visibilité (layers),\n *          icon : {                   // afficher l'icone \"oeil\" ou \"checkbox\" (layers),\n *              \"image\" : true,\n *              \"anchor\" : \"start\" // afficher l'icone au debut ou à la fin de la ligne\n *          },\n *          editable : true | false    // active l'edition de la legende (legendes)\n *      }\n *   });\n *   // options par defaut\n *   {\n *      themes : false,\n *      layers : true,\n *      search : false,\n *      style : false,\n *      filter : false,\n *      legend : false,\n *      group : false,\n *      groupAuto : false,\n *      sort : true,\n *      sortBy : \"id\",\n *      sortOrder : \"asc\",\n *      title : true,\n *      collapse : undefined,\n *      type : true,\n *      pin : true,\n *      visibility : true,\n *      icon : {\n *          image : true,\n *          anchor : \"end\"\n *      },\n *      editable : true\n *   }\n *   // Context\n *   editor.setContext(\"map\", map);\n *   editor.setContext(\"layer\", layer);\n *   // create DOM\n *   editor.createElement()\n *     .then(() => {\n *       console.warn(editor.getID());\n *       console.log(this.getContext(\"map\"));\n *       console.log(this.getContext(\"layer\"));\n *     })\n *     .catch(error => {});\n *   // possibility to add listeners with globale variable : eventbus\n *   eventbus.addEventListener(\"editor:style:scale:onchangemin\", function (e) {...});\n */\nclass Editor {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Editor\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Editor)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // gestion des options\n        if (!this.options.target) {\n            logger.info(\"La 'target' n'est pas renseignée (options.target).\");\n        }\n\n        if (!this.options.style) {\n            logger.error(\"Le 'style' MapBox n'est pas renseigné (options.style) !\");\n            return;\n        }\n\n        if (this.options.events) {\n            this._initEvents();\n        } else {\n            logger.warn(\"Les 'handlers' ne sont pas renseignés (options.events) !\");\n        }\n\n        if (!this.options.themes) {\n            logger.info(\"Les 'themes' MapBox ne sont pas renseignés (options.themes).\");\n        }\n\n        // options par defaut\n        var _toolsDefault = {\n            themes : false,\n            layers : true,\n            search : false,\n            style : false,\n            filter : false,\n            legend : false,\n            group : false,\n            groupAuto : false,\n            sort : true,\n            sortBy : \"id\",\n            sortOrder : \"asc\",\n            title : true,\n            collapse : undefined,\n            type : true,\n            pin : true,\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            editable : true\n        };\n\n        if (!this.options.tools) {\n            logger.trace(\"Utilisation des outils MapBox par défaut (options.tools).\");\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        // id unique\n        this.id = this.options.id || ID.generate();\n\n        // context\n        this.context = {};\n        // property layers\n        this.layers = [];\n        // dom container\n        this.container = null;\n        // dom name\n        this.name = {\n            target : \"GPEditorMapBoxTarget\",\n            container : \"GPEditorMapBoxContainer\",\n            containerID : \"GPEditorMapBoxContainer_ID_\",\n            containerLayers : \"GPEditorMapBoxLayersContainer\",\n            titleLayers : \"GPEditorMapBoxLayersTitle\",\n            titleLayersID : \"GPEditorMapBoxLayersTitle_ID_\",\n            titleThemes : \"GPEditorMapBoxThemesTitle\",\n            titleThemesID : \"GPEditorMapBoxThemesTitle_ID_\",\n            sep : \"GPEditorMapBoxSep\"\n        };\n        // style json\n        this.mapbox = {};\n        // INFO\n        // sprites :\n        // {\n        //     url : null,\n        //     size : {\n        //         h : null,\n        //         w : null\n        //     },\n        //     json : {}\n        // }\n        this.sprites = {};\n    }\n\n    /**\n    * Initialize events with handlers\n    * (called by constructor)\n    *\n    * List Events :\n    *          \"editor:layer:visibility\"\n    *          \"editor:layer:clone\"\n    *          \"editor:layer:remove\"\n    *          \"editor:style:edit\"\n    *          \"editor:style:minScale\"\n    *          \"editor:style:maxScale\"\n    *          \"editor:filter:edit\"\n    *          \"editor:themes:image\",\n    *          \"editor:themes:title\"\n    * @private\n    */\n    _initEvents () {\n        var ctx = this.options.scope || this;\n        var events = this.options.events;\n        if (events) {\n            for (var event in events) {\n                if (events.hasOwnProperty(event)) {\n                    var handler = events[event];\n                    // test sur les events disponibles !\n                    if (handler) {\n                        if (!EventBus.hasEventListener(event, handler, ctx)) {\n                            EventBus.addEventListener(event, handler, ctx);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @example\n     *  <div class=\"GPEditorMapBoxContainer\" id=\"GPEditorMapBoxContainer_ID_0\">\n     *    <div id=\"GPEditorMapBoxThemesTitle\" class=\"GPEditorMapBoxThemesTitle\">Liste des 'thèmes'</div>\n     *    <div class=\"GPEditorMapBoxThemesContainer\">\n     *      ...\n     *    </div>\n     *    <div id=\"GPEditorMapBoxLayersTitle\" class=\"GPEditorMapBoxLayersTitle\">Liste des 'couches'</div>\n     *    <div class=\"GPEditorMapBoxLayersContainer\">\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-0_1\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-0_1\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-0_1\" title=\"states\">population_lt_2m</label>\n     *          </div>\n     *      </div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *    </div>\n     *  </div>\n     * @private\n     */\n    _initContainer () {\n        logger.trace(this.mapbox);\n\n        // existance d'un autre container (editeur) ?\n        // var _idx = 0;\n        // var elements = document.querySelectorAll(\"div[id^=\" + this.name.containerID + \"]\");\n        // for (var j = 0; j < elements.length; j++) {\n        //     var element = elements[j];\n        //     var num = parseInt(element.id.substring(element.id.lastIndexOf(\"_\") + 1), 10);\n        //     if (num > _idx) {\n        //         _idx = num;\n        //     }\n        // }\n        // if (elements.length) {\n        //     _idx += 1;\n        // }\n        // container principal de l'editeur\n        var div = document.createElement(\"div\");\n        div.id = this.name.containerID + this.id;\n        div.className = this.name.container;\n\n        // Themes\n        var _toolsThemes = this.options.tools.themes;\n        if (_toolsThemes && this.options.themes) {\n            // title\n            if (this.options.tools.title) {\n                var titleThemes = document.createElement(\"div\");\n                titleThemes.id = this.name.titleThemesID + this.id;\n                titleThemes.className = this.name.titleThemes;\n                titleThemes.innerHTML = \"Liste des 'thèmes'\";\n                div.appendChild(titleThemes);\n            }\n\n            // lien vers les styles\n            var themes = new Themes({\n                id : this.id,\n                target : div,\n                tools : (typeof _toolsThemes === \"object\") ? _toolsThemes : {},\n                obj : this.options.themes\n            });\n            themes.add();\n        }\n\n        // TODO : Recheche / filtre de couches\n        if (this.options.tools.search) {\n            var search = new Search({\n                id : this.id,\n                target : div,\n                tools : {},\n                obj : this.mapbox.layers // liste des objets layers\n            });\n            search.add();\n        }\n\n        for (var source in this.mapbox.sources) {\n            if (this.mapbox.sources.hasOwnProperty(source)) {\n                if (this.options.tools.layers) {\n                    // multisources ? Si oui, on renseigne un titre...\n                    var multisources = (Object.keys(this.mapbox.sources).length > 1) ? 1 : 0;\n                    if (multisources) {\n                        var hr = document.createElement(\"hr\");\n                        hr.className = this.name.sep;\n                        div.appendChild(hr);\n                    }\n                    // title\n                    if (this.options.tools.title) {\n                        var titleLayers = document.createElement(\"div\");\n                        titleLayers.id = this.name.titleLayersID + this.id;\n                        titleLayers.className = this.name.titleLayers;\n                        titleLayers.innerHTML = (multisources) ? \"Liste des 'couches' (\" + source + \")\" : \"Liste des 'couches'\";\n                        div.appendChild(titleLayers);\n                    }\n                }\n\n                // gestion de l'ordre avant tri avec la metadata 'order'\n                var _layers = this.mapbox.layers.slice(); // clone\n\n                // une fois les layers triés, la metadata:geoportail:order permet\n                // de savoir l'emplacement du layers dans le fichier de style.\n                _layers.forEach(function (layer, order) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // ajout de la metadata d'ordre\n                    var _metadata = layer[\"metadata\"];\n                    if (_metadata) {\n                        _metadata[\"geoportail:order\"] = order;\n                    } else {\n                        layer[\"metadata\"] = {\n                            \"geoportail:order\" : order\n                        };\n                    }\n                });\n                // tri des layers\n                if (this.options.tools.sort) {\n                    var sortBy = this.options.tools.sortBy;\n                    var sortOrder = this.options.tools.sortOrder;\n                    var sortFct = function (a, b) {\n                        // si on utilise les groupements utilisateurs, ils doivent\n                        // tous être renseignés sinon..., ça va coincer !\n                        var result = 0;\n                        if (a[\"metadata\"] &&\n                            a[\"metadata\"][\"geoportail:group\"] &&\n                            b[\"metadata\"] &&\n                            b[\"metadata\"][\"geoportail:group\"]) {\n                            var cmpA = null;\n                            var cmpB = null;\n                            cmpA = a[\"metadata\"][\"geoportail:group\"];\n                            cmpB = b[\"metadata\"][\"geoportail:group\"];\n                            result = cmpA.localeCompare(cmpB);\n                        } else {\n                            switch (sortBy) {\n                                case \"geom\":\n                                    result = sortOrder === \"asc\" ? a.type.localeCompare(b.type) || a.id.localeCompare(b.id)\n                                        : b.type.localeCompare(a.type) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"class\":\n                                    result = sortOrder === \"asc\" ? a[\"source-layer\"].localeCompare(b[\"source-layer\"]) || a.id.localeCompare(b.id)\n                                        : b[\"source-layer\"].localeCompare(a[\"source-layer\"]) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"id\":\n                                default:\n                                    // tri sur l'id par defaut\n                                    result = sortOrder === \"asc\" ? a.id.localeCompare(b.id) : b.id.localeCompare(a.id);\n                                    break;\n                            }\n                        }\n                        return result;\n                    };\n\n                    _layers.sort(sortFct);\n                }\n\n                logger.trace(\"Layers : \", _layers);\n\n                // gestion des groupes avec la metadata de groupe\n                var groupBy = this.options.tools.sortBy; // le même type de tri que les couches !\n                var groupAuto = this.options.tools.groupAuto;\n                var _groups = {}; // liste et comptage des layers dans chaque groupes\n                _layers.forEach(function (layer) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // balise metadata\n                    var _metadata = layer[\"metadata\"];\n                    // s'il existe déjà une meta de groupe, on l'utilise...\n                    // sinon, on la met en place.\n                    if (_metadata && _metadata[\"geoportail:group\"]) {\n                        var _groupName = _metadata[\"geoportail:group\"];\n                        _groups[_groupName] = (_groups[_groupName])\n                            ? _groups[_groupName] + 1 : 1;\n                    } else {\n                        var _field = null;\n                        switch (groupBy) {\n                            case \"class\":\n                                _field = layer[\"source-layer\"];\n                                break;\n                            case \"geom\":\n                                _field = layer.type;\n                                break;\n                            case \"id\":\n                            default:\n                                _field = layer.id;\n                                break;\n                        }\n                        var _newGroupName = _field;\n                        if (groupAuto) {\n                            // separateur\n                            var _regex = /_|-|:|=/; // TODO à definir via une option !\n\n                            // index\n                            var _idx = _field.search(_regex);\n                            // y'a t il un separateur ?\n                            _newGroupName = (_idx !== -1) ? _field.substring(0, _idx).trim() : _field;\n                        }\n                        // on compte le nombre d'entrée dans un groupe\n                        _groups[_newGroupName] = (_groups[_newGroupName])\n                            ? _groups[_newGroupName] + 1 : 1;\n\n                        // ajout de la metadata de groupe\n                        if (_metadata) {\n                            _metadata[\"geoportail:group\"] = _newGroupName;\n                        } else {\n                            layer[\"metadata\"] = {\n                                \"geoportail:group\" : _newGroupName\n                            };\n                        }\n                    }\n                });\n\n                logger.trace(\"Groups : \", _groups);\n\n                // container principal des couches\n                var divLayers = document.createElement(\"div\");\n                divLayers.className = this.name.containerLayers;\n                div.appendChild(divLayers);\n\n                var details;\n                if (this.options.tools.collapse !== undefined) {\n                    details = document.createElement(\"details\");\n                    details.className = \"\";\n                    details.open = !this.options.tools.collapse;\n                    divLayers.appendChild(details);\n\n                    var summary = document.createElement(\"summary\");\n                    summary.className = \"\";\n                    summary.innerHTML = \"\";\n                    details.appendChild(summary);\n                }\n\n                // container courant (cf. groupe) pour l'ajout des elements\n                var target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n\n                // Ex. Layers, Styles, Groups et Filtres\n                //  \"id\": \"ocs - vegetation\",\n                //  \"type\": \"fill\",\n                //  \"source\": \"pyramide_proto\",\n                //  \"source-layer\": \"ocs_vegetation_surf\",\n                //  \"metadata\" : {\n                //      \"geoportail:group\": \"ocs\"\n                //  },\n                //  \"layout\": {\n                //    \"visibility\": \"visible\"\n                //  },\n                //  \"filter\": [\"in\",\"symbo\",\n                //      \"SURFACE_D_EAU\",\n                //      \"BASSIN\",\n                //      \"ZONE_MARINE\"\n                //  ],\n                //  \"paint\": {\n                //    \"fill-color\": \"#2BB3E1\"\n                //  }\n                var index = -1;\n                for (var ii = 0; ii < _layers.length; ii++) {\n                    var data = _layers[ii];\n                    index++;\n\n                    // traitement dans l'ordre des sources\n                    if (data.source === source) {\n                        // Groups\n                        // INFO la gestion des groupes est basée sur la balise metadata::geoportail:group\n                        // ainsi que sur l'ordre des couches.\n                        // il n'y a pas de regroupement sans tri des couches !\n                        if (this.options.tools.group && this.options.tools.sort) {\n                            var mtd = data.metadata;\n                            // creation du container de groupe\n                            // si le tag metadata existe\n                            if (mtd) {\n                                var grp = data.metadata[\"geoportail:group\"];\n                                if (grp) {\n                                    // le groupe doit contenir plus d'un element\n                                    if (_groups[grp] > 1) {\n                                        // le groupe est déjà créé, on en veut plus par la suite...\n                                        _groups[grp] = -1;\n                                        // creation du groupe\n                                        var oGroup = new Group({\n                                            id : this.id,\n                                            target : (this.options.tools.collapse !== undefined) ? details : divLayers,\n                                            title : grp,\n                                            collapse : true\n                                        });\n                                        oGroup.add();\n                                        // le nouveau container pour les elements suivants\n                                        target = oGroup.getContainer();\n                                    } else if (_groups[grp] === 1) {\n                                        // l'element est seul, donc pas d'ajout dans le\n                                        // groupe en cours\n                                        target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                    } else {\n                                        // on ajoute l'element dans le groupe courant...\n                                    }\n                                } else {\n                                    target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                }\n                            } else {\n                                target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                            }\n                        }\n                        // Layers\n                        if (this.options.tools.layers) {\n                            var oLayer = new Layer({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !\n                                tools : {\n                                    visibility : this.options.tools.visibility,\n                                    icon : this.options.tools.icon,\n                                    type : this.options.tools.type,\n                                    pin : this.options.tools.pin\n                                },\n                                obj : {\n                                    id : data.id,\n                                    type : data.type,\n                                    source : data.source,\n                                    \"source-layer\" : data[\"source-layer\"]\n                                }\n                            });\n                            oLayer.add();\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                            // sauvegarde des layers\n                            this.layers.push(oLayer);\n                        }\n                        // Legende\n                        if (this.options.tools.legend) {\n                            // gestion de l'edition de la legende :\n                            // l'option \"editable\" est prioritaire sur le tag \"editable\" du fichier de style !\n                            var isEditable = this.options.tools.editable;\n                            if (typeof isEditable === \"undefined\") {\n                                isEditable = data.editable;\n                            }\n                            var oLegend = new Legend({\n                                id : this.id,\n                                target : target,\n                                sprites : this.sprites,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    title : data.id,\n                                    editable : (typeof isEditable !== \"undefined\") ? isEditable : false,\n                                    paint : data.paint,\n                                    layout : data.layout\n                                }\n                            });\n                            oLegend.add();\n                            oLegend.display(false);\n                            if (oLayer) {\n                                oLayer.addLegend(oLegend);\n                                oLayer.slotLegend(); // integration de la legende dans le container du layers !\n                            }\n                        }\n                        // Style\n                        if (this.options.tools.style) {\n                            var oStyle = new Style({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    layout : data.layout,\n                                    paint : data.paint\n                                }\n                            });\n                            oStyle.add();\n                            oStyle.display(false);\n                            if (oLayer) {\n                                oLayer.addStyle(oStyle);\n                            }\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                        }\n                        // Filter\n                        if (this.options.tools.filter) {\n                            var oFilter = new Filter({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    filter : data.Filter\n                                }\n                            });\n                            oFilter.add();\n                            oFilter.display(false);\n                            if (oLayer) {\n                                oLayer.addFilter(oFilter);\n                            }\n                        }\n                    } else {\n                        // on ecarte un layer car il n'est pas reconnu dans la source\n                        // on decremente la position du layer\n                        if (index >= 0) {\n                            index--;\n                        }\n                    }\n                }\n            }\n        }\n\n        // sauvegarde\n        this.container = div;\n\n        // container principal\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var _target = document.createElement(\"div\");\n                _target.id = this.name.target;\n                var node = document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0] ||\n                    document.documentElement;\n                node.appendChild(_target);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        // dispatch event\n        EventBus.dispatch(Event.onloaded, this);\n    }\n\n    /**\n     * Getting Sprites informations\n     * (called by _initialize)\n     *\n     * @param {String} sprites - url des sprites\n     * @returns {Promise} - promise\n     * @private\n     */\n    _getSprites (sprites) {\n        var self = this;\n\n        // on ne doit pas mettre de promise en échec...\n        // car on souhaite continuer le traitement même si on n'a pas de sprites !\n        // si le protocole est mapbox://\n        if (sprites && sprites.startsWith(\"mapbox://\")) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Protocole mapbox:// non géré !\");\n                resolve(self);\n            });\n        }\n        // si pas de sprites\n        if (!sprites) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Auncun sprites disponibles !\");\n                resolve(self);\n            });\n        }\n\n        var fetchSpritesImage = function () {\n            var spritesImage = sprites + \".png\";\n            return fetch(spritesImage, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.blob()\n                            .then(function (blob) {\n                                self.sprites.url = spritesImage;\n                                // decode de l'image\n                                var theImage = new Image();\n                                theImage.src = spritesImage;\n                                return theImage.decode()\n                                    .then(function () {\n                                        self.sprites.size = {};\n                                        self.sprites.size.h = theImage.height;\n                                        self.sprites.size.w = theImage.width;\n                                    });\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch image sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch image sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n        var fetchSpritesJson = function () {\n            var spritesJson = sprites + \".json\";\n            return fetch(spritesJson, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.json()\n                            .then(function (json) {\n                                self.sprites.json = json;\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch json sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch json sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n\n        // promise\n        return Promise.all([\n            fetchSpritesImage(),\n            fetchSpritesJson()\n        ]);\n    }\n\n    // ################################################################### //\n    // ########################## INTERFACE ############################## //\n    // ################################################################### //\n    /**\n     * Create Editor\n     *\n     * @returns {Promise} - promise\n     */\n    createElement () {\n        var self = this;\n        // objet json\n        if (typeof this.options.style === \"object\") {\n            this.mapbox = this.options.style;\n            // les sprites sont utiles que si on veut une legende !\n            if (this.options.tools.legend) {\n                return this._getSprites(this.mapbox.sprite)\n                    .then(function () {\n                        // init du DOM\n                        self._initContainer();\n                        return self;\n                    })\n                    .catch(error => {\n                        logger.warn(\"fetch sprites exception :\", error);\n                    });\n            } else {\n                return new Promise((resolve, reject) => {\n                    self._initContainer();\n                    resolve(self);\n                });\n            }\n        }\n\n        // url\n        if (typeof this.options.style === \"string\") {\n            return fetch(this.options.style, {\n                credentials : \"same-origin\"\n            })\n                .then(response => {\n                    // sauvegarde du json\n                    return response.json()\n                        .then(style => {\n                            self.mapbox = style;\n                        })\n                        .then(function () {\n                            // les sprites sont utiles que si on veut une legende !\n                            if (self.options.tools.legend) {\n                                return self._getSprites(self.mapbox.sprite)\n                                    .then(function () {\n                                        // init du DOM\n                                        self._initContainer();\n                                        return self;\n                                    })\n                                    .catch(error => {\n                                        logger.warn(\"fetch sprites exception :\", error);\n                                    });\n                            } else {\n                                return new Promise((resolve, reject) => {\n                                    self._initContainer();\n                                    resolve(self);\n                                });\n                            }\n                        })\n                        .catch(error => {\n                            logger.error(\"json exception :\", error);\n                        });\n                })\n                .catch(error => {\n                    logger.error(\"fetch exception :\", error);\n                });\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"block\" : \"none\";\n    }\n\n    setContext (key, value) {\n        this.context[key] = value;\n    }\n\n    getContext (key) {\n        return this.context[key];\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Get id editor\n     * @returns {Number} id\n     */\n    getID () {\n        return this.id;\n    }\n\n    /**\n     * Get container (DOM)\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    /**\n     * Get Style (json)\n     * @returns {Object} Style MapBox\n     */\n    getStyle () {\n        return this.mapbox;\n    }\n\n    /**\n     * Get layer style (json)\n     * @param {Number} i - index\n     * @returns {Object} Style MapBox of a layers\n     */\n    getStyleLayer (i) {\n        var layer = null;\n        var o = this.getLayer(i);\n        var id = o.options.obj.id;\n        for (var k = 0; k < this.mapbox.layers.length; k++) {\n            var l = this.mapbox.layers[k];\n            if (l.id === id) {\n                layer = l;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get layer object from json style\n     * @param {Number} i - index into style json\n     * @returns {Object} Style MapBox of a layers\n     */\n    getLayerFromStyle (i) {\n        var layer = null;\n        var l = this.mapbox.layers[i];\n        for (var k = 0; k < this.getLayers().length; k++) {\n            var o = this.getLayer(k);\n            if (l.id === o.options.obj.id) {\n                layer = o;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get a list of layer object sorted or not (see options.tools.sort)\n     * @returns {Array} - List of layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayers () {\n        return this.layers;\n    }\n\n    /**\n     * Get the layer object from a list sorted or not (see options.tools.sort)\n     * @param {Number} i - index\n     * @returns {Object} - layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayer (i) {\n        return this.layers[i];\n    }\n\n};\n\n// on récupère les méthodes de la classe DOM\nUtils.assign(Editor.prototype, EditorDOM);\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\nexport default Editor;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    window.ol.style.Editor = Editor;\n}\n","import Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport GeocodeRequestFactory from \"./Request/GeocodeRequestFactory\";\nimport GeocodeResponseFactory from \"./Response/GeocodeResponseFactory\";\n\n/**\n * @classdesc\n * Appel du service de géocodage direct du Géoportail :\n *     envoi de la requête construite selon les paramètres en options,\n *     éventuellement parsing et analyse  de la réponse,\n *     retour d'une réponse en paramètre de la fonction onSuccess.\n *\n *\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.Geocode\n *\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {String|Object} options.query - Nom de l'adresse, du toponyme, de l'unité administrative ou de la parcelle cadastrale recherchée.\n *\n * @param {Object} [options.filters] - Les propriétés possibles de cet objet sont décrites ci-après.\n * @param {String} [options.filters.[prop]] - Critère supplémentaire pour filtrer la recherche sous la forme\n *      d'un couple clé/valeur à définir selon les possibilités du serveur ajouté à la requête.\n *      Le service de géocodage du Géoportail permet de filtrer les adresses postales avec les propriétés :\n *          \"postalCode\", \"inseeCode\", \"city\".\n *      Il permet également de filtrer les toponymes avec les propriétés :\n *          \"postalCode\", \"inseeCode\", \"type\".\n *      Enfin, il permet de filtrer les parcelles cadastrales avec les propriétés :\n *          \"codeDepartement\", \"codeCommune\", \"nomCommune\", \"codeCommuneAbs\", \"codeArrondissement\", \"section\", \"numero\", \"feuille\".\n *\n * @param {String} [options.index = \"StreetAddress\"] - Type de l'objet recherché.\n *      Le service de géocodage du Géoportail permet de rechercher des 'PositionOfInterest' pour des toponymes, des 'StreetAddress'\n *      pour des adresses postales ou des 'CadastralParcel' pour des parcelles cadastrales.\n *      L'index 'location' regroupe les indexes 'StreetAddress' et 'PositionOfInterest'.\n *      D'autres types pourront être rajoutés selon l'évolution du service.\n *      Par défaut, index = 'StreetAddress'.\n *\n * @param {Object} options.position - Position du point de référence pour le calcul de proximité exprimée dans le système de référence spécifié par le srs.\n *      @param {Float} options.position.lon - Longitude du point de référence pour le calcul de proximité.\n *      @param {Float} options.position.lat - Latitude du point de référence pour le calcul de proximité.\n *\n * @param {Number} [options.maximumResponses] - Nombre de réponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par défaut.\n *      Si le serveur consulté est celui du Géoportail, la valeur par défaut sera donc celle du service : 20.\n *\n * @param {Boolean} [options.returnTrueGeometry = false] - Booléen indiquant si l'on souhaite récupérer la géométrie vraie des objects géolocalisés.\n *      false par défaut.\n *\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      proxyURL : null,\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      position : {lon:, lat:},\n *      index : 'StreetAddress',\n *      query : '10 rue du pont Machin-ville'\n *      (...)\n *   };\n */\nfunction Geocode (options_) {\n    if (!(this instanceof Geocode)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"Geocode\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"Geocode\";\n\n    this.logger = Logger.getLogger(\"Gp.Services.Geocode\");\n    this.logger.trace(\"[Constructeur Geocode (options)]\");\n\n    var options = this.patchOptionConvertor(options_);\n    if (!options.serverUrl) {\n        options.serverUrl = DefaultUrlService.Geocode.newUrl();\n    }\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, [options]);\n\n    if (!options.hasOwnProperty(\"query\")) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"query\"));\n    }\n\n    // ajout des options spécifiques au service\n    this.options.query = options.query;\n\n    // on definit l'index par defaut\n    if (!options.index) {\n        this.options.index = options.index = \"StreetAddress\";\n    }\n\n    if (options.filters) {\n        var filter = Object.keys(options.filters);\n        for (var i = 0; i < filter.length; i++) {\n            var key = filter[i];\n            // on supprime les filtres vides\n            if (typeof options.filters[key] === \"undefined\" ||\n                (typeof options.filters[key] === \"object\" && Object.keys(options.filters[key]).length === 0) ||\n                (typeof options.filters[key] === \"string\" && options.filters[key].length === 0) ||\n                (Array.isArray(options.filters[key]) && options.filters[key].length === 0)\n            ) {\n                delete this.options.filters[key];\n            }\n        }\n    }\n\n    this.options.index = options.index || \"StreetAddress\";\n    this.options.maximumResponses = options.maximumResponses || 20;\n}\n\n/**\n * @lends module:Geocode#\n */\nGeocode.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nGeocode.prototype.constructor = Geocode;\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Object} options_ - options du service\n * @return {Object} - options\n */\nGeocode.prototype.patchOptionConvertor = function (options_) {\n    const options = options_;\n\n    if (options.hasOwnProperty(\"location\")) {\n        this.logger.warn(\"The parameter 'location' is deprecated\");\n\n        if (!options.query) {\n            options.query = options.location;\n        }\n        delete options.location;\n    }\n\n    if (options.filterOptions) {\n        this.logger.warn(\"The parameter 'filterOptions' is deprecated\");\n\n        if (!options.filters) {\n            options.filters = options.filterOptions;\n\n            if (options.filters.type) {\n                this.logger.warn(\"The parameter 'filterOptions.type' is deprecated\");\n                if (!options.index) {\n                    if (Array.isArray(options.filters.type) && options.filters.type.length > 0) {\n                        options.index = options.filters.type[0];\n                    } else {\n                        options.index = options.filters.type;\n                    }\n                }\n                delete options.filters.type;\n            }\n\n            if (options.filters.bbox) {\n                this.logger.warn(\"The parameter 'filterOptions.bbox' is deprecated\");\n                delete options.filters.bbox;\n            }\n        }\n        delete options.filterOptions;\n    }\n\n    if (options.position) {\n        if (options.position.x) {\n            this.logger.warn(\"The parameter 'position.x' is deprecated\");\n\n            if (!options.position.lon) {\n                options.position.lon = options.position.x;\n            }\n            delete options.position.x;\n        }\n\n        if (options.position.y) {\n            this.logger.warn(\"The parameter 'position.y' is deprecated\");\n\n            if (!options.position.lat) {\n                options.position.lat = options.position.y;\n            }\n            delete options.position.y;\n        }\n    }\n\n    if (options.returnFreeForm) {\n        this.logger.warn(\"The parameter 'returnFreeForm' is deprecated\");\n        delete options.returnFreeForm;\n    }\n\n    if (options.srs) {\n        this.logger.warn(\"The parameter 'srs' is deprecated\");\n        delete options.srs;\n    }\n\n    return options;\n};\n\n/**\n * Création de la requête (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nGeocode.prototype.buildRequest = function (error, success) {\n    var options = {\n        httpMethod : this.options.httpMethod,\n        // options specifiques du service\n        geocodeMethod : \"search\",\n        query : this.options.query,\n        index : this.options.index,\n        returnTrueGeometry : this.options.returnTrueGeometry,\n        position : this.options.position,\n        maxResp : this.options.maximumResponses,\n        filters : this.options.filters\n    };\n\n    this.request = GeocodeRequestFactory.build(options);\n\n    // on teste si la requete a bien été construite !\n    (!this.request)\n        ? error.call(this, new ErrorService(_.getMessage(\"SERVICE_REQUEST_BUILD\")))\n        : success.call(this, this.request);\n};\n\n/**\n * Analyse de la reponse (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nGeocode.prototype.analyzeResponse = function (error, success) {\n    /* INFO :\n         Etape 1 : Création de la requête (URL)\n            -> stockage de la requête dans this.request\n         Etape 2 : Envoi de la requête\n            -> appel du protocol XHR, et envoi (par ex send ())\n            -> récupération de la réponse JSON dans la fonction onSuccess () (this.response)\n            -> si code HTTP 200 et pas de message d'erreur : etape 3\n            -> si code HTTP != 200 : lancement de la fonction de callback onFailure avec le message d'erreur\n         Etape 3 : Analyse de la réponse JSON (si rawResponse === false )\n            -> appel du parser pour récupérer le document\n         Etape 4 : Lancement de la fonction de callback onSuccess avec la réponse :\n            -> JSON (si rawResponse === true)\n            -> ou geocodedLocations\n    */\n\n    if (this.response) {\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        GeocodeResponseFactory.build(options);\n    } else {\n        error.call(this, new ErrorService(_.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\nexport default Geocode;\n","\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport AltiRequestFactory from \"./Request/AltiRequestFactory\";\nimport AltiResponseFactory from \"./Response/AltiResponseFactory\";\n\n/**\n * @classdesc\n *\n * Appel du service d'altimétrie du Géoportail\n *\n * @todo gestion du parma. output et callback\n * @todo outputFormat (REST) et format (WPS)\n * @todo La reponse JSON peut encapsuler un XML !\n *\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.Alti\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {Array.<Object>} options.positions - Tableau ({lon:float,lat:float}) contenant les coordonnées des points (CRS:84)\n *      dont on veut connaître les altitudes (ou à partir desquelles on va calculer le profil).\n *      Chaque élément du tableau est un objet JavaScript avec deux attributs : lon et lat, qui sont des flottants.\n *      Minimum 2 éléments si on souhaite calculer un profil altimétrique (ElevationLine).\n *      Maximum 50 éléments.\n *\n * @param {String} options.outputFormat - Le format de la réponse du service alti : 'xml' ou 'json'.\n *      Ce paramètre déterminera l'extension '.xml' ou '.json' du service dans le cas de l'API REST,\n *      ou la valeur du paramètre 'format' dans le cas de la norme WPS.\n *      Nécessaire si serverUrl est renseigné, et qu'on souhaite passer par l'API REST,\n *      pour connaître le format dans lequel sera fournie la réponse (pour son traitement).\n *      Non nécessaire pour la norme WPS. Par défaut, ce paramètre vaut 'json'.\n *\n * @param {Number} [options.sampling] - Nombre de points à utiliser pour déterminer le tracé d'un profil altimétrique, compris entre 2 et 5000.\n *      A spécifier lorsqu'on souhaite accéder à cette fonctionnalité.\n *      Dans ce cas, les points fournis en entrée (au minimum de deux) servent à déterminer l'axe planimétrique\n *      le long duquel le profil doit être calculé.\n *      Si le paramètre sampling n'est pas spécifié ou moins de deux points sont fournis,\n *      c'est le service Elevation qui sera interrogé (altitudes simples calculées pour les points fournis).\n *      Une valeur de sampling strictement inférieure à 2 déclenchera un échantillonnage avec la valeur par défaut du service (3 points).\n *\n * @param {String} [options.api] - Manière d'accéder au service : 'REST' (via l'API REST) ou 'WPS' (via la norme WPS).\n *      Par défaut, on utilise l'API REST.\n *\n * @param {Boolean} [options.zonly] - Permet de ne récupérer que les altitudes en sortie s'il vaut 'true'.\n *      Vaut 'false' par défaut.\n *\n * @param {String} [options.resource] - Resource utilisée pour réaliser le calcul.\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      positions : [{lon:, lat:}, {lon:, lat:}],\n *      outputFormat : 'json' // json|xml\n *      sampling : 3,\n *      api : 'REST', // REST|WPS\n *      zonly : false // false|true,\n *      resource : \"resource-par-defaut\"\n *   };\n *\n */\nfunction Alti (options) {\n    if (!(this instanceof Alti)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"Alti\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"Alti\";\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, arguments);\n\n    this.logger = Logger.getLogger(\"Gp.Services.Alti\");\n    this.logger.trace(\"[Constructeur Alti (options)]\");\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    if (!options.positions) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"positions\"));\n    }\n\n    if (options.positions.length === 0) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"positions\"));\n    }\n\n    // ajout des options spécifiques au service\n    this.options.positions = options.positions;\n\n    // format de réponse du service : \"json\" ou \"xml\" (valeur par défaut), en minuscule !\n    this.options.outputFormat = (typeof options.outputFormat === \"string\") ? options.outputFormat.toLowerCase() : \"xml\";\n\n    // ressource utilisée pour le calcul altimétrique\n    this.options.resource = options.resource || \"ign_rge_alti_wld\";\n\n    // sampling\n    this.options.sampling = options.sampling || null;\n\n    // type d'api utilisé pour requeter le service, en majuscule !\n    this.options.api = (typeof options.api === \"string\") ? options.api.toUpperCase() : \"REST\";\n\n    // l'api ne peut être interrogée qu'en GET.\n    if (this.options.api === \"REST\") {\n        this.options.httpMethod = \"GET\";\n    }\n\n    // param. zonly\n    this.options.zonly = options.zonly || false;\n\n    // param. measures\n    this.options.measures = options.measures || false;\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseignée, il faut utiliser les urls par defaut\n    // en fonction du type d'api, REST ou WPS, du format de reponse demandé (outputFormat)\n    // ainsi que sur le type de service (profil ou elevation)\n    if (!this.options.serverUrl) {\n        var lstUrlByDefault = DefaultUrlService.Alti.newUrl();\n        var urlFound = null;\n        switch (this.options.api) {\n            case \"WPS\":\n                urlFound = lstUrlByDefault.wps;\n                break;\n            case \"REST\":\n                var key = (options.sampling ? \"profil\" : \"elevation\") + \"-\" + this.options.outputFormat;\n                urlFound = lstUrlByDefault[key];\n                break;\n            default:\n                throw new Error(_.getMessage(\"PARAM_UNKNOWN\", \"api\"));\n        }\n\n        if (!urlFound) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = urlFound;\n        this.logger.trace(\"Server URL by default : \" + this.options.serverUrl);\n    }\n\n    // gestion du type de service\n    // si l'extension de l'url est .json ou .xml, on surcharge le format de sortie (outputFormat)\n    var idx = this.options.serverUrl.lastIndexOf(\".\");\n    if (idx !== -1) {\n        var extension = this.options.serverUrl.substring(idx + 1);\n        if (extension && extension.length < 5) { // FIXME extension de moins de 4 car. ...\n            this.logger.trace(\"Server Extension URL : \" + extension);\n            switch (extension.toLowerCase()) {\n                case \"json\":\n                case \"xml\":\n                    this.options.outputFormat = extension.toLowerCase();\n                    break;\n                default:\n                    throw new Error(\"type of service : unknown or unsupported (json or xml) !\");\n            }\n        }\n    }\n}\n\n/**\n * @lends module:Alti#\n */\nAlti.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/**\n * Constructeur (alias)\n */\nAlti.prototype.constructor = Alti;\n\n/**\n * Création de la requête (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAlti.prototype.buildRequest = function (error, success) {\n    // utilisation en mode callback\n    var options = {\n        httpMethod : this.options.httpMethod,\n        // callback\n        onSuccess : function (result) {\n            // sauvegarde de la requete !\n            this.request = result;\n            success.call(this, this.request);\n        },\n        onError : error,\n        scope : this,\n        // spécifique au service :\n        resource : this.options.resource,\n        positions : this.options.positions,\n        outputFormat : this.options.outputFormat,\n        sampling : this.options.sampling,\n        api : this.options.api,\n        zonly : this.options.zonly,\n        measures : this.options.measures\n    };\n\n    AltiRequestFactory.build(options);\n};\n\n/**\n * Analyse de la reponse (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAlti.prototype.analyzeResponse = function (error, success) {\n    // INFO\n    // Factory pour masquer la complexité du retour du service qui renvoie soit\n    //  - une 'string' qui contient du XML ou JSON natif en mode XHR\n    //  - un objet JSON qui est natif ou encapsulé\n\n    if (this.response) {\n        var options = {\n            response : this.response,\n            outputFormat : this.options.outputFormat, // utile pour parser la string en mode XHR : JSON ou XML !\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        AltiResponseFactory.build(options);\n    } else {\n        error.call(this, new ErrorService(_.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\nexport default Alti;\n","module.exports = ol.style.Circle;","/**\n* @module Helper\n* @alias module:~utils/HelperUtils\n* @description\n* ...\n*\n* @example\n* import HelperUtils from \"gpf-ext-ol/utils/HelperUtils\"\n* ou \n* import {HelperUtils} from \"gpf-ext-ol\n* \n* HelperUtils.detectSupport();\n* HelperUtils.assign();\n* HelperUtils.mergeParams();\n*/\nvar Helper = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @function detectSupport\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport : function () {\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @function assign\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign : function (dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @function mergeParams\n     * @param {Object} dest     - destination object where properties and method will be merge\n     * @param {Object} source   - source object from which properties and method will be merge\n     * @param {Boolean} replace - replace destination value by source if exists or not (true by default)\n     */\n    mergeParams : function (dest, source, replace) {\n        if (typeof dest === \"undefined\" || typeof source === \"undefined\") {\n            return;\n        }\n        if (typeof replace === \"undefined\") {\n            replace = true;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param], replace);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    if (dest.hasOwnProperty(param)) {\n                        if (replace) {\n                            dest[param] = source[param];\n                        }\n                    } else {\n                        dest[param] = source[param];\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport default Helper;\n","import * as Log from \"loglevel\";\n\nvar LoggerByDefault = {\n    /**\n     * logger statique\n     *\n     * @static\n     * @param {String} name - nom du logger\n     * @returns {Object} retourne un logger\n     */\n    getLogger : function (name) {\n        // Substitute global constants configured at compile time\n        // cf. webpack.config.js\n        // on définit process si non défini dans l'environnement\n        // eslint-disable-next-line no-use-before-define\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    }\n};\n\nexport default LoggerByDefault;\n","import ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport GeocodeUtils from \"../../Utils/GeocodeUtils\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\nvar logger = Logger.getLogger(\"LocationSelectorDOM\");\n\nvar LocationSelectorDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.className = this._addUID(\"GPlocationPoint\"); // ceci permet de gerer les groupes de points !\n        container.className += \" GPwidget gpf-widget \";\n        return container;\n    },\n\n    /**\n     * Create Container Point\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @param {Number} display  - display\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointElement : function (id, display) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlocationPoint_\" + id);\n        div.className = (display) ? \"GPflexInput GPlocationStageFlexInput gpf-flex\" : \"GPflexInput GPelementHidden gpf-flex gpf-hidden\";\n        div.style.cssText = \"\";\n\n        return div;\n    },\n\n    /**\n     * Create Container Point\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @param {String} text - label\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointLabelElement : function (id, text) {\n        // contexte d'execution\n        var self = this;\n\n        var buttonOrigin = document.createElement(\"button\");\n        buttonOrigin.id = this._addUID(\"GPlocationOriginLabel_\" + id);\n        buttonOrigin.innerHTML = text;\n        buttonOrigin.className = \"GPlocationOriginLabel gpf-btn gpf-btn-icon-label fr-btn fr-btn--secondary gpf-btn--secondary\";\n        buttonOrigin.setAttribute(\"type\", \"button\");\n        buttonOrigin.addEventListener(\"click\", function (e) {\n            var i = ID.index(this.id);\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            for (var j = 0; j < points.length; j++) {\n                var tag = points[j].childNodes[0].id;\n                var id = ID.index(tag);\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n            }\n            document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n            document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value = \"\";\n            document.getElementById(self._addUID(\"GPlocationPoint_\" + i)).style.cssText = \"\";\n            document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = false;\n            document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPelementShow gpf-show  gpf-input fr-input\";\n            document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPelementHidden gpf-hidden\";\n            if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary\";\n            }\n            if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w\";\n            }\n            // document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).disabled = true;\n            self.onLocationClearPointClick(e);\n        });\n\n        return buttonOrigin;\n    },\n\n    /**\n     * Create Input AutoComplete Point tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAutoCompleteteInputElement : function (id) {\n        // contexte d'execution\n        var self = this;\n\n        var inputOrigin = document.createElement(\"input\");\n        inputOrigin.id = this._addUID(\"GPlocationOrigin_\" + id);\n        inputOrigin.className = \"GPelementShow gpf-show gpf-input fr-input\";\n        inputOrigin.type = \"text\";\n        inputOrigin.placeholder = \"Saisir une adresse, un lieu...\";\n        inputOrigin.autocomplete = \"off\";\n        inputOrigin.addEventListener(\"keyup\", function (e) {\n            var charCode = e.which || e.keyCode;\n            if (charCode === 13 || charCode === 10 || charCode === 38 || charCode === 40) {\n                return;\n            }\n\n            var i = ID.index(this.id);\n            if (document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value.length > 2) {\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).classList.replace(\"gpf-hidden\", \"gpf-visible\");\n            } else {\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).classList.replace(\"gpf-visible\", \"gpf-hidden\");\n            }\n            // gestionnaire d'evenement :\n            // on récupère la valeur de saisie pour une requête sur le service d'autocompletion.\n            // le resultat de la requête nous permet de recuperer les coordonnées du point...\n            self.onAutoCompleteSearchText(e);\n        });\n\n        inputOrigin.addEventListener(\"keydown\", function (e) {\n            var charCode = e.which || e.keyCode;\n\n            var container = document.getElementById(self._addUID(\"GPlocationAutoCompleteResult_\" + id));\n\n            // si aucun container !?\n            if (!container) {\n                return;\n            }\n\n            var curr = container.getElementsByClassName(\"GPautoCompleteProposal current\");\n            var list = container.getElementsByClassName(\"GPautoCompleteProposal\");\n\n            // si aucune suggestion, on ne va pas plus loin !\n            var length = list.length;\n            if (!length) {\n                return;\n            }\n\n            var current = null;\n\n            // si aucun item courant, on prend le 1er !\n            if (!curr.length) {\n                current = list[0];\n                current.className = \"GPautoCompleteProposal current\";\n                current.style.color = \"#000000\";\n                current.style[\"background-color\"] = \"#CEDBEF\";\n                return;\n            } else {\n                current = curr[0];\n            }\n\n            var index = parseInt(ID.index(current.id), 10);\n            var next = (index === length - 1) ? list[0] : list[index + 1];\n            var prev = (index === 0) ? list[length - 1] : list[index - 1];\n\n            current.style[\"background-color\"] = \"\";\n            current.style.color = \"\";\n            prev.style[\"background-color\"] = \"\";\n            prev.style.color = \"\";\n            next.style[\"background-color\"] = \"\";\n            next.style.color = \"\";\n\n            switch (charCode) {\n                case 38: // arrow up\n                    logger.log(\"arrow up\");\n                    current.className = \"GPautoCompleteProposal\";\n                    prev.className = \"GPautoCompleteProposal current\";\n                    prev.style.color = \"#000000\";\n                    prev.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 40: // arrow down\n                    logger.log(\"arrow down\");\n                    current.className = \"GPautoCompleteProposal\";\n                    next.className = \"GPautoCompleteProposal current\";\n                    next.style.color = \"#000000\";\n                    next.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 13: // enter\n                    logger.log(\"enter\");\n                    current.click(e);\n                    break;\n            }\n\n            current.focus();\n        });\n\n        return inputOrigin;\n    },\n\n    /**\n     * Create Input Coordinate Point tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationCoordinateInputElement : function (id) {\n        // contexte d'execution\n        var self = this;\n\n        var inputOriginCoord = document.createElement(\"input\");\n        inputOriginCoord.id = this._addUID(\"GPlocationOriginCoords_\" + id);\n        inputOriginCoord.className = \"GPelementHidden gpf-input gpf-hidden fr-input\";\n        inputOriginCoord.type = \"text\";\n        inputOriginCoord.disabled = false;\n        inputOriginCoord.addEventListener(\"click\", function () {\n            var i = ID.index(this.id);\n            document.getElementById(self._addUID(\"GPlocationOriginLabel_\" + i)).click();\n        });\n        return inputOriginCoord;\n    },\n\n    /**\n     * Create Show Pointer tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointerShowInputElement : function (id) {\n        var inputOriginPointer = document.createElement(\"input\");\n        inputOriginPointer.id = this._addUID(\"GPlocationOriginPointer_\" + id);\n        inputOriginPointer.className = \"GPelementHidden gpf-hidden\";\n        inputOriginPointer.type = \"checkbox\";\n\n        return inputOriginPointer;\n    },\n\n    /**\n     * Create Input Pointer tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointerInputElement : function (id) {\n        // contexte d'execution\n        var self = this;\n\n        var buttonOriginPointer = document.createElement(\"button\");\n        buttonOriginPointer.id = this._addUID(\"GPlocationOriginPointerImg_\" + id);\n        buttonOriginPointer.htmlFor = this._addUID(\"GPlocationOriginPointer_\" + id);\n        buttonOriginPointer.className = \"GPlocationOriginPointerImg gpf-btn gpf-btn-icon-pointer fr-btn\";\n        buttonOriginPointer.title = \"Pointer un lieu sur la carte\";\n        buttonOriginPointer.setAttribute(\"type\", \"button\");\n        buttonOriginPointer.addEventListener(\"click\", function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            var i = ID.index(this.id);\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            var j;\n            var tag;\n            var id;\n            for (j = 0; j < points.length; j++) {\n                tag = points[j].childNodes[0].id;\n                id = ID.index(tag);\n                if (i !== id) {\n                    document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + id)).checked = false;\n                    if (document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).value === \"Pointer un lieu sur la carte\") {\n                        document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).value = \"\";\n                        document.getElementById(self._addUID(\"GPlocationOrigin_\" + id)).className = \"GPelementShow gpf-show  gpf-input fr-input\";\n                        document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).className = \"GPelementHidden gpf-hidden\";\n                    }\n                }\n            }\n            if (document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked) {\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n                for (j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    id = ID.index(tag);\n                    document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                    document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPlocationStageRemove  gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w\";\n                }\n                document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = false;\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPelementShow gpf-show  gpf-input fr-input\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPelementHidden gpf-hidden\";\n            } else {\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"Pointer un lieu sur la carte\";\n                for (j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    id = ID.index(tag);\n                    if (i === id) {\n                        document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n                    } else {\n                        document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.display = \"none\";\n                    }\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                    document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPelementHidden gpf-hidden\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"GPelementHidden gpf-hidden\";\n                }\n                document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = true;\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPelementShow gpf-show gpf-input fr-input\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).disabled = true;\n            }\n            // gestionnaire d'evenement :\n            // on stocke la valeur du point, utilisée pour la requête sur le service de calcul d'itiniraire\n            self.onActivateMapPointClick(e);\n        });\n\n        return buttonOriginPointer;\n    },\n\n    /**\n     * Create Remove Point tag\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationRemovePointElement : function (id) {\n        // contexte d'execution\n        var self = this;\n\n        var buttonRm = document.createElement(\"button\");\n        buttonRm.id = this._addUID(\"GPlocationStageRemove_\" + id);\n        buttonRm.className = \"GPlocationOpen GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary\";\n        buttonRm.title = \"Supprimer l'étape\";\n        buttonRm.setAttribute(\"tabindex\", \"0\");\n        buttonRm.setAttribute(\"aria-pressed\", false);\n        buttonRm.setAttribute(\"type\", \"button\");\n        buttonRm.addEventListener(\"click\", function (e) {\n            var status = (e.target.ariaPressed === \"true\");\n            e.target.setAttribute(\"aria-pressed\", !status);\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            var last = points.length - 1;\n            var start = points[0].childNodes[0].id;\n            var end = points[last].childNodes[0].id;\n\n            var startID = ID.index(start);\n            var endID = ID.index(end);\n\n            if (id !== startID && id !== endID) {\n                var i = ID.index(this.id);\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + i)).className = \"GPflexInput GPelementHidden gpf-flex gpf-hidden\";\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value = \"\";\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPelementShow gpf-show gpf-input fr-input\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).style.display = \"\";\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + i)).parentElement.previousSibling.classList.add(\"GPelementHidden\", \"gpf-hidden\");\n                // Moving up exclusions picto\n                // var exclusionsPictoTop = document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top;\n                // document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top = (parseInt(exclusionsPictoTop) - 33).toString() + \"px\";\n\n                // gestionnaire d'evenement :\n                // on supprime le point, utilisé pour la requête sur le service d'itiniraire\n                self.onLocationRemovePointClick(e);\n            }\n        });\n\n        return buttonRm;\n    },\n\n    /**\n     * Create Add Point tag\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAddPointElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var buttonAdd = document.createElement(\"button\");\n        buttonAdd.id = this._addUID(\"GPlocationStageAdd\");\n        buttonAdd.className = \"GPlocationOpen GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm fr-btn--secondary gpf-btn--secondary fr-mt-2w\";\n        buttonAdd.title = \"Ajouter une étape\";\n        if (checkDsfr()) {\n            buttonAdd.innerText = \"Ajouter une étape\";\n        }\n        buttonAdd.setAttribute(\"tabindex\", \"0\");\n        buttonAdd.setAttribute(\"aria-pressed\", false);\n        buttonAdd.setAttribute(\"type\", \"button\");\n        buttonAdd.addEventListener(\"click\", function (e) {\n            var lastStage = 1;\n            var nbStages = 0;\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            for (var i = 1; i < points.length - 1; i++) {\n                var tag = points[i].childNodes[0].id;\n                var id = ID.index(tag);\n                if (document.getElementById(self._addUID(\"GPlocationPoint_\" + id))) {\n                    if (document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).className === \"GPflexInput GPelementHidden gpf-flex gpf-hidden\") {\n                        if (lastStage === 1) {\n                            lastStage = id;\n                        }\n                    } else {\n                        nbStages++;\n                    }\n                }\n            }\n            // FIXME algo à revoir : lastStage = id hors si id = 300 sur 3 points !?\n            if (lastStage < points.length) {\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + lastStage)).className = \"GPflexInput GPlocationStageFlexInput gpf-flex\";\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + lastStage)).parentElement.previousSibling.classList.remove(\"GPelementHidden\", \"gpf-hidden\");\n                // Moving down exclusions picto\n                // var exclusionsPictoTop = document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top;\n                // document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top = (parseInt(exclusionsPictoTop) + 33).toString() + \"px\";\n            }\n            if (nbStages === 4) {\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on ajoute le point, utilisé pour la requête sur le service d'itiniraire\n            var status = (e.target.ariaPressed === \"true\");\n            e.target.setAttribute(\"aria-pressed\", !status);\n            self.onLocationAddPointClick(e);\n        });\n\n        return buttonAdd;\n    },\n\n    _createLocationAutoCompleteElement : function (id) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlocationAutoCompleteList_\" + id);\n        div.className = \"GPlocationAutoCompleteList GPelementHidden gpf-panel gpf-hidden fr-modal\"; // GPpanel ?\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs à la main...\n        // div.appendChild(this._createLocationAutoCompleteResultElement ());\n\n        return div;\n    },\n\n    /**\n     * Create Results autocompletion to the point\n     * see event!\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAutoCompleteResultElement : function (id) {\n        // contexte d'execution\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlocationAutoCompleteResult_\" + id);\n        div.className = \"GPadvancedAutoCompleteResult gpf-panel__list\";\n\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function (e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).classList.replace(\"gpf-hidden\", \"gpf-visible\");\n            }, false);\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function (e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).classList.replace(\"gpf-hidden\", \"gpf-visible\");\n            });\n        }\n\n        return div;\n    },\n\n    /**\n     * Autocompletion result to a point.\n     * Proposals are dynamically filled in Javascript by autocomplete service\n     *\n     * TODO formaliser le contenu des reponse\n     *\n     * @param {Number} id - tag ID\n     * @param {Object} location - suggested location result\n     * @param {Number} n  - number of the point\n     */\n    _createLocationAutoCompletedLocationElement : function (id, location, n) {\n        var container = document.getElementById(this._addUID(\"GPlocationAutoCompleteResult_\" + id));\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"AutoCompletedLocation_\" + n);\n        div.className = \"GPautoCompleteProposal gpf-panel__items\";\n        div.title = GeocodeUtils.getSuggestedLocationFreeform(location);\n        div.innerHTML = GeocodeUtils.getSuggestedLocationFreeform(location);\n\n        container.appendChild(div);\n    },\n\n    /**\n    * Display Coordinate\n    * @param {String} value - a Coordinate\n    */\n    GPdisplayCoordinate : function (value) {\n        var points = document.getElementsByClassName(this._addUID(\"GPlocationPoint\"));\n        for (var i = 0; i < points.length; i++) {\n            var tag = points[i].childNodes[0].id;\n            var id1 = ID.index(tag);\n            if (document.getElementById(this._addUID(\"GPlocationOriginPointer_\" + id1)).checked) {\n                document.getElementById(this._addUID(\"GPlocationOriginCoords_\" + id1)).value = value;\n                document.getElementById(this._addUID(\"GPlocationOriginCoords_\" + id1)).disabled = false;\n                for (var j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    var id2 = ID.index(tag);\n                    document.getElementById(this._addUID(\"GPlocationPoint_\" + id2)).style.cssText = \"\";\n                    if (document.getElementById(this._addUID(\"GPlocationStageRemove_\" + id2))) {\n                        document.getElementById(this._addUID(\"GPlocationStageRemove_\" + id2)).className = \"GPlocationStageRemove gpf-btn gpf-btn-icon-remove fr-btn--sm fr-btn--secondary gpf-btn--secondary\";\n                    }\n                }\n                document.getElementById(this._addUID(\"GPlocationOriginPointer_\" + id1)).checked = false;\n                if (document.getElementById(this._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(this._addUID(\"GPlocationStageAdd\")).className = \"GPlocationStageAdd gpf-btn gpf-btn-icon-add fr-btn--sm\";\n                }\n                return;\n            }\n        }\n    }\n};\n\nexport default LocationSelectorDOM;\n","// import CSS\nimport \"../../CSS/Controls/LocationSelector/GPFlocation.css\";\n// import \"../../CSS/Controls/LocationSelector/GPFlocationStyle.css\";\n// import OpenLayers\nimport Control from \"ol/control/Control\";\nimport Overlay from \"ol/Overlay\";\nimport { transform as olTransformProj } from \"ol/proj\";\nimport { unByKey as olObservableUnByKey } from \"ol/Observable\";\n// import geoportal library access\nimport Gp from \"geoportal-access-lib\";\n// import local\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Utils from \"../../Utils/Helper\";\nimport GeocodeUtils from \"../../Utils/GeocodeUtils\";\nimport SelectorID from \"../../Utils/SelectorID\";\nimport Markers from \"../Utils/Markers\";\n// DOM\nimport LocationSelectorDOM from \"./LocationSelectorDOM\";\n\nvar logger = Logger.getLogger(\"locationselector\");\n\n/**\n * @classdesc\n *\n * LocationSelector component. Enables to select a location, using autocompletion or picking location on the map\n * @constructor\n * @extends {ol.control.Control}\n * @alias ol.control.LocationSelector\n * @type {ol.control.LocationSelector}\n * @param {Object} [options] - component options\n * @param {String} [options.apiKey] - API key for autocomplete service call. The key \"calcul\" is used by default.\n * @param {Boolean} [options.ssl = true] - use of ssl or not (default true, service requested using https protocol)\n * @param {Boolean} [options.displayInfo = true] - whether to display info in a popup or not (not implemented yet) Default is true\n * @param {Object} [options.tag] - tag options\n * @param {Number} [options.tag.id = 1] - order id number in a locations group, in case several LocationSelector are used. For instance in route case : departure tag id should be 0, arrival tag id should be 1, and other ones : 2, 3, ...\n * @param {Number} [options.tag.groupId = null] - locationSelector global component id (in case locationSelector is called by another graphic component, e.g. route control)\n * @param {String} [options.tag.label] - text to display in component (e.g. \"Departure\"). Default is \">\"\n * @param {Object} [options.tag.markerOpts] - options to use your own marker. Default is a lightOrange marker.\n * @param {String} [options.tag.markerOpts.url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.tag.markerOpts.offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see {@link http://openlayers.org/en/latest/apidoc/ol.Overlay.html ol.Overlay})\n * @param {Boolean} [options.tag.display = true] - whether to display or hide component. Default is true\n * @param {Boolean} [options.tag.addOption = false] - whether to display picto to add another LocationSelector (in case of route control)\n * @param {Boolean} [options.tag.removeOption = false] - whether to display picto to remove a LocationSelector (in case of route control)\n * @param {Object} [options.autocompleteOptions] - autocomplete service options (see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options)\n * @example\n *  var locationselector = new LocationSelector({\n *      apiKey : \"\",\n *      tag : {\n *         id : 1,\n *         groupId : null,\n *         label : \"Départ\",\n *         markerOpts : {\n *              url : \"...\",\n *              offset : [0,0]\n *         },\n *         display : true\n *      },\n *      autocompleteOptions : {}\n *  });\n */\nvar LocationSelector = class LocationSelector extends Control {\n\n    /**\n     * See {@link ol.control.LocationSelector}\n     * @module LocationSelector\n     * @alias module:~controls/LocationSelector\n     * @param {*} options - options\n     * @example\n     * import LocationSelector from \"gpf-ext-ol/controls/LocationSelector\"\n     * ou \n     * import { LocationSelector } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {};\n\n        super({\n            element : options.element || document.createElement(\"div\"),\n            render : options.render,\n            target : options.target\n        });\n\n        if (!(this instanceof LocationSelector)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"LocationSelector\";\n        // initialisation du composant\n        this.initialize(options);\n\n        // creation du DOM\n        this._container = this._initContainer();\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this._container) : this.element = this._container;\n\n        return this;\n    }\n\n    /**\n     * initialize component\n     *\n     * @param {Object} options - options\n     */\n    initialize (options) {\n        // set default options\n        this.options = {\n            tag : {\n                id : 1, // numero d'ordre sur un groupe de locations\n                groupId : null, // id du composant global contenant le LocationSelector\n                label : \">\",\n                display : true,\n                addOption : false,\n                removeOption : false\n            },\n            displayInfo : true,\n            autocompleteOptions : {}\n        };\n\n        // merge with user options\n        Utils.mergeParams(this.options, options);\n\n        /** uuid */\n        this._uid = this.options.tag.groupId || SelectorID.generate();\n        // info : si un uid (groupId) est spécifié\n        // (par ex si ce composant est appélé par un autre composant graphique)\n        // alors on le récupère, sinon c'est qu'il est indépendant : on génère donc un uuid\n\n        /** container map */\n        this._map = null;\n\n        /** container principal des entrées  */\n        this._inputsContainer = null;\n\n        /** container du label du point */\n        this._buttonLabel = null;\n\n        /** container de la saisi de l'autocompletion */\n        this._inputAutoComplete = null;\n\n        /** container du pointer de saisi sur la carte */\n        this._inputShowPointerContainer = null;\n\n        /** label du pointer de saisi sur la carte (avec img) */\n        this._inputShowPointer = null;\n\n        /** container des coordonnées */\n        this._inputCoordinateContainer = null;\n\n        /** elements pour ajouter ou supprimer un nouveau point */\n        this._addPointElement = null;\n        this._removePointElement = null;\n\n        /** coordonnées du point selectionné, en EPSG:4326 */\n        this._coordinate = null;\n\n        /** container des reponses de l'autocompletion */\n        this._suggestedContainer = null;\n        this._suggestedList = null;\n\n        /** listes des reponses de l'autocompletion */\n        this._suggestedLocations = [];\n\n        /** localisant */\n        this._currentLocation = null;\n\n        /** marker */\n        this._initMarker();\n\n        /** ressources du services d'autocompletion (ayant droit!) */\n        this._resources = {};\n\n        // listener key for event click on map\n        this.listenerKey = null;\n    }\n\n    /**\n     * initialize marker : url and offset\n     *\n     * @private\n     */\n    _initMarker () {\n        // init marker properties\n        this._marker = null;\n        this._markerUrl = \"\";\n        this._markerOffset = [0, 0];\n\n        if (this.options.tag.markerOpts && this.options.tag.markerOpts.url) {\n            // get marker src url\n            this._markerUrl = this.options.tag.markerOpts.url;\n\n            // get marker offset\n            var offset = this.options.tag.markerOpts.offset;\n            if (offset) {\n                if (Array.isArray(offset) && offset.length === 2) {\n                    this._markerOffset = offset;\n                } else {\n                    logger.log(\"markerOpts.offset should be an array. e.g. : [0,0]\");\n                }\n            }\n        } else {\n            // set default options for marker\n            this._markerUrl = Markers[\"lightOrange\"];\n            this._markerOffset = Markers.defaultOffset;\n        }\n    }\n\n    // ################################################################### //\n    // ########################## publics methods ######################## //\n    // ################################################################### //\n\n    /**\n     * get coordinate\n     *\n     * @returns {Array} this._coordinate - point coordinate (EPSG:4326) : [lon, lat]\n     */\n    getCoordinate () {\n        return this._coordinate;\n    }\n\n    /**\n     * set coordinate\n     * @param {Object} coordinate - Coordinate in the map projection by default, otherwise, the projection is entered in the following parameter\n     * @param {String} crs - Coordinate projection\n     */\n    setCoordinate (coordinate, crs) {\n        var map = this.getMap();\n        var proj = map.getView().getProjection().getCode();\n        // on utilise la projection de la carte\n        if (!crs) {\n            crs = proj;\n        }\n\n        this._setCoordinate(coordinate, crs);\n\n        // on utilise toujours la projection de la carte pour placer le marker\n        coordinate = olTransformProj(coordinate, crs, proj);\n        this._setMarker([\n            coordinate[0],\n            coordinate[1]\n        ], null, false);\n    }\n\n    /**\n     * clean all and input\n     */\n    clear () {\n        this.clearResults();\n        this._buttonLabel.click();\n    }\n\n    /**\n     * clear all results and the marker.\n     */\n    clearResults () {\n        this._currentLocation = null;\n        this._coordinate = null;\n        this._hideSuggestedLocation();\n        this._clearSuggestedLocation();\n        this._setMarker();\n        // map.un(\"click\", (e) => this.onMouseMapClick(e));\n        olObservableUnByKey(this.listenerKey);\n    }\n\n    // ################################################################### //\n    // ##################### init component (private) #################### //\n    // ################################################################### //\n\n    /**\n     * initialize component container\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _initContainer () {\n        var id = this.options.tag.id;\n\n        // create main container\n        var container = this._createMainContainerElement();\n\n        var inputs = this._inputsContainer = this._createLocationPointElement(id, this.options.tag.display);\n        container.appendChild(inputs);\n\n        var _buttonLabel = this._buttonLabel = this._createLocationPointLabelElement(id, this.options.tag.label);\n        inputs.appendChild(_buttonLabel);\n        var _inputAutoComplete = this._inputAutoComplete = this._createLocationAutoCompleteteInputElement(id);\n        if (_inputAutoComplete.addEventListener) {\n            _inputAutoComplete.addEventListener(\"click\", () => this.onAutoCompleteInputClick());\n        } else if (_inputAutoComplete.attachEvent) {\n            _inputAutoComplete.attachEvent(\"onclick\", () => this.onAutoCompleteInputClick());\n        }\n        inputs.appendChild(_inputAutoComplete);\n        var _inputCoordinate = this._inputCoordinateContainer = this._createLocationCoordinateInputElement(id);\n        inputs.appendChild(_inputCoordinate);\n        var _inputShowPointer = this._inputShowPointerContainer = this._createLocationPointerShowInputElement(id);\n        inputs.appendChild(_inputShowPointer);\n        var _inputPointer = this._inputShowPointer = this._createLocationPointerInputElement(id);\n        inputs.appendChild(_inputPointer);\n\n        if (this.options.tag.addOption) {\n            var _inputAddStage = this._addPointElement = this._createLocationAddPointElement();\n            inputs.appendChild(_inputAddStage);\n        }\n\n        if (this.options.tag.removeOption) {\n            var _inputRemoveStage = this._removePointElement = this._createLocationRemovePointElement(id);\n            inputs.appendChild(_inputRemoveStage);\n        }\n\n        var resultsPanel = this._suggestedContainer = this._createLocationAutoCompleteElement(id);\n        var results = this._suggestedList = this._createLocationAutoCompleteResultElement(id);\n        resultsPanel.appendChild(results);\n        container.appendChild(resultsPanel);\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ###################### handlers events (dom) ###################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'click' on 'GPlocationOrigin' input\n     *\n     * @private\n     */\n    onAutoCompleteInputClick () {\n        if (this._inputAutoComplete && this._inputAutoComplete.value.length > 2) {\n            this._displaySuggestedLocation();\n        }\n    }\n\n    /**\n     * this method is called by event 'keyup' on 'GProuteOrigin' tag input\n     * (cf. this._createRouteAutoCompleteteInputElement), and it gets the value of input.\n     * this value is passed as a parameter for the service autocomplete (text).\n     * the results of the request are displayed into a drop down menu.\n     * FIXME\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onAutoCompleteSearchText (e) {\n        var value = e.target.value;\n        if (!value) {\n            return;\n        }\n\n        // on recupere les options du service\n        var serviceOptions = this.options.autocompleteOptions || {};\n        var _customOnSuccess = serviceOptions.onSuccess || null;\n        var _customOnFailure = serviceOptions.onFailure || null;\n\n        // on sauvegarde le localisant\n        this._currentLocation = value;\n\n        // on limite les requêtes à partir de 3 car. saisie !\n        if (value.length < 3) {\n            this._clearSuggestedLocation();\n            return;\n        }\n\n        // INFORMATION\n        // on effectue la requête au service d'autocompletion.\n        // on met en place des callbacks afin de recuperer les resultats ou\n        // les messages d'erreurs du service.\n        // les resultats sont affichés dans une liste deroulante.\n        // les messages d'erreurs sont affichés sur la console (?)\n        var context = this;\n        this._requestAutoComplete({\n            text : value,\n            maximumResponses : 5, // FIXME je limite le nombre de reponse car le container DOM est limité dans l'affichage !!!\n            // callback onSuccess\n            onSuccess : function (results) {\n                if (results) {\n                    var locations = results.suggestedLocations;\n                    context._fillAutoCompletedLocationListContainer(locations);\n                    if (_customOnSuccess) {\n                        _customOnSuccess.call(this, results);\n                    }\n                }\n            },\n            // callback onFailure\n            onFailure : function (error) {\n                // FIXME\n                // où affiche t on les messages : ex. 'No suggestion matching the search' ?\n                // doit on nettoyer la liste des suggestions dernierement enregistrée :\n                context._clearSuggestedLocation();\n                logger.log(error.message);\n                if (_customOnFailure) {\n                    _customOnFailure.call(this, error);\n                }\n            }\n        });\n\n        var map = this.getMap();\n        map.on(\n            \"click\",\n            () => this._hideSuggestedLocation()\n        );\n        map.on(\n            \"pointerdrag\",\n            () => this._hideSuggestedLocation()\n        );\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPautoCompleteResultsList' tag div\n     * (cf. this._createAutoCompleteListElement), and it selects the location.\n     * this location displays a marker on the map.\n     * FIXME\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onAutoCompletedResultsItemClick (e) {\n        var idx = SelectorID.index(e.target.id);\n\n        if (!idx) {\n            return;\n        }\n\n        // FIXME\n        // les coordonnées sont inversées entre les 2 services !?\n        // AutoCompletion : lon/lat (\"EPSG:4326\")\n        // Geocoding : lat/lon\n        var position = [\n            this._suggestedLocations[idx].position.x,\n            this._suggestedLocations[idx].position.y\n        ];\n        // on sauvegarde le point courant (en EPSG:4326, [lon, lat])\n        this._coordinate = position;\n\n        var info = {\n            type : this._suggestedLocations[idx].type,\n            fields : this._suggestedLocations[idx]\n        };\n\n        // on ajoute le texte de l'autocomplétion dans l'input\n        var label = GeocodeUtils.getSuggestedLocationFreeform(this._suggestedLocations[idx]);\n        this._setLabel(label);\n\n        // Info : la position est en EPSG:4326, à transformer dans la projection de la carte\n        var view = this.getMap().getView();\n        var mapProj = view.getProjection().getCode();\n        if (mapProj !== \"EPSG:4326\") {\n            // on retransforme les coordonnées de la position dans la projection de la carte\n            position = olTransformProj(position, \"EPSG:4326\", mapProj);\n        }\n        // on centre la vue et positionne le marker, à la position reprojetée dans la projection de la carte\n        this._setPosition(position);\n        this._setMarker(position, info, this.options.displayInfo);\n    }\n\n    /**\n     * this method is called by event 'click' on 'GProuteOriginPointerImg' tag input\n     * (cf. this._createRoutePointerInputElement), and it create or remove the event of click map.\n     *\n     * @private\n     */\n    onActivateMapPointClick () {\n        var map = this.getMap();\n\n        if (this._inputShowPointerContainer.checked) {\n            // on efface l'ancien resultat\n            this.clearResults();\n            this.listenerKey = map.on(\n                \"click\",\n                (e) => this.onMouseMapClick(e)\n            );\n            this._setCursor(\"crosshair\");\n        } else {\n            // map.un(\"click\", (e) => this.onMouseMapClick(e));\n            olObservableUnByKey(this.listenerKey);\n            this._setCursor();\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GProuteOriginLabel' tag label\n     * (cf. this._createRoutePointLabelElement).\n     * this point is erased.\n     *Missing\n     * @private\n     */\n    onLocationClearPointClick () {\n        this._setCursor();\n        this.clearResults();\n    }\n\n    /**\n     * this method is called by event 'click' on 'GProuteStageRemove' tag input\n     * (cf. this._createRouteRemovePointElement).\n     * this point is deleted\n     *\n     * @private\n     */\n    onLocationRemovePointClick () {\n        this._setCursor();\n        this.clearResults();\n    }\n\n    /**\n     * TODO this method is called by event 'click' on 'GProuteStageAdd' tag input\n     * (cf. this._createRouteAddPointElement).\n     * this point is added as a parameter for the service route.\n     *\n     * @param {Object} e - HTMLElement\n     */\n    onLocationAddPointClick (e) {\n        logger.log(\"onRouteAddPointClick\", e);\n    }\n\n    // ################################################################### //\n    // #################### handlers events (control) #################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'click' on map\n     * (cf. this.onRouteMapPointClick), and it gets the coordinate of click on map.\n     * this point is saved as a parameter for the service route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onMouseMapClick (e) {\n        var coordinate = e.coordinate;\n        if (!e.map || !e.map.getView()) {\n            return;\n        }\n        var crs = e.map.getView().getProjection();\n\n        this._setCoordinate(coordinate, crs);\n\n        this._setMarker([\n            coordinate[0],\n            coordinate[1]\n        ], null, false);\n\n        // on desactive l'event sur la map !\n        this.onActivateMapPointClick(e);\n    }\n\n    // ################################################################### //\n    // ################# pivates methods use by events ################### //\n    // ################################################################### //\n\n    /**\n     * this sends the label to the panel.\n     *\n     * @param {String} label - label suggested location\n     * @private\n     */\n    _setLabel (label) {\n        this._inputAutoComplete.value = label;\n    }\n\n    /**\n     * this change the cursor of the map when entering a point.\n     *\n     * @param {String} cursor - cursor style\n     * @private\n     */\n    _setCursor (cursor) {\n        var map = this.getMap();\n        var div = map.getTargetElement();\n\n        if (cursor) {\n            div.style.cursor = cursor;\n        } else {\n            div.style.cursor = null;\n        }\n    }\n\n    /**\n     * this sends the coordinates to the panel.\n     *\n     * @method _setCoordinate\n     * @param {Array} olCoordinate - ol.Coordinate object [lon, lat] ou [x, y] (proj = map proj system)\n     * @param {Object} crs - coordinate CRS (ol.proj.Projection)\n     * @private\n     */\n    _setCoordinate (olCoordinate, crs) {\n        // structure\n        // ol.Coordinate\n        //      [\n        //          4   // lon ou x\n        //          48  // lat ou y\n        //      ]\n\n        // on transforme olCoodinate (dont la projection est celle de la carte) en EPSG:4326\n        this._coordinate = olTransformProj(olCoordinate, crs, \"EPSG:4326\");\n\n        // INFO : si on veut des DMS\n        // var coords = ol.coordinate.toStringHDMS(this._coordinate, 2).split(\"N \");\n        // // coords est du type : \"48° 00′ 00″ N 2° 00′ 00″ E\". On veut récupérer les 2 coordonnées séparément.\n        // var lat = coords[0] + \"N\";\n        // var lng = coords[1];\n\n        // Pour avoir des degrés décimaux :\n        var lat = this._coordinate[0].toFixed(4);\n        var lng = this._coordinate[1].toFixed(4);\n\n        var value = lng + \" / \" + lat;\n        this.GPdisplayCoordinate(value);\n    }\n\n    /**\n     * this method is called by this.on*ResultsItemClick()\n     * and set center at given position.\n     *\n     * @param {Array} position - ol.Coordinate object [lon, lat] (en lat/lon : \"EPSG:4326\")\n     * @private\n     */\n    _setPosition (position) {\n        var view = this.getMap().getView();\n        view.setCenter(position);\n    }\n\n    /**\n     * this method is called by this.on*ResultsItemClick()\n     * and displays a marker.\n     * FIXME : marker IGN et informations ?\n     *\n     * @param {Array} position - ol.Coordinate object [lon, lat] ou [x, y]\n     * @param {Object} information - suggested or geocoded information\n     * @param {Boolean} display - display a popup information\n     * @private\n     */\n    _setMarker (position, information, display) {\n        var map = this.getMap();\n        // remove previous markers\n        if (this._marker != null) {\n            map.removeOverlay(this._marker);\n            this._marker = null;\n        }\n\n        if (position) {\n            var markerDiv = document.createElement(\"img\");\n            markerDiv.src = this._markerUrl;\n            this._marker = new Overlay({\n                position : position,\n                offset : this._markerOffset,\n                element : markerDiv,\n                stopEvent : false\n            });\n            map.addOverlay(this._marker);\n\n            if (display) {\n                logger.log(\"marker information : \", information);\n            }\n            // // FIXME\n            // // doit on mettre une information\n            // // - correctement construite ?\n            // // - uniquement informatif ?\n            // // - RIEN ?\n            // if (display) {\n            //     var popupContent = null;\n            //\n            //     var values = [];\n            //\n            //     values.push(information.fields.fullText || \"\");\n            //     values.push(information.fields.street || \"\");\n            //     values.push(information.fields.postalCode || \"\");\n            //     values.push(information.fields.commune || \"\");\n            //\n            //     if (information.type === \"PositionOfInterest\") {\n            //         values.push(information.fields.poi || \"\");\n            //         values.push(information.fields.kind || \"\");\n            //     }\n            //\n            //     popupContent = values.join(\" | \");\n            //\n            //     this._marker.bindPopup(popupContent);\n            // }\n        }\n    }\n\n    /**\n     * this method is called by this.onAutoCompleteSearchText()\n     * and it clears all suggested location.\n     *\n     * @private\n     */\n    _clearSuggestedLocation () {\n        // suppression du dom\n        this._suggestedLocations = [];\n        if (this._suggestedList) {\n            while (this._suggestedList.firstChild) {\n                this._suggestedList.removeChild(this._suggestedList.firstChild);\n            }\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on map\n     * and it hide suggested locations\n     *\n     * @private\n     */\n    _hideSuggestedLocation () {\n        if (this._suggestedContainer) {\n            this._suggestedContainer.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n            this._suggestedContainer.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n        }\n    }\n\n    /**\n     * this method is called by this.onAutoCompleteSearchText()\n     * and it clears all suggested location.\n     *\n     * @private\n     */\n    _displaySuggestedLocation () {\n        if (this._suggestedContainer) {\n            this._suggestedContainer.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n            this._suggestedContainer.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n        }\n    }\n\n    /**\n     * this method is called by this.onAutoCompleteSearch()\n     * and executes a request to the service.\n     *\n     * @param {Object} settings - service settings\n     * @param {String}   settings.text - text\n     * @param {Function} settings.onSuccess - callback\n     * @param {Function} settings.onFailure - callback\n     * @private\n     */\n    _requestAutoComplete (settings) {\n        logger.log(\"_requestAutoComplete()\", settings);\n\n        // on ne fait pas de requête si on n'a pas renseigné de parametres !\n        if (!settings || Object.keys(settings).length === 0) {\n            return;\n        }\n\n        // on ne fait pas de requête si la parametre 'text' est vide !\n        if (!settings.text) {\n            return;\n        }\n\n        logger.log(settings);\n\n        var options = {};\n        // on recupere les options du service\n        Utils.assign(options, this.options.autocompleteOptions);\n        // ainsi que la recherche et les callbacks\n        Utils.assign(options, settings);\n\n        // les ressources\n        var resources = this._resources[\"AutoCompletion\"] || null;\n        if (resources && Array.isArray(resources)) {\n            if (!options.filterOptions) {\n                options.filterOptions = {};\n            }\n            options.filterOptions.type = resources;\n        }\n\n        // cas où la clef API n'est pas renseignée dans les options du service,\n        // on utilise celle renseignée au niveau du controle ou la clé \"calcul\" par défaut.\n        options.apiKey = options.apiKey || this.options.apiKey;\n\n        // si l'utilisateur a spécifié le paramètre ssl au niveau du control, on s'en sert\n        // true par défaut (https)\n        if (typeof options.ssl !== \"boolean\") {\n            if (typeof this.options.ssl === \"boolean\") {\n                options.ssl = this.options.ssl;\n            } else {\n                options.ssl = true;\n            }\n        }\n\n        logger.log(options);\n\n        Gp.Services.autoComplete(options);\n    }\n\n    /**\n     * this method is called by this.onAutoCompleteSearchText()\n     * and fills the container of the location list.\n     * it creates a HTML Element per location\n     * (cf. this. ...)\n     *\n     * @param {Object[]} locations - locations\n     *\n     * @private\n     */\n    _fillAutoCompletedLocationListContainer (locations) {\n        if (!locations || locations.length === 0) {\n            return;\n        }\n\n        // on vide la liste avant de la construire\n        var element = this._suggestedList;\n        if (element.childElementCount) {\n            while (element.firstChild) {\n                element.removeChild(element.firstChild);\n            }\n        }\n\n        for (var i = 0; i < locations.length; i++) {\n            // Proposals are dynamically filled in Javascript by autocomplete service\n            this._createLocationAutoCompletedLocationElement(this.options.tag.id, locations[i], i);\n        }\n\n        // sauvegarde de l'etat des locations\n        this._suggestedLocations = locations;\n    }\n\n};\n\n// on récupère les méthodes de la classe DOM\nObject.assign(LocationSelector.prototype, LocationSelectorDOM);\n\nexport default LocationSelector;\n\n// Expose LocationSelector as ol.control.LocationSelector (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.LocationSelector = LocationSelector;\n}\n","'use strict';\n\n/**\n * Detects relevant unicode support for regular expressions in the runtime.\n * Should the runtime not accepts the flag `u` or unicode ranges,\n * character classes without unicode handling will be used.\n *\n * @param {typeof RegExp} [RegExpImpl=RegExp]\n * For testing: the RegExp class.\n * @returns {boolean}\n * @see https://node.green/#ES2015-syntax-RegExp--y--and--u--flags\n */\nfunction detectUnicodeSupport(RegExpImpl) {\n\ttry {\n\t\tif (typeof RegExpImpl !== 'function') {\n\t\t\tRegExpImpl = RegExp;\n\t\t}\n\t\t// eslint-disable-next-line es5/no-unicode-regex,es5/no-unicode-code-point-escape\n\t\tvar match = new RegExpImpl('\\u{1d306}', 'u').exec('𝌆');\n\t\treturn !!match && match[0].length === 2;\n\t} catch (error) {}\n\treturn false;\n}\nvar UNICODE_SUPPORT = detectUnicodeSupport();\n\n/**\n * Removes `[`, `]` and any trailing quantifiers from the source of a RegExp.\n *\n * @param {RegExp} regexp\n */\nfunction chars(regexp) {\n\tif (regexp.source[0] !== '[') {\n\t\tthrow new Error(regexp + ' can not be used with chars');\n\t}\n\treturn regexp.source.slice(1, regexp.source.lastIndexOf(']'));\n}\n\n/**\n * Creates a new character list regular expression,\n * by removing `search` from the source of `regexp`.\n *\n * @param {RegExp} regexp\n * @param {string} search\n * The character(s) to remove.\n * @returns {RegExp}\n */\nfunction chars_without(regexp, search) {\n\tif (regexp.source[0] !== '[') {\n\t\tthrow new Error('/' + regexp.source + '/ can not be used with chars_without');\n\t}\n\tif (!search || typeof search !== 'string') {\n\t\tthrow new Error(JSON.stringify(search) + ' is not a valid search');\n\t}\n\tif (regexp.source.indexOf(search) === -1) {\n\t\tthrow new Error('\"' + search + '\" is not is /' + regexp.source + '/');\n\t}\n\tif (search === '-' && regexp.source.indexOf(search) !== 1) {\n\t\tthrow new Error('\"' + search + '\" is not at the first postion of /' + regexp.source + '/');\n\t}\n\treturn new RegExp(regexp.source.replace(search, ''), UNICODE_SUPPORT ? 'u' : '');\n}\n\n/**\n * Combines and Regular expressions correctly by using `RegExp.source`.\n *\n * @param {...(RegExp | string)[]} args\n * @returns {RegExp}\n */\nfunction reg(args) {\n\tvar self = this;\n\treturn new RegExp(\n\t\tArray.prototype.slice\n\t\t\t.call(arguments)\n\t\t\t.map(function (part) {\n\t\t\t\tvar isStr = typeof part === 'string';\n\t\t\t\tif (isStr && self === undefined && part === '|') {\n\t\t\t\t\tthrow new Error('use regg instead of reg to wrap expressions with `|`!');\n\t\t\t\t}\n\t\t\t\treturn isStr ? part : part.source;\n\t\t\t})\n\t\t\t.join(''),\n\t\tUNICODE_SUPPORT ? 'mu' : 'm'\n\t);\n}\n\n/**\n * Like `reg` but wraps the expression in `(?:`,`)` to create a non tracking group.\n *\n * @param {...(RegExp | string)[]} args\n * @returns {RegExp}\n */\nfunction regg(args) {\n\tif (arguments.length === 0) {\n\t\tthrow new Error('no parameters provided');\n\t}\n\treturn reg.apply(regg, ['(?:'].concat(Array.prototype.slice.call(arguments), [')']));\n}\n\n// /**\n//  * Append ^ to the beginning of the expression.\n//  * @param {...(RegExp | string)[]} args\n//  * @returns {RegExp}\n//  */\n// function reg_start(args) {\n// \tif (arguments.length === 0) {\n// \t\tthrow new Error('no parameters provided');\n// \t}\n// \treturn reg.apply(reg_start, ['^'].concat(Array.prototype.slice.call(arguments)));\n// }\n\n// https://www.w3.org/TR/xml/#document\n// `[1] document ::= prolog element Misc*`\n// https://www.w3.org/TR/xml11/#NT-document\n// `[1] document ::= ( prolog element Misc* ) - ( Char* RestrictedChar Char* )`\n\n/**\n * A character usually appearing in wrongly converted strings.\n *\n * @type {string}\n * @see https://en.wikipedia.org/wiki/Specials_(Unicode_block)#Replacement_character\n * @see https://nodejs.dev/en/api/v18/buffer/#buffers-and-character-encodings\n * @see https://www.unicode.org/faq/utf_bom.html#BOM\n * @readonly\n */\nvar UNICODE_REPLACEMENT_CHARACTER = '\\uFFFD';\n// https://www.w3.org/TR/xml/#NT-Char\n// any Unicode character, excluding the surrogate blocks, FFFE, and FFFF.\n// `[2] Char ::= #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]`\n// https://www.w3.org/TR/xml11/#NT-Char\n// `[2] Char ::= [#x1-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]`\n// https://www.w3.org/TR/xml11/#NT-RestrictedChar\n// `[2a] RestrictedChar ::= [#x1-#x8] | [#xB-#xC] | [#xE-#x1F] | [#x7F-#x84] | [#x86-#x9F]`\n// https://www.w3.org/TR/xml11/#charsets\nvar Char = /[-\\x09\\x0A\\x0D\\x20-\\x2C\\x2E-\\uD7FF\\uE000-\\uFFFD]/; // without \\u10000-\\uEFFFF\nif (UNICODE_SUPPORT) {\n\t// eslint-disable-next-line es5/no-unicode-code-point-escape\n\tChar = reg('[', chars(Char), '\\\\u{10000}-\\\\u{10FFFF}', ']');\n}\n\nvar _SChar = /[\\x20\\x09\\x0D\\x0A]/;\nvar SChar_s = chars(_SChar);\n// https://www.w3.org/TR/xml11/#NT-S\n// `[3] S ::= (#x20 | #x9 | #xD | #xA)+`\nvar S = reg(_SChar, '+');\n// optional whitespace described as `S?` in the grammar,\n// simplified to 0-n occurrences of the character class\n// instead of 0-1 occurrences of a non-capturing group around S\nvar S_OPT = reg(_SChar, '*');\n\n// https://www.w3.org/TR/xml11/#NT-NameStartChar\n// `[4] NameStartChar ::= \":\" | [A-Z] | \"_\" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]`\nvar NameStartChar =\n\t/[:_a-zA-Z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02FF\\u0370-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]/; // without \\u10000-\\uEFFFF\nif (UNICODE_SUPPORT) {\n\t// eslint-disable-next-line es5/no-unicode-code-point-escape\n\tNameStartChar = reg('[', chars(NameStartChar), '\\\\u{10000}-\\\\u{10FFFF}', ']');\n}\nvar NameStartChar_s = chars(NameStartChar);\n\n// https://www.w3.org/TR/xml11/#NT-NameChar\n// `[4a] NameChar ::= NameStartChar | \"-\" | \".\" | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]`\nvar NameChar = reg('[', NameStartChar_s, chars(/[-.0-9\\xB7]/), chars(/[\\u0300-\\u036F\\u203F-\\u2040]/), ']');\n// https://www.w3.org/TR/xml11/#NT-Name\n// `[5] Name ::= NameStartChar (NameChar)*`\nvar Name = reg(NameStartChar, NameChar, '*');\n/*\nhttps://www.w3.org/TR/xml11/#NT-Names\n`[6] Names ::= Name (#x20 Name)*`\n*/\n\n// https://www.w3.org/TR/xml11/#NT-Nmtoken\n// `[7] Nmtoken ::= (NameChar)+`\nvar Nmtoken = reg(NameChar, '+');\n/*\nhttps://www.w3.org/TR/xml11/#NT-Nmtokens\n`[8] Nmtokens ::= Nmtoken (#x20 Nmtoken)*`\nvar Nmtokens = reg(Nmtoken, regg(/\\x20/, Nmtoken), '*');\n*/\n\n// https://www.w3.org/TR/xml11/#NT-EntityRef\n// `[68] EntityRef ::= '&' Name ';'` [WFC: Entity Declared] [VC: Entity Declared] [WFC: Parsed Entity] [WFC: No Recursion]\nvar EntityRef = reg('&', Name, ';');\n// https://www.w3.org/TR/xml11/#NT-CharRef\n// `[66] CharRef ::= '&#' [0-9]+ ';' | '&#x' [0-9a-fA-F]+ ';'` [WFC: Legal Character]\nvar CharRef = regg(/&#[0-9]+;|&#x[0-9a-fA-F]+;/);\n\n/*\nhttps://www.w3.org/TR/xml11/#NT-Reference\n- `[67] Reference ::= EntityRef | CharRef`\n- `[66] CharRef ::= '&#' [0-9]+ ';' | '&#x' [0-9a-fA-F]+ ';'` [WFC: Legal Character]\n- `[68] EntityRef ::= '&' Name ';'` [WFC: Entity Declared] [VC: Entity Declared] [WFC: Parsed Entity] [WFC: No Recursion]\n*/\nvar Reference = regg(EntityRef, '|', CharRef);\n\n// https://www.w3.org/TR/xml11/#NT-PEReference\n// `[69] PEReference ::= '%' Name ';'`\n// [VC: Entity Declared] [WFC: No Recursion] [WFC: In DTD]\nvar PEReference = reg('%', Name, ';');\n\n// https://www.w3.org/TR/xml11/#NT-EntityValue\n// `[9] EntityValue ::= '\"' ([^%&\"] | PEReference | Reference)* '\"' | \"'\" ([^%&'] | PEReference | Reference)* \"'\"`\nvar EntityValue = regg(\n\treg('\"', regg(/[^%&\"]/, '|', PEReference, '|', Reference), '*', '\"'),\n\t'|',\n\treg(\"'\", regg(/[^%&']/, '|', PEReference, '|', Reference), '*', \"'\")\n);\n\n// https://www.w3.org/TR/xml11/#NT-AttValue\n// `[10] AttValue ::= '\"' ([^<&\"] | Reference)* '\"' | \"'\" ([^<&'] | Reference)* \"'\"`\nvar AttValue = regg('\"', regg(/[^<&\"]/, '|', Reference), '*', '\"', '|', \"'\", regg(/[^<&']/, '|', Reference), '*', \"'\");\n\n// https://www.w3.org/TR/xml-names/#ns-decl\n// https://www.w3.org/TR/xml-names/#ns-qualnames\n// NameStartChar without \":\"\nvar NCNameStartChar = chars_without(NameStartChar, ':');\n// https://www.w3.org/TR/xml-names/#orphans\n// `[5] NCNameChar ::= NameChar - ':'`\n// An XML NameChar, minus the \":\"\nvar NCNameChar = chars_without(NameChar, ':');\n// https://www.w3.org/TR/xml-names/#NT-NCName\n// `[4] NCName ::= Name - (Char* ':' Char*)`\n// An XML Name, minus the \":\"\nvar NCName = reg(NCNameStartChar, NCNameChar, '*');\n\n/**\nhttps://www.w3.org/TR/xml-names/#ns-qualnames\n\n```\n[7] QName ::= PrefixedName | UnprefixedName\n\t\t\t\t  === (NCName ':' NCName) | NCName\n\t\t\t\t  === NCName (':' NCName)?\n[8] PrefixedName ::= Prefix ':' LocalPart\n\t\t\t\t\t\t\t\t === NCName ':' NCName\n[9] UnprefixedName ::= LocalPart\n\t\t\t\t\t\t\t\t\t === NCName\n[10] Prefix ::= NCName\n[11] LocalPart ::= NCName\n```\n*/\nvar QName = reg(NCName, regg(':', NCName), '?');\nvar QName_exact = reg('^', QName, '$');\nvar QName_group = reg('(', QName, ')');\n\n// https://www.w3.org/TR/xml11/#NT-SystemLiteral\n// `[11] SystemLiteral ::= ('\"' [^\"]* '\"') | (\"'\" [^']* \"'\")`\nvar SystemLiteral = regg(/\"[^\"]*\"|'[^']*'/);\n\n/*\n https://www.w3.org/TR/xml11/#NT-PI\n ```\n [17] PITarget    ::= Name - (('X' | 'x') ('M' | 'm') ('L' | 'l'))\n [16] PI    ::= '<?' PITarget (S (Char* - (Char* '?>' Char*)))? '?>'\n ```\n target /xml/i is not excluded!\n*/\nvar PI = reg(/^<\\?/, '(', Name, ')', regg(S, '(', Char, '*?)'), '?', /\\?>/);\n\n// https://www.w3.org/TR/xml11/#NT-PubidChar\n// `[13] PubidChar ::= #x20 | #xD | #xA | [a-zA-Z0-9] | [-'()+,./:=?;!*#@$_%]`\nvar PubidChar = /[\\x20\\x0D\\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/;\n\n// https://www.w3.org/TR/xml11/#NT-PubidLiteral\n// `[12] PubidLiteral ::= '\"' PubidChar* '\"' | \"'\" (PubidChar - \"'\")* \"'\"`\nvar PubidLiteral = regg('\"', PubidChar, '*\"', '|', \"'\", chars_without(PubidChar, \"'\"), \"*'\");\n\n// https://www.w3.org/TR/xml11/#NT-CharData\n// `[14] CharData    ::= [^<&]* - ([^<&]* ']]>' [^<&]*)`\n\nvar COMMENT_START = '<!--';\nvar COMMENT_END = '-->';\n// https://www.w3.org/TR/xml11/#NT-Comment\n// `[15] Comment ::= '<!--' ((Char - '-') | ('-' (Char - '-')))* '-->'`\nvar Comment = reg(COMMENT_START, regg(chars_without(Char, '-'), '|', reg('-', chars_without(Char, '-'))), '*', COMMENT_END);\n\nvar PCDATA = '#PCDATA';\n// https://www.w3.org/TR/xml11/#NT-Mixed\n// `[51] Mixed ::= '(' S? '#PCDATA' (S? '|' S? Name)* S? ')*' | '(' S? '#PCDATA' S? ')'`\n// https://www.w3.org/TR/xml-names/#NT-Mixed\n// `[51] Mixed ::= '(' S? '#PCDATA' (S? '|' S? QName)* S? ')*' | '(' S? '#PCDATA' S? ')'`\n// [VC: Proper Group/PE Nesting] [VC: No Duplicate Types]\nvar Mixed = regg(\n\treg(/\\(/, S_OPT, PCDATA, regg(S_OPT, /\\|/, S_OPT, QName), '*', S_OPT, /\\)\\*/),\n\t'|',\n\treg(/\\(/, S_OPT, PCDATA, S_OPT, /\\)/)\n);\n\nvar _children_quantity = /[?*+]?/;\n/*\n `[49] choice ::= '(' S? cp ( S? '|' S? cp )+ S? ')'` [VC: Proper Group/PE Nesting]\n `[50] seq ::= '(' S? cp ( S? ',' S? cp )* S? ')'` [VC: Proper Group/PE Nesting]\n simplification to solve circular referencing, but doesn't check validity constraint \"Proper Group/PE Nesting\"\n var _choice_or_seq = reg('[', NameChar_s, SChar_s, chars(_children_quantity), '()|,]*');\n ```\n [48] cp ::= (Name | choice | seq) ('?' | '*' | '+')?\n         === (Name | '(' S? cp ( S? '|' S? cp )+ S? ')' | '(' S? cp ( S? ',' S? cp )* S? ')') ('?' | '*' | '+')?\n         !== (Name | [_choice_or_seq]*) ('?' | '*' | '+')?\n ```\n simplification to solve circular referencing, but doesn't check validity constraint \"Proper Group/PE Nesting\"\n var cp = reg(regg(Name, '|', _choice_or_seq), _children_quantity);\n*/\n/*\nInefficient regular expression (High)\nThis part of the regular expression may cause exponential backtracking on strings starting with '(|' and containing many repetitions of '|'.\nhttps://github.com/xmldom/xmldom/security/code-scanning/91\nvar choice = regg(/\\(/, S_OPT, cp, regg(S_OPT, /\\|/, S_OPT, cp), '+', S_OPT, /\\)/);\n*/\n/*\nInefficient regular expression (High)\nThis part of the regular expression may cause exponential backtracking on strings starting with '(,' and containing many repetitions of ','.\nhttps://github.com/xmldom/xmldom/security/code-scanning/92\nvar seq = regg(/\\(/, S_OPT, cp, regg(S_OPT, /,/, S_OPT, cp), '*', S_OPT, /\\)/);\n*/\n\n// `[47] children ::= (choice | seq) ('?' | '*' | '+')?`\n// simplification to solve circular referencing, but doesn't check validity constraint \"Proper Group/PE Nesting\"\nvar children = reg(/\\([^>]+\\)/, _children_quantity /*regg(choice, '|', seq), _children_quantity*/);\n\n// https://www.w3.org/TR/xml11/#NT-contentspec\n// `[46] contentspec ::= 'EMPTY' | 'ANY' | Mixed | children`\nvar contentspec = regg('EMPTY', '|', 'ANY', '|', Mixed, '|', children);\n\nvar ELEMENTDECL_START = '<!ELEMENT';\n// https://www.w3.org/TR/xml11/#NT-elementdecl\n// `[45] elementdecl ::= '<!ELEMENT' S Name S contentspec S? '>'`\n// https://www.w3.org/TR/xml-names/#NT-elementdecl\n// `[17] elementdecl ::= '<!ELEMENT' S QName S contentspec S? '>'`\n// because of https://www.w3.org/TR/xml11/#NT-PEReference\n// since xmldom is not supporting replacements of PEReferences in the DTD\n// this also supports PEReference in the possible places\nvar elementdecl = reg(ELEMENTDECL_START, S, regg(QName, '|', PEReference), S, regg(contentspec, '|', PEReference), S_OPT, '>');\n\n// https://www.w3.org/TR/xml11/#NT-NotationType\n// `[58] NotationType ::= 'NOTATION' S '(' S? Name (S? '|' S? Name)* S? ')'`\n// [VC: Notation Attributes] [VC: One Notation Per Element Type] [VC: No Notation on Empty Element] [VC: No Duplicate Tokens]\nvar NotationType = reg('NOTATION', S, /\\(/, S_OPT, Name, regg(S_OPT, /\\|/, S_OPT, Name), '*', S_OPT, /\\)/);\n// https://www.w3.org/TR/xml11/#NT-Enumeration\n// `[59] Enumeration ::= '(' S? Nmtoken (S? '|' S? Nmtoken)* S? ')'`\n// [VC: Enumeration] [VC: No Duplicate Tokens]\nvar Enumeration = reg(/\\(/, S_OPT, Nmtoken, regg(S_OPT, /\\|/, S_OPT, Nmtoken), '*', S_OPT, /\\)/);\n\n// https://www.w3.org/TR/xml11/#NT-EnumeratedType\n// `[57] EnumeratedType ::= NotationType | Enumeration`\nvar EnumeratedType = regg(NotationType, '|', Enumeration);\n\n/*\n```\n[55] StringType ::= 'CDATA'\n[56] TokenizedType ::= 'ID' [VC: ID] [VC: One ID per Element Type] [VC: ID Attribute Default]\n   | 'IDREF' [VC: IDREF]\n   | 'IDREFS' [VC: IDREF]\n\t | 'ENTITY' [VC: Entity Name]\n\t | 'ENTITIES' [VC: Entity Name]\n\t | 'NMTOKEN' [VC: Name Token]\n\t | 'NMTOKENS' [VC: Name Token]\n [54] AttType ::= StringType | TokenizedType | EnumeratedType\n```*/\nvar AttType = regg(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/, '|', EnumeratedType);\n\n// `[60] DefaultDecl ::= '#REQUIRED' | '#IMPLIED' | (('#FIXED' S)? AttValue)`\n// [WFC: No < in Attribute Values] [WFC: No External Entity References]\n// [VC: Fixed Attribute Default] [VC: Required Attribute] [VC: Attribute Default Value Syntactically Correct]\nvar DefaultDecl = regg(/#REQUIRED|#IMPLIED/, '|', regg(regg('#FIXED', S), '?', AttValue));\n\n// https://www.w3.org/TR/xml11/#NT-AttDef\n// [53] AttDef ::= S Name S AttType S DefaultDecl\n// https://www.w3.org/TR/xml-names/#NT-AttDef\n// [1] NSAttName ::= PrefixedAttName | DefaultAttName\n// [2] PrefixedAttName ::= 'xmlns:' NCName [NSC: Reserved Prefixes and Namespace Names]\n// [3] DefaultAttName ::= 'xmlns'\n// [21] AttDef ::= S (QName | NSAttName) S AttType S DefaultDecl\n// \t\t\t\t\t\t === S Name S AttType S DefaultDecl\n// xmldom is not distinguishing between QName and NSAttName on this level\n// to support XML without namespaces in DTD we can not restrict it to QName\nvar AttDef = regg(S, Name, S, AttType, S, DefaultDecl);\n\nvar ATTLIST_DECL_START = '<!ATTLIST';\n// https://www.w3.org/TR/xml11/#NT-AttlistDecl\n// `[52] AttlistDecl ::= '<!ATTLIST' S Name AttDef* S? '>'`\n// https://www.w3.org/TR/xml-names/#NT-AttlistDecl\n// `[20] AttlistDecl ::= '<!ATTLIST' S QName AttDef* S? '>'`\n// to support XML without namespaces in DTD we can not restrict it to QName\nvar AttlistDecl = reg(ATTLIST_DECL_START, S, Name, AttDef, '*', S_OPT, '>');\n\n// https://html.spec.whatwg.org/multipage/urls-and-fetching.html#about:legacy-compat\nvar ABOUT_LEGACY_COMPAT = 'about:legacy-compat';\nvar ABOUT_LEGACY_COMPAT_SystemLiteral = regg('\"' + ABOUT_LEGACY_COMPAT + '\"', '|', \"'\" + ABOUT_LEGACY_COMPAT + \"'\");\nvar SYSTEM = 'SYSTEM';\nvar PUBLIC = 'PUBLIC';\n// https://www.w3.org/TR/xml11/#NT-ExternalID\n// `[75] ExternalID ::= 'SYSTEM' S SystemLiteral | 'PUBLIC' S PubidLiteral S SystemLiteral`\nvar ExternalID = regg(regg(SYSTEM, S, SystemLiteral), '|', regg(PUBLIC, S, PubidLiteral, S, SystemLiteral));\nvar ExternalID_match = reg(\n\t'^',\n\tregg(\n\t\tregg(SYSTEM, S, '(?<SystemLiteralOnly>', SystemLiteral, ')'),\n\t\t'|',\n\t\tregg(PUBLIC, S, '(?<PubidLiteral>', PubidLiteral, ')', S, '(?<SystemLiteral>', SystemLiteral, ')')\n\t)\n);\n\n// https://www.w3.org/TR/xml11/#NT-NDataDecl\n// `[76] NDataDecl ::= S 'NDATA' S Name` [VC: Notation Declared]\nvar NDataDecl = regg(S, 'NDATA', S, Name);\n\n// https://www.w3.org/TR/xml11/#NT-EntityDef\n// `[73] EntityDef ::= EntityValue | (ExternalID NDataDecl?)`\nvar EntityDef = regg(EntityValue, '|', regg(ExternalID, NDataDecl, '?'));\n\nvar ENTITY_DECL_START = '<!ENTITY';\n// https://www.w3.org/TR/xml11/#NT-GEDecl\n// `[71] GEDecl ::= '<!ENTITY' S Name S EntityDef S? '>'`\nvar GEDecl = reg(ENTITY_DECL_START, S, Name, S, EntityDef, S_OPT, '>');\n// https://www.w3.org/TR/xml11/#NT-PEDef\n// `[74] PEDef ::= EntityValue | ExternalID`\nvar PEDef = regg(EntityValue, '|', ExternalID);\n// https://www.w3.org/TR/xml11/#NT-PEDecl\n// `[72] PEDecl ::= '<!ENTITY' S '%' S Name S PEDef S? '>'`\nvar PEDecl = reg(ENTITY_DECL_START, S, '%', S, Name, S, PEDef, S_OPT, '>');\n// https://www.w3.org/TR/xml11/#NT-EntityDecl\n// `[70] EntityDecl ::= GEDecl | PEDecl`\nvar EntityDecl = regg(GEDecl, '|', PEDecl);\n\n// https://www.w3.org/TR/xml11/#NT-PublicID\n// `[83] PublicID    ::= 'PUBLIC' S PubidLiteral`\nvar PublicID = reg(PUBLIC, S, PubidLiteral);\n// https://www.w3.org/TR/xml11/#NT-NotationDecl\n// `[82] NotationDecl    ::= '<!NOTATION' S Name S (ExternalID | PublicID) S? '>'` [VC: Unique Notation Name]\nvar NotationDecl = reg('<!NOTATION', S, Name, S, regg(ExternalID, '|', PublicID), S_OPT, '>');\n\n// https://www.w3.org/TR/xml11/#NT-Eq\n// `[25] Eq ::= S? '=' S?`\nvar Eq = reg(S_OPT, '=', S_OPT);\n// https://www.w3.org/TR/xml/#NT-VersionNum\n// `[26] VersionNum ::= '1.' [0-9]+`\n// https://www.w3.org/TR/xml11/#NT-VersionNum\n// `[26] VersionNum ::= '1.1'`\nvar VersionNum = /1[.]\\d+/;\n// https://www.w3.org/TR/xml11/#NT-VersionInfo\n// `[24] VersionInfo ::= S 'version' Eq (\"'\" VersionNum \"'\" | '\"' VersionNum '\"')`\nvar VersionInfo = reg(S, 'version', Eq, regg(\"'\", VersionNum, \"'\", '|', '\"', VersionNum, '\"'));\n// https://www.w3.org/TR/xml11/#NT-EncName\n// `[81] EncName ::= [A-Za-z] ([A-Za-z0-9._] | '-')*`\nvar EncName = /[A-Za-z][-A-Za-z0-9._]*/;\n// https://www.w3.org/TR/xml11/#NT-EncDecl\n// `[80] EncodingDecl ::= S 'encoding' Eq ('\"' EncName '\"' | \"'\" EncName \"'\" )`\nvar EncodingDecl = regg(S, 'encoding', Eq, regg('\"', EncName, '\"', '|', \"'\", EncName, \"'\"));\n// https://www.w3.org/TR/xml11/#NT-SDDecl\n// `[32] SDDecl ::= S 'standalone' Eq ((\"'\" ('yes' | 'no') \"'\") | ('\"' ('yes' | 'no') '\"'))`\nvar SDDecl = regg(S, 'standalone', Eq, regg(\"'\", regg('yes', '|', 'no'), \"'\", '|', '\"', regg('yes', '|', 'no'), '\"'));\n// https://www.w3.org/TR/xml11/#NT-XMLDecl\n// [23] XMLDecl ::= '<?xml' VersionInfo EncodingDecl? SDDecl? S? '?>'\nvar XMLDecl = reg(/^<\\?xml/, VersionInfo, EncodingDecl, '?', SDDecl, '?', S_OPT, /\\?>/);\n\n/*\n https://www.w3.org/TR/xml/#NT-markupdecl\n https://www.w3.org/TR/xml11/#NT-markupdecl\n `[29] markupdecl ::= elementdecl | AttlistDecl | EntityDecl | NotationDecl | PI | Comment`\n var markupdecl = regg(elementdecl, '|', AttlistDecl, '|', EntityDecl, '|', NotationDecl, '|', PI_unsafe, '|', Comment);\n*/\n/*\n https://www.w3.org/TR/xml-names/#NT-doctypedecl\n`[28a] DeclSep   ::= PEReference | S`\n https://www.w3.org/TR/xml11/#NT-intSubset\n```\n [28b] intSubset ::= (markupdecl | DeclSep)*\n                 === (markupdecl | PEReference | S)*\n```\n [WFC: PE Between Declarations]\n var intSubset = reg(regg(markupdecl, '|', PEReference, '|', S), '*');\n*/\nvar DOCTYPE_DECL_START = '<!DOCTYPE';\n/*\n https://www.w3.org/TR/xml11/#NT-doctypedecl\n `[28] doctypedecl ::= '<!DOCTYPE' S Name (S ExternalID)? S? ('[' intSubset ']' S?)? '>'`\n https://www.afterwardsw3.org/TR/xml-names/#NT-doctypedecl\n `[16] doctypedecl ::= '<!DOCTYPE' S QName (S ExternalID)? S? ('[' (markupdecl | PEReference | S)* ']' S?)? '>'`\n var doctypedecl = reg('<!DOCTYPE', S, Name, regg(S, ExternalID), '?', S_OPT, regg(/\\[/, intSubset, /]/, S_OPT), '?', '>');\n*/\n\nvar CDATA_START = '<![CDATA[';\nvar CDATA_END = ']]>';\nvar CDStart = /<!\\[CDATA\\[/;\nvar CDEnd = /\\]\\]>/;\nvar CData = reg(Char, '*?', CDEnd);\n/*\n https://www.w3.org/TR/xml/#dt-cdsection\n `[18]   \tCDSect\t   ::=   \tCDStart CData CDEnd`\n `[19]   \tCDStart\t   ::=   \t'<![CDATA['`\n `[20]   \tCData\t   ::=   \t(Char* - (Char* ']]>' Char*))`\n `[21]   \tCDEnd\t   ::=   \t']]>'`\n*/\nvar CDSect = reg(CDStart, CData);\n\n// unit tested\nexports.chars = chars;\nexports.chars_without = chars_without;\nexports.detectUnicodeSupport = detectUnicodeSupport;\nexports.reg = reg;\nexports.regg = regg;\nexports.ABOUT_LEGACY_COMPAT = ABOUT_LEGACY_COMPAT;\nexports.ABOUT_LEGACY_COMPAT_SystemLiteral = ABOUT_LEGACY_COMPAT_SystemLiteral;\nexports.AttlistDecl = AttlistDecl;\nexports.CDATA_START = CDATA_START;\nexports.CDATA_END = CDATA_END;\nexports.CDSect = CDSect;\nexports.Char = Char;\nexports.Comment = Comment;\nexports.COMMENT_START = COMMENT_START;\nexports.COMMENT_END = COMMENT_END;\nexports.DOCTYPE_DECL_START = DOCTYPE_DECL_START;\nexports.elementdecl = elementdecl;\nexports.EntityDecl = EntityDecl;\nexports.EntityValue = EntityValue;\nexports.ExternalID = ExternalID;\nexports.ExternalID_match = ExternalID_match;\nexports.Name = Name;\nexports.NotationDecl = NotationDecl;\nexports.Reference = Reference;\nexports.PEReference = PEReference;\nexports.PI = PI;\nexports.PUBLIC = PUBLIC;\nexports.PubidLiteral = PubidLiteral;\nexports.QName = QName;\nexports.QName_exact = QName_exact;\nexports.QName_group = QName_group;\nexports.S = S;\nexports.SChar_s = SChar_s;\nexports.S_OPT = S_OPT;\nexports.SYSTEM = SYSTEM;\nexports.SystemLiteral = SystemLiteral;\nexports.UNICODE_REPLACEMENT_CHARACTER = UNICODE_REPLACEMENT_CHARACTER;\nexports.UNICODE_SUPPORT = UNICODE_SUPPORT;\nexports.XMLDecl = XMLDecl;\n","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\n\n/**\n * @classdesc\n * Classe de gestion des param. des requêtes du service de calcul d'itineraire (REST).\n *      Permet le mapping avec les options du service.\n * @constructor\n * @alias Gp.Services.Route.Request.RouteParamREST\n * @param {Object} options - options\n *\n * @private\n */\nfunction RouteParamREST (options) {\n    if (!(this instanceof RouteParamREST)) {\n        throw new TypeError(\"RouteParamREST constructor cannot be called as a function.\");\n    }\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur RouteParamREST ()]\");\n    /**\n     * Options en paramêtres du constructeur.\n     */\n    this.options = options || {};\n\n    // mapping des options avec l'API REST\n\n    /** Ressource utilisée */\n    this.resource = this.options.resource;\n\n    /** Coordonnées du point de départ. */\n    this.start = this.options.startPoint.x + \",\" + this.options.startPoint.y;\n\n    /** Coordonnées du point d’arrivée. */\n    this.end = this.options.endPoint.x + \",\" + this.options.endPoint.y;\n\n    /** Coordonnées des étapes point de départ. */\n    this.intermediates = this.options.viaPoints;\n\n    /** Nom du profile à utiliser */\n    this.profile = this.options.graph;\n\n    /** projection (code EPSG comme epsg:4326 ou wgs84) */\n    this.crs = this.options.srs;\n\n    /** Liste des contraintes */\n    this.constraints = this.options.constraints;\n\n    /** Nom de l'optimisation à utiliser */\n    this.optimization = this.options.routePreference;\n\n    /** Format de sortie (résumé de l’itinéraire) */\n    this.getSteps = (this.options.geometryInInstructions) ? \"true\" : \"false\";\n\n    /** Unité des distances */\n    this.distanceUnit = this.options.distanceUnit;\n\n    /** Unité des durées */\n    this.timeUnit = this.options.timeUnit;\n\n    /** Attributs des voies */\n    this.waysAttributes = this.options.waysAttributes;\n}\n\n/**\n * CLASSNAME\n */\nRouteParamREST.CLASSNAME = \"RouteParamREST\";\n\nRouteParamREST.prototype = {\n\n    /**\n     * @lends module:RouteParamREST#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RouteParamREST,\n\n    /**\n     * Retourne une liste de points\n     * @returns {String} une liste de points (sep '|')\n     */\n    getIntermediates : function () {\n        var array = [];\n        if (this.intermediates.length !== 0) {\n            for (var i = 0; i < this.intermediates.length; i++) {\n                var obj = this.intermediates[i];\n                array.push(obj.x + \",\" + obj.y);\n            }\n        }\n\n        return array.join(\"|\");\n    },\n\n    /**\n     * Retourne une liste d'attributs\n     * @returns {String} une liste d'attributs (sep '|')\n     */\n    getWaysAttributes : function () {\n        return this.waysAttributes.join(\"|\");\n    },\n\n    /**\n     * Retourne un profile\n     * @returns {String} profile\n     */\n    getProfile : function () {\n        return this.profile;\n    },\n\n    /**\n     * Retourne un distanceUnit\n     * @returns {String} distanceUnit\n     */\n    getDistanceUnit : function () {\n        if (this.distanceUnit === \"m\") {\n            return \"meter\";\n        }\n        if (this.distanceUnit === \"km\") {\n            return \"kilometer\";\n        }\n        return \"\";\n    },\n\n    /**\n     * Retourne une optimisation\n     * @returns {String} optimization\n     */\n    getOptimization : function () {\n        if (this.optimization) {\n            return this.optimization;\n        } else {\n            return \"\";\n        }\n    },\n\n    /**\n     * Retourne la liste des constraints\n     * @returns {String} une liste des constraints (sep '|')\n     */\n    getConstraints : function () {\n        var constraintArray = [];\n\n        if (this.constraints.length !== 0) {\n            for (var k = 0; k < this.constraints.length; k++) {\n                constraintArray.push(JSON.stringify(this.constraints[k]));\n            }\n        }\n        return constraintArray.join(\"|\");\n    }\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Array} liste de paramêtres\n */\nRouteParamREST.prototype.getParams = function () {\n    var map = [];\n\n    map.push({\n        k : \"resource\",\n        v : this.resource\n    });\n\n    map.push({\n        k : \"start\",\n        v : this.start\n    });\n\n    map.push({\n        k : \"end\",\n        v : this.end\n    });\n\n    map.push({\n        k : \"geometryFormat\",\n        v : \"geojson\"\n    });\n\n    if (this.optimization) {\n        map.push({\n            k : \"optimization\",\n            v : this.getOptimization()\n        });\n    }\n\n    if (this.intermediates) {\n        map.push({\n            k : \"intermediates\",\n            v : this.getIntermediates()\n        });\n    }\n\n    if (this.profile) {\n        map.push({\n            k : \"profile\",\n            v : this.getProfile()\n        });\n    }\n\n    if (this.constraints) {\n        map.push({\n            k : \"constraints\",\n            v : this.getConstraints()\n        });\n    }\n\n    if (this.crs) {\n        map.push({\n            k : \"crs\",\n            v : this.crs\n        });\n    }\n\n    if (this.distanceUnit) {\n        map.push({\n            k : \"distanceUnit\",\n            v : this.getDistanceUnit()\n        });\n    }\n\n    if (this.timeUnit) {\n        map.push({\n            k : \"timeUnit\",\n            v : this.timeUnit\n        });\n    }\n\n    if (this.waysAttributes) {\n        map.push({\n            k : \"waysAttributes\",\n            v : this.getWaysAttributes()\n        });\n    }\n\n    return map;\n};\n\nexport default RouteParamREST;\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.geom.Polygon;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.geom.MultiPolygon;","import Color from \"../Utils/ColorUtils\";\nimport Logger from \"../Utils/LoggerByDefault\";\nimport Markers from \"../Controls/Utils/Markers\";\n// import ol\nimport Feature from \"ol/Feature\";\n// import Style\nimport Style from \"ol/style/Style\";\nimport CircleStyle from \"ol/style/Circle\";\nimport IconStyle from \"ol/style/Icon\";\nimport FillStyle from \"ol/style/Fill\";\nimport StrokeStyle from \"ol/style/Stroke\";\nimport TextStyle from \"ol/style/Text\";\n// import geom\nimport Polygon from \"ol/geom/Polygon\";\nimport MultiPolygon from \"ol/geom/MultiPolygon\";\n\nvar logger = Logger.getLogger(\"styling\");\n\nFeature.prototype.setPropertyFill = function () {\n    var style = this.getStyle();\n    if (!style) {\n        return;\n    }\n    if (Array.isArray(style) && style.length === 0) {\n        return;\n    }\n    var fill = style.getFill();\n    if (fill) {\n        var colorFill = fill.getColor();\n        // array\n        if (Array.isArray(colorFill)) {\n            var cf = \"rgba(\";\n            cf += colorFill[0] + \",\";\n            cf += colorFill[1] + \",\";\n            cf += colorFill[2] + \",\";\n            cf += colorFill[3] + \")\";\n            colorFill = cf;\n        }\n        if (Color.isRGB(colorFill)) {\n            var oColorFill = Color.rgbaToHex(colorFill);\n            this.set(\"fill\", oColorFill.hex);\n            this.set(\"fill-opacity\", oColorFill.opacity);\n        } else {\n            this.set(\"fill\", colorFill);\n            this.set(\"fill-opacity\", 1);\n        }\n    }\n};\n\nFeature.prototype.setPropertyStroke = function () {\n    var style = this.getStyle();\n    if (!style) {\n        return;\n    }\n    if (Array.isArray(style) && style.length === 0) {\n        return;\n    }\n    var stroke = style.getStroke();\n    if (stroke) {\n        var colorStroke = stroke.getColor();\n        // array\n        if (Array.isArray(colorStroke)) {\n            var cs = \"rgba(\";\n            cs += colorStroke[0] + \",\";\n            cs += colorStroke[1] + \",\";\n            cs += colorStroke[2] + \",\";\n            cs += colorStroke[3] + \")\";\n            colorStroke = cs;\n        }\n        if (Color.isRGB(colorStroke)) {\n            var oColorStroke = Color.rgbaToHex(colorStroke);\n            this.set(\"stroke\", oColorStroke.hex);\n            this.set(\"stroke-opacity\", oColorStroke.opacity);\n        } else {\n            this.set(\"stroke\", colorStroke);\n            this.set(\"stroke-opacity\", 1);\n        }\n        this.set(\"stroke-width\", stroke.getWidth());\n    }\n};\n\nFeature.prototype.setPropertyLabel = function () {\n    var style = this.getStyle();\n    if (!style) {\n        return;\n    }\n    if (Array.isArray(style) && style.length === 0) {\n        return;\n    }\n    var isName = this.get(\"name\") !== undefined;\n    var label = style.getText();\n    if (label && isName) {\n        var fill = style.getText().getFill();\n        if (fill) {\n            var colorFill = fill.getColor();\n            // array\n            if (Array.isArray(colorFill)) {\n                var cf = \"rgba(\";\n                cf += colorFill[0] + \",\";\n                cf += colorFill[1] + \",\";\n                cf += colorFill[2] + \",\";\n                cf += colorFill[3] + \")\";\n                colorFill = cf;\n            }\n            if (Color.isRGB(colorFill)) {\n                var oColorFill = Color.rgbaToHex(colorFill);\n                this.set(\"label-fill\", oColorFill.hex);\n                this.set(\"label-fill-opacity\", oColorFill.opacity);\n            } else {\n                this.set(\"label-fill\", colorFill);\n                this.set(\"label-fill-opacity\", 1);\n            }\n        }\n        var stroke = style.getText().getStroke();\n        if (stroke) {\n            var colorStroke = stroke.getColor();\n            // array\n            if (Array.isArray(colorStroke)) {\n                var cs = \"rgba(\";\n                cs += colorStroke[0] + \",\";\n                cs += colorStroke[1] + \",\";\n                cs += colorStroke[2] + \",\";\n                cs += colorStroke[3] + \")\";\n                colorStroke = cs;\n            }\n            if (Color.isRGB(colorStroke)) {\n                var oColorStroke = Color.rgbaToHex(colorStroke);\n                this.set(\"label-stroke\", oColorStroke.hex);\n                this.set(\"label-stroke-opacity\", oColorStroke.opacity);\n            } else {\n                this.set(\"label-stroke\", colorStroke);\n                this.set(\"label-stroke-opacity\", 1);\n            }\n            this.set(\"label-stroke-width\", stroke.getWidth());\n        }\n        this.set(\"label-font\", style.getText().getFont() || Styling.DEFAULT_TEXT.font);\n        this.set(\"label-textAlign\", style.getText().getTextAlign() || Styling.DEFAULT_TEXT.textAlign);\n    }\n};\n\nFeature.prototype.setPropertyMarker = function () {\n    var style = this.getStyle();\n    if (!style) {\n        return;\n    }\n    if (Array.isArray(style) && style.length === 0) {\n        return;\n    }\n    var image = style.getImage();\n    if (image) {\n        // si le tag image est seul...\n        // c'est soit un marker ou soit un cercle !\n        if (image instanceof IconStyle) {\n            var color = image.getColor();\n            // array\n            if (Array.isArray(color)) {\n                var c = \"rgba(\";\n                c += color[0] + \",\";\n                c += color[1] + \",\";\n                c += color[2] + \",\";\n                c += color[3] + \")\";\n                color = c;\n            }\n            // feature.set(\"marker-color\", \"\"); // par defaut\n            if (color) {\n                var colorIcon = Color.rgbaToHex(color);\n                this.set(\"marker-color\", colorIcon.hex);\n            }\n            var scaleIcon = image.getScale();\n            switch (Math.round(scaleIcon * 2) / 2) {\n                case 0:\n                case 0.5:\n                    this.set(\"marker-size\", \"small\");\n                    break;\n                case 1:\n                    this.set(\"marker-size\", \"medium\");\n                    break;\n                case 1.5:\n                case 2:\n                    this.set(\"marker-size\", \"large\");\n                    break;\n                default:\n                    // this.set(\"marker-size\", \"\"); // par defaut\n                    break;\n            }\n            // feature.set(\"marker-symbol\", \"\"); // par defaut\n            var srcImage = image.getSrc();\n            if (srcImage) {\n                this.set(\"marker-symbol\", srcImage);\n            }\n            // INFO\n            // cas particulier où un objet est transformé :\n            //  * un cercle est transformé en icone\n            //  > les attributs du cercle sont à supprimer !\n            this.unset(\"circle-fill\");\n            this.unset(\"circle-fill-opacity\");\n            this.unset(\"circle-stroke\");\n            this.unset(\"circle-stroke-width\");\n            this.unset(\"circle-stroke-opacity\");\n            this.unset(\"circle-radius\");\n        } else {\n            var fillImg = image.getFill();\n            if (fillImg) {\n                var colorFillImg = fillImg.getColor();\n                // array\n                if (Array.isArray(colorFillImg)) {\n                    var cfi = \"rgba(\";\n                    cfi += colorFillImg[0] + \",\";\n                    cfi += colorFillImg[1] + \",\";\n                    cfi += colorFillImg[2] + \",\";\n                    cfi += colorFillImg[3] + \")\";\n                    colorFillImg = cfi;\n                }\n                if (Color.isRGB(colorFillImg)) {\n                    var oColorFillImg = Color.rgbaToHex(colorFillImg);\n                    this.set(\"circle-fill\", oColorFillImg.hex);\n                    this.set(\"circle-fill-opacity\", oColorFillImg.opacity);\n                } else {\n                    this.set(\"circle-fill\", colorFillImg);\n                    this.set(\"circle-fill-opacity\", 1);\n                }\n            }\n            var strokeImg = image.getStroke();\n            if (strokeImg) {\n                var colorStrokeImg = strokeImg.getColor();\n                // array\n                if (Array.isArray(colorStrokeImg)) {\n                    var csi = \"rgba(\";\n                    csi += colorStrokeImg[0] + \",\";\n                    csi += colorStrokeImg[1] + \",\";\n                    csi += colorStrokeImg[2] + \",\";\n                    csi += colorStrokeImg[3] + \")\";\n                    colorStrokeImg = csi;\n                }\n                if (Color.isRGB(colorStrokeImg)) {\n                    var oColorStrokeImg = Color.rgbaToHex(colorStrokeImg);\n                    this.set(\"circle-stroke\", oColorStrokeImg.hex);\n                    this.set(\"circle-stroke-opacity\", oColorStrokeImg.opacity);\n                } else {\n                    this.set(\"circle-stroke\", colorStrokeImg);\n                    this.set(\"circle-stroke-opacity\", 1);\n                }\n                this.set(\"circle-stroke-width\", strokeImg.getWidth());\n            }\n            var radius = image.getRadius();\n            this.set(\"circle-radius\", radius);\n        }\n    }\n};\n\n/**\n * @module Styling\n * @alias Gp.Styling\n * @private\n * @todo ...\n * @description\n * A simple specification for styling GeoJSON / GPX / KML data.\n *\n * @see ol.format.GeoJSONExtended\n * @see ol.format.KMLExtended\n * @see ol.format.GPXExtended\n *\n * @example\n * feature.getStyle(); // null\n * feature.getProperties(); // {\"stroke\": \"#ff0000\", \"stroke-width\": 2}\n * Styling.defineStyleFromProperties(feature);\n * feature.getStyle(); // [Object Style]\n *\n * feature.getStyle(); // [Object Style]\n * feature.getProperties(); // {}\n * Styling.definePropertiesFromStyle(feature);\n * feature.getProperties(); // {\"stroke\": \"#ff0000\", \"stroke-width\": 2}\n *\n * var style = feature.getStyle(); // [Object Style]\n * var tag = Styling.setTag(style, \"GPX\");\n *\n * ex. output GeoJSON:\n * ```json\n *  \"properties\": {\n *   \"stroke\": \"#ff0000\",\n *   \"stroke-width\": 2\n *  }\n * ```\n */\nvar Styling = {\n\n    /**\n     * Options to convert geometry\n     */\n    APPLY_CONVERT_GEOM_GPX : true,\n\n    /**\n     * Default icon style options\n     */\n    DEFAULT_ICON : {\n        src : Markers[\"lightOrange\"],\n        anchor : [0.5, 1],\n        scale : 1\n    },\n\n    /**\n     * Default circle style options\n     */\n    DEFAULT_CIRCLE : {\n        radius : 10,\n        fill : {\n            opacity : 1,\n            color : [0, 0, 0, 1]\n        },\n        stroke : {\n            width : 1,\n            opacity : 1,\n            color : [0, 0, 0, 1]\n        }\n    },\n\n    /**\n     * Default stroke style options\n     */\n    DEFAULT_STROKE : {\n        width : 5,\n        opacity : 1,\n        color : [250, 250, 250, 1]\n    },\n\n    /**\n     * Default fill style options\n     */\n    DEFAULT_FILL : {\n        opacity : 1,\n        color : [0, 0, 0, 1]\n    },\n\n    /**\n     * Default text style options\n     * @see https://openlayers.org/en/v6.15.1/apidoc/module-ol_style_Text-Text.html\n     */\n    DEFAULT_TEXT : {\n        font : \"16px sans\",\n        textAlign : \"left\",\n        stroke : {\n            color : [250, 250, 250, 1],\n            width : 5,\n            opactity : 1\n        },\n        fill : {\n            opacity : 1,\n            color : [0, 0, 0, 1]\n        }\n        // offsetX\n        // offsetY\n        // placement\n        // scale\n        // rotation\n        // justify\n        // padding\n    },\n\n    /**\n     * All styling tags\n     * @function getListTags\n     * @returns {Array} all styling tags\n     * @example\n     * \"type\", // type de geometrie\n     * \"fill\",\n     * \"fill-opacity\",\n     * \"stroke\",\n     * \"stroke-opacity\",\n     * \"stroke-width\",\n     * \"circle-fill\",\n     * \"circle-fill-opacity\",\n     * \"circle-stroke\",\n     * \"circle-stroke-opacity\",\n     * \"circle-stroke-width\",\n     * \"circle-radius\",\n     * \"marker-symbol\",\n     * \"marker-color\",\n     * \"marker-size\"\n     */\n    getListTags : function () {\n        return [\n            \"type\",\n            \"fill\",\n            \"fill-opacity\",\n            \"stroke\",\n            \"stroke-opacity\",\n            \"stroke-width\",\n            \"circle-fill\",\n            \"circle-fill-opacity\",\n            \"circle-stroke\",\n            \"circle-stroke-opacity\",\n            \"circle-stroke-width\",\n            \"circle-radius\",\n            \"marker-symbol\",\n            \"marker-color\",\n            \"marker-size\",\n            \"label-fill\",\n            \"label-fill-opacity\",\n            \"label-stroke\",\n            \"label-stroke-width\",\n            \"label-stroke-opacity\",\n            \"label-font\",\n            \"label-textAlign\"\n        ];\n    },\n\n    /**\n     * Transform feature properties to a native style\n     *\n     * @function defineStyleFromProperties\n     * @param {*} feature - ...\n     * @returns {*} style - ...\n     * @public\n     *\n     * @description\n     * A la lecture du format :\n     * > tag styling ---> feature properties ---> feature style\n     *\n     * Les balises de 'styling' du fichier sont ajoutées dans les properties de chaque features\n     * (opération native sous OpenLayers):\n     *\n     * Ex. avec le format GeoJSON :\n     * ```json\n     * \"properties\": {\n     *    \"stroke\": \"#000000\",      -> feature.get(\"stroke\");\n     *    \"stroke-width\": 13,       -> feature.get(\"stroke-width\");\n     *    \"stroke-opacity\": 0.8,    -> feature.get(\"stroke-opacity\");\n     *    \"fill\": \"#a03737\",        -> feature.get(\"fill\");\n     *    \"fill-opacity\": 0.5       -> feature.get(\"fill-opacity\");\n     * }\n     * ```\n     *\n     * Ensuite, les properties des features sont transformées dans le style natif :\n     *\n     * ```js\n     * // Ex.\n     * feature.setStyle(new Style({\n     *  fill : new FillStyle({\n     *      color : Color.hexToRgba(feature.get(\"fill\"), feature.get(\"fill-opacity\") || 1)\n     *  }),\n     *  stroke : new StrokeStyle({\n     *      color : Color.hexToRgba(feature.get(\"stroke\"), feature.get(\"stroke-opacity\"))\n     *      width : feature.get(\"stroke-width\")\n     *  })\n     * }));\n     * ```\n     */\n    defineStyleFromProperties : function (feature) {\n        // style\n        var style = null;\n\n        // les options de styles définis dans le format\n        var options = {};\n\n        // properties :\n        // \"marker-size\" -> icon\n        // \"marker-symbol\" -> icon\n        // \"marker-color\" -> icon\n        var marker = null;\n        if (feature.get(\"marker-color\") ||\n            feature.get(\"marker-size\") ||\n            feature.get(\"marker-symbol\")) {\n            marker = {};\n            // icone par defaut\n            marker[\"src\"] = this.DEFAULT_ICON.src;\n            marker[\"anchor\"] = this.DEFAULT_ICON.anchor;\n            var symbolMarker = feature.get(\"marker-symbol\");\n            if (symbolMarker) {\n                if (symbolMarker.search(\"data:image/png;base64\") !== -1) {\n                    // icone du portail\n                    marker[\"src\"] = symbolMarker;\n                } else {\n                    // TODO\n                    // utiliser les symboles de Maki\n                    // (cf. https://labs.mapbox.com/maki-icons/)\n                }\n            }\n            var colorMarker = feature.get(\"marker-color\");\n            if (Color.isHex(colorMarker)) {\n                marker[\"color\"] = Color.hexToRgba(colorMarker, 1);\n            }\n            var size = feature.get(\"marker-size\");\n            if (size) {\n                switch (size) {\n                    case \"small\":\n                        marker[\"scale\"] = 0.5;\n                        break;\n                    case \"medium\":\n                        marker[\"scale\"] = 1;\n                        break;\n                    case \"large\":\n                        marker[\"scale\"] = 1.5;\n                        break;\n                    default:\n                        marker[\"scale\"] = this.DEFAULT_ICON.scale;\n                        break;\n                }\n            }\n        }\n\n        // properties :\n        // \"stroke\" -> line / polygon\n        // \"stroke-opacity\" -> line / polygon\n        // \"stroke-width\" -> line / polygon\n        var stroke = null;\n        if (feature.get(\"stroke\") ||\n            feature.get(\"stroke-opacity\") ||\n            feature.get(\"stroke-width\")) {\n            stroke = {};\n            stroke[\"color\"] = Color.hexToRgba(feature.get(\"stroke\"), +feature.get(\"stroke-opacity\") || this.DEFAULT_STROKE.opacity);\n            stroke[\"width\"] = +feature.get(\"stroke-width\") || this.DEFAULT_STROKE.width;\n        }\n\n        // properties :\n        // \"fill\" -> polygon\n        // \"fill-opacity\" -> polygon\n        var fill = null;\n        if (feature.get(\"fill\") ||\n            feature.get(\"fill-opacity\")) {\n            fill = {};\n            fill[\"color\"] = Color.hexToRgba(feature.get(\"fill\"), +feature.get(\"fill-opacity\") || this.DEFAULT_FILL.opacity);\n        }\n\n        // properties :\n        // \"label-fill\",\n        // \"label-fill-opacity\",\n        // \"label-stroke\",\n        // \"label-stroke-width\",\n        // \"label-stroke-opacity\",\n        // \"label-font\",\n        // \"label-textAlign\"\n        // \"name\" -> text\n        var labelStroke = null;\n        var labelFill = null;\n        var isLabel = feature.get(\"name\") !== \"\";\n        if (isLabel) {\n            if (feature.get(\"label-fill\") ||\n                feature.get(\"label-fill-opacity\")) {\n                labelFill = {};\n                labelFill[\"color\"] = Color.hexToRgba(feature.get(\"label-fill\"), +feature.get(\"label-fill-opacity\") || this.DEFAULT_TEXT.fill.opacity);\n            }\n            if (feature.get(\"label-stroke\") ||\n                feature.get(\"label-stroke-opacity\") ||\n                feature.get(\"label-stroke-width\")) {\n                labelStroke = {};\n                labelStroke[\"color\"] = Color.hexToRgba(feature.get(\"label-stroke\"), +feature.get(\"label-stroke-opacity\") || this.DEFAULT_TEXT.stroke.opacity);\n                labelStroke[\"width\"] = +feature.get(\"label-stroke-width\") || this.DEFAULT_TEXT.stroke.width;\n            }\n        }\n\n        // properties :\n        // \"circle-fill\"\n        // \"circle-stroke\"\n        // \"circle-stroke-width\"\n        // \"circle-radius\"\n        var circleRadius = feature.get(\"circle-radius\") || this.DEFAULT_CIRCLE.radius;\n        var circleStroke = null;\n        if (feature.get(\"circle-stroke\") ||\n            feature.get(\"circle-stroke-opacity\") ||\n            feature.get(\"circle-stroke-width\")) {\n            circleStroke = {};\n            circleStroke[\"color\"] = Color.hexToRgba(feature.get(\"circle-stroke\"), +feature.get(\"circle-stroke-opacity\") || this.DEFAULT_CIRCLE.stroke.opacity);\n            circleStroke[\"width\"] = +feature.get(\"circle-stroke-width\") || this.DEFAULT_CIRCLE.stroke.width;\n        }\n        var circleFill = null;\n        if (feature.get(\"circle-fill\") ||\n            feature.get(\"circle-fill-opacity\")) {\n            circleFill = {};\n            circleFill[\"color\"] = Color.hexToRgba(feature.get(\"circle-fill\"), +feature.get(\"circle-fill-opacity\") || this.DEFAULT_CIRCLE.fill.opacity);\n        }\n\n        // options du Style en fonction du type de geometrie\n        if (feature.getGeometry()) {\n            var type = feature.getGeometry().getType();\n            switch (type) {\n                case \"Circle\":\n                case \"Point\":\n                case \"MultiPoint\":\n                    // Cercle\n                    var isCircle = false;\n                    var optionsCircle = {};\n                    if (circleStroke) {\n                        optionsCircle[\"stroke\"] = new StrokeStyle(circleStroke);\n                    }\n                    if (circleFill) {\n                        optionsCircle[\"fill\"] = new FillStyle(circleFill);\n                    }\n                    if (Object.keys(optionsCircle).length !== 0) {\n                        isCircle = true;\n                        optionsCircle[\"radius\"] = +circleRadius; // Conversion en nombre\n                        options[\"image\"] = new CircleStyle(optionsCircle);\n                    }\n                    // Ponctuel\n                    if (marker) {\n                        options[\"image\"] = new IconStyle(marker);\n                    }\n                    // Label\n                    if (isLabel) {\n                        var optionsText = {};\n    \n                        if (labelStroke) {\n                            optionsText[\"stroke\"] = new StrokeStyle(labelStroke);\n                        }\n                        if (labelFill) {\n                            optionsText[\"fill\"] = new FillStyle(labelFill);\n                        }\n                        if (Object.keys(optionsText).length !== 0) {\n                            optionsText[\"text\"] = feature.get(\"name\");\n                            optionsText[\"textAlign\"] = feature.get(\"label-textAlign\") || this.DEFAULT_TEXT.textAlign;\n                            optionsText[\"font\"] = feature.get(\"label-font\") || this.DEFAULT_TEXT.font;\n                            options[\"text\"] = new TextStyle(\n                                Object.assign({},\n                                    this.DEFAULT_TEXT,\n                                    optionsText\n                                ));\n                        } else {\n                            // on applique un style par defaut sur le label\n                            // pour un marker ou un cercle\n                            if (marker || isCircle) {\n                                var styleText = new TextStyle(\n                                    Object.assign({},\n                                        this.DEFAULT_TEXT, {\n                                            fill : new FillStyle(this.DEFAULT_TEXT.fill),\n                                            stroke : new StrokeStyle(this.DEFAULT_TEXT.stroke)\n                                        }\n                                    )\n                                );\n                                if (styleText) {\n                                    var cloneStyleText = styleText.clone();\n                                    cloneStyleText.setText(feature.get(\"name\"));\n                                    options[\"text\"] = cloneStyleText;\n                                }\n                            }\n                        }\n                    }\n                    break;\n    \n                case \"Polygon\":\n                case \"MultiPolygon\":\n                    if (stroke) {\n                        options[\"stroke\"] = new StrokeStyle(stroke);\n                    }\n                    if (fill) {\n                        options[\"fill\"] = new FillStyle(fill);\n                    }\n                    break;\n    \n                case \"LineString\":\n                case \"MultiLineString\":\n                    if (stroke) {\n                        options[\"stroke\"] = new StrokeStyle(stroke);\n                    }\n                    if (this.APPLY_CONVERT_GEOM_GPX && fill) {\n                        // INFO\n                        // Lors d'une transformation de type de geometrie, le type est renseigné.\n                        // Pour le format GPX,\n                        // -> on transforme une surface vers ligne lors de l'écriture\n                        // -> on transforme une ligne vers une surface lors de la lecture si le type est précisé !\n                        var initType = feature.get(\"type\");\n                        if (initType && (initType === \"Polygon\" || initType === \"MultiPolygon\")) {\n                            options[\"fill\"] = new FillStyle(fill);\n                            var f = feature.clone();\n                            var ClassPoly = (type === \"LineString\") ? Polygon : MultiPolygon;\n                            feature.setGeometry(new ClassPoly([f.getGeometry().getCoordinates()]));\n                        }\n                    }\n                    break;\n    \n                default:\n                    break;\n            }\n        }\n\n        // si aucun style disponible, on utilisera le style par defaut defini\n        // par l'utilisateur ou l'application\n        if (Object.keys(options).length !== 0) {\n            style = new Style(options);\n        }\n\n        return style;\n    },\n\n    /**\n     * Define a default style function to apply to a feature\n     *\n     * @function defineStyleFunctionByDefault\n     * @param {Object} defaultStyle - ...\n     * @returns {Function} style function\n     * @public\n     *\n     * @description\n     * ...\n     */\n    defineStyleFunctionByDefault : function (defaultStyle) {\n        if (!defaultStyle) {\n            return [];\n        }\n\n        if (Object.keys(defaultStyle).length === 0) {\n            return [];\n        }\n\n        // les styles par defaut\n        var styleFunction = (feature, resolution) => {\n            if (feature.getGeometry()) {\n                var style = null;\n                var type = feature.getGeometry().getType();\n                switch (type) {\n                    case \"Point\":\n                    case \"MultiPoint\":\n                        // on n'a aucune information sur le type de style à appliquer sur un \"Point\" :\n                        // * label ou\n                        // * marker ou\n                        // * marker avec label\n                        // donc, c'est en fonction des styles par defaut...\n                        var opts = {};\n                        if (defaultStyle.getImage()) {\n                            opts[\"image\"] = defaultStyle.getImage();\n                        }\n                        if (defaultStyle.getText() && feature.get(\"name\")) {\n                            var styleText = defaultStyle.getText().clone();\n                            styleText.setText(feature.get(\"name\"));\n                            opts[\"text\"] = styleText;\n                        }\n                        style = new Style(opts);\n                        break;\n                    case \"Circle\":\n                        var optsc = {};\n    \n                        var optsCircle = {};\n                        if (defaultStyle.getFill()) {\n                            optsCircle.fill = defaultStyle.getFill();\n                        }\n                        if (defaultStyle.getStroke()) {\n                            optsCircle.stroke = defaultStyle.getStroke();\n                        }\n                        if (defaultStyle.getText() && feature.get(\"name\")) {\n                            var styleTextCircle = defaultStyle.getText().clone();\n                            styleTextCircle.setText(feature.get(\"name\"));\n                            optsc.text = styleTextCircle;\n                        }\n                        if (Object.keys(optsCircle).length !== 0) {\n                            // FIXME param radius ?\n                            optsCircle.radius = 3;\n                            optsc.image = new CircleStyle(optsCircle);\n                        }\n                        style = new Style(optsc);\n                        break;\n                    case \"Polygon\":\n                    case \"MultiPolygon\":\n                        var optsp = {};\n                        if (defaultStyle.getFill()) {\n                            optsp.fill = defaultStyle.getFill();\n                        }\n                        if (defaultStyle.getStroke()) {\n                            optsp.stroke = defaultStyle.getStroke();\n                        }\n                        style = new Style(optsp);\n                        break;\n                    case \"LineString\":\n                    case \"LinearRing\":\n                    case \"MultiLineString\":\n                        var optsl = {};\n                        if (defaultStyle.getStroke()) {\n                            optsl.stroke = defaultStyle.getStroke();\n                        }\n                        style = new Style(optsl);\n                        break;\n                }\n                return [style];\n            }\n        };\n        return styleFunction;\n    },\n\n    /**\n     * Transform a native style to feature properties by type of geometry\n     *\n     * @todo not yet implemented !\n     * @param {*} feature - feature\n     */\n    definePropertiesFromStyleByType : function (feature) {\n        if (feature.getGeometry()) {\n            var geomType = feature.getGeometry().getType();\n            switch (geomType) {\n                case \"Point\":\n                case \"MultiPoint\":\n                    feature.setPropertyMarker();\n                    feature.setPropertyLabel();\n                    break;\n                case \"LineString\":\n                case \"MultiLineString\":\n                    feature.setPropertyStroke();\n                    break;\n                case \"Polygon\":\n                case \"MultiPolygon\":\n                    feature.setPropertyStroke();\n                    feature.setPropertyFill();\n                    break;\n                default:\n                    break;\n            }\n        }\n    },\n\n    /**\n     * Transform a native style to feature properties\n     *\n     * @function definePropertiesFromStyle\n     * @param {*} feature - ...\n     * @public\n     *\n     * @description\n     * A l'écriture du format.\n     * > feature style --> feature properties --> tag styling\n     *\n     * Le style natif est récupéré pour chaque feature :\n     *\n     * ```js\n     * // Ex.\n     * var style = feature.getStyle();\n     * ```\n     *\n     * Ensuite, le style natif est transformé en properties pour chaque feature :\n     *\n     * ```js\n     * // Ex.\n     * var stroke = style.getStroke();\n     * var oColorStroke = Color.rgbaToHex(stroke.getColor());\n     * feature.set(\"stroke\", oColorStroke.hex); // #000000\n     * feature.set(\"stroke-opacity\", oColorStroke.opacity); // 0.8\n     * ```\n     *\n     * Et, chaque properties des features sont ecrites dans le format du fichier\n     * (opération native sous OpenLayers) :\n     *\n     * Ex. avec le format GeoJSON :\n     * ```json\n     * \"properties\": {\n     *    \"stroke\": \"#000000\",\n     *    \"stroke-opacity\": 0.8\n     * }\n     * ```\n     */\n    definePropertiesFromStyle : function (feature) {\n        var style = feature.getStyle() || feature.getStyleFunction();\n        if (style) {\n            // style ajouté via une fonction, pour les styles par defaut par ex.\n            if (typeof style === \"function\") {\n                var styles = style.call(this, feature, 0);\n                if (styles && styles.length !== 0) {\n                    style = (Array.isArray(styles)) ? styles[0] : styles;\n                    feature.setStyle(style);\n                } else {\n                    // au cas où...\n                    return;\n                }\n            }\n            this.definePropertiesFromStyleByType(feature);\n        }\n    },\n\n    /**\n     * Transform a native style to tags 'styling' into the format\n     *\n     * @function defineTagFromStyle\n     * @param {*} style - ...\n     * @param {String} format - ...\n     * @returns {String} tags stringify into the format (json / xml)\n     * @todo\n     * @public\n     *\n     * @description\n     * A partir d'un style natif, on le transforme en balise de 'styling' dans le format demandé,\n     * que l'on peut ensuite inserer dans le fichier.\n     * > style ---> tag styling\n     *\n     */\n    defineTagFromStyle : function (style, format) {\n        logger.trace(\"todo...\");\n        return null;\n    }\n};\n\nexport default Styling;\n","module.exports = ol.extent;","var checkDsfr = function () {\n    // HACK: check si le styl dsfr est chargé via la variable blue-france-sun-113-625\n    var style = getComputedStyle(document.documentElement);\n    var color = style.getPropertyValue(\"--blue-france-sun-113-625\");\n    if (color === \"\") {\n        return false;\n    }\n    return true;\n};\n\nexport default checkDsfr;\n\n","'use strict';\n\nvar conventions = require('./conventions');\n\nfunction extendError(constructor, writableName) {\n\tconstructor.prototype = Object.create(Error.prototype, {\n\t\tconstructor: { value: constructor },\n\t\tname: { value: constructor.name, enumerable: true, writable: writableName },\n\t});\n}\n\nvar DOMExceptionName = conventions.freeze({\n\t/**\n\t * the default value as defined by the spec\n\t */\n\tError: 'Error',\n\t/**\n\t * @deprecated\n\t * Use RangeError instead.\n\t */\n\tIndexSizeError: 'IndexSizeError',\n\t/**\n\t * @deprecated\n\t * Just to match the related static code, not part of the spec.\n\t */\n\tDomstringSizeError: 'DomstringSizeError',\n\tHierarchyRequestError: 'HierarchyRequestError',\n\tWrongDocumentError: 'WrongDocumentError',\n\tInvalidCharacterError: 'InvalidCharacterError',\n\t/**\n\t * @deprecated\n\t * Just to match the related static code, not part of the spec.\n\t */\n\tNoDataAllowedError: 'NoDataAllowedError',\n\tNoModificationAllowedError: 'NoModificationAllowedError',\n\tNotFoundError: 'NotFoundError',\n\tNotSupportedError: 'NotSupportedError',\n\tInUseAttributeError: 'InUseAttributeError',\n\tInvalidStateError: 'InvalidStateError',\n\tSyntaxError: 'SyntaxError',\n\tInvalidModificationError: 'InvalidModificationError',\n\tNamespaceError: 'NamespaceError',\n\t/**\n\t * @deprecated\n\t * Use TypeError for invalid arguments,\n\t * \"NotSupportedError\" DOMException for unsupported operations,\n\t * and \"NotAllowedError\" DOMException for denied requests instead.\n\t */\n\tInvalidAccessError: 'InvalidAccessError',\n\t/**\n\t * @deprecated\n\t * Just to match the related static code, not part of the spec.\n\t */\n\tValidationError: 'ValidationError',\n\t/**\n\t * @deprecated\n\t * Use TypeError instead.\n\t */\n\tTypeMismatchError: 'TypeMismatchError',\n\tSecurityError: 'SecurityError',\n\tNetworkError: 'NetworkError',\n\tAbortError: 'AbortError',\n\t/**\n\t * @deprecated\n\t * Just to match the related static code, not part of the spec.\n\t */\n\tURLMismatchError: 'URLMismatchError',\n\tQuotaExceededError: 'QuotaExceededError',\n\tTimeoutError: 'TimeoutError',\n\tInvalidNodeTypeError: 'InvalidNodeTypeError',\n\tDataCloneError: 'DataCloneError',\n\tEncodingError: 'EncodingError',\n\tNotReadableError: 'NotReadableError',\n\tUnknownError: 'UnknownError',\n\tConstraintError: 'ConstraintError',\n\tDataError: 'DataError',\n\tTransactionInactiveError: 'TransactionInactiveError',\n\tReadOnlyError: 'ReadOnlyError',\n\tVersionError: 'VersionError',\n\tOperationError: 'OperationError',\n\tNotAllowedError: 'NotAllowedError',\n\tOptOutError: 'OptOutError',\n});\nvar DOMExceptionNames = Object.keys(DOMExceptionName);\n\nfunction isValidDomExceptionCode(value) {\n\treturn typeof value === 'number' && value >= 1 && value <= 25;\n}\nfunction endsWithError(value) {\n\treturn typeof value === 'string' && value.substring(value.length - DOMExceptionName.Error.length) === DOMExceptionName.Error;\n}\n/**\n * DOM operations only raise exceptions in \"exceptional\" circumstances, i.e., when an operation\n * is impossible to perform (either for logical reasons, because data is lost, or because the\n * implementation has become unstable). In general, DOM methods return specific error values in\n * ordinary processing situations, such as out-of-bound errors when using NodeList.\n *\n * Implementations should raise other exceptions under other circumstances. For example,\n * implementations should raise an implementation-dependent exception if a null argument is\n * passed when null was not expected.\n *\n * This implementation supports the following usages:\n * 1. according to the living standard (both arguments are optional):\n * ```\n * new DOMException(\"message (can be empty)\", DOMExceptionNames.HierarchyRequestError)\n * ```\n * 2. according to previous xmldom implementation (only the first argument is required):\n * ```\n * new DOMException(DOMException.HIERARCHY_REQUEST_ERR, \"optional message\")\n * ```\n * both result in the proper name being set.\n *\n * @class DOMException\n * @param {number | string} messageOrCode\n * The reason why an operation is not acceptable.\n * If it is a number, it is used to determine the `name`, see\n * {@link https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-258A00AF ExceptionCode}\n * @param {string | keyof typeof DOMExceptionName | Error} [nameOrMessage]\n * The `name` to use for the error.\n * If `messageOrCode` is a number, this arguments is used as the `message` instead.\n * @augments Error\n * @see https://webidl.spec.whatwg.org/#idl-DOMException\n * @see https://webidl.spec.whatwg.org/#dfn-error-names-table\n * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-17189187\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/ecma-script-binding.html\n * @see http://www.w3.org/TR/REC-DOM-Level-1/ecma-script-language-binding.html\n */\nfunction DOMException(messageOrCode, nameOrMessage) {\n\t// support old way of passing arguments: first argument is a valid number\n\tif (isValidDomExceptionCode(messageOrCode)) {\n\t\tthis.name = DOMExceptionNames[messageOrCode];\n\t\tthis.message = nameOrMessage || '';\n\t} else {\n\t\tthis.message = messageOrCode;\n\t\tthis.name = endsWithError(nameOrMessage) ? nameOrMessage : DOMExceptionName.Error;\n\t}\n\tif (Error.captureStackTrace) Error.captureStackTrace(this, DOMException);\n}\nextendError(DOMException, true);\nObject.defineProperties(DOMException.prototype, {\n\tcode: {\n\t\tenumerable: true,\n\t\tget: function () {\n\t\t\tvar code = DOMExceptionNames.indexOf(this.name);\n\t\t\tif (isValidDomExceptionCode(code)) return code;\n\t\t\treturn 0;\n\t\t},\n\t},\n});\n\nvar ExceptionCode = {\n\tINDEX_SIZE_ERR: 1,\n\tDOMSTRING_SIZE_ERR: 2,\n\tHIERARCHY_REQUEST_ERR: 3,\n\tWRONG_DOCUMENT_ERR: 4,\n\tINVALID_CHARACTER_ERR: 5,\n\tNO_DATA_ALLOWED_ERR: 6,\n\tNO_MODIFICATION_ALLOWED_ERR: 7,\n\tNOT_FOUND_ERR: 8,\n\tNOT_SUPPORTED_ERR: 9,\n\tINUSE_ATTRIBUTE_ERR: 10,\n\tINVALID_STATE_ERR: 11,\n\tSYNTAX_ERR: 12,\n\tINVALID_MODIFICATION_ERR: 13,\n\tNAMESPACE_ERR: 14,\n\tINVALID_ACCESS_ERR: 15,\n\tVALIDATION_ERR: 16,\n\tTYPE_MISMATCH_ERR: 17,\n\tSECURITY_ERR: 18,\n\tNETWORK_ERR: 19,\n\tABORT_ERR: 20,\n\tURL_MISMATCH_ERR: 21,\n\tQUOTA_EXCEEDED_ERR: 22,\n\tTIMEOUT_ERR: 23,\n\tINVALID_NODE_TYPE_ERR: 24,\n\tDATA_CLONE_ERR: 25,\n};\n\nvar entries = Object.entries(ExceptionCode);\nfor (var i = 0; i < entries.length; i++) {\n\tvar key = entries[i][0];\n\tDOMException[key] = entries[i][1];\n}\n\n/**\n * Creates an error that will not be caught by XMLReader aka the SAX parser.\n *\n * @class\n * @param {string} message\n * @param {any} [locator]\n */\nfunction ParseError(message, locator) {\n\tthis.message = message;\n\tthis.locator = locator;\n\tif (Error.captureStackTrace) Error.captureStackTrace(this, ParseError);\n}\nextendError(ParseError);\n\nexports.DOMException = DOMException;\nexports.DOMExceptionName = DOMExceptionName;\nexports.ExceptionCode = ExceptionCode;\nexports.ParseError = ParseError;\n","/**\n* Global variable Gp.\n*\n* @module Gp\n* @alias Gp\n* @description\n*\n* This is the global variable that is exposed in the browser environment.\n* Content is composed of constructor, functions and properties...\n*\n* > {@link Gp.Error Error()}\n*     - .TYPE_SRVERR : \"SERVICE_ERROR\"\n*     - .TYPE_UNKERR : \"UNKNOWN_ERROR\"\n*     - .TYPE_USEERR : \"USAGE_ERROR\"\n*\n* > {@link module:Helper Helper}\n*     - .indent()\n*     - .normalyzeParameters()\n*     - .normalyzeUrl()\n*\n* > {@link module:XHR Protocols.XHR}\n*     - .call()\n*\n* > {@link module:Services Services (objects)}\n*     - .Alti\n*         - {@link Gp.Services.Alti.Elevation .Elevation()}\n*     - {@link Gp.Services.AltiResponse .AltiResponse()}\n*     - .AutoComplete\n*         - {@link Gp.Services.AutoComplete.SuggestedLocation .SuggestedLocation()}\n*     - {@link Gp.Services.AutoCompleteResponse .AutoCompleteResponse()}\n*     - {@link Gp.Services.Config .Config()}\n*     - {@link Gp.Services.DefaultUrl .DefaultUrl()}\n*     - {@link Gp.Services.GeocodeResponse .GeocodeResponse()}\n*     - {@link Gp.Services.GetConfigResponse .GetConfigResponse()}\n*     - {@link Gp.Services.IsoCurveResponse .IsoCurveResponse()}\n*     - .Route\n*         - {@link Gp.Services.Route.RouteInstruction .RouteInstruction()}\n*     - {@link Gp.Services.RouteResponse .RouteResponse()}\n*\n* > Services (factory)\n*     - {@link module:Services~autoComplete .autoComplete()}\n*     - {@link module:Services~geocode .geocode()}\n*     - {@link module:Services~getAltitude .getAltitude()}\n*     - {@link module:Services~getConfig .getConfig()}\n*     - {@link module:Services~isoCurve .isoCurve()}\n*     - {@link module:Services~reverseGeocode .reverseGeocode()}\n*     - {@link module:Services~route .route()}\n*\n* > servicesDate : \"YYYY-MM-DD\"\n*\n* > servicesVersion : \"X.X.X\"\n*\n*/\n\nimport Services from \"./Services/Services\";\nimport DefaultUrl from \"./Services/DefaultUrlService\";\nimport AltiResponse from \"./Services/Alti/Response/model/AltiResponse\";\nimport Elevation from \"./Services/Alti/Response/model/Elevation\";\nimport AutoCompleteResponse from \"./Services/AutoComplete/Response/model/AutoCompleteResponse\";\nimport SuggestedLocation from \"./Services/AutoComplete/Response/model/SuggestedLocation\";\nimport IsoCurveResponse from \"./Services/ProcessIsoCurve/Response/model/ProcessIsoCurveResponse\";\nimport RouteResponse from \"./Services/Route/Response/model/RouteResponse\";\nimport RouteInstruction from \"./Services/Route/Response/model/RouteInstruction\";\nimport Config from \"./Services/Config/Config\";\nimport XHR from \"./Protocols/XHR\";\nimport Error from \"./Exceptions/ErrorService\";\nimport Helper from \"./Utils/Helper\";\n\nimport Pkg from \"../package.json\";\n\n/** Version */\nexport const servicesVersion = Pkg.version;\n/** Publication date */\nexport const servicesDate = Pkg.date;\n\n// on declare les ns dans root global\nvar Gp = {};\n\nGp.servicesVersion = servicesVersion;\nGp.servicesDate = servicesDate;\n\n// Export Protocols\nGp.Protocols = {};\nGp.Protocols.XHR = XHR;\n// Export services\nGp.Services = Services;\n// Export DefaultUrls\nGp.Services.DefaultUrl = DefaultUrl;\n// Export Alti\nGp.Services.AltiResponse = AltiResponse;\nGp.Services.Alti = {};\nGp.Services.Alti.Elevation = Elevation;\n// Export Autocomplete\nGp.Services.AutoCompleteResponse = AutoCompleteResponse;\nGp.Services.AutoComplete = {};\nGp.Services.AutoComplete.SuggestedLocation = SuggestedLocation;\n// Export Config\nGp.Services.Config = Config;\n// Export IsoCurve\nGp.Services.IsoCurveResponse = IsoCurveResponse;\n// Export Route\nGp.Services.RouteResponse = RouteResponse;\nGp.Services.Route = {};\nGp.Services.Route.RouteInstruction = RouteInstruction;\n// Export Erreurs et Outils\nGp.Error = Error;\nGp.Helper = Helper;\n\nexport default Gp;\n","/**\n * Response object for {@link module:Services~route Gp.Services.route ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Gp.BBox} bbox - Bounding Box of the route. Given when provideBBox parameter is used in function call.\n * @property {Object} routeGeometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the route.\n * @property {Array.<Gp.Services.Route.RouteInstruction>} routeInstructions - Instructions of the route.\n * @property {String} totalDistance - Length of the route. If distanceUnit parameter was set to \"km\" (default), totalDistance is a string containing the total distance expressed in kilometers, followed by \" Km\" (e.g. : \"19.6 Km\"). If distanceUnit parameter was set to \"m\", totalDistance is a string containing the total distance expressed in meters (e.g. : \"19599.14\").\n * @property {Float} totalTime - Route duration in seconds.\n *\n * @namespace\n * @alias Gp.Services.RouteResponse\n */\nfunction RouteResponse () {\n    if (!(this instanceof RouteResponse)) {\n        throw new TypeError(\"RouteResponse constructor cannot be called as a function.\");\n    }\n\n    this.totalTime = null;\n\n    this.totalDistance = null;\n\n    this.bbox = {\n        left : null,\n        right : null,\n        top : null,\n        bottom : null\n    };\n\n    this.routeGeometry = null; // FIXME can be null if option 'geometryInInstructions' is true !\n\n    this.routeInstructions = [];\n}\n\nRouteResponse.prototype = {\n\n    constructor : RouteResponse\n\n};\n\nexport default RouteResponse;\n","module.exports = ol.style;","\n/**\n * Single elevation object returned by underlying web service. Contains at least, one elevation (z). May also contain point coordinates and elevation accuracy if \"zonly\" parameter wasn't set to true.\n *\n * @property {Float} lat - Point latitude. (only if zonly=false)\n * @property {Float} lon - Point longitude. (only if zonly=false)\n * @property {Float} z - Point elevation.\n * @property {Float} acc - Accuracy of elevation for this point. (only if zonly=false)\n *\n * @namespace\n * @alias Gp.Services.Alti.Elevation\n */\nfunction Elevation () {\n    if (!(this instanceof Elevation)) {\n        throw new TypeError(\"Elevation constructor cannot be called as a function.\");\n    }\n\n    this.z = null;\n}\n\nElevation.prototype = {\n\n    constructor : Elevation\n\n};\n\nexport default Elevation;\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","\"use strict\";\n\n// ref: https://github.com/tc39/proposal-global\nvar getGlobal = function () {\n\t// the only reliable means to get the global object is\n\t// `Function('return this')()`\n\t// However, this causes CSP violations in Chrome apps.\n\tif (typeof self !== 'undefined') { return self; }\n\tif (typeof window !== 'undefined') { return window; }\n\tif (typeof global !== 'undefined') { return global; }\n\tthrow new Error('unable to locate global object');\n}\n\nvar globalObject = getGlobal();\n\nmodule.exports = exports = globalObject.fetch;\n\n// Needed for TypeScript and Webpack.\nif (globalObject.fetch) {\n\texports.default = globalObject.fetch.bind(globalObject);\n}\n\nexports.Headers = globalObject.Headers;\nexports.Request = globalObject.Request;\nexports.Response = globalObject.Response;\n","(function(root,factory){if(typeof exports===\"object\"&&typeof module===\"object\")module.exports=factory();else if(typeof define===\"function\"&&define.amd)define(\"EventBus\",[],factory);else if(typeof exports===\"object\")exports[\"EventBus\"]=factory();else root[\"EventBus\"]=factory()})(this,function(){var EventBusClass={};EventBusClass=function(){this.listeners={}};EventBusClass.prototype={addEventListener:function(type,callback,scope){var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>3?args.splice(3,args.length-1):[];if(typeof this.listeners[type]!=\"undefined\"){this.listeners[type].push({scope:scope,callback:callback,args:args})}else{this.listeners[type]=[{scope:scope,callback:callback,args:args}]}},removeEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;var newArray=[];for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if(listener.scope==scope&&listener.callback==callback){}else{newArray.push(listener)}}this.listeners[type]=newArray}},hasEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;if(callback===undefined&&scope===undefined){return numOfCallbacks>0}for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if((scope?listener.scope==scope:true)&&listener.callback==callback){return true}}}return false},dispatch:function(type,target){var event={type:type,target:target};var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>2?args.splice(2,args.length-1):[];args=[event].concat(args);if(typeof this.listeners[type]!=\"undefined\"){var listeners=this.listeners[type].slice();var numOfCallbacks=listeners.length;for(var i=0;i<numOfCallbacks;i++){var listener=listeners[i];if(listener&&listener.callback){var concatArgs=args.concat(listener.args);listener.callback.apply(listener.scope,concatArgs)}}}},getEvents:function(){var str=\"\";for(var type in this.listeners){var numOfCallbacks=this.listeners[type].length;for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];str+=listener.scope&&listener.scope.className?listener.scope.className:\"anonymous\";str+=\" listen for '\"+type+\"'\\n\"}}return str}};var EventBus=new EventBusClass;return EventBus});","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"point|circle|bbox\" }] */\n\n/**\n* Geoportal web services invocation namespace.\n*\n* @module Services\n* @alias Gp.Services\n*/\nimport Config from \"./Config/Config\";\nimport Alti from \"./Alti/Alti\";\nimport Geocode from \"./Geocode/Geocode\";\nimport ReverseGeocode from \"./Geocode/ReverseGeocode\";\nimport AutoComplete from \"./AutoComplete/AutoComplete\";\nimport Route from \"./Route/Route\";\nimport ProcessIsoCurve from \"./ProcessIsoCurve/ProcessIsoCurve\";\n\nvar Services = {\n    /**\n     * Access to Geoportal resources metadata availables with one ore several keys\n     *\n     * @method getConfig\n     * @param {Object} options - Options for function call.\n     * @param {String} [options.apiKey] - Access key(s) (\",\" as separator, no spaces) to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}\n     * @param {String} [options.customConfigFile] - path to a local config file. Overload the apiKey parameter\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GetConfigResponse} object as a parameter except if \"rawResponse\" parameter is set to true : a String will be returned.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     */\n    getConfig : function (options) {\n        var configService = new Config(options);\n        configService.call();\n    },\n    /**\n     * Getting elevations in or along of one or several points on french territories using the [elevation services of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/alti.html}.<br/>\n     * Two use cases are availables :<br/>\n     * 1. getting elevations of the given points : don't use the options.sampling parameter ;<br/>\n     * 2. getting a regular set of elevations along the given points : use the options.sampling parameter.\n     *\n     * @method getAltitude\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {Array.<Object>} options.positions - Array of positions ({lon:float, lat:float}) expressed in CRS:84 coordinates system, where to get elevations. 50 positions maximum may be given. 2 positions minimum are required if you use the options.sampling parameter.\n     * @param {Number} [options.sampling] - Number of points to use (between 2 and 5000) in order to compute an elevation path. The points given with the options.positions parameter are used to fix the planimetric path along which the elevations will be computed.<br/>\n     * If not used, only elevations of these positions will be returned.\n     * @param {Boolean} [options.zonly=false] - Set this parameter to true if you only want to have elevations returned without corresponding coordinates.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.AltiResponse} object as a parameter, except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=https://data.geopf.fr/altimetrie/1.0/calcul/alti/rest/elevation.json] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     * @param {String} [options.api='REST'] - What API to use for interacting with underlying web service : 'REST'. Only use if you know what you are doing.\n     * @param {String} [options.outputFormat='xml'] - Output format for underlying web service response : 'xml' or 'json'. Only use if you know what you are doing.\n     */\n    getAltitude : function (options) {\n        var altiService = new Alti(options);\n        altiService.call();\n    },\n    /**\n     * Getting positon of a geographic identifier (places names, address, cadastral parcel, other...) using the [geocoding web service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}.\n     *\n     * @example\n     * Gp.Services.geocode ({\n     *     apiKey : \"carte\",\n     *     location : \"73 avenue de Paris, Saint-Mandé\",\n     *     // traitement des resultats\n     *     onSuccess  : function (result) {\n     *         console.log(\"found (x:\"+result.position.x+\", y:\"+result.position.y+\")\") ;\n     *     }\n     * }) ;\n     *\n     *\n     * @method geocode\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {String} [options.index=\"StreetAddress\"] - Geographical identifier type to search. Values currently availables are : \"PositionOfInterest\" for place names, \"StreetAddress\" for address search, \"CadastralParcel\" for Cadastral parcels search, \"location\" for a multi-index search on \"StreetAddress\" and \"PositionOfInterest\". Default is \"StreetAddress\".\n     * @param {String} options.query - Geographic identifier to locate.\n     * @param {Object} [options.filters] - Additional filters to apply to search. The following properties may be given.\n     *      @param {String} [options.filters.[prop]] - Additionnal properties to filter search. Properties depends on options.index, and values type should be \"String\".\n     *      <br/><br/>\n     *      Properties availables for address search :<br/>\n     *      \"postalCode\", \"inseeCode\" and \"city\".\n     *      <br/><br/>\n     *      Properties availables for place names search :<br/>\n     *      \"postalCode\", \"inseeCode\" and \"type\".\n     *      <br/><br/>\n     *      Properties availables for cadastral parcels search :<br/>\n     *      \"codeDepartement\", \"codeCommune\", \"nomCommune\", \"codeCommuneAbs\", \"codeArrondissement\", \"section\", \"numero\", \"feuille\".\n     * @param {Number} [options.maximumResponses=20] - Maximum number of responses. Default underlying service value applies (20) if not provided.\n     * @param {Boolean} [options.returnTrueGeometry=false] - Set this parameter to true if you wish to have the true geometrie returned.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GeocodeResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://data.geopf.fr/geocodage/search] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     */\n    geocode : function (options) {\n        var geocodeService = new Geocode(options);\n        geocodeService.call();\n    },\n    /**\n     * Retrieving geographical identifiers (place names, address, cadastral parcels, ...) near a given position, using the [reverse geocoding web service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/geocodage-inverse.html}.\n     *\n     * @method reverseGeocode\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {String} [options.index=\"StreetAddress\"] - Geographical identifier type to search. Values currently availables are : \"PositionOfInterest\" for place names, \"StreetAddress\" for address search, \"CadastralParcel\" for Cadastral parcels search, \"location\" for a multi-index search on \"StreetAddress\" and \"PositionOfInterest\". Default is \"StreetAddress\".\n     * @param {Object} options.position - Reference position where to search geographical identifiers.\n     *      @param {Float} options.position.lon - Longitude\n     *      @param {Float} options.position.lat - Latitude\n     * @param {Object} [options.filters] - Additional filters to apply to search. The following properties may be given.\n     *      @param {String} [options.filters.[prop]] - Additionnal properties to filter search. Properties depends on options.index, and values type should be \"String\".\n     *      <br/><br/>\n     *      Properties availables for address search :<br/>\n     *      \"postalCode\", \"inseeCode\" and \"city\".\n     *      <br/><br/>\n     *      Properties availables for place names search :<br/>\n     *      \"postalCode\", \"inseeCode\" and \"type\".\n     *      <br/><br/>\n     *      Properties availables for cadastral parcels search :<br/>\n     *      \"codeDepartement\", \"codeCommune\", \"nomCommune\", \"codeCommuneAbs\", \"codeArrondissement\", \"section\", \"numero\", \"feuille\".\n     * @param {Object} [options.searchGeometry] - Location where to perform the search.\n     *      @param {String} options.searchGeometry.type - Geometry type (Point|Circle|Linestring|Polygon)\n     *      @param {Array.<Float>|Array.Array.<Float>} options.searchGeometry.coordinates - Coordinates\n     *      @param {Float} [options.searchGeometry.radius] - Radius (only for type 'Circle')\n     * @param {Number} [options.maximumResponses=20] - Maximum number of responses. Default underlying service value applies (20) if not provided.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GeocodeResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=https://data.geopf.fr/geocodage/reverse] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     */\n    reverseGeocode : function (options) {\n        var reverseGeocodeService = new ReverseGeocode(options);\n        reverseGeocodeService.call();\n    },\n    /**\n     * Getting suggestions of probable places names or address based on uncomplete texts, using the [autocompletion service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/autocompletion.html}\n     *\n     * @method autoComplete\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {String} options.text - Text input to complete.\n     * @param {Array.<String>} [options.filterOptions.type = \"StreetAddress\"] - Suggestion types to provide : address (\"StreetAddress\") and/or place name (\"PositionOfInterest\").\n     * @param {Array.<String>} [options.filterOptions.territory] - Places where to limit the search of suggestions : \"METROPOLE\" (Corsica and metropolitan France), \"DOMTOM\" (French overseas departments and territories), or an INSEE code of a department. No limitation by default. For instance : ['METROPOLE', '31']\n     * @param {Number} [options.maximumResponses = 10] - Maximum number of responses.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.AutoCompleteResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=https://data.geopf.fr/geocodage/completion] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     */\n    autoComplete : function (options) {\n        var autoCompleteService = new AutoComplete(options);\n        autoCompleteService.call();\n    },\n    /**\n     * Getting a route from one point to another using the [route service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/itineraires.html}.\n     *\n     * @method route\n     * @param {Object} options - Options for function call.\n     * @param {String} options.resource - Resource used to compute the route. Available values are in the GetCapabilities.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {String} [options.routePreference = \"fastest\"] - Indicates the way to compute the route : \"fastest\" (time optimisation) or \"shortest\" (distance optimisation). Available values are in the GetCapabilities.\n     * @param {Gp.Point} options.startPoint - Start point of the route. Expressed in CRS:84 coordinates system (startPoint.x corresponds to longitude, startPoint.y corresponds to latitude). Available bbox are in the GetCapabilities.\n     * @param {Gp.Point} options.endPoint - End point of the route. Expressed in CRS:84 coordinates system (endPoint.x corresponds to longitude, endPoint.y corresponds to latitude). Available bbox are in the GetCapabilities.\n     * @param {Array.<Gp.Point>} [options.viaPoints] - Ordered via Points of the route. Expressed in CRS:84 coordinates system (viaPoints[i].x corresponds to longitude, viaPoints[i].y corresponds to latitude). Available bbox are in the GetCapabilities.\n     * @param {String} [options.graph = \"Voiture\"] - User profile to use to compute the route : \"Voiture\" (using a vehicule) or \"Pieton\" (pedestrian). Has an influence on the kind of roads the route may use and the average speed. Available bbox are in the GetCapabilities.\n     * @param {Array.<String>} [options.exclusions] - DEPRECATED: use options.constraints. Indicates if route has to avoid some features (\"toll\", \"bridge\" or \"tunnel\").\n     * @param {Boolean} [options.geometryInInstructions = false] - Indicates if route geometry has to be also returned with route instructions.\n     * @param {Boolean} [options.provideBoundingBox = true] - Indicates if route instructions has to be localised with a BBOX in the response.\n     * @param {String} [options.distanceUnit = \"m\"] - The unit used to provide distances in the response (\"meter\" or \"kilometer\").\n     * @param {String} [options.timeUnit = \"second\"] - The unit used to provide duration in the response (\"standard\", \"second\", \"minute\", \"hour\").\n     * @param {Array.<String>} [options.waysAttributes] - Way Attributes to add in the response. Available values are in the GetCapabilities.\n     * @param {Array.<Object>} [options.constraints] - Constraints used ({'constraintType':'banned','key':'ways_type','operator':'=','value':'autoroute'}). Available values are in the GetCapabilities.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.RouteResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.outputFormat='json'] - Output format (\"json\" or \"xml\") to use for underlying webService. Only use if you know what you are doing.\n     * @param {String} [options.serverUrl=https://data.geopf.fr/navigation/itineraire] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     */\n    route : function (options) {\n        var routeService = new Route(options);\n        routeService.call();\n    },\n    /**\n     * Computing a set of places (curve) reachable from a given point (or from where to start to reach a given point) within a time or distance constraint using the [isochrone service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/isochrones.html}.\n     *\n     * @method isoCurve\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link https://geoservices.ign.fr/services-web}.\n     * @param {String} options.resource - Resource used to compute the route. Available values are in the GetCapabilities.\n     * @param {Gp.Point} options.position - Start or Arrival (options.reverse===true) Point for the computing. Expressed in CRS:84 coordinates system (position.x corresponds to longitude, position.y corresponds to latitude).\n     * @param {String} [options.graph = \"Voiture\"] - User profile to use to compute the isoCurve : \"Voiture\" (using a vehicule) or \"Pieton\" (pedestrian). Has an influence on the kind of roads to use and the average speed. Available values are in the GetCapabilities.\n     * @param {Array.<String>} [options.exclusions] - DEPRECATED: use options.constraints. Indicates if route has to avoid some features (\"toll\", \"bridge\" or \"tunnel\").\n     * @param {Array.<Object>} [options.constraints] - Constraints used ({'constraintType':'banned','key':'ways_type','operator':'=','value':'autoroute'}). Available values are in the GetCapabilities.\n     * @param {String} [options.method = \"time\"] - Computing method to use : \"time\" (using a duration as a constraint) or \"distance\" (using a distance as a constraint). Available values are in the GetCapabilities.\n     * @param {Float} options.time - Maximum duration (expressed in seconds) to use when options.method is set to \"time\".\n     * @param {Float} options.distance - Maximum distance (expressed in meters) to use when options.method is set to \"distance\".\n     * @param {Boolean} [options.reverse = false] - Set this parameter to true if you want options.position to be the destination (instead of departure) for the computing.\n     * @param {String} [options.distanceUnit = \"km\"] - The unit used to provide distances in the response (\"m\" or \"km\").\n     * @param {String} [options.timeUnit = \"second\"] - The unit used to provide duration in the response (\"standard\", \"second\", \"minute\", \"hour\").\n     * @param {Boolean} [options.smoothing = false] - DEPRECATED: Set this parameter to true if you want the resulting geometry to be smoothed.\n     * @param {Boolean} [options.holes = false] - DEPRECATED: Set this parameter to true if you want the resulting geometry (polygon) to have holes if pertinent.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.IsoCurveResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.outputFormat='json'] - Output format (\"json\") to use for underlying webService. Only use if you know what you are doing.\n     * @param {String} [options.serverUrl=https://data.geopf.fr/navigation/isochrone] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {Boolean} [options.ssl = true] - Use of HTTPS or HTTP protocol to request the services. HTTPS by default (ssl=true).\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Only use if you know what you are doing.\n     */\n    isoCurve : function (options) {\n        var processIsoCurveService = new ProcessIsoCurve(options);\n        processIsoCurveService.call();\n    }\n};\n\n/**\n * Point object.\n *\n * @namespace\n * @alias Gp.Point\n *\n * @property {Float} x - Point abscissa\n * @property {Float} y - Point ordinate\n */\nvar point = {};\n\n/**\n * Circle object.\n *\n * @namespace\n * @alias Gp.Circle\n *\n * @property {Float} x - Circle center abscissa.\n * @property {Float} y - Circle center ordinate.\n * @property {Float} radius - Circle radius.\n */\nvar circle = {};\n\n/**\n * Bounding box object, expressed with four coordinates.\n *\n * @namespace\n * @alias Gp.BBox\n *\n * @property {Float} left - minimum abscissa\n * @property {Float} right - maximum abscissa\n * @property {Float} bottom - minimum ordinate\n * @property {Float} top - maximum ordinate\n */\nvar bbox = {};\n\nexport default Services;\n","/**\n * @module GeocodeUtils\n * @alias module:~utils/GeocodeUtils\n * @private\n * @description\n * ...\n *\n * @example\n * getGeocodedLocationFreeform();\n * getSuggestedLocationFreeform();\n */\nvar GeocodeUtils = {\n    /**\n     * Return the freeform of a structured geocoded item\n     *\n     * @param {Object} geocodedLocation - Geocoded location\n     * @returns {String} freeform string\n     */\n    getGeocodedLocationFreeform : function (geocodedLocation) {\n        var attributes = geocodedLocation.placeAttributes;\n        if (attributes.label) {\n            return attributes.label;\n        } else if (geocodedLocation.type === \"PositionOfInterest\") {\n            var resultToReturn = attributes.toponym;\n            if (attributes.category && Array.isArray(attributes.category) && attributes.category.length >= 2 && attributes.category[0] === \"administratif\") {\n                // gestion particulière des territoires administratifs\n                resultToReturn = resultToReturn + \", \" + attributes.category[1];\n            } else {\n                // gestion standard des POI non adminsitratifs\n                if (attributes.postcode) {\n                    resultToReturn = resultToReturn + \", \" + attributes.postcode[0];\n                    if (attributes.city) {\n                        resultToReturn = resultToReturn + \" \" + attributes.city[0];\n                    }\n                }\n            }\n            return resultToReturn;\n        } else if (geocodedLocation.type === \"StreetAddress\") {\n            return (attributes.housenumber ? attributes.housenumber + \" \" : \"\") + attributes.street + \" \" + (attributes.postcode ? attributes.postcode + \", \" : \"\") + attributes.city;\n        } else if (geocodedLocation.type === \"CadastralParcel\") {\n            return attributes.id;\n        } else {\n            return \"...\";\n        }\n    },\n\n    /**\n     * Return the freeform of a structured suggested item\n     *\n     * @param {Object} suggestedLocation - Suggested location\n     * @returns {String} freeform string\n     */\n    getSuggestedLocationFreeform : function (suggestedLocation) {\n        if (suggestedLocation.fullText) {\n            return suggestedLocation.fullText;\n        } else {\n            var values = [];\n            values.push(suggestedLocation.street || \"\");\n            values.push(suggestedLocation.postalCode || \"\");\n            values.push(suggestedLocation.commune || \"\");\n\n            if (suggestedLocation.type === \"PositionOfInterest\") {\n                values.push(suggestedLocation.poi || \"\");\n                values.push(suggestedLocation.kind || \"\");\n            }\n            return values.join(\" - \");\n        }\n    }\n};\n\nexport default GeocodeUtils;\n","import PanelManager from \"../Utils/PanelManager\";\n// Mixin pour ajouter des méthodes communes à tous les widgets.\n\n// voir fichiers DOM  et assign\n// modifier snippets.\nvar Widget = {\n    /**\n     * This method is called when a widget opens a panel\n     * It calls the panelManager to automatically close other panels\n     */\n    onPanelOpen : function () {\n        // On récupère l'id du widget à partir de l'id du DOM de la forme GPwidgetName-1876465465\n        PanelManager(this.options.position, this.element.id.match(/(\\w+)-[0-9]+/)[1]);\n    }\n};\n\nexport default Widget;","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\nimport AltiRequest from \"./AltiRequest\";\n\n/**\n * @classdesc\n * Classe de gestion des param. des requêtes de type PROFIL du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiProfilRequest\n * @param {Object}   options - options\n * @param {String}   options.sampling - 3\n *\n * @private\n */\nfunction AltiProfilRequest (options) {\n    if (!(this instanceof AltiProfilRequest)) {\n        throw new TypeError(\"AltiProfilRequest constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"AltiProfilRequest\";\n\n    // appel du constructeur par heritage\n    AltiRequest.apply(this, arguments);\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur AltiProfilRequest ()]\");\n\n    /**\n     * Sampling\n     * Par defaut, 3\n     */\n    this.sampling = this.options.sampling || 3; // test des options héritées !\n}\n\n/**\n * @lends module:AltiProfilRequest#\n */\n\nAltiProfilRequest.prototype = Object.create(AltiRequest.prototype, {\n\n    /**\n     * Setter/getter pour \"sampling\"\n     */\n    sampling : {\n        /** getter */\n        get : function () {\n            return this._sampling;\n        },\n        /** setter */\n        set : function (value) {\n            this._sampling = value;\n        }\n    }\n});\n\n/**\n * Constructeur (alias)\n */\nAltiProfilRequest.prototype.constructor = AltiProfilRequest;\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]}\n */\nAltiProfilRequest.prototype.getData = function () {\n    // par glop..., appel de AltiRequest::getData () !\n    var map = [];\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    // map.push({k : \"delimiter\", v : this.delimiter}); // FIXME on retire le param \"delimiter\"\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"sampling\",\n        v : this.sampling\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n    map.push({\n        k : \"resource\",\n        v : this.resource\n    });\n\n    return map;\n};\n\nexport default AltiProfilRequest;\n","/**\n * Classe utilitaire\n *\n * @module Helper\n * @alias Gp.Helper\n */\nvar Helper = {\n\n    /**\n     * concatenation des parametres key/value dans les urls\n     *\n     * @method normalyzeParameters\n     * @static\n     * @param {Object} params - tableau de clef/valeur\n     *\n     * @example\n     *  Gp.Utils.Helper.normalyzeParameters ({\n     *         key1:value1,\n     *         key2:value2,\n     *         key3:value3\n     *  });\n     *  // out : \"key1=value1&key2=value2&key3=value3\"\n     *\n     * @returns {String} retourne les paramètres concaténés\n     */\n    normalyzeParameters : function (params) {\n        var myParams = null;\n\n        if (params) {\n            var tabParams = [];\n            for (var key in params) {\n                if (params.hasOwnProperty(key)) {\n                    var value = params[key];\n                    if (!value) {\n                        value = \"\";\n                    }\n                    tabParams.push(key + \"=\" + value);\n                }\n            }\n\n            myParams = tabParams.join(\"&\");\n        }\n\n        return myParams;\n    },\n\n    /**\n     * Concaténation et encodage des urls.\n     *\n     * @method normalyzeUrl\n     * @static\n     * @param {String} url - url\n     * @param {Object|String} params - tableau de clef/valeur ou string\n     * @param {Boolean} encode - true|false, false par defaut\n     *\n     * @example\n     *  Gp.Utils.Helper.normalyzeUrl (url, {\n     *         key1:value1,\n     *         key2=:value2,\n     *         key3:value3\n     *  });\n     *  // out : \"url?key1=value1&key2=value2&key3=value3\"\n     *\n     * @returns {String} retourne une url normalisée\n     */\n    normalyzeUrl : function (url, params, encode) {\n        var myUrl = url;\n\n        if (url) {\n            if (url.split(\"?\").length - 1 >= 2) {\n                // S'il y a plusieurs \"?\" dans l'URL, on garde le premier et on remplace les autres par des &\n                var firstOccuranceIndex = url.search(/\\?/) + 1;\n                myUrl = url.substring(0, firstOccuranceIndex) + url.slice(firstOccuranceIndex).replace(/\\?/g, \"&\");\n            }\n\n            var k = url.indexOf(\"?\");\n            if (k === -1) { // pas de ? et KVP\n                myUrl += \"?\";\n            }\n\n            if (k !== -1 && k !== url.length - 1) { // KVP\n                myUrl += \"&\";\n            }\n        }\n\n        if (params) {\n            if (typeof params === \"string\") {\n                params = params.replace(\"?\", \"\");\n                myUrl += params;\n            } else {\n                myUrl += this.normalyzeParameters(params);\n            }\n        }\n\n        if (encode) {\n            // FIXME bonne idée ?\n            myUrl = encodeURIComponent(myUrl);\n        }\n\n        return myUrl;\n    },\n\n    /**\n     * Indentation d'une chaine\n     *\n     * @method indent\n     * @static\n     * @param {Number} n - nombre de tabulation\n     * @param {String} msg - chaine\n     *\n     * @example\n     * Gp.Utils.Helper.indent (2, \"message à indenter\")\n     * // out\n     * // ........message à indenter\n     *\n     * @returns {String} retourne une chaine indentée\n     */\n    indent : function (n, msg) {\n        var num = n || 0;\n        return new Array(num + 1).join(\"\\t\") + msg;\n    }\n};\n\nexport default Helper;\n","/**\n * JSONP : Implémentation du protocole JSONP de la plateforme Géoportail\n *\n * @module JSONP\n * @private\n * @alias Gp.Protocols.JSONP\n */\nimport Logger from \"../Utils/LoggerByDefault\";\n\n// cf. https://github.com/sobstel/jsonp.js\nvar JSONP = {\n\n    /**\n     * Construction d'un identifiant statique basé sur le timestamp,\n     * et qui s'incremente de +1 à chaque appel\n     */\n    uuid : (function () {\n        var id = Math.floor(Date.now());\n        return function () {\n            return id++;\n        };\n    })(),\n\n    /**\n     * Cette fonction réalise l'appel du service fourni via le paramètre \"options.url\"\n     * en mettant en œuvre le protocole JSONP.\n     *\n     * @method call\n     * @static\n     * @param {Object} options - parametres d'invocation du service en JSONP\n     * @param {String} options.url - URL du service à invoquer (indépendamment du protocole JSONP).\n     *  Cette URL contient déjà les paramètres du service.\n     *  Si le paramètre dédié à la mise en oeuvre du protocole JSONP (callback=xxx) n'est pas présent, il est rajouté par la fonction ;\n     *  sa valeur est déterminée en fonction du paramètre callbackName.\n     * @param {Number} [options.timeOut = 0] - Nombre de ms au bout duquel on considère que le service n'a pas répondu.\n     *  Une valeur de 0 pour ce paramètre permet de désactiver la gestion du timeOut.\n     * @param {String} [options.callbackSuffix = null] - Suffixe de la fonction de callback à rajouter sur l'URL.\n     *  Si aucun suffixe n'est spécifié (cas par défaut), on utilisera l'identifiant this.uuid () comme suffixe. Ex: \"callback1458574396582 ()\"\n     * @param {String} [options.callbackName = gp.protocol.jsonp] - Valeur du paramètre callback à rajouter sur l'URL.\n     *  Si l'URL fournie contient déjà le paramètre callback, le paramètre callbackName ne sera pas pris en compte.\n     *  La fonction de callback est créée dynamiquement par la fonction JSONP ;\n     *  elle a deux fonctions :\n     *    elle annule la condition de timeOut\n     *    puis appelle la fonction fournie par l'utilisateur via le paramètre onResponse.\n     * @param {Function} options.onResponse - Nom de la fonction qui sera appelée lors de la réception des résultats du service.\n     *  Ce paramètre sera ignoré si l'URL contient déjà le paramètre callback.\n     *  La fonction de rappel appelée sera alors celle ayant pour nom la valeur de ce paramètre.\n     * @param {Function} [options.onTimeOut] - Nom de la fonction qui sera appelée en cas de non réponse du service.\n     *  Le temps au bout duquel on considère que le service n'a pas répondu est déterminé par le paramètre timeOut.\n     *  @example\n     *  var options = {\n     *      url : 'http://localhost/some/test.json&callback=myResults',\n     *      timeOut : 100,\n     *      callbackName : 'myResults',\n     *      callbackSuffix : \"\",\n     *      onResponse : function (response) {\n     *          console.log('results : ', response);\n     *      },\n     *\n     *   };\n     *   JSONP.call(options);\n     */\n    call : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"JSONP\");\n        logger.trace(\"[JSONP::call ()]\");\n\n        // analyse parametres\n\n        if (!options) {\n            logger.error(\"missing parameter : options !\");\n            throw new Error(\"missing parameter : options !\");\n        }\n\n        if (!options.url) {\n            logger.error(\"missing parameter : options.url !\");\n            throw new Error(\"missing parameter : options.url !\");\n        }\n\n        if (!options.timeOut) {\n            logger.info(\"setting 'options.timeOut' default value\");\n            options.timeOut = 0;\n        }\n\n        // FIXME si un callback coté client a été mis en place,\n        // cette condition sur cette methode n'a pas de sens !?\n        if (!options.onResponse) {\n            logger.error(\"missing parameter : options.onResponse !\");\n            throw new Error(\"missing parameter : options.onResponse !\");\n            // FIXME doit on definir un callback interne par defaut !?\n            // options.onResponse = function (data) {\n            //    console.log(\"response callback (inner) : \", data);\n            // };\n        }\n\n        // ID du callback à utiliser : null ou string.\n        // si l'utilisateur a spécifié un suffixe pour le callback, on le récupère comme un ID (ex: options.callbackSuffix = \"\")\n        // sinon, on utilise un timestamp : this.uuid ()\n        var callbackId = (typeof options.callbackSuffix === \"string\") ? options.callbackSuffix : this.uuid();\n\n        // on recherche le parametre callback et son nom de fonction dans l'url\n        var urlHasCallbackKey = false;\n        var urlHasCallbackName = false;\n\n        var idx = options.url.indexOf(\"callback=\");\n\n        if (idx !== -1) {\n            urlHasCallbackKey = true;\n            // extraction callbackName de l'url : entre \"callback=\" et \"&\" ou fin de ligne\n            var j = options.url.indexOf(\"&\", idx);\n            if (j === -1) {\n                j = options.url.length;\n            }\n\n            // on ecrase le parametre options.callbackName s'il avait été défini\n            var callbackName = options.url.substring(idx + 9, j);\n\n            if (callbackName) {\n                urlHasCallbackName = true;\n                options.callbackName = callbackName;\n                logger.info(\"setting 'options.callbackName' value (\" + options.callbackName + \") from 'options.url' parameter\");\n            }\n        }\n\n        // on ajoute le parametre callback dans l'URL s'il n'existe pas\n        if (!urlHasCallbackKey) {\n            // gestion des autres param. et \"?\"\n            var k = options.url.indexOf(\"?\");\n            if (k === -1) {\n                // aucun param., ni de '?'\n                options.url = options.url + \"?\" + \"callback=\";\n            } else if (k === options.url.length) {\n                // uniquement le '?'\n                options.url = options.url + \"callback=\";\n            } else {\n                // le '?' et les param. existent\n                options.url = options.url + \"&\" + \"callback=\";\n            }\n            logger.info(\"setting callback default key in 'options.url' : \" + options.url);\n        }\n\n        // utilisation de la fonction callback coté client ?\n        var HasCallbackName = options.callbackName ? true : urlHasCallbackName;\n\n        // on ajoute le nom de la fonction callback dans l'URL si elle n'existe pas\n        if (!urlHasCallbackName) {\n            // fonction callback par defaut\n            if (!options.callbackName) {\n                logger.info(\"setting 'options.callbackName' default value\");\n                options.callbackName = \"callback\"; // ou \"gp.protocol.jsonp\" ?\n                // info : si on ne veut pas gerer d'ID dans le callback,\n                // options.callbackSuffix = \"\"\n                if (callbackId || callbackId === \"\") {\n                    options.callbackName += callbackId;\n                }\n            }\n            options.url = options.url.replace(\"callback=\", \"callback=\" + options.callbackName);\n            logger.info(\"setting callback function name in 'options.url' : \" + options.url);\n        }\n\n        // timeOut par defaut\n        if (!options.onTimeOut) {\n            logger.info(\"setting 'options.onTimeOut' default value\");\n            /** callback timeout par defaut */\n            options.onTimeOut = function (/* error */) {\n                console.log(\"TimeOut while invoking url : \" + options.url);\n            };\n        }\n\n        if (!HasCallbackName) {\n            var self = this;\n\n            // event du timeout\n            var onTimeOutTrigger = null;\n\n            // declenche le timeout si > à 0 !\n            if (options.timeOut > 0) {\n                onTimeOutTrigger = window.setTimeout(\n                    function () {\n                        /** fonction de reponse du service */\n                        window[options.callbackName] = function () {};\n                        options.onTimeOut();\n                        self._deleteScript(callbackId);\n                    }, options.timeOut);\n            }\n\n            // FIXME le nom de la fonction n'accepte pas de namespace !\n            // ex. Gp.Function.callback\n            /**\n            * fonction de reponse du service\n            * @param {Object} data - data\n            * @private\n            */\n            window[options.callbackName] = function (data) {\n                window.clearTimeout(onTimeOutTrigger);\n                options.onResponse(data);\n                self._deleteScript(callbackId);\n            };\n        }\n\n        this._createScript(callbackId, options.url);\n    },\n\n    /**\n    * create Script\n    * @param {String} callbackId - callback Id\n    * @param {String} url - url\n    * @private\n    */\n    _createScript : function (callbackId, url) {\n        var scriptu;\n        var scripto = document.getElementById(\"results\" + callbackId);\n\n        scriptu = document.createElement(\"script\");\n        scriptu.setAttribute(\"type\", \"text/javascript\");\n        scriptu.setAttribute(\"src\", url);\n        scriptu.setAttribute(\"charset\", \"UTF-8\");\n        scriptu.setAttribute(\"id\", \"results\" + callbackId);\n        scriptu.setAttribute(\"async\", \"true\"); // FIXME async ?\n        // head ou body ou autres ?\n        var node = document.documentElement || document.getElementsByTagName(\"head\")[0];\n        if (scripto === null) {\n            node.appendChild(scriptu);\n        } else {\n            // s'il existe déjà, on le remplace !\n            node.replaceChild(scriptu, scripto);\n        }\n    },\n\n    /**\n    * delete Script\n    * @param {String} callbackId - callback Id\n    * @private\n    */\n    _deleteScript : function (callbackId) {\n        var script = document.getElementById(\"results\" + callbackId);\n        if (script) {\n            var node = script.parentNode || document.documentElement;\n            if (!node) {\n                return;\n            }\n            node.removeChild(script);\n        }\n    }\n};\n\nexport default JSONP;\n","/**\n * Response object for {@link module:Services~getAltitude Gp.Services.getAltitude ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.Alti.Elevation>} elevations - Elevations array.\n *\n * @namespace\n * @alias Gp.Services.AltiResponse\n */\nfunction AltiResponse () {\n    if (!(this instanceof AltiResponse)) {\n        throw new TypeError(\"AltiResponse constructor cannot be called as a function.\");\n    }\n\n    this.elevations = [];\n}\n\nAltiResponse.prototype = {\n\n    constructor : AltiResponse\n\n};\n\nexport default AltiResponse;\n","// import OpenLayers\nimport Control from \"ol/control/Control\";\nimport {\n    Select as SelectInteraction,\n    Modify as ModifyInteraction,\n    Draw as DrawInteraction\n} from \"ol/interaction\";\n// import local\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Utils from \"../../Utils/Helper\";\n\nvar logger = Logger.getLogger(\"interactions\");\n\n/**\n * @private\n * @description\n * Pourquoi et comment l'utiliser ?\n * Cette classe permet de gérer les interactions entre chaque extension.\n * Une extension qui active une interaction avec la carte, doit desactiver\n * les autres interactions issues d'autre extensions.\n * La désactivation d'une interaction s'accompagne d'actions telles que\n * le nettoyage des dessins, l'état du composant graphique, ...\n *\n * Ex\n * // desactive toutes les interactions avec l'opération par defaut : clean\n * Interactions.unset(map);\n * // desactive les interactions sauf celles de Drawing. On execute des\n * // operations particulieres : status, collapse et message\n * Interactions.unset(map, {\n *    current : \"Drawing\",\n *    status : false,\n *    collapse : true,\n *    messsage : [\"WARNING\", \"Ceci est un avertissement !\"]\n * });\n *\n * Dans le code de l'extension, il faut placer des informations dans l'interaction :\n * interaction.setProperties({\n *     name : \"Drawing\",\n *     source : this\n * });\n */\nvar Interactions = {\n\n    /**\n     * Liste des extensions qui utilisent le mécanisme des interactions\n     */\n    _extensions : [\n        \"Measures\",\n        \"ElevationPath\",\n        \"Drawing\"\n    ],\n\n    /**\n     * Options par defaut\n     * - current : ex. \"Drawing\"\n     *       c'est l'extension qui demande la desactivation des autres interactions.\n     *       Par defaut, toutes les interactions sont desactivées.\n     * - clean :\n     *       c'est la suppression des interactions, des dessins de la carte,\n     *       ainsi que la reinitialisation de l'état graphique.\n     *       Les extensions doivent implementer la méthode 'clean()'.\n     *       Par defaut, tous les dessins sont supprimés\n     */\n    _options : {\n        current : null,\n        clean : null\n    },\n\n    /**\n     * Permet de desactive les interactions (Draw) de la carte pour les extensions,\n     * sauf l'interaction courrante (si elle est renseignée avec l'option 'current').\n     * Il est possible d'ajouter des fonctionnalités via les options.\n     * Par defaut, l'option 'clean' est renseignée...\n     *\n     * @param {Object} map - the map\n     * @param {Object} options - options\n     */\n    unset : function (map, options) {\n        logger.trace(\"unset()\");\n\n        var opts = {};\n        Utils.mergeParams(opts, this._options);\n        Utils.mergeParams(opts, options);\n\n        var interactions = map.getInteractions().getArray();\n        for (var i = 0; i < interactions.length; i++) {\n            if (interactions[i].getActive() &&\n                (interactions[i] instanceof DrawInteraction ||\n                    interactions[i] instanceof SelectInteraction ||\n                    interactions[i] instanceof ModifyInteraction)) {\n                var prop = interactions[i].getProperties();\n                var name = prop.name;\n                if (typeof name !== \"undefined\" && this._extensions.indexOf(name) > -1) {\n                    // doit on desactiver l'interaction courrante ?\n                    if (opts.current && opts.current === name) {\n                        continue;\n                    }\n                    interactions[i].setActive(false);\n                    // instance de l'extension\n                    var source = prop.source;\n                    if (typeof source !== \"undefined\" && source instanceof Control) {\n                        // opérations sur le composant graphique\n                        for (var action in opts) {\n                            if (opts.hasOwnProperty(action)) {\n                                if (action === \"current\") {\n                                    continue;\n                                }\n                                if (typeof source[action] === \"function\") {\n                                    var args = Array.isArray(opts[action]) ? opts[action] : [opts[action]];\n                                    source[action].apply(source, args);\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    interactions[i].setActive(false);\n                }\n            }\n        }\n    }\n};\n\nexport default Interactions;\n","\n/**\n * Fonction retournant un objet contenant des clés de lecture (readers)\n *      qui permettent de parser des réponses XML du service Altimétrique du Géoportail\n *      (calcul altimétrique simple ou profil altimétrique d'une courbe),\n *      lorsque le paramètre output = xml,\n *      afin de récupérer les élévations retournées.\n *\n * @module AltiResponseReader\n * @alias Gp.Services.Alti.Formats.AltiResponseReader\n * @private\n */\n\n// import Logger from \"../../../Utils/LoggerByDefault\";\nimport AltiResponse from \"../Response/model/AltiResponse\";\nimport Elevation from \"../Response/model/Elevation\";\nimport Measure from \"../Response/model/Measure\";\n\n/**\n *\n * Objet AltiResponseReader\n *\n * @member {Object} AltiResponseReader\n *\n * @property {Object} AltiResponseReader.READERS - Objet contenant des fonctions de lecture, appelées \"readers\"\n *      dont chaque clé correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associée est une fonction (node, data)\n *      où node est un noeud du document DOM\n *      et data est un objet où l'on stocke les informations lues dans le XML.\n *\n * @property {Method} AltiResponseReader.READERS.elevations -  Lecture d'un noeud \"elevations\" de la réponse XML\n *      du service alti, correspondant logiquement à la racine du document\n *      (contient un ou plusieurs childNodes correspondant chacun à une élévation retournée)\n *\n * @property {Method} AltiResponseReader.READERS.elevation - Lecture d'un noeud \"elevation\" de la réponse xml du service alti.\n *      (contient un ou 4 childNode (s) correspondant à l'altitude (z) et éventuellement lat, lon, et acc)\n *\n * @property {Method} AltiResponseReader.READERS.lat - Lecture d'un noeud \"lat\" de la réponse xml du service alti.\n *      (contient une valeur de latitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.lon - Lecture d'un noeud \"lon\" de la réponse xml du service alti.\n *      (contient une valeur de longitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.z - Lecture d'un noeud \"z\" de la réponse xml du service alti.\n *      (contient une valeur d'altitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.acc - Lecture d'un noeud \"acc\" de la réponse xml du service alti.\n *      (contient une valeur de précision, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.measures - Lecture d'un noeud \"measures\" de la réponse xml du service alti.\n *      (contient une valeur de précision, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.source_name - Lecture d'un noeud \"source_name\" de la réponse xml du service alti.\n *      (pour remplir l'éventuel objet measure)\n *\n * @property {Method} AltiResponseReader.READERS.source_mesure - Lecture d'un noeud \"source_mesure\" de la réponse xml du service alti.\n *      (pour remplir l'éventuel objet measure)\n *\n * @property {Method} AltiResponseReader.READERS.exceptionreport - Lecture d'un noeud \"ExceptionReport\" de la réponse xml du service alti.\n *\n * @property {Method} AltiResponseReader.READERS.exception - Lecture d'un noeud \"Exception\" de la réponse xml du service alti.\n *\n * @property {Method} AltiResponseReader.read - Méthode permettant de lancer la lecture d'une réponse XML du service altimétrique,\n *      à l'aide des readers de la classe.\n *\n */\nvar AltiResponseReader = {};\n\nAltiResponseReader.READERS = {\n\n    /**\n     * Lecture d'un noeud \"elevations\" de la réponse XML du service alti, correspondant logiquement à la racine du document\n     *      (contient un ou plusieurs childNodes correspondant chacun à une élévation retournée)\n     *\n     * @param {DOMElement} root - racine de la réponse XML\n     * @static\n     * @memberof AltiResponseReader\n     * @returns {Object} Retourne un objet de type AltiResponse\n     */\n    elevations : function (root) {\n        // INFO : on passe en paramètre l'objet en entrée elevations, vide, à remplir.\n        var altiResponse = new AltiResponse();\n\n        if (root.hasChildNodes()) {\n            var children = root.childNodes;\n            var child;\n            var elevation;\n\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n\n                if (AltiResponseReader.READERS[child.nodeName]) {\n                    elevation = AltiResponseReader.READERS[child.nodeName](child);\n                    altiResponse.elevations.push(elevation);\n                }\n            }\n        }\n\n        return altiResponse;\n    },\n\n    /**\n     * Lecture d'un noeud \"elevation\" de la réponse xml du service alti.\n     *      (contient un ou 5 childNode (s) correspondant à l'altitude (z) et éventuellement lat, lon, acc et measures)\n     *\n     * @param {DOMElement} node - noeud elevation à lire pour récupérer les informations de l'élévation retournée (z [, lon, lat, acc, measures])\n     * @return {Array} elevationResponse - format de la réponse en sortie, instance de AltiResponse\n     * @static\n     * @memberof AltiResponseReader\n     */\n    elevation : function (node) {\n        var elevation = new Elevation();\n\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (AltiResponseReader.READERS[child.nodeName]) {\n                    // INFO : on passe en paramètre l'objet en entrée elevation, vide, à remplir.\n                    AltiResponseReader.READERS[child.nodeName](child, elevation);\n                }\n            }\n        }\n        return elevation;\n    },\n\n    /**\n     * Lecture d'un noeud \"lat\" de la réponse xml du service alti.\n     *      (contient une valeur de latitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la latitude\n     * @param {Object} elevation - objet dans lequel stocker la latitude retournée\n     * @static\n     * @memberof AltiResponseReader\n     */\n    lat : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            elevation.lat = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : latitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"lon\" de la réponse xml du service alti.\n     *      (contient une valeur de longitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la longitude\n     * @param {Object} elevation - objet dans lequel stocker la longitude retournée\n     * @static\n     * @memberof AltiResponseReader\n     */\n    lon : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            elevation.lon = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : longitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"z\" de la réponse xml du service alti.\n     *      (contient une valeur d'altitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer l'altitude\n     * @param {Object} elevationObject - objet dans lequel stocker l'altitude retournée : elevation ou measure\n     * @static\n     * @memberof AltiResponseReader\n     */\n    z : function (node, elevationObject) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            if (elevationObject) {\n                elevationObject.z = parseFloat(textNode.nodeValue);\n            } else {\n                elevationObject = new Elevation();\n                elevationObject.z = parseFloat(textNode.nodeValue);\n                return elevationObject;\n            }\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : altitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"acc\" de la réponse xml du service alti.\n     *      (contient une valeur de précision, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la précision\n     * @param {Object} elevationObject - objet dans lequel stocker la précision retournée : elevation ou measure\n     * @static\n     * @memberof AltiResponseReader\n     */\n    acc : function (node, elevationObject) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            elevationObject.acc = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : précision (acc) attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"source_name\" de la réponse xml du service alti.\n     *      (contient le nom de la source, qui est un string)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la précision\n     * @param {Object} measure - objet dans lequel stocker le nom de la source retourné\n     * @static\n     * @memberof AltiResponseReader\n     */\n    source_name : function (node, measure) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            measure.source_name = textNode.nodeValue;\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : source_name attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"source_measure\" de la réponse xml du service alti.\n     *      (contient le nom de la mesure, qui est un string)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la précision\n     * @param {Object} measure - objet dans lequel stocker le nom de la source retourné\n     * @static\n     * @memberof AltiResponseReader\n     */\n    source_measure : function (node, measure) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            measure.source_measure = textNode.nodeValue;\n        } else {\n            throw new Error(\"Erreur dans la lecture de la réponse du service : source_measure attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"measures\" et de ses enfants \"measure\" de la réponse xml du service alti.\n     *      (contient une valeur de précision, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer la précision\n     * @param {Object} elevation - objet dans lequel stocker la précision retournée\n     * @static\n     * @memberof AltiResponseReader\n     */\n    measures : function (node, elevation) {\n        elevation.measures = [];\n        var measure;\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var measureNode;\n            var measureChildren;\n            for (var i = 0; i < children.length; i++) {\n                measure = new Measure();\n                measureNode = children[i];\n                measureChildren = measureNode.childNodes;\n                for (var j = 0; j < measureChildren.length; j++) {\n                    if (AltiResponseReader.READERS[measureChildren[j].nodeName]) {\n                        // INFO : on passe en paramètre l'objet en entrée elevation, vide, à remplir.\n                        AltiResponseReader.READERS[measureChildren[j].nodeName](measureChildren[j], measure);\n                    } else {\n                        throw new Error(\"Erreur dans la lecture de la réponse du service : measures attendues mais absentes\");\n                    }\n                }\n                elevation.measures.push(measure);\n            }\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"ExceptionReport\" de la réponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer l'exception\n     * @return {Object} exceptionReport - objet contenant l'exception\n     * @static\n     * @memberof AltiResponseReader\n     */\n    exceptionreport : function (node) {\n        var response = {};\n\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"Exception\") {\n                    response.exceptionReport = AltiResponseReader.READERS.exception(child);\n                }\n            }\n        }\n\n        return response;\n    },\n\n    /**\n     * Lecture d'un noeud \"Exception\" de la réponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer l'exception\n     * @return {Object} exceptionReport - objet contenant l'exception, avec deux attributs :\n     *      {String} exceptionReport.exceptionCode - qui contient l'identifiant du code de l'exception\n     *      {String} exceptionReport.exception - qui contient le message de l'exception\n     * @static\n     * @memberof AltiResponseReader\n     */\n    exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute(\"exceptionCode\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    },\n\n    /**\n     * Lecture d'un noeud \"Error\" de la réponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud à lire pour récupérer l'exception\n     * @return {Object} error - objet contenant l'exception\n     * @static\n     */\n    error : function (node) {\n        var response = {\n            error : {}\n        };\n        // get error code and description\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                var textNode;\n                // get error code\n                if (child.nodeType === 1 && child.nodeName === \"code\") { // 1 === node.ELEMENT_NODE\n                    textNode = child.firstChild;\n                    if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n                        response.error.code = textNode.nodeValue;\n                    }\n                }\n                // get error description\n                if (child.nodeType === 1 && child.nodeName === \"description\") { // 1 === node.ELEMENT_NODE\n                    textNode = child.firstChild;\n                    if (textNode && textNode.nodeType === 3) { // 3 === node.TEXT_NODE\n                        response.error.description = textNode.nodeValue;\n                    }\n                }\n            }\n        }\n        return response;\n    }\n\n};\n\n/**\n * Méthode permettant de lancer la lecture d'une réponse XML du service altimétrique,\n *      à l'aide des readers de la classe.\n *\n * @method AltiResponseReader.read\n * @param {DOMElement} root - racine de la réponse XML à lire\n * @static\n * @memberof AltiResponseReader\n */\nAltiResponseReader.read = function (root) {\n    if (root.nodeName === \"elevations\") {\n        var altiResponse = AltiResponseReader.READERS.elevations(root);\n        return altiResponse;\n    } else if (root.nodeName === \"ExceptionReport\") {\n        var exceptionReport = AltiResponseReader.READERS.exceptionreport(root);\n        return exceptionReport;\n    } else if (root.nodeName === \"error\") {\n        var error = AltiResponseReader.READERS.error(root);\n        return error;\n    } else {\n        throw new Error(\"Erreur lors de la lecture de la réponse : elle n'est pas au format attendu.\");\n    }\n};\n\nexport default AltiResponseReader;\n","module.exports = ol.source.Vector;","import Logger from \"../../../Utils/LoggerByDefault\";\nimport MRes from \"../../../Utils/MessagesResources\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport RouteResponse from \"./model/RouteResponse\";\nimport RouteInstruction from \"./model/RouteInstruction\";\n\n/**\n * Factory pour générer une reponse JSON à partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module RouteResponseFactory\n * @alias Gp.Services.Route.Response.RouteResponseFactory\n * @private\n */\nvar RouteResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Route\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"RouteResponseFactory\");\n        logger.trace(\"RouteResponseFactory::build()\");\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                logger.trace(\"analyze response : json\");\n\n                var JSONResponse;\n                if (typeof options.response === \"string\") {\n                    JSONResponse = JSON.parse(options.response);\n                } else {\n                    JSONResponse = options.response;\n                }\n\n                // construction de l'objet réponse JSON\n                if (JSONResponse) {\n                    // le service renvoie t il une erreur ?\n                    if (JSONResponse.message) {\n                        // ex. {\"message\":\"message not null\", \"status\":\"ERROR\"}\n                        options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.message)));\n                        return;\n                    }\n                    var legs = [];\n                    var legSteps = [];\n                    var steps = [];\n\n                    data = new RouteResponse();\n\n                    if (data.hasOwnProperty(\"totalTime\")) {\n                        data.totalTime = parseFloat(JSONResponse.duration);\n                    }\n                    if (data.hasOwnProperty(\"totalDistance\")) {\n                        data.totalDistance = parseFloat(JSONResponse.distance);\n                    }\n\n                    if (data.hasOwnProperty(\"bbox\")) {\n                        data.bbox.left = parseFloat(JSONResponse.bbox[0]);\n                        data.bbox.bottom = parseFloat(JSONResponse.bbox[1]);\n                        data.bbox.right = parseFloat(JSONResponse.bbox[2]);\n                        data.bbox.top = parseFloat(JSONResponse.bbox[3]);\n                    }\n\n                    if (data.hasOwnProperty(\"routeGeometry\") && !options.geometryInInstructions) {\n                        data.routeGeometry = JSONResponse.geometry;\n                    }\n\n                    if (data.hasOwnProperty(\"routeInstructions\") && options.geometryInInstructions) {\n                        var legList = JSONResponse.portions;\n                        var i;\n                        if (Array.isArray(legList) && legList.length) {\n                            for (i = 0; i < legList.length; i++) {\n                                legs.push(legList[i]);\n                            }\n                        }\n                        if (legs.length) {\n                            for (i = 0; i < legs.length; i++) {\n                                legSteps.push(legs[i].steps);\n                            }\n                        }\n                        if (legSteps.length) {\n                            for (i = 0; i < legSteps.length; i++) {\n                                steps = steps.concat(legSteps[i]);\n                            }\n                        }\n\n                        steps.forEach(function (step) {\n                            data.routeInstructions.push(new RouteInstruction());\n                            data.routeInstructions[data.routeInstructions.length - 1].duration = step.duration;\n                            data.routeInstructions[data.routeInstructions.length - 1].distance = step.distance;\n                            data.routeInstructions[data.routeInstructions.length - 1].code = \"\";\n                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"\";\n                            data.routeInstructions[data.routeInstructions.length - 1].geometry = step.geometry;\n\n                            // on ne souhaite pas de ce type de valeur...\n                            if (step.name === \"Valeur non renseignée\") {\n                                step.name = \"\";\n                            }\n\n                            switch (step.instruction.type) {\n                                case \"turn\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Tourner\";\n                                    break;\n                                case \"new name\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Continuer tout droit\";\n                                    break;\n                                case \"depart\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Départ\";\n                                    break;\n                                case \"arrive\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Arrivée\";\n                                    break;\n                                case \"merge\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Rejoindre\";\n                                    break;\n                                case \"ramp\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Prendre la bretelle\";\n                                    break;\n                                case \"on ramp\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Prendre la bretelle\";\n                                    break;\n                                case \"off ramp\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Prendre la sortie\";\n                                    break;\n                                case \"fork\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Sur la bifurcation, prendre\";\n                                    break;\n                                case \"end of road\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"À la fin de la route, prendre\";\n                                    break;\n                                case \"use lane\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Utiliser la file\";\n                                    break;\n                                case \"continue\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Continuer\";\n                                    break;\n                                case \"roundabout\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Au rond-point\";\n                                    break;\n                                case \"rotary\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Au rond-point\";\n                                    break;\n                                case \"roundabout turn\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"Au rond point, tourner\";\n                                    break;\n                                case \"notification\":\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"\";\n                                    break;\n                                default:\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \"?\" + step.instruction.type + \"?\";\n                                    break;\n                            }\n\n                            if (step.instruction.modifier) {\n                                switch (step.instruction.modifier) {\n                                    case \"uturn\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Faire demi-tour\";\n                                        break;\n                                    case \"sharp right\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" complètement à droite\";\n                                        break;\n                                    case \"right\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" à droite\";\n                                        break;\n                                    case \"slight right\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" légèrement à droite\";\n                                        break;\n                                    case \"straight\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Continuer tout droit\";\n                                        break;\n                                    case \"slight left\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" lègèrement à gauche\";\n                                        break;\n                                    case \"left\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" à gauche\";\n                                        break;\n                                    case \"sharp left\":\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" complètement à gauche\";\n                                        break;\n                                    default:\n                                        data.routeInstructions[data.routeInstructions.length - 1].instruction += \" ?\" + step.instruction.modifier + \"?\";\n                                        break;\n                                }\n                            }\n\n                            if (step.instruction.exit) {\n                                data.routeInstructions[data.routeInstructions.length - 1].instruction += `${step.instruction.exit}e sortie`;\n                            }\n\n                            if (step.attributes.name) {\n                                if (step.attributes.name.nom_1_droite || step.attributes.name.toponyme) {\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += \" sur\";\n                                }\n\n                                if (step.attributes.name.nom_1_droite) {\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += ` ${step.attributes.name.nom_1_droite}`;\n                                }\n\n                                if (step.attributes.name.toponyme) {\n                                    data.routeInstructions[data.routeInstructions.length - 1].instruction += ` ${step.attributes.name.toponyme}`;\n                                }\n                            }\n                        });\n                    }\n                }\n\n                if (!data) {\n                    options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_ANALYSE\", \"json\")));\n                    return;\n                }\n\n                // Si la réponse contenait une exception renvoyée par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION_2\")));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n    }\n};\n\nexport default RouteResponseFactory;\n","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\n\n/**\n * @classdesc\n * Classe de gestion des param. des requêtes du service de calcul d'itineraire (REST).\n *      Permet le mapping avec les options du service.\n * @constructor\n * @alias Gp.Services.Route.Request.RouteParamREST\n * @param {Object} options - options\n *\n * @private\n */\nfunction GeocodeParamREST (options) {\n    if (!(this instanceof GeocodeParamREST)) {\n        throw new TypeError(\"GeocodeParamREST constructor cannot be called as a function.\");\n    }\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur GeocodeParamREST ()]\");\n\n    /**\n     * Options en paramêtres du constructeur.\n     */\n    this.options = options || {};\n\n    // methode de geocodage\n    if (!this.options.geocodeMethod || (this.options.geocodeMethod !== \"search\" && this.options.geocodeMethod !== \"reverse\")) {\n        throw new Error(\"Error geocodeMethod not valid\");\n    }\n    this.geocodeMethod = this.options.geocodeMethod;\n\n    // mapping des options avec l'API REST\n    this.query = (typeof this.options !== \"undefined\") ? this.options.query : null;\n\n    this.searchGeometry = this.options.searchGeometry || null;\n\n    this.index = this.options.index || null;\n\n    this.lon = this.options.position && this.options.position.lon ? this.options.position.lon : null;\n\n    this.lat = this.options.position && this.options.position.lat ? this.options.position.lat : null;\n\n    this.maxResp = this.options.maxResp || null;\n\n    this.returnTrueGeometry = this.options.returnTrueGeometry || null;\n\n    this.filters = this.options.filters || {};\n}\n\n/**\n * CLASSNAME\n */\nGeocodeParamREST.CLASSNAME = \"GeocodeParamREST\";\n\nGeocodeParamREST.prototype = {\n\n    /**\n     * @lends module:GeocodeParamREST#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : GeocodeParamREST,\n\n    /**\n     * Retourne les filtres\n     * @returns {String} les filtres\n     */\n    getFilters : function () {\n        var filters = {};\n        for (var prop in this.filters) {\n            if (this.filters.hasOwnProperty(prop)) {\n                filters[prop] = this.filters[prop];\n            }\n        }\n        return filters;\n    },\n\n    /**\n     * Retourne l'index\n     * @returns {String} l'index\n     */\n    getIndex : function () {\n        if (this.index === undefined) {\n            return null;\n        }\n        if (this.index === \"StreetAddress\") {\n            return \"address\";\n        } else if (this.index === \"CadastralParcel\") {\n            return \"parcel\";\n        } else if (this.index === \"PositionOfInterest\") {\n            return \"poi\";\n        } else if (this.index === \"location\") {\n            return \"location\";\n        }\n        return this.index;\n    },\n\n    /**\n     * Retourne la géométrie de recherche\n     * @returns {String} la géométrie de recherche au format json\n     */\n    getSearchGeometry : function () {\n        return JSON.stringify(this.searchGeometry);\n    }\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Array} liste de paramêtres\n */\nGeocodeParamREST.prototype.getParams = function () {\n    var map = [];\n\n    if (this.geocodeMethod === \"search\") {\n        map.push({\n            k : \"q\",\n            v : this.query\n        });\n    }\n\n    if (this.index) {\n        map.push({\n            k : \"index\",\n            v : this.getIndex()\n        });\n    }\n\n    if (this.geocodeMethod === \"reverse\" && this.searchGeometry) {\n        map.push({\n            k : \"searchgeom\",\n            v : this.getSearchGeometry()\n        });\n    }\n\n    if (this.lon && this.lat) {\n        map.push({\n            k : \"lon\",\n            v : this.lon\n        });\n        map.push({\n            k : \"lat\",\n            v : this.lat\n        });\n    }\n\n    if (this.maxResp) {\n        map.push({\n            k : \"limit\",\n            v : this.maxResp\n        });\n    }\n\n    if (this.returnTrueGeometry) {\n        map.push({\n            k : \"returntruegeometry\",\n            v : this.returnTrueGeometry\n        });\n    }\n\n    const filters = this.getFilters();\n    for (var key in filters) {\n        map.push({\n            k : key,\n            v : filters[key]\n        });\n    }\n\n    return map;\n};\n\nexport default GeocodeParamREST;\n","/**\n * @module ColorUtils\n * @alias module:~utils/ColorUtils\n * @description\n * ...\n *\n * @example\n * import ColorUtils from \"gpf-ext-ol/utils/ColorUtils\"\n * ou \n * import {ColorUtils} from \"gpf-ext-ol\n * \n * ColorUtils.hex();\n * ColorUtils.num();\n * ColorUtils.arrayTorgba();\n * ColorUtils.arrayToHex();\n * ColorUtils.rgbaToHex();\n * ColorUtils.hexToRgba();\n * ColorUtils.isHex();\n * ColorUtils.isRGB();\n */\nvar ColorUtils = {\n\n    /**\n     * Number to hex conversion\n     *\n     * @param {Number} number - 0-255\n     * @returns {String} hex value\n     */\n    hex : function (number) {\n        if (number > 255) {\n            throw new Error(\"'\" + number + \"'' is greater than 255(0xff);\");\n        }\n        var str = Number(number).toString(16);\n        return (\"0\" + str).slice(-2);\n    },\n\n    /**\n     * Hexa to number conversion\n     *\n     * @param {*} hexa 00-FF\n     * @returns {Number} number value\n     */\n    num : function (hexa) {\n        return parseInt(hexa, 16);\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to rgba string\n     *\n     * @function arrayToRgba\n     * @param {Array} values - array of values\n     * @returns {String} A color of RGB or RGBA format\n     */\n    arrayToRgba : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3] || 1;\n        var result = \"rgba(\" + red + \", \" + green + \", \" + blue + \", \" + parseFloat(alpha) + \")\";\n        return result;\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to #RRGGBBAA\n     *\n     * @function arrayToHex\n     * @param {Array} values - array of values\n     * @returns {Object}  hex and opacity formated values\n     */\n    arrayToHex : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts rgba string to #RRGGBBAA\n     * (Code adapted from : https://gist.github.com/mstssk/afda4ce9e5c335fd79cd)\n     *\n     * @function rgbaToHex\n     * @param {String} rgba - A color of RGB or RGBA format.\n     * @returns {Object} hex and opacity formated values\n     */\n    rgbaToHex : function (rgba) {\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(rgba);\n        if (!parsed) {\n            throw new Error(\"Invalid format: \" + rgba);\n        }\n        var red = parsed[1];\n        var green = parsed[2];\n        var blue = parsed[3];\n        var alpha = parsed[4];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts hex color and opacity value to rgba string.\n     * (Code adapted from : http://stackoverflow.com/a/5624139)\n     *\n     * @function hexToRgba\n     * @param {String} hex - A color value on RGB format (hexa).\n     * @param {Number} opacity - A opacity value.\n     * @returns {String} A color of RGB or RGBA format\n     */\n    hexToRgba : function (hex, opacity) {\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        if (!hex) {\n            throw new Error(\"Invalid format\");\n        }\n        hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        rgb = rgb ? {\n            r : parseInt(rgb[1], 16),\n            g : parseInt(rgb[2], 16),\n            b : parseInt(rgb[3], 16)\n        } : null;\n        var result = rgb ? \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + opacity + \")\" : null;\n        return result;\n    },\n\n    /**\n     * Determine if value is a correct hexa color.\n     * @param {*} value - hex color (#FFFFFF)\n     * @returns {Boolean} True if value is a hexa color\n     */\n    isHex : function (value) {\n        if (!value) {\n            return false;\n        }\n        if (value.charAt(0) !== \"#\") {\n            return false;\n        }\n        var regex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Determine if value is a correct rgba color.\n     * @param {*} value - rgba color (rgba(125,125,125,1))\n     * @returns {Boolean} True if value is a rgba color\n     */\n    isRGB : function (value) {\n        if (!value) {\n            return false;\n        }\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    }\n};\n\nexport default ColorUtils;\n","\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport _ from \"../../../Utils/MessagesResources\";\nimport GeocodeParamREST from \"./model/GeocodeParamREST\";\n\n/**\n * @classdesc\n * Classe de gestion des requêtes de type REST sur le service de calcul d'itineraire\n * (uniquement en GET)\n *\n * @constructor\n * @alias Gp.Services.Geocode.Request.GeocodeRequestREST\n * @param {Object} options - options definies dans le composant Route\n *\n * @example\n * var options = {\n *      (...)\n * };\n *\n * @private\n */\nfunction GeocodeRequestREST (options) {\n    this.logger = Logger.getLogger(\"GeocodeRequestREST\");\n    this.logger.trace(\"[Constructeur GeocodeRequestREST ()]\");\n\n    if (!(this instanceof GeocodeRequestREST)) {\n        throw new TypeError(\"GeocodeRequestREST constructor cannot be called as a function.\");\n    }\n\n    // existance des options\n    if (!options) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    /** liste des options */\n    this.settings = options;\n}\n\nGeocodeRequestREST.prototype = {\n\n    /**\n     * @lends module:GeocodeRequestREST#\n     */\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : GeocodeRequestREST,\n\n    /**\n     * Construction de la requête.\n     *\n     * @returns {String} request\n     */\n    processRequestString : function () {\n        var request = \"\";\n\n        // Mapping des options avec le service de l'API REST\n        const oParams = new GeocodeParamREST(this.settings);\n\n        const params = oParams.getParams();\n        for (var i = 0; i < params.length; i++) {\n            var o = params[i];\n            if (request) {\n                request += \"&\";\n            }\n            request += o.k + \"=\" + o.v;\n        }\n\n        if (!this.settings.geocodeMethod || (this.settings.geocodeMethod !== \"search\" && this.settings.geocodeMethod !== \"reverse\")) {\n            throw new Error(\"Error geocodeMethod not valid\");\n        }\n\n        this.requestString = \"?\" + request;\n        this.logger.trace(this.requestString);\n\n        return this.requestString;\n    }\n};\n\nexport default GeocodeRequestREST;\n","/**\n* @module MathUtils\n* @alias module:~utils/MathUtils\n* @description\n* ...\n*\n* @example\n* modulo();\n* decimalToDMS();\n* coordinateTo();\n* toInteger();\n* isInteger();\n* toFloat();\n*/\nvar MathUtils = {\n    /**\n     * Reste de la division euclidienne\n     * \n     * @function modulo\n     * @param {Number} a - divisor\n     * @param {Number} b - quotient\n     * @returns {Number} Modulo\n     */\n    modulo : function (a, b) {\n        var r = a % b;\n        return r * b < 0 ? r + b : r;\n    },\n\n    /**\n     * Transform degrees, minutes, seconds form decimal degrees -\n     * Largely inspired by the private function degreesToStringHDMS from ol/coordinate.js\n     *\n     * @function decimalToDMS\n     * @param {Number} degrees - decimal degrees\n     * @param {Array} hemispheres - \"NS\" ou \"EO\"\n     * @param {Number} numDigits - number of digits for seconds\n     * @returns {Object} DMS coordinate\n     */\n    decimalToDMS : function (degrees, hemispheres, numDigits) {\n        var normalizedDegrees = this.modulo(degrees + 180, 360) - 180;\n        var x = Math.abs(3600 * normalizedDegrees);\n        var dflPrecision = numDigits || 0;\n        var precision = Math.pow(10, dflPrecision);\n\n        var deg = Math.floor(x / 3600);\n        var min = Math.floor((x - deg * 3600) / 60);\n        var sec = x - (deg * 3600) - (min * 60);\n        sec = Math.ceil(sec * precision) / precision;\n\n        if (sec >= 60) {\n            sec = 0;\n            min += 1;\n        }\n\n        if (min >= 60) {\n            min = 0;\n            deg += 1;\n        }\n\n        var direction = hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0);\n        return {\n            d : deg,\n            m : min,\n            s : sec,\n            direction : direction\n        };\n    },\n\n    /**\n     * Transform decimal degrees form degrees, minutes, seconds\n     * \n     * @function dmsToDecimal\n     * @param {*} degrees - degrees\n     * @param {*} minutes - minutes\n     * @param {*} seconds - seconds\n     * @param {*} hemispheres - \"NS\" ou \"EO\"\n     * @returns {Number} decimal coordinate\n     */\n    dmsToDecimal (degrees, minutes, seconds, hemispheres) {\n        var dd = degrees + minutes/60 + seconds/(60*60);\n    \n        if (hemispheres == \"S\" || hemispheres == \"O\") {\n            dd = dd * -1;\n        }\n        return dd;\n    },\n    /**\n     * ol coordinate to decimal\n     * \n     * @function coordinateToDecimal\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {lat, lng, unit:°}\n     */\n    coordinateToDecimal (olCoordinate) {\n        var coordinate = {};\n        coordinate.lat = olCoordinate[1].toFixed(6);\n        coordinate.lng = olCoordinate[0].toFixed(6);\n        coordinate.unit = \"°\";\n        return coordinate;\n    },\n\n    /**\n     * ol coordinate to dms\n     * \n     * @function coordinateToDMS\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {lat, lng, unit:dms}\n     */\n    coordinateToDMS (olCoordinate) {\n        return {\n            lng : MathUtils.decimalToDMS(olCoordinate[0], \"EO\", 2),\n            lat : MathUtils.decimalToDMS(olCoordinate[1], \"NS\", 2),\n            unit : \"DMS\"\n        };\n    },\n\n    /**\n     * ol coordinate to rad\n     * \n     * @function coordinateToRad\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {lat, lng, unit:rad}\n     */\n    coordinateToRad (olCoordinate) {\n        var coordinate = {};\n        var d = 0.01745329251994329577;\n        coordinate.lng = olCoordinate[0] * d;\n        coordinate.lng = coordinate.lng.toFixed(8);\n        coordinate.lat = olCoordinate[1] * d;\n        coordinate.lat = coordinate.lat.toFixed(8);\n        coordinate.unit = \"rad\";\n        return coordinate;\n    },\n\n    /**\n     * ol coordinate to gon\n     * \n     * @function coordinateToGon\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {lat, lng, unit:gon}\n     */\n    coordinateToGon (olCoordinate) {\n        var coordinate = {};\n        var d = 1.11111111111111111111;\n        coordinate.lng = olCoordinate[0] * d;\n        coordinate.lng = coordinate.lng.toFixed(8);\n        coordinate.lat = olCoordinate[1] * d;\n        coordinate.lat = coordinate.lat.toFixed(8);\n        coordinate.unit = \"gon\";\n        return coordinate;\n    },\n\n    /**\n     * ol coordinate to meter\n     * \n     * @function coordinateToMeter\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {x, y, unit:m}\n     */\n    coordinateToMeter (olCoordinate) {\n        // on recoit toujours des coordonnées metriques\n        var coordinate = {};\n        coordinate.x = olCoordinate[0].toFixed(2);\n        coordinate.y = olCoordinate[1].toFixed(2);\n        coordinate.unit = \"m\";\n        return coordinate;\n    },\n\n    /**\n     * ol coordinate to kilometer\n     * \n     * @function coordinateToKMeter\n     * @param {*} olCoordinate - see ol/coordinate.js\n     * @returns {Object} - {x, lyng, unit:km}\n     */\n    coordinateToKMeter (olCoordinate) {\n        // on recoit toujours des coordonnées metriques\n        var coordinate = {};\n        coordinate.x = (olCoordinate[0] / 1000).toFixed(2);\n        coordinate.y = (olCoordinate[1] / 1000).toFixed(2);\n        coordinate.unit = \"km\";\n        return coordinate;\n    },\n\n    /**\n     * Converts string to Integer\n     *\n     * @function toInteger\n     * @param {String} s - string number\n     * @param {Numeric} base - between 2 and 36\n     * @returns {null|Numeric} result\n     */\n    toInteger : function (s, base) {\n        var _base = base || 10;\n        var n = parseInt(s, _base);\n        if (!isNaN(n) && isFinite(n)) {\n            return n;\n        }\n        return null;\n    },\n\n    /**\n     * check if s represents an integer\n     *\n     * @function isInteger\n     * @param {String} s - string number\n     * @returns {Boolean} is integer\n     */\n    isInteger : function (s) {\n        if (isNaN(s)) {\n            return false;\n        }\n\n        var v = parseFloat(s);\n        return ((v | 0) === v);\n    },\n\n    /**\n     * Converts s to float\n     *\n     * @function toFloat\n     * @param {String} s - string number\n     * @returns {null|Numeric} result\n     */\n    toFloat : function (s) {\n        var n = parseFloat(s);\n        if (!isNaN(n) && isFinite(n)) {\n            return n;\n        }\n        return null;\n    },\n\n    /**\n     * convert seconds to time : HH:MM:SS\n     *\n     * @param {Number} duration - duration in seconds\n     *\n     * @returns {String} time in hours/minutes/seconds\n     */\n    convertSecondsToTime : function (duration) {\n        var time = \"\";\n\n        duration = Math.round(duration);\n        var hours = Math.floor(duration / (60 * 60));\n\n        var divisor4minutes = duration % (60 * 60);\n        var minutes = Math.floor(divisor4minutes / 60);\n\n        if (hours) {\n            time = hours + \"h \";\n        }\n        time += minutes + \" min\";\n        return time;\n    },\n\n    /**\n     * convert distance in meters or kilometers\n     *\n     * @param {Number} distance - distance in meters\n     *\n     * @returns {String} distance in km\n     */\n    convertDistance : function (distance) {\n        var d = \"\";\n\n        var distanceKm = parseInt(distance / 1000, 10);\n        if (!distanceKm) {\n            d = parseInt(distance, 10) + \" m\"; // arrondi !\n        } else {\n            d = distanceKm + \" km\";\n        }\n\n        return d;\n    }\n};\n\nexport default MathUtils;\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.source.ImageWMS;","/**\n * @module Config\n * @alias module:~utils/Config\n * @private\n * @description\n * ...\n *\n * @example\n * isConfigLoaded();\n */\nvar Config = {\n\n    /**\n     * Config\n     *\n     * @public\n     * @type {Object}\n     */\n    configuration : {},\n\n    /**\n     * Check if the configuration is loaded\n     *\n     * @returns {Boolean} True if Config is loaded, false otherwise\n     */\n    isConfigLoaded : function () {\n        // config already loaded !\n        if (this.configuration && Object.keys(this.configuration).length !== 0) {\n            return true;\n        }\n        var scope = typeof window !== \"undefined\" ? window : typeof self !== \"undefined\" ? self : typeof global !== \"undefined\" ? global : {};\n        if (scope.Gp && scope.Gp.Config && scope.Gp.Config.layers && Object.keys(scope.Gp.Config.layers).length !== 0) {\n            /** ts-syntax */ (this.configuration) = scope.Gp.Config;\n            return true;\n        }\n        return false;\n    }\n\n};\n\nexport default Config;\n","/**!\n * Sortable 1.15.3\n * @author\tRubaXa   <trash@rubaxa.org>\n * @author\towenm    <owen23355@gmail.com>\n * @license MIT\n */\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar version = \"1.15.3\";\n\nfunction userAgent(pattern) {\n  if (typeof window !== 'undefined' && window.navigator) {\n    return !! /*@__PURE__*/navigator.userAgent.match(pattern);\n  }\n}\nvar IE11OrLess = userAgent(/(?:Trident.*rv[ :]?11\\.|msie|iemobile|Windows Phone)/i);\nvar Edge = userAgent(/Edge/i);\nvar FireFox = userAgent(/firefox/i);\nvar Safari = userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);\nvar IOS = userAgent(/iP(ad|od|hone)/i);\nvar ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);\n\nvar captureMode = {\n  capture: false,\n  passive: false\n};\nfunction on(el, event, fn) {\n  el.addEventListener(event, fn, !IE11OrLess && captureMode);\n}\nfunction off(el, event, fn) {\n  el.removeEventListener(event, fn, !IE11OrLess && captureMode);\n}\nfunction matches( /**HTMLElement*/el, /**String*/selector) {\n  if (!selector) return;\n  selector[0] === '>' && (selector = selector.substring(1));\n  if (el) {\n    try {\n      if (el.matches) {\n        return el.matches(selector);\n      } else if (el.msMatchesSelector) {\n        return el.msMatchesSelector(selector);\n      } else if (el.webkitMatchesSelector) {\n        return el.webkitMatchesSelector(selector);\n      }\n    } catch (_) {\n      return false;\n    }\n  }\n  return false;\n}\nfunction getParentOrHost(el) {\n  return el.host && el !== document && el.host.nodeType ? el.host : el.parentNode;\n}\nfunction closest( /**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx, includeCTX) {\n  if (el) {\n    ctx = ctx || document;\n    do {\n      if (selector != null && (selector[0] === '>' ? el.parentNode === ctx && matches(el, selector) : matches(el, selector)) || includeCTX && el === ctx) {\n        return el;\n      }\n      if (el === ctx) break;\n      /* jshint boss:true */\n    } while (el = getParentOrHost(el));\n  }\n  return null;\n}\nvar R_SPACE = /\\s+/g;\nfunction toggleClass(el, name, state) {\n  if (el && name) {\n    if (el.classList) {\n      el.classList[state ? 'add' : 'remove'](name);\n    } else {\n      var className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n      el.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n    }\n  }\n}\nfunction css(el, prop, val) {\n  var style = el && el.style;\n  if (style) {\n    if (val === void 0) {\n      if (document.defaultView && document.defaultView.getComputedStyle) {\n        val = document.defaultView.getComputedStyle(el, '');\n      } else if (el.currentStyle) {\n        val = el.currentStyle;\n      }\n      return prop === void 0 ? val : val[prop];\n    } else {\n      if (!(prop in style) && prop.indexOf('webkit') === -1) {\n        prop = '-webkit-' + prop;\n      }\n      style[prop] = val + (typeof val === 'string' ? '' : 'px');\n    }\n  }\n}\nfunction matrix(el, selfOnly) {\n  var appliedTransforms = '';\n  if (typeof el === 'string') {\n    appliedTransforms = el;\n  } else {\n    do {\n      var transform = css(el, 'transform');\n      if (transform && transform !== 'none') {\n        appliedTransforms = transform + ' ' + appliedTransforms;\n      }\n      /* jshint boss:true */\n    } while (!selfOnly && (el = el.parentNode));\n  }\n  var matrixFn = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;\n  /*jshint -W056 */\n  return matrixFn && new matrixFn(appliedTransforms);\n}\nfunction find(ctx, tagName, iterator) {\n  if (ctx) {\n    var list = ctx.getElementsByTagName(tagName),\n      i = 0,\n      n = list.length;\n    if (iterator) {\n      for (; i < n; i++) {\n        iterator(list[i], i);\n      }\n    }\n    return list;\n  }\n  return [];\n}\nfunction getWindowScrollingElement() {\n  var scrollingElement = document.scrollingElement;\n  if (scrollingElement) {\n    return scrollingElement;\n  } else {\n    return document.documentElement;\n  }\n}\n\n/**\r\n * Returns the \"bounding client rect\" of given element\r\n * @param  {HTMLElement} el                       The element whose boundingClientRect is wanted\r\n * @param  {[Boolean]} relativeToContainingBlock  Whether the rect should be relative to the containing block of (including) the container\r\n * @param  {[Boolean]} relativeToNonStaticParent  Whether the rect should be relative to the relative parent of (including) the contaienr\r\n * @param  {[Boolean]} undoScale                  Whether the container's scale() should be undone\r\n * @param  {[HTMLElement]} container              The parent the element will be placed in\r\n * @return {Object}                               The boundingClientRect of el, with specified adjustments\r\n */\nfunction getRect(el, relativeToContainingBlock, relativeToNonStaticParent, undoScale, container) {\n  if (!el.getBoundingClientRect && el !== window) return;\n  var elRect, top, left, bottom, right, height, width;\n  if (el !== window && el.parentNode && el !== getWindowScrollingElement()) {\n    elRect = el.getBoundingClientRect();\n    top = elRect.top;\n    left = elRect.left;\n    bottom = elRect.bottom;\n    right = elRect.right;\n    height = elRect.height;\n    width = elRect.width;\n  } else {\n    top = 0;\n    left = 0;\n    bottom = window.innerHeight;\n    right = window.innerWidth;\n    height = window.innerHeight;\n    width = window.innerWidth;\n  }\n  if ((relativeToContainingBlock || relativeToNonStaticParent) && el !== window) {\n    // Adjust for translate()\n    container = container || el.parentNode;\n\n    // solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)\n    // Not needed on <= IE11\n    if (!IE11OrLess) {\n      do {\n        if (container && container.getBoundingClientRect && (css(container, 'transform') !== 'none' || relativeToNonStaticParent && css(container, 'position') !== 'static')) {\n          var containerRect = container.getBoundingClientRect();\n\n          // Set relative to edges of padding box of container\n          top -= containerRect.top + parseInt(css(container, 'border-top-width'));\n          left -= containerRect.left + parseInt(css(container, 'border-left-width'));\n          bottom = top + elRect.height;\n          right = left + elRect.width;\n          break;\n        }\n        /* jshint boss:true */\n      } while (container = container.parentNode);\n    }\n  }\n  if (undoScale && el !== window) {\n    // Adjust for scale()\n    var elMatrix = matrix(container || el),\n      scaleX = elMatrix && elMatrix.a,\n      scaleY = elMatrix && elMatrix.d;\n    if (elMatrix) {\n      top /= scaleY;\n      left /= scaleX;\n      width /= scaleX;\n      height /= scaleY;\n      bottom = top + height;\n      right = left + width;\n    }\n  }\n  return {\n    top: top,\n    left: left,\n    bottom: bottom,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\n/**\r\n * Checks if a side of an element is scrolled past a side of its parents\r\n * @param  {HTMLElement}  el           The element who's side being scrolled out of view is in question\r\n * @param  {String}       elSide       Side of the element in question ('top', 'left', 'right', 'bottom')\r\n * @param  {String}       parentSide   Side of the parent in question ('top', 'left', 'right', 'bottom')\r\n * @return {HTMLElement}               The parent scroll element that the el's side is scrolled past, or null if there is no such element\r\n */\nfunction isScrolledPast(el, elSide, parentSide) {\n  var parent = getParentAutoScrollElement(el, true),\n    elSideVal = getRect(el)[elSide];\n\n  /* jshint boss:true */\n  while (parent) {\n    var parentSideVal = getRect(parent)[parentSide],\n      visible = void 0;\n    if (parentSide === 'top' || parentSide === 'left') {\n      visible = elSideVal >= parentSideVal;\n    } else {\n      visible = elSideVal <= parentSideVal;\n    }\n    if (!visible) return parent;\n    if (parent === getWindowScrollingElement()) break;\n    parent = getParentAutoScrollElement(parent, false);\n  }\n  return false;\n}\n\n/**\r\n * Gets nth child of el, ignoring hidden children, sortable's elements (does not ignore clone if it's visible)\r\n * and non-draggable elements\r\n * @param  {HTMLElement} el       The parent element\r\n * @param  {Number} childNum      The index of the child\r\n * @param  {Object} options       Parent Sortable's options\r\n * @return {HTMLElement}          The child at index childNum, or null if not found\r\n */\nfunction getChild(el, childNum, options, includeDragEl) {\n  var currentChild = 0,\n    i = 0,\n    children = el.children;\n  while (i < children.length) {\n    if (children[i].style.display !== 'none' && children[i] !== Sortable.ghost && (includeDragEl || children[i] !== Sortable.dragged) && closest(children[i], options.draggable, el, false)) {\n      if (currentChild === childNum) {\n        return children[i];\n      }\n      currentChild++;\n    }\n    i++;\n  }\n  return null;\n}\n\n/**\r\n * Gets the last child in the el, ignoring ghostEl or invisible elements (clones)\r\n * @param  {HTMLElement} el       Parent element\r\n * @param  {selector} selector    Any other elements that should be ignored\r\n * @return {HTMLElement}          The last child, ignoring ghostEl\r\n */\nfunction lastChild(el, selector) {\n  var last = el.lastElementChild;\n  while (last && (last === Sortable.ghost || css(last, 'display') === 'none' || selector && !matches(last, selector))) {\n    last = last.previousElementSibling;\n  }\n  return last || null;\n}\n\n/**\r\n * Returns the index of an element within its parent for a selected set of\r\n * elements\r\n * @param  {HTMLElement} el\r\n * @param  {selector} selector\r\n * @return {number}\r\n */\nfunction index(el, selector) {\n  var index = 0;\n  if (!el || !el.parentNode) {\n    return -1;\n  }\n\n  /* jshint boss:true */\n  while (el = el.previousElementSibling) {\n    if (el.nodeName.toUpperCase() !== 'TEMPLATE' && el !== Sortable.clone && (!selector || matches(el, selector))) {\n      index++;\n    }\n  }\n  return index;\n}\n\n/**\r\n * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.\r\n * The value is returned in real pixels.\r\n * @param  {HTMLElement} el\r\n * @return {Array}             Offsets in the format of [left, top]\r\n */\nfunction getRelativeScrollOffset(el) {\n  var offsetLeft = 0,\n    offsetTop = 0,\n    winScroller = getWindowScrollingElement();\n  if (el) {\n    do {\n      var elMatrix = matrix(el),\n        scaleX = elMatrix.a,\n        scaleY = elMatrix.d;\n      offsetLeft += el.scrollLeft * scaleX;\n      offsetTop += el.scrollTop * scaleY;\n    } while (el !== winScroller && (el = el.parentNode));\n  }\n  return [offsetLeft, offsetTop];\n}\n\n/**\r\n * Returns the index of the object within the given array\r\n * @param  {Array} arr   Array that may or may not hold the object\r\n * @param  {Object} obj  An object that has a key-value pair unique to and identical to a key-value pair in the object you want to find\r\n * @return {Number}      The index of the object in the array, or -1\r\n */\nfunction indexOfObject(arr, obj) {\n  for (var i in arr) {\n    if (!arr.hasOwnProperty(i)) continue;\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key) && obj[key] === arr[i][key]) return Number(i);\n    }\n  }\n  return -1;\n}\nfunction getParentAutoScrollElement(el, includeSelf) {\n  // skip to window\n  if (!el || !el.getBoundingClientRect) return getWindowScrollingElement();\n  var elem = el;\n  var gotSelf = false;\n  do {\n    // we don't need to get elem css if it isn't even overflowing in the first place (performance)\n    if (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\n      var elemCSS = css(elem);\n      if (elem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') || elem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')) {\n        if (!elem.getBoundingClientRect || elem === document.body) return getWindowScrollingElement();\n        if (gotSelf || includeSelf) return elem;\n        gotSelf = true;\n      }\n    }\n    /* jshint boss:true */\n  } while (elem = elem.parentNode);\n  return getWindowScrollingElement();\n}\nfunction extend(dst, src) {\n  if (dst && src) {\n    for (var key in src) {\n      if (src.hasOwnProperty(key)) {\n        dst[key] = src[key];\n      }\n    }\n  }\n  return dst;\n}\nfunction isRectEqual(rect1, rect2) {\n  return Math.round(rect1.top) === Math.round(rect2.top) && Math.round(rect1.left) === Math.round(rect2.left) && Math.round(rect1.height) === Math.round(rect2.height) && Math.round(rect1.width) === Math.round(rect2.width);\n}\nvar _throttleTimeout;\nfunction throttle(callback, ms) {\n  return function () {\n    if (!_throttleTimeout) {\n      var args = arguments,\n        _this = this;\n      if (args.length === 1) {\n        callback.call(_this, args[0]);\n      } else {\n        callback.apply(_this, args);\n      }\n      _throttleTimeout = setTimeout(function () {\n        _throttleTimeout = void 0;\n      }, ms);\n    }\n  };\n}\nfunction cancelThrottle() {\n  clearTimeout(_throttleTimeout);\n  _throttleTimeout = void 0;\n}\nfunction scrollBy(el, x, y) {\n  el.scrollLeft += x;\n  el.scrollTop += y;\n}\nfunction clone(el) {\n  var Polymer = window.Polymer;\n  var $ = window.jQuery || window.Zepto;\n  if (Polymer && Polymer.dom) {\n    return Polymer.dom(el).cloneNode(true);\n  } else if ($) {\n    return $(el).clone(true)[0];\n  } else {\n    return el.cloneNode(true);\n  }\n}\nfunction setRect(el, rect) {\n  css(el, 'position', 'absolute');\n  css(el, 'top', rect.top);\n  css(el, 'left', rect.left);\n  css(el, 'width', rect.width);\n  css(el, 'height', rect.height);\n}\nfunction unsetRect(el) {\n  css(el, 'position', '');\n  css(el, 'top', '');\n  css(el, 'left', '');\n  css(el, 'width', '');\n  css(el, 'height', '');\n}\nfunction getChildContainingRectFromElement(container, options, ghostEl) {\n  var rect = {};\n  Array.from(container.children).forEach(function (child) {\n    var _rect$left, _rect$top, _rect$right, _rect$bottom;\n    if (!closest(child, options.draggable, container, false) || child.animated || child === ghostEl) return;\n    var childRect = getRect(child);\n    rect.left = Math.min((_rect$left = rect.left) !== null && _rect$left !== void 0 ? _rect$left : Infinity, childRect.left);\n    rect.top = Math.min((_rect$top = rect.top) !== null && _rect$top !== void 0 ? _rect$top : Infinity, childRect.top);\n    rect.right = Math.max((_rect$right = rect.right) !== null && _rect$right !== void 0 ? _rect$right : -Infinity, childRect.right);\n    rect.bottom = Math.max((_rect$bottom = rect.bottom) !== null && _rect$bottom !== void 0 ? _rect$bottom : -Infinity, childRect.bottom);\n  });\n  rect.width = rect.right - rect.left;\n  rect.height = rect.bottom - rect.top;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\nvar expando = 'Sortable' + new Date().getTime();\n\nfunction AnimationStateManager() {\n  var animationStates = [],\n    animationCallbackId;\n  return {\n    captureAnimationState: function captureAnimationState() {\n      animationStates = [];\n      if (!this.options.animation) return;\n      var children = [].slice.call(this.el.children);\n      children.forEach(function (child) {\n        if (css(child, 'display') === 'none' || child === Sortable.ghost) return;\n        animationStates.push({\n          target: child,\n          rect: getRect(child)\n        });\n        var fromRect = _objectSpread2({}, animationStates[animationStates.length - 1].rect);\n\n        // If animating: compensate for current animation\n        if (child.thisAnimationDuration) {\n          var childMatrix = matrix(child, true);\n          if (childMatrix) {\n            fromRect.top -= childMatrix.f;\n            fromRect.left -= childMatrix.e;\n          }\n        }\n        child.fromRect = fromRect;\n      });\n    },\n    addAnimationState: function addAnimationState(state) {\n      animationStates.push(state);\n    },\n    removeAnimationState: function removeAnimationState(target) {\n      animationStates.splice(indexOfObject(animationStates, {\n        target: target\n      }), 1);\n    },\n    animateAll: function animateAll(callback) {\n      var _this = this;\n      if (!this.options.animation) {\n        clearTimeout(animationCallbackId);\n        if (typeof callback === 'function') callback();\n        return;\n      }\n      var animating = false,\n        animationTime = 0;\n      animationStates.forEach(function (state) {\n        var time = 0,\n          target = state.target,\n          fromRect = target.fromRect,\n          toRect = getRect(target),\n          prevFromRect = target.prevFromRect,\n          prevToRect = target.prevToRect,\n          animatingRect = state.rect,\n          targetMatrix = matrix(target, true);\n        if (targetMatrix) {\n          // Compensate for current animation\n          toRect.top -= targetMatrix.f;\n          toRect.left -= targetMatrix.e;\n        }\n        target.toRect = toRect;\n        if (target.thisAnimationDuration) {\n          // Could also check if animatingRect is between fromRect and toRect\n          if (isRectEqual(prevFromRect, toRect) && !isRectEqual(fromRect, toRect) &&\n          // Make sure animatingRect is on line between toRect & fromRect\n          (animatingRect.top - toRect.top) / (animatingRect.left - toRect.left) === (fromRect.top - toRect.top) / (fromRect.left - toRect.left)) {\n            // If returning to same place as started from animation and on same axis\n            time = calculateRealTime(animatingRect, prevFromRect, prevToRect, _this.options);\n          }\n        }\n\n        // if fromRect != toRect: animate\n        if (!isRectEqual(toRect, fromRect)) {\n          target.prevFromRect = fromRect;\n          target.prevToRect = toRect;\n          if (!time) {\n            time = _this.options.animation;\n          }\n          _this.animate(target, animatingRect, toRect, time);\n        }\n        if (time) {\n          animating = true;\n          animationTime = Math.max(animationTime, time);\n          clearTimeout(target.animationResetTimer);\n          target.animationResetTimer = setTimeout(function () {\n            target.animationTime = 0;\n            target.prevFromRect = null;\n            target.fromRect = null;\n            target.prevToRect = null;\n            target.thisAnimationDuration = null;\n          }, time);\n          target.thisAnimationDuration = time;\n        }\n      });\n      clearTimeout(animationCallbackId);\n      if (!animating) {\n        if (typeof callback === 'function') callback();\n      } else {\n        animationCallbackId = setTimeout(function () {\n          if (typeof callback === 'function') callback();\n        }, animationTime);\n      }\n      animationStates = [];\n    },\n    animate: function animate(target, currentRect, toRect, duration) {\n      if (duration) {\n        css(target, 'transition', '');\n        css(target, 'transform', '');\n        var elMatrix = matrix(this.el),\n          scaleX = elMatrix && elMatrix.a,\n          scaleY = elMatrix && elMatrix.d,\n          translateX = (currentRect.left - toRect.left) / (scaleX || 1),\n          translateY = (currentRect.top - toRect.top) / (scaleY || 1);\n        target.animatingX = !!translateX;\n        target.animatingY = !!translateY;\n        css(target, 'transform', 'translate3d(' + translateX + 'px,' + translateY + 'px,0)');\n        this.forRepaintDummy = repaint(target); // repaint\n\n        css(target, 'transition', 'transform ' + duration + 'ms' + (this.options.easing ? ' ' + this.options.easing : ''));\n        css(target, 'transform', 'translate3d(0,0,0)');\n        typeof target.animated === 'number' && clearTimeout(target.animated);\n        target.animated = setTimeout(function () {\n          css(target, 'transition', '');\n          css(target, 'transform', '');\n          target.animated = false;\n          target.animatingX = false;\n          target.animatingY = false;\n        }, duration);\n      }\n    }\n  };\n}\nfunction repaint(target) {\n  return target.offsetWidth;\n}\nfunction calculateRealTime(animatingRect, fromRect, toRect, options) {\n  return Math.sqrt(Math.pow(fromRect.top - animatingRect.top, 2) + Math.pow(fromRect.left - animatingRect.left, 2)) / Math.sqrt(Math.pow(fromRect.top - toRect.top, 2) + Math.pow(fromRect.left - toRect.left, 2)) * options.animation;\n}\n\nvar plugins = [];\nvar defaults = {\n  initializeByDefault: true\n};\nvar PluginManager = {\n  mount: function mount(plugin) {\n    // Set default static properties\n    for (var option in defaults) {\n      if (defaults.hasOwnProperty(option) && !(option in plugin)) {\n        plugin[option] = defaults[option];\n      }\n    }\n    plugins.forEach(function (p) {\n      if (p.pluginName === plugin.pluginName) {\n        throw \"Sortable: Cannot mount plugin \".concat(plugin.pluginName, \" more than once\");\n      }\n    });\n    plugins.push(plugin);\n  },\n  pluginEvent: function pluginEvent(eventName, sortable, evt) {\n    var _this = this;\n    this.eventCanceled = false;\n    evt.cancel = function () {\n      _this.eventCanceled = true;\n    };\n    var eventNameGlobal = eventName + 'Global';\n    plugins.forEach(function (plugin) {\n      if (!sortable[plugin.pluginName]) return;\n      // Fire global events if it exists in this sortable\n      if (sortable[plugin.pluginName][eventNameGlobal]) {\n        sortable[plugin.pluginName][eventNameGlobal](_objectSpread2({\n          sortable: sortable\n        }, evt));\n      }\n\n      // Only fire plugin event if plugin is enabled in this sortable,\n      // and plugin has event defined\n      if (sortable.options[plugin.pluginName] && sortable[plugin.pluginName][eventName]) {\n        sortable[plugin.pluginName][eventName](_objectSpread2({\n          sortable: sortable\n        }, evt));\n      }\n    });\n  },\n  initializePlugins: function initializePlugins(sortable, el, defaults, options) {\n    plugins.forEach(function (plugin) {\n      var pluginName = plugin.pluginName;\n      if (!sortable.options[pluginName] && !plugin.initializeByDefault) return;\n      var initialized = new plugin(sortable, el, sortable.options);\n      initialized.sortable = sortable;\n      initialized.options = sortable.options;\n      sortable[pluginName] = initialized;\n\n      // Add default options from plugin\n      _extends(defaults, initialized.defaults);\n    });\n    for (var option in sortable.options) {\n      if (!sortable.options.hasOwnProperty(option)) continue;\n      var modified = this.modifyOption(sortable, option, sortable.options[option]);\n      if (typeof modified !== 'undefined') {\n        sortable.options[option] = modified;\n      }\n    }\n  },\n  getEventProperties: function getEventProperties(name, sortable) {\n    var eventProperties = {};\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.eventProperties !== 'function') return;\n      _extends(eventProperties, plugin.eventProperties.call(sortable[plugin.pluginName], name));\n    });\n    return eventProperties;\n  },\n  modifyOption: function modifyOption(sortable, name, value) {\n    var modifiedValue;\n    plugins.forEach(function (plugin) {\n      // Plugin must exist on the Sortable\n      if (!sortable[plugin.pluginName]) return;\n\n      // If static option listener exists for this option, call in the context of the Sortable's instance of this plugin\n      if (plugin.optionListeners && typeof plugin.optionListeners[name] === 'function') {\n        modifiedValue = plugin.optionListeners[name].call(sortable[plugin.pluginName], value);\n      }\n    });\n    return modifiedValue;\n  }\n};\n\nfunction dispatchEvent(_ref) {\n  var sortable = _ref.sortable,\n    rootEl = _ref.rootEl,\n    name = _ref.name,\n    targetEl = _ref.targetEl,\n    cloneEl = _ref.cloneEl,\n    toEl = _ref.toEl,\n    fromEl = _ref.fromEl,\n    oldIndex = _ref.oldIndex,\n    newIndex = _ref.newIndex,\n    oldDraggableIndex = _ref.oldDraggableIndex,\n    newDraggableIndex = _ref.newDraggableIndex,\n    originalEvent = _ref.originalEvent,\n    putSortable = _ref.putSortable,\n    extraEventProperties = _ref.extraEventProperties;\n  sortable = sortable || rootEl && rootEl[expando];\n  if (!sortable) return;\n  var evt,\n    options = sortable.options,\n    onName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n  // Support for new CustomEvent feature\n  if (window.CustomEvent && !IE11OrLess && !Edge) {\n    evt = new CustomEvent(name, {\n      bubbles: true,\n      cancelable: true\n    });\n  } else {\n    evt = document.createEvent('Event');\n    evt.initEvent(name, true, true);\n  }\n  evt.to = toEl || rootEl;\n  evt.from = fromEl || rootEl;\n  evt.item = targetEl || rootEl;\n  evt.clone = cloneEl;\n  evt.oldIndex = oldIndex;\n  evt.newIndex = newIndex;\n  evt.oldDraggableIndex = oldDraggableIndex;\n  evt.newDraggableIndex = newDraggableIndex;\n  evt.originalEvent = originalEvent;\n  evt.pullMode = putSortable ? putSortable.lastPutMode : undefined;\n  var allEventProperties = _objectSpread2(_objectSpread2({}, extraEventProperties), PluginManager.getEventProperties(name, sortable));\n  for (var option in allEventProperties) {\n    evt[option] = allEventProperties[option];\n  }\n  if (rootEl) {\n    rootEl.dispatchEvent(evt);\n  }\n  if (options[onName]) {\n    options[onName].call(sortable, evt);\n  }\n}\n\nvar _excluded = [\"evt\"];\nvar pluginEvent = function pluginEvent(eventName, sortable) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n    originalEvent = _ref.evt,\n    data = _objectWithoutProperties(_ref, _excluded);\n  PluginManager.pluginEvent.bind(Sortable)(eventName, sortable, _objectSpread2({\n    dragEl: dragEl,\n    parentEl: parentEl,\n    ghostEl: ghostEl,\n    rootEl: rootEl,\n    nextEl: nextEl,\n    lastDownEl: lastDownEl,\n    cloneEl: cloneEl,\n    cloneHidden: cloneHidden,\n    dragStarted: moved,\n    putSortable: putSortable,\n    activeSortable: Sortable.active,\n    originalEvent: originalEvent,\n    oldIndex: oldIndex,\n    oldDraggableIndex: oldDraggableIndex,\n    newIndex: newIndex,\n    newDraggableIndex: newDraggableIndex,\n    hideGhostForTarget: _hideGhostForTarget,\n    unhideGhostForTarget: _unhideGhostForTarget,\n    cloneNowHidden: function cloneNowHidden() {\n      cloneHidden = true;\n    },\n    cloneNowShown: function cloneNowShown() {\n      cloneHidden = false;\n    },\n    dispatchSortableEvent: function dispatchSortableEvent(name) {\n      _dispatchEvent({\n        sortable: sortable,\n        name: name,\n        originalEvent: originalEvent\n      });\n    }\n  }, data));\n};\nfunction _dispatchEvent(info) {\n  dispatchEvent(_objectSpread2({\n    putSortable: putSortable,\n    cloneEl: cloneEl,\n    targetEl: dragEl,\n    rootEl: rootEl,\n    oldIndex: oldIndex,\n    oldDraggableIndex: oldDraggableIndex,\n    newIndex: newIndex,\n    newDraggableIndex: newDraggableIndex\n  }, info));\n}\nvar dragEl,\n  parentEl,\n  ghostEl,\n  rootEl,\n  nextEl,\n  lastDownEl,\n  cloneEl,\n  cloneHidden,\n  oldIndex,\n  newIndex,\n  oldDraggableIndex,\n  newDraggableIndex,\n  activeGroup,\n  putSortable,\n  awaitingDragStarted = false,\n  ignoreNextClick = false,\n  sortables = [],\n  tapEvt,\n  touchEvt,\n  lastDx,\n  lastDy,\n  tapDistanceLeft,\n  tapDistanceTop,\n  moved,\n  lastTarget,\n  lastDirection,\n  pastFirstInvertThresh = false,\n  isCircumstantialInvert = false,\n  targetMoveDistance,\n  // For positioning ghost absolutely\n  ghostRelativeParent,\n  ghostRelativeParentInitialScroll = [],\n  // (left, top)\n\n  _silent = false,\n  savedInputChecked = [];\n\n/** @const */\nvar documentExists = typeof document !== 'undefined',\n  PositionGhostAbsolutely = IOS,\n  CSSFloatProperty = Edge || IE11OrLess ? 'cssFloat' : 'float',\n  // This will not pass for IE9, because IE9 DnD only works on anchors\n  supportDraggable = documentExists && !ChromeForAndroid && !IOS && 'draggable' in document.createElement('div'),\n  supportCssPointerEvents = function () {\n    if (!documentExists) return;\n    // false when <= IE11\n    if (IE11OrLess) {\n      return false;\n    }\n    var el = document.createElement('x');\n    el.style.cssText = 'pointer-events:auto';\n    return el.style.pointerEvents === 'auto';\n  }(),\n  _detectDirection = function _detectDirection(el, options) {\n    var elCSS = css(el),\n      elWidth = parseInt(elCSS.width) - parseInt(elCSS.paddingLeft) - parseInt(elCSS.paddingRight) - parseInt(elCSS.borderLeftWidth) - parseInt(elCSS.borderRightWidth),\n      child1 = getChild(el, 0, options),\n      child2 = getChild(el, 1, options),\n      firstChildCSS = child1 && css(child1),\n      secondChildCSS = child2 && css(child2),\n      firstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + getRect(child1).width,\n      secondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + getRect(child2).width;\n    if (elCSS.display === 'flex') {\n      return elCSS.flexDirection === 'column' || elCSS.flexDirection === 'column-reverse' ? 'vertical' : 'horizontal';\n    }\n    if (elCSS.display === 'grid') {\n      return elCSS.gridTemplateColumns.split(' ').length <= 1 ? 'vertical' : 'horizontal';\n    }\n    if (child1 && firstChildCSS[\"float\"] && firstChildCSS[\"float\"] !== 'none') {\n      var touchingSideChild2 = firstChildCSS[\"float\"] === 'left' ? 'left' : 'right';\n      return child2 && (secondChildCSS.clear === 'both' || secondChildCSS.clear === touchingSideChild2) ? 'vertical' : 'horizontal';\n    }\n    return child1 && (firstChildCSS.display === 'block' || firstChildCSS.display === 'flex' || firstChildCSS.display === 'table' || firstChildCSS.display === 'grid' || firstChildWidth >= elWidth && elCSS[CSSFloatProperty] === 'none' || child2 && elCSS[CSSFloatProperty] === 'none' && firstChildWidth + secondChildWidth > elWidth) ? 'vertical' : 'horizontal';\n  },\n  _dragElInRowColumn = function _dragElInRowColumn(dragRect, targetRect, vertical) {\n    var dragElS1Opp = vertical ? dragRect.left : dragRect.top,\n      dragElS2Opp = vertical ? dragRect.right : dragRect.bottom,\n      dragElOppLength = vertical ? dragRect.width : dragRect.height,\n      targetS1Opp = vertical ? targetRect.left : targetRect.top,\n      targetS2Opp = vertical ? targetRect.right : targetRect.bottom,\n      targetOppLength = vertical ? targetRect.width : targetRect.height;\n    return dragElS1Opp === targetS1Opp || dragElS2Opp === targetS2Opp || dragElS1Opp + dragElOppLength / 2 === targetS1Opp + targetOppLength / 2;\n  },\n  /**\r\n   * Detects first nearest empty sortable to X and Y position using emptyInsertThreshold.\r\n   * @param  {Number} x      X position\r\n   * @param  {Number} y      Y position\r\n   * @return {HTMLElement}   Element of the first found nearest Sortable\r\n   */\n  _detectNearestEmptySortable = function _detectNearestEmptySortable(x, y) {\n    var ret;\n    sortables.some(function (sortable) {\n      var threshold = sortable[expando].options.emptyInsertThreshold;\n      if (!threshold || lastChild(sortable)) return;\n      var rect = getRect(sortable),\n        insideHorizontally = x >= rect.left - threshold && x <= rect.right + threshold,\n        insideVertically = y >= rect.top - threshold && y <= rect.bottom + threshold;\n      if (insideHorizontally && insideVertically) {\n        return ret = sortable;\n      }\n    });\n    return ret;\n  },\n  _prepareGroup = function _prepareGroup(options) {\n    function toFn(value, pull) {\n      return function (to, from, dragEl, evt) {\n        var sameGroup = to.options.group.name && from.options.group.name && to.options.group.name === from.options.group.name;\n        if (value == null && (pull || sameGroup)) {\n          // Default pull value\n          // Default pull and put value if same group\n          return true;\n        } else if (value == null || value === false) {\n          return false;\n        } else if (pull && value === 'clone') {\n          return value;\n        } else if (typeof value === 'function') {\n          return toFn(value(to, from, dragEl, evt), pull)(to, from, dragEl, evt);\n        } else {\n          var otherGroup = (pull ? to : from).options.group.name;\n          return value === true || typeof value === 'string' && value === otherGroup || value.join && value.indexOf(otherGroup) > -1;\n        }\n      };\n    }\n    var group = {};\n    var originalGroup = options.group;\n    if (!originalGroup || _typeof(originalGroup) != 'object') {\n      originalGroup = {\n        name: originalGroup\n      };\n    }\n    group.name = originalGroup.name;\n    group.checkPull = toFn(originalGroup.pull, true);\n    group.checkPut = toFn(originalGroup.put);\n    group.revertClone = originalGroup.revertClone;\n    options.group = group;\n  },\n  _hideGhostForTarget = function _hideGhostForTarget() {\n    if (!supportCssPointerEvents && ghostEl) {\n      css(ghostEl, 'display', 'none');\n    }\n  },\n  _unhideGhostForTarget = function _unhideGhostForTarget() {\n    if (!supportCssPointerEvents && ghostEl) {\n      css(ghostEl, 'display', '');\n    }\n  };\n\n// #1184 fix - Prevent click event on fallback if dragged but item not changed position\nif (documentExists && !ChromeForAndroid) {\n  document.addEventListener('click', function (evt) {\n    if (ignoreNextClick) {\n      evt.preventDefault();\n      evt.stopPropagation && evt.stopPropagation();\n      evt.stopImmediatePropagation && evt.stopImmediatePropagation();\n      ignoreNextClick = false;\n      return false;\n    }\n  }, true);\n}\nvar nearestEmptyInsertDetectEvent = function nearestEmptyInsertDetectEvent(evt) {\n  if (dragEl) {\n    evt = evt.touches ? evt.touches[0] : evt;\n    var nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);\n    if (nearest) {\n      // Create imitation event\n      var event = {};\n      for (var i in evt) {\n        if (evt.hasOwnProperty(i)) {\n          event[i] = evt[i];\n        }\n      }\n      event.target = event.rootEl = nearest;\n      event.preventDefault = void 0;\n      event.stopPropagation = void 0;\n      nearest[expando]._onDragOver(event);\n    }\n  }\n};\nvar _checkOutsideTargetEl = function _checkOutsideTargetEl(evt) {\n  if (dragEl) {\n    dragEl.parentNode[expando]._isOutsideThisEl(evt.target);\n  }\n};\n\n/**\r\n * @class  Sortable\r\n * @param  {HTMLElement}  el\r\n * @param  {Object}       [options]\r\n */\nfunction Sortable(el, options) {\n  if (!(el && el.nodeType && el.nodeType === 1)) {\n    throw \"Sortable: `el` must be an HTMLElement, not \".concat({}.toString.call(el));\n  }\n  this.el = el; // root element\n  this.options = options = _extends({}, options);\n\n  // Export instance\n  el[expando] = this;\n  var defaults = {\n    group: null,\n    sort: true,\n    disabled: false,\n    store: null,\n    handle: null,\n    draggable: /^[uo]l$/i.test(el.nodeName) ? '>li' : '>*',\n    swapThreshold: 1,\n    // percentage; 0 <= x <= 1\n    invertSwap: false,\n    // invert always\n    invertedSwapThreshold: null,\n    // will be set to same as swapThreshold if default\n    removeCloneOnHide: true,\n    direction: function direction() {\n      return _detectDirection(el, this.options);\n    },\n    ghostClass: 'sortable-ghost',\n    chosenClass: 'sortable-chosen',\n    dragClass: 'sortable-drag',\n    ignore: 'a, img',\n    filter: null,\n    preventOnFilter: true,\n    animation: 0,\n    easing: null,\n    setData: function setData(dataTransfer, dragEl) {\n      dataTransfer.setData('Text', dragEl.textContent);\n    },\n    dropBubble: false,\n    dragoverBubble: false,\n    dataIdAttr: 'data-id',\n    delay: 0,\n    delayOnTouchOnly: false,\n    touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1,\n    forceFallback: false,\n    fallbackClass: 'sortable-fallback',\n    fallbackOnBody: false,\n    fallbackTolerance: 0,\n    fallbackOffset: {\n      x: 0,\n      y: 0\n    },\n    supportPointer: Sortable.supportPointer !== false && 'PointerEvent' in window && !Safari,\n    emptyInsertThreshold: 5\n  };\n  PluginManager.initializePlugins(this, el, defaults);\n\n  // Set default options\n  for (var name in defaults) {\n    !(name in options) && (options[name] = defaults[name]);\n  }\n  _prepareGroup(options);\n\n  // Bind all private methods\n  for (var fn in this) {\n    if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n      this[fn] = this[fn].bind(this);\n    }\n  }\n\n  // Setup drag mode\n  this.nativeDraggable = options.forceFallback ? false : supportDraggable;\n  if (this.nativeDraggable) {\n    // Touch start threshold cannot be greater than the native dragstart threshold\n    this.options.touchStartThreshold = 1;\n  }\n\n  // Bind events\n  if (options.supportPointer) {\n    on(el, 'pointerdown', this._onTapStart);\n  } else {\n    on(el, 'mousedown', this._onTapStart);\n    on(el, 'touchstart', this._onTapStart);\n  }\n  if (this.nativeDraggable) {\n    on(el, 'dragover', this);\n    on(el, 'dragenter', this);\n  }\n  sortables.push(this.el);\n\n  // Restore sorting\n  options.store && options.store.get && this.sort(options.store.get(this) || []);\n\n  // Add animation state manager\n  _extends(this, AnimationStateManager());\n}\nSortable.prototype = /** @lends Sortable.prototype */{\n  constructor: Sortable,\n  _isOutsideThisEl: function _isOutsideThisEl(target) {\n    if (!this.el.contains(target) && target !== this.el) {\n      lastTarget = null;\n    }\n  },\n  _getDirection: function _getDirection(evt, target) {\n    return typeof this.options.direction === 'function' ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;\n  },\n  _onTapStart: function _onTapStart( /** Event|TouchEvent */evt) {\n    if (!evt.cancelable) return;\n    var _this = this,\n      el = this.el,\n      options = this.options,\n      preventOnFilter = options.preventOnFilter,\n      type = evt.type,\n      touch = evt.touches && evt.touches[0] || evt.pointerType && evt.pointerType === 'touch' && evt,\n      target = (touch || evt).target,\n      originalTarget = evt.target.shadowRoot && (evt.path && evt.path[0] || evt.composedPath && evt.composedPath()[0]) || target,\n      filter = options.filter;\n    _saveInputCheckedState(el);\n\n    // Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n    if (dragEl) {\n      return;\n    }\n    if (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n      return; // only left button and enabled\n    }\n\n    // cancel dnd if original target is content editable\n    if (originalTarget.isContentEditable) {\n      return;\n    }\n\n    // Safari ignores further event handling after mousedown\n    if (!this.nativeDraggable && Safari && target && target.tagName.toUpperCase() === 'SELECT') {\n      return;\n    }\n    target = closest(target, options.draggable, el, false);\n    if (target && target.animated) {\n      return;\n    }\n    if (lastDownEl === target) {\n      // Ignoring duplicate `down`\n      return;\n    }\n\n    // Get the index of the dragged element within its parent\n    oldIndex = index(target);\n    oldDraggableIndex = index(target, options.draggable);\n\n    // Check filter\n    if (typeof filter === 'function') {\n      if (filter.call(this, evt, target, this)) {\n        _dispatchEvent({\n          sortable: _this,\n          rootEl: originalTarget,\n          name: 'filter',\n          targetEl: target,\n          toEl: el,\n          fromEl: el\n        });\n        pluginEvent('filter', _this, {\n          evt: evt\n        });\n        preventOnFilter && evt.cancelable && evt.preventDefault();\n        return; // cancel dnd\n      }\n    } else if (filter) {\n      filter = filter.split(',').some(function (criteria) {\n        criteria = closest(originalTarget, criteria.trim(), el, false);\n        if (criteria) {\n          _dispatchEvent({\n            sortable: _this,\n            rootEl: criteria,\n            name: 'filter',\n            targetEl: target,\n            fromEl: el,\n            toEl: el\n          });\n          pluginEvent('filter', _this, {\n            evt: evt\n          });\n          return true;\n        }\n      });\n      if (filter) {\n        preventOnFilter && evt.cancelable && evt.preventDefault();\n        return; // cancel dnd\n      }\n    }\n    if (options.handle && !closest(originalTarget, options.handle, el, false)) {\n      return;\n    }\n\n    // Prepare `dragstart`\n    this._prepareDragStart(evt, touch, target);\n  },\n  _prepareDragStart: function _prepareDragStart( /** Event */evt, /** Touch */touch, /** HTMLElement */target) {\n    var _this = this,\n      el = _this.el,\n      options = _this.options,\n      ownerDocument = el.ownerDocument,\n      dragStartFn;\n    if (target && !dragEl && target.parentNode === el) {\n      var dragRect = getRect(target);\n      rootEl = el;\n      dragEl = target;\n      parentEl = dragEl.parentNode;\n      nextEl = dragEl.nextSibling;\n      lastDownEl = target;\n      activeGroup = options.group;\n      Sortable.dragged = dragEl;\n      tapEvt = {\n        target: dragEl,\n        clientX: (touch || evt).clientX,\n        clientY: (touch || evt).clientY\n      };\n      tapDistanceLeft = tapEvt.clientX - dragRect.left;\n      tapDistanceTop = tapEvt.clientY - dragRect.top;\n      this._lastX = (touch || evt).clientX;\n      this._lastY = (touch || evt).clientY;\n      dragEl.style['will-change'] = 'all';\n      dragStartFn = function dragStartFn() {\n        pluginEvent('delayEnded', _this, {\n          evt: evt\n        });\n        if (Sortable.eventCanceled) {\n          _this._onDrop();\n          return;\n        }\n        // Delayed drag has been triggered\n        // we can re-enable the events: touchmove/mousemove\n        _this._disableDelayedDragEvents();\n        if (!FireFox && _this.nativeDraggable) {\n          dragEl.draggable = true;\n        }\n\n        // Bind the events: dragstart/dragend\n        _this._triggerDragStart(evt, touch);\n\n        // Drag start event\n        _dispatchEvent({\n          sortable: _this,\n          name: 'choose',\n          originalEvent: evt\n        });\n\n        // Chosen item\n        toggleClass(dragEl, options.chosenClass, true);\n      };\n\n      // Disable \"draggable\"\n      options.ignore.split(',').forEach(function (criteria) {\n        find(dragEl, criteria.trim(), _disableDraggable);\n      });\n      on(ownerDocument, 'dragover', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'mousemove', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'touchmove', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'mouseup', _this._onDrop);\n      on(ownerDocument, 'touchend', _this._onDrop);\n      on(ownerDocument, 'touchcancel', _this._onDrop);\n\n      // Make dragEl draggable (must be before delay for FireFox)\n      if (FireFox && this.nativeDraggable) {\n        this.options.touchStartThreshold = 4;\n        dragEl.draggable = true;\n      }\n      pluginEvent('delayStart', this, {\n        evt: evt\n      });\n\n      // Delay is impossible for native DnD in Edge or IE\n      if (options.delay && (!options.delayOnTouchOnly || touch) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {\n        if (Sortable.eventCanceled) {\n          this._onDrop();\n          return;\n        }\n        // If the user moves the pointer or let go the click or touch\n        // before the delay has been reached:\n        // disable the delayed drag\n        on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n        on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n        on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n        on(ownerDocument, 'mousemove', _this._delayedDragTouchMoveHandler);\n        on(ownerDocument, 'touchmove', _this._delayedDragTouchMoveHandler);\n        options.supportPointer && on(ownerDocument, 'pointermove', _this._delayedDragTouchMoveHandler);\n        _this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n      } else {\n        dragStartFn();\n      }\n    }\n  },\n  _delayedDragTouchMoveHandler: function _delayedDragTouchMoveHandler( /** TouchEvent|PointerEvent **/e) {\n    var touch = e.touches ? e.touches[0] : e;\n    if (Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))) {\n      this._disableDelayedDrag();\n    }\n  },\n  _disableDelayedDrag: function _disableDelayedDrag() {\n    dragEl && _disableDraggable(dragEl);\n    clearTimeout(this._dragStartTimer);\n    this._disableDelayedDragEvents();\n  },\n  _disableDelayedDragEvents: function _disableDelayedDragEvents() {\n    var ownerDocument = this.el.ownerDocument;\n    off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n    off(ownerDocument, 'touchend', this._disableDelayedDrag);\n    off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n    off(ownerDocument, 'mousemove', this._delayedDragTouchMoveHandler);\n    off(ownerDocument, 'touchmove', this._delayedDragTouchMoveHandler);\n    off(ownerDocument, 'pointermove', this._delayedDragTouchMoveHandler);\n  },\n  _triggerDragStart: function _triggerDragStart( /** Event */evt, /** Touch */touch) {\n    touch = touch || evt.pointerType == 'touch' && evt;\n    if (!this.nativeDraggable || touch) {\n      if (this.options.supportPointer) {\n        on(document, 'pointermove', this._onTouchMove);\n      } else if (touch) {\n        on(document, 'touchmove', this._onTouchMove);\n      } else {\n        on(document, 'mousemove', this._onTouchMove);\n      }\n    } else {\n      on(dragEl, 'dragend', this);\n      on(rootEl, 'dragstart', this._onDragStart);\n    }\n    try {\n      if (document.selection) {\n        // Timeout neccessary for IE9\n        _nextTick(function () {\n          document.selection.empty();\n        });\n      } else {\n        window.getSelection().removeAllRanges();\n      }\n    } catch (err) {}\n  },\n  _dragStarted: function _dragStarted(fallback, evt) {\n    awaitingDragStarted = false;\n    if (rootEl && dragEl) {\n      pluginEvent('dragStarted', this, {\n        evt: evt\n      });\n      if (this.nativeDraggable) {\n        on(document, 'dragover', _checkOutsideTargetEl);\n      }\n      var options = this.options;\n\n      // Apply effect\n      !fallback && toggleClass(dragEl, options.dragClass, false);\n      toggleClass(dragEl, options.ghostClass, true);\n      Sortable.active = this;\n      fallback && this._appendGhost();\n\n      // Drag start event\n      _dispatchEvent({\n        sortable: this,\n        name: 'start',\n        originalEvent: evt\n      });\n    } else {\n      this._nulling();\n    }\n  },\n  _emulateDragOver: function _emulateDragOver() {\n    if (touchEvt) {\n      this._lastX = touchEvt.clientX;\n      this._lastY = touchEvt.clientY;\n      _hideGhostForTarget();\n      var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n      var parent = target;\n      while (target && target.shadowRoot) {\n        target = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n        if (target === parent) break;\n        parent = target;\n      }\n      dragEl.parentNode[expando]._isOutsideThisEl(target);\n      if (parent) {\n        do {\n          if (parent[expando]) {\n            var inserted = void 0;\n            inserted = parent[expando]._onDragOver({\n              clientX: touchEvt.clientX,\n              clientY: touchEvt.clientY,\n              target: target,\n              rootEl: parent\n            });\n            if (inserted && !this.options.dragoverBubble) {\n              break;\n            }\n          }\n          target = parent; // store last element\n        }\n        /* jshint boss:true */ while (parent = getParentOrHost(parent));\n      }\n      _unhideGhostForTarget();\n    }\n  },\n  _onTouchMove: function _onTouchMove( /**TouchEvent*/evt) {\n    if (tapEvt) {\n      var options = this.options,\n        fallbackTolerance = options.fallbackTolerance,\n        fallbackOffset = options.fallbackOffset,\n        touch = evt.touches ? evt.touches[0] : evt,\n        ghostMatrix = ghostEl && matrix(ghostEl, true),\n        scaleX = ghostEl && ghostMatrix && ghostMatrix.a,\n        scaleY = ghostEl && ghostMatrix && ghostMatrix.d,\n        relativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && getRelativeScrollOffset(ghostRelativeParent),\n        dx = (touch.clientX - tapEvt.clientX + fallbackOffset.x) / (scaleX || 1) + (relativeScrollOffset ? relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0] : 0) / (scaleX || 1),\n        dy = (touch.clientY - tapEvt.clientY + fallbackOffset.y) / (scaleY || 1) + (relativeScrollOffset ? relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1] : 0) / (scaleY || 1);\n\n      // only set the status to dragging, when we are actually dragging\n      if (!Sortable.active && !awaitingDragStarted) {\n        if (fallbackTolerance && Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) < fallbackTolerance) {\n          return;\n        }\n        this._onDragStart(evt, true);\n      }\n      if (ghostEl) {\n        if (ghostMatrix) {\n          ghostMatrix.e += dx - (lastDx || 0);\n          ghostMatrix.f += dy - (lastDy || 0);\n        } else {\n          ghostMatrix = {\n            a: 1,\n            b: 0,\n            c: 0,\n            d: 1,\n            e: dx,\n            f: dy\n          };\n        }\n        var cssMatrix = \"matrix(\".concat(ghostMatrix.a, \",\").concat(ghostMatrix.b, \",\").concat(ghostMatrix.c, \",\").concat(ghostMatrix.d, \",\").concat(ghostMatrix.e, \",\").concat(ghostMatrix.f, \")\");\n        css(ghostEl, 'webkitTransform', cssMatrix);\n        css(ghostEl, 'mozTransform', cssMatrix);\n        css(ghostEl, 'msTransform', cssMatrix);\n        css(ghostEl, 'transform', cssMatrix);\n        lastDx = dx;\n        lastDy = dy;\n        touchEvt = touch;\n      }\n      evt.cancelable && evt.preventDefault();\n    }\n  },\n  _appendGhost: function _appendGhost() {\n    // Bug if using scale(): https://stackoverflow.com/questions/2637058\n    // Not being adjusted for\n    if (!ghostEl) {\n      var container = this.options.fallbackOnBody ? document.body : rootEl,\n        rect = getRect(dragEl, true, PositionGhostAbsolutely, true, container),\n        options = this.options;\n\n      // Position absolutely\n      if (PositionGhostAbsolutely) {\n        // Get relatively positioned parent\n        ghostRelativeParent = container;\n        while (css(ghostRelativeParent, 'position') === 'static' && css(ghostRelativeParent, 'transform') === 'none' && ghostRelativeParent !== document) {\n          ghostRelativeParent = ghostRelativeParent.parentNode;\n        }\n        if (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {\n          if (ghostRelativeParent === document) ghostRelativeParent = getWindowScrollingElement();\n          rect.top += ghostRelativeParent.scrollTop;\n          rect.left += ghostRelativeParent.scrollLeft;\n        } else {\n          ghostRelativeParent = getWindowScrollingElement();\n        }\n        ghostRelativeParentInitialScroll = getRelativeScrollOffset(ghostRelativeParent);\n      }\n      ghostEl = dragEl.cloneNode(true);\n      toggleClass(ghostEl, options.ghostClass, false);\n      toggleClass(ghostEl, options.fallbackClass, true);\n      toggleClass(ghostEl, options.dragClass, true);\n      css(ghostEl, 'transition', '');\n      css(ghostEl, 'transform', '');\n      css(ghostEl, 'box-sizing', 'border-box');\n      css(ghostEl, 'margin', 0);\n      css(ghostEl, 'top', rect.top);\n      css(ghostEl, 'left', rect.left);\n      css(ghostEl, 'width', rect.width);\n      css(ghostEl, 'height', rect.height);\n      css(ghostEl, 'opacity', '0.8');\n      css(ghostEl, 'position', PositionGhostAbsolutely ? 'absolute' : 'fixed');\n      css(ghostEl, 'zIndex', '100000');\n      css(ghostEl, 'pointerEvents', 'none');\n      Sortable.ghost = ghostEl;\n      container.appendChild(ghostEl);\n\n      // Set transform-origin\n      css(ghostEl, 'transform-origin', tapDistanceLeft / parseInt(ghostEl.style.width) * 100 + '% ' + tapDistanceTop / parseInt(ghostEl.style.height) * 100 + '%');\n    }\n  },\n  _onDragStart: function _onDragStart( /**Event*/evt, /**boolean*/fallback) {\n    var _this = this;\n    var dataTransfer = evt.dataTransfer;\n    var options = _this.options;\n    pluginEvent('dragStart', this, {\n      evt: evt\n    });\n    if (Sortable.eventCanceled) {\n      this._onDrop();\n      return;\n    }\n    pluginEvent('setupClone', this);\n    if (!Sortable.eventCanceled) {\n      cloneEl = clone(dragEl);\n      cloneEl.removeAttribute(\"id\");\n      cloneEl.draggable = false;\n      cloneEl.style['will-change'] = '';\n      this._hideClone();\n      toggleClass(cloneEl, this.options.chosenClass, false);\n      Sortable.clone = cloneEl;\n    }\n\n    // #1143: IFrame support workaround\n    _this.cloneId = _nextTick(function () {\n      pluginEvent('clone', _this);\n      if (Sortable.eventCanceled) return;\n      if (!_this.options.removeCloneOnHide) {\n        rootEl.insertBefore(cloneEl, dragEl);\n      }\n      _this._hideClone();\n      _dispatchEvent({\n        sortable: _this,\n        name: 'clone'\n      });\n    });\n    !fallback && toggleClass(dragEl, options.dragClass, true);\n\n    // Set proper drop events\n    if (fallback) {\n      ignoreNextClick = true;\n      _this._loopId = setInterval(_this._emulateDragOver, 50);\n    } else {\n      // Undo what was set in _prepareDragStart before drag started\n      off(document, 'mouseup', _this._onDrop);\n      off(document, 'touchend', _this._onDrop);\n      off(document, 'touchcancel', _this._onDrop);\n      if (dataTransfer) {\n        dataTransfer.effectAllowed = 'move';\n        options.setData && options.setData.call(_this, dataTransfer, dragEl);\n      }\n      on(document, 'drop', _this);\n\n      // #1276 fix:\n      css(dragEl, 'transform', 'translateZ(0)');\n    }\n    awaitingDragStarted = true;\n    _this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));\n    on(document, 'selectstart', _this);\n    moved = true;\n    if (Safari) {\n      css(document.body, 'user-select', 'none');\n    }\n  },\n  // Returns true - if no further action is needed (either inserted or another condition)\n  _onDragOver: function _onDragOver( /**Event*/evt) {\n    var el = this.el,\n      target = evt.target,\n      dragRect,\n      targetRect,\n      revert,\n      options = this.options,\n      group = options.group,\n      activeSortable = Sortable.active,\n      isOwner = activeGroup === group,\n      canSort = options.sort,\n      fromSortable = putSortable || activeSortable,\n      vertical,\n      _this = this,\n      completedFired = false;\n    if (_silent) return;\n    function dragOverEvent(name, extra) {\n      pluginEvent(name, _this, _objectSpread2({\n        evt: evt,\n        isOwner: isOwner,\n        axis: vertical ? 'vertical' : 'horizontal',\n        revert: revert,\n        dragRect: dragRect,\n        targetRect: targetRect,\n        canSort: canSort,\n        fromSortable: fromSortable,\n        target: target,\n        completed: completed,\n        onMove: function onMove(target, after) {\n          return _onMove(rootEl, el, dragEl, dragRect, target, getRect(target), evt, after);\n        },\n        changed: changed\n      }, extra));\n    }\n\n    // Capture animation state\n    function capture() {\n      dragOverEvent('dragOverAnimationCapture');\n      _this.captureAnimationState();\n      if (_this !== fromSortable) {\n        fromSortable.captureAnimationState();\n      }\n    }\n\n    // Return invocation when dragEl is inserted (or completed)\n    function completed(insertion) {\n      dragOverEvent('dragOverCompleted', {\n        insertion: insertion\n      });\n      if (insertion) {\n        // Clones must be hidden before folding animation to capture dragRectAbsolute properly\n        if (isOwner) {\n          activeSortable._hideClone();\n        } else {\n          activeSortable._showClone(_this);\n        }\n        if (_this !== fromSortable) {\n          // Set ghost class to new sortable's ghost class\n          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);\n          toggleClass(dragEl, options.ghostClass, true);\n        }\n        if (putSortable !== _this && _this !== Sortable.active) {\n          putSortable = _this;\n        } else if (_this === Sortable.active && putSortable) {\n          putSortable = null;\n        }\n\n        // Animation\n        if (fromSortable === _this) {\n          _this._ignoreWhileAnimating = target;\n        }\n        _this.animateAll(function () {\n          dragOverEvent('dragOverAnimationComplete');\n          _this._ignoreWhileAnimating = null;\n        });\n        if (_this !== fromSortable) {\n          fromSortable.animateAll();\n          fromSortable._ignoreWhileAnimating = null;\n        }\n      }\n\n      // Null lastTarget if it is not inside a previously swapped element\n      if (target === dragEl && !dragEl.animated || target === el && !target.animated) {\n        lastTarget = null;\n      }\n\n      // no bubbling and not fallback\n      if (!options.dragoverBubble && !evt.rootEl && target !== document) {\n        dragEl.parentNode[expando]._isOutsideThisEl(evt.target);\n\n        // Do not detect for empty insert if already inserted\n        !insertion && nearestEmptyInsertDetectEvent(evt);\n      }\n      !options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();\n      return completedFired = true;\n    }\n\n    // Call when dragEl has been inserted\n    function changed() {\n      newIndex = index(dragEl);\n      newDraggableIndex = index(dragEl, options.draggable);\n      _dispatchEvent({\n        sortable: _this,\n        name: 'change',\n        toEl: el,\n        newIndex: newIndex,\n        newDraggableIndex: newDraggableIndex,\n        originalEvent: evt\n      });\n    }\n    if (evt.preventDefault !== void 0) {\n      evt.cancelable && evt.preventDefault();\n    }\n    target = closest(target, options.draggable, el, true);\n    dragOverEvent('dragOver');\n    if (Sortable.eventCanceled) return completedFired;\n    if (dragEl.contains(evt.target) || target.animated && target.animatingX && target.animatingY || _this._ignoreWhileAnimating === target) {\n      return completed(false);\n    }\n    ignoreNextClick = false;\n    if (activeSortable && !options.disabled && (isOwner ? canSort || (revert = parentEl !== rootEl) // Reverting item into the original list\n    : putSortable === this || (this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) && group.checkPut(this, activeSortable, dragEl, evt))) {\n      vertical = this._getDirection(evt, target) === 'vertical';\n      dragRect = getRect(dragEl);\n      dragOverEvent('dragOverValid');\n      if (Sortable.eventCanceled) return completedFired;\n      if (revert) {\n        parentEl = rootEl; // actualization\n        capture();\n        this._hideClone();\n        dragOverEvent('revert');\n        if (!Sortable.eventCanceled) {\n          if (nextEl) {\n            rootEl.insertBefore(dragEl, nextEl);\n          } else {\n            rootEl.appendChild(dragEl);\n          }\n        }\n        return completed(true);\n      }\n      var elLastChild = lastChild(el, options.draggable);\n      if (!elLastChild || _ghostIsLast(evt, vertical, this) && !elLastChild.animated) {\n        // Insert to end of list\n\n        // If already at end of list: Do not insert\n        if (elLastChild === dragEl) {\n          return completed(false);\n        }\n\n        // if there is a last element, it is the target\n        if (elLastChild && el === evt.target) {\n          target = elLastChild;\n        }\n        if (target) {\n          targetRect = getRect(target);\n        }\n        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {\n          capture();\n          if (elLastChild && elLastChild.nextSibling) {\n            // the last draggable element is not the last node\n            el.insertBefore(dragEl, elLastChild.nextSibling);\n          } else {\n            el.appendChild(dragEl);\n          }\n          parentEl = el; // actualization\n\n          changed();\n          return completed(true);\n        }\n      } else if (elLastChild && _ghostIsFirst(evt, vertical, this)) {\n        // Insert to start of list\n        var firstChild = getChild(el, 0, options, true);\n        if (firstChild === dragEl) {\n          return completed(false);\n        }\n        target = firstChild;\n        targetRect = getRect(target);\n        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, false) !== false) {\n          capture();\n          el.insertBefore(dragEl, firstChild);\n          parentEl = el; // actualization\n\n          changed();\n          return completed(true);\n        }\n      } else if (target.parentNode === el) {\n        targetRect = getRect(target);\n        var direction = 0,\n          targetBeforeFirstSwap,\n          differentLevel = dragEl.parentNode !== el,\n          differentRowCol = !_dragElInRowColumn(dragEl.animated && dragEl.toRect || dragRect, target.animated && target.toRect || targetRect, vertical),\n          side1 = vertical ? 'top' : 'left',\n          scrolledPastTop = isScrolledPast(target, 'top', 'top') || isScrolledPast(dragEl, 'top', 'top'),\n          scrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;\n        if (lastTarget !== target) {\n          targetBeforeFirstSwap = targetRect[side1];\n          pastFirstInvertThresh = false;\n          isCircumstantialInvert = !differentRowCol && options.invertSwap || differentLevel;\n        }\n        direction = _getSwapDirection(evt, target, targetRect, vertical, differentRowCol ? 1 : options.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold, isCircumstantialInvert, lastTarget === target);\n        var sibling;\n        if (direction !== 0) {\n          // Check if target is beside dragEl in respective direction (ignoring hidden elements)\n          var dragIndex = index(dragEl);\n          do {\n            dragIndex -= direction;\n            sibling = parentEl.children[dragIndex];\n          } while (sibling && (css(sibling, 'display') === 'none' || sibling === ghostEl));\n        }\n        // If dragEl is already beside target: Do not insert\n        if (direction === 0 || sibling === target) {\n          return completed(false);\n        }\n        lastTarget = target;\n        lastDirection = direction;\n        var nextSibling = target.nextElementSibling,\n          after = false;\n        after = direction === 1;\n        var moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n        if (moveVector !== false) {\n          if (moveVector === 1 || moveVector === -1) {\n            after = moveVector === 1;\n          }\n          _silent = true;\n          setTimeout(_unsilent, 30);\n          capture();\n          if (after && !nextSibling) {\n            el.appendChild(dragEl);\n          } else {\n            target.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n          }\n\n          // Undo chrome's scroll adjustment (has no effect on other browsers)\n          if (scrolledPastTop) {\n            scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);\n          }\n          parentEl = dragEl.parentNode; // actualization\n\n          // must be done before animation\n          if (targetBeforeFirstSwap !== undefined && !isCircumstantialInvert) {\n            targetMoveDistance = Math.abs(targetBeforeFirstSwap - getRect(target)[side1]);\n          }\n          changed();\n          return completed(true);\n        }\n      }\n      if (el.contains(dragEl)) {\n        return completed(false);\n      }\n    }\n    return false;\n  },\n  _ignoreWhileAnimating: null,\n  _offMoveEvents: function _offMoveEvents() {\n    off(document, 'mousemove', this._onTouchMove);\n    off(document, 'touchmove', this._onTouchMove);\n    off(document, 'pointermove', this._onTouchMove);\n    off(document, 'dragover', nearestEmptyInsertDetectEvent);\n    off(document, 'mousemove', nearestEmptyInsertDetectEvent);\n    off(document, 'touchmove', nearestEmptyInsertDetectEvent);\n  },\n  _offUpEvents: function _offUpEvents() {\n    var ownerDocument = this.el.ownerDocument;\n    off(ownerDocument, 'mouseup', this._onDrop);\n    off(ownerDocument, 'touchend', this._onDrop);\n    off(ownerDocument, 'pointerup', this._onDrop);\n    off(ownerDocument, 'touchcancel', this._onDrop);\n    off(document, 'selectstart', this);\n  },\n  _onDrop: function _onDrop( /**Event*/evt) {\n    var el = this.el,\n      options = this.options;\n\n    // Get the index of the dragged element within its parent\n    newIndex = index(dragEl);\n    newDraggableIndex = index(dragEl, options.draggable);\n    pluginEvent('drop', this, {\n      evt: evt\n    });\n    parentEl = dragEl && dragEl.parentNode;\n\n    // Get again after plugin event\n    newIndex = index(dragEl);\n    newDraggableIndex = index(dragEl, options.draggable);\n    if (Sortable.eventCanceled) {\n      this._nulling();\n      return;\n    }\n    awaitingDragStarted = false;\n    isCircumstantialInvert = false;\n    pastFirstInvertThresh = false;\n    clearInterval(this._loopId);\n    clearTimeout(this._dragStartTimer);\n    _cancelNextTick(this.cloneId);\n    _cancelNextTick(this._dragStartId);\n\n    // Unbind events\n    if (this.nativeDraggable) {\n      off(document, 'drop', this);\n      off(el, 'dragstart', this._onDragStart);\n    }\n    this._offMoveEvents();\n    this._offUpEvents();\n    if (Safari) {\n      css(document.body, 'user-select', '');\n    }\n    css(dragEl, 'transform', '');\n    if (evt) {\n      if (moved) {\n        evt.cancelable && evt.preventDefault();\n        !options.dropBubble && evt.stopPropagation();\n      }\n      ghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {\n        // Remove clone(s)\n        cloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n      }\n      if (dragEl) {\n        if (this.nativeDraggable) {\n          off(dragEl, 'dragend', this);\n        }\n        _disableDraggable(dragEl);\n        dragEl.style['will-change'] = '';\n\n        // Remove classes\n        // ghostClass is added in dragStarted\n        if (moved && !awaitingDragStarted) {\n          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);\n        }\n        toggleClass(dragEl, this.options.chosenClass, false);\n\n        // Drag stop event\n        _dispatchEvent({\n          sortable: this,\n          name: 'unchoose',\n          toEl: parentEl,\n          newIndex: null,\n          newDraggableIndex: null,\n          originalEvent: evt\n        });\n        if (rootEl !== parentEl) {\n          if (newIndex >= 0) {\n            // Add event\n            _dispatchEvent({\n              rootEl: parentEl,\n              name: 'add',\n              toEl: parentEl,\n              fromEl: rootEl,\n              originalEvent: evt\n            });\n\n            // Remove event\n            _dispatchEvent({\n              sortable: this,\n              name: 'remove',\n              toEl: parentEl,\n              originalEvent: evt\n            });\n\n            // drag from one list and drop into another\n            _dispatchEvent({\n              rootEl: parentEl,\n              name: 'sort',\n              toEl: parentEl,\n              fromEl: rootEl,\n              originalEvent: evt\n            });\n            _dispatchEvent({\n              sortable: this,\n              name: 'sort',\n              toEl: parentEl,\n              originalEvent: evt\n            });\n          }\n          putSortable && putSortable.save();\n        } else {\n          if (newIndex !== oldIndex) {\n            if (newIndex >= 0) {\n              // drag & drop within the same list\n              _dispatchEvent({\n                sortable: this,\n                name: 'update',\n                toEl: parentEl,\n                originalEvent: evt\n              });\n              _dispatchEvent({\n                sortable: this,\n                name: 'sort',\n                toEl: parentEl,\n                originalEvent: evt\n              });\n            }\n          }\n        }\n        if (Sortable.active) {\n          /* jshint eqnull:true */\n          if (newIndex == null || newIndex === -1) {\n            newIndex = oldIndex;\n            newDraggableIndex = oldDraggableIndex;\n          }\n          _dispatchEvent({\n            sortable: this,\n            name: 'end',\n            toEl: parentEl,\n            originalEvent: evt\n          });\n\n          // Save sorting\n          this.save();\n        }\n      }\n    }\n    this._nulling();\n  },\n  _nulling: function _nulling() {\n    pluginEvent('nulling', this);\n    rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = lastDownEl = cloneHidden = tapEvt = touchEvt = moved = newIndex = newDraggableIndex = oldIndex = oldDraggableIndex = lastTarget = lastDirection = putSortable = activeGroup = Sortable.dragged = Sortable.ghost = Sortable.clone = Sortable.active = null;\n    savedInputChecked.forEach(function (el) {\n      el.checked = true;\n    });\n    savedInputChecked.length = lastDx = lastDy = 0;\n  },\n  handleEvent: function handleEvent( /**Event*/evt) {\n    switch (evt.type) {\n      case 'drop':\n      case 'dragend':\n        this._onDrop(evt);\n        break;\n      case 'dragenter':\n      case 'dragover':\n        if (dragEl) {\n          this._onDragOver(evt);\n          _globalDragOver(evt);\n        }\n        break;\n      case 'selectstart':\n        evt.preventDefault();\n        break;\n    }\n  },\n  /**\r\n   * Serializes the item into an array of string.\r\n   * @returns {String[]}\r\n   */\n  toArray: function toArray() {\n    var order = [],\n      el,\n      children = this.el.children,\n      i = 0,\n      n = children.length,\n      options = this.options;\n    for (; i < n; i++) {\n      el = children[i];\n      if (closest(el, options.draggable, this.el, false)) {\n        order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n      }\n    }\n    return order;\n  },\n  /**\r\n   * Sorts the elements according to the array.\r\n   * @param  {String[]}  order  order of the items\r\n   */\n  sort: function sort(order, useAnimation) {\n    var items = {},\n      rootEl = this.el;\n    this.toArray().forEach(function (id, i) {\n      var el = rootEl.children[i];\n      if (closest(el, this.options.draggable, rootEl, false)) {\n        items[id] = el;\n      }\n    }, this);\n    useAnimation && this.captureAnimationState();\n    order.forEach(function (id) {\n      if (items[id]) {\n        rootEl.removeChild(items[id]);\n        rootEl.appendChild(items[id]);\n      }\n    });\n    useAnimation && this.animateAll();\n  },\n  /**\r\n   * Save the current sorting\r\n   */\n  save: function save() {\n    var store = this.options.store;\n    store && store.set && store.set(this);\n  },\n  /**\r\n   * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\r\n   * @param   {HTMLElement}  el\r\n   * @param   {String}       [selector]  default: `options.draggable`\r\n   * @returns {HTMLElement|null}\r\n   */\n  closest: function closest$1(el, selector) {\n    return closest(el, selector || this.options.draggable, this.el, false);\n  },\n  /**\r\n   * Set/get option\r\n   * @param   {string} name\r\n   * @param   {*}      [value]\r\n   * @returns {*}\r\n   */\n  option: function option(name, value) {\n    var options = this.options;\n    if (value === void 0) {\n      return options[name];\n    } else {\n      var modifiedValue = PluginManager.modifyOption(this, name, value);\n      if (typeof modifiedValue !== 'undefined') {\n        options[name] = modifiedValue;\n      } else {\n        options[name] = value;\n      }\n      if (name === 'group') {\n        _prepareGroup(options);\n      }\n    }\n  },\n  /**\r\n   * Destroy\r\n   */\n  destroy: function destroy() {\n    pluginEvent('destroy', this);\n    var el = this.el;\n    el[expando] = null;\n    off(el, 'mousedown', this._onTapStart);\n    off(el, 'touchstart', this._onTapStart);\n    off(el, 'pointerdown', this._onTapStart);\n    if (this.nativeDraggable) {\n      off(el, 'dragover', this);\n      off(el, 'dragenter', this);\n    }\n    // Remove draggable attributes\n    Array.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n      el.removeAttribute('draggable');\n    });\n    this._onDrop();\n    this._disableDelayedDragEvents();\n    sortables.splice(sortables.indexOf(this.el), 1);\n    this.el = el = null;\n  },\n  _hideClone: function _hideClone() {\n    if (!cloneHidden) {\n      pluginEvent('hideClone', this);\n      if (Sortable.eventCanceled) return;\n      css(cloneEl, 'display', 'none');\n      if (this.options.removeCloneOnHide && cloneEl.parentNode) {\n        cloneEl.parentNode.removeChild(cloneEl);\n      }\n      cloneHidden = true;\n    }\n  },\n  _showClone: function _showClone(putSortable) {\n    if (putSortable.lastPutMode !== 'clone') {\n      this._hideClone();\n      return;\n    }\n    if (cloneHidden) {\n      pluginEvent('showClone', this);\n      if (Sortable.eventCanceled) return;\n\n      // show clone at dragEl or original position\n      if (dragEl.parentNode == rootEl && !this.options.group.revertClone) {\n        rootEl.insertBefore(cloneEl, dragEl);\n      } else if (nextEl) {\n        rootEl.insertBefore(cloneEl, nextEl);\n      } else {\n        rootEl.appendChild(cloneEl);\n      }\n      if (this.options.group.revertClone) {\n        this.animate(dragEl, cloneEl);\n      }\n      css(cloneEl, 'display', '');\n      cloneHidden = false;\n    }\n  }\n};\nfunction _globalDragOver( /**Event*/evt) {\n  if (evt.dataTransfer) {\n    evt.dataTransfer.dropEffect = 'move';\n  }\n  evt.cancelable && evt.preventDefault();\n}\nfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvent, willInsertAfter) {\n  var evt,\n    sortable = fromEl[expando],\n    onMoveFn = sortable.options.onMove,\n    retVal;\n  // Support for new CustomEvent feature\n  if (window.CustomEvent && !IE11OrLess && !Edge) {\n    evt = new CustomEvent('move', {\n      bubbles: true,\n      cancelable: true\n    });\n  } else {\n    evt = document.createEvent('Event');\n    evt.initEvent('move', true, true);\n  }\n  evt.to = toEl;\n  evt.from = fromEl;\n  evt.dragged = dragEl;\n  evt.draggedRect = dragRect;\n  evt.related = targetEl || toEl;\n  evt.relatedRect = targetRect || getRect(toEl);\n  evt.willInsertAfter = willInsertAfter;\n  evt.originalEvent = originalEvent;\n  fromEl.dispatchEvent(evt);\n  if (onMoveFn) {\n    retVal = onMoveFn.call(sortable, evt, originalEvent);\n  }\n  return retVal;\n}\nfunction _disableDraggable(el) {\n  el.draggable = false;\n}\nfunction _unsilent() {\n  _silent = false;\n}\nfunction _ghostIsFirst(evt, vertical, sortable) {\n  var firstElRect = getRect(getChild(sortable.el, 0, sortable.options, true));\n  var childContainingRect = getChildContainingRectFromElement(sortable.el, sortable.options, ghostEl);\n  var spacer = 10;\n  return vertical ? evt.clientX < childContainingRect.left - spacer || evt.clientY < firstElRect.top && evt.clientX < firstElRect.right : evt.clientY < childContainingRect.top - spacer || evt.clientY < firstElRect.bottom && evt.clientX < firstElRect.left;\n}\nfunction _ghostIsLast(evt, vertical, sortable) {\n  var lastElRect = getRect(lastChild(sortable.el, sortable.options.draggable));\n  var childContainingRect = getChildContainingRectFromElement(sortable.el, sortable.options, ghostEl);\n  var spacer = 10;\n  return vertical ? evt.clientX > childContainingRect.right + spacer || evt.clientY > lastElRect.bottom && evt.clientX > lastElRect.left : evt.clientY > childContainingRect.bottom + spacer || evt.clientX > lastElRect.right && evt.clientY > lastElRect.top;\n}\nfunction _getSwapDirection(evt, target, targetRect, vertical, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {\n  var mouseOnAxis = vertical ? evt.clientY : evt.clientX,\n    targetLength = vertical ? targetRect.height : targetRect.width,\n    targetS1 = vertical ? targetRect.top : targetRect.left,\n    targetS2 = vertical ? targetRect.bottom : targetRect.right,\n    invert = false;\n  if (!invertSwap) {\n    // Never invert or create dragEl shadow when target movemenet causes mouse to move past the end of regular swapThreshold\n    if (isLastTarget && targetMoveDistance < targetLength * swapThreshold) {\n      // multiplied only by swapThreshold because mouse will already be inside target by (1 - threshold) * targetLength / 2\n      // check if past first invert threshold on side opposite of lastDirection\n      if (!pastFirstInvertThresh && (lastDirection === 1 ? mouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2 : mouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2)) {\n        // past first invert threshold, do not restrict inverted threshold to dragEl shadow\n        pastFirstInvertThresh = true;\n      }\n      if (!pastFirstInvertThresh) {\n        // dragEl shadow (target move distance shadow)\n        if (lastDirection === 1 ? mouseOnAxis < targetS1 + targetMoveDistance // over dragEl shadow\n        : mouseOnAxis > targetS2 - targetMoveDistance) {\n          return -lastDirection;\n        }\n      } else {\n        invert = true;\n      }\n    } else {\n      // Regular\n      if (mouseOnAxis > targetS1 + targetLength * (1 - swapThreshold) / 2 && mouseOnAxis < targetS2 - targetLength * (1 - swapThreshold) / 2) {\n        return _getInsertDirection(target);\n      }\n    }\n  }\n  invert = invert || invertSwap;\n  if (invert) {\n    // Invert of regular\n    if (mouseOnAxis < targetS1 + targetLength * invertedSwapThreshold / 2 || mouseOnAxis > targetS2 - targetLength * invertedSwapThreshold / 2) {\n      return mouseOnAxis > targetS1 + targetLength / 2 ? 1 : -1;\n    }\n  }\n  return 0;\n}\n\n/**\r\n * Gets the direction dragEl must be swapped relative to target in order to make it\r\n * seem that dragEl has been \"inserted\" into that element's position\r\n * @param  {HTMLElement} target       The target whose position dragEl is being inserted at\r\n * @return {Number}                   Direction dragEl must be swapped\r\n */\nfunction _getInsertDirection(target) {\n  if (index(dragEl) < index(target)) {\n    return 1;\n  } else {\n    return -1;\n  }\n}\n\n/**\r\n * Generate id\r\n * @param   {HTMLElement} el\r\n * @returns {String}\r\n * @private\r\n */\nfunction _generateId(el) {\n  var str = el.tagName + el.className + el.src + el.href + el.textContent,\n    i = str.length,\n    sum = 0;\n  while (i--) {\n    sum += str.charCodeAt(i);\n  }\n  return sum.toString(36);\n}\nfunction _saveInputCheckedState(root) {\n  savedInputChecked.length = 0;\n  var inputs = root.getElementsByTagName('input');\n  var idx = inputs.length;\n  while (idx--) {\n    var el = inputs[idx];\n    el.checked && savedInputChecked.push(el);\n  }\n}\nfunction _nextTick(fn) {\n  return setTimeout(fn, 0);\n}\nfunction _cancelNextTick(id) {\n  return clearTimeout(id);\n}\n\n// Fixed #973:\nif (documentExists) {\n  on(document, 'touchmove', function (evt) {\n    if ((Sortable.active || awaitingDragStarted) && evt.cancelable) {\n      evt.preventDefault();\n    }\n  });\n}\n\n// Export utils\nSortable.utils = {\n  on: on,\n  off: off,\n  css: css,\n  find: find,\n  is: function is(el, selector) {\n    return !!closest(el, selector, el, false);\n  },\n  extend: extend,\n  throttle: throttle,\n  closest: closest,\n  toggleClass: toggleClass,\n  clone: clone,\n  index: index,\n  nextTick: _nextTick,\n  cancelNextTick: _cancelNextTick,\n  detectDirection: _detectDirection,\n  getChild: getChild,\n  expando: expando\n};\n\n/**\r\n * Get the Sortable instance of an element\r\n * @param  {HTMLElement} element The element\r\n * @return {Sortable|undefined}         The instance of Sortable\r\n */\nSortable.get = function (element) {\n  return element[expando];\n};\n\n/**\r\n * Mount a plugin to Sortable\r\n * @param  {...SortablePlugin|SortablePlugin[]} plugins       Plugins being mounted\r\n */\nSortable.mount = function () {\n  for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n    plugins[_key] = arguments[_key];\n  }\n  if (plugins[0].constructor === Array) plugins = plugins[0];\n  plugins.forEach(function (plugin) {\n    if (!plugin.prototype || !plugin.prototype.constructor) {\n      throw \"Sortable: Mounted plugin must be a constructor function, not \".concat({}.toString.call(plugin));\n    }\n    if (plugin.utils) Sortable.utils = _objectSpread2(_objectSpread2({}, Sortable.utils), plugin.utils);\n    PluginManager.mount(plugin);\n  });\n};\n\n/**\r\n * Create sortable instance\r\n * @param {HTMLElement}  el\r\n * @param {Object}      [options]\r\n */\nSortable.create = function (el, options) {\n  return new Sortable(el, options);\n};\n\n// Export\nSortable.version = version;\n\nvar autoScrolls = [],\n  scrollEl,\n  scrollRootEl,\n  scrolling = false,\n  lastAutoScrollX,\n  lastAutoScrollY,\n  touchEvt$1,\n  pointerElemChangedInterval;\nfunction AutoScrollPlugin() {\n  function AutoScroll() {\n    this.defaults = {\n      scroll: true,\n      forceAutoScrollFallback: false,\n      scrollSensitivity: 30,\n      scrollSpeed: 10,\n      bubbleScroll: true\n    };\n\n    // Bind all private methods\n    for (var fn in this) {\n      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n        this[fn] = this[fn].bind(this);\n      }\n    }\n  }\n  AutoScroll.prototype = {\n    dragStarted: function dragStarted(_ref) {\n      var originalEvent = _ref.originalEvent;\n      if (this.sortable.nativeDraggable) {\n        on(document, 'dragover', this._handleAutoScroll);\n      } else {\n        if (this.options.supportPointer) {\n          on(document, 'pointermove', this._handleFallbackAutoScroll);\n        } else if (originalEvent.touches) {\n          on(document, 'touchmove', this._handleFallbackAutoScroll);\n        } else {\n          on(document, 'mousemove', this._handleFallbackAutoScroll);\n        }\n      }\n    },\n    dragOverCompleted: function dragOverCompleted(_ref2) {\n      var originalEvent = _ref2.originalEvent;\n      // For when bubbling is canceled and using fallback (fallback 'touchmove' always reached)\n      if (!this.options.dragOverBubble && !originalEvent.rootEl) {\n        this._handleAutoScroll(originalEvent);\n      }\n    },\n    drop: function drop() {\n      if (this.sortable.nativeDraggable) {\n        off(document, 'dragover', this._handleAutoScroll);\n      } else {\n        off(document, 'pointermove', this._handleFallbackAutoScroll);\n        off(document, 'touchmove', this._handleFallbackAutoScroll);\n        off(document, 'mousemove', this._handleFallbackAutoScroll);\n      }\n      clearPointerElemChangedInterval();\n      clearAutoScrolls();\n      cancelThrottle();\n    },\n    nulling: function nulling() {\n      touchEvt$1 = scrollRootEl = scrollEl = scrolling = pointerElemChangedInterval = lastAutoScrollX = lastAutoScrollY = null;\n      autoScrolls.length = 0;\n    },\n    _handleFallbackAutoScroll: function _handleFallbackAutoScroll(evt) {\n      this._handleAutoScroll(evt, true);\n    },\n    _handleAutoScroll: function _handleAutoScroll(evt, fallback) {\n      var _this = this;\n      var x = (evt.touches ? evt.touches[0] : evt).clientX,\n        y = (evt.touches ? evt.touches[0] : evt).clientY,\n        elem = document.elementFromPoint(x, y);\n      touchEvt$1 = evt;\n\n      // IE does not seem to have native autoscroll,\n      // Edge's autoscroll seems too conditional,\n      // MACOS Safari does not have autoscroll,\n      // Firefox and Chrome are good\n      if (fallback || this.options.forceAutoScrollFallback || Edge || IE11OrLess || Safari) {\n        autoScroll(evt, this.options, elem, fallback);\n\n        // Listener for pointer element change\n        var ogElemScroller = getParentAutoScrollElement(elem, true);\n        if (scrolling && (!pointerElemChangedInterval || x !== lastAutoScrollX || y !== lastAutoScrollY)) {\n          pointerElemChangedInterval && clearPointerElemChangedInterval();\n          // Detect for pointer elem change, emulating native DnD behaviour\n          pointerElemChangedInterval = setInterval(function () {\n            var newElem = getParentAutoScrollElement(document.elementFromPoint(x, y), true);\n            if (newElem !== ogElemScroller) {\n              ogElemScroller = newElem;\n              clearAutoScrolls();\n            }\n            autoScroll(evt, _this.options, newElem, fallback);\n          }, 10);\n          lastAutoScrollX = x;\n          lastAutoScrollY = y;\n        }\n      } else {\n        // if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\n        if (!this.options.bubbleScroll || getParentAutoScrollElement(elem, true) === getWindowScrollingElement()) {\n          clearAutoScrolls();\n          return;\n        }\n        autoScroll(evt, this.options, getParentAutoScrollElement(elem, false), false);\n      }\n    }\n  };\n  return _extends(AutoScroll, {\n    pluginName: 'scroll',\n    initializeByDefault: true\n  });\n}\nfunction clearAutoScrolls() {\n  autoScrolls.forEach(function (autoScroll) {\n    clearInterval(autoScroll.pid);\n  });\n  autoScrolls = [];\n}\nfunction clearPointerElemChangedInterval() {\n  clearInterval(pointerElemChangedInterval);\n}\nvar autoScroll = throttle(function (evt, options, rootEl, isFallback) {\n  // Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n  if (!options.scroll) return;\n  var x = (evt.touches ? evt.touches[0] : evt).clientX,\n    y = (evt.touches ? evt.touches[0] : evt).clientY,\n    sens = options.scrollSensitivity,\n    speed = options.scrollSpeed,\n    winScroller = getWindowScrollingElement();\n  var scrollThisInstance = false,\n    scrollCustomFn;\n\n  // New scroll root, set scrollEl\n  if (scrollRootEl !== rootEl) {\n    scrollRootEl = rootEl;\n    clearAutoScrolls();\n    scrollEl = options.scroll;\n    scrollCustomFn = options.scrollFn;\n    if (scrollEl === true) {\n      scrollEl = getParentAutoScrollElement(rootEl, true);\n    }\n  }\n  var layersOut = 0;\n  var currentParent = scrollEl;\n  do {\n    var el = currentParent,\n      rect = getRect(el),\n      top = rect.top,\n      bottom = rect.bottom,\n      left = rect.left,\n      right = rect.right,\n      width = rect.width,\n      height = rect.height,\n      canScrollX = void 0,\n      canScrollY = void 0,\n      scrollWidth = el.scrollWidth,\n      scrollHeight = el.scrollHeight,\n      elCSS = css(el),\n      scrollPosX = el.scrollLeft,\n      scrollPosY = el.scrollTop;\n    if (el === winScroller) {\n      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll' || elCSS.overflowX === 'visible');\n      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll' || elCSS.overflowY === 'visible');\n    } else {\n      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll');\n      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll');\n    }\n    var vx = canScrollX && (Math.abs(right - x) <= sens && scrollPosX + width < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);\n    var vy = canScrollY && (Math.abs(bottom - y) <= sens && scrollPosY + height < scrollHeight) - (Math.abs(top - y) <= sens && !!scrollPosY);\n    if (!autoScrolls[layersOut]) {\n      for (var i = 0; i <= layersOut; i++) {\n        if (!autoScrolls[i]) {\n          autoScrolls[i] = {};\n        }\n      }\n    }\n    if (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\n      autoScrolls[layersOut].el = el;\n      autoScrolls[layersOut].vx = vx;\n      autoScrolls[layersOut].vy = vy;\n      clearInterval(autoScrolls[layersOut].pid);\n      if (vx != 0 || vy != 0) {\n        scrollThisInstance = true;\n        /* jshint loopfunc:true */\n        autoScrolls[layersOut].pid = setInterval(function () {\n          // emulate drag over during autoscroll (fallback), emulating native DnD behaviour\n          if (isFallback && this.layer === 0) {\n            Sortable.active._onTouchMove(touchEvt$1); // To move ghost if it is positioned absolutely\n          }\n          var scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\n          var scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\n          if (typeof scrollCustomFn === 'function') {\n            if (scrollCustomFn.call(Sortable.dragged.parentNode[expando], scrollOffsetX, scrollOffsetY, evt, touchEvt$1, autoScrolls[this.layer].el) !== 'continue') {\n              return;\n            }\n          }\n          scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);\n        }.bind({\n          layer: layersOut\n        }), 24);\n      }\n    }\n    layersOut++;\n  } while (options.bubbleScroll && currentParent !== winScroller && (currentParent = getParentAutoScrollElement(currentParent, false)));\n  scrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\n}, 30);\n\nvar drop = function drop(_ref) {\n  var originalEvent = _ref.originalEvent,\n    putSortable = _ref.putSortable,\n    dragEl = _ref.dragEl,\n    activeSortable = _ref.activeSortable,\n    dispatchSortableEvent = _ref.dispatchSortableEvent,\n    hideGhostForTarget = _ref.hideGhostForTarget,\n    unhideGhostForTarget = _ref.unhideGhostForTarget;\n  if (!originalEvent) return;\n  var toSortable = putSortable || activeSortable;\n  hideGhostForTarget();\n  var touch = originalEvent.changedTouches && originalEvent.changedTouches.length ? originalEvent.changedTouches[0] : originalEvent;\n  var target = document.elementFromPoint(touch.clientX, touch.clientY);\n  unhideGhostForTarget();\n  if (toSortable && !toSortable.el.contains(target)) {\n    dispatchSortableEvent('spill');\n    this.onSpill({\n      dragEl: dragEl,\n      putSortable: putSortable\n    });\n  }\n};\nfunction Revert() {}\nRevert.prototype = {\n  startIndex: null,\n  dragStart: function dragStart(_ref2) {\n    var oldDraggableIndex = _ref2.oldDraggableIndex;\n    this.startIndex = oldDraggableIndex;\n  },\n  onSpill: function onSpill(_ref3) {\n    var dragEl = _ref3.dragEl,\n      putSortable = _ref3.putSortable;\n    this.sortable.captureAnimationState();\n    if (putSortable) {\n      putSortable.captureAnimationState();\n    }\n    var nextSibling = getChild(this.sortable.el, this.startIndex, this.options);\n    if (nextSibling) {\n      this.sortable.el.insertBefore(dragEl, nextSibling);\n    } else {\n      this.sortable.el.appendChild(dragEl);\n    }\n    this.sortable.animateAll();\n    if (putSortable) {\n      putSortable.animateAll();\n    }\n  },\n  drop: drop\n};\n_extends(Revert, {\n  pluginName: 'revertOnSpill'\n});\nfunction Remove() {}\nRemove.prototype = {\n  onSpill: function onSpill(_ref4) {\n    var dragEl = _ref4.dragEl,\n      putSortable = _ref4.putSortable;\n    var parentSortable = putSortable || this.sortable;\n    parentSortable.captureAnimationState();\n    dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\n    parentSortable.animateAll();\n  },\n  drop: drop\n};\n_extends(Remove, {\n  pluginName: 'removeOnSpill'\n});\n\nvar lastSwapEl;\nfunction SwapPlugin() {\n  function Swap() {\n    this.defaults = {\n      swapClass: 'sortable-swap-highlight'\n    };\n  }\n  Swap.prototype = {\n    dragStart: function dragStart(_ref) {\n      var dragEl = _ref.dragEl;\n      lastSwapEl = dragEl;\n    },\n    dragOverValid: function dragOverValid(_ref2) {\n      var completed = _ref2.completed,\n        target = _ref2.target,\n        onMove = _ref2.onMove,\n        activeSortable = _ref2.activeSortable,\n        changed = _ref2.changed,\n        cancel = _ref2.cancel;\n      if (!activeSortable.options.swap) return;\n      var el = this.sortable.el,\n        options = this.options;\n      if (target && target !== el) {\n        var prevSwapEl = lastSwapEl;\n        if (onMove(target) !== false) {\n          toggleClass(target, options.swapClass, true);\n          lastSwapEl = target;\n        } else {\n          lastSwapEl = null;\n        }\n        if (prevSwapEl && prevSwapEl !== lastSwapEl) {\n          toggleClass(prevSwapEl, options.swapClass, false);\n        }\n      }\n      changed();\n      completed(true);\n      cancel();\n    },\n    drop: function drop(_ref3) {\n      var activeSortable = _ref3.activeSortable,\n        putSortable = _ref3.putSortable,\n        dragEl = _ref3.dragEl;\n      var toSortable = putSortable || this.sortable;\n      var options = this.options;\n      lastSwapEl && toggleClass(lastSwapEl, options.swapClass, false);\n      if (lastSwapEl && (options.swap || putSortable && putSortable.options.swap)) {\n        if (dragEl !== lastSwapEl) {\n          toSortable.captureAnimationState();\n          if (toSortable !== activeSortable) activeSortable.captureAnimationState();\n          swapNodes(dragEl, lastSwapEl);\n          toSortable.animateAll();\n          if (toSortable !== activeSortable) activeSortable.animateAll();\n        }\n      }\n    },\n    nulling: function nulling() {\n      lastSwapEl = null;\n    }\n  };\n  return _extends(Swap, {\n    pluginName: 'swap',\n    eventProperties: function eventProperties() {\n      return {\n        swapItem: lastSwapEl\n      };\n    }\n  });\n}\nfunction swapNodes(n1, n2) {\n  var p1 = n1.parentNode,\n    p2 = n2.parentNode,\n    i1,\n    i2;\n  if (!p1 || !p2 || p1.isEqualNode(n2) || p2.isEqualNode(n1)) return;\n  i1 = index(n1);\n  i2 = index(n2);\n  if (p1.isEqualNode(p2) && i1 < i2) {\n    i2++;\n  }\n  p1.insertBefore(n2, p1.children[i1]);\n  p2.insertBefore(n1, p2.children[i2]);\n}\n\nvar multiDragElements = [],\n  multiDragClones = [],\n  lastMultiDragSelect,\n  // for selection with modifier key down (SHIFT)\n  multiDragSortable,\n  initialFolding = false,\n  // Initial multi-drag fold when drag started\n  folding = false,\n  // Folding any other time\n  dragStarted = false,\n  dragEl$1,\n  clonesFromRect,\n  clonesHidden;\nfunction MultiDragPlugin() {\n  function MultiDrag(sortable) {\n    // Bind all private methods\n    for (var fn in this) {\n      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n        this[fn] = this[fn].bind(this);\n      }\n    }\n    if (!sortable.options.avoidImplicitDeselect) {\n      if (sortable.options.supportPointer) {\n        on(document, 'pointerup', this._deselectMultiDrag);\n      } else {\n        on(document, 'mouseup', this._deselectMultiDrag);\n        on(document, 'touchend', this._deselectMultiDrag);\n      }\n    }\n    on(document, 'keydown', this._checkKeyDown);\n    on(document, 'keyup', this._checkKeyUp);\n    this.defaults = {\n      selectedClass: 'sortable-selected',\n      multiDragKey: null,\n      avoidImplicitDeselect: false,\n      setData: function setData(dataTransfer, dragEl) {\n        var data = '';\n        if (multiDragElements.length && multiDragSortable === sortable) {\n          multiDragElements.forEach(function (multiDragElement, i) {\n            data += (!i ? '' : ', ') + multiDragElement.textContent;\n          });\n        } else {\n          data = dragEl.textContent;\n        }\n        dataTransfer.setData('Text', data);\n      }\n    };\n  }\n  MultiDrag.prototype = {\n    multiDragKeyDown: false,\n    isMultiDrag: false,\n    delayStartGlobal: function delayStartGlobal(_ref) {\n      var dragged = _ref.dragEl;\n      dragEl$1 = dragged;\n    },\n    delayEnded: function delayEnded() {\n      this.isMultiDrag = ~multiDragElements.indexOf(dragEl$1);\n    },\n    setupClone: function setupClone(_ref2) {\n      var sortable = _ref2.sortable,\n        cancel = _ref2.cancel;\n      if (!this.isMultiDrag) return;\n      for (var i = 0; i < multiDragElements.length; i++) {\n        multiDragClones.push(clone(multiDragElements[i]));\n        multiDragClones[i].sortableIndex = multiDragElements[i].sortableIndex;\n        multiDragClones[i].draggable = false;\n        multiDragClones[i].style['will-change'] = '';\n        toggleClass(multiDragClones[i], this.options.selectedClass, false);\n        multiDragElements[i] === dragEl$1 && toggleClass(multiDragClones[i], this.options.chosenClass, false);\n      }\n      sortable._hideClone();\n      cancel();\n    },\n    clone: function clone(_ref3) {\n      var sortable = _ref3.sortable,\n        rootEl = _ref3.rootEl,\n        dispatchSortableEvent = _ref3.dispatchSortableEvent,\n        cancel = _ref3.cancel;\n      if (!this.isMultiDrag) return;\n      if (!this.options.removeCloneOnHide) {\n        if (multiDragElements.length && multiDragSortable === sortable) {\n          insertMultiDragClones(true, rootEl);\n          dispatchSortableEvent('clone');\n          cancel();\n        }\n      }\n    },\n    showClone: function showClone(_ref4) {\n      var cloneNowShown = _ref4.cloneNowShown,\n        rootEl = _ref4.rootEl,\n        cancel = _ref4.cancel;\n      if (!this.isMultiDrag) return;\n      insertMultiDragClones(false, rootEl);\n      multiDragClones.forEach(function (clone) {\n        css(clone, 'display', '');\n      });\n      cloneNowShown();\n      clonesHidden = false;\n      cancel();\n    },\n    hideClone: function hideClone(_ref5) {\n      var _this = this;\n      var sortable = _ref5.sortable,\n        cloneNowHidden = _ref5.cloneNowHidden,\n        cancel = _ref5.cancel;\n      if (!this.isMultiDrag) return;\n      multiDragClones.forEach(function (clone) {\n        css(clone, 'display', 'none');\n        if (_this.options.removeCloneOnHide && clone.parentNode) {\n          clone.parentNode.removeChild(clone);\n        }\n      });\n      cloneNowHidden();\n      clonesHidden = true;\n      cancel();\n    },\n    dragStartGlobal: function dragStartGlobal(_ref6) {\n      var sortable = _ref6.sortable;\n      if (!this.isMultiDrag && multiDragSortable) {\n        multiDragSortable.multiDrag._deselectMultiDrag();\n      }\n      multiDragElements.forEach(function (multiDragElement) {\n        multiDragElement.sortableIndex = index(multiDragElement);\n      });\n\n      // Sort multi-drag elements\n      multiDragElements = multiDragElements.sort(function (a, b) {\n        return a.sortableIndex - b.sortableIndex;\n      });\n      dragStarted = true;\n    },\n    dragStarted: function dragStarted(_ref7) {\n      var _this2 = this;\n      var sortable = _ref7.sortable;\n      if (!this.isMultiDrag) return;\n      if (this.options.sort) {\n        // Capture rects,\n        // hide multi drag elements (by positioning them absolute),\n        // set multi drag elements rects to dragRect,\n        // show multi drag elements,\n        // animate to rects,\n        // unset rects & remove from DOM\n\n        sortable.captureAnimationState();\n        if (this.options.animation) {\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            css(multiDragElement, 'position', 'absolute');\n          });\n          var dragRect = getRect(dragEl$1, false, true, true);\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            setRect(multiDragElement, dragRect);\n          });\n          folding = true;\n          initialFolding = true;\n        }\n      }\n      sortable.animateAll(function () {\n        folding = false;\n        initialFolding = false;\n        if (_this2.options.animation) {\n          multiDragElements.forEach(function (multiDragElement) {\n            unsetRect(multiDragElement);\n          });\n        }\n\n        // Remove all auxiliary multidrag items from el, if sorting enabled\n        if (_this2.options.sort) {\n          removeMultiDragElements();\n        }\n      });\n    },\n    dragOver: function dragOver(_ref8) {\n      var target = _ref8.target,\n        completed = _ref8.completed,\n        cancel = _ref8.cancel;\n      if (folding && ~multiDragElements.indexOf(target)) {\n        completed(false);\n        cancel();\n      }\n    },\n    revert: function revert(_ref9) {\n      var fromSortable = _ref9.fromSortable,\n        rootEl = _ref9.rootEl,\n        sortable = _ref9.sortable,\n        dragRect = _ref9.dragRect;\n      if (multiDragElements.length > 1) {\n        // Setup unfold animation\n        multiDragElements.forEach(function (multiDragElement) {\n          sortable.addAnimationState({\n            target: multiDragElement,\n            rect: folding ? getRect(multiDragElement) : dragRect\n          });\n          unsetRect(multiDragElement);\n          multiDragElement.fromRect = dragRect;\n          fromSortable.removeAnimationState(multiDragElement);\n        });\n        folding = false;\n        insertMultiDragElements(!this.options.removeCloneOnHide, rootEl);\n      }\n    },\n    dragOverCompleted: function dragOverCompleted(_ref10) {\n      var sortable = _ref10.sortable,\n        isOwner = _ref10.isOwner,\n        insertion = _ref10.insertion,\n        activeSortable = _ref10.activeSortable,\n        parentEl = _ref10.parentEl,\n        putSortable = _ref10.putSortable;\n      var options = this.options;\n      if (insertion) {\n        // Clones must be hidden before folding animation to capture dragRectAbsolute properly\n        if (isOwner) {\n          activeSortable._hideClone();\n        }\n        initialFolding = false;\n        // If leaving sort:false root, or already folding - Fold to new location\n        if (options.animation && multiDragElements.length > 1 && (folding || !isOwner && !activeSortable.options.sort && !putSortable)) {\n          // Fold: Set all multi drag elements's rects to dragEl's rect when multi-drag elements are invisible\n          var dragRectAbsolute = getRect(dragEl$1, false, true, true);\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            setRect(multiDragElement, dragRectAbsolute);\n\n            // Move element(s) to end of parentEl so that it does not interfere with multi-drag clones insertion if they are inserted\n            // while folding, and so that we can capture them again because old sortable will no longer be fromSortable\n            parentEl.appendChild(multiDragElement);\n          });\n          folding = true;\n        }\n\n        // Clones must be shown (and check to remove multi drags) after folding when interfering multiDragElements are moved out\n        if (!isOwner) {\n          // Only remove if not folding (folding will remove them anyways)\n          if (!folding) {\n            removeMultiDragElements();\n          }\n          if (multiDragElements.length > 1) {\n            var clonesHiddenBefore = clonesHidden;\n            activeSortable._showClone(sortable);\n\n            // Unfold animation for clones if showing from hidden\n            if (activeSortable.options.animation && !clonesHidden && clonesHiddenBefore) {\n              multiDragClones.forEach(function (clone) {\n                activeSortable.addAnimationState({\n                  target: clone,\n                  rect: clonesFromRect\n                });\n                clone.fromRect = clonesFromRect;\n                clone.thisAnimationDuration = null;\n              });\n            }\n          } else {\n            activeSortable._showClone(sortable);\n          }\n        }\n      }\n    },\n    dragOverAnimationCapture: function dragOverAnimationCapture(_ref11) {\n      var dragRect = _ref11.dragRect,\n        isOwner = _ref11.isOwner,\n        activeSortable = _ref11.activeSortable;\n      multiDragElements.forEach(function (multiDragElement) {\n        multiDragElement.thisAnimationDuration = null;\n      });\n      if (activeSortable.options.animation && !isOwner && activeSortable.multiDrag.isMultiDrag) {\n        clonesFromRect = _extends({}, dragRect);\n        var dragMatrix = matrix(dragEl$1, true);\n        clonesFromRect.top -= dragMatrix.f;\n        clonesFromRect.left -= dragMatrix.e;\n      }\n    },\n    dragOverAnimationComplete: function dragOverAnimationComplete() {\n      if (folding) {\n        folding = false;\n        removeMultiDragElements();\n      }\n    },\n    drop: function drop(_ref12) {\n      var evt = _ref12.originalEvent,\n        rootEl = _ref12.rootEl,\n        parentEl = _ref12.parentEl,\n        sortable = _ref12.sortable,\n        dispatchSortableEvent = _ref12.dispatchSortableEvent,\n        oldIndex = _ref12.oldIndex,\n        putSortable = _ref12.putSortable;\n      var toSortable = putSortable || this.sortable;\n      if (!evt) return;\n      var options = this.options,\n        children = parentEl.children;\n\n      // Multi-drag selection\n      if (!dragStarted) {\n        if (options.multiDragKey && !this.multiDragKeyDown) {\n          this._deselectMultiDrag();\n        }\n        toggleClass(dragEl$1, options.selectedClass, !~multiDragElements.indexOf(dragEl$1));\n        if (!~multiDragElements.indexOf(dragEl$1)) {\n          multiDragElements.push(dragEl$1);\n          dispatchEvent({\n            sortable: sortable,\n            rootEl: rootEl,\n            name: 'select',\n            targetEl: dragEl$1,\n            originalEvent: evt\n          });\n\n          // Modifier activated, select from last to dragEl\n          if (evt.shiftKey && lastMultiDragSelect && sortable.el.contains(lastMultiDragSelect)) {\n            var lastIndex = index(lastMultiDragSelect),\n              currentIndex = index(dragEl$1);\n            if (~lastIndex && ~currentIndex && lastIndex !== currentIndex) {\n              // Must include lastMultiDragSelect (select it), in case modified selection from no selection\n              // (but previous selection existed)\n              var n, i;\n              if (currentIndex > lastIndex) {\n                i = lastIndex;\n                n = currentIndex;\n              } else {\n                i = currentIndex;\n                n = lastIndex + 1;\n              }\n              for (; i < n; i++) {\n                if (~multiDragElements.indexOf(children[i])) continue;\n                toggleClass(children[i], options.selectedClass, true);\n                multiDragElements.push(children[i]);\n                dispatchEvent({\n                  sortable: sortable,\n                  rootEl: rootEl,\n                  name: 'select',\n                  targetEl: children[i],\n                  originalEvent: evt\n                });\n              }\n            }\n          } else {\n            lastMultiDragSelect = dragEl$1;\n          }\n          multiDragSortable = toSortable;\n        } else {\n          multiDragElements.splice(multiDragElements.indexOf(dragEl$1), 1);\n          lastMultiDragSelect = null;\n          dispatchEvent({\n            sortable: sortable,\n            rootEl: rootEl,\n            name: 'deselect',\n            targetEl: dragEl$1,\n            originalEvent: evt\n          });\n        }\n      }\n\n      // Multi-drag drop\n      if (dragStarted && this.isMultiDrag) {\n        folding = false;\n        // Do not \"unfold\" after around dragEl if reverted\n        if ((parentEl[expando].options.sort || parentEl !== rootEl) && multiDragElements.length > 1) {\n          var dragRect = getRect(dragEl$1),\n            multiDragIndex = index(dragEl$1, ':not(.' + this.options.selectedClass + ')');\n          if (!initialFolding && options.animation) dragEl$1.thisAnimationDuration = null;\n          toSortable.captureAnimationState();\n          if (!initialFolding) {\n            if (options.animation) {\n              dragEl$1.fromRect = dragRect;\n              multiDragElements.forEach(function (multiDragElement) {\n                multiDragElement.thisAnimationDuration = null;\n                if (multiDragElement !== dragEl$1) {\n                  var rect = folding ? getRect(multiDragElement) : dragRect;\n                  multiDragElement.fromRect = rect;\n\n                  // Prepare unfold animation\n                  toSortable.addAnimationState({\n                    target: multiDragElement,\n                    rect: rect\n                  });\n                }\n              });\n            }\n\n            // Multi drag elements are not necessarily removed from the DOM on drop, so to reinsert\n            // properly they must all be removed\n            removeMultiDragElements();\n            multiDragElements.forEach(function (multiDragElement) {\n              if (children[multiDragIndex]) {\n                parentEl.insertBefore(multiDragElement, children[multiDragIndex]);\n              } else {\n                parentEl.appendChild(multiDragElement);\n              }\n              multiDragIndex++;\n            });\n\n            // If initial folding is done, the elements may have changed position because they are now\n            // unfolding around dragEl, even though dragEl may not have his index changed, so update event\n            // must be fired here as Sortable will not.\n            if (oldIndex === index(dragEl$1)) {\n              var update = false;\n              multiDragElements.forEach(function (multiDragElement) {\n                if (multiDragElement.sortableIndex !== index(multiDragElement)) {\n                  update = true;\n                  return;\n                }\n              });\n              if (update) {\n                dispatchSortableEvent('update');\n                dispatchSortableEvent('sort');\n              }\n            }\n          }\n\n          // Must be done after capturing individual rects (scroll bar)\n          multiDragElements.forEach(function (multiDragElement) {\n            unsetRect(multiDragElement);\n          });\n          toSortable.animateAll();\n        }\n        multiDragSortable = toSortable;\n      }\n\n      // Remove clones if necessary\n      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {\n        multiDragClones.forEach(function (clone) {\n          clone.parentNode && clone.parentNode.removeChild(clone);\n        });\n      }\n    },\n    nullingGlobal: function nullingGlobal() {\n      this.isMultiDrag = dragStarted = false;\n      multiDragClones.length = 0;\n    },\n    destroyGlobal: function destroyGlobal() {\n      this._deselectMultiDrag();\n      off(document, 'pointerup', this._deselectMultiDrag);\n      off(document, 'mouseup', this._deselectMultiDrag);\n      off(document, 'touchend', this._deselectMultiDrag);\n      off(document, 'keydown', this._checkKeyDown);\n      off(document, 'keyup', this._checkKeyUp);\n    },\n    _deselectMultiDrag: function _deselectMultiDrag(evt) {\n      if (typeof dragStarted !== \"undefined\" && dragStarted) return;\n\n      // Only deselect if selection is in this sortable\n      if (multiDragSortable !== this.sortable) return;\n\n      // Only deselect if target is not item in this sortable\n      if (evt && closest(evt.target, this.options.draggable, this.sortable.el, false)) return;\n\n      // Only deselect if left click\n      if (evt && evt.button !== 0) return;\n      while (multiDragElements.length) {\n        var el = multiDragElements[0];\n        toggleClass(el, this.options.selectedClass, false);\n        multiDragElements.shift();\n        dispatchEvent({\n          sortable: this.sortable,\n          rootEl: this.sortable.el,\n          name: 'deselect',\n          targetEl: el,\n          originalEvent: evt\n        });\n      }\n    },\n    _checkKeyDown: function _checkKeyDown(evt) {\n      if (evt.key === this.options.multiDragKey) {\n        this.multiDragKeyDown = true;\n      }\n    },\n    _checkKeyUp: function _checkKeyUp(evt) {\n      if (evt.key === this.options.multiDragKey) {\n        this.multiDragKeyDown = false;\n      }\n    }\n  };\n  return _extends(MultiDrag, {\n    // Static methods & properties\n    pluginName: 'multiDrag',\n    utils: {\n      /**\r\n       * Selects the provided multi-drag item\r\n       * @param  {HTMLElement} el    The element to be selected\r\n       */\n      select: function select(el) {\n        var sortable = el.parentNode[expando];\n        if (!sortable || !sortable.options.multiDrag || ~multiDragElements.indexOf(el)) return;\n        if (multiDragSortable && multiDragSortable !== sortable) {\n          multiDragSortable.multiDrag._deselectMultiDrag();\n          multiDragSortable = sortable;\n        }\n        toggleClass(el, sortable.options.selectedClass, true);\n        multiDragElements.push(el);\n      },\n      /**\r\n       * Deselects the provided multi-drag item\r\n       * @param  {HTMLElement} el    The element to be deselected\r\n       */\n      deselect: function deselect(el) {\n        var sortable = el.parentNode[expando],\n          index = multiDragElements.indexOf(el);\n        if (!sortable || !sortable.options.multiDrag || !~index) return;\n        toggleClass(el, sortable.options.selectedClass, false);\n        multiDragElements.splice(index, 1);\n      }\n    },\n    eventProperties: function eventProperties() {\n      var _this3 = this;\n      var oldIndicies = [],\n        newIndicies = [];\n      multiDragElements.forEach(function (multiDragElement) {\n        oldIndicies.push({\n          multiDragElement: multiDragElement,\n          index: multiDragElement.sortableIndex\n        });\n\n        // multiDragElements will already be sorted if folding\n        var newIndex;\n        if (folding && multiDragElement !== dragEl$1) {\n          newIndex = -1;\n        } else if (folding) {\n          newIndex = index(multiDragElement, ':not(.' + _this3.options.selectedClass + ')');\n        } else {\n          newIndex = index(multiDragElement);\n        }\n        newIndicies.push({\n          multiDragElement: multiDragElement,\n          index: newIndex\n        });\n      });\n      return {\n        items: _toConsumableArray(multiDragElements),\n        clones: [].concat(multiDragClones),\n        oldIndicies: oldIndicies,\n        newIndicies: newIndicies\n      };\n    },\n    optionListeners: {\n      multiDragKey: function multiDragKey(key) {\n        key = key.toLowerCase();\n        if (key === 'ctrl') {\n          key = 'Control';\n        } else if (key.length > 1) {\n          key = key.charAt(0).toUpperCase() + key.substr(1);\n        }\n        return key;\n      }\n    }\n  });\n}\nfunction insertMultiDragElements(clonesInserted, rootEl) {\n  multiDragElements.forEach(function (multiDragElement, i) {\n    var target = rootEl.children[multiDragElement.sortableIndex + (clonesInserted ? Number(i) : 0)];\n    if (target) {\n      rootEl.insertBefore(multiDragElement, target);\n    } else {\n      rootEl.appendChild(multiDragElement);\n    }\n  });\n}\n\n/**\r\n * Insert multi-drag clones\r\n * @param  {[Boolean]} elementsInserted  Whether the multi-drag elements are inserted\r\n * @param  {HTMLElement} rootEl\r\n */\nfunction insertMultiDragClones(elementsInserted, rootEl) {\n  multiDragClones.forEach(function (clone, i) {\n    var target = rootEl.children[clone.sortableIndex + (elementsInserted ? Number(i) : 0)];\n    if (target) {\n      rootEl.insertBefore(clone, target);\n    } else {\n      rootEl.appendChild(clone);\n    }\n  });\n}\nfunction removeMultiDragElements() {\n  multiDragElements.forEach(function (multiDragElement) {\n    if (multiDragElement === dragEl$1) return;\n    multiDragElement.parentNode && multiDragElement.parentNode.removeChild(multiDragElement);\n  });\n}\n\nSortable.mount(new AutoScrollPlugin());\nSortable.mount(Remove, Revert);\n\nexport default Sortable;\nexport { MultiDragPlugin as MultiDrag, Sortable, SwapPlugin as Swap };\n","import Sortable from \"sortablejs\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\nvar LayerSwitcherDOM = {\n\n    /**\n     * Creation du drag and drop\n     *\n     * @param {Object} elementDraggable - Element HTML (DOM) Container\n     * @param {Object} context - this\n     */\n    _createDraggableElement : function (elementDraggable, context) {\n        // FIXME retirer cette détection user-agent pour solution propre\n        // option forcefallback pour réparer sortable sous Chrome 97\n        // option forcefallback casse le layerswitcher du portail sous firefox\n        let handleClass = \".GPlayerName\";\n        if (checkDsfr()) {\n            handleClass = \".GPlayerDragNDrop\";\n        }\n        if (navigator.userAgent.match(/chrome|chromium|crios/i)) {\n            Sortable.create(elementDraggable, {\n                handle : handleClass,\n                draggable : \".draggable-layer\",\n                ghostClass : \"GPghostLayer\",\n                animation : 200,\n                forceFallback : true,\n                // Call event function on drag and drop\n                onEnd : function (e) {\n                    // FIXME pas terrrible, mais il faut bien passer ce contexte...\n                    context._onEndDragAndDropLayerClick(e);\n                }\n            });\n        } else {\n            Sortable.create(elementDraggable, {\n                handle : handleClass,\n                draggable : \".draggable-layer\",\n                ghostClass : \"GPghostLayer\",\n                animation : 200,\n                // Call event function on drag and drop\n                onEnd : function (e) {\n                    // FIXME pas terrrible, mais il faut bien passer ce contexte...\n                    context._onEndDragAndDropLayerClick(e);\n                }\n            });\n        }\n    },\n\n    // ################################################################### //\n    // ######################### Main container ########################## //\n    // ################################################################### //\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Creation du container principal (DOM)\n     *\n     * @returns {DOMElement} container - layer switcher DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPlayerSwitcher\");\n        container.className = \"GPwidget gpf-widget gpf-mobile-fullscreen gpf-widget-button\";\n        return container;\n    },\n\n    /**\n     * Creation du container principal d\"affichage des layers (DOM)\n     *\n     * @returns {DOMElement} input - element for minimizing/maximizing the layer switcher\n     */\n    _createMainLayersShowElement : function () {\n        // <!-- Hidden checkbox for minimizing/maximizing -->\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowLayersList\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Creation du container principal des layers (DOM)\n     *\n     * @returns {DOMElement} container - layers list container\n     */\n    _createMainLayersElement : function () {\n        // ajout de la liste des layers dans le container principal\n        // <div id=\"GPlayersList\" class=\"GPpanel\">\n        //   (...)\n        // </div>\n        var dialog = document.createElement(\"dialog\");\n        dialog.id = this._addUID(\"GPlayersList\");\n        dialog.className = \"GPpanel gpf-panel fr-modal\";\n        return dialog;\n    },\n\n    _createMainLayersDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelBody gpf-panel__body_ls fr-modal__body\";\n        return div;\n    },\n\n    /**\n     * Creation du container du picto du controle (DOM)\n     *\n     * @returns {DOMElement} label\n     */\n    _createMainPictoElement : function () {\n        var self = this;\n\n        var button = document.createElement(\"button\");\n        // INFO: Ajout d'une SPAN pour enlever des marges de 6px dans CHROMIUM (?!)\n        var span = document.createElement(\"span\");\n        button.appendChild(span);\n        button.id = this._addUID(\"GPshowLayersListPicto\");\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowLayersListPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-layerswitcher fr-btn fr-btn--tertiary\";\n        button.htmlFor = this._addUID(\"GPshowLayersList\");\n        button.setAttribute(\"aria-label\", \"Afficher/masquer le gestionnaire de couches\");\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                document.getElementById(self._addUID(\"GPshowLayersList\")).checked = status;\n                if (document.getElementById(self._addUID(\"GPshowLayersList\")).checked) {\n                    document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.remove(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n                    document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n                }\n                self.onShowLayerSwitcherClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                if (document.getElementById(self._addUID(\"GPshowLayersList\")).checked) {\n                    document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.remove(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n                    document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n                }\n                self.onShowLayerSwitcherClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    _createMainCounterLayersElement : function () {\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPlayerCounter\");\n        span.className = \"GPlayerCounter\";\n        span.innerHTML = \"0\";\n        return span;\n    },\n\n    /**\n     * Creation du container du panneau d\"information (DOM)\n     *\n     * @returns {DOMElement} container\n     */\n    _createMainInfoElement : function () {\n        // gestion du panneau d\"information dans le container principal\n        // <div id=\"GPlayerInfoPanel\" class=\"GPlayerInfoPanelClosed\">...</div>\n        var divP = document.createElement(\"dialog\");\n        divP.id = this._addUID(\"GPlayerInfoPanel\");\n        divP.className = \"GPpanel GPlayerInfoPanelClosed gpf-panel fr-modal\";\n        return divP;\n    },\n\n    _createMainInfoDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"gpf-panel__body fr-modal__body\";\n        return div;\n    },\n\n    // ################################################################### //\n    // ######################### Layer container ######################### //\n    // ################################################################### //\n\n    _createLayersPanelHeaderElement : function () {\n        var container = document.createElement(\"div\");\n        // FIXME on n'utilise pas le dsfr !\n        // container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n        container.className = \"GPpanelHeader gpf-panel__header_ls\";\n        return container;\n    },\n    _createLayersPanelIconElement : function () {\n        var label = document.createElement(\"label\");\n        label.className = \"GPpanelIcon gpf-btn-header gpf-btn-icon-layers\";\n        label.title = \"Couches de données\";\n        return label;\n    },\n    _createLayersPanelTitleElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle gpf-panel__title_ls\";\n        div.id = this._addUID(\"GPlayersHeaderTitle\");\n        div.innerHTML = \"Couches de données\";\n        return div;\n    },\n    _createLayersPanelCloseElement : function () {\n        // contexte\n        var self = this;\n\n        var btnClose = document.createElement(\"button\");\n        btnClose.id = this._addUID(\"GPlayersPanelClose\");\n        btnClose.className = \"GPpanelClose GPlayersPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        btnClose.title = \"Fermer le panneau\";\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible fr-mx-1w\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        btnClose.appendChild(span);\n\n        // Link panel close / visibility checkbox\n        if (btnClose.addEventListener) {\n            btnClose.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPshowLayersListPicto\")).click();\n            }, false);\n        } else if (btnClose.attachEvent) {\n            btnClose.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPshowLayersListPicto\")).click();\n            });\n        }\n\n        return btnClose;\n    },\n\n    /**\n     * Creation du container du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @param {Object} obj.layer - couche (ol ou leaflet)\n     * @param {String} obj.id - identifiant de la couche (pour ol ou leaflet)\n     * @param {String} obj.title - nom de la couche à afficher dans le controle\n     * @param {String} obj.description - description de la couche à afficher\n     * @param {Boolean} obj.visibility - visibilité de la couche dans la carte (true or false)\n     * @param {Float} obj.opacity - opacité de la couche\n     * @param {String} obj.type - feature or vector\n     *\n     * @returns {DOMElement} container\n     */\n    _createContainerLayerElement : function (obj) {\n        // exemple :\n        // <div id=\"GPlayerSwitcher_ID_Layer1\" class=\"GPlayerSwitcher_layer outOfRange\">\n        //     <!-- Basic toolbar : visibility / layer name\n        //     _createBasicToolElement\n        //           _createBasicToolVisibilityElement\n        //           _createBasicToolNameElement\n        //     -->\n        //     <!-- Hidden checkbox + label for showing advanced toolbar\n        //     _createAdvancedToolShowElement\n        //     -->\n        //     <!-- Advanced toolbar : layer info / opacity slider / opacity value / removal\n        //     _createAdvancedToolElement\n        //           _createAdvancedToolDeleteElement\n        //           _createAdvancedToolInformationElement\n        //           _createAdvancedToolOpacityElement\n        //     -->\n        // </div>\n\n        // <!-- Layer entry in layer list -->\n        // <!-- Every item is marked with layerID, which is defined at layer import -->\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPlayerSwitcher_ID_\" + obj.id);\n        container.className = \"GPlayerSwitcher_layer gpf-panel__content fr-modal__content draggable-layer\";\n\n        // ajout des outils basiques (visibility / layer name)\n        container.appendChild(this._createBasicToolElement(obj));\n\n        // ajout bouton des outils avancés\n        container.appendChild(this._createAdvancedToolShowElement(obj));\n\n        // liste des outils avancés (layer info / opacity slider / opacity value / removal)\n        container.appendChild(this._createAdvancedToolElement(obj));\n\n        return container;\n    },\n\n    // ################################################################### //\n    // ############################ Layer tool ########################### //\n    // ################################################################### //\n\n    /**\n     * Creation du container des outils basiques du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement} container\n     */\n    _createBasicToolElement : function (obj) {\n        // exemple :\n        // <div id=\"GPbasicTools_ID_1\" class=\"GPlayerBasicTools\">\n        //      <!-- _createBasicToolVisibilityElement -->\n        //      <!-- _createBasicToolNameElement -->\n        // </div>\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPbasicTools_ID_\" + obj.id);\n        div.className = \"GPlayerBasicTools\";\n\n        div.appendChild(this._createBasicToolNameElement(obj));\n        div.appendChild(this._createBasicToolVisibilityElement(obj));\n        div.appendChild(this._createBasicToolDragNDropElement(obj));\n\n        return div;\n    },\n\n    _createBasicToolDragNDropElement : function (obj) {\n        // INFO inactif en mode classique !\n        var button = document.createElement(\"div\");\n        button.id = this._addUID(\"GPdragndropPicto_ID_\" + obj.id);\n        button.className = \"GPelementHidden GPlayerDragNDrop gpf-btn gpf-btn-icon gpf-btn-icon-ls-dragndrop gpf-btn--tertiary fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        button.title = \"Deplacer la couche\";\n        button.setAttribute(\"tabindex\", \"0\");\n\n        var self = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                self._onStartDragAndDropLayerClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                self._onStartDragAndDropLayerClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Creation du nom du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement} container\n     */\n    _createBasicToolNameElement : function (obj) {\n        // exemple :\n        // <span id=\"GPname_ID_Layer1\" class=\"GPlayerName\" title=\"Quartiers prioritaires de la ville\">Quartiers prioritaires de la ville</span>\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPname_ID_\" + obj.id);\n        label.className = \"GPlayerName gpf-label gpf-label-name fr-label\";\n        label.title = obj.description || obj.title;\n        label.innerHTML = obj.title;\n\n        return label;\n    },\n\n    /**\n     * Creation de l'icone de visibilité du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n\n     * @returns {DOMElement[]} array containing input and label elements\n     */\n    _createBasicToolVisibilityElement : function (obj) {\n        var visible = (typeof obj.visibility !== \"undefined\") ? obj.visibility : true;\n\n        var button = document.createElement(\"button\");\n        button.id = this._addUID(\"GPvisibilityPicto_ID_\" + obj.id);\n        button.className = \"GPlayerVisibility gpf-btn gpf-btn-icon gpf-btn-icon-ls-visibility fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        button.title = \"Afficher/masquer la couche\";\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", visible);\n        button.setAttribute(\"type\",\"button\");\n\n        var context = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context._onVisibilityLayerClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context._onVisibilityLayerClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Creation de l'affichage du menu des outils avancés du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement[]} array containing input and label elements\n     */\n    _createAdvancedToolShowElement : function (obj) {\n        var button = document.createElement(\"button\");\n        button.id = this._addUID(\"GPshowAdvancedTools_ID_\" + obj.id);\n\n        button.className = \"GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowLayerAdvancedTools gpf-btn gpf-btn-icon gpf-btn-icon-ls-collapse fr-btn--sm fr-btn--tertiary gpf-btn--tertiary\";\n        button.title = \"Plus d'outils\";\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\",\"button\");\n\n        var self = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                var element = document.getElementById(self._addUID(\"GPadvancedTools_ID_\" + obj.id));\n                if (status) {\n                    element.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                    element.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n                } else {\n                    element.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                    element.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n                }\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                element.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                element.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Creation du container des outils avancés du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolElement : function (obj) {\n        // exemple :\n        // <div id=\"GPadvancedTools_ID_Layer1\" class=\"GPlayerAdvancedTools\">\n        //     <!-- _createAdvancedToolDeleteElement -->\n        //     <!-- _createAdvancedToolInformationElement -->\n        //     <!-- _createAdvancedToolOpacityElement -->\n        // </div>\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPadvancedTools_ID_\" + obj.id);\n        container.className = \"GPelementHidden GPlayerAdvancedTools gpf-hidden\";\n\n        container.appendChild(this._createAdvancedToolDeleteElement(obj));\n        if (checkDsfr()) {\n            container.appendChild(this._createAdvancedToolEditionElement(obj));\n        }\n        container.appendChild(this._createAdvancedToolInformationElement(obj));\n\n        var array = this._createAdvancedToolOpacityElement(obj);\n        for (var i = 0; i < array.length; i++) {\n            container.appendChild(array[i]);\n        }\n\n        container.appendChild(this._createAdvancedToolExtentElement(obj));\n        container.appendChild(this._createAdvancedToolGreyscaleElement(obj));\n\n        if (checkDsfr()) {\n            var btn = document.createElement(\"button\");\n            btn.className = \"GPlayerAdvancedToolsContextual fr-btn gpf-btn gpf-btn--tertiary fr-btn--tertiary-no-outline\";\n            btn.setAttribute(\"aria-pressed\", false);\n            if (btn.addEventListener) {\n                btn.addEventListener(\"click\", function (e) {\n                    var status = (e.target.ariaPressed === \"true\");\n                    e.target.setAttribute(\"aria-pressed\", !status);\n                });\n            } else if (btn.attachEvent) {\n                btn.attachEvent(\"onclick\", function (e) {\n                    var status = (e.target.ariaPressed === \"true\");\n                    e.target.setAttribute(\"aria-pressed\", !status);\n                });\n            }\n\n            var contextual = document.createElement(\"div\");\n            contextual.appendChild(this._createAdvancedToolDeleteElement(obj, true));\n            contextual.appendChild(this._createAdvancedToolInformationElement(obj, true));\n            contextual.appendChild(this._createAdvancedToolExtentElement(obj, true));\n            contextual.appendChild(this._createAdvancedToolGreyscaleElement(obj, true));\n\n            container.appendChild(btn);\n            container.appendChild(contextual);\n        }\n        return container;\n    },\n\n    /**\n     * Creation de l'icone de suppression du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @param {Boolean} contextual - est-ce que le bouton est dans le menu contextuel ? Default false\n     *\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolDeleteElement : function (obj, contextual = false) {\n        var button = document.createElement(\"button\");\n        if (!contextual) {\n            button.id = this._addUID(\"GPremove_ID_\" + obj.id);\n        } else {\n            button.id = this._addUID(\"GPremoveContextual_ID_\" + obj.id);\n        }\n        button.className = \"GPlayerRemove gpf-btn gpf-btn-icon gpf-btn-icon-ls-remove fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        button.title = \"Supprimer la couche\";\n        button.layerId = obj.id;\n        if (contextual) {\n            button.innerText = \"Supprimer\";\n        }\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"type\", \"button\");\n\n        var context = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                context._onDropLayerClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                context._onDropLayerClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Creation de l'icone d'edition du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolEditionElement : function (obj) {\n        var button = document.createElement(\"button\");\n        button.id = this._addUID(\"GPedit_ID_\" + obj.id);\n        button.className = \"GPlayerEdit gpf-btn gpf-btn-icon gpf-btn-icon-ls-edit fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        button.title = \"Editer la couche\";\n        button.layerId = obj.id;\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"type\", \"button\");\n\n        // hack pour garder un emplacement vide\n        if (obj.type !== \"feature\") {\n            button.style.opacity = \"0\";\n            button.style.visibility = \"hidden\";\n        }\n\n        var context = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                context._onEditLayerClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                context._onEditLayerClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Creation de l'icone d'information du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @param {Boolean} contextual - est-ce que le bouton est dans le menu contextuel ? Default false\n     *\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolInformationElement : function (obj, contextual = false) {\n        // exemple :\n        // <div id=\"GPinfo_ID_Layer1\" class=\"GPlayerInfo\" title=\"Informations/légende\" onclick=\"GPopenLayerInfo(this);\"></div>\n\n        var btnInfo = document.createElement(\"button\");\n        if (!contextual) {\n            btnInfo.id = this._addUID(\"GPinfo_ID_\" + obj.id);\n        } else {\n            btnInfo.id = this._addUID(\"GPinfoContextual_ID_\" + obj.id);\n        }\n        btnInfo.className = \"GPlayerInfo GPlayerInfoClosed gpf-btn gpf-btn-icon gpf-btn-icon-ls-info fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        // hack pour garder un emplacement vide\n        if (!obj.title || !obj.description) {\n            btnInfo.style.opacity = \"0\";\n            btnInfo.style.visibility = \"hidden\";\n            if (contextual) {\n                btnInfo.style.display = \"none\";\n            }\n        }\n        btnInfo.title = \"Informations/légende\";\n        btnInfo.layerId = obj.id;\n        if (contextual) {\n            btnInfo.innerText = \"Informations\";\n        }\n        btnInfo.setAttribute(\"tabindex\", \"0\");\n        btnInfo.setAttribute(\"type\", \"button\");\n\n        // add event on click\n        var context = this;\n        if (btnInfo.addEventListener) {\n            btnInfo.addEventListener(\n                \"click\",\n                function (e) {\n                    context._onOpenLayerInfoClick(e);\n                }\n            );\n        } else if (btnInfo.attachEvent) {\n            // internet explorer\n            btnInfo.attachEvent(\n                \"onclick\",\n                function (e) {\n                    context._onOpenLayerInfoClick(e);\n                }\n            );\n        }\n\n        return btnInfo;\n    },\n\n    /**\n     * Creation de l'icone de n&b du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @param {Boolean} contextual - est-ce que le bouton est dans le menu contextuel ? Default false\n     *\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolGreyscaleElement : function (obj, contextual = false) {\n        // exemple :\n        // <div id=\"GPgreyscale_ID_Layer1\" class=\"GPlayerBreyscale\" title=\"Noir & blanc\" onclick=\"GPtoggleGreyscale(this);\"></div>\n\n        var btnGreyscale = document.createElement(\"button\");\n        if (!contextual) {\n            btnGreyscale.id = this._addUID(\"GPgreyscale_ID_\" + obj.id);\n        } else {\n            btnGreyscale.id = this._addUID(\"GPgreyscaleContextual_ID_\" + obj.id);\n        }\n        btnGreyscale.className = \"GPelementHidden GPlayerGreyscale GPlayerGreyscaleOff gpf-btn gpf-btn-icon gpf-btn-icon-ls-greyscale fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        btnGreyscale.title = \"Noir et blanc\";\n        btnGreyscale.layerId = obj.id;\n        if (contextual) {\n            btnGreyscale.innerText = \"N&B\";\n        }\n        btnGreyscale.setAttribute(\"tabindex\", \"0\");\n        btnGreyscale.setAttribute(\"type\", \"button\");\n\n        // add event on click\n        var context = this;\n        if (btnGreyscale.addEventListener) {\n            btnGreyscale.addEventListener(\n                \"click\",\n                function (e) {\n                    context._onToggleLayerGreyscaleClick(e);\n                }\n            );\n        } else if (btnGreyscale.attachEvent) {\n            // internet explorer\n            btnGreyscale.attachEvent(\n                \"onclick\",\n                function (e) {\n                    context._onToggleLayerGreyscaleClick(e);\n                }\n            );\n        }\n\n        return btnGreyscale;\n    },\n\n    /**\n     * Creation de l'icone de gestion de l'opacité du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement[]} array of two containers\n     */\n    _createAdvancedToolOpacityElement : function (obj) {\n        // exemple :\n        // <div id=\"GPopacity_ID_Layer1\" class=\"GPlayerOpacity\" title=\"Opacité\">\n        //   <input id=\"GPopacityRange_ID_Layer1\" type=\"range\" value=\"100\" oninput=\"GPchangeLayerOpacity(this);\" onchange=\"GPchangeLayerOpacity(this);\">\n        // </div>\n        // <div class=\"GPlayerOpacityValue\" id=\"GPopacityValueDiv_ID_Layer1\">\n        //   <span id=\"GPopacityValue_ID_Layer1\">100</span>\n        //   %\n        // </div>\n\n        var list = [];\n\n        // curseur pour changer l'opacité\n        var divO = document.createElement(\"div\");\n        divO.id = this._addUID(\"GPopacity_ID_\" + obj.id);\n        divO.className = \"GPlayerOpacity fr-range fr-range--sm\";\n        // For DSFR\n        divO.dataset.frJsRange = \"true\";\n        divO.title = \"Opacité\";\n\n        var opacity = (typeof obj.opacity !== \"undefined\") ? obj.opacity : 1;\n        opacity = Math.round(opacity * 100);\n        divO.style.setProperty(\"--progress-right\", opacity + \"%\");\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPopacityValueDiv_ID_\" + obj.id);\n        input.type = \"range\";\n        input.value = opacity;\n        input.ariaLabel = \"Opacité\";\n\n        // add event for opacity change\n        var context = this;\n        if (input.addEventListener) {\n            input.addEventListener(\n                \"change\",\n                function (e) {\n                    context._onChangeLayerOpacity(e);\n                }\n            );\n        } else if (input.attachEvent) {\n            // internet explorer\n            input.attachEvent(\n                \"onchange\",\n                function (e) {\n                    context._onChangeLayerOpacity(e);\n                }\n            );\n        }\n\n        if (input.addEventListener) {\n            input.addEventListener(\n                \"input\",\n                function (e) {\n                    context._onChangeLayerOpacity(e);\n                }\n            );\n        } else if (input.attachEvent) {\n            // internet explorer\n            input.attachEvent(\n                \"oninput\",\n                function (e) {\n                    context._onChangeLayerOpacity(e);\n                }\n            );\n        }\n\n        divO.appendChild(input);\n\n        // Valeur d'opacité\n        var divC = document.createElement(\"div\");\n        divC.id = this._addUID(\"GPopacityValueDiv_ID_\" + obj.id);\n        divC.className = \"GPlayerOpacityValue\";\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPopacityValue_ID_\" + obj.id);\n        span.className = \"gpf-range__output fr-range__output gpf-visible\";\n        span.innerHTML = opacity + \"%\";\n\n        divC.appendChild(span);\n\n        list.push(divO);\n        list.push(divC);\n\n        return list;\n    },\n\n    /**\n     * Creation de l'icone de zoom sur extent (DOM)\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     * @param {Boolean} contextual - est-ce que le bouton est dans le menu contextuel ? Default false\n     *\n     * @returns {DOMElement} container\n     */\n    _createAdvancedToolExtentElement : function (obj, contextual = false) {\n        // FIXME inactif en mode classique !\n        var button = document.createElement(\"button\");\n        if (!contextual) {\n            button.id = this._addUID(\"GPextent_ID_\" + obj.id);\n        } else {\n            button.id = this._addUID(\"GPextentContextual_ID_\" + obj.id);\n        }\n        button.className = \"GPelementHidden GPlayerExtent gpf-btn gpf-btn-icon gpf-btn-icon-ls-extent fr-btn fr-btn--tertiary gpf-btn--tertiary\";\n        button.title = \"Zoomer dans l'étendue\";\n        button.layerId = obj.id;\n        if (contextual) {\n            button.innerText = \"Zoomer\";\n        }\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", true);\n        button.setAttribute(\"type\", \"button\");\n\n        var context = this;\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context._onZoomToExtentClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context._onZoomToExtentClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    // ################################################################### //\n    // ############################ Layer info ########################### //\n    // ################################################################### //\n\n    /**\n     * Creation du container du layer info (DOM)\n     *\n     * TODO GPlayerInfoPopup : ???\n     * TODO GPlayerInfoLink  : mettre en forme les échelles !\n     *\n     * @param {Object} obj - options de la couche à ajouter dans le layer switcher\n     *\n     * @returns {DOMElement} container\n     */\n    _createContainerLayerInfoElement : function (obj) {\n        var container = document.createElement(\"div\");\n\n        var header = document.createElement(\"div\");\n        // FIXME on n'utilise pas le dsfr !\n        // container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n        header.className = \"gpf-panel__header_ls\";\n        container.appendChild(header);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPlayerInfo gpf-btn-header gpf-btn-icon-ls-info\";\n        label.title = \"Informations\";\n        header.appendChild(label);\n\n        var title = document.createElement(\"div\");\n        title.id = this._addUID(\"GPlayerInfoTitle\");\n        title.innerHTML = obj.title;\n        title.className = \"gpf-panel__title_ls\";\n        header.appendChild(title);\n\n        var btnClose = document.createElement(\"button\");\n        btnClose.id = this._addUID(\"GPlayerInfoClose\");\n        btnClose.className = \"GPpanelClose GPlayersPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        btnClose.title = \"Fermer la fenêtre\";\n\n        var self = this;\n        /** Call event function on close click */\n        var onCloseClick = function () {\n            document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n            document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.remove(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n            document.getElementById(obj.id).classList.add(\"GPlayerInfoClosed\");\n            document.getElementById(obj.id).classList.remove(\"GPlayerInfoOpened\");\n        };\n        if (btnClose.addEventListener) {\n            btnClose.addEventListener(\"click\", onCloseClick);\n        } else if (btnClose.attachEvent) {\n            // internet explorer\n            btnClose.attachEvent(\"onclick\", onCloseClick);\n        }\n        this.addEventListener(\"layerswitcher:remove\", (e) => {\n            if (parseInt(obj.id.split(\"-\")[0].split(\"GPinfo_ID_\")[1]) === e.layer.id) {\n                document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n                document.getElementById(self._addUID(\"GPlayerInfoPanel\")).classList.remove(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n            }\n        });\n        header.appendChild(btnClose);\n        container.appendChild(header);\n\n        var content = document.createElement(\"div\");\n        content.id = this._addUID(\"GPlayerInfoContent\");\n        content.className = \"gpf-panel__content fr-modal__content\";\n        container.appendChild(content);\n\n        if (obj.quicklookUrl) {\n            var quick = document.createElement(\"div\");\n            quick.id = this._addUID(\"GPlayerInfoQuicklook\");\n            quick.title = \"Afficher un aperçu de la couche\";\n            var refquick = document.createElement(\"a\");\n            refquick.href = obj.quicklookUrl;\n            refquick.appendChild(quick);\n            content.appendChild(refquick);\n        }\n\n        var desc = document.createElement(\"div\");\n        desc.id = this._addUID(\"GPlayerInfoDescription\");\n        desc.innerHTML = obj.description;\n        content.appendChild(desc);\n\n        if (obj.metadata) {\n            var mtd = document.createElement(\"div\");\n            mtd.id = this._addUID(\"GPlayerInfoMetadata\");\n\n            var mtdtitle = document.createElement(\"div\");\n            mtdtitle.className = \"GPlayerInfoSubtitle\";\n            mtdtitle.innerHTML = \"Métadonnées\";\n            mtd.appendChild(mtdtitle);\n\n            for (var i = 0; i < obj.metadata.length; i++) {\n                var urlmtd = obj.metadata[i].url;\n\n                var mtdlink = document.createElement(\"div\");\n                mtdlink.className = \"GPlayerInfoLink\";\n\n                var refmtd = document.createElement(\"a\");\n                refmtd.href = urlmtd;\n                refmtd.innerHTML = urlmtd;\n                mtdlink.appendChild(refmtd);\n                mtd.appendChild(mtdlink);\n            }\n\n            if (obj.metadata.length !== 0) {\n                content.appendChild(mtd);\n            }\n        }\n\n        if (obj.legends) {\n            var lgd = document.createElement(\"div\");\n            lgd.id = this._addUID(\"GPlayerInfoLegend\");\n\n            var lgdtitle = document.createElement(\"div\");\n            lgdtitle.className = \"GPlayerInfoSubtitle\";\n            lgdtitle.innerHTML = \"Légende\";\n            lgd.appendChild(lgdtitle);\n\n            var legends = {};\n            var maxScale = obj.maxScaleDenominator || 560000000;\n\n            // on crée un tableau temporaire pour ordonner les légendes selon le dénominateur d'échelle\n            for (var k = 0; k < obj.legends.length; k++) {\n                var minScale = obj.legends[k].minScaleDenominator;\n                if (minScale) {\n                    var s = minScale.toString();\n                    minScale = Math.round(parseInt(s.substring(0, 3), 10) / 10) * Math.pow(10, s.length - 2);\n                } else {\n                    minScale = 270;\n                }\n                legends[minScale] = obj.legends[k];\n            }\n\n            for (var scale in legends) {\n                if (legends.hasOwnProperty(scale)) {\n                    var urllgd = legends[scale].url;\n                    // on n'affiche pas les légendes pointant vers \"nolegend.jpg\"\n                    if (typeof urllgd === \"string\" && urllgd.toLowerCase().indexOf(\"nolegend.jpg\") === -1) {\n                        // TODO GPlayerInfoPopup\n                        var lgdlink = document.createElement(\"div\");\n                        lgdlink.className = \"GPlayerInfoLink\";\n\n                        maxScale = legends[scale].maxScaleDenominator || maxScale;\n\n                        var reflgd = document.createElement(\"a\");\n                        reflgd.className = \"fr-link\";\n                        reflgd.href = urllgd;\n                        reflgd.target = \"_blank\";\n                        reflgd.innerHTML = \"Du 1/\" + scale + \" au 1/\" + maxScale;\n                        lgdlink.appendChild(reflgd);\n                        lgd.appendChild(lgdlink);\n                    } else {\n                        delete legends[scale];\n                    }\n                }\n            }\n\n            if (Object.keys(legends).length !== 0) {\n                content.appendChild(lgd);\n            }\n        }\n\n        return container;\n    }\n};\n\nexport default LayerSwitcherDOM;\n","// import CSS\nimport \"../../CSS/Controls/LayerSwitcher/GPFlayerSwitcher.css\";\n// import \"../../CSS/Controls/LayerSwitcher/GPFlayerSwitcherStyle.css\";\n// import OpenLayers\n// import Control from \"ol/control/Control\";\nimport Widget from \"../Widget\";\nimport Control from \"../Control\";\nimport ImageWMSSource from \"ol/source/ImageWMS\";\nimport WMTSSource from \"ol/source/WMTS\";\nimport TileWMSSource from \"ol/source/TileWMS\";\nimport { unByKey as olObservableUnByKey } from \"ol/Observable\";\nimport { intersects as olIntersects } from \"ol/extent\";\nimport {\n    transformExtent as olTransformExtentProj\n} from \"ol/proj\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorTileLayer from \"ol/layer/VectorTile\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport SelectorID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Config from \"../../Utils/Config\";\n// DOM\nimport LayerSwitcherDOM from \"./LayerSwitcherDOM\";\n\nvar logger = Logger.getLogger(\"layerswitcher\");\n\n/**\n * @classdesc\n * OpenLayers Control to manage map layers : their order, visibility and opacity, and display their informations (title, description, legends, metadata...)\n *\n * @constructor\n * @extends {ol.control.Control}\n * @alias ol.control.LayerSwitcher\n * @type {ol.control.LayerSwitcher}\n * @param {Object} options - control options\n * @param {Array} [options.layers] - list of layers to be configured. Each array element is an object, with following properties :\n * @param {ol.layer.Layer} [options.layers.layer] - ol.layer.Layer layer to be configured (that has been added to map)\n * @param {Object} [options.layers.config] - custom configuration object for layer information (title, description, legends, metadata, quicklook url), with following properties :\n * @param {String} [options.layers.config.title] - layer alias, to be displayed in widget layer list. E.g. : \"Cartes IGN\"\n * @param {String} [options.layers.config.description] - layer description, to be displayed on title hover, or in layer information panel.\n * @param {String} [options.layers.config.quicklookUrl] - link to a quick look image for this layer.\n * @param {Array} [options.layers.config.legends] - array of layer legends. Each array element is an object, with following properties :\n *      - url (String, mandatory) : link to a legend\n *      - minScaleDenominator (Number, optional) : min scale denominator for legend validity.\n * @param {Array} [options.layers.config.metadata] - array of layer metadata. Each array element is an object, with property url (String, mandatory) : link to a metadata\n * @param {Object} [options.options] - ol.control.Control options (see {@link http://openlayers.org/en/latest/apidoc/ol.control.Control.html ol.control.Control})\n * @param {Number} [options.options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {Boolean} [options.options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Boolean} [options.options.panel = false] - Specify if widget has to have a panel header. Default is false.\n * @param {Boolean} [options.options.counter = false] - Specify if widget has to have a counter. Default is false.\n * @param {Boolean} [options.options.allowEdit = false] - Specify if widget has to have an edit button. Default is false.\n * @fires layerswitcher:add\n * @fires layerswitcher:remove\n * @fires layerswitcher:extent\n * @fires layerswitcher:edit\n * @fires layerswitcher:change:opacity\n * @fires layerswitcher:change:visibility\n * @fires layerswitcher:change:position\n * @example\n * map.addControl(new ol.control.LayerSwitcher(\n *  [\n *      {\n *          layer : wms1,\n *          config : {\n *              title : \"test layer name 1\",\n *              description : \"test layer desc 1\",\n *          }\n *      }\n *  ],\n *  {\n *      collapsed : true,\n *      panel : false,\n *      counter : false,\n *      position : \"top-left\",\n *      allowEdit : true\n *  }\n * ));\n *\n * LayerSwitcher.on(\"layerswitcher:add\", function (e) {\n *    console.warn(\"layer\", e.layer);\n * });\n * LayerSwitcher.on(\"layerswitcher:remove\", function (e) {\n *    console.warn(\"layer\", e.layer);\n * });\n * LayerSwitcher.on(\"layerswitcher:extent\", function (e) {\n *    console.warn(\"layer\", e.layer);\n * });\n * LayerSwitcher.on(\"layerswitcher:edit\", function (e) {\n *    console.warn(\"layer\", e.layer);\n * });\n * LayerSwitcher.on(\"layerswitcher:change:opacity\", function (e) {\n *    console.warn(\"layer\", e.layer, e.opacity);\n * });\n * LayerSwitcher.on(\"layerswitcher:change:visibility\", function (e) {\n *    console.warn(\"layer\", e.layer, e.visibility);\n * });\n * LayerSwitcher.on(\"layerswitcher:change:position\", function (e) {\n *    console.warn(\"layer\", e.layer, e.position);\n * });\n *\n */\nvar LayerSwitcher = class LayerSwitcher extends Control {\n\n    /**\n     * See {@link ol.control.LayerSwitcher}\n     * @module LayerSwitcher\n     * @alias module:~controls/LayerSwitcher\n     * @param {*} options - options\n     * @example\n     * import LayerSwitcher from \"gpf-ext-ol/controls/LayerSwitcher\"\n     * ou\n     * import { LayerSwitcher } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {};\n        var _options = options.options || {};\n        var _layers = options.layers || [];\n\n        // call ol.control.Control constructor\n        super(_options);\n\n        if (!(this instanceof LayerSwitcher)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        if (!Array.isArray(_layers)) {\n            throw new Error(\"ERROR WRONG_TYPE : layers should be an array\");\n        }\n\n        if (typeof _options !== \"object\") {\n            throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n        }\n\n        /**\n         * Nom de la classe\n         * @private\n         */\n        this.CLASSNAME = \"LayerSwitcher\";\n\n        this._initialize(_options, _layers);\n\n        this.container = this._initContainer(_options);\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this.container) : this.element = this.container;\n\n        return this;\n    }\n\n    // ################################################################### //\n    // ############## public methods (getters, setters) ################## //\n    // ################################################################### //\n\n    /**\n     * Overload setMap function, that enables to catch map events, such as movend events.\n     *\n     * @param {ol.Map} map - Map.\n     */\n    setMap (map) {\n        // info : cette méthode est appelée (entre autres?) après un map.addControl() ou map.removeControl()\n\n        if (map) { // dans le cas de l'ajout du contrôle à la map\n            // on ajoute les couches\n            this._addMapLayers(map);\n\n            // mode \"collapsed\"\n            if (!this.collapsed) {\n                this._showLayerSwitcherButton.setAttribute(\"aria-pressed\", true);\n            }\n\n            // At every map movement, layer switcher may be updated,\n            // according to layers on map, and their range.\n            this._listeners.onMoveListener = map.on(\n                \"moveend\",\n                () => this._onMapMoveEnd(map)\n            );\n\n            // add event listeners when a new layer is added to map, to add it in LayerSwitcher control (and DOM)\n            this._listeners.onAddListener = map.getLayers().on(\n                \"add\",\n                (evt) => {\n                    var layer = evt.element;\n                    var id;\n                    // on attribue un nouvel identifiant à cette couche,\n                    // sauf si c'est une couche qui a déjà été ajoutée dans le LayerSwitcher au préalable (si gpLayerId existe)\n                    if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                        id = this._layerId;\n                        layer.gpLayerId = id;\n                        this._layerId++;\n                    } else {\n                        id = layer.gpLayerId;\n                    }\n                    if (!this._layers[id]) {\n                        this.addLayer(layer);\n                    }\n                }\n            );\n\n            // add event listeners when a layer is removed from map, to remove it from LayerSwitcher control (and DOM)\n            this._listeners.onRemoveListener = map.getLayers().on(\n                \"remove\",\n                (evt) => {\n                    var layer = evt.element;\n                    var id = layer.gpLayerId;\n                    if (this._layers[id]) {\n                        this.removeLayer(layer);\n                    }\n                }\n            );\n        } else {\n            // we are in a setMap(null) case\n            // we forget the listeners linked to the layerSwitcher\n            olObservableUnByKey(this._listeners.onMoveListener);\n            olObservableUnByKey(this._listeners.onAddListener);\n            olObservableUnByKey(this._listeners.onRemoveListener);\n\n            // we put all the layers at Zindex = 0, without changing the visual order\n            // in order that the next added layers are not hidden by layers with Zindex > 0\n            for (var i = this._layersOrder.length - 1; i >= 0; i--) {\n                // this._layersOrder[i].layer.setZIndex(0);\n            }\n        }\n\n        // on appelle la méthode setMap originale d'OpenLayers\n        super.setMap(map);\n\n        // position\n        if (this.options.position) {\n            this.setPosition(this.options.position);\n        }\n\n        // reunion du bouton avec le précédent\n        if (this.options.gutter === false) {\n            this.getContainer().classList.add(\"gpf-button-no-gutter\");\n        }\n    }\n\n    /**\n     * Add a new layer to control (when added to map) or add new layer configuration\n     *\n     * @param {ol.layer.Layer} layer - layer to add to layer switcher\n     * @param {Object} [config] - additional options for layer configuration\n     * @param {Object} [config.title] - layer title (default is layer identifier)\n     * @param {Object} [config.description] - layer description (default is null)\n     * @param {Object} [config.legends] - layer legends (default is an empty array)\n     * @param {Object} [config.metadata] - layer metadata (default is an empty array)\n     * @param {Object} [config.quicklookUrl] - layer quicklookUrl (default is null)\n     * @fires layerswitcher:add\n     * @example\n     *   layerSwitcher.addLayer(\n     *       gpParcels,\n     *       {\n     *           title : \"Parcelles cadastrales\",\n     *           description : \"description de la couche\",\n     *           quicklookUrl : \"http://quicklookUrl.fr\"\n     *       }\n     *   )\n     */\n    addLayer (layer, config) {\n        var map = this.getMap();\n        config = config || {};\n\n        if (!layer) {\n            logger.log(\"[ERROR] LayerSwitcher:addLayer - missing layer parameter\");\n            return;\n        }\n\n        var id = layer.gpLayerId;\n        if (typeof id === \"undefined\") {\n            logger.trace(\"[WARN] LayerSwitcher:addLayer - configuration cannot be set for this layer (layer id not found)\", layer);\n            return;\n        }\n\n        // make sure layer is in map layers\n        var isLayerInMap = false;\n        map.getLayers().forEach(\n            (lyr) => {\n                if (lyr.gpLayerId === id) {\n                    isLayerInMap = true;\n                }\n            }\n        );\n        if (!isLayerInMap) {\n            logger.log(\"[ERROR] LayerSwitcher:addLayer - configuration cannot be set for \", layer, \" layer (layer is not in map.getLayers() )\");\n            return;\n        }\n\n        // if layer is not already in layers list, add it to control (layers list and container div)\n        if (!this._layers[id]) {\n            // 1. add layer to layers list\n            var layerInfos = this.getLayerInfo(layer) || {};\n            var opacity = layer.getOpacity();\n            var visibility = layer.getVisible();\n            var isInRange = this.isInRange(layer, map);\n            var layerOptions = {\n                layer : layer,\n                id : id,\n                name : layer.name, // only geoportal layers\n                service : layer.service, // only geoportal layers\n                type : \"\", // only geoportal website : ie 'feature'\n                opacity : opacity != null ? opacity : 1,\n                visibility : visibility != null ? visibility : true,\n                inRange : isInRange != null ? isInRange : true,\n                title : config.title != null ? config.title : (layerInfos._title || id),\n                description : config.description || layerInfos._description || null,\n                legends : config.legends || layerInfos._legends || [],\n                metadata : config.metadata || layerInfos._metadata || [],\n                quicklookUrl : config.quicklookUrl || layerInfos._quicklookUrl || null\n            };\n            this._layers[id] = layerOptions;\n\n            // 2. create layer div (to be added to control main container)\n            // Création de la div correspondante à cette couche\n            var layerDiv = this._createLayerDiv(layerOptions);\n            // on stocke la div dans les options de la couche, pour une éventuelle réorganisation (setZIndex par ex)\n            this._layers[id].div = layerDiv;\n\n            // 3. réorganisation des couches si un zIndex est spécifié\n            // FIXME :\n            //  _forceNullzIndex !?\n            //  getZIndex() retourne undefined au lieu de 0 !?\n            if ((layer.getZIndex && layer.getZIndex() !== 0 && typeof layer.getZIndex() !== \"undefined\") || layer._forceNullzIndex) {\n                // réorganisation des couches si un zIndex est spécifié\n                this._updateLayersOrder();\n            } else {\n                // sinon on ajoute la couche au dessus des autres\n                this._layersOrder.unshift(layerOptions);\n                this._lastZIndex++;\n                layer.setZIndex(this._lastZIndex);\n                this._layerListContainer.insertBefore(layerDiv, this._layerListContainer.firstChild);\n                // this._layerListContainer.insertBefore(layerDiv,\n                //     (this.options.panel) ?\n                //         this._layerListContainer.childNodes[1] : this._layerListContainer.firstChild);\n            }\n\n            // 3. Add listeners for opacity and visibility changes\n            this._listeners.updateLayerOpacity = layer.on(\n                \"change:opacity\",\n                (e) => this._updateLayerOpacity(e)\n            );\n            this._listeners.updateLayerVisibility = layer.on(\n                \"change:visible\",\n                (e) => this._updateLayerVisibility(e)\n            );\n\n            if (this._layers[id].onZIndexChangeEvent == null) {\n                this._layers[id].onZIndexChangeEvent = layer.on(\n                    \"change:zIndex\",\n                    () => this._updateLayersOrder()\n                );\n            }\n\n            // user may also add a new configuration for an already added layer\n        } else {\n            // add new configuration parameters to layer informations\n            for (var prop in config) {\n                if (config.hasOwnProperty(prop)) {\n                    this._layers[id][prop] = config[prop];\n                }\n            }\n            // set new title in layer div\n            if (config.title) {\n                var nameDiv = document.getElementById(this._addUID(\"GPname_ID_\" + id));\n                if (nameDiv) {\n                    nameDiv.innerHTML = config.title;\n                    nameDiv.title = config.description || config.title;\n                }\n            }\n            // add layer info picto if necessary\n            var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + id));\n            if (!document.getElementById(this._addUID(\"GPinfo_ID_\" + id)) && config.description) {\n                var advancedTools = document.getElementById(this._addUID(\"GPadvancedTools_ID_\" + id));\n                if (advancedTools) {\n                    advancedTools.appendChild(\n                        this._createAdvancedToolInformationElement({\n                            id : id\n                        })\n                    );\n                }\n            }\n            // close layer info element if open, to update information.\n            if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n                document.getElementById(this._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n                // infodiv.className = \"GPlayerInfo\";\n            }\n        }\n        // on met à jour le compteur\n        this._updateLayerCounter();\n        /**\n         * event triggered when a layer is added\n         *\n         * @event layerswitcher:add\n         * @property {Object} type - event\n         * @property {Object} layer - layer\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:add\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:add\",\n            layer : this._layers[id]\n        });\n    };\n\n    /**\n     * Remove a layer from control\n     *\n     * @param {ol.layer.Layer} layer - layer.\n     * @fires layerswitcher:remove\n     * @deprecated on the future version ...\n     */\n    removeLayer (layer) {\n        if (!layer) {\n            return;\n        }\n\n        olObservableUnByKey(this._listeners.updateLayerOpacity);\n        olObservableUnByKey(this._listeners.updateLayerVisibility);\n        // olObservableUnByKey(this._listeners.updateLayersOrder);\n\n        logger.trace(layer);\n\n        var layerID = layer.gpLayerId;\n        // var layerList = document.getElementById(this._addUID(\"GPlayersList\")).firstChild;\n        // close layer info element if open.\n        var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + layerID));\n        if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n            document.getElementById(this._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n            // infodiv.className = \"GPlayerInfo\";\n        }\n        // remove layer div\n        var layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + layerID));\n        if (layerDiv) {\n            this._layerListContainer.removeChild(layerDiv);\n        }\n\n        var layerIndex = Math.abs(layer.getZIndex() - this._lastZIndex);\n        // on retire la couche de la liste ordonnée des layers\n        this._layersOrder.splice(layerIndex, 1);\n        this._lastZIndex--;\n        // on met à jour les zindex des couches restantes\n        var layerOrderTemp = this._layersOrder;\n        for (var i = 0; i < layerOrderTemp.length; i++) {\n            layerOrderTemp[i].layer.setZIndex(this._lastZIndex - i);\n        }\n\n        /**\n         * event triggered when a layer is removed\n         *\n         * @event layerswitcher:add\n         * @property {Object} type - event\n         * @property {Object} layer - layer\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:remove\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:remove\",\n            layer : this._layers[layerID]\n        });\n\n        // on retire la couche de la liste des layers\n        delete this._layers[layerID];\n\n        // on met à jour le compteur\n        this._updateLayerCounter();\n    }\n\n    /**\n     * Collapse or display control main container\n     *\n     * @param {Boolean} collapsed - True to collapse control, False to display it\n     */\n    setCollapsed (collapsed) {\n        if (collapsed === undefined) {\n            logger.log(\"[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter\");\n            return;\n        }\n        var isCollapsed = !document.getElementById(this._addUID(\"GPshowLayersList\")).checked;\n        if ((collapsed && isCollapsed) || (!collapsed && !isCollapsed)) {\n            return;\n        }\n        // on simule l'ouverture du panneau après un click\n        if (!isCollapsed) {\n            // var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n            // for (var i = 0; i < layers.length; i++) {\n            //     layers[i].className = \"GPlayerInfo\";\n            // }\n            document.getElementById(this._addUID(\"GPlayerInfoPanel\")).classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n        }\n        document.getElementById(this._addUID(\"GPshowLayersList\")).checked = !collapsed;\n    }\n\n    /**\n     * Returns true if widget is collapsed (minimize), false otherwise\n     * @returns {Boolean} is collapsed\n     */\n    getCollapsed () {\n        return this.collapsed;\n    }\n\n    /**\n     * Display or hide removeLayerPicto from layerSwitcher for this layer\n     *\n     * @param {ol.layer.Layer} layer - ol.layer to be configured\n     * @param {Boolean} removable - specify if layer can be remove from layerSwitcher (true) or not (false). Default is true\n     */\n    setRemovable (layer, removable) {\n        if (!layer) {\n            return;\n        }\n        var layerID = layer.gpLayerId;\n        if (layerID == null) { // on teste si layerID est null ou undefined\n            logger.log(\"[LayerSwitcher:setRemovable] layer should be added to map before calling setRemovable method\");\n            return;\n        }\n        var removalDiv = document.getElementById(this._addUID(\"GPremove_ID_\" + layerID));\n        if (removalDiv) {\n            if (removable === false) {\n                removalDiv.style.display = \"none\";\n            } else if (removable === true) {\n                removalDiv.style.display = \"block\";\n            } else {\n\n            }\n        }\n    }\n\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ##################### init component ############################## //\n    // ################################################################### //\n\n    /**\n     * Initialize LayerSwitcher control (called by constructor)\n     *\n     * @param {Object} options - ol.control.Control options (see {@link http://openlayers.org/en/latest/apidoc/ol.control.Control.html ol.control.Control})\n     * @param {Array} layers - list of layers to be configured. Each array element is an object, with following properties :\n     * @private\n     */\n    _initialize (options, layers) {\n        // options par defaut\n        this.options = {\n            id : \"\",\n            collapsed : true,\n            draggable : false,\n            counter : false,\n            panel : false,\n            gutter : false,\n            allowEdit : false\n        };\n\n        // merge with user options\n        Utils.assign(this.options, options);\n\n        this.options.layers = layers;\n\n        // identifiant du contrôle : utile pour suffixer les identifiants CSS (pour gérer le cas où il y en a plusieurs dans la même page)\n        this._uid = this.options.id || SelectorID.generate();\n        // {Object} control layers list. Each key is a layer id, and its value is an object of layers options (layer, id, opacity, visibility, title, description...)\n        this._layers = {};\n        // [Array] array of ordered control layers\n        this._layersOrder = [];\n        // [Object] associative array of layers ordered by zindex (keys are zindex values, and corresponding values are arrays of layers at this zindex)\n        this._layersIndex = {};\n        // {Number} layers max z index, to order layers using their z index\n        this._lastZIndex = 0;\n        // {Number} layers max id, incremented when a new layer is added\n        this._layerId = 0;\n        /** {Boolean} true if widget is collapsed, false otherwise */\n        this.collapsed = (this.options.collapsed !== undefined) ? this.options.collapsed : true;\n        // div qui contiendra les div des listes.\n        this._layerListContainer = null;\n        // [Object] listeners added to the layerSwitcher saved here in order to delete them if we remove the control from the map)\n        this._listeners = {};\n\n        // add options layers to layerlist.\n        // (seulement les couches configurées dans les options du layerSwitcher par l'utilisateur),\n        // les autres couches de la carte seront ajoutées dans la méthode setMap\n        for (var i = 0; i < layers.length; i++) {\n            // recup la layer, son id,\n            var layer = layers[i].layer;\n            if (layer) {\n                var id;\n                // si elles ont déjà un identifiant (gpLayerId), on le récupère, sinon on en crée un nouveau, en incrémentant this_layerId.\n                if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                    id = this._layerId;\n                    layer.gpLayerId = id;\n                    this._layerId++;\n                } else {\n                    id = layer.gpLayerId;\n                }\n\n                // et les infos de la conf si elles existent (title, description, legends, quicklook, metadata)\n                var conf = layers[i].config || {};\n                var opacity = layer.getOpacity();\n                var visibility = layer.getVisible();\n                var layerOptions = {\n                    layer : layer, // la couche ol.layer concernée\n                    id : id,\n                    name : layer.name, // only geoportal layers\n                    service : layer.service, // only geoportal layers\n                    opacity : opacity != null ? opacity : 1,\n                    visibility : visibility != null ? visibility : true,\n                    title : conf.title != null ? conf.title : conf.id ? conf.id : id,\n                    description : conf.description || null,\n                    legends : conf.legends || [],\n                    metadata : conf.metadata || [],\n                    quicklookUrl : conf.quicklookUrl || null\n                };\n                this._layers[id] = layerOptions;\n            }\n        }\n    }\n\n    /**\n     * Create control main container (called by constructor)\n     *\n     * @returns {DOMElement} container - control container\n     * @private\n     */\n    _initContainer () {\n        // creation du container principal\n        var container = this._createMainContainerElement();\n\n        // ajout dans le container principal d'affichage des layers\n        var input = this._createMainLayersShowElement();\n        container.appendChild(input);\n\n        // gestion du mode \"collapsed\"\n        if (!this.collapsed) {\n            input.checked = \"checked\";\n            this.collapsed = false;\n        } else {\n            this.collapsed = true;\n        }\n\n        // on ajoute un écouteur d'évènement sur le bouton (checkbox) de dépliement/repliement des couches,\n        // pour modifier la propriété this.collapsed quand on clique dessus\n        var context = this;\n        // event listener\n        var changeCollapsed = function (e) {\n            this.collapsed = !e.target.checked;\n            // on génère nous même l'evenement OpenLayers de changement de pté\n            // (utiliser layerSwitcher.on(\"change:collapsed\", function ) pour s'abonner à cet évènement)\n            this.dispatchEvent(\"change:collapsed\");\n        };\n        input.addEventListener(\n            \"click\",\n            function (e) {\n                changeCollapsed.call(context, e);\n            }\n        );\n\n        // ajout dans le container principal du picto du controle\n        var picto = this._showLayerSwitcherButton = this._createMainPictoElement();\n        container.appendChild(picto);\n\n        // ajout du compteur de couches\n        container.classList.add(\"GplayerSwitcher-counterRemoved\");\n        if (this.options.counter) {\n            container.classList.remove(\"GplayerSwitcher-counterRemoved\");\n            container.classList.add(\"GplayerSwitcher-counterAdded\");\n            var counter = this._layerSwitcherCounter =  this._createMainCounterLayersElement();\n            picto.appendChild(counter);\n        }\n\n        // ajout dans le container principal de la liste des layers\n        var divL = this._createMainLayersElement();\n        container.appendChild(divL);\n\n        // header ?\n        if (this.options.panel) {\n            // header\n            var panelHeader = this._createLayersPanelHeaderElement();\n            divL.appendChild(panelHeader);\n            // icon\n            var panelIcon = this._createLayersPanelIconElement();\n            panelHeader.appendChild(panelIcon);\n            // title\n            var panelTitle = this._createLayersPanelTitleElement();\n            panelHeader.appendChild(panelTitle);\n            // close picto\n            var panelClose = this._createLayersPanelCloseElement();\n            panelHeader.appendChild(panelClose);\n        }\n\n        var div = this._layerListContainer = this._createMainLayersDivElement();\n        divL.appendChild(div);\n\n        // creation du mode draggable\n        this._createDraggableElement(div, this);\n\n        // ajout dans le container principal du panneau d'information\n        var divI = this._createMainInfoElement();\n        var divD = this._createMainInfoDivElement();\n        divI.appendChild(divD);\n        container.appendChild(divI);\n\n        return container;\n    }\n\n    /**\n     * Add all map layers to control main container\n     *\n     * @param {Object} map - ol.Map object, to which control is added\n     * @private\n     */\n    _addMapLayers (map) {\n        this._layersIndex = {};\n\n        // on parcourt toutes les couches de la carte, pour les ajouter à la liste du controle si ce n'est pas déjà le cas.\n        // idée : le layerSwitcher doit représenter l'ensemble des couches de la carte.\n        map.getLayers().forEach((layer) => {\n            // ajout des couches de la carte à la liste\n            var id = null;\n            // si elles ont déjà un identifiant (gpLayerId), on le récupère, sinon on en crée un nouveau, en incrémentant this_layerId.\n            if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                id = this._layerId;\n                layer.gpLayerId = id;\n                this._layerId++;\n            } else {\n                id = layer.gpLayerId;\n            }\n\n            var layerInfos = this.getLayerInfo(layer) || {};\n            if (!this._layers[id]) {\n                // si la couche n'est pas encore dans la liste des layers (this._layers), on l'ajoute\n                var opacity = layer.getOpacity();\n                var visibility = layer.getVisible();\n                var isInRange = this.isInRange(layer, map);\n                var layerOptions = {\n                    layer : layer,\n                    id : id,\n                    name : layer.name, // only geoportal layers\n                    service : layer.service, // only geoportal layers\n                    opacity : opacity != null ? opacity : 1,\n                    visibility : visibility != null ? visibility : true,\n                    inRange : isInRange != null ? isInRange : true,\n                    title : layerInfos._title || id,\n                    description : layerInfos._description || null,\n                    legends : layerInfos._legends || [],\n                    metadata : layerInfos._metadata || [],\n                    quicklookUrl : layerInfos._quicklookUrl || null\n                };\n                this._layers[id] = layerOptions;\n            } else {\n                // si elle existe déjà, on met à jour ses informations (visibility, opacity, inRange)\n                this._layers[id].opacity = layer.getOpacity();\n                this._layers[id].visibility = layer.getVisible();\n                this._layers[id].inRange = this.isInRange(layer, map);\n            }\n            // on met à jour le compteur\n            this._updateLayerCounter();\n\n            // Ajout de listeners sur les changements d'opacité, visibilité\n            this._listeners.updateLayerOpacity = layer.on(\n                \"change:opacity\",\n                (e) => this._updateLayerOpacity(e)\n            );\n            this._listeners._updateLayerVisibility = layer.on(\n                \"change:visible\",\n                (e) => this._updateLayerVisibility(e)\n            );\n\n            // récupération des zindex des couches s'ils existent, pour les ordonner.\n            if (layer.getZIndex !== undefined) {\n                var layerIndex = layer.getZIndex() || 0; // FIXME le zIndex peut être undefined !? donc par defaut à 0 !\n                if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {\n                    this._layersIndex[layerIndex] = [];\n                }\n                this._layersIndex[layerIndex].push(this._layers[id]);\n            };\n        });\n\n        // on récupère l'ordre d'affichage des couches entre elles dans la carte, à partir de zindex.\n        for (var zindex in this._layersIndex) {\n            if (this._layersIndex.hasOwnProperty(zindex)) {\n                var layers = this._layersIndex[zindex];\n                for (var l = 0; l < layers.length; l++) { // à ce stade layers[l] est une couche de this._layers.\n                    // on conserve l'ordre des couches : la première est celle qui se situe tout en haut, et la dernière est le \"fond de carte\"\n                    this._layersOrder.unshift(layers[l]);\n                    // et on réordonne les couches avec des zindex, uniques.\n                    this._lastZIndex++;\n                    layers[l].layer.setZIndex(this._lastZIndex);\n                    if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {\n                        this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on(\n                            \"change:zIndex\",\n                            () => this._updateLayersOrder()\n                        );\n                    }\n                }\n            }\n        }\n\n        // on ajoute les div correspondantes aux différentes couches (dans l'ordre inverse d'affichage) dans le controle.\n        for (var j = 0; j < this._layersOrder.length; j++) {\n            var layerOptions = this._layersOrder[j];\n            var layerDiv = this._createLayerDiv(layerOptions);\n            if (!this._layerListContainer.querySelector(\"#\" + layerDiv.id)) {\n                this._layerListContainer.appendChild(layerDiv);\n            }\n            // on stocke la div dans les options de la couche, pour une éventuelle réorganisation (setZIndex par ex)\n            this._layers[layerOptions.id].div = layerDiv;\n        }\n    }\n\n    /**\n     * create layer div (to append to control DOM element).\n     *\n     * @param {Object} layerOptions - layer options (id, title, description, legends, metadata, quicklookUrl ...)\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     */\n    _createLayerDiv (layerOptions) {\n        var isLegends = layerOptions.legends && layerOptions.legends.length !== 0;\n        var isMetadata = layerOptions.metadata && layerOptions.metadata.length !== 0;\n        var isQuicklookUrl = layerOptions.quicklookUrl;\n        // on n'affiche les informations que si elles sont renseignées\n        // (pour ne pas avoir un panneau vide)\n        if (isLegends || isMetadata || isQuicklookUrl) {\n            layerOptions.displayInformationElement = true;\n        }\n\n        layerOptions.type = \"\";\n        if (this.options.allowEdit) {\n            // information sur le type de couche : vecteur\n            if (layerOptions.layer instanceof VectorLayer || layerOptions.layer instanceof VectorTileLayer) {\n                layerOptions.type = \"feature\";\n            }\n        }\n        // ajout d'une div pour cette layer dans le control\n        var layerDiv = this._createContainerLayerElement(layerOptions);\n\n        if (!layerOptions.inRange) {\n            layerDiv.classList.add(\"outOfRange\");\n        }\n\n        return layerDiv;\n    }\n\n    // ################################################################### //\n    // ######################### DOM events ############################## //\n    // ################################################################### //\n\n    /**\n     * ...\n     *\n     * @method onShowLayerSwitcherClick\n     * @param { event } e évènement associé au clic\n     * @private\n     */\n    onShowLayerSwitcherClick (e) {\n        if (e.target.ariaPressed === \"true\") {\n            this.onPanelOpen();\n        }\n        var opened = this._showLayerSwitcherButton.ariaPressed;\n        this.collapsed = !(opened === \"true\");// on génère nous même l'evenement OpenLayers de changement de propriété\n        // (utiliser mousePosition.on(\"change:collapsed\", function(e) ) pour s'abonner à cet évènement)\n        this.dispatchEvent(\"change:collapsed\");\n        // on recalcule la position\n        if (this.options.position && !this.collapsed) {\n            this.updatePosition(this.options.position);\n        }\n    }\n\n    /**\n     * update layer counter\n     */\n    _updateLayerCounter () {\n        if (this._layerSwitcherCounter) {\n            this._layerSwitcherCounter.innerHTML = Object.keys(this._layers).length;\n        }\n    }\n\n    /**\n     * Change layer opacity on layer opacity picto click\n     *\n     * @param {Object} e - event\n     * @private\n     */\n    _onChangeLayerOpacity (e) {\n        e.target.parentNode.style.setProperty(\"--progress-right\", e.target.value + \"%\");\n        var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(divId); // ex. 26\n        var layer = this._layers[layerID].layer;\n\n        var opacityValue = e.target.value;\n        var opacityId = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + layerID));\n        opacityId.innerHTML = opacityValue + \"%\";\n\n        layer.setOpacity(opacityValue / 100);\n    }\n\n    /**\n     * Update picto opacity value on layer opacity change\n     *\n     * @param {Object} e - event\n     * @fires layerswitcher:change:opacity\n     * @private\n     */\n    _updateLayerOpacity (e) {\n        var opacity = e.target.getOpacity();\n        if (opacity > 1) {\n            opacity = 1;\n        }\n        if (opacity < 0) {\n            opacity = 0;\n        }\n        var id = e.target.gpLayerId;\n\n        var layerOpacityInput = document.getElementById(this._addUID(\"GPopacityValueDiv_ID_\" + id));\n        if (layerOpacityInput) {\n            layerOpacityInput.value = Math.round(opacity * 100);\n        }\n\n        var layerOpacitySpan = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + id));\n        if (layerOpacitySpan) {\n            layerOpacitySpan.innerHTML = Math.round(opacity * 100) + \"%\";\n        }\n\n        /**\n         * event triggered when an opacity layer is changed\n         *\n         * @event layerswitcher:change:opacity\n         * @property {Object} type - event\n         * @property {Object} opacity - opacity\n         * @property {Object} layer - layer\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:change\", function (e) {\n         *   console.log(e.opacity);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:change:opacity\",\n            opacity : opacity,\n            layer : this._layers[id]\n        });\n    }\n\n    /**\n     * Change layer visibility on layer visibility picto click\n     *\n     * @param {Object} e - event\n     * @private\n     */\n    _onVisibilityLayerClick (e) {\n        var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(divId); // ex. 26\n        var layer = this._layers[layerID].layer;\n        layer.setVisible((e.target.ariaPressed === \"true\"));\n    }\n\n    /**\n     * Change picto visibility on layer visibility change\n     *\n     * @param {Object} e - event\n     * @fires layerswitcher:change:visibility\n     * @private\n     */\n    _updateLayerVisibility (e) {\n        var visible = e.target.getVisible();\n        var id = e.target.gpLayerId;\n        var layerVisibility = document.getElementById(this._addUID(\"GPvisibilityPicto_ID_\" + id));\n        if (layerVisibility) {\n            layerVisibility.ariaPressed = visible;\n        }\n\n        /**\n         * event triggered when an visibility layer is changed\n         *\n         * @event layerswitcher:change:visibility\n         * @property {Object} type - event\n         * @property {Object} visibility - visibility\n         * @property {Object} layer - layer\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:change:visibility\", function (e) {\n         *   console.log(e.visibility);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:change:visibility\",\n            visibility : visible,\n            layer : this._layers[id]\n        });\n    }\n\n    /**\n     * Change layers order in layerswitcher (control container) on a layer index change (on map) or when a layer is added to a specific zindex\n     * @todo fires layerswitcher:change:zindex\n     * @private\n     */\n    _updateLayersOrder () {\n        // info :\n        // 1. on récupère les zindex et les couches associées dans un tableau associatif (objet)\n        // 2. on réordonne les couche selon leur index : on leur attribue de nouveaux zindex uniques\n        // 3. on vide le container des layers, et rajoute les div des couches dans l'ordre décroissant des zindex\n\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this._layersIndex = {};\n        var layerIndex;\n        var id;\n\n        // on parcourt toutes les couches pour récupérer leur ordre :\n        // on stocke les couches dans un tableau associatif ou les clés sont les zindex, et les valeurs sont des tableaux des couches à ce zindex.\n        map.getLayers().forEach(\n            (layer) => {\n                id = layer.gpLayerId;\n\n                // on commence par désactiver temporairement l'écouteur d'événements sur le changement de zindex.\n                olObservableUnByKey(this._layers[id].onZIndexChangeEvent);\n                this._layers[id].onZIndexChangeEvent = null;\n\n                // on ajoute la couche dans le tableau (de l'objet this._layersIndex) correspondant à son zindex\n                layerIndex = null;\n                if (layer.getZIndex !== undefined) {\n                    layerIndex = layer.getZIndex();\n                    if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {\n                        this._layersIndex[layerIndex] = [];\n                    }\n                    this._layersIndex[layerIndex].push(this._layers[id]);\n                };\n            }\n        );\n\n        // on réordonne les couches entre elles dans la carte, à partir des zindex stockés ci-dessus.\n        this._lastZIndex = 0;\n        this._layersOrder = [];\n        for (var zindex in this._layersIndex) {\n            if (this._layersIndex.hasOwnProperty(zindex)) {\n                var layers = this._layersIndex[zindex];\n                for (var l = 0; l < layers.length; l++) { // à ce stade layers[l] est une couche de this._layers.\n                    // on conserve l'ordre des couches : la première est celle qui se situe tout en haut, et la dernière est le \"fond de carte\"\n                    this._layersOrder.unshift(layers[l]);\n                    // et on réordonne les couches avec des zindex, uniques.\n                    this._lastZIndex++;\n                    // layers[l].layer.setZIndex(lastZIndex);\n                    // et on réactive l'écouteur d'événement sur les zindex\n                    if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {\n                        this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on(\n                            \"change:zIndex\",\n                            () => this._updateLayersOrder()\n                        );\n                    }\n                }\n            }\n        }\n\n        if (this._layerListContainer) {\n            // on vide le container précédent\n            for (let index = 0; index < this._layerListContainer.childNodes.length; index++) {\n                const element = this._layerListContainer.childNodes[index];\n                if (element.id === \"\") {\n                    continue;\n                }\n                element.remove();\n            }\n            // et on rajoute les div correspondantes aux différentes couches, dans l'ordre décroissant des zindex\n            for (var j = 0; j < this._layersOrder.length; j++) {\n                var layerOptions = this._layersOrder[j];\n                this._layerListContainer.appendChild(layerOptions.div);\n            }\n        } else {\n            logger.log(\"[ol.control.LayerSwitcher] _updateLayersOrder : layer list container not found to update layers order ?!\");\n        }\n    }\n\n    /**\n     * Open layer information panel on picto click\n     *\n     * @param {Event} e - MouseEvent\n     * @private\n     */\n    _onOpenLayerInfoClick (e) {\n        var id = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(id); // ex. 26\n        var layerOptions = this._layers[layerID];\n\n        var panel;\n        var info;\n\n        // Close layer info panel\n        var divId = document.getElementById(e.target.id);\n        if (divId.classList.contains(\"GPlayerInfoOpened\")) {\n            divId.classList.remove(\"GPlayerInfoOpened\");\n            divId.classList.add(\"GPlayerInfoClosed\");\n\n            panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n            panel.classList.remove(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n            panel.classList.add(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n\n            info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n            if (info) {\n                info.parentNode.remove();\n            }\n            return;\n        }\n\n        // Open layer info panel\n        if (divId.classList.contains(\"GPlayerInfoClosed\")) {\n            divId.classList.remove(\"GPlayerInfoClosed\");\n            divId.classList.add(\"GPlayerInfoOpened\");\n        }\n\n        panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n        panel.classList.remove(\"GPlayerInfoPanelClosed\", \"gpf-hidden\");\n        panel.classList.add(\"GPlayerInfoPanelOpened\", \"gpf-visible\");\n\n        info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n        if (info) {\n            info.parentNode.remove();\n        }\n\n        // on récupère les infos associées au layer pour mettre dynamiquement le contenu du panel d'informations\n        var obj = {\n            id : id,\n            title : layerOptions.title,\n            description : layerOptions.description,\n            quicklookUrl : layerOptions.quicklookUrl,\n            metadata : layerOptions.metadata,\n            legends : layerOptions.legends\n        };\n        // get layer max scale denominator\n        var maxResolution = layerOptions.layer.getMaxResolution();\n        if (maxResolution === Infinity) {\n            obj._maxScaleDenominator = 560000000;\n        } else {\n            obj._maxScaleDenominator = Math.round(maxResolution / 0.00028);\n        }\n        var infoLayer = this._createContainerLayerInfoElement(obj);\n        panel.firstChild.appendChild(infoLayer);\n    }\n\n    /**\n     * remove layer from layer switcher and map on picto click\n     *\n     * @param {Event} e - MouseEvent\n     * @private\n     */\n    _onDropLayerClick (e) {\n        var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(divId); // ex. 26\n        var layer = this._layers[layerID].layer;\n\n        // le retrait de la couche va déclencher l'ecouteur d'évenement,\n        // et appeler this.removeLayer qui va supprimer la div.\n        this.getMap().getLayers().remove(layer);\n    }\n\n    /**\n     * edit layer\n     *\n     * @param {Event} e - MouseEvent\n     * @private\n     */\n    _onEditLayerClick (e) {\n        var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(divId); // ex. 26\n\n        var options = this._layers[layerID];\n        var layer = this._layers[layerID].layer;\n\n        /**\n         * event triggered when the edit button is clicked\n         *\n         * @event layerswitcher:edit\n         * @property {Object} type - event\n         * @property {Object} layer - layer\n         * @property {Object} options - layer options\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:edit\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:edit\",\n            layer : layer,\n            options : options\n        });\n    }\n\n    /**\n     * change layers order (on map) on drag and drop (on control container)\n     *\n     * @param {Event} e - CustomEvent\n     * @private\n     */\n    _onEndDragAndDropLayerClick (e) {\n        logger.trace(e);\n        // INFO : e.oldIndex et e.newIndex marchent en mode AMD mais pas Bundle.\n        var map = this.getMap();\n\n        // on récupère l'ordre des div dans le contrôle pour réordonner les couches (avec zindex)\n        var matchesLayers = document.querySelectorAll(\"div.GPlayerSwitcher_layer\");\n        var maxZIndex = matchesLayers.length;\n        // on vide la liste ordonnée avant de la remplir avec l'ordre des couches selon les div.\n        this._layersOrder = [];\n        for (var i = 0; i < matchesLayers.length; i++) {\n            var tag = matchesLayers[i].id;\n            var id = SelectorID.index(tag);\n            var layer = this._layers[id].layer;\n\n            // on commence par désactiver temporairement l'écouteur d'événements sur le changement de zindex.\n            olObservableUnByKey(this._layers[id].onZIndexChangeEvent);\n            this._layers[id].onZIndexChangeEvent = null;\n\n            if (layer.setZIndex) {\n                // maxZIndex--;\n                layer.setZIndex(maxZIndex);\n                this._layersOrder.push(this._layers[id]);\n                maxZIndex--;\n            }\n\n            // et on réactive l'écouteur d'événement sur les zindex\n            if (this._layers[id].onZIndexChangeEvent == null) {\n                this._layers[id].onZIndexChangeEvent = layer.on(\n                    \"change:zIndex\",\n                    () => this._updateLayersOrder()\n                );\n            }\n        }\n\n        // mise à jour de la visu\n        map.updateSize();\n\n        /**\n         * event triggered when an position layer is changed\n         *\n         * @event layerswitcher:change:visibility\n         * @property {Object} type - event\n         * @property {Object} position - position\n         * @property {Object} layer - layer\n         * @property {Object} layers - layers sorted\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:change:position\", function (e) {\n         *   console.log(e.position);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:change:position\",\n            position : e.newIndex,\n            layer : this._layersOrder[e.newIndex],\n            layers : this._layersOrder\n        });\n    }\n\n    /**\n     * change layers order (on map) on drag and drop (on control container)\n     *\n     * @param {Event} e - DragNDrop Event\n     * @private\n     */\n    _onStartDragAndDropLayerClick (e) {\n        logger.debug(e);\n    }\n\n    /**\n     * togglegreyscale\n     * @param {Event} e - Event\n     * @private\n     */\n    _onToggleLayerGreyscaleClick (e) {\n        // fonction de conversion d'une image en n/b SEE: https://github.com/IGNF/geoportal-sdk/blob/316168e8de142627da59dff008cc4c4b308bf2c2/src/OpenLayers/OlMapLayers.js#L965\n        function getGreyScaledDataUrl (img) {\n            // FIXME : patch pour safari !?\n            // ce patch cause des problemes sur Chrome v83+\n            // img.crossOrigin = null;\n            img.crossOrigin = \"anonymous\";\n\n            var canvas = document.createElement(\"canvas\");\n            var ctx = canvas.getContext(\"2d\");\n\n            // si la taille est nulle, on force à une taille de tuile par defaut\n            // afin d'eviter une exception !\n            img.width = img.width || 256;\n            img.height = img.height || 256;\n\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n\n            var imageData = ctx.getImageData(0, 0, img.width, img.height);\n            var data = imageData.data;\n\n            for (var i = 0; i < data.length; i += 4) {\n                var avg = (data[i] + data[i + 1] + data[i + 2]) / 3;\n                data[i] = avg; // red\n                data[i + 1] = avg; // green\n                data[i + 2] = avg; // blue\n            }\n\n            ctx.putImageData(imageData, 0, 0);\n            return canvas.toDataURL();\n        };\n\n        // fonction de conversion et de chargement d'une image en n/b\n        function convertImagetoGreyScale (image, context) {\n            // conversion en n/b\n            var dataUrl = getGreyScaledDataUrl(image);\n\n            // chargement d'une image vide intermediaire pour eviter\n            // l'affichage d'images couleurs (pour certains navigateurs\n            // le chargement de l'image n/b et plus long et l'image originale\n            // apparait de manière transitoire)\n            image.src = \"\";\n            image.src = dataUrl;\n        }\n\n        // handler for event 'imageloadstart'\n        function imageloadstartHandler (evt) {\n            evt.image.getImage().crossOrigin = \"Anonymous\";\n        };\n\n        // handler for event 'tileloadstart'\n        function tileloadstartHandler (evt) {\n            evt.tile.getImage().crossOrigin = \"Anonymous\";\n        };\n\n        // handler for event 'imageloadend'\n        function imageloadendHandler (evt) {\n            convertImagetoGreyScale(evt.image.getImage(), evt.target);\n        };\n\n        // handler for event 'tileloadend'\n        function tileloadendHandler (evt) {\n            convertImagetoGreyScale(evt.tile.getImage(), evt.target);\n        };\n\n        // abonnement/desabonnement aux evenements permettant la conversion en n/b\n        var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n        var layerID = SelectorID.index(divId); // ex. 26\n\n        var layer = this._layers[layerID].layer;\n        var source = layer.getSource();\n\n        if (!(source instanceof TileWMSSource || source instanceof WMTSSource)) {\n            console.warn(\"greyscale only implemented of raster pour l'instant\");\n            return;\n        }\n        var toGreyScale = true;\n        if (e.target.classList.contains(\"GPlayerGreyscaleOff\")) {\n            e.target.classList.remove(\"GPlayerGreyscaleOff\");\n            e.target.classList.add(\"GPlayerGreyscaleOn\");\n        } else {\n            e.target.classList.add(\"GPlayerGreyscaleOff\");\n            e.target.classList.remove(\"GPlayerGreyscaleOn\");\n            toGreyScale = false;\n        }\n\n        if (toGreyScale) {\n            if (source instanceof TileWMSSource) {\n                source.loadstartListenerKey = source.on(\"imageloadstart\", imageloadstartHandler);\n                source.loadendListenerKey = source.on(\"imageloadend\", imageloadendHandler);\n            } else {\n                source.loadstartListenerKey = source.on(\"tileloadstart\", tileloadstartHandler);\n                source.loadendListenerKey = source.on(\"tileloadend\", tileloadendHandler);\n            }\n        } else {\n            olObservableUnByKey(source.loadstartListenerKey);\n            olObservableUnByKey(source.loadendListenerKey);\n            source.loadstartListenerKey = null;\n            source.loadendListenerKey = null;\n        }\n\n        // maj du cache\n        source.refresh();\n    }\n\n    /**\n     * zoom to extent\n     * @fixme dot it for other user data\n     * @param {PointerEvent} e - Event\n     */\n    _onZoomToExtentClick (e) {\n        logger.debug(e);\n\n        // FIXME\n        // le zoom to extent fonctionne par defaut pour les couches raster TMS/WMS/WMTS issues du catalogue\n        // et pour les données utilisateurs de type vecteur\n        // mais doit aussi le faire pour les données utilisateurs du type :\n        // * raster par moissonnage (imports)\n        // * style mapbox (imports)\n\n        var domIDShort = e.target.id; // ex GPvisibilityPicto_ID_26\n        var domIDLong = SelectorID.index(domIDShort); // ex. 26\n        var data = this._layers[domIDLong];\n\n        var extent = null;\n        var error = null;\n\n        var map = this.getMap();\n        // cas d'un layer vecteur\n        // - importé,\n        // - d'un croquis,\n        // - d'une couche de calcul\n        // - enregistré sur l'espace personnel\n        if (data.layer.hasOwnProperty(\"gpResultLayerId\") &&\n            (data.layer.gpResultLayerId.split(\":\")[0] === \"layerimport\" ||\n            data.layer.gpResultLayerId.split(\":\")[0] === \"drawing\" ||\n            data.layer.gpResultLayerId.split(\":\")[0] === \"compute\" ||\n            data.layer.gpResultLayerId.split(\":\")[0] === \"bookmark\"\n            )) {\n            // TODO : appeler fonc  tion commune\n            // zoom sur l'étendue des entités récupérées (si possible)\n            if (map.getView() && map.getSize()) {\n                var sourceExtent = data.layer.getExtent();\n                if (!sourceExtent) {\n                    var source = data.layer.getSource();\n                    if (source && source.getExtent) {\n                        sourceExtent = source.getExtent();\n                    } else {\n                        sourceExtent = source.getTileGrid().getExtent();\n                    }\n                }\n                if (sourceExtent && sourceExtent[0] !== Infinity) {\n                    map.getView().fit(sourceExtent, map.getSize());\n                }\n            }\n        } else {\n            try {\n                // Check if configuration is loaded\n                if (!Config.isConfigLoaded()) {\n                    throw \"ERROR : contract key configuration has to be loaded to load Geoportal layers.\";\n                }\n\n                var layerName = data.layer.name || data.layer.getSource().name;\n                var layerService = data.layer.service || data.layer.getSource().service;\n                var layerId = Config.configuration.getLayerId(layerName, layerService);\n                if (!layerId) {\n                    throw \"ERROR : Layer ID not found into the catalogue !?\";\n                }\n\n                var globalConstraints = Config.configuration.getGlobalConstraints(layerId);\n                if (globalConstraints) {\n                    if (!map || !map.getView()) {\n                        return;\n                    }\n                    var view = map.getView();\n                    var crsTarget = view.getProjection();\n\n                    // récupération de l'étendue (en EPSG:4326 par défaut),\n                    // et reprojection dans la projection de la couche\n                    var bbox = [\n                        globalConstraints.extent.left,\n                        globalConstraints.extent.bottom,\n                        globalConstraints.extent.right,\n                        globalConstraints.extent.top\n                    ];\n                    var crsSource = globalConstraints.crs;\n                    // projection par defaut\n                    if (!crsSource) {\n                        crsSource = \"EPSG:4326\";\n                    }\n\n                    extent = olTransformExtentProj(bbox, crsSource, crsTarget);\n                    if (extent) {\n                        view.fit(extent);\n                    }\n                }\n            } catch (e) {\n                error = e;\n            }\n        }\n\n        /**\n         * event triggered when an zoom extent is done\n         *\n         * @event layerswitcher:zoom\n         * @property {Object} type - event\n         * @property {Object} extent - extent (map projection)\n         * @property {Object} layer - layer\n         * @property {String} error - error\n         * @property {Object} target - instance LayerSwitcher\n         * @example\n         * LayerSwitcher.on(\"layerswitcher:extent\", function (e) {\n         *   console.log(e.extent);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerswitcher:extent\",\n            extent : extent,\n            layer : data,\n            error : error\n        });\n    }\n\n    /**\n     * check layers range on map movement\n     *\n     * @param {ol.Map} map - ol map on which event occured\n     * @private\n     */\n    _onMapMoveEnd (map) {\n        // pour chaque couche de la map, on vérifie qu'elle soit toujours dans la visu (inRange)\n        map.getLayers().forEach(\n            (layer) => {\n                var id = layer.gpLayerId;\n                if (this._layers[id]) {\n                    var layerOptions = this._layers[id];\n\n                    // Check if layer is out of range.\n                    var layerDiv;\n                    if (this.isInRange(layer, map) && !layerOptions.inRange) {\n                        layerOptions.inRange = true;\n                        layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + id));\n                        layerDiv.classList.remove(\"outOfRange\");\n                    } else if (!this.isInRange(layer, map) && layerOptions.inRange) {\n                        layerOptions.inRange = false;\n                        layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + id));\n                        layerDiv.classList.add(\"outOfRange\");\n                    }\n                }\n            }\n        );\n    }\n\n    // ################################################################### //\n    // ############################ Utils ################################ //\n    // ################################################################### //\n\n    /**\n     * Returns Layer Container Id associated with given olLayer\n     *\n     * @param {ol.layer.Layer} olLayer - ol layer object\n     * @returns {String} - div container Id ; null if layer not found.\n     */\n    getLayerDOMId (olLayer) {\n        var foundId = null;\n\n        this.getMap().getLayers().forEach((layer) => {\n            if (layer === olLayer) {\n                foundId = layer.hasOwnProperty(\"gpLayerId\") ? layer.gpLayerId : null;\n            }\n        });\n\n        // TODO : recuperer \"GPlayerSwitcher_ID\" depuis une constante\n        return foundId !== null ? this._addUID(\"GPlayerSwitcher_ID_\" + foundId) : null;\n    }\n\n    /**\n     * Check if map view is out of layer range (in terms of extent and zoom)\n     *\n     * @param {Object} layer - the ol.layer object\n     * @param {Object} map   - the ol.Map object\n     * @returns {Boolean} outOfRange - false if map view is out of layer range\n     */\n    isInRange (layer, map) {\n        if (!map) {\n            return;\n        }\n        // check if map zoom is in layer zoom range\n        var mapResolution = map.getView().getResolution();\n        if (mapResolution > layer.getMaxResolution() || mapResolution < layer.getMinResolution()) {\n            return false;\n        }\n\n        // check if map extent intersects layer extent (if defined)\n        var mapExtent = map.getView().calculateExtent(map.getSize());\n        var layerExtent = layer.getExtent();\n        if (layerExtent && !olIntersects(mapExtent, layerExtent)) {\n            return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Get layer informations : title, description, quicklookurl, legends, metadata\n     *\n     * @param {Object} layer - the ol.layer object\n     * @returns {Object} layerInfo - layer informations\n     */\n    getLayerInfo (layer) {\n        var layerInfo = {};\n        if (layer.getProperties !== undefined && layer.getSource !== undefined) {\n            var layerProperties = layer.getProperties();\n            var src = layerProperties.source;\n            if (src) {\n                layerInfo._title = src._title || layerProperties.title || layerProperties.id || \"\";\n                layerInfo._description = src._description || layerProperties.description || \"\";\n                layerInfo._quicklookUrl = src._quicklookUrl || layerProperties.quicklookUrl || \"\";\n                layerInfo._metadata = src._metadata || layerProperties.metadata || [];\n                layerInfo._legends = src._legends || layerProperties.legends || [];\n            }\n        }\n        return layerInfo;\n    }\n\n};\n\n// on récupère les méthodes de la classe commune LayerSwitcherDOM\nObject.assign(LayerSwitcher.prototype, LayerSwitcherDOM);\nObject.assign(LayerSwitcher.prototype, Widget);\n\nexport default LayerSwitcher;\n\n// Expose LayerSwitcher as ol.control.LayerSwitcher (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.LayerSwitcher = LayerSwitcher;\n}\n","import Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport ConfigInterface from \"./ConfigInterface\";\n\n/**\n * @classdesc\n *\n * Recupération de la configuration de clés Géoportail sous forme de JSON\n *\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.Config\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n * @param {Sting} options.apiKey - clé(s) dont on veut obtenir la configuration. Si plusieurs clés, séparer chacune par une virgule\n * @param {Boolean} [options.sync=false] - force le mode synchrone\n * @param {String} options.customConfigFile - chemin vers un fichier de configuration personnalisé. Surcharge le paramètre apiKey.\n * @see Gp.Services.GetConfigInterface\n *\n * @example\n *   var options = {\n *      apiKey : \"cartes,ortho\",\n *      sync : false,\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *   };\n *\n */\nfunction Config (options) {\n    if (!(this instanceof Config)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"Config\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"Config\";\n\n    this.logger = Logger.getLogger(\"Gp.Config\");\n    this.logger.trace(\"[Constructeur Config (options)]\");\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    // gestion du callback onSuccess\n    var bOnSuccess = !!(options.onSuccess !== null && typeof options.onSuccess === \"function\");\n    if (!bOnSuccess) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"onSuccess()\"));\n    }\n    if (!options.apiKey && !options.customConfigFile) {\n        // si pas de thème spécifié, on récupère toutes les ressources possibles dans l'objet Config\n        options.apiKey = \"full\";\n    }\n    this.options = {};\n    this.options.onSuccess = options.onSuccess;\n    this.options.onFailure = options.onFailure;\n\n    // mode sync\n    this.options.sync = options.sync || false;\n\n    // gestion d'un tableau d'url des fichiers de configuration\n    this.options.listConfigUrls = (options.customConfigFile)\n        ? [options.customConfigFile]\n        : !Array.isArray(options.apiKey)\n            ? DefaultUrlService.Config.url(options.apiKey.split(\",\"))\n            : DefaultUrlService.Config.url(options.apiKey);\n}\n\n/**\n * @lends module:Config#\n */\nConfig.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/**\n * Constructeur (alias)\n */\nConfig.prototype.constructor = Config;\n\n/**\n * Création de la requête\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n * @overload\n */\nConfig.prototype.buildRequest = function (error, success) {\n    // liste des urls des fichiers de configuration en JSON\n    this.listConfigUrls = this.options.listConfigUrls;\n\n    if (!this.listConfigUrls) {\n        error.call(this, new Error(\"url by default not found !\"));\n        return;\n    }\n\n    // INFO :\n    // il n'y a pas de construction de requête,\n    // on passe directement à l'appel des requêtes\n    success.call(this, this.listConfigUrls);\n};\n\n/**\n * Récupération des configuration\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n * @overload\n */\nConfig.prototype.callService = function (error, success) {\n    if (this.options.sync) {\n        __callServiceSync.call(this, error, success);\n    } else {\n        __callService.call(this, error, success);\n    }\n};\n\n/**\n * Requêtes en mode asynchrone\n *\n * @param {*} error\n * @param {*} success\n * @private\n */\nvar __callService = function (error, success) {\n    // liste des resultats au format JSON\n    this.listConfigResults = [];\n\n    // test on env. nodejs or browser\n    let Fetch = null;\n    if (typeof window === \"undefined\") {\n        var nodefetch = require(\"node-fetch\");\n        Fetch = nodefetch;\n    } else {\n        Fetch = window.fetch;\n    }\n\n    // the factory of fetch !\n    var fetchFactory = (url) => {\n        return Fetch(url, { credentials : \"same-origin\" })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json()\n                        .then((json) => {\n                            // TODO :\n                            // tester le contenu !\n                            return json;\n                        })\n                        .catch((error) => {\n                            throw new Error(\"Exception Json : \" + error);\n                        });\n                } else {\n                    throw new Error(\"Exception HTTP : \" + response.status + \" (status code) !\");\n                }\n            })\n            .catch((error) => {\n                return new Promise((resolve, reject) => {\n                    // eslint-disable-line no-unused-vars\n                    reject(error);\n                });\n            });\n    };\n\n    // construction des promises fetch\n    var promises = [];\n    for (let index = 0; index < this.listConfigUrls.length; index++) {\n        const url = this.listConfigUrls[index];\n        promises.push(fetchFactory(url));\n    }\n\n    Promise.all(promises)\n        .then((results) => {\n            if (!results) {\n                throw new Error(\"results config empty !?\");\n            }\n            results.forEach((result) => {\n                // TODO :\n                // verification des resultats\n                this.listConfigResults.push(result);\n            });\n        })\n        .then(() => {\n            success.call(this, this.listConfigResults);\n        })\n        .catch((e) => {\n            // TODO :\n            // construction d'un message\n            error.call(this, e);\n        });\n};\n\n/**\n * Requêtes en mode synchrone\n *\n * @param {*} error\n * @param {*} success\n * @private\n */\nvar __callServiceSync = function (error, success) {\n    // liste des resultats au format JSON\n    this.listConfigResults = [];\n\n    // FIXME :\n    // boucle synchrone !\n    for (var i = 0; i < this.listConfigUrls.length; i++) {\n        const url = this.listConfigUrls[i];\n        // TODO :\n        // prévoir le CORS, headers, ...\n        const request = new XMLHttpRequest();\n        request.open(\"GET\", url, false);\n        request.send(null);\n        if (request.status === 200) {\n            // TODO :\n            // tester la reponse !\n            var response = JSON.parse(request.responseText);\n            this.listConfigResults.push(response);\n        }\n    }\n    // callback\n    if (this.listConfigResults.length !== 0) {\n        success.call(this, this.listConfigResults);\n    } else {\n        error.call(this, new Error(\"...\"));\n    }\n};\n\n/**\n * Analyse et mise en forme de la réponse en fusionnant les configurations\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n * @overload\n */\nConfig.prototype.analyzeResponse = function (error, success) {\n    // fonction de merge des objects JSON\n    var mergeConfig = function (objects) {\n        // objet fusion des couches\n        var allLayersConfig = {};\n        // objet fusion des clés\n        var allKeysConfig = {};\n        // objet fusion des TMS\n        var allTMSConfig = {};\n\n        // on fusionne les résultat\n        for (var i = 0; i < objects.length; i++) {\n            if (!objects[i].generalOptions || !objects[i].layers) {\n                return;\n            }\n            allKeysConfig = {\n                ...allKeysConfig,\n                ...objects[i].generalOptions.apiKeys\n            };\n            allLayersConfig = {\n                ...allLayersConfig,\n                ...objects[i].layers\n            };\n            allTMSConfig = {\n                ...allTMSConfig,\n                ...objects[i].tileMatrixSets\n            };\n        }\n\n        var mergedConfig = {\n            generalOptions : {\n                apiKeys : allKeysConfig\n            },\n            layers : allLayersConfig,\n            tileMatrixSets : allTMSConfig\n        };\n        return mergedConfig;\n    };\n\n    // fusion des configurations JSON\n    var ConfigJSON = mergeConfig(this.listConfigResults);\n    if (!ConfigJSON) {\n        error.call(this, new Error(\"configuration structure not conforme !\"));\n        return;\n    }\n\n    // creation des interfaces\n    var IConfig = new ConfigInterface();\n    // ajout des interfaces avec la configuration JSON\n    Object.assign(IConfig, ConfigJSON);\n\n    // définition de la variable globale Gp.Config\n    var scope = typeof window !== \"undefined\" ? window : {};\n    if (!scope.Gp) {\n        scope.Gp = {};\n    }\n\n    // enregistrement\n    if (scope.Gp.Config) {\n        Object.assign(scope.Gp.Config, IConfig);\n        // dans le doute..., ceinture et bretelles !\n        for (var property in IConfig) {\n            scope.Gp.Config[property] = IConfig[property];\n        }\n    } else {\n        scope.Gp.Config = IConfig;\n    }\n\n    // INFO :\n    // il n'y a pas d'analyse des résultats,\n    // on passe directement à l'appel de la callback utilisateur\n    success.call(this, scope.Gp.Config);\n};\n\nexport default Config;\n","/**\n * Classe d'interface des requêtes de type WPS sur le service altimetrique.\n * (Factory)\n *\n * @module Gp.Services.Alti.Request.AltiRequestWPS\n * @alias Gp.Services.Alti.Request.AltiRequestWPS\n * @private\n */\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport _ from \"../../../Utils/MessagesResources\";\nimport WPS from \"../../../Formats/WPS\";\nimport AltiElevationRequest from \"./model/AltiElevationRequest\";\nimport AltiProfilRequest from \"./model/AltiProfilRequest\";\n\nvar AltiRequestWPS = {\n\n    /**\n     * Interface unique de construction de la requête.\n     *\n     * @method build\n     * @param {Object} options - options\n     * @param {Object}   options.param.positions - tableau de coordonnées lon/lat\n     * @param {String}   options.param.delimiter - '|'\n     * @param {Boolean}  options.param.indent - false|true\n     * @param {String}   options.param.crs - 'CRS:84'\n     * @param {String}   options.param.sampling - 3\n     * @param {Boolean}  options.param.zonly - false|true\n     * @param {String}   options.param.format - \"JSON|XML\" (only to POST)\n     * @param {String}   options.wps.service - \"WPS\"\n     * @param {String}   options.wps.version - \"1.0.0\"\n     * @param {String}   options.wps.identifier - \"gs:WPSElevation|gs:WPSLineElevation\"\n     * @param {String}   options.wps.rawdataoutput - \"result\"\n     * @param {String}   options.wps.request - \"Execute\"\n     * @param {String}   options.type - \"Profil|Elevation\"\n     * @param {String}   options.method - GET|POST\n     * @example\n     *      var options = {\n     *           type : 'Profil', // Elevation\n     *           method : 'GET',  // par defaut\n     *           param : {\n     *               positions : [\n     *                   {lon:'1.11', lat:'1.11'},\n     *                   {lon:'1.10', lat:'1.10'},\n     *                   {lon:'1.12', lat:'1.12'}\n     *               ],\n     *               delimiter : \";\",         // par defaut\n     *               indent    : true,        // par defaut\n     *               crs       : 'EPSG:4326', // par defaut\n     *               format    : 'json',      // par defaut (only to POST)\n     *               sampling  : 3 ,          // par defaut (only use by Profil)\n     *               zonly     : false,       // par defaut (only use by Elevation)\n     *           },\n     *           wps : {\n     *                 service : 'WPS',         // par defaut\n     *                 version : '1.0.0',       // par defaut\n     *                 identifier : 'gs:WPS',   // par defaut, Elevation = gs:WPSElevation, Profil = gs:WPSLineElevation\n     *                 rawdataoutput : 'result',// par defaut\n     *                 request : 'Execute'      // par defaut\n     *           }\n     *       };\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"AltiRequestWPS\");\n        logger.trace([\"AltiRequestWPS::build()\"]);\n\n        // existance des options\n        if (!options) {\n            throw new Error(_.getMessage(\"PARAM_EMPTY\", \"options\"));\n        }\n\n        // type de requete : Altitude ou Profil\n        // (param. à determiner en fonction des parametres d'entrée)\n        if (!options.type) {\n            throw new Error(_.getMessage(\"PARAM_EMPTY\", \"type (Elevation or Profil)\"));\n        }\n\n        // construction du modele de requête\n        // (test du type d'objet candidat)\n        var DataObject = null;\n        switch (options.type) {\n            case \"Elevation\":\n                // surcharge\n                options.wps.identifier = \"gs:WPSElevation\";\n                DataObject = new AltiElevationRequest(options.param);\n                break;\n            case \"Profil\":\n                // surcharge\n                options.wps.identifier = \"gs:WPSLineElevation\";\n                DataObject = new AltiProfilRequest(options.param);\n                break;\n            default:\n                throw new Error(_.getMessage(\"PARAM_TYPE\", \"type (Elevation or Profil)\"));\n        }\n\n        // construction de la requête WPS\n        var settings = {\n            data : DataObject,\n            method : options.method,\n            param : options.wps\n        };\n\n        var rqstWPS = new WPS(settings);\n\n        if (!rqstWPS.processRequestString()) {\n            throw new Error(\"Enable to process request !\");\n        }\n\n        return rqstWPS.requestString;\n    }\n};\n\nexport default AltiRequestWPS;\n","'use strict';\n\nvar conventions = require('./conventions');\nvar g = require('./grammar');\nvar errors = require('./errors');\n\nvar isHTMLEscapableRawTextElement = conventions.isHTMLEscapableRawTextElement;\nvar isHTMLMimeType = conventions.isHTMLMimeType;\nvar isHTMLRawTextElement = conventions.isHTMLRawTextElement;\nvar hasOwn = conventions.hasOwn;\nvar NAMESPACE = conventions.NAMESPACE;\nvar ParseError = errors.ParseError;\nvar DOMException = errors.DOMException;\n\n//var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')\n\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\nvar S_TAG = 0; //tag name offerring\nvar S_ATTR = 1; //attr name offerring\nvar S_ATTR_SPACE = 2; //attr name end and space offer\nvar S_EQ = 3; //=space?\nvar S_ATTR_NOQUOT_VALUE = 4; //attr value(no quot value only)\nvar S_ATTR_END = 5; //attr value end and no space(quot end)\nvar S_TAG_SPACE = 6; //(attr value end || tag end ) && (space offer)\nvar S_TAG_CLOSE = 7; //closed el<el />\n\nfunction XMLReader() {}\n\nXMLReader.prototype = {\n\tparse: function (source, defaultNSMap, entityMap) {\n\t\tvar domBuilder = this.domBuilder;\n\t\tdomBuilder.startDocument();\n\t\t_copy(defaultNSMap, (defaultNSMap = Object.create(null)));\n\t\tparse(source, defaultNSMap, entityMap, domBuilder, this.errorHandler);\n\t\tdomBuilder.endDocument();\n\t},\n};\n\n/**\n * Detecting everything that might be a reference,\n * including those without ending `;`, since those are allowed in HTML.\n * The entityReplacer takes care of verifying and transforming each occurrence,\n * and reports to the errorHandler on those that are not OK,\n * depending on the context.\n */\nvar ENTITY_REG = /&#?\\w+;?/g;\n\nfunction parse(source, defaultNSMapCopy, entityMap, domBuilder, errorHandler) {\n\tvar isHTML = isHTMLMimeType(domBuilder.mimeType);\n\tif (source.indexOf(g.UNICODE_REPLACEMENT_CHARACTER) >= 0) {\n\t\terrorHandler.warning('Unicode replacement character detected, source encoding issues?');\n\t}\n\n\tfunction fixedFromCharCode(code) {\n\t\t// String.prototype.fromCharCode does not supports\n\t\t// > 2 bytes unicode chars directly\n\t\tif (code > 0xffff) {\n\t\t\tcode -= 0x10000;\n\t\t\tvar surrogate1 = 0xd800 + (code >> 10),\n\t\t\t\tsurrogate2 = 0xdc00 + (code & 0x3ff);\n\n\t\t\treturn String.fromCharCode(surrogate1, surrogate2);\n\t\t} else {\n\t\t\treturn String.fromCharCode(code);\n\t\t}\n\t}\n\n\tfunction entityReplacer(a) {\n\t\tvar complete = a[a.length - 1] === ';' ? a : a + ';';\n\t\tif (!isHTML && complete !== a) {\n\t\t\terrorHandler.error('EntityRef: expecting ;');\n\t\t\treturn a;\n\t\t}\n\t\tvar match = g.Reference.exec(complete);\n\t\tif (!match || match[0].length !== complete.length) {\n\t\t\terrorHandler.error('entity not matching Reference production: ' + a);\n\t\t\treturn a;\n\t\t}\n\t\tvar k = complete.slice(1, -1);\n\t\tif (hasOwn(entityMap, k)) {\n\t\t\treturn entityMap[k];\n\t\t} else if (k.charAt(0) === '#') {\n\t\t\treturn fixedFromCharCode(parseInt(k.substring(1).replace('x', '0x')));\n\t\t} else {\n\t\t\terrorHandler.error('entity not found:' + a);\n\t\t\treturn a;\n\t\t}\n\t}\n\n\tfunction appendText(end) {\n\t\t//has some bugs\n\t\tif (end > start) {\n\t\t\tvar xt = source.substring(start, end).replace(ENTITY_REG, entityReplacer);\n\t\t\tlocator && position(start);\n\t\t\tdomBuilder.characters(xt, 0, end - start);\n\t\t\tstart = end;\n\t\t}\n\t}\n\n\tvar lineStart = 0;\n\tvar lineEnd = 0;\n\tvar linePattern = /\\r\\n?|\\n|$/g;\n\tvar locator = domBuilder.locator;\n\n\tfunction position(p, m) {\n\t\twhile (p >= lineEnd && (m = linePattern.exec(source))) {\n\t\t\tlineStart = lineEnd;\n\t\t\tlineEnd = m.index + m[0].length;\n\t\t\tlocator.lineNumber++;\n\t\t}\n\t\tlocator.columnNumber = p - lineStart + 1;\n\t}\n\n\tvar parseStack = [{ currentNSMap: defaultNSMapCopy }];\n\tvar unclosedTags = [];\n\tvar start = 0;\n\twhile (true) {\n\t\ttry {\n\t\t\tvar tagStart = source.indexOf('<', start);\n\t\t\tif (tagStart < 0) {\n\t\t\t\tif (!isHTML && unclosedTags.length > 0) {\n\t\t\t\t\treturn errorHandler.fatalError('unclosed xml tag(s): ' + unclosedTags.join(', '));\n\t\t\t\t}\n\t\t\t\tif (!source.substring(start).match(/^\\s*$/)) {\n\t\t\t\t\tvar doc = domBuilder.doc;\n\t\t\t\t\tvar text = doc.createTextNode(source.substring(start));\n\t\t\t\t\tif (doc.documentElement) {\n\t\t\t\t\t\treturn errorHandler.error('Extra content at the end of the document');\n\t\t\t\t\t}\n\t\t\t\t\tdoc.appendChild(text);\n\t\t\t\t\tdomBuilder.currentElement = text;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (tagStart > start) {\n\t\t\t\tvar fromSource = source.substring(start, tagStart);\n\t\t\t\tif (!isHTML && unclosedTags.length === 0) {\n\t\t\t\t\tfromSource = fromSource.replace(new RegExp(g.S_OPT.source, 'g'), '');\n\t\t\t\t\tfromSource && errorHandler.error(\"Unexpected content outside root element: '\" + fromSource + \"'\");\n\t\t\t\t}\n\t\t\t\tappendText(tagStart);\n\t\t\t}\n\t\t\tswitch (source.charAt(tagStart + 1)) {\n\t\t\t\tcase '/':\n\t\t\t\t\tvar end = source.indexOf('>', tagStart + 2);\n\t\t\t\t\tvar tagNameRaw = source.substring(tagStart + 2, end > 0 ? end : undefined);\n\t\t\t\t\tif (!tagNameRaw) {\n\t\t\t\t\t\treturn errorHandler.fatalError('end tag name missing');\n\t\t\t\t\t}\n\t\t\t\t\tvar tagNameMatch = end > 0 && g.reg('^', g.QName_group, g.S_OPT, '$').exec(tagNameRaw);\n\t\t\t\t\tif (!tagNameMatch) {\n\t\t\t\t\t\treturn errorHandler.fatalError('end tag name contains invalid characters: \"' + tagNameRaw + '\"');\n\t\t\t\t\t}\n\t\t\t\t\tif (!domBuilder.currentElement && !domBuilder.doc.documentElement) {\n\t\t\t\t\t\t// not enough information to provide a helpful error message,\n\t\t\t\t\t\t// but parsing will throw since there is no root element\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar currentTagName =\n\t\t\t\t\t\tunclosedTags[unclosedTags.length - 1] ||\n\t\t\t\t\t\tdomBuilder.currentElement.tagName ||\n\t\t\t\t\t\tdomBuilder.doc.documentElement.tagName ||\n\t\t\t\t\t\t'';\n\t\t\t\t\tif (currentTagName !== tagNameMatch[1]) {\n\t\t\t\t\t\tvar tagNameLower = tagNameMatch[1].toLowerCase();\n\t\t\t\t\t\tif (!isHTML || currentTagName.toLowerCase() !== tagNameLower) {\n\t\t\t\t\t\t\treturn errorHandler.fatalError('Opening and ending tag mismatch: \"' + currentTagName + '\" != \"' + tagNameRaw + '\"');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar config = parseStack.pop();\n\t\t\t\t\tunclosedTags.pop();\n\t\t\t\t\tvar localNSMap = config.localNSMap;\n\t\t\t\t\tdomBuilder.endElement(config.uri, config.localName, currentTagName);\n\t\t\t\t\tif (localNSMap) {\n\t\t\t\t\t\tfor (var prefix in localNSMap) {\n\t\t\t\t\t\t\tif (hasOwn(localNSMap, prefix)) {\n\t\t\t\t\t\t\t\tdomBuilder.endPrefixMapping(prefix);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tend++;\n\t\t\t\t\tbreak;\n\t\t\t\t// end element\n\t\t\t\tcase '?': // <?...?>\n\t\t\t\t\tlocator && position(tagStart);\n\t\t\t\t\tend = parseProcessingInstruction(source, tagStart, domBuilder, errorHandler);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '!': // <!doctype,<![CDATA,<!--\n\t\t\t\t\tlocator && position(tagStart);\n\t\t\t\t\tend = parseDoctypeCommentOrCData(source, tagStart, domBuilder, errorHandler, isHTML);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlocator && position(tagStart);\n\t\t\t\t\tvar el = new ElementAttributes();\n\t\t\t\t\tvar currentNSMap = parseStack[parseStack.length - 1].currentNSMap;\n\t\t\t\t\t//elStartEnd\n\t\t\t\t\tvar end = parseElementStartPart(source, tagStart, el, currentNSMap, entityReplacer, errorHandler, isHTML);\n\t\t\t\t\tvar len = el.length;\n\n\t\t\t\t\tif (!el.closed) {\n\t\t\t\t\t\tif (isHTML && conventions.isHTMLVoidElement(el.tagName)) {\n\t\t\t\t\t\t\tel.closed = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tunclosedTags.push(el.tagName);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (locator && len) {\n\t\t\t\t\t\tvar locator2 = copyLocator(locator, {});\n\t\t\t\t\t\t//try{//attribute position fixed\n\t\t\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\t\t\tvar a = el[i];\n\t\t\t\t\t\t\tposition(a.offset);\n\t\t\t\t\t\t\ta.locator = copyLocator(locator, {});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomBuilder.locator = locator2;\n\t\t\t\t\t\tif (appendElement(el, domBuilder, currentNSMap)) {\n\t\t\t\t\t\t\tparseStack.push(el);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomBuilder.locator = locator;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (appendElement(el, domBuilder, currentNSMap)) {\n\t\t\t\t\t\t\tparseStack.push(el);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isHTML && !el.closed) {\n\t\t\t\t\t\tend = parseHtmlSpecialContent(source, end, el.tagName, entityReplacer, domBuilder);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tend++;\n\t\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tif (e instanceof ParseError) {\n\t\t\t\tthrow e;\n\t\t\t} else if (e instanceof DOMException) {\n\t\t\t\tthrow new ParseError(e.name + ': ' + e.message, domBuilder.locator, e);\n\t\t\t}\n\t\t\terrorHandler.error('element parse error: ' + e);\n\t\t\tend = -1;\n\t\t}\n\t\tif (end > start) {\n\t\t\tstart = end;\n\t\t} else {\n\t\t\t//Possible sax fallback here, risk of positional error\n\t\t\tappendText(Math.max(tagStart, start) + 1);\n\t\t}\n\t}\n}\n\nfunction copyLocator(f, t) {\n\tt.lineNumber = f.lineNumber;\n\tt.columnNumber = f.columnNumber;\n\treturn t;\n}\n\n/**\n * @returns\n * end of the elementStartPart(end of elementEndPart for selfClosed el)\n * @see {@link #appendElement}\n */\nfunction parseElementStartPart(source, start, el, currentNSMap, entityReplacer, errorHandler, isHTML) {\n\t/**\n\t * @param {string} qname\n\t * @param {string} value\n\t * @param {number} startIndex\n\t */\n\tfunction addAttribute(qname, value, startIndex) {\n\t\tif (hasOwn(el.attributeNames, qname)) {\n\t\t\treturn errorHandler.fatalError('Attribute ' + qname + ' redefined');\n\t\t}\n\t\tif (!isHTML && value.indexOf('<') >= 0) {\n\t\t\treturn errorHandler.fatalError(\"Unescaped '<' not allowed in attributes values\");\n\t\t}\n\t\tel.addValue(\n\t\t\tqname,\n\t\t\t// @see https://www.w3.org/TR/xml/#AVNormalize\n\t\t\t// since the xmldom sax parser does not \"interpret\" DTD the following is not implemented:\n\t\t\t// - recursive replacement of (DTD) entity references\n\t\t\t// - trimming and collapsing multiple spaces into a single one for attributes that are not of type CDATA\n\t\t\tvalue.replace(/[\\t\\n\\r]/g, ' ').replace(ENTITY_REG, entityReplacer),\n\t\t\tstartIndex\n\t\t);\n\t}\n\n\tvar attrName;\n\tvar value;\n\tvar p = ++start;\n\tvar s = S_TAG; //status\n\twhile (true) {\n\t\tvar c = source.charAt(p);\n\t\tswitch (c) {\n\t\t\tcase '=':\n\t\t\t\tif (s === S_ATTR) {\n\t\t\t\t\t//attrName\n\t\t\t\t\tattrName = source.slice(start, p);\n\t\t\t\t\ts = S_EQ;\n\t\t\t\t} else if (s === S_ATTR_SPACE) {\n\t\t\t\t\ts = S_EQ;\n\t\t\t\t} else {\n\t\t\t\t\t//fatalError: equal must after attrName or space after attrName\n\t\t\t\t\tthrow new Error('attribute equal must after attrName'); // No known test case\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"'\":\n\t\t\tcase '\"':\n\t\t\t\tif (\n\t\t\t\t\ts === S_EQ ||\n\t\t\t\t\ts === S_ATTR //|| s == S_ATTR_SPACE\n\t\t\t\t) {\n\t\t\t\t\t//equal\n\t\t\t\t\tif (s === S_ATTR) {\n\t\t\t\t\t\terrorHandler.warning('attribute value must after \"=\"');\n\t\t\t\t\t\tattrName = source.slice(start, p);\n\t\t\t\t\t}\n\t\t\t\t\tstart = p + 1;\n\t\t\t\t\tp = source.indexOf(c, start);\n\t\t\t\t\tif (p > 0) {\n\t\t\t\t\t\tvalue = source.slice(start, p);\n\t\t\t\t\t\taddAttribute(attrName, value, start - 1);\n\t\t\t\t\t\ts = S_ATTR_END;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//fatalError: no end quot match\n\t\t\t\t\t\tthrow new Error(\"attribute value no end '\" + c + \"' match\");\n\t\t\t\t\t}\n\t\t\t\t} else if (s == S_ATTR_NOQUOT_VALUE) {\n\t\t\t\t\tvalue = source.slice(start, p);\n\t\t\t\t\taddAttribute(attrName, value, start);\n\t\t\t\t\terrorHandler.warning('attribute \"' + attrName + '\" missed start quot(' + c + ')!!');\n\t\t\t\t\tstart = p + 1;\n\t\t\t\t\ts = S_ATTR_END;\n\t\t\t\t} else {\n\t\t\t\t\t//fatalError: no equal before\n\t\t\t\t\tthrow new Error('attribute value must after \"=\"'); // No known test case\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase '/':\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase S_TAG:\n\t\t\t\t\t\tel.setTagName(source.slice(start, p));\n\t\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\tcase S_TAG_SPACE:\n\t\t\t\t\tcase S_TAG_CLOSE:\n\t\t\t\t\t\ts = S_TAG_CLOSE;\n\t\t\t\t\t\tel.closed = true;\n\t\t\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\t\t\tcase S_ATTR:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase S_ATTR_SPACE:\n\t\t\t\t\t\tel.closed = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//case S_EQ:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(\"attribute invalid close char('/')\"); // No known test case\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase '': //end document\n\t\t\t\terrorHandler.error('unexpected end of input');\n\t\t\t\tif (s == S_TAG) {\n\t\t\t\t\tel.setTagName(source.slice(start, p));\n\t\t\t\t}\n\t\t\t\treturn p;\n\t\t\tcase '>':\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase S_TAG:\n\t\t\t\t\t\tel.setTagName(source.slice(start, p));\n\t\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\tcase S_TAG_SPACE:\n\t\t\t\t\tcase S_TAG_CLOSE:\n\t\t\t\t\t\tbreak; //normal\n\t\t\t\t\tcase S_ATTR_NOQUOT_VALUE: //Compatible state\n\t\t\t\t\tcase S_ATTR:\n\t\t\t\t\t\tvalue = source.slice(start, p);\n\t\t\t\t\t\tif (value.slice(-1) === '/') {\n\t\t\t\t\t\t\tel.closed = true;\n\t\t\t\t\t\t\tvalue = value.slice(0, -1);\n\t\t\t\t\t\t}\n\t\t\t\t\tcase S_ATTR_SPACE:\n\t\t\t\t\t\tif (s === S_ATTR_SPACE) {\n\t\t\t\t\t\t\tvalue = attrName;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (s == S_ATTR_NOQUOT_VALUE) {\n\t\t\t\t\t\t\terrorHandler.warning('attribute \"' + value + '\" missed quot(\")!');\n\t\t\t\t\t\t\taddAttribute(attrName, value, start);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!isHTML) {\n\t\t\t\t\t\t\t\terrorHandler.warning('attribute \"' + value + '\" missed value!! \"' + value + '\" instead!!');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taddAttribute(value, value, start);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase S_EQ:\n\t\t\t\t\t\tif (!isHTML) {\n\t\t\t\t\t\t\treturn errorHandler.fatalError('AttValue: \\' or \" expected');\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn p;\n\t\t\t/*xml space '\\x20' | #x9 | #xD | #xA; */\n\t\t\tcase '\\u0080':\n\t\t\t\tc = ' ';\n\t\t\tdefault:\n\t\t\t\tif (c <= ' ') {\n\t\t\t\t\t//space\n\t\t\t\t\tswitch (s) {\n\t\t\t\t\t\tcase S_TAG:\n\t\t\t\t\t\t\tel.setTagName(source.slice(start, p)); //tagName\n\t\t\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase S_ATTR:\n\t\t\t\t\t\t\tattrName = source.slice(start, p);\n\t\t\t\t\t\t\ts = S_ATTR_SPACE;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\t\t\t\t\tvar value = source.slice(start, p);\n\t\t\t\t\t\t\terrorHandler.warning('attribute \"' + value + '\" missed quot(\")!!');\n\t\t\t\t\t\t\taddAttribute(attrName, value, start);\n\t\t\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t//case S_TAG_SPACE:\n\t\t\t\t\t\t//case S_EQ:\n\t\t\t\t\t\t//case S_ATTR_SPACE:\n\t\t\t\t\t\t//\tvoid();break;\n\t\t\t\t\t\t//case S_TAG_CLOSE:\n\t\t\t\t\t\t//ignore warning\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//not space\n\t\t\t\t\t//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n\t\t\t\t\t//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\n\t\t\t\t\tswitch (s) {\n\t\t\t\t\t\t//case S_TAG:void();break;\n\t\t\t\t\t\t//case S_ATTR:void();break;\n\t\t\t\t\t\t//case S_ATTR_NOQUOT_VALUE:void();break;\n\t\t\t\t\t\tcase S_ATTR_SPACE:\n\t\t\t\t\t\t\tif (!isHTML) {\n\t\t\t\t\t\t\t\terrorHandler.warning('attribute \"' + attrName + '\" missed value!! \"' + attrName + '\" instead2!!');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taddAttribute(attrName, attrName, start);\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\t\t\terrorHandler.warning('attribute space is required\"' + attrName + '\"!!');\n\t\t\t\t\t\tcase S_TAG_SPACE:\n\t\t\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase S_EQ:\n\t\t\t\t\t\t\ts = S_ATTR_NOQUOT_VALUE;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase S_TAG_CLOSE:\n\t\t\t\t\t\t\tthrow new Error(\"elements closed character '/' and '>' must be connected to\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t} //end outer switch\n\t\tp++;\n\t}\n}\n\n/**\n * @returns\n * `true` if a new namespace has been defined.\n */\nfunction appendElement(el, domBuilder, currentNSMap) {\n\tvar tagName = el.tagName;\n\tvar localNSMap = null;\n\tvar i = el.length;\n\twhile (i--) {\n\t\tvar a = el[i];\n\t\tvar qName = a.qName;\n\t\tvar value = a.value;\n\t\tvar nsp = qName.indexOf(':');\n\t\tif (nsp > 0) {\n\t\t\tvar prefix = (a.prefix = qName.slice(0, nsp));\n\t\t\tvar localName = qName.slice(nsp + 1);\n\t\t\tvar nsPrefix = prefix === 'xmlns' && localName;\n\t\t} else {\n\t\t\tlocalName = qName;\n\t\t\tprefix = null;\n\t\t\tnsPrefix = qName === 'xmlns' && '';\n\t\t}\n\t\t//can not set prefix,because prefix !== ''\n\t\ta.localName = localName;\n\t\t//prefix == null for no ns prefix attribute\n\t\tif (nsPrefix !== false) {\n\t\t\t//hack!!\n\t\t\tif (localNSMap == null) {\n\t\t\t\tlocalNSMap = Object.create(null);\n\t\t\t\t_copy(currentNSMap, (currentNSMap = Object.create(null)));\n\t\t\t}\n\t\t\tcurrentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;\n\t\t\ta.uri = NAMESPACE.XMLNS;\n\t\t\tdomBuilder.startPrefixMapping(nsPrefix, value);\n\t\t}\n\t}\n\tvar i = el.length;\n\twhile (i--) {\n\t\ta = el[i];\n\t\tif (a.prefix) {\n\t\t\t//no prefix attribute has no namespace\n\t\t\tif (a.prefix === 'xml') {\n\t\t\t\ta.uri = NAMESPACE.XML;\n\t\t\t}\n\t\t\tif (a.prefix !== 'xmlns') {\n\t\t\t\ta.uri = currentNSMap[a.prefix];\n\t\t\t}\n\t\t}\n\t}\n\tvar nsp = tagName.indexOf(':');\n\tif (nsp > 0) {\n\t\tprefix = el.prefix = tagName.slice(0, nsp);\n\t\tlocalName = el.localName = tagName.slice(nsp + 1);\n\t} else {\n\t\tprefix = null; //important!!\n\t\tlocalName = el.localName = tagName;\n\t}\n\t//no prefix element has default namespace\n\tvar ns = (el.uri = currentNSMap[prefix || '']);\n\tdomBuilder.startElement(ns, localName, tagName, el);\n\t//endPrefixMapping and startPrefixMapping have not any help for dom builder\n\t//localNSMap = null\n\tif (el.closed) {\n\t\tdomBuilder.endElement(ns, localName, tagName);\n\t\tif (localNSMap) {\n\t\t\tfor (prefix in localNSMap) {\n\t\t\t\tif (hasOwn(localNSMap, prefix)) {\n\t\t\t\t\tdomBuilder.endPrefixMapping(prefix);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tel.currentNSMap = currentNSMap;\n\t\tel.localNSMap = localNSMap;\n\t\t//parseStack.push(el);\n\t\treturn true;\n\t}\n}\n\nfunction parseHtmlSpecialContent(source, elStartEnd, tagName, entityReplacer, domBuilder) {\n\t// https://html.spec.whatwg.org/#raw-text-elements\n\t// https://html.spec.whatwg.org/#escapable-raw-text-elements\n\t// https://html.spec.whatwg.org/#cdata-rcdata-restrictions:raw-text-elements\n\t// TODO: https://html.spec.whatwg.org/#cdata-rcdata-restrictions\n\tvar isEscapableRaw = isHTMLEscapableRawTextElement(tagName);\n\tif (isEscapableRaw || isHTMLRawTextElement(tagName)) {\n\t\tvar elEndStart = source.indexOf('</' + tagName + '>', elStartEnd);\n\t\tvar text = source.substring(elStartEnd + 1, elEndStart);\n\n\t\tif (isEscapableRaw) {\n\t\t\ttext = text.replace(ENTITY_REG, entityReplacer);\n\t\t}\n\t\tdomBuilder.characters(text, 0, text.length);\n\t\treturn elEndStart;\n\t}\n\treturn elStartEnd + 1;\n}\n\nfunction _copy(source, target) {\n\tfor (var n in source) {\n\t\tif (hasOwn(source, n)) {\n\t\t\ttarget[n] = source[n];\n\t\t}\n\t}\n}\n\n/**\n * @typedef ParseUtils\n * @property {function(relativeIndex: number?): string | undefined} char\n * Provides look ahead access to a singe character relative to the current index.\n * @property {function(): number} getIndex\n * Provides read-only access to the current index.\n * @property {function(reg: RegExp): string | null} getMatch\n * Applies the provided regular expression enforcing that it starts at the current index and\n * returns the complete matching string,\n * and moves the current index by the length of the matching string.\n * @property {function(): string} getSource\n * Provides read-only access to the complete source.\n * @property {function(places: number?): void} skip\n * moves the current index by places (defaults to 1)\n * @property {function(): number} skipBlanks\n * Moves the current index by the amount of white space that directly follows the current index\n * and returns the amount of whitespace chars skipped (0..n),\n * or -1 if the end of the source was reached.\n * @property {function(): string} substringFromIndex\n * creates a substring from the current index to the end of `source`\n * @property {function(compareWith: string): boolean} substringStartsWith\n * Checks if `source` contains `compareWith`, starting from the current index.\n * @property {function(compareWith: string): boolean} substringStartsWithCaseInsensitive\n * Checks if `source` contains `compareWith`, starting from the current index,\n * comparing the upper case of both sides.\n * @see {@link parseUtils}\n */\n\n/**\n * A temporary scope for parsing and look ahead operations in `source`,\n * starting from index `start`.\n *\n * Some operations move the current index by a number of positions,\n * after which `getIndex` returns the new index.\n *\n * @param {string} source\n * @param {number} start\n * @returns {ParseUtils}\n */\nfunction parseUtils(source, start) {\n\tvar index = start;\n\n\tfunction char(n) {\n\t\tn = n || 0;\n\t\treturn source.charAt(index + n);\n\t}\n\n\tfunction skip(n) {\n\t\tn = n || 1;\n\t\tindex += n;\n\t}\n\n\tfunction skipBlanks() {\n\t\tvar blanks = 0;\n\t\twhile (index < source.length) {\n\t\t\tvar c = char();\n\t\t\tif (c !== ' ' && c !== '\\n' && c !== '\\t' && c !== '\\r') {\n\t\t\t\treturn blanks;\n\t\t\t}\n\t\t\tblanks++;\n\t\t\tskip();\n\t\t}\n\t\treturn -1;\n\t}\n\tfunction substringFromIndex() {\n\t\treturn source.substring(index);\n\t}\n\tfunction substringStartsWith(text) {\n\t\treturn source.substring(index, index + text.length) === text;\n\t}\n\tfunction substringStartsWithCaseInsensitive(text) {\n\t\treturn source.substring(index, index + text.length).toUpperCase() === text.toUpperCase();\n\t}\n\n\tfunction getMatch(args) {\n\t\tvar expr = g.reg('^', args);\n\t\tvar match = expr.exec(substringFromIndex());\n\t\tif (match) {\n\t\t\tskip(match[0].length);\n\t\t\treturn match[0];\n\t\t}\n\t\treturn null;\n\t}\n\treturn {\n\t\tchar: char,\n\t\tgetIndex: function () {\n\t\t\treturn index;\n\t\t},\n\t\tgetMatch: getMatch,\n\t\tgetSource: function () {\n\t\t\treturn source;\n\t\t},\n\t\tskip: skip,\n\t\tskipBlanks: skipBlanks,\n\t\tsubstringFromIndex: substringFromIndex,\n\t\tsubstringStartsWith: substringStartsWith,\n\t\tsubstringStartsWithCaseInsensitive: substringStartsWithCaseInsensitive,\n\t};\n}\n\n/**\n * @param {ParseUtils} p\n * @param {DOMHandler} errorHandler\n * @returns {string}\n */\nfunction parseDoctypeInternalSubset(p, errorHandler) {\n\t/**\n\t * @param {ParseUtils} p\n\t * @param {DOMHandler} errorHandler\n\t * @returns {string}\n\t */\n\tfunction parsePI(p, errorHandler) {\n\t\tvar match = g.PI.exec(p.substringFromIndex());\n\t\tif (!match) {\n\t\t\treturn errorHandler.fatalError('processing instruction is not well-formed at position ' + p.getIndex());\n\t\t}\n\t\tif (match[1].toLowerCase() === 'xml') {\n\t\t\treturn errorHandler.fatalError(\n\t\t\t\t'xml declaration is only allowed at the start of the document, but found at position ' + p.getIndex()\n\t\t\t);\n\t\t}\n\t\tp.skip(match[0].length);\n\t\treturn match[0];\n\t}\n\t// Parse internal subset\n\tvar source = p.getSource();\n\tif (p.char() === '[') {\n\t\tp.skip(1);\n\t\tvar intSubsetStart = p.getIndex();\n\t\twhile (p.getIndex() < source.length) {\n\t\t\tp.skipBlanks();\n\t\t\tif (p.char() === ']') {\n\t\t\t\tvar internalSubset = source.substring(intSubsetStart, p.getIndex());\n\t\t\t\tp.skip(1);\n\t\t\t\treturn internalSubset;\n\t\t\t}\n\t\t\tvar current = null;\n\t\t\t// Only in external subset\n\t\t\t// if (char() === '<' && char(1) === '!' && char(2) === '[') {\n\t\t\t// \tparseConditionalSections(p, errorHandler);\n\t\t\t// } else\n\t\t\tif (p.char() === '<' && p.char(1) === '!') {\n\t\t\t\tswitch (p.char(2)) {\n\t\t\t\t\tcase 'E': // ELEMENT | ENTITY\n\t\t\t\t\t\tif (p.char(3) === 'L') {\n\t\t\t\t\t\t\tcurrent = p.getMatch(g.elementdecl);\n\t\t\t\t\t\t} else if (p.char(3) === 'N') {\n\t\t\t\t\t\t\tcurrent = p.getMatch(g.EntityDecl);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'A': // ATTRIBUTE\n\t\t\t\t\t\tcurrent = p.getMatch(g.AttlistDecl);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'N': // NOTATION\n\t\t\t\t\t\tcurrent = p.getMatch(g.NotationDecl);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '-': // COMMENT\n\t\t\t\t\t\tcurrent = p.getMatch(g.Comment);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (p.char() === '<' && p.char(1) === '?') {\n\t\t\t\tcurrent = parsePI(p, errorHandler);\n\t\t\t} else if (p.char() === '%') {\n\t\t\t\tcurrent = p.getMatch(g.PEReference);\n\t\t\t} else {\n\t\t\t\treturn errorHandler.fatalError('Error detected in Markup declaration');\n\t\t\t}\n\t\t\tif (!current) {\n\t\t\t\treturn errorHandler.fatalError('Error in internal subset at position ' + p.getIndex());\n\t\t\t}\n\t\t}\n\t\treturn errorHandler.fatalError('doctype internal subset is not well-formed, missing ]');\n\t}\n}\n\n/**\n * Called when the parser encounters an element starting with '<!'.\n *\n * @param {string} source\n * The xml.\n * @param {number} start\n * the start index of the '<!'\n * @param {DOMHandler} domBuilder\n * @param {DOMHandler} errorHandler\n * @param {boolean} isHTML\n * @returns {number | never}\n * The end index of the element.\n * @throws {ParseError}\n * In case the element is not well-formed.\n */\nfunction parseDoctypeCommentOrCData(source, start, domBuilder, errorHandler, isHTML) {\n\tvar p = parseUtils(source, start);\n\n\tswitch (isHTML ? p.char(2).toUpperCase() : p.char(2)) {\n\t\tcase '-':\n\t\t\t// should be a comment\n\t\t\tvar comment = p.getMatch(g.Comment);\n\t\t\tif (comment) {\n\t\t\t\tdomBuilder.comment(comment, g.COMMENT_START.length, comment.length - g.COMMENT_START.length - g.COMMENT_END.length);\n\t\t\t\treturn p.getIndex();\n\t\t\t} else {\n\t\t\t\treturn errorHandler.fatalError('comment is not well-formed at position ' + p.getIndex());\n\t\t\t}\n\t\tcase '[':\n\t\t\t// should be CDATA\n\t\t\tvar cdata = p.getMatch(g.CDSect);\n\t\t\tif (cdata) {\n\t\t\t\tif (!isHTML && !domBuilder.currentElement) {\n\t\t\t\t\treturn errorHandler.fatalError('CDATA outside of element');\n\t\t\t\t}\n\t\t\t\tdomBuilder.startCDATA();\n\t\t\t\tdomBuilder.characters(cdata, g.CDATA_START.length, cdata.length - g.CDATA_START.length - g.CDATA_END.length);\n\t\t\t\tdomBuilder.endCDATA();\n\t\t\t\treturn p.getIndex();\n\t\t\t} else {\n\t\t\t\treturn errorHandler.fatalError('Invalid CDATA starting at position ' + start);\n\t\t\t}\n\t\tcase 'D': {\n\t\t\t// should be DOCTYPE\n\t\t\tif (domBuilder.doc && domBuilder.doc.documentElement) {\n\t\t\t\treturn errorHandler.fatalError('Doctype not allowed inside or after documentElement at position ' + p.getIndex());\n\t\t\t}\n\t\t\tif (isHTML ? !p.substringStartsWithCaseInsensitive(g.DOCTYPE_DECL_START) : !p.substringStartsWith(g.DOCTYPE_DECL_START)) {\n\t\t\t\treturn errorHandler.fatalError('Expected ' + g.DOCTYPE_DECL_START + ' at position ' + p.getIndex());\n\t\t\t}\n\t\t\tp.skip(g.DOCTYPE_DECL_START.length);\n\t\t\tif (p.skipBlanks() < 1) {\n\t\t\t\treturn errorHandler.fatalError('Expected whitespace after ' + g.DOCTYPE_DECL_START + ' at position ' + p.getIndex());\n\t\t\t}\n\n\t\t\tvar doctype = {\n\t\t\t\tname: undefined,\n\t\t\t\tpublicId: undefined,\n\t\t\t\tsystemId: undefined,\n\t\t\t\tinternalSubset: undefined,\n\t\t\t};\n\t\t\t// Parse the DOCTYPE name\n\t\t\tdoctype.name = p.getMatch(g.Name);\n\t\t\tif (!doctype.name)\n\t\t\t\treturn errorHandler.fatalError('doctype name missing or contains unexpected characters at position ' + p.getIndex());\n\n\t\t\tif (isHTML && doctype.name.toLowerCase() !== 'html') {\n\t\t\t\terrorHandler.warning('Unexpected DOCTYPE in HTML document at position ' + p.getIndex());\n\t\t\t}\n\t\t\tp.skipBlanks();\n\n\t\t\t// Check for ExternalID\n\t\t\tif (p.substringStartsWith(g.PUBLIC) || p.substringStartsWith(g.SYSTEM)) {\n\t\t\t\tvar match = g.ExternalID_match.exec(p.substringFromIndex());\n\t\t\t\tif (!match) {\n\t\t\t\t\treturn errorHandler.fatalError('doctype external id is not well-formed at position ' + p.getIndex());\n\t\t\t\t}\n\t\t\t\tif (match.groups.SystemLiteralOnly !== undefined) {\n\t\t\t\t\tdoctype.systemId = match.groups.SystemLiteralOnly;\n\t\t\t\t} else {\n\t\t\t\t\tdoctype.systemId = match.groups.SystemLiteral;\n\t\t\t\t\tdoctype.publicId = match.groups.PubidLiteral;\n\t\t\t\t}\n\t\t\t\tp.skip(match[0].length);\n\t\t\t} else if (isHTML && p.substringStartsWithCaseInsensitive(g.SYSTEM)) {\n\t\t\t\t// https://html.spec.whatwg.org/multipage/syntax.html#doctype-legacy-string\n\t\t\t\tp.skip(g.SYSTEM.length);\n\t\t\t\tif (p.skipBlanks() < 1) {\n\t\t\t\t\treturn errorHandler.fatalError('Expected whitespace after ' + g.SYSTEM + ' at position ' + p.getIndex());\n\t\t\t\t}\n\t\t\t\tdoctype.systemId = p.getMatch(g.ABOUT_LEGACY_COMPAT_SystemLiteral);\n\t\t\t\tif (!doctype.systemId) {\n\t\t\t\t\treturn errorHandler.fatalError(\n\t\t\t\t\t\t'Expected ' + g.ABOUT_LEGACY_COMPAT + ' in single or double quotes after ' + g.SYSTEM + ' at position ' + p.getIndex()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isHTML && doctype.systemId && !g.ABOUT_LEGACY_COMPAT_SystemLiteral.test(doctype.systemId)) {\n\t\t\t\terrorHandler.warning('Unexpected doctype.systemId in HTML document at position ' + p.getIndex());\n\t\t\t}\n\t\t\tif (!isHTML) {\n\t\t\t\tp.skipBlanks();\n\t\t\t\tdoctype.internalSubset = parseDoctypeInternalSubset(p, errorHandler);\n\t\t\t}\n\t\t\tp.skipBlanks();\n\t\t\tif (p.char() !== '>') {\n\t\t\t\treturn errorHandler.fatalError('doctype not terminated with > at position ' + p.getIndex());\n\t\t\t}\n\t\t\tp.skip(1);\n\t\t\tdomBuilder.startDTD(doctype.name, doctype.publicId, doctype.systemId, doctype.internalSubset);\n\t\t\tdomBuilder.endDTD();\n\t\t\treturn p.getIndex();\n\t\t}\n\t\tdefault:\n\t\t\treturn errorHandler.fatalError('Not well-formed XML starting with \"<!\" at position ' + start);\n\t}\n}\n\nfunction parseProcessingInstruction(source, start, domBuilder, errorHandler) {\n\tvar match = source.substring(start).match(g.PI);\n\tif (!match) {\n\t\treturn errorHandler.fatalError('Invalid processing instruction starting at position ' + start);\n\t}\n\tif (match[1].toLowerCase() === 'xml') {\n\t\tif (start > 0) {\n\t\t\treturn errorHandler.fatalError(\n\t\t\t\t'processing instruction at position ' + start + ' is an xml declaration which is only at the start of the document'\n\t\t\t);\n\t\t}\n\t\tif (!g.XMLDecl.test(source.substring(start))) {\n\t\t\treturn errorHandler.fatalError('xml declaration is not well-formed');\n\t\t}\n\t}\n\tdomBuilder.processingInstruction(match[1], match[2]);\n\treturn start + match[0].length;\n}\n\nfunction ElementAttributes() {\n\tthis.attributeNames = Object.create(null);\n}\n\nElementAttributes.prototype = {\n\tsetTagName: function (tagName) {\n\t\tif (!g.QName_exact.test(tagName)) {\n\t\t\tthrow new Error('invalid tagName:' + tagName);\n\t\t}\n\t\tthis.tagName = tagName;\n\t},\n\taddValue: function (qName, value, offset) {\n\t\tif (!g.QName_exact.test(qName)) {\n\t\t\tthrow new Error('invalid attribute:' + qName);\n\t\t}\n\t\tthis.attributeNames[qName] = this.length;\n\t\tthis[this.length++] = { qName: qName, value: value, offset: offset };\n\t},\n\tlength: 0,\n\tgetLocalName: function (i) {\n\t\treturn this[i].localName;\n\t},\n\tgetLocator: function (i) {\n\t\treturn this[i].locator;\n\t},\n\tgetQName: function (i) {\n\t\treturn this[i].qName;\n\t},\n\tgetURI: function (i) {\n\t\treturn this[i].uri;\n\t},\n\tgetValue: function (i) {\n\t\treturn this[i].value;\n\t},\n\t//\t,getIndex:function(uri, localName)){\n\t//\t\tif(localName){\n\t//\n\t//\t\t}else{\n\t//\t\t\tvar qName = uri\n\t//\t\t}\n\t//\t},\n\t//\tgetValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},\n\t//\tgetType:function(uri,localName){}\n\t//\tgetType:function(i){},\n};\n\nexports.XMLReader = XMLReader;\nexports.parseUtils = parseUtils;\nexports.parseDoctypeCommentOrCData = parseDoctypeCommentOrCData;\n","'use strict';\n\n/**\n * Ponyfill for `Array.prototype.find` which is only available in ES6 runtimes.\n *\n * Works with anything that has a `length` property and index access properties,\n * including NodeList.\n *\n * @param {T[] | { length: number; [number]: T }} list\n * @param {function (item: T, index: number, list:T[]):boolean} predicate\n * @param {Partial<Pick<ArrayConstructor['prototype'], 'find'>>?} ac\n * Allows injecting a custom implementation in tests (`Array.prototype` by default).\n * @returns {T | undefined}\n * @template {unknown} T\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\n * @see https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.find\n */\nfunction find(list, predicate, ac) {\n\tif (ac === undefined) {\n\t\tac = Array.prototype;\n\t}\n\tif (list && typeof ac.find === 'function') {\n\t\treturn ac.find.call(list, predicate);\n\t}\n\tfor (var i = 0; i < list.length; i++) {\n\t\tif (hasOwn(list, i)) {\n\t\t\tvar item = list[i];\n\t\t\tif (predicate.call(undefined, item, i, list)) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * \"Shallow freezes\" an object to render it immutable.\n * Uses `Object.freeze` if available,\n * otherwise the immutability is only in the type.\n *\n * Is used to create \"enum like\" objects.\n *\n * If `Object.getOwnPropertyDescriptors` is available,\n * a new object with all properties of object but without any prototype is created and returned\n * after freezing it.\n *\n * @param {T} object\n * The object to freeze.\n * @param {Pick<ObjectConstructor, 'create' | 'freeze' | 'getOwnPropertyDescriptors'>} [oc=Object]\n * `Object` by default,\n * allows to inject custom object constructor for tests.\n * @returns {Readonly<T>}\n * @template {Object} T\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze\n * @prettierignore\n */\nfunction freeze(object, oc) {\n\tif (oc === undefined) {\n\t\toc = Object;\n\t}\n\tif (oc && typeof oc.getOwnPropertyDescriptors === 'function') {\n\t\tobject = oc.create(null, oc.getOwnPropertyDescriptors(object));\n\t}\n\treturn oc && typeof oc.freeze === 'function' ? oc.freeze(object) : object;\n}\n\n/**\n * Implementation for `Object.hasOwn` but ES5 compatible.\n *\n * @param {any} object\n * @param {string | number} key\n * @returns {boolean}\n */\nfunction hasOwn(object, key) {\n\treturn Object.prototype.hasOwnProperty.call(object, key);\n}\n\n/**\n * Since xmldom can not rely on `Object.assign`,\n * it uses/provides a simplified version that is sufficient for its needs.\n *\n * @param {Object} target\n * @param {Object | null | undefined} source\n * @returns {Object}\n * The target with the merged/overridden properties.\n * @throws {TypeError}\n * If target is not an object.\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n * @see https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object.assign\n */\nfunction assign(target, source) {\n\tif (target === null || typeof target !== 'object') {\n\t\tthrow new TypeError('target is not an object');\n\t}\n\tfor (var key in source) {\n\t\tif (hasOwn(source, key)) {\n\t\t\ttarget[key] = source[key];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * A number of attributes are boolean attributes.\n * The presence of a boolean attribute on an element represents the `true` value,\n * and the absence of the attribute represents the `false` value.\n *\n * If the attribute is present, its value must either be the empty string, or a value that is\n * an ASCII case-insensitive match for the attribute's canonical name,\n * with no leading or trailing whitespace.\n *\n * Note: The values `\"true\"` and `\"false\"` are not allowed on boolean attributes.\n * To represent a `false` value, the attribute has to be omitted altogether.\n *\n * @see https://html.spec.whatwg.org/#boolean-attributes\n * @see https://html.spec.whatwg.org/#attributes-3\n */\nvar HTML_BOOLEAN_ATTRIBUTES = freeze({\n\tallowfullscreen: true,\n\tasync: true,\n\tautofocus: true,\n\tautoplay: true,\n\tchecked: true,\n\tcontrols: true,\n\tdefault: true,\n\tdefer: true,\n\tdisabled: true,\n\tformnovalidate: true,\n\thidden: true,\n\tismap: true,\n\titemscope: true,\n\tloop: true,\n\tmultiple: true,\n\tmuted: true,\n\tnomodule: true,\n\tnovalidate: true,\n\topen: true,\n\tplaysinline: true,\n\treadonly: true,\n\trequired: true,\n\treversed: true,\n\tselected: true,\n});\n\n/**\n * Check if `name` is matching one of the HTML boolean attribute names.\n * This method doesn't check if such attributes are allowed in the context of the current\n * document/parsing.\n *\n * @param {string} name\n * @returns {boolean}\n * @see {@link HTML_BOOLEAN_ATTRIBUTES}\n * @see https://html.spec.whatwg.org/#boolean-attributes\n * @see https://html.spec.whatwg.org/#attributes-3\n */\nfunction isHTMLBooleanAttribute(name) {\n\treturn hasOwn(HTML_BOOLEAN_ATTRIBUTES, name.toLowerCase());\n}\n\n/**\n * Void elements only have a start tag; end tags must not be specified for void elements.\n * These elements should be written as self-closing like this: `<area />`.\n * This should not be confused with optional tags that HTML allows to omit the end tag for\n * (like `li`, `tr` and others), which can have content after them,\n * so they can not be written as self-closing.\n * xmldom does not have any logic for optional end tags cases,\n * and will report them as a warning.\n * Content that would go into the unopened element,\n * will instead be added as a sibling text node.\n *\n * @type {Readonly<{\n * \tarea: boolean;\n * \tcol: boolean;\n * \timg: boolean;\n * \twbr: boolean;\n * \tlink: boolean;\n * \thr: boolean;\n * \tsource: boolean;\n * \tbr: boolean;\n * \tinput: boolean;\n * \tparam: boolean;\n * \tmeta: boolean;\n * \tembed: boolean;\n * \ttrack: boolean;\n * \tbase: boolean;\n * }>}\n * @see https://html.spec.whatwg.org/#void-elements\n * @see https://html.spec.whatwg.org/#optional-tags\n */\nvar HTML_VOID_ELEMENTS = freeze({\n\tarea: true,\n\tbase: true,\n\tbr: true,\n\tcol: true,\n\tembed: true,\n\thr: true,\n\timg: true,\n\tinput: true,\n\tlink: true,\n\tmeta: true,\n\tparam: true,\n\tsource: true,\n\ttrack: true,\n\twbr: true,\n});\n\n/**\n * Check if `tagName` is matching one of the HTML void element names.\n * This method doesn't check if such tags are allowed in the context of the current\n * document/parsing.\n *\n * @param {string} tagName\n * @returns {boolean}\n * @see {@link HTML_VOID_ELEMENTS}\n * @see https://html.spec.whatwg.org/#void-elements\n */\nfunction isHTMLVoidElement(tagName) {\n\treturn hasOwn(HTML_VOID_ELEMENTS, tagName.toLowerCase());\n}\n\n/**\n * Tag names that are raw text elements according to HTML spec.\n * The value denotes whether they are escapable or not.\n *\n * @see {@link isHTMLEscapableRawTextElement}\n * @see {@link isHTMLRawTextElement}\n * @see https://html.spec.whatwg.org/#raw-text-elements\n * @see https://html.spec.whatwg.org/#escapable-raw-text-elements\n */\nvar HTML_RAW_TEXT_ELEMENTS = freeze({\n\tscript: false,\n\tstyle: false,\n\ttextarea: true,\n\ttitle: true,\n});\n\n/**\n * Check if `tagName` is matching one of the HTML raw text element names.\n * This method doesn't check if such tags are allowed in the context of the current\n * document/parsing.\n *\n * @param {string} tagName\n * @returns {boolean}\n * @see {@link isHTMLEscapableRawTextElement}\n * @see {@link HTML_RAW_TEXT_ELEMENTS}\n * @see https://html.spec.whatwg.org/#raw-text-elements\n * @see https://html.spec.whatwg.org/#escapable-raw-text-elements\n */\nfunction isHTMLRawTextElement(tagName) {\n\tvar key = tagName.toLowerCase();\n\treturn hasOwn(HTML_RAW_TEXT_ELEMENTS, key) && !HTML_RAW_TEXT_ELEMENTS[key];\n}\n/**\n * Check if `tagName` is matching one of the HTML escapable raw text element names.\n * This method doesn't check if such tags are allowed in the context of the current\n * document/parsing.\n *\n * @param {string} tagName\n * @returns {boolean}\n * @see {@link isHTMLRawTextElement}\n * @see {@link HTML_RAW_TEXT_ELEMENTS}\n * @see https://html.spec.whatwg.org/#raw-text-elements\n * @see https://html.spec.whatwg.org/#escapable-raw-text-elements\n */\nfunction isHTMLEscapableRawTextElement(tagName) {\n\tvar key = tagName.toLowerCase();\n\treturn hasOwn(HTML_RAW_TEXT_ELEMENTS, key) && HTML_RAW_TEXT_ELEMENTS[key];\n}\n/**\n * Only returns true if `value` matches MIME_TYPE.HTML, which indicates an HTML document.\n *\n * @param {string} mimeType\n * @returns {mimeType is 'text/html'}\n * @see https://www.iana.org/assignments/media-types/text/html\n * @see https://en.wikipedia.org/wiki/HTML\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-domparser-parsefromstring\n */\nfunction isHTMLMimeType(mimeType) {\n\treturn mimeType === MIME_TYPE.HTML;\n}\n/**\n * For both the `text/html` and the `application/xhtml+xml` namespace the spec defines that the\n * HTML namespace is provided as the default.\n *\n * @param {string} mimeType\n * @returns {boolean}\n * @see https://dom.spec.whatwg.org/#dom-document-createelement\n * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocument\n * @see https://dom.spec.whatwg.org/#dom-domimplementation-createhtmldocument\n */\nfunction hasDefaultHTMLNamespace(mimeType) {\n\treturn isHTMLMimeType(mimeType) || mimeType === MIME_TYPE.XML_XHTML_APPLICATION;\n}\n\n/**\n * All mime types that are allowed as input to `DOMParser.parseFromString`\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString#Argument02\n *      MDN\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#domparsersupportedtype\n *      WHATWG HTML Spec\n * @see {@link DOMParser.prototype.parseFromString}\n */\nvar MIME_TYPE = freeze({\n\t/**\n\t * `text/html`, the only mime type that triggers treating an XML document as HTML.\n\t *\n\t * @see https://www.iana.org/assignments/media-types/text/html IANA MimeType registration\n\t * @see https://en.wikipedia.org/wiki/HTML Wikipedia\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString MDN\n\t * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-domparser-parsefromstring\n\t *      WHATWG HTML Spec\n\t */\n\tHTML: 'text/html',\n\n\t/**\n\t * `application/xml`, the standard mime type for XML documents.\n\t *\n\t * @see https://www.iana.org/assignments/media-types/application/xml IANA MimeType\n\t *      registration\n\t * @see https://tools.ietf.org/html/rfc7303#section-9.1 RFC 7303\n\t * @see https://en.wikipedia.org/wiki/XML_and_MIME Wikipedia\n\t */\n\tXML_APPLICATION: 'application/xml',\n\n\t/**\n\t * `text/xml`, an alias for `application/xml`.\n\t *\n\t * @see https://tools.ietf.org/html/rfc7303#section-9.2 RFC 7303\n\t * @see https://www.iana.org/assignments/media-types/text/xml IANA MimeType registration\n\t * @see https://en.wikipedia.org/wiki/XML_and_MIME Wikipedia\n\t */\n\tXML_TEXT: 'text/xml',\n\n\t/**\n\t * `application/xhtml+xml`, indicates an XML document that has the default HTML namespace,\n\t * but is parsed as an XML document.\n\t *\n\t * @see https://www.iana.org/assignments/media-types/application/xhtml+xml IANA MimeType\n\t *      registration\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocument WHATWG DOM Spec\n\t * @see https://en.wikipedia.org/wiki/XHTML Wikipedia\n\t */\n\tXML_XHTML_APPLICATION: 'application/xhtml+xml',\n\n\t/**\n\t * `image/svg+xml`,\n\t *\n\t * @see https://www.iana.org/assignments/media-types/image/svg+xml IANA MimeType registration\n\t * @see https://www.w3.org/TR/SVG11/ W3C SVG 1.1\n\t * @see https://en.wikipedia.org/wiki/Scalable_Vector_Graphics Wikipedia\n\t */\n\tXML_SVG_IMAGE: 'image/svg+xml',\n});\n/**\n * @typedef {'application/xhtml+xml' | 'application/xml' | 'image/svg+xml' | 'text/html' | 'text/xml'}\n * MimeType\n */\n/**\n * @type {MimeType[]}\n * @private\n * Basically `Object.values`, which is not available in ES5.\n */\nvar _MIME_TYPES = Object.keys(MIME_TYPE).map(function (key) {\n\treturn MIME_TYPE[key];\n});\n\n/**\n * Only returns true if `mimeType` is one of the allowed values for\n * `DOMParser.parseFromString`.\n *\n * @param {string} mimeType\n * @returns {mimeType is 'application/xhtml+xml' | 'application/xml' | 'image/svg+xml' |  'text/html' | 'text/xml'}\n *\n */\nfunction isValidMimeType(mimeType) {\n\treturn _MIME_TYPES.indexOf(mimeType) > -1;\n}\n/**\n * Namespaces that are used in this code base.\n *\n * @see http://www.w3.org/TR/REC-xml-names\n */\nvar NAMESPACE = freeze({\n\t/**\n\t * The XHTML namespace.\n\t *\n\t * @see http://www.w3.org/1999/xhtml\n\t */\n\tHTML: 'http://www.w3.org/1999/xhtml',\n\n\t/**\n\t * The SVG namespace.\n\t *\n\t * @see http://www.w3.org/2000/svg\n\t */\n\tSVG: 'http://www.w3.org/2000/svg',\n\n\t/**\n\t * The `xml:` namespace.\n\t *\n\t * @see http://www.w3.org/XML/1998/namespace\n\t */\n\tXML: 'http://www.w3.org/XML/1998/namespace',\n\n\t/**\n\t * The `xmlns:` namespace.\n\t *\n\t * @see https://www.w3.org/2000/xmlns/\n\t */\n\tXMLNS: 'http://www.w3.org/2000/xmlns/',\n});\n\nexports.assign = assign;\nexports.find = find;\nexports.freeze = freeze;\nexports.HTML_BOOLEAN_ATTRIBUTES = HTML_BOOLEAN_ATTRIBUTES;\nexports.HTML_RAW_TEXT_ELEMENTS = HTML_RAW_TEXT_ELEMENTS;\nexports.HTML_VOID_ELEMENTS = HTML_VOID_ELEMENTS;\nexports.hasDefaultHTMLNamespace = hasDefaultHTMLNamespace;\nexports.hasOwn = hasOwn;\nexports.isHTMLBooleanAttribute = isHTMLBooleanAttribute;\nexports.isHTMLRawTextElement = isHTMLRawTextElement;\nexports.isHTMLEscapableRawTextElement = isHTMLEscapableRawTextElement;\nexports.isHTMLMimeType = isHTMLMimeType;\nexports.isHTMLVoidElement = isHTMLVoidElement;\nexports.isValidMimeType = isValidMimeType;\nexports.MIME_TYPE = MIME_TYPE;\nexports.NAMESPACE = NAMESPACE;\n","module.exports = ol.source.TileWMS;","'use strict';\n\nvar conventions = require('./conventions');\nvar find = conventions.find;\nvar hasDefaultHTMLNamespace = conventions.hasDefaultHTMLNamespace;\nvar hasOwn = conventions.hasOwn;\nvar isHTMLMimeType = conventions.isHTMLMimeType;\nvar isHTMLRawTextElement = conventions.isHTMLRawTextElement;\nvar isHTMLVoidElement = conventions.isHTMLVoidElement;\nvar MIME_TYPE = conventions.MIME_TYPE;\nvar NAMESPACE = conventions.NAMESPACE;\n\n/**\n * Private DOM Constructor symbol\n *\n * Internal symbol used for construction of all classes whose constructors should be private.\n * Currently used for checks in `Node`, `Document`, `Element`, `Attr`, `CharacterData`, `Text`, `Comment`,\n * `CDATASection`, `DocumentType`, `Notation`, `Entity`, `EntityReference`, `DocumentFragment`, `ProcessingInstruction`\n * so the constructor can't be used from outside the module.\n */\nvar PDC = Symbol();\n\nvar errors = require('./errors');\nvar DOMException = errors.DOMException;\nvar DOMExceptionName = errors.DOMExceptionName;\n\nvar g = require('./grammar');\n\n/**\n * Checks if the given symbol equals the Private DOM Constructor symbol (PDC)\n * and throws an Illegal constructor exception when the symbols don't match.\n * This ensures that the constructor remains private and can't be used outside this module.\n */\nfunction checkSymbol(symbol) {\n\tif (symbol !== PDC) {\n\t\tthrow new TypeError('Illegal constructor');\n\t}\n}\n\n/**\n * A prerequisite for `[].filter`, to drop elements that are empty.\n *\n * @param {string} input\n * The string to be checked.\n * @returns {boolean}\n * Returns `true` if the input string is not empty, `false` otherwise.\n */\nfunction notEmptyString(input) {\n\treturn input !== '';\n}\n/**\n * Splits a string on ASCII whitespace characters (U+0009 TAB, U+000A LF, U+000C FF, U+000D CR,\n * U+0020 SPACE).\n * It follows the definition from the infra specification from WHATWG.\n *\n * @param {string} input\n * The string to be split.\n * @returns {string[]}\n * An array of the split strings. The array can be empty if the input string is empty or only\n * contains whitespace characters.\n * @see {@link https://infra.spec.whatwg.org/#split-on-ascii-whitespace}\n * @see {@link https://infra.spec.whatwg.org/#ascii-whitespace}\n */\nfunction splitOnASCIIWhitespace(input) {\n\t// U+0009 TAB, U+000A LF, U+000C FF, U+000D CR, U+0020 SPACE\n\treturn input ? input.split(/[\\t\\n\\f\\r ]+/).filter(notEmptyString) : [];\n}\n\n/**\n * Adds element as a key to current if it is not already present.\n *\n * @param {Record<string, boolean | undefined>} current\n * The current record object to which the element will be added as a key.\n * The object's keys are string types and values are either boolean or undefined.\n * @param {string} element\n * The string to be added as a key to the current record.\n * @returns {Record<string, boolean | undefined>}\n * The updated record object after the addition of the new element.\n */\nfunction orderedSetReducer(current, element) {\n\tif (!hasOwn(current, element)) {\n\t\tcurrent[element] = true;\n\t}\n\treturn current;\n}\n\n/**\n * Converts a string into an ordered set by splitting the input on ASCII whitespace and\n * ensuring uniqueness of elements.\n * This follows the definition of an ordered set from the infra specification by WHATWG.\n *\n * @param {string} input\n * The input string to be transformed into an ordered set.\n * @returns {string[]}\n * An array of unique strings obtained from the input, preserving the original order.\n * The array can be empty if the input string is empty or only contains whitespace characters.\n * @see {@link https://infra.spec.whatwg.org/#ordered-set}\n */\nfunction toOrderedSet(input) {\n\tif (!input) return [];\n\tvar list = splitOnASCIIWhitespace(input);\n\treturn Object.keys(list.reduce(orderedSetReducer, {}));\n}\n\n/**\n * Uses `list.indexOf` to implement a function that behaves like `Array.prototype.includes`.\n * This function is used in environments where `Array.prototype.includes` may not be available.\n *\n * @param {any[]} list\n * The array in which to search for the element.\n * @returns {function(any): boolean}\n * A function that accepts an element and returns a boolean indicating whether the element is\n * included in the provided list.\n */\nfunction arrayIncludes(list) {\n\treturn function (element) {\n\t\treturn list && list.indexOf(element) !== -1;\n\t};\n}\n\n/**\n * Validates a qualified name based on the criteria provided in the DOM specification by\n * WHATWG.\n *\n * @param {string} qualifiedName\n * The qualified name to be validated.\n * @throws {DOMException}\n * With code {@link DOMException.INVALID_CHARACTER_ERR} if the qualified name contains an\n * invalid character.\n * @see {@link https://dom.spec.whatwg.org/#validate}\n */\nfunction validateQualifiedName(qualifiedName) {\n\tif (!g.QName_exact.test(qualifiedName)) {\n\t\tthrow new DOMException(DOMException.INVALID_CHARACTER_ERR, 'invalid character in qualified name \"' + qualifiedName + '\"');\n\t}\n}\n\n/**\n * Validates a qualified name and the namespace associated with it,\n * based on the criteria provided in the DOM specification by WHATWG.\n *\n * @param {string | null} namespace\n * The namespace to be validated. It can be a string or null.\n * @param {string} qualifiedName\n * The qualified name to be validated.\n * @returns {[namespace: string | null, prefix: string | null, localName: string]}\n * Returns a tuple with the namespace,\n * prefix and local name of the qualified name.\n * @throws {DOMException}\n * Throws a DOMException if the qualified name or the namespace is not valid.\n * @see {@link https://dom.spec.whatwg.org/#validate-and-extract}\n */\nfunction validateAndExtract(namespace, qualifiedName) {\n\tvalidateQualifiedName(qualifiedName);\n\tnamespace = namespace || null;\n\t/**\n\t * @type {string | null}\n\t */\n\tvar prefix = null;\n\tvar localName = qualifiedName;\n\tif (qualifiedName.indexOf(':') >= 0) {\n\t\tvar splitResult = qualifiedName.split(':');\n\t\tprefix = splitResult[0];\n\t\tlocalName = splitResult[1];\n\t}\n\tif (prefix !== null && namespace === null) {\n\t\tthrow new DOMException(DOMException.NAMESPACE_ERR, 'prefix is non-null and namespace is null');\n\t}\n\tif (prefix === 'xml' && namespace !== conventions.NAMESPACE.XML) {\n\t\tthrow new DOMException(DOMException.NAMESPACE_ERR, 'prefix is \"xml\" and namespace is not the XML namespace');\n\t}\n\tif ((prefix === 'xmlns' || qualifiedName === 'xmlns') && namespace !== conventions.NAMESPACE.XMLNS) {\n\t\tthrow new DOMException(\n\t\t\tDOMException.NAMESPACE_ERR,\n\t\t\t'either qualifiedName or prefix is \"xmlns\" and namespace is not the XMLNS namespace'\n\t\t);\n\t}\n\tif (namespace === conventions.NAMESPACE.XMLNS && prefix !== 'xmlns' && qualifiedName !== 'xmlns') {\n\t\tthrow new DOMException(\n\t\t\tDOMException.NAMESPACE_ERR,\n\t\t\t'namespace is the XMLNS namespace and neither qualifiedName nor prefix is \"xmlns\"'\n\t\t);\n\t}\n\treturn [namespace, prefix, localName];\n}\n\n/**\n * Copies properties from one object to another.\n * It only copies the object's own (not inherited) properties.\n *\n * @param {Object} src\n * The source object from which properties are copied.\n * @param {Object} dest\n * The destination object to which properties are copied.\n */\nfunction copy(src, dest) {\n\tfor (var p in src) {\n\t\tif (hasOwn(src, p)) {\n\t\t\tdest[p] = src[p];\n\t\t}\n\t}\n}\n\n/**\n * Extends a class with the properties and methods of a super class.\n * It uses a form of prototypal inheritance, and establishes the `constructor` property\n * correctly(?).\n *\n * It is not clear to the current maintainers if this implementation is making sense,\n * since it creates an intermediate prototype function,\n * which all properties of `Super` are copied onto using `_copy`.\n *\n * @param {Object} Class\n * The class that is to be extended.\n * @param {Object} Super\n * The super class from which properties and methods are inherited.\n * @private\n */\nfunction _extends(Class, Super) {\n\tvar pt = Class.prototype;\n\tif (!(pt instanceof Super)) {\n\t\tfunction t() {}\n\t\tt.prototype = Super.prototype;\n\t\tt = new t();\n\t\tcopy(pt, t);\n\t\tClass.prototype = pt = t;\n\t}\n\tif (pt.constructor != Class) {\n\t\tif (typeof Class != 'function') {\n\t\t\tconsole.error('unknown Class:' + Class);\n\t\t}\n\t\tpt.constructor = Class;\n\t}\n}\n\nvar NodeType = {};\nvar ELEMENT_NODE = (NodeType.ELEMENT_NODE = 1);\nvar ATTRIBUTE_NODE = (NodeType.ATTRIBUTE_NODE = 2);\nvar TEXT_NODE = (NodeType.TEXT_NODE = 3);\nvar CDATA_SECTION_NODE = (NodeType.CDATA_SECTION_NODE = 4);\nvar ENTITY_REFERENCE_NODE = (NodeType.ENTITY_REFERENCE_NODE = 5);\nvar ENTITY_NODE = (NodeType.ENTITY_NODE = 6);\nvar PROCESSING_INSTRUCTION_NODE = (NodeType.PROCESSING_INSTRUCTION_NODE = 7);\nvar COMMENT_NODE = (NodeType.COMMENT_NODE = 8);\nvar DOCUMENT_NODE = (NodeType.DOCUMENT_NODE = 9);\nvar DOCUMENT_TYPE_NODE = (NodeType.DOCUMENT_TYPE_NODE = 10);\nvar DOCUMENT_FRAGMENT_NODE = (NodeType.DOCUMENT_FRAGMENT_NODE = 11);\nvar NOTATION_NODE = (NodeType.NOTATION_NODE = 12);\n\nvar DocumentPosition = conventions.freeze({\n\tDOCUMENT_POSITION_DISCONNECTED: 1,\n\tDOCUMENT_POSITION_PRECEDING: 2,\n\tDOCUMENT_POSITION_FOLLOWING: 4,\n\tDOCUMENT_POSITION_CONTAINS: 8,\n\tDOCUMENT_POSITION_CONTAINED_BY: 16,\n\tDOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC: 32,\n});\n\n//helper functions for compareDocumentPosition\n/**\n * Finds the common ancestor in two parent chains.\n *\n * @param {Node[]} a\n * The first parent chain.\n * @param {Node[]} b\n * The second parent chain.\n * @returns {Node}\n * The common ancestor node if it exists. If there is no common ancestor, the function will\n * return `null`.\n */\nfunction commonAncestor(a, b) {\n\tif (b.length < a.length) return commonAncestor(b, a);\n\tvar c = null;\n\tfor (var n in a) {\n\t\tif (a[n] !== b[n]) return c;\n\t\tc = a[n];\n\t}\n\treturn c;\n}\n\n/**\n * Assigns a unique identifier to a document to ensure consistency while comparing unrelated\n * nodes.\n *\n * @param {Document} doc\n * The document to which a unique identifier is to be assigned.\n * @returns {string}\n * The unique identifier of the document. If the document already had a unique identifier, the\n * function will return the existing one.\n */\nfunction docGUID(doc) {\n\tif (!doc.guid) doc.guid = Math.random();\n\treturn doc.guid;\n}\n//-- end of helper functions\n\n/**\n * The NodeList interface provides the abstraction of an ordered collection of nodes,\n * without defining or constraining how this collection is implemented.\n * NodeList objects in the DOM are live.\n * The items in the NodeList are accessible via an integral index, starting from 0.\n * You can also access the items of the NodeList with a `for...of` loop.\n *\n * @class NodeList\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-536297177\n * @constructs NodeList\n */\nfunction NodeList() {}\nNodeList.prototype = {\n\t/**\n\t * The number of nodes in the list. The range of valid child node indices is 0 to length-1\n\t * inclusive.\n\t *\n\t * @type {number}\n\t */\n\tlength: 0,\n\t/**\n\t * Returns the item at `index`. If index is greater than or equal to the number of nodes in\n\t * the list, this returns null.\n\t *\n\t * @param index\n\t * Unsigned long Index into the collection.\n\t * @returns {Node | null}\n\t * The node at position `index` in the NodeList,\n\t * or null if that is not a valid index.\n\t */\n\titem: function (index) {\n\t\treturn index >= 0 && index < this.length ? this[index] : null;\n\t},\n\t/**\n\t * Returns a string representation of the NodeList.\n\t *\n\t * @param {unknown} nodeFilter\n\t * __A filter function? Not implemented according to the spec?__.\n\t * @returns {string}\n\t * A string representation of the NodeList.\n\t */\n\ttoString: function (nodeFilter) {\n\t\tfor (var buf = [], i = 0; i < this.length; i++) {\n\t\t\tserializeToString(this[i], buf, nodeFilter);\n\t\t}\n\t\treturn buf.join('');\n\t},\n\t/**\n\t * Filters the NodeList based on a predicate.\n\t *\n\t * @param {function(Node): boolean} predicate\n\t * - A predicate function to filter the NodeList.\n\t * @returns {Node[]}\n\t * An array of nodes that satisfy the predicate.\n\t * @private\n\t */\n\tfilter: function (predicate) {\n\t\treturn Array.prototype.filter.call(this, predicate);\n\t},\n\t/**\n\t * Returns the first index at which a given node can be found in the NodeList, or -1 if it is\n\t * not present.\n\t *\n\t * @param {Node} item\n\t * - The Node item to locate in the NodeList.\n\t * @returns {number}\n\t * The first index of the node in the NodeList; -1 if not found.\n\t * @private\n\t */\n\tindexOf: function (item) {\n\t\treturn Array.prototype.indexOf.call(this, item);\n\t},\n};\nNodeList.prototype[Symbol.iterator] = function () {\n\tvar me = this;\n\tvar index = 0;\n\n\treturn {\n\t\tnext: function () {\n\t\t\tif (index < me.length) {\n\t\t\t\treturn {\n\t\t\t\t\tvalue: me[index++],\n\t\t\t\t\tdone: false,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tdone: true,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\treturn: function () {\n\t\t\treturn {\n\t\t\t\tdone: true,\n\t\t\t};\n\t\t},\n\t};\n};\n\n/**\n * Represents a live collection of nodes that is automatically updated when its associated\n * document changes.\n *\n * @class LiveNodeList\n * @param {Node} node\n * The associated node.\n * @param {function} refresh\n * The function to refresh the live node list.\n * @augments NodeList\n * @constructs LiveNodeList\n */\nfunction LiveNodeList(node, refresh) {\n\tthis._node = node;\n\tthis._refresh = refresh;\n\t_updateLiveList(this);\n}\n/**\n * Updates the live node list.\n *\n * @param {LiveNodeList} list\n * The live node list to update.\n * @private\n */\nfunction _updateLiveList(list) {\n\tvar inc = list._node._inc || list._node.ownerDocument._inc;\n\tif (list._inc !== inc) {\n\t\tvar ls = list._refresh(list._node);\n\t\t__set__(list, 'length', ls.length);\n\t\tif (!list.$$length || ls.length < list.$$length) {\n\t\t\tfor (var i = ls.length; i in list; i++) {\n\t\t\t\tif (hasOwn(list, i)) {\n\t\t\t\t\tdelete list[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcopy(ls, list);\n\t\tlist._inc = inc;\n\t}\n}\n/**\n * Returns the node at position `index` in the LiveNodeList, or null if that is not a valid\n * index.\n *\n * @param {number} i\n * Index into the collection.\n * @returns {Node | null}\n * The node at position `index` in the LiveNodeList, or null if that is not a valid index.\n */\nLiveNodeList.prototype.item = function (i) {\n\t_updateLiveList(this);\n\treturn this[i] || null;\n};\n\n_extends(LiveNodeList, NodeList);\n\n/**\n * Objects implementing the NamedNodeMap interface are used to represent collections of nodes\n * that can be accessed by name.\n * Note that NamedNodeMap does not inherit from NodeList;\n * NamedNodeMaps are not maintained in any particular order.\n * Objects contained in an object implementing NamedNodeMap may also be accessed by an ordinal\n * index,\n * but this is simply to allow convenient enumeration of the contents of a NamedNodeMap,\n * and does not imply that the DOM specifies an order to these Nodes.\n * NamedNodeMap objects in the DOM are live.\n * used for attributes or DocumentType entities\n *\n * This implementation only supports property indices, but does not support named properties,\n * as specified in the living standard.\n *\n * @class NamedNodeMap\n * @see https://dom.spec.whatwg.org/#interface-namednodemap\n * @see https://webidl.spec.whatwg.org/#dfn-supported-property-names\n * @constructs NamedNodeMap\n */\nfunction NamedNodeMap() {}\n/**\n * Returns the index of a node within the list.\n *\n * @param {Array} list\n * The list of nodes.\n * @param {Node} node\n * The node to find.\n * @returns {number}\n * The index of the node within the list, or -1 if not found.\n * @private\n */\nfunction _findNodeIndex(list, node) {\n\tvar i = 0;\n\twhile (i < list.length) {\n\t\tif (list[i] === node) {\n\t\t\treturn i;\n\t\t}\n\t\ti++;\n\t}\n}\n/**\n * Adds a new attribute to the list and updates the owner element of the attribute.\n *\n * @param {Element} el\n * The element which will become the owner of the new attribute.\n * @param {NamedNodeMap} list\n * The list to which the new attribute will be added.\n * @param {Attr} newAttr\n * The new attribute to be added.\n * @param {Attr} oldAttr\n * The old attribute to be replaced, or null if no attribute is to be replaced.\n * @returns {void}\n * @private\n */\nfunction _addNamedNode(el, list, newAttr, oldAttr) {\n\tif (oldAttr) {\n\t\tlist[_findNodeIndex(list, oldAttr)] = newAttr;\n\t} else {\n\t\tlist[list.length] = newAttr;\n\t\tlist.length++;\n\t}\n\tif (el) {\n\t\tnewAttr.ownerElement = el;\n\t\tvar doc = el.ownerDocument;\n\t\tif (doc) {\n\t\t\toldAttr && _onRemoveAttribute(doc, el, oldAttr);\n\t\t\t_onAddAttribute(doc, el, newAttr);\n\t\t}\n\t}\n}\n/**\n * Removes an attribute from the list and updates the owner element of the attribute.\n *\n * @param {Element} el\n * The element which is the current owner of the attribute.\n * @param {NamedNodeMap} list\n * The list from which the attribute will be removed.\n * @param {Attr} attr\n * The attribute to be removed.\n * @returns {void}\n * @private\n */\nfunction _removeNamedNode(el, list, attr) {\n\t//console.log('remove attr:'+attr)\n\tvar i = _findNodeIndex(list, attr);\n\tif (i >= 0) {\n\t\tvar lastIndex = list.length - 1;\n\t\twhile (i <= lastIndex) {\n\t\t\tlist[i] = list[++i];\n\t\t}\n\t\tlist.length = lastIndex;\n\t\tif (el) {\n\t\t\tvar doc = el.ownerDocument;\n\t\t\tif (doc) {\n\t\t\t\t_onRemoveAttribute(doc, el, attr);\n\t\t\t}\n\t\t\tattr.ownerElement = null;\n\t\t}\n\t}\n}\nNamedNodeMap.prototype = {\n\tlength: 0,\n\titem: NodeList.prototype.item,\n\n\t/**\n\t * Get an attribute by name. Note: Name is in lower case in case of HTML namespace and\n\t * document.\n\t *\n\t * @param {string} localName\n\t * The local name of the attribute.\n\t * @returns {Attr | null}\n\t * The attribute with the given local name, or null if no such attribute exists.\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-get-by-name\n\t */\n\tgetNamedItem: function (localName) {\n\t\tif (this._ownerElement && this._ownerElement._isInHTMLDocumentAndNamespace()) {\n\t\t\tlocalName = localName.toLowerCase();\n\t\t}\n\t\tvar i = 0;\n\t\twhile (i < this.length) {\n\t\t\tvar attr = this[i];\n\t\t\tif (attr.nodeName === localName) {\n\t\t\t\treturn attr;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Set an attribute.\n\t *\n\t * @param {Attr} attr\n\t * The attribute to set.\n\t * @returns {Attr | null}\n\t * The old attribute with the same local name and namespace URI as the new one, or null if no\n\t * such attribute exists.\n\t * @throws {DOMException}\n\t * With code:\n\t * - {@link INUSE_ATTRIBUTE_ERR} - If the attribute is already an attribute of another\n\t * element.\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-set\n\t */\n\tsetNamedItem: function (attr) {\n\t\tvar el = attr.ownerElement;\n\t\tif (el && el !== this._ownerElement) {\n\t\t\tthrow new DOMException(DOMException.INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\tvar oldAttr = this.getNamedItemNS(attr.namespaceURI, attr.localName);\n\t\tif (oldAttr === attr) {\n\t\t\treturn attr;\n\t\t}\n\t\t_addNamedNode(this._ownerElement, this, attr, oldAttr);\n\t\treturn oldAttr;\n\t},\n\n\t/**\n\t * Set an attribute, replacing an existing attribute with the same local name and namespace\n\t * URI if one exists.\n\t *\n\t * @param {Attr} attr\n\t * The attribute to set.\n\t * @returns {Attr | null}\n\t * The old attribute with the same local name and namespace URI as the new one, or null if no\n\t * such attribute exists.\n\t * @throws {DOMException}\n\t * Throws a DOMException with the name \"InUseAttributeError\" if the attribute is already an\n\t * attribute of another element.\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-set\n\t */\n\tsetNamedItemNS: function (attr) {\n\t\treturn this.setNamedItem(attr);\n\t},\n\n\t/**\n\t * Removes an attribute specified by the local name.\n\t *\n\t * @param {string} localName\n\t * The local name of the attribute to be removed.\n\t * @returns {Attr}\n\t * The attribute node that was removed.\n\t * @throws {DOMException}\n\t * With code:\n\t * - {@link DOMException.NOT_FOUND_ERR} if no attribute with the given name is found.\n\t * @see https://dom.spec.whatwg.org/#dom-namednodemap-removenameditem\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-remove-by-name\n\t */\n\tremoveNamedItem: function (localName) {\n\t\tvar attr = this.getNamedItem(localName);\n\t\tif (!attr) {\n\t\t\tthrow new DOMException(DOMException.NOT_FOUND_ERR, localName);\n\t\t}\n\t\t_removeNamedNode(this._ownerElement, this, attr);\n\t\treturn attr;\n\t},\n\n\t/**\n\t * Removes an attribute specified by the namespace and local name.\n\t *\n\t * @param {string | null} namespaceURI\n\t * The namespace URI of the attribute to be removed.\n\t * @param {string} localName\n\t * The local name of the attribute to be removed.\n\t * @returns {Attr}\n\t * The attribute node that was removed.\n\t * @throws {DOMException}\n\t * With code:\n\t * - {@link DOMException.NOT_FOUND_ERR} if no attribute with the given namespace URI and local\n\t * name is found.\n\t * @see https://dom.spec.whatwg.org/#dom-namednodemap-removenameditemns\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-remove-by-namespace\n\t */\n\tremoveNamedItemNS: function (namespaceURI, localName) {\n\t\tvar attr = this.getNamedItemNS(namespaceURI, localName);\n\t\tif (!attr) {\n\t\t\tthrow new DOMException(DOMException.NOT_FOUND_ERR, namespaceURI ? namespaceURI + ' : ' + localName : localName);\n\t\t}\n\t\t_removeNamedNode(this._ownerElement, this, attr);\n\t\treturn attr;\n\t},\n\n\t/**\n\t * Get an attribute by namespace and local name.\n\t *\n\t * @param {string | null} namespaceURI\n\t * The namespace URI of the attribute.\n\t * @param {string} localName\n\t * The local name of the attribute.\n\t * @returns {Attr | null}\n\t * The attribute with the given namespace URI and local name, or null if no such attribute\n\t * exists.\n\t * @see https://dom.spec.whatwg.org/#concept-element-attributes-get-by-namespace\n\t */\n\tgetNamedItemNS: function (namespaceURI, localName) {\n\t\tif (!namespaceURI) {\n\t\t\tnamespaceURI = null;\n\t\t}\n\t\tvar i = 0;\n\t\twhile (i < this.length) {\n\t\t\tvar node = this[i];\n\t\t\tif (node.localName === localName && node.namespaceURI === namespaceURI) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn null;\n\t},\n};\nNamedNodeMap.prototype[Symbol.iterator] = function () {\n\tvar me = this;\n\tvar index = 0;\n\n\treturn {\n\t\tnext: function () {\n\t\t\tif (index < me.length) {\n\t\t\t\treturn {\n\t\t\t\t\tvalue: me[index++],\n\t\t\t\t\tdone: false,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tdone: true,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\treturn: function () {\n\t\t\treturn {\n\t\t\t\tdone: true,\n\t\t\t};\n\t\t},\n\t};\n};\n\n/**\n * The DOMImplementation interface provides a number of methods for performing operations that\n * are independent of any particular instance of the document object model.\n *\n * The DOMImplementation interface represents an object providing methods which are not\n * dependent on any particular document.\n * Such an object is returned by the `Document.implementation` property.\n *\n * **The individual methods describe the differences compared to the specs**.\n *\n * @class DOMImplementation\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation MDN\n * @see https://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-102161490 DOM Level 1 Core\n *      (Initial)\n * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-102161490 DOM Level 2 Core\n * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-102161490 DOM Level 3 Core\n * @see https://dom.spec.whatwg.org/#domimplementation DOM Living Standard\n * @constructs DOMImplementation\n */\nfunction DOMImplementation() {}\n\nDOMImplementation.prototype = {\n\t/**\n\t * Test if the DOM implementation implements a specific feature and version, as specified in\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMFeatures DOM Features}.\n\t *\n\t * The DOMImplementation.hasFeature() method returns a Boolean flag indicating if a given\n\t * feature is supported. The different implementations fairly diverged in what kind of\n\t * features were reported. The latest version of the spec settled to force this method to\n\t * always return true, where the functionality was accurate and in use.\n\t *\n\t * @deprecated\n\t * It is deprecated and modern browsers return true in all cases.\n\t * @function DOMImplementation#hasFeature\n\t * @param {string} feature\n\t * The name of the feature to test.\n\t * @param {string} [version]\n\t * This is the version number of the feature to test.\n\t * @returns {boolean}\n\t * Always returns true.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/hasFeature MDN\n\t * @see https://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-5CED94D7 DOM Level 1 Core\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-hasfeature DOM Living Standard\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-5CED94D7 DOM Level 3 Core\n\t */\n\thasFeature: function (feature, version) {\n\t\treturn true;\n\t},\n\t/**\n\t * Creates a DOM Document object of the specified type with its document element. Note that\n\t * based on the {@link DocumentType}\n\t * given to create the document, the implementation may instantiate specialized\n\t * {@link Document} objects that support additional features than the \"Core\", such as \"HTML\"\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#DOM2HTML DOM Level 2 HTML}.\n\t * On the other hand, setting the {@link DocumentType} after the document was created makes\n\t * this very unlikely to happen. Alternatively, specialized {@link Document} creation methods,\n\t * such as createHTMLDocument\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#DOM2HTML DOM Level 2 HTML},\n\t * can be used to obtain specific types of {@link Document} objects.\n\t *\n\t * __It behaves slightly different from the description in the living standard__:\n\t * - There is no interface/class `XMLDocument`, it returns a `Document`\n\t * instance (with it's `type` set to `'xml'`).\n\t * - `encoding`, `mode`, `origin`, `url` fields are currently not declared.\n\t *\n\t * @function DOMImplementation.createDocument\n\t * @param {string | null} namespaceURI\n\t * The\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/glossary.html#dt-namespaceURI namespace URI}\n\t * of the document element to create or null.\n\t * @param {string | null} qualifiedName\n\t * The\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/glossary.html#dt-qualifiedname qualified name}\n\t * of the document element to be created or null.\n\t * @param {DocumentType | null} [doctype=null]\n\t * The type of document to be created or null. When doctype is not null, its\n\t * {@link Node#ownerDocument} attribute is set to the document being created. Default is\n\t * `null`\n\t * @returns {Document}\n\t * A new {@link Document} object with its document element. If the NamespaceURI,\n\t * qualifiedName, and doctype are null, the returned {@link Document} is empty with no\n\t * document element.\n\t * @throws {DOMException}\n\t * With code:\n\t *\n\t * - `INVALID_CHARACTER_ERR`: Raised if the specified qualified name is not an XML name\n\t * according to {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#XML XML 1.0}.\n\t * - `NAMESPACE_ERR`: Raised if the qualifiedName is malformed, if the qualifiedName has a\n\t * prefix and the namespaceURI is null, or if the qualifiedName is null and the namespaceURI\n\t * is different from null, or if the qualifiedName has a prefix that is \"xml\" and the\n\t * namespaceURI is different from \"{@link http://www.w3.org/XML/1998/namespace}\"\n\t * {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#Namespaces XML Namespaces},\n\t * or if the DOM implementation does not support the \"XML\" feature but a non-null namespace\n\t * URI was provided, since namespaces were defined by XML.\n\t * - `WRONG_DOCUMENT_ERR`: Raised if doctype has already been used with a different document\n\t * or was created from a different implementation.\n\t * - `NOT_SUPPORTED_ERR`: May be raised if the implementation does not support the feature\n\t * \"XML\" and the language exposed through the Document does not support XML Namespaces (such\n\t * as {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#HTML40 HTML 4.01}).\n\t * @since DOM Level 2.\n\t * @see {@link #createHTMLDocument}\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createDocument MDN\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocument DOM Living Standard\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Level-2-Core-DOM-createDocument DOM\n\t *      Level 3 Core\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#Level-2-Core-DOM-createDocument DOM\n\t *      Level 2 Core (initial)\n\t */\n\tcreateDocument: function (namespaceURI, qualifiedName, doctype) {\n\t\tvar contentType = MIME_TYPE.XML_APPLICATION;\n\t\tif (namespaceURI === NAMESPACE.HTML) {\n\t\t\tcontentType = MIME_TYPE.XML_XHTML_APPLICATION;\n\t\t} else if (namespaceURI === NAMESPACE.SVG) {\n\t\t\tcontentType = MIME_TYPE.XML_SVG_IMAGE;\n\t\t}\n\t\tvar doc = new Document(PDC, { contentType: contentType });\n\t\tdoc.implementation = this;\n\t\tdoc.childNodes = new NodeList();\n\t\tdoc.doctype = doctype || null;\n\t\tif (doctype) {\n\t\t\tdoc.appendChild(doctype);\n\t\t}\n\t\tif (qualifiedName) {\n\t\t\tvar root = doc.createElementNS(namespaceURI, qualifiedName);\n\t\t\tdoc.appendChild(root);\n\t\t}\n\t\treturn doc;\n\t},\n\t/**\n\t * Creates an empty DocumentType node. Entity declarations and notations are not made\n\t * available. Entity reference expansions and default attribute additions do not occur.\n\t *\n\t * **This behavior is slightly different from the one in the specs**:\n\t * - `encoding`, `mode`, `origin`, `url` fields are currently not declared.\n\t * - `publicId` and `systemId` contain the raw data including any possible quotes,\n\t *   so they can always be serialized back to the original value\n\t * - `internalSubset` contains the raw string between `[` and `]` if present,\n\t *   but is not parsed or validated in any form.\n\t *\n\t * @function DOMImplementation#createDocumentType\n\t * @param {string} qualifiedName\n\t * The {@link https://www.w3.org/TR/DOM-Level-3-Core/glossary.html#dt-qualifiedname qualified\n\t * name} of the document type to be created.\n\t * @param {string} [publicId]\n\t * The external subset public identifier.\n\t * @param {string} [systemId]\n\t * The external subset system identifier.\n\t * @param {string} [internalSubset]\n\t * the internal subset or an empty string if it is not present\n\t * @returns {DocumentType}\n\t * A new {@link DocumentType} node with {@link Node#ownerDocument} set to null.\n\t * @throws {DOMException}\n\t * With code:\n\t *\n\t * - `INVALID_CHARACTER_ERR`: Raised if the specified qualified name is not an XML name\n\t * according to {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#XML XML 1.0}.\n\t * - `NAMESPACE_ERR`: Raised if the qualifiedName is malformed.\n\t * - `NOT_SUPPORTED_ERR`: May be raised if the implementation does not support the feature\n\t * \"XML\" and the language exposed through the Document does not support XML Namespaces (such\n\t * as {@link https://www.w3.org/TR/DOM-Level-3-Core/references.html#HTML40 HTML 4.01}).\n\t * @since DOM Level 2.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createDocumentType\n\t *      MDN\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocumenttype DOM Living\n\t *      Standard\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Level-3-Core-DOM-createDocType DOM\n\t *      Level 3 Core\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#Level-2-Core-DOM-createDocType DOM\n\t *      Level 2 Core\n\t * @see https://github.com/xmldom/xmldom/blob/master/CHANGELOG.md#050\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/#core-ID-Core-DocType-internalSubset\n\t * @prettierignore\n\t */\n\tcreateDocumentType: function (qualifiedName, publicId, systemId, internalSubset) {\n\t\tvalidateQualifiedName(qualifiedName);\n\t\tvar node = new DocumentType(PDC);\n\t\tnode.name = qualifiedName;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.publicId = publicId || '';\n\t\tnode.systemId = systemId || '';\n\t\tnode.internalSubset = internalSubset || '';\n\t\tnode.childNodes = new NodeList();\n\n\t\treturn node;\n\t},\n\t/**\n\t * Returns an HTML document, that might already have a basic DOM structure.\n\t *\n\t * __It behaves slightly different from the description in the living standard__:\n\t * - If the first argument is `false` no initial nodes are added (steps 3-7 in the specs are\n\t * omitted)\n\t * - `encoding`, `mode`, `origin`, `url` fields are currently not declared.\n\t *\n\t * @param {string | false} [title]\n\t * A string containing the title to give the new HTML document.\n\t * @returns {Document}\n\t * The HTML document.\n\t * @since WHATWG Living Standard.\n\t * @see {@link #createDocument}\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createhtmldocument\n\t * @see https://dom.spec.whatwg.org/#html-document\n\t */\n\tcreateHTMLDocument: function (title) {\n\t\tvar doc = new Document(PDC, { contentType: MIME_TYPE.HTML });\n\t\tdoc.implementation = this;\n\t\tdoc.childNodes = new NodeList();\n\t\tif (title !== false) {\n\t\t\tdoc.doctype = this.createDocumentType('html');\n\t\t\tdoc.doctype.ownerDocument = doc;\n\t\t\tdoc.appendChild(doc.doctype);\n\t\t\tvar htmlNode = doc.createElement('html');\n\t\t\tdoc.appendChild(htmlNode);\n\t\t\tvar headNode = doc.createElement('head');\n\t\t\thtmlNode.appendChild(headNode);\n\t\t\tif (typeof title === 'string') {\n\t\t\t\tvar titleNode = doc.createElement('title');\n\t\t\t\ttitleNode.appendChild(doc.createTextNode(title));\n\t\t\t\theadNode.appendChild(titleNode);\n\t\t\t}\n\t\t\thtmlNode.appendChild(doc.createElement('body'));\n\t\t}\n\t\treturn doc;\n\t},\n};\n\n/**\n * The DOM Node interface is an abstract base class upon which many other DOM API objects are\n * based, thus letting those object types to be used similarly and often interchangeably. As an\n * abstract class, there is no such thing as a plain Node object. All objects that implement\n * Node functionality are based on one of its subclasses. Most notable are Document, Element,\n * and DocumentFragment.\n *\n * In addition, every kind of DOM node is represented by an interface based on Node. These\n * include Attr, CharacterData (which Text, Comment, CDATASection and ProcessingInstruction are\n * all based on), and DocumentType.\n *\n * In some cases, a particular feature of the base Node interface may not apply to one of its\n * child interfaces; in that case, the inheriting node may return null or throw an exception,\n * depending on circumstances. For example, attempting to add children to a node type that\n * cannot have children will throw an exception.\n *\n * **This behavior is slightly different from the in the specs**:\n * - unimplemented interfaces: `EventTarget`\n *\n * @class\n * @abstract\n * @param {Symbol} symbol\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-1950641247\n * @see https://dom.spec.whatwg.org/#node\n * @prettierignore\n */\nfunction Node(symbol) {\n\tcheckSymbol(symbol);\n}\n\nNode.prototype = {\n\t/**\n\t * The first child of this node.\n\t *\n\t * @type {Node | null}\n\t */\n\tfirstChild: null,\n\t/**\n\t * The last child of this node.\n\t *\n\t * @type {Node | null}\n\t */\n\tlastChild: null,\n\t/**\n\t * The previous sibling of this node.\n\t *\n\t * @type {Node | null}\n\t */\n\tpreviousSibling: null,\n\t/**\n\t * The next sibling of this node.\n\t *\n\t * @type {Node | null}\n\t */\n\tnextSibling: null,\n\t/**\n\t * The parent node of this node.\n\t *\n\t * @type {Node | null}\n\t */\n\tparentNode: null,\n\t/**\n\t * The parent element of this node.\n\t *\n\t * @type {Element | null}\n\t */\n\tget parentElement() {\n\t\treturn this.parentNode && this.parentNode.nodeType === this.ELEMENT_NODE ? this.parentNode : null;\n\t},\n\t/**\n\t * The child nodes of this node.\n\t *\n\t * @type {NodeList}\n\t */\n\tchildNodes: null,\n\t/**\n\t * The document object associated with this node.\n\t *\n\t * @type {Document | null}\n\t */\n\townerDocument: null,\n\t/**\n\t * The value of this node.\n\t *\n\t * @type {string | null}\n\t */\n\tnodeValue: null,\n\t/**\n\t * The namespace URI of this node.\n\t *\n\t * @type {string | null}\n\t */\n\tnamespaceURI: null,\n\t/**\n\t * The prefix of the namespace for this node.\n\t *\n\t * @type {string | null}\n\t */\n\tprefix: null,\n\t/**\n\t * The local part of the qualified name of this node.\n\t *\n\t * @type {string | null}\n\t */\n\tlocalName: null,\n\t/**\n\t * The baseURI is currently always `about:blank`,\n\t * since that's what happens when you create a document from scratch.\n\t *\n\t * @type {'about:blank'}\n\t */\n\tbaseURI: 'about:blank',\n\t/**\n\t * Is true if this node is part of a document.\n\t *\n\t * @type {boolean}\n\t */\n\tget isConnected() {\n\t\tvar rootNode = this.getRootNode();\n\t\treturn rootNode && rootNode.nodeType === rootNode.DOCUMENT_NODE;\n\t},\n\t/**\n\t * Checks whether `other` is an inclusive descendant of this node.\n\t *\n\t * @param {Node | null | undefined} other\n\t * The node to check.\n\t * @returns {boolean}\n\t * True if `other` is an inclusive descendant of this node; false otherwise.\n\t * @see https://dom.spec.whatwg.org/#dom-node-contains\n\t */\n\tcontains: function (other) {\n\t\tif (!other) return false;\n\t\tvar parent = other;\n\t\tdo {\n\t\t\tif (this === parent) return true;\n\t\t\tparent = other.parentNode;\n\t\t} while (parent);\n\t\treturn false;\n\t},\n\t/**\n\t * @typedef GetRootNodeOptions\n\t * @property {boolean} [composed=false]\n\t */\n\t/**\n\t * Searches for the root node of this node.\n\t *\n\t * **This behavior is slightly different from the in the specs**:\n\t * - ignores `options.composed`, since `ShadowRoot`s are unsupported, always returns root.\n\t *\n\t * @param {GetRootNodeOptions} [options]\n\t * @returns {Node}\n\t * Root node.\n\t * @see https://dom.spec.whatwg.org/#dom-node-getrootnode\n\t * @see https://dom.spec.whatwg.org/#concept-shadow-including-root\n\t */\n\tgetRootNode: function (options) {\n\t\tvar parent = this;\n\t\tdo {\n\t\t\tif (!parent.parentNode) {\n\t\t\t\treturn parent;\n\t\t\t}\n\t\t\tparent = parent.parentNode;\n\t\t} while (parent);\n\t},\n\t/**\n\t * Checks whether the given node is equal to this node.\n\t *\n\t * @param {Node} [otherNode]\n\t * @see https://dom.spec.whatwg.org/#concept-node-equals\n\t */\n\tisEqualNode: function (otherNode) {\n\t\tif (!otherNode) return false;\n\n\t\tif (this.nodeType !== otherNode.nodeType) return false;\n\n\t\tswitch (this.nodeType) {\n\t\t\tcase this.DOCUMENT_TYPE_NODE:\n\t\t\t\tif (this.name !== otherNode.name) return false;\n\t\t\t\tif (this.publicId !== otherNode.publicId) return false;\n\t\t\t\tif (this.systemId !== otherNode.systemId) return false;\n\t\t\t\tbreak;\n\t\t\tcase this.ELEMENT_NODE:\n\t\t\t\tif (this.namespaceURI !== otherNode.namespaceURI) return false;\n\t\t\t\tif (this.prefix !== otherNode.prefix) return false;\n\t\t\t\tif (this.localName !== otherNode.localName) return false;\n\t\t\t\tif (this.attributes.length !== otherNode.attributes.length) return false;\n\t\t\t\tfor (var i = 0; i < this.attributes.length; i++) {\n\t\t\t\t\tvar attr = this.attributes.item(i);\n\t\t\t\t\tif (!attr.isEqualNode(otherNode.getAttributeNodeNS(attr.namespaceURI, attr.localName))) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase this.ATTRIBUTE_NODE:\n\t\t\t\tif (this.namespaceURI !== otherNode.namespaceURI) return false;\n\t\t\t\tif (this.localName !== otherNode.localName) return false;\n\t\t\t\tif (this.value !== otherNode.value) return false;\n\n\t\t\t\tbreak;\n\t\t\tcase this.PROCESSING_INSTRUCTION_NODE:\n\t\t\t\tif (this.target !== otherNode.target || this.data !== otherNode.data) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase this.TEXT_NODE:\n\t\t\tcase this.COMMENT_NODE:\n\t\t\t\tif (this.data !== otherNode.data) return false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (this.childNodes.length !== otherNode.childNodes.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (var i = 0; i < this.childNodes.length; i++) {\n\t\t\tif (!this.childNodes[i].isEqualNode(otherNode.childNodes[i])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\t/**\n\t * Checks whether or not the given node is this node.\n\t *\n\t * @param {Node} [otherNode]\n\t */\n\tisSameNode: function (otherNode) {\n\t\treturn this === otherNode;\n\t},\n\t/**\n\t * Inserts a node before a reference node as a child of this node.\n\t *\n\t * @param {Node} newChild\n\t * The new child node to be inserted.\n\t * @param {Node | null} refChild\n\t * The reference node before which newChild will be inserted.\n\t * @returns {Node}\n\t * The new child node successfully inserted.\n\t * @throws {DOMException}\n\t * Throws a DOMException if inserting the node would result in a DOM tree that is not\n\t * well-formed, or if `child` is provided but is not a child of `parent`.\n\t * See {@link _insertBefore} for more details.\n\t * @since Modified in DOM L2\n\t */\n\tinsertBefore: function (newChild, refChild) {\n\t\treturn _insertBefore(this, newChild, refChild);\n\t},\n\t/**\n\t * Replaces an old child node with a new child node within this node.\n\t *\n\t * @param {Node} newChild\n\t * The new node that is to replace the old node.\n\t * If it already exists in the DOM, it is removed from its original position.\n\t * @param {Node} oldChild\n\t * The existing child node to be replaced.\n\t * @returns {Node}\n\t * Returns the replaced child node.\n\t * @throws {DOMException}\n\t * Throws a DOMException if replacing the node would result in a DOM tree that is not\n\t * well-formed, or if `oldChild` is not a child of `this`.\n\t * This can also occur if the pre-replacement validity assertion fails.\n\t * See {@link _insertBefore}, {@link Node.removeChild}, and\n\t * {@link assertPreReplacementValidityInDocument} for more details.\n\t * @see https://dom.spec.whatwg.org/#concept-node-replace\n\t */\n\treplaceChild: function (newChild, oldChild) {\n\t\t_insertBefore(this, newChild, oldChild, assertPreReplacementValidityInDocument);\n\t\tif (oldChild) {\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t},\n\t/**\n\t * Removes an existing child node from this node.\n\t *\n\t * @param {Node} oldChild\n\t * The child node to be removed.\n\t * @returns {Node}\n\t * Returns the removed child node.\n\t * @throws {DOMException}\n\t * Throws a DOMException if `oldChild` is not a child of `this`.\n\t * See {@link _removeChild} for more details.\n\t */\n\tremoveChild: function (oldChild) {\n\t\treturn _removeChild(this, oldChild);\n\t},\n\t/**\n\t * Appends a child node to this node.\n\t *\n\t * @param {Node} newChild\n\t * The child node to be appended to this node.\n\t * If it already exists in the DOM, it is removed from its original position.\n\t * @returns {Node}\n\t * Returns the appended child node.\n\t * @throws {DOMException}\n\t * Throws a DOMException if appending the node would result in a DOM tree that is not\n\t * well-formed, or if `newChild` is not a valid Node.\n\t * See {@link insertBefore} for more details.\n\t */\n\tappendChild: function (newChild) {\n\t\treturn this.insertBefore(newChild, null);\n\t},\n\t/**\n\t * Determines whether this node has any child nodes.\n\t *\n\t * @returns {boolean}\n\t * Returns true if this node has any child nodes, and false otherwise.\n\t */\n\thasChildNodes: function () {\n\t\treturn this.firstChild != null;\n\t},\n\t/**\n\t * Creates a copy of the calling node.\n\t *\n\t * @param {boolean} deep\n\t * If true, the contents of the node are recursively copied.\n\t * If false, only the node itself (and its attributes, if it is an element) are copied.\n\t * @returns {Node}\n\t * Returns the newly created copy of the node.\n\t * @throws {DOMException}\n\t * May throw a DOMException if operations within {@link Element#setAttributeNode} or\n\t * {@link Node#appendChild} (which are potentially invoked in this method) do not meet their\n\t * specific constraints.\n\t * @see {@link cloneNode}\n\t */\n\tcloneNode: function (deep) {\n\t\treturn cloneNode(this.ownerDocument || this, this, deep);\n\t},\n\t/**\n\t * Puts the specified node and all of its subtree into a \"normalized\" form. In a normalized\n\t * subtree, no text nodes in the subtree are empty and there are no adjacent text nodes.\n\t *\n\t * Specifically, this method merges any adjacent text nodes (i.e., nodes for which `nodeType`\n\t * is `TEXT_NODE`) into a single node with the combined data. It also removes any empty text\n\t * nodes.\n\t *\n\t * This method operates recursively, so it also normalizes any and all descendent nodes within\n\t * the subtree.\n\t *\n\t * @throws {DOMException}\n\t * May throw a DOMException if operations within removeChild or appendData (which are\n\t * potentially invoked in this method) do not meet their specific constraints.\n\t * @since Modified in DOM Level 2\n\t * @see {@link Node.removeChild}\n\t * @see {@link CharacterData.appendData}\n\t */\n\tnormalize: function () {\n\t\tvar child = this.firstChild;\n\t\twhile (child) {\n\t\t\tvar next = child.nextSibling;\n\t\t\tif (next && next.nodeType == TEXT_NODE && child.nodeType == TEXT_NODE) {\n\t\t\t\tthis.removeChild(next);\n\t\t\t\tchild.appendData(next.data);\n\t\t\t} else {\n\t\t\t\tchild.normalize();\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * Checks whether the DOM implementation implements a specific feature and its version.\n\t *\n\t * @deprecated\n\t * Since `DOMImplementation.hasFeature` is deprecated and always returns true.\n\t * @param {string} feature\n\t * The package name of the feature to test. This is the same name that can be passed to the\n\t * method `hasFeature` on `DOMImplementation`.\n\t * @param {string} version\n\t * This is the version number of the package name to test.\n\t * @returns {boolean}\n\t * Returns true in all cases in the current implementation.\n\t * @since Introduced in DOM Level 2\n\t * @see {@link DOMImplementation.hasFeature}\n\t */\n\tisSupported: function (feature, version) {\n\t\treturn this.ownerDocument.implementation.hasFeature(feature, version);\n\t},\n\t/**\n\t * Look up the prefix associated to the given namespace URI, starting from this node.\n\t * **The default namespace declarations are ignored by this method.**\n\t * See Namespace Prefix Lookup for details on the algorithm used by this method.\n\t *\n\t * **This behavior is different from the in the specs**:\n\t * - no node type specific handling\n\t * - uses the internal attribute _nsMap for resolving namespaces that is updated when changing attributes\n\t *\n\t * @param {string | null} namespaceURI\n\t * The namespace URI for which to find the associated prefix.\n\t * @returns {string | null}\n\t * The associated prefix, if found; otherwise, null.\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespacePrefix\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/namespaces-algorithms.html#lookupNamespacePrefixAlgo\n\t * @see https://dom.spec.whatwg.org/#dom-node-lookupprefix\n\t * @see https://github.com/xmldom/xmldom/issues/322\n\t * @prettierignore\n\t */\n\tlookupPrefix: function (namespaceURI) {\n\t\tvar el = this;\n\t\twhile (el) {\n\t\t\tvar map = el._nsMap;\n\t\t\t//console.dir(map)\n\t\t\tif (map) {\n\t\t\t\tfor (var n in map) {\n\t\t\t\t\tif (hasOwn(map, n) && map[n] === namespaceURI) {\n\t\t\t\t\t\treturn n;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tel = el.nodeType == ATTRIBUTE_NODE ? el.ownerDocument : el.parentNode;\n\t\t}\n\t\treturn null;\n\t},\n\t/**\n\t * This function is used to look up the namespace URI associated with the given prefix,\n\t * starting from this node.\n\t *\n\t * **This behavior is different from the in the specs**:\n\t * - no node type specific handling\n\t * - uses the internal attribute _nsMap for resolving namespaces that is updated when changing attributes\n\t *\n\t * @param {string | null} prefix\n\t * The prefix for which to find the associated namespace URI.\n\t * @returns {string | null}\n\t * The associated namespace URI, if found; otherwise, null.\n\t * @since DOM Level 3\n\t * @see https://dom.spec.whatwg.org/#dom-node-lookupnamespaceuri\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespaceURI\n\t * @prettierignore\n\t */\n\tlookupNamespaceURI: function (prefix) {\n\t\tvar el = this;\n\t\twhile (el) {\n\t\t\tvar map = el._nsMap;\n\t\t\t//console.dir(map)\n\t\t\tif (map) {\n\t\t\t\tif (hasOwn(map, prefix)) {\n\t\t\t\t\treturn map[prefix];\n\t\t\t\t}\n\t\t\t}\n\t\t\tel = el.nodeType == ATTRIBUTE_NODE ? el.ownerDocument : el.parentNode;\n\t\t}\n\t\treturn null;\n\t},\n\t/**\n\t * Determines whether the given namespace URI is the default namespace.\n\t *\n\t * The function works by looking up the prefix associated with the given namespace URI. If no\n\t * prefix is found (i.e., the namespace URI is not registered in the namespace map of this\n\t * node or any of its ancestors), it returns `true`, implying the namespace URI is considered\n\t * the default.\n\t *\n\t * **This behavior is different from the in the specs**:\n\t * - no node type specific handling\n\t * - uses the internal attribute _nsMap for resolving namespaces that is updated when changing attributes\n\t *\n\t * @param {string | null} namespaceURI\n\t * The namespace URI to be checked.\n\t * @returns {boolean}\n\t * Returns true if the given namespace URI is the default namespace, false otherwise.\n\t * @since DOM Level 3\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-isDefaultNamespace\n\t * @see https://dom.spec.whatwg.org/#dom-node-isdefaultnamespace\n\t * @prettierignore\n\t */\n\tisDefaultNamespace: function (namespaceURI) {\n\t\tvar prefix = this.lookupPrefix(namespaceURI);\n\t\treturn prefix == null;\n\t},\n\t/**\n\t * Compares the reference node with a node with regard to their position in the document and\n\t * according to the document order.\n\t *\n\t * @param {Node} other\n\t * The node to compare the reference node to.\n\t * @returns {number}\n\t * Returns how the node is positioned relatively to the reference node according to the\n\t * bitmask. 0 if reference node and given node are the same.\n\t * @since DOM Level 3\n\t * @see https://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#Node3-compare\n\t * @see https://dom.spec.whatwg.org/#dom-node-comparedocumentposition\n\t */\n\tcompareDocumentPosition: function (other) {\n\t\tif (this === other) return 0;\n\t\tvar node1 = other;\n\t\tvar node2 = this;\n\t\tvar attr1 = null;\n\t\tvar attr2 = null;\n\t\tif (node1 instanceof Attr) {\n\t\t\tattr1 = node1;\n\t\t\tnode1 = attr1.ownerElement;\n\t\t}\n\t\tif (node2 instanceof Attr) {\n\t\t\tattr2 = node2;\n\t\t\tnode2 = attr2.ownerElement;\n\t\t\tif (attr1 && node1 && node2 === node1) {\n\t\t\t\tfor (var i = 0, attr; (attr = node2.attributes[i]); i++) {\n\t\t\t\t\tif (attr === attr1)\n\t\t\t\t\t\treturn DocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC + DocumentPosition.DOCUMENT_POSITION_PRECEDING;\n\t\t\t\t\tif (attr === attr2)\n\t\t\t\t\t\treturn DocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC + DocumentPosition.DOCUMENT_POSITION_FOLLOWING;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!node1 || !node2 || node2.ownerDocument !== node1.ownerDocument) {\n\t\t\treturn (\n\t\t\t\tDocumentPosition.DOCUMENT_POSITION_DISCONNECTED +\n\t\t\t\tDocumentPosition.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC +\n\t\t\t\t(docGUID(node2.ownerDocument) > docGUID(node1.ownerDocument)\n\t\t\t\t\t? DocumentPosition.DOCUMENT_POSITION_FOLLOWING\n\t\t\t\t\t: DocumentPosition.DOCUMENT_POSITION_PRECEDING)\n\t\t\t);\n\t\t}\n\t\tif (attr2 && node1 === node2) {\n\t\t\treturn DocumentPosition.DOCUMENT_POSITION_CONTAINS + DocumentPosition.DOCUMENT_POSITION_PRECEDING;\n\t\t}\n\t\tif (attr1 && node1 === node2) {\n\t\t\treturn DocumentPosition.DOCUMENT_POSITION_CONTAINED_BY + DocumentPosition.DOCUMENT_POSITION_FOLLOWING;\n\t\t}\n\n\t\tvar chain1 = [];\n\t\tvar ancestor1 = node1.parentNode;\n\t\twhile (ancestor1) {\n\t\t\tif (!attr2 && ancestor1 === node2) {\n\t\t\t\treturn DocumentPosition.DOCUMENT_POSITION_CONTAINED_BY + DocumentPosition.DOCUMENT_POSITION_FOLLOWING;\n\t\t\t}\n\t\t\tchain1.push(ancestor1);\n\t\t\tancestor1 = ancestor1.parentNode;\n\t\t}\n\t\tchain1.reverse();\n\n\t\tvar chain2 = [];\n\t\tvar ancestor2 = node2.parentNode;\n\t\twhile (ancestor2) {\n\t\t\tif (!attr1 && ancestor2 === node1) {\n\t\t\t\treturn DocumentPosition.DOCUMENT_POSITION_CONTAINS + DocumentPosition.DOCUMENT_POSITION_PRECEDING;\n\t\t\t}\n\t\t\tchain2.push(ancestor2);\n\t\t\tancestor2 = ancestor2.parentNode;\n\t\t}\n\t\tchain2.reverse();\n\n\t\tvar ca = commonAncestor(chain1, chain2);\n\t\tfor (var n in ca.childNodes) {\n\t\t\tvar child = ca.childNodes[n];\n\t\t\tif (child === node2) return DocumentPosition.DOCUMENT_POSITION_FOLLOWING;\n\t\t\tif (child === node1) return DocumentPosition.DOCUMENT_POSITION_PRECEDING;\n\t\t\tif (chain2.indexOf(child) >= 0) return DocumentPosition.DOCUMENT_POSITION_FOLLOWING;\n\t\t\tif (chain1.indexOf(child) >= 0) return DocumentPosition.DOCUMENT_POSITION_PRECEDING;\n\t\t}\n\t\treturn 0;\n\t},\n};\n\n/**\n * Encodes special XML characters to their corresponding entities.\n *\n * @param {string} c\n * The character to be encoded.\n * @returns {string}\n * The encoded character.\n * @private\n */\nfunction _xmlEncoder(c) {\n\treturn (\n\t\t(c == '<' && '&lt;') || (c == '>' && '&gt;') || (c == '&' && '&amp;') || (c == '\"' && '&quot;') || '&#' + c.charCodeAt() + ';'\n\t);\n}\n\ncopy(NodeType, Node);\ncopy(NodeType, Node.prototype);\ncopy(DocumentPosition, Node);\ncopy(DocumentPosition, Node.prototype);\n\n/**\n * @param callback\n * Return true for continue,false for break.\n * @returns\n * boolean true: break visit;\n */\nfunction _visitNode(node, callback) {\n\tif (callback(node)) {\n\t\treturn true;\n\t}\n\tif ((node = node.firstChild)) {\n\t\tdo {\n\t\t\tif (_visitNode(node, callback)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} while ((node = node.nextSibling));\n\t}\n}\n\n/**\n * @typedef DocumentOptions\n * @property {string} [contentType=MIME_TYPE.XML_APPLICATION]\n */\n/**\n * The Document interface describes the common properties and methods for any kind of document.\n *\n * It should usually be created using `new DOMImplementation().createDocument(...)`\n * or `new DOMImplementation().createHTMLDocument(...)`.\n *\n * The constructor is considered a private API and offers to initially set the `contentType`\n * property via it's options parameter.\n *\n * @class\n * @param {Symbol} symbol\n * @param {DocumentOptions} [options]\n * @augments Node\n * @private\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Document\n * @see https://dom.spec.whatwg.org/#interface-document\n */\nfunction Document(symbol, options) {\n\tcheckSymbol(symbol);\n\n\tvar opt = options || {};\n\tthis.ownerDocument = this;\n\t/**\n\t * The mime type of the document is determined at creation time and can not be modified.\n\t *\n\t * @type {string}\n\t * @see https://dom.spec.whatwg.org/#concept-document-content-type\n\t * @see {@link DOMImplementation}\n\t * @see {@link MIME_TYPE}\n\t * @readonly\n\t */\n\tthis.contentType = opt.contentType || MIME_TYPE.XML_APPLICATION;\n\t/**\n\t * @type {'html' | 'xml'}\n\t * @see https://dom.spec.whatwg.org/#concept-document-type\n\t * @see {@link DOMImplementation}\n\t * @readonly\n\t */\n\tthis.type = isHTMLMimeType(this.contentType) ? 'html' : 'xml';\n}\n\n/**\n * Updates the namespace mapping of an element when a new attribute is added.\n *\n * @param {Document} doc\n * The document that the element belongs to.\n * @param {Element} el\n * The element to which the attribute is being added.\n * @param {Attr} newAttr\n * The new attribute being added.\n * @private\n */\nfunction _onAddAttribute(doc, el, newAttr) {\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI;\n\tif (ns === NAMESPACE.XMLNS) {\n\t\t//update namespace\n\t\tel._nsMap[newAttr.prefix ? newAttr.localName : ''] = newAttr.value;\n\t}\n}\n\n/**\n * Updates the namespace mapping of an element when an attribute is removed.\n *\n * @param {Document} doc\n * The document that the element belongs to.\n * @param {Element} el\n * The element from which the attribute is being removed.\n * @param {Attr} newAttr\n * The attribute being removed.\n * @param {boolean} remove\n * Indicates whether the attribute is to be removed.\n * @private\n */\nfunction _onRemoveAttribute(doc, el, newAttr, remove) {\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI;\n\tif (ns === NAMESPACE.XMLNS) {\n\t\t//update namespace\n\t\tdelete el._nsMap[newAttr.prefix ? newAttr.localName : ''];\n\t}\n}\n\n/**\n * Updates `parent.childNodes`, adjusting the indexed items and its `length`.\n * If `newChild` is provided and has no nextSibling, it will be appended.\n * Otherwise, it's assumed that an item has been removed or inserted,\n * and `parent.firstNode` and its `.nextSibling` to re-indexing all child nodes of `parent`.\n *\n * @param {Document} doc\n * The parent document of `el`.\n * @param {Node} parent\n * The parent node whose childNodes list needs to be updated.\n * @param {Node} [newChild]\n * The new child node to be appended. If not provided, the function assumes a node has been\n * removed.\n * @private\n */\nfunction _onUpdateChild(doc, parent, newChild) {\n\tif (doc && doc._inc) {\n\t\tdoc._inc++;\n\t\tvar childNodes = parent.childNodes;\n\t\t// assumes nextSibling and previousSibling were already configured upfront\n\t\tif (newChild && !newChild.nextSibling) {\n\t\t\t// if an item has been appended, we only need to update the last index and the length\n\t\t\tchildNodes[childNodes.length++] = newChild;\n\t\t} else {\n\t\t\t// otherwise we need to reindex all items,\n\t\t\t// which can take a while when processing nodes with a lot of children\n\t\t\tvar child = parent.firstChild;\n\t\t\tvar i = 0;\n\t\t\twhile (child) {\n\t\t\t\tchildNodes[i++] = child;\n\t\t\t\tchild = child.nextSibling;\n\t\t\t}\n\t\t\tchildNodes.length = i;\n\t\t\tdelete childNodes[childNodes.length];\n\t\t}\n\t}\n}\n\n/**\n * Removes the connections between `parentNode` and `child`\n * and any existing `child.previousSibling` or `child.nextSibling`.\n *\n * @param {Node} parentNode\n * The parent node from which the child node is to be removed.\n * @param {Node} child\n * The child node to be removed from the parentNode.\n * @returns {Node}\n * Returns the child node that was removed.\n * @throws {DOMException}\n * With code:\n * - {@link DOMException.NOT_FOUND_ERR} If the parentNode is not the parent of the child node.\n * @private\n * @see https://github.com/xmldom/xmldom/issues/135\n * @see https://github.com/xmldom/xmldom/issues/145\n */\nfunction _removeChild(parentNode, child) {\n\tif (parentNode !== child.parentNode) {\n\t\tthrow new DOMException(DOMException.NOT_FOUND_ERR, \"child's parent is not parent\");\n\t}\n\tvar oldPreviousSibling = child.previousSibling;\n\tvar oldNextSibling = child.nextSibling;\n\tif (oldPreviousSibling) {\n\t\toldPreviousSibling.nextSibling = oldNextSibling;\n\t} else {\n\t\tparentNode.firstChild = oldNextSibling;\n\t}\n\tif (oldNextSibling) {\n\t\toldNextSibling.previousSibling = oldPreviousSibling;\n\t} else {\n\t\tparentNode.lastChild = oldPreviousSibling;\n\t}\n\t_onUpdateChild(parentNode.ownerDocument, parentNode);\n\tchild.parentNode = null;\n\tchild.previousSibling = null;\n\tchild.nextSibling = null;\n\treturn child;\n}\n\n/**\n * Returns `true` if `node` can be a parent for insertion.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nfunction hasValidParentNodeType(node) {\n\treturn (\n\t\tnode &&\n\t\t(node.nodeType === Node.DOCUMENT_NODE || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE || node.nodeType === Node.ELEMENT_NODE)\n\t);\n}\n\n/**\n * Returns `true` if `node` can be inserted according to it's `nodeType`.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nfunction hasInsertableNodeType(node) {\n\treturn (\n\t\tnode &&\n\t\t(node.nodeType === Node.CDATA_SECTION_NODE ||\n\t\t\tnode.nodeType === Node.COMMENT_NODE ||\n\t\t\tnode.nodeType === Node.DOCUMENT_FRAGMENT_NODE ||\n\t\t\tnode.nodeType === Node.DOCUMENT_TYPE_NODE ||\n\t\t\tnode.nodeType === Node.ELEMENT_NODE ||\n\t\t\tnode.nodeType === Node.PROCESSING_INSTRUCTION_NODE ||\n\t\t\tnode.nodeType === Node.TEXT_NODE)\n\t);\n}\n\n/**\n * Returns true if `node` is a DOCTYPE node.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isDocTypeNode(node) {\n\treturn node && node.nodeType === Node.DOCUMENT_TYPE_NODE;\n}\n\n/**\n * Returns true if the node is an element.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isElementNode(node) {\n\treturn node && node.nodeType === Node.ELEMENT_NODE;\n}\n/**\n * Returns true if `node` is a text node.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isTextNode(node) {\n\treturn node && node.nodeType === Node.TEXT_NODE;\n}\n\n/**\n * Check if en element node can be inserted before `child`, or at the end if child is falsy,\n * according to the presence and position of a doctype node on the same level.\n *\n * @param {Document} doc\n * The document node.\n * @param {Node} child\n * The node that would become the nextSibling if the element would be inserted.\n * @returns {boolean}\n * `true` if an element can be inserted before child.\n * @private\n */\nfunction isElementInsertionPossible(doc, child) {\n\tvar parentChildNodes = doc.childNodes || [];\n\tif (find(parentChildNodes, isElementNode) || isDocTypeNode(child)) {\n\t\treturn false;\n\t}\n\tvar docTypeNode = find(parentChildNodes, isDocTypeNode);\n\treturn !(child && docTypeNode && parentChildNodes.indexOf(docTypeNode) > parentChildNodes.indexOf(child));\n}\n\n/**\n * Check if en element node can be inserted before `child`, or at the end if child is falsy,\n * according to the presence and position of a doctype node on the same level.\n *\n * @param {Node} doc\n * The document node.\n * @param {Node} child\n * The node that would become the nextSibling if the element would be inserted.\n * @returns {boolean}\n * `true` if an element can be inserted before child.\n * @private\n */\nfunction isElementReplacementPossible(doc, child) {\n\tvar parentChildNodes = doc.childNodes || [];\n\n\tfunction hasElementChildThatIsNotChild(node) {\n\t\treturn isElementNode(node) && node !== child;\n\t}\n\n\tif (find(parentChildNodes, hasElementChildThatIsNotChild)) {\n\t\treturn false;\n\t}\n\tvar docTypeNode = find(parentChildNodes, isDocTypeNode);\n\treturn !(child && docTypeNode && parentChildNodes.indexOf(docTypeNode) > parentChildNodes.indexOf(child));\n}\n\n/**\n * Asserts pre-insertion validity of a node into a parent before a child.\n * Throws errors for invalid node combinations that would result in an ill-formed DOM.\n *\n * @param {Node} parent\n * The parent node to insert `node` into.\n * @param {Node} node\n * The node to insert.\n * @param {Node | null} child\n * The node that should become the `nextSibling` of `node`. If null, no sibling is considered.\n * @throws {DOMException}\n * With code:\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `parent` is not a Document,\n * DocumentFragment, or Element node.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is a host-including inclusive\n * ancestor of `parent`. (Currently not implemented)\n * - {@link DOMException.NOT_FOUND_ERR} If `child` is non-null and its `parent` is not\n * `parent`.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is not a DocumentFragment,\n * DocumentType, Element, or CharacterData node.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If either `node` is a Text node and `parent` is\n * a document, or if `node` is a doctype and `parent` is not a document.\n * @private\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreInsertionValidity1to5(parent, node, child) {\n\t// 1. If `parent` is not a Document, DocumentFragment, or Element node, then throw a \"HierarchyRequestError\" DOMException.\n\tif (!hasValidParentNodeType(parent)) {\n\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Unexpected parent node type ' + parent.nodeType);\n\t}\n\t// 2. If `node` is a host-including inclusive ancestor of `parent`, then throw a \"HierarchyRequestError\" DOMException.\n\t// not implemented!\n\t// 3. If `child` is non-null and its parent is not `parent`, then throw a \"NotFoundError\" DOMException.\n\tif (child && child.parentNode !== parent) {\n\t\tthrow new DOMException(DOMException.NOT_FOUND_ERR, 'child not in parent');\n\t}\n\tif (\n\t\t// 4. If `node` is not a DocumentFragment, DocumentType, Element, or CharacterData node, then throw a \"HierarchyRequestError\" DOMException.\n\t\t!hasInsertableNodeType(node) ||\n\t\t// 5. If either `node` is a Text node and `parent` is a document,\n\t\t// the sax parser currently adds top level text nodes, this will be fixed in 0.9.0\n\t\t// || (node.nodeType === Node.TEXT_NODE && parent.nodeType === Node.DOCUMENT_NODE)\n\t\t// or `node` is a doctype and `parent` is not a document, then throw a \"HierarchyRequestError\" DOMException.\n\t\t(isDocTypeNode(node) && parent.nodeType !== Node.DOCUMENT_NODE)\n\t) {\n\t\tthrow new DOMException(\n\t\t\tDOMException.HIERARCHY_REQUEST_ERR,\n\t\t\t'Unexpected node type ' + node.nodeType + ' for parent node type ' + parent.nodeType\n\t\t);\n\t}\n}\n\n/**\n * Asserts pre-insertion validity of a node into a document before a child.\n * Throws errors for invalid node combinations that would result in an ill-formed DOM.\n *\n * @param {Document} parent\n * The parent node to insert `node` into.\n * @param {Node} node\n * The node to insert.\n * @param {Node | undefined} child\n * The node that should become the `nextSibling` of `node`. If undefined, no sibling is\n * considered.\n * @returns {Node}\n * @throws {DOMException}\n * With code:\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is a DocumentFragment with more than\n * one element child or has a Text node child.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is a DocumentFragment with one\n * element child and either `parent` has an element child, `child` is a doctype, or `child` is\n * non-null and a doctype is following `child`.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is an Element and `parent` has an\n * element child, `child` is a doctype, or `child` is non-null and a doctype is following\n * `child`.\n * - {@link DOMException.HIERARCHY_REQUEST_ERR} If `node` is a DocumentType and `parent` has a\n * doctype child, `child` is non-null and an element is preceding `child`, or `child` is null\n * and `parent` has an element child.\n * @private\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreInsertionValidityInDocument(parent, node, child) {\n\tvar parentChildNodes = parent.childNodes || [];\n\tvar nodeChildNodes = node.childNodes || [];\n\n\t// DocumentFragment\n\tif (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n\t\tvar nodeChildElements = nodeChildNodes.filter(isElementNode);\n\t\t// If node has more than one element child or has a Text node child.\n\t\tif (nodeChildElements.length > 1 || find(nodeChildNodes, isTextNode)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'More than one element or text in fragment');\n\t\t}\n\t\t// Otherwise, if `node` has one element child and either `parent` has an element child,\n\t\t// `child` is a doctype, or `child` is non-null and a doctype is following `child`.\n\t\tif (nodeChildElements.length === 1 && !isElementInsertionPossible(parent, child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Element in fragment can not be inserted before doctype');\n\t\t}\n\t}\n\t// Element\n\tif (isElementNode(node)) {\n\t\t// `parent` has an element child, `child` is a doctype,\n\t\t// or `child` is non-null and a doctype is following `child`.\n\t\tif (!isElementInsertionPossible(parent, child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Only one element can be added and only after doctype');\n\t\t}\n\t}\n\t// DocumentType\n\tif (isDocTypeNode(node)) {\n\t\t// `parent` has a doctype child,\n\t\tif (find(parentChildNodes, isDocTypeNode)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Only one doctype is allowed');\n\t\t}\n\t\tvar parentElementChild = find(parentChildNodes, isElementNode);\n\t\t// `child` is non-null and an element is preceding `child`,\n\t\tif (child && parentChildNodes.indexOf(parentElementChild) < parentChildNodes.indexOf(child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Doctype can only be inserted before an element');\n\t\t}\n\t\t// or `child` is null and `parent` has an element child.\n\t\tif (!child && parentElementChild) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Doctype can not be appended since element is present');\n\t\t}\n\t}\n}\n\n/**\n * @param {Document} parent\n * The parent node to insert `node` into.\n * @param {Node} node\n * The node to insert.\n * @param {Node | undefined} child\n * the node that should become the `nextSibling` of `node`\n * @returns {Node}\n * @throws {DOMException}\n * For several node combinations that would create a DOM that is not well-formed.\n * @throws {DOMException}\n * If `child` is provided but is not a child of `parent`.\n * @private\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreReplacementValidityInDocument(parent, node, child) {\n\tvar parentChildNodes = parent.childNodes || [];\n\tvar nodeChildNodes = node.childNodes || [];\n\n\t// DocumentFragment\n\tif (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n\t\tvar nodeChildElements = nodeChildNodes.filter(isElementNode);\n\t\t// If `node` has more than one element child or has a Text node child.\n\t\tif (nodeChildElements.length > 1 || find(nodeChildNodes, isTextNode)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'More than one element or text in fragment');\n\t\t}\n\t\t// Otherwise, if `node` has one element child and either `parent` has an element child that is not `child` or a doctype is following `child`.\n\t\tif (nodeChildElements.length === 1 && !isElementReplacementPossible(parent, child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Element in fragment can not be inserted before doctype');\n\t\t}\n\t}\n\t// Element\n\tif (isElementNode(node)) {\n\t\t// `parent` has an element child that is not `child` or a doctype is following `child`.\n\t\tif (!isElementReplacementPossible(parent, child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Only one element can be added and only after doctype');\n\t\t}\n\t}\n\t// DocumentType\n\tif (isDocTypeNode(node)) {\n\t\tfunction hasDoctypeChildThatIsNotChild(node) {\n\t\t\treturn isDocTypeNode(node) && node !== child;\n\t\t}\n\n\t\t// `parent` has a doctype child that is not `child`,\n\t\tif (find(parentChildNodes, hasDoctypeChildThatIsNotChild)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Only one doctype is allowed');\n\t\t}\n\t\tvar parentElementChild = find(parentChildNodes, isElementNode);\n\t\t// or an element is preceding `child`.\n\t\tif (child && parentChildNodes.indexOf(parentElementChild) < parentChildNodes.indexOf(child)) {\n\t\t\tthrow new DOMException(DOMException.HIERARCHY_REQUEST_ERR, 'Doctype can only be inserted before an element');\n\t\t}\n\t}\n}\n\n/**\n * Inserts a node into a parent node before a child node.\n *\n * @param {Node} parent\n * The parent node to insert the node into.\n * @param {Node} node\n * The node to insert into the parent.\n * @param {Node | null} child\n * The node that should become the next sibling of the node.\n * If null, the function inserts the node at the end of the children of the parent node.\n * @param {Function} [_inDocumentAssertion]\n * An optional function to check pre-insertion validity if parent is a document node.\n * Defaults to {@link assertPreInsertionValidityInDocument}\n * @returns {Node}\n * Returns the inserted node.\n * @throws {DOMException}\n * Throws a DOMException if inserting the node would result in a DOM tree that is not\n * well-formed. See {@link assertPreInsertionValidity1to5},\n * {@link assertPreInsertionValidityInDocument}.\n * @throws {DOMException}\n * Throws a DOMException if child is provided but is not a child of the parent. See\n * {@link Node.removeChild}\n * @private\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n */\nfunction _insertBefore(parent, node, child, _inDocumentAssertion) {\n\t// To ensure pre-insertion validity of a node into a parent before a child, run these steps:\n\tassertPreInsertionValidity1to5(parent, node, child);\n\n\t// If parent is a document, and any of the statements below, switched on the interface node implements,\n\t// are true, then throw a \"HierarchyRequestError\" DOMException.\n\tif (parent.nodeType === Node.DOCUMENT_NODE) {\n\t\t(_inDocumentAssertion || assertPreInsertionValidityInDocument)(parent, node, child);\n\t}\n\n\tvar cp = node.parentNode;\n\tif (cp) {\n\t\tcp.removeChild(node); //remove and update\n\t}\n\tif (node.nodeType === DOCUMENT_FRAGMENT_NODE) {\n\t\tvar newFirst = node.firstChild;\n\t\tif (newFirst == null) {\n\t\t\treturn node;\n\t\t}\n\t\tvar newLast = node.lastChild;\n\t} else {\n\t\tnewFirst = newLast = node;\n\t}\n\tvar pre = child ? child.previousSibling : parent.lastChild;\n\n\tnewFirst.previousSibling = pre;\n\tnewLast.nextSibling = child;\n\n\tif (pre) {\n\t\tpre.nextSibling = newFirst;\n\t} else {\n\t\tparent.firstChild = newFirst;\n\t}\n\tif (child == null) {\n\t\tparent.lastChild = newLast;\n\t} else {\n\t\tchild.previousSibling = newLast;\n\t}\n\tdo {\n\t\tnewFirst.parentNode = parent;\n\t} while (newFirst !== newLast && (newFirst = newFirst.nextSibling));\n\t_onUpdateChild(parent.ownerDocument || parent, parent, node);\n\tif (node.nodeType == DOCUMENT_FRAGMENT_NODE) {\n\t\tnode.firstChild = node.lastChild = null;\n\t}\n\n\treturn node;\n}\n\nDocument.prototype = {\n\t/**\n\t * The implementation that created this document.\n\t *\n\t * @type DOMImplementation\n\t * @readonly\n\t */\n\timplementation: null,\n\tnodeName: '#document',\n\tnodeType: DOCUMENT_NODE,\n\t/**\n\t * The DocumentType node of the document.\n\t *\n\t * @type DocumentType\n\t * @readonly\n\t */\n\tdoctype: null,\n\tdocumentElement: null,\n\t_inc: 1,\n\n\tinsertBefore: function (newChild, refChild) {\n\t\t//raises\n\t\tif (newChild.nodeType === DOCUMENT_FRAGMENT_NODE) {\n\t\t\tvar child = newChild.firstChild;\n\t\t\twhile (child) {\n\t\t\t\tvar next = child.nextSibling;\n\t\t\t\tthis.insertBefore(child, refChild);\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t\treturn newChild;\n\t\t}\n\t\t_insertBefore(this, newChild, refChild);\n\t\tnewChild.ownerDocument = this;\n\t\tif (this.documentElement === null && newChild.nodeType === ELEMENT_NODE) {\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\n\t\treturn newChild;\n\t},\n\tremoveChild: function (oldChild) {\n\t\tvar removed = _removeChild(this, oldChild);\n\t\tif (removed === this.documentElement) {\n\t\t\tthis.documentElement = null;\n\t\t}\n\t\treturn removed;\n\t},\n\treplaceChild: function (newChild, oldChild) {\n\t\t//raises\n\t\t_insertBefore(this, newChild, oldChild, assertPreReplacementValidityInDocument);\n\t\tnewChild.ownerDocument = this;\n\t\tif (oldChild) {\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t\tif (isElementNode(newChild)) {\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\t},\n\t// Introduced in DOM Level 2:\n\timportNode: function (importedNode, deep) {\n\t\treturn importNode(this, importedNode, deep);\n\t},\n\t// Introduced in DOM Level 2:\n\tgetElementById: function (id) {\n\t\tvar rtv = null;\n\t\t_visitNode(this.documentElement, function (node) {\n\t\t\tif (node.nodeType == ELEMENT_NODE) {\n\t\t\t\tif (node.getAttribute('id') == id) {\n\t\t\t\t\trtv = node;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn rtv;\n\t},\n\n\t/**\n\t * Creates a new `Element` that is owned by this `Document`.\n\t * In HTML Documents `localName` is the lower cased `tagName`,\n\t * otherwise no transformation is being applied.\n\t * When `contentType` implies the HTML namespace, it will be set as `namespaceURI`.\n\t *\n\t * __This implementation differs from the specification:__ - The provided name is not checked\n\t * against the `Name` production,\n\t * so no related error will be thrown.\n\t * - There is no interface `HTMLElement`, it is always an `Element`.\n\t * - There is no support for a second argument to indicate using custom elements.\n\t *\n\t * @param {string} tagName\n\t * @returns {Element}\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement\n\t * @see https://dom.spec.whatwg.org/#dom-document-createelement\n\t * @see https://dom.spec.whatwg.org/#concept-create-element\n\t */\n\tcreateElement: function (tagName) {\n\t\tvar node = new Element(PDC);\n\t\tnode.ownerDocument = this;\n\t\tif (this.type === 'html') {\n\t\t\ttagName = tagName.toLowerCase();\n\t\t}\n\t\tif (hasDefaultHTMLNamespace(this.contentType)) {\n\t\t\tnode.namespaceURI = NAMESPACE.HTML;\n\t\t}\n\t\tnode.nodeName = tagName;\n\t\tnode.tagName = tagName;\n\t\tnode.localName = tagName;\n\t\tnode.childNodes = new NodeList();\n\t\tvar attrs = (node.attributes = new NamedNodeMap());\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\t/**\n\t * @returns {DocumentFragment}\n\t */\n\tcreateDocumentFragment: function () {\n\t\tvar node = new DocumentFragment(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\treturn node;\n\t},\n\t/**\n\t * @param {string} data\n\t * @returns {Text}\n\t */\n\tcreateTextNode: function (data) {\n\t\tvar node = new Text(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.appendData(data);\n\t\treturn node;\n\t},\n\t/**\n\t * @param {string} data\n\t * @returns {Comment}\n\t */\n\tcreateComment: function (data) {\n\t\tvar node = new Comment(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.appendData(data);\n\t\treturn node;\n\t},\n\t/**\n\t * @param {string} data\n\t * @returns {CDATASection}\n\t */\n\tcreateCDATASection: function (data) {\n\t\tvar node = new CDATASection(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.appendData(data);\n\t\treturn node;\n\t},\n\t/**\n\t * @param {string} target\n\t * @param {string} data\n\t * @returns {ProcessingInstruction}\n\t */\n\tcreateProcessingInstruction: function (target, data) {\n\t\tvar node = new ProcessingInstruction(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.nodeName = node.target = target;\n\t\tnode.nodeValue = node.data = data;\n\t\treturn node;\n\t},\n\t/**\n\t * Creates an `Attr` node that is owned by this document.\n\t * In HTML Documents `localName` is the lower cased `name`,\n\t * otherwise no transformation is being applied.\n\t *\n\t * __This implementation differs from the specification:__ - The provided name is not checked\n\t * against the `Name` production,\n\t * so no related error will be thrown.\n\t *\n\t * @param {string} name\n\t * @returns {Attr}\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/createAttribute\n\t * @see https://dom.spec.whatwg.org/#dom-document-createattribute\n\t */\n\tcreateAttribute: function (name) {\n\t\tif (!g.QName_exact.test(name)) {\n\t\t\tthrow new DOMException(DOMException.INVALID_CHARACTER_ERR, 'invalid character in name \"' + name + '\"');\n\t\t}\n\t\tif (this.type === 'html') {\n\t\t\tname = name.toLowerCase();\n\t\t}\n\t\treturn this._createAttribute(name);\n\t},\n\t_createAttribute: function (name) {\n\t\tvar node = new Attr(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.name = name;\n\t\tnode.nodeName = name;\n\t\tnode.localName = name;\n\t\tnode.specified = true;\n\t\treturn node;\n\t},\n\t/**\n\t * Creates an EntityReference object.\n\t * The current implementation does not fill the `childNodes` with those of the corresponding\n\t * `Entity`\n\t *\n\t * @deprecated\n\t * In DOM Level 4.\n\t * @param {string} name\n\t * The name of the entity to reference. No namespace well-formedness checks are performed.\n\t * @returns {EntityReference}\n\t * @throws {DOMException}\n\t * With code `INVALID_CHARACTER_ERR` when `name` is not valid.\n\t * @throws {DOMException}\n\t * with code `NOT_SUPPORTED_ERR` when the document is of type `html`\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-392B75AE\n\t */\n\tcreateEntityReference: function (name) {\n\t\tif (!g.Name.test(name)) {\n\t\t\tthrow new DOMException(DOMException.INVALID_CHARACTER_ERR, 'not a valid xml name \"' + name + '\"');\n\t\t}\n\t\tif (this.type === 'html') {\n\t\t\tthrow new DOMException('document is an html document', DOMExceptionName.NotSupportedError);\n\t\t}\n\n\t\tvar node = new EntityReference(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.nodeName = name;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\t/**\n\t * @param {string} namespaceURI\n\t * @param {string} qualifiedName\n\t * @returns {Element}\n\t */\n\tcreateElementNS: function (namespaceURI, qualifiedName) {\n\t\tvar validated = validateAndExtract(namespaceURI, qualifiedName);\n\t\tvar node = new Element(PDC);\n\t\tvar attrs = (node.attributes = new NamedNodeMap());\n\t\tnode.childNodes = new NodeList();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.tagName = qualifiedName;\n\t\tnode.namespaceURI = validated[0];\n\t\tnode.prefix = validated[1];\n\t\tnode.localName = validated[2];\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\t/**\n\t * @param {string} namespaceURI\n\t * @param {string} qualifiedName\n\t * @returns {Attr}\n\t */\n\tcreateAttributeNS: function (namespaceURI, qualifiedName) {\n\t\tvar validated = validateAndExtract(namespaceURI, qualifiedName);\n\t\tvar node = new Attr(PDC);\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.name = qualifiedName;\n\t\tnode.specified = true;\n\t\tnode.namespaceURI = validated[0];\n\t\tnode.prefix = validated[1];\n\t\tnode.localName = validated[2];\n\t\treturn node;\n\t},\n};\n_extends(Document, Node);\n\nfunction Element(symbol) {\n\tcheckSymbol(symbol);\n\n\tthis._nsMap = Object.create(null);\n}\nElement.prototype = {\n\tnodeType: ELEMENT_NODE,\n\t/**\n\t * The attributes of this element.\n\t *\n\t * @type {NamedNodeMap | null}\n\t */\n\tattributes: null,\n\tgetQualifiedName: function () {\n\t\treturn this.prefix ? this.prefix + ':' + this.localName : this.localName;\n\t},\n\t_isInHTMLDocumentAndNamespace: function () {\n\t\treturn this.ownerDocument.type === 'html' && this.namespaceURI === NAMESPACE.HTML;\n\t},\n\t/**\n\t * Implementaton of Level2 Core function hasAttributes.\n\t *\n\t * @returns {boolean}\n\t * True if attribute list is not empty.\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/#core-ID-NodeHasAttrs\n\t */\n\thasAttributes: function () {\n\t\treturn !!(this.attributes && this.attributes.length);\n\t},\n\thasAttribute: function (name) {\n\t\treturn !!this.getAttributeNode(name);\n\t},\n\t/**\n\t * Returns element’s first attribute whose qualified name is `name`, and `null`\n\t * if there is no such attribute.\n\t *\n\t * @param {string} name\n\t * @returns {string | null}\n\t */\n\tgetAttribute: function (name) {\n\t\tvar attr = this.getAttributeNode(name);\n\t\treturn attr ? attr.value : null;\n\t},\n\tgetAttributeNode: function (name) {\n\t\tif (this._isInHTMLDocumentAndNamespace()) {\n\t\t\tname = name.toLowerCase();\n\t\t}\n\t\treturn this.attributes.getNamedItem(name);\n\t},\n\t/**\n\t * Sets the value of element’s first attribute whose qualified name is qualifiedName to value.\n\t *\n\t * @param {string} name\n\t * @param {string} value\n\t */\n\tsetAttribute: function (name, value) {\n\t\tif (this._isInHTMLDocumentAndNamespace()) {\n\t\t\tname = name.toLowerCase();\n\t\t}\n\t\tvar attr = this.getAttributeNode(name);\n\t\tif (attr) {\n\t\t\tattr.value = attr.nodeValue = '' + value;\n\t\t} else {\n\t\t\tattr = this.ownerDocument._createAttribute(name);\n\t\t\tattr.value = attr.nodeValue = '' + value;\n\t\t\tthis.setAttributeNode(attr);\n\t\t}\n\t},\n\tremoveAttribute: function (name) {\n\t\tvar attr = this.getAttributeNode(name);\n\t\tattr && this.removeAttributeNode(attr);\n\t},\n\tsetAttributeNode: function (newAttr) {\n\t\treturn this.attributes.setNamedItem(newAttr);\n\t},\n\tsetAttributeNodeNS: function (newAttr) {\n\t\treturn this.attributes.setNamedItemNS(newAttr);\n\t},\n\tremoveAttributeNode: function (oldAttr) {\n\t\t//console.log(this == oldAttr.ownerElement)\n\t\treturn this.attributes.removeNamedItem(oldAttr.nodeName);\n\t},\n\t//get real attribute name,and remove it by removeAttributeNode\n\tremoveAttributeNS: function (namespaceURI, localName) {\n\t\tvar old = this.getAttributeNodeNS(namespaceURI, localName);\n\t\told && this.removeAttributeNode(old);\n\t},\n\n\thasAttributeNS: function (namespaceURI, localName) {\n\t\treturn this.getAttributeNodeNS(namespaceURI, localName) != null;\n\t},\n\t/**\n\t * Returns element’s attribute whose namespace is `namespaceURI` and local name is\n\t * `localName`,\n\t * or `null` if there is no such attribute.\n\t *\n\t * @param {string} namespaceURI\n\t * @param {string} localName\n\t * @returns {string | null}\n\t */\n\tgetAttributeNS: function (namespaceURI, localName) {\n\t\tvar attr = this.getAttributeNodeNS(namespaceURI, localName);\n\t\treturn attr ? attr.value : null;\n\t},\n\t/**\n\t * Sets the value of element’s attribute whose namespace is `namespaceURI` and local name is\n\t * `localName` to value.\n\t *\n\t * @param {string} namespaceURI\n\t * @param {string} qualifiedName\n\t * @param {string} value\n\t * @see https://dom.spec.whatwg.org/#dom-element-setattributens\n\t */\n\tsetAttributeNS: function (namespaceURI, qualifiedName, value) {\n\t\tvar validated = validateAndExtract(namespaceURI, qualifiedName);\n\t\tvar localName = validated[2];\n\t\tvar attr = this.getAttributeNodeNS(namespaceURI, localName);\n\t\tif (attr) {\n\t\t\tattr.value = attr.nodeValue = '' + value;\n\t\t} else {\n\t\t\tattr = this.ownerDocument.createAttributeNS(namespaceURI, qualifiedName);\n\t\t\tattr.value = attr.nodeValue = '' + value;\n\t\t\tthis.setAttributeNode(attr);\n\t\t}\n\t},\n\tgetAttributeNodeNS: function (namespaceURI, localName) {\n\t\treturn this.attributes.getNamedItemNS(namespaceURI, localName);\n\t},\n\n\t/**\n\t * Returns a LiveNodeList of all child elements which have **all** of the given class name(s).\n\t *\n\t * Returns an empty list if `classNames` is an empty string or only contains HTML white space\n\t * characters.\n\t *\n\t * Warning: This returns a live LiveNodeList.\n\t * Changes in the DOM will reflect in the array as the changes occur.\n\t * If an element selected by this array no longer qualifies for the selector,\n\t * it will automatically be removed. Be aware of this for iteration purposes.\n\t *\n\t * @param {string} classNames\n\t * Is a string representing the class name(s) to match; multiple class names are separated by\n\t * (ASCII-)whitespace.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByClassName\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName\n\t * @see https://dom.spec.whatwg.org/#concept-getelementsbyclassname\n\t */\n\tgetElementsByClassName: function (classNames) {\n\t\tvar classNamesSet = toOrderedSet(classNames);\n\t\treturn new LiveNodeList(this, function (base) {\n\t\t\tvar ls = [];\n\t\t\tif (classNamesSet.length > 0) {\n\t\t\t\t_visitNode(base, function (node) {\n\t\t\t\t\tif (node !== base && node.nodeType === ELEMENT_NODE) {\n\t\t\t\t\t\tvar nodeClassNames = node.getAttribute('class');\n\t\t\t\t\t\t// can be null if the attribute does not exist\n\t\t\t\t\t\tif (nodeClassNames) {\n\t\t\t\t\t\t\t// before splitting and iterating just compare them for the most common case\n\t\t\t\t\t\t\tvar matches = classNames === nodeClassNames;\n\t\t\t\t\t\t\tif (!matches) {\n\t\t\t\t\t\t\t\tvar nodeClassNamesSet = toOrderedSet(nodeClassNames);\n\t\t\t\t\t\t\t\tmatches = classNamesSet.every(arrayIncludes(nodeClassNamesSet));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (matches) {\n\t\t\t\t\t\t\t\tls.push(node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn ls;\n\t\t});\n\t},\n\n\t/**\n\t * Returns a LiveNodeList of elements with the given qualifiedName.\n\t * Searching for all descendants can be done by passing `*` as `qualifiedName`.\n\t *\n\t * All descendants of the specified element are searched, but not the element itself.\n\t * The returned list is live, which means it updates itself with the DOM tree automatically.\n\t * Therefore, there is no need to call `Element.getElementsByTagName()`\n\t * with the same element and arguments repeatedly if the DOM changes in between calls.\n\t *\n\t * When called on an HTML element in an HTML document,\n\t * `getElementsByTagName` lower-cases the argument before searching for it.\n\t * This is undesirable when trying to match camel-cased SVG elements (such as\n\t * `<linearGradient>`) in an HTML document.\n\t * Instead, use `Element.getElementsByTagNameNS()`,\n\t * which preserves the capitalization of the tag name.\n\t *\n\t * `Element.getElementsByTagName` is similar to `Document.getElementsByTagName()`,\n\t * except that it only searches for elements that are descendants of the specified element.\n\t *\n\t * @param {string} qualifiedName\n\t * @returns {LiveNodeList}\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByTagName\n\t * @see https://dom.spec.whatwg.org/#concept-getelementsbytagname\n\t */\n\tgetElementsByTagName: function (qualifiedName) {\n\t\tvar isHTMLDocument = (this.nodeType === DOCUMENT_NODE ? this : this.ownerDocument).type === 'html';\n\t\tvar lowerQualifiedName = qualifiedName.toLowerCase();\n\t\treturn new LiveNodeList(this, function (base) {\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base, function (node) {\n\t\t\t\tif (node === base || node.nodeType !== ELEMENT_NODE) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (qualifiedName === '*') {\n\t\t\t\t\tls.push(node);\n\t\t\t\t} else {\n\t\t\t\t\tvar nodeQualifiedName = node.getQualifiedName();\n\t\t\t\t\tvar matchingQName = isHTMLDocument && node.namespaceURI === NAMESPACE.HTML ? lowerQualifiedName : qualifiedName;\n\t\t\t\t\tif (nodeQualifiedName === matchingQName) {\n\t\t\t\t\t\tls.push(node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n\tgetElementsByTagNameNS: function (namespaceURI, localName) {\n\t\treturn new LiveNodeList(this, function (base) {\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base, function (node) {\n\t\t\t\tif (\n\t\t\t\t\tnode !== base &&\n\t\t\t\t\tnode.nodeType === ELEMENT_NODE &&\n\t\t\t\t\t(namespaceURI === '*' || node.namespaceURI === namespaceURI) &&\n\t\t\t\t\t(localName === '*' || node.localName == localName)\n\t\t\t\t) {\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n};\nDocument.prototype.getElementsByClassName = Element.prototype.getElementsByClassName;\nDocument.prototype.getElementsByTagName = Element.prototype.getElementsByTagName;\nDocument.prototype.getElementsByTagNameNS = Element.prototype.getElementsByTagNameNS;\n\n_extends(Element, Node);\nfunction Attr(symbol) {\n\tcheckSymbol(symbol);\n\n\tthis.namespaceURI = null;\n\tthis.prefix = null;\n\tthis.ownerElement = null;\n}\nAttr.prototype.nodeType = ATTRIBUTE_NODE;\n_extends(Attr, Node);\n\nfunction CharacterData(symbol) {\n\tcheckSymbol(symbol);\n}\nCharacterData.prototype = {\n\tdata: '',\n\tsubstringData: function (offset, count) {\n\t\treturn this.data.substring(offset, offset + count);\n\t},\n\tappendData: function (text) {\n\t\ttext = this.data + text;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t},\n\tinsertData: function (offset, text) {\n\t\tthis.replaceData(offset, 0, text);\n\t},\n\tdeleteData: function (offset, count) {\n\t\tthis.replaceData(offset, count, '');\n\t},\n\treplaceData: function (offset, count, text) {\n\t\tvar start = this.data.substring(0, offset);\n\t\tvar end = this.data.substring(offset + count);\n\t\ttext = start + text + end;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t},\n};\n_extends(CharacterData, Node);\nfunction Text(symbol) {\n\tcheckSymbol(symbol);\n}\nText.prototype = {\n\tnodeName: '#text',\n\tnodeType: TEXT_NODE,\n\tsplitText: function (offset) {\n\t\tvar text = this.data;\n\t\tvar newText = text.substring(offset);\n\t\ttext = text.substring(0, offset);\n\t\tthis.data = this.nodeValue = text;\n\t\tthis.length = text.length;\n\t\tvar newNode = this.ownerDocument.createTextNode(newText);\n\t\tif (this.parentNode) {\n\t\t\tthis.parentNode.insertBefore(newNode, this.nextSibling);\n\t\t}\n\t\treturn newNode;\n\t},\n};\n_extends(Text, CharacterData);\nfunction Comment(symbol) {\n\tcheckSymbol(symbol);\n}\nComment.prototype = {\n\tnodeName: '#comment',\n\tnodeType: COMMENT_NODE,\n};\n_extends(Comment, CharacterData);\n\nfunction CDATASection(symbol) {\n\tcheckSymbol(symbol);\n}\nCDATASection.prototype = {\n\tnodeName: '#cdata-section',\n\tnodeType: CDATA_SECTION_NODE,\n};\n_extends(CDATASection, Text);\n\nfunction DocumentType(symbol) {\n\tcheckSymbol(symbol);\n}\nDocumentType.prototype.nodeType = DOCUMENT_TYPE_NODE;\n_extends(DocumentType, Node);\n\nfunction Notation(symbol) {\n\tcheckSymbol(symbol);\n}\nNotation.prototype.nodeType = NOTATION_NODE;\n_extends(Notation, Node);\n\nfunction Entity(symbol) {\n\tcheckSymbol(symbol);\n}\nEntity.prototype.nodeType = ENTITY_NODE;\n_extends(Entity, Node);\n\nfunction EntityReference(symbol) {\n\tcheckSymbol(symbol);\n}\nEntityReference.prototype.nodeType = ENTITY_REFERENCE_NODE;\n_extends(EntityReference, Node);\n\nfunction DocumentFragment(symbol) {\n\tcheckSymbol(symbol);\n}\nDocumentFragment.prototype.nodeName = '#document-fragment';\nDocumentFragment.prototype.nodeType = DOCUMENT_FRAGMENT_NODE;\n_extends(DocumentFragment, Node);\n\nfunction ProcessingInstruction(symbol) {\n\tcheckSymbol(symbol);\n}\nProcessingInstruction.prototype.nodeType = PROCESSING_INSTRUCTION_NODE;\n_extends(ProcessingInstruction, CharacterData);\nfunction XMLSerializer() {}\nXMLSerializer.prototype.serializeToString = function (node, nodeFilter) {\n\treturn nodeSerializeToString.call(node, nodeFilter);\n};\nNode.prototype.toString = nodeSerializeToString;\nfunction nodeSerializeToString(nodeFilter) {\n\tvar buf = [];\n\tvar refNode = (this.nodeType === DOCUMENT_NODE && this.documentElement) || this;\n\tvar prefix = refNode.prefix;\n\tvar uri = refNode.namespaceURI;\n\n\tif (uri && prefix == null) {\n\t\tvar prefix = refNode.lookupPrefix(uri);\n\t\tif (prefix == null) {\n\t\t\tvar visibleNamespaces = [\n\t\t\t\t{ namespace: uri, prefix: null },\n\t\t\t\t//{namespace:uri,prefix:''}\n\t\t\t];\n\t\t}\n\t}\n\tserializeToString(this, buf, nodeFilter, visibleNamespaces);\n\treturn buf.join('');\n}\n\nfunction needNamespaceDefine(node, isHTML, visibleNamespaces) {\n\tvar prefix = node.prefix || '';\n\tvar uri = node.namespaceURI;\n\t// According to [Namespaces in XML 1.0](https://www.w3.org/TR/REC-xml-names/#ns-using) ,\n\t// and more specifically https://www.w3.org/TR/REC-xml-names/#nsc-NoPrefixUndecl :\n\t// > In a namespace declaration for a prefix [...], the attribute value MUST NOT be empty.\n\t// in a similar manner [Namespaces in XML 1.1](https://www.w3.org/TR/xml-names11/#ns-using)\n\t// and more specifically https://www.w3.org/TR/xml-names11/#nsc-NSDeclared :\n\t// > [...] Furthermore, the attribute value [...] must not be an empty string.\n\t// so serializing empty namespace value like xmlns:ds=\"\" would produce an invalid XML document.\n\tif (!uri) {\n\t\treturn false;\n\t}\n\tif ((prefix === 'xml' && uri === NAMESPACE.XML) || uri === NAMESPACE.XMLNS) {\n\t\treturn false;\n\t}\n\n\tvar i = visibleNamespaces.length;\n\twhile (i--) {\n\t\tvar ns = visibleNamespaces[i];\n\t\t// get namespace prefix\n\t\tif (ns.prefix === prefix) {\n\t\t\treturn ns.namespace !== uri;\n\t\t}\n\t}\n\treturn true;\n}\n/**\n * Literal whitespace other than space that appear in attribute values are serialized as\n * their entity references, so they will be preserved.\n * (In contrast to whitespace literals in the input which are normalized to spaces).\n *\n * Well-formed constraint: No < in Attribute Values:\n * > The replacement text of any entity referred to directly or indirectly\n * > in an attribute value must not contain a <.\n *\n * @see https://www.w3.org/TR/xml11/#CleanAttrVals\n * @see https://www.w3.org/TR/xml11/#NT-AttValue\n * @see https://www.w3.org/TR/xml11/#AVNormalize\n * @see https://w3c.github.io/DOM-Parsing/#serializing-an-element-s-attributes\n * @prettierignore\n */\nfunction addSerializedAttribute(buf, qualifiedName, value) {\n\tbuf.push(' ', qualifiedName, '=\"', value.replace(/[<>&\"\\t\\n\\r]/g, _xmlEncoder), '\"');\n}\n\nfunction serializeToString(node, buf, nodeFilter, visibleNamespaces) {\n\tif (!visibleNamespaces) {\n\t\tvisibleNamespaces = [];\n\t}\n\tvar doc = node.nodeType === DOCUMENT_NODE ? node : node.ownerDocument;\n\tvar isHTML = doc.type === 'html';\n\n\tif (nodeFilter) {\n\t\tnode = nodeFilter(node);\n\t\tif (node) {\n\t\t\tif (typeof node == 'string') {\n\t\t\t\tbuf.push(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t\t//buf.sort.apply(attrs, attributeSorter);\n\t}\n\n\tswitch (node.nodeType) {\n\t\tcase ELEMENT_NODE:\n\t\t\tvar attrs = node.attributes;\n\t\t\tvar len = attrs.length;\n\t\t\tvar child = node.firstChild;\n\t\t\tvar nodeName = node.tagName;\n\n\t\t\tvar prefixedNodeName = nodeName;\n\t\t\tif (!isHTML && !node.prefix && node.namespaceURI) {\n\t\t\t\tvar defaultNS;\n\t\t\t\t// lookup current default ns from `xmlns` attribute\n\t\t\t\tfor (var ai = 0; ai < attrs.length; ai++) {\n\t\t\t\t\tif (attrs.item(ai).name === 'xmlns') {\n\t\t\t\t\t\tdefaultNS = attrs.item(ai).value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!defaultNS) {\n\t\t\t\t\t// lookup current default ns in visibleNamespaces\n\t\t\t\t\tfor (var nsi = visibleNamespaces.length - 1; nsi >= 0; nsi--) {\n\t\t\t\t\t\tvar namespace = visibleNamespaces[nsi];\n\t\t\t\t\t\tif (namespace.prefix === '' && namespace.namespace === node.namespaceURI) {\n\t\t\t\t\t\t\tdefaultNS = namespace.namespace;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (defaultNS !== node.namespaceURI) {\n\t\t\t\t\tfor (var nsi = visibleNamespaces.length - 1; nsi >= 0; nsi--) {\n\t\t\t\t\t\tvar namespace = visibleNamespaces[nsi];\n\t\t\t\t\t\tif (namespace.namespace === node.namespaceURI) {\n\t\t\t\t\t\t\tif (namespace.prefix) {\n\t\t\t\t\t\t\t\tprefixedNodeName = namespace.prefix + ':' + nodeName;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbuf.push('<', prefixedNodeName);\n\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t// add namespaces for attributes\n\t\t\t\tvar attr = attrs.item(i);\n\t\t\t\tif (attr.prefix == 'xmlns') {\n\t\t\t\t\tvisibleNamespaces.push({\n\t\t\t\t\t\tprefix: attr.localName,\n\t\t\t\t\t\tnamespace: attr.value,\n\t\t\t\t\t});\n\t\t\t\t} else if (attr.nodeName == 'xmlns') {\n\t\t\t\t\tvisibleNamespaces.push({ prefix: '', namespace: attr.value });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\tvar attr = attrs.item(i);\n\t\t\t\tif (needNamespaceDefine(attr, isHTML, visibleNamespaces)) {\n\t\t\t\t\tvar prefix = attr.prefix || '';\n\t\t\t\t\tvar uri = attr.namespaceURI;\n\t\t\t\t\taddSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : 'xmlns', uri);\n\t\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace: uri });\n\t\t\t\t}\n\t\t\t\tserializeToString(attr, buf, nodeFilter, visibleNamespaces);\n\t\t\t}\n\n\t\t\t// add namespace for current node\n\t\t\tif (nodeName === prefixedNodeName && needNamespaceDefine(node, isHTML, visibleNamespaces)) {\n\t\t\t\tvar prefix = node.prefix || '';\n\t\t\t\tvar uri = node.namespaceURI;\n\t\t\t\taddSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : 'xmlns', uri);\n\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace: uri });\n\t\t\t}\n\t\t\t// in XML elements can be closed when they have no children\n\t\t\tvar canCloseTag = !child;\n\t\t\tif (canCloseTag && (isHTML || node.namespaceURI === NAMESPACE.HTML)) {\n\t\t\t\t// in HTML (doc or ns) only void elements can be closed right away\n\t\t\t\tcanCloseTag = isHTMLVoidElement(nodeName);\n\t\t\t}\n\t\t\tif (canCloseTag) {\n\t\t\t\tbuf.push('/>');\n\t\t\t} else {\n\t\t\t\tbuf.push('>');\n\t\t\t\t//if is cdata child node\n\t\t\t\tif (isHTML && isHTMLRawTextElement(nodeName)) {\n\t\t\t\t\twhile (child) {\n\t\t\t\t\t\tif (child.data) {\n\t\t\t\t\t\t\tbuf.push(child.data);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tserializeToString(child, buf, nodeFilter, visibleNamespaces.slice());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\twhile (child) {\n\t\t\t\t\t\tserializeToString(child, buf, nodeFilter, visibleNamespaces.slice());\n\t\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbuf.push('</', prefixedNodeName, '>');\n\t\t\t}\n\t\t\t// remove added visible namespaces\n\t\t\t//visibleNamespaces.length = startVisibleNamespaces;\n\t\t\treturn;\n\t\tcase DOCUMENT_NODE:\n\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\tvar child = node.firstChild;\n\t\t\twhile (child) {\n\t\t\t\tserializeToString(child, buf, nodeFilter, visibleNamespaces.slice());\n\t\t\t\tchild = child.nextSibling;\n\t\t\t}\n\t\t\treturn;\n\t\tcase ATTRIBUTE_NODE:\n\t\t\treturn addSerializedAttribute(buf, node.name, node.value);\n\t\tcase TEXT_NODE:\n\t\t\t/*\n\t\t\t * The ampersand character (&) and the left angle bracket (<) must not appear in their literal form,\n\t\t\t * except when used as markup delimiters, or within a comment, a processing instruction,\n\t\t\t * or a CDATA section.\n\t\t\t * If they are needed elsewhere, they must be escaped using either numeric character\n\t\t\t * references or the strings `&amp;` and `&lt;` respectively.\n\t\t\t * The right angle bracket (>) may be represented using the string \" &gt; \",\n\t\t\t * and must, for compatibility, be escaped using either `&gt;`,\n\t\t\t * or a character reference when it appears in the string `]]>` in content,\n\t\t\t * when that string is not marking the end of a CDATA section.\n\t\t\t *\n\t\t\t * In the content of elements, character data is any string of characters which does not\n\t\t\t * contain the start-delimiter of any markup and does not include the CDATA-section-close\n\t\t\t * delimiter, `]]>`.\n\t\t\t *\n\t\t\t * @see https://www.w3.org/TR/xml/#NT-CharData\n\t\t\t * @see https://w3c.github.io/DOM-Parsing/#xml-serializing-a-text-node\n\t\t\t */\n\t\t\treturn buf.push(node.data.replace(/[<&>]/g, _xmlEncoder));\n\t\tcase CDATA_SECTION_NODE:\n\t\t\treturn buf.push(g.CDATA_START, node.data, g.CDATA_END);\n\t\tcase COMMENT_NODE:\n\t\t\treturn buf.push(g.COMMENT_START, node.data, g.COMMENT_END);\n\t\tcase DOCUMENT_TYPE_NODE:\n\t\t\tvar pubid = node.publicId;\n\t\t\tvar sysid = node.systemId;\n\t\t\tbuf.push(g.DOCTYPE_DECL_START, ' ', node.name);\n\t\t\tif (pubid) {\n\t\t\t\tbuf.push(' ', g.PUBLIC, ' ', pubid);\n\t\t\t\tif (sysid && sysid !== '.') {\n\t\t\t\t\tbuf.push(' ', sysid);\n\t\t\t\t}\n\t\t\t} else if (sysid && sysid !== '.') {\n\t\t\t\tbuf.push(' ', g.SYSTEM, ' ', sysid);\n\t\t\t}\n\t\t\tif (node.internalSubset) {\n\t\t\t\tbuf.push(' [', node.internalSubset, ']');\n\t\t\t}\n\t\t\tbuf.push('>');\n\t\t\treturn;\n\t\tcase PROCESSING_INSTRUCTION_NODE:\n\t\t\treturn buf.push('<?', node.target, ' ', node.data, '?>');\n\t\tcase ENTITY_REFERENCE_NODE:\n\t\t\treturn buf.push('&', node.nodeName, ';');\n\t\t//case ENTITY_NODE:\n\t\t//case NOTATION_NODE:\n\t\tdefault:\n\t\t\tbuf.push('??', node.nodeName);\n\t}\n}\nfunction importNode(doc, node, deep) {\n\tvar node2;\n\tswitch (node.nodeType) {\n\t\tcase ELEMENT_NODE:\n\t\t\tnode2 = node.cloneNode(false);\n\t\t\tnode2.ownerDocument = doc;\n\t\t//var attrs = node2.attributes;\n\t\t//var len = attrs.length;\n\t\t//for(var i=0;i<len;i++){\n\t\t//node2.setAttributeNodeNS(importNode(doc,attrs.item(i),deep));\n\t\t//}\n\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\tbreak;\n\t\tcase ATTRIBUTE_NODE:\n\t\t\tdeep = true;\n\t\t\tbreak;\n\t\t//case ENTITY_REFERENCE_NODE:\n\t\t//case PROCESSING_INSTRUCTION_NODE:\n\t\t////case TEXT_NODE:\n\t\t//case CDATA_SECTION_NODE:\n\t\t//case COMMENT_NODE:\n\t\t//\tdeep = false;\n\t\t//\tbreak;\n\t\t//case DOCUMENT_NODE:\n\t\t//case DOCUMENT_TYPE_NODE:\n\t\t//cannot be imported.\n\t\t//case ENTITY_NODE:\n\t\t//case NOTATION_NODE：\n\t\t//can not hit in level3\n\t\t//default:throw e;\n\t}\n\tif (!node2) {\n\t\tnode2 = node.cloneNode(false); //false\n\t}\n\tnode2.ownerDocument = doc;\n\tnode2.parentNode = null;\n\tif (deep) {\n\t\tvar child = node.firstChild;\n\t\twhile (child) {\n\t\t\tnode2.appendChild(importNode(doc, child, deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n\n/**\n * Creates a copy of a node from an existing one.\n *\n * @param {Document} doc\n * The Document object representing the document that the new node will belong to.\n * @param {Node} node\n * The node to clone.\n * @param {boolean} deep\n * If true, the contents of the node are recursively copied.\n * If false, only the node itself (and its attributes, if it is an element) are copied.\n * @returns {Node}\n * Returns the newly created copy of the node.\n * @throws {DOMException}\n * May throw a DOMException if operations within setAttributeNode or appendChild (which are\n * potentially invoked in this function) do not meet their specific constraints.\n */\nfunction cloneNode(doc, node, deep) {\n\tvar node2 = new node.constructor(PDC);\n\tfor (var n in node) {\n\t\tif (hasOwn(node, n)) {\n\t\t\tvar v = node[n];\n\t\t\tif (typeof v != 'object') {\n\t\t\t\tif (v != node2[n]) {\n\t\t\t\t\tnode2[n] = v;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (node.childNodes) {\n\t\tnode2.childNodes = new NodeList();\n\t}\n\tnode2.ownerDocument = doc;\n\tswitch (node2.nodeType) {\n\t\tcase ELEMENT_NODE:\n\t\t\tvar attrs = node.attributes;\n\t\t\tvar attrs2 = (node2.attributes = new NamedNodeMap());\n\t\t\tvar len = attrs.length;\n\t\t\tattrs2._ownerElement = node2;\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\tnode2.setAttributeNode(cloneNode(doc, attrs.item(i), true));\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ATTRIBUTE_NODE:\n\t\t\tdeep = true;\n\t}\n\tif (deep) {\n\t\tvar child = node.firstChild;\n\t\twhile (child) {\n\t\t\tnode2.appendChild(cloneNode(doc, child, deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n\nfunction __set__(object, key, value) {\n\tobject[key] = value;\n}\n//do dynamic\ntry {\n\tif (Object.defineProperty) {\n\t\tObject.defineProperty(LiveNodeList.prototype, 'length', {\n\t\t\tget: function () {\n\t\t\t\t_updateLiveList(this);\n\t\t\t\treturn this.$$length;\n\t\t\t},\n\t\t});\n\n\t\tObject.defineProperty(Node.prototype, 'textContent', {\n\t\t\tget: function () {\n\t\t\t\treturn getTextContent(this);\n\t\t\t},\n\n\t\t\tset: function (data) {\n\t\t\t\tswitch (this.nodeType) {\n\t\t\t\t\tcase ELEMENT_NODE:\n\t\t\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\t\t\twhile (this.firstChild) {\n\t\t\t\t\t\t\tthis.removeChild(this.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data || String(data)) {\n\t\t\t\t\t\t\tthis.appendChild(this.ownerDocument.createTextNode(data));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.data = data;\n\t\t\t\t\t\tthis.value = data;\n\t\t\t\t\t\tthis.nodeValue = data;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tfunction getTextContent(node) {\n\t\t\tswitch (node.nodeType) {\n\t\t\t\tcase ELEMENT_NODE:\n\t\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\t\tvar buf = [];\n\t\t\t\t\tnode = node.firstChild;\n\t\t\t\t\twhile (node) {\n\t\t\t\t\t\tif (node.nodeType !== 7 && node.nodeType !== 8) {\n\t\t\t\t\t\t\tbuf.push(getTextContent(node));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.join('');\n\t\t\t\tdefault:\n\t\t\t\t\treturn node.nodeValue;\n\t\t\t}\n\t\t}\n\n\t\t__set__ = function (object, key, value) {\n\t\t\t//console.log(value)\n\t\t\tobject['$$' + key] = value;\n\t\t};\n\t}\n} catch (e) {\n\t//ie8\n}\n\nexports._updateLiveList = _updateLiveList;\nexports.Attr = Attr;\nexports.CDATASection = CDATASection;\nexports.CharacterData = CharacterData;\nexports.Comment = Comment;\nexports.Document = Document;\nexports.DocumentFragment = DocumentFragment;\nexports.DocumentType = DocumentType;\nexports.DOMImplementation = DOMImplementation;\nexports.Element = Element;\nexports.Entity = Entity;\nexports.EntityReference = EntityReference;\nexports.LiveNodeList = LiveNodeList;\nexports.NamedNodeMap = NamedNodeMap;\nexports.Node = Node;\nexports.NodeList = NodeList;\nexports.Notation = Notation;\nexports.Text = Text;\nexports.ProcessingInstruction = ProcessingInstruction;\nexports.XMLSerializer = XMLSerializer;\n","import Logger from \"../Utils/LoggerByDefault\";\n\n/**\n * @classdesc\n * Standard WPS\n *\n * @constructor\n * @alias Gp.Formats.WPS\n * @param {Object} options - options\n * @param {Object}   options.data - objet\n * @param {String}   options.method - POST|GET\n * @param {String}   options.param.service - \"WPS\"\n * @param {String}   options.param.version - \"1.0.0\"\n * @param {String}   options.param.identifier - \"gs:WPSElevation|gs:WPSLineElevation\"\n * @param {String}   options.param.rawdataoutput - \"result\"\n * @param {String}   options.param.request - \"Execute\"\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n * @private\n */\nfunction WPS (options) {\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur WPS()]\");\n\n    if (!(this instanceof WPS)) {\n        throw new TypeError(\"WPS constructor cannot be called as a function.\");\n    }\n\n    this.options = options || {};\n\n    /**\n     * Objet DATA\n     */\n    this.DataObject = this.options.data;\n\n    if (!this.DataObject) {\n        throw new TypeError(\"This data object is not defined !\");\n    }\n\n    /**\n     * param service.\n     * Par defaut, \"WPS\".\n     */\n    this.paramservice = this.options.param.service || \"WPS\";\n\n    /**\n     * param version.\n     * Par defaut, \"1.0.0\".\n     */\n    this.paramversion = this.options.param.version || \"1.0.0\";\n\n    /**\n     * param identifier\n     * Par defaut, \"gs:WPS\"\n     */\n    this.paramidentifier = this.options.param.identifier || \"gs:WPS\";\n\n    /**\n     * param rawdataoutput\n     * Par defaut, \"result\".\n     */\n    this.paramrawdataoutput = this.options.param.rawdataoutput || \"result\";\n\n    /**\n     * param request\n     * Par defaut, \"Execute\".\n     */\n    this.paramrequest = this.options.param.request || \"Execute\";\n\n    /**\n     * methode.\n     * Par defaut, \"GET\".\n     */\n    this.method = this.options.method || \"GET\";\n}\n\nWPS.prototype = {\n\n    /**\n     * @lends module:WPS#\n     */\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : WPS,\n\n    /**\n     * Template de la requête.\n     */\n    template : {\n        get : {\n            value : \"service=__SERVICE__\" +\n                \"&version=__VERSION__\" +\n                \"&rawdataoutput=__RAWDATAOUTPUT__\" +\n                \"&identifier=__IDENTIFIER__\" +\n                \"&request=__REQUEST__\" +\n                \"&datainputs=<!-- __DATAINPUTS__ -->\",\n\n            input : \"__KEY__=__DATA__\"\n\n        },\n        post : {\n\n            value : \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" +\n                \"<wps:__REQUEST__ version=\\\"__VERSION__\\\" service=\\\"__SERVICE__\\\" \" +\n                \"__NAMESPACE__ __SCHEMALOCATION__>\" +\n                \"<ows:Identifier>__IDENTIFIER__</ows:Identifier>\" +\n                \"<wps:DataInputs>\" +\n                \"<!-- __DATAINPUTS__ -->\" +\n                \"</wps:DataInputs>\" +\n                \"<wps:ResponseForm>\" +\n                \"<wps:RawDataOutput>\" +\n                \"<ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier>\" +\n                \"</wps:RawDataOutput>\" +\n                \"</wps:ResponseForm>\" +\n                \"</wps:__REQUEST__>\",\n\n            input : \"<wps:Input>\" +\n                \"<ows:Identifier>__KEY__</ows:Identifier>\" +\n                \"<wps:Data>\" +\n                \"<wps:LiteralData>__DATA__</wps:LiteralData>\" +\n                \"</wps:Data>\" +\n                \"</wps:Input>\"\n        }\n    },\n\n    /**\n     * Namespace par defaut de la requete POST.\n     *\n     * @returns {String} namespace\n     */\n    namespaceByDefault : function () {\n        var ns = [\n            \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"\",\n            \"xmlns=\\\"http://www.opengis.net/wps/1.0.0\\\"\",\n            \"xmlns:wfs=\\\"http://www.opengis.net/wfs\\\"\",\n            \"xmlns:wps=\\\"http://www.opengis.net/wps/1.0.0\\\"\",\n            \"xmlns:ows=\\\"http://www.opengis.net/ows/1.1\\\"\",\n            \"xmlns:gml=\\\"http://www.opengis.net/gml\\\"\",\n            \"xmlns:ogc=\\\"http://www.opengis.net/ogc\\\"\",\n            \"xmlns:wcs=\\\"http://www.opengis.net/wcs/1.1.1\\\"\",\n            \"xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"\"\n        ];\n\n        return ns.join(\" \");\n    },\n\n    /**\n     * Schemalocation par defaut.\n     *\n     * @returns {String} schemaLocation\n     */\n    schemaLocationByDefault : function () {\n        return \"xsi:schemaLocation=\\\"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd\\\"\";\n    },\n\n    /**\n     * Construction de la requête.\n     *\n     * @example\n     * // GET  out :\n     * //  service=__SERVICE__\n     * //  &version=__VERSION__\n     * //  &rawdataoutput=__RAWDATAOUTPUT__\n     * //  &identifier=__IDENTIFIER__\n     * //  &request=__REQUEST__\n     * //  &datainputs=\"__DATAINPUTS__\"\n     * //  avec __DATAINPUTS__ = __KEY__=__DATA__;...\n     *\n     * // POST out :\n     * //      <?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\n     * //      <wps:__REQUEST__ version=\\\"__VERSION__\\\" service=\\\"__SERVICE__\\\"\n     * //         __NAMESPACE__ __SCHEMALOCATION__>\n     * //          <ows:Identifier>__IDENTIFIER__</ows:Identifier>\n     * //          <wps:DataInputs>\n     * //              <!-- __DATAINPUTS__ -->\n     * //          </wps:DataInputs>\n     * //          <wps:ResponseForm>\n     * //              <wps:RawDataOutput>\n     * //              <ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier>\n     * //              </wps:RawDataOutput>\n     * //          </wps:ResponseForm>\n     * //      </wps:__REQUEST__>\",\n     * //      avec __DATAINPUTS__\n     * //             <wps:Input>\n     * //                  <ows:Identifier>__KEY__</ows:Identifier>\n     * //                  <wps:Data>\n     * //                    <wps:LiteralData>__DATA__</wps:LiteralData>\n     * //                  </wps:Data>\n     * //              </wps:Input>\n     *\n     * @returns {Boolean} validation de la construction de la requete\n     */\n    processRequestString : function () {\n        this.logger.trace(\"WPS::processRequestString ()\");\n\n        var template = \"\";\n        if (this.method === \"POST\") {\n            template = this.template.post.value;\n        } else if (this.method === \"GET\") {\n            template = this.template.get.value;\n        } else {\n            this.logger.error(\"No other method supported by the service !\");\n            return false;\n        }\n\n        template = template.replace(/__SERVICE__/g, this.paramservice);\n        template = template.replace(/__VERSION__/g, this.paramversion);\n        template = template.replace(/__RAWDATAOUTPUT__/g, this.paramrawdataoutput);\n        template = template.replace(/__IDENTIFIER__/g, this.paramidentifier);\n        template = template.replace(/__REQUEST__/g, this.paramrequest);\n\n        // ajout +\n        if (this.method === \"POST\") {\n            template = template.replace(/__NAMESPACE__/g, this.namespaceByDefault);\n            template = template.replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault);\n        }\n\n        // ajout des datainputs\n        template = template.replace(/<!-- __DATAINPUTS__ -->/g, this.__addDataInputs());\n\n        if (!template) {\n            this.logger.warn(\"traduction tmpl : empty request !?\");\n            return false;\n        }\n\n        this.requestString = template;\n        this.logger.trace(\"traduction tmpl\", template);\n\n        return true;\n    },\n\n    /**\n     * Ajout des données\n     *\n     * @returns {String} Données concaténées dans une chaine\n     */\n    __addDataInputs : function () {\n        this.logger.trace(\"WPS::__addDataInputs ()\");\n\n        // c'est un peu grossier...\n        var tmpl = this.method === \"GET\" ? this.template.get.input : this.template.post.input;\n        var sep = this.method === \"GET\" ? \";\" : \"\";\n\n        var result = \"\";\n        var that = this;\n        var map = this.DataObject.getData();\n        for (var i = 0; i < map.length; i++) {\n            // FIXME closure ?\n            (function (j) {\n                if (sep) {\n                    sep = (j === map.length - 1) ? \"\" : \";\";\n                }\n                result = result.concat(that.__addDataInput(tmpl, map[j].k, map[j].v), sep);\n            })(i);\n        }\n\n        return result;\n    },\n\n    /**\n     * Ajout d'une donnée.\n     *\n     * @param {String} tmpl - template\n     * @param {String} key - clef\n     * @param {String} data - valeur\n     * @returns {String} chaine avec les substitutions clef/valeur\n     */\n    __addDataInput : function (tmpl, key, data) {\n        var tmp = tmpl;\n        tmp = tmp.replace(/__KEY__/g, key);\n        tmp = tmp.replace(/__DATA__/g, data);\n        return tmp;\n    },\n\n    /**\n     * Definir le mode de requête\n     *\n     * @param {String} method - GET|POST\n     */\n    setMethod : function (method) {\n        if (method === \"GET\" || method === \"POST\") {\n            this.method = method;\n        } else {\n            this.logger.warn(\"support only GET and POST method !\");\n        }\n    },\n\n    /**\n     * Retourne le mode de requete (GET|POST).\n     *\n     * @returns {AltiRequest.options.mode|String} methode (GET|POST)\n     */\n    getMethod : function () {\n        return this.method;\n    }\n};\n\nexport default WPS;\n","/**\n * Factory pour générer une reponse JSON à partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module AutoCompleteResponseFactory\n * @private\n * @alias Gp.Services.AutoComplete.Response.AutoCompleteResponseFactory\n */\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport MRes from \"../../../Utils/MessagesResources\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport AutoCompleteResponse from \"./model/AutoCompleteResponse\";\nimport SuggestedLocation from \"./model/SuggestedLocation\";\n\nvar AutoCompleteResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"AutoCompleteResponseFactory\");\n        logger.trace([\"AutoCompleteResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                var JSONResponse = null;\n                if (typeof options.response === \"string\") {\n                    JSONResponse = JSON.parse(options.response);\n                } else {\n                    JSONResponse = options.response;\n                }\n\n                // analyse de la réponse\n                if (JSONResponse) {\n                    // le service renvoie t il une erreur ?\n                    if (JSONResponse.error) {\n                        // ex. ?\n                        options.onError.call(options.scope, new ErrorService({\n                            message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.error.description),\n                            status : JSONResponse.error.code,\n                            type : ErrorService.TYPE_SRVERR\n                        }));\n                        return;\n                    }\n\n                    // création de l'objet réponse\n                    data = new AutoCompleteResponse();\n\n                    // boucle sur les résultats de l'autocomplétion\n                    if (JSONResponse.results && Array.isArray(JSONResponse.results)) {\n                        var suggestedLocation = null;\n\n                        for (var i = 0; i < JSONResponse.results.length; i++) {\n                            var result = JSONResponse.results[i];\n                            suggestedLocation = new SuggestedLocation();\n\n                            if (result) {\n                                if (result.country === \"StreetAddress\") {\n                                    suggestedLocation.street = result.street;\n                                    suggestedLocation.type = \"StreetAddress\";\n                                } else if (result.country === \"PositionOfInterest\") {\n                                    suggestedLocation.poi = result.street;\n                                    suggestedLocation.type = \"PositionOfInterest\";\n                                    suggestedLocation.poiType = result.poiType;\n                                }\n\n                                if (suggestedLocation.position) {\n                                    suggestedLocation.position.x = result.x;\n                                    suggestedLocation.position.y = result.y;\n                                }\n\n                                suggestedLocation.kind = result.kind;\n                                suggestedLocation.commune = result.city;\n                                suggestedLocation.fullText = result.fulltext;\n                                suggestedLocation.postalCode = result.zipcode;\n                                suggestedLocation.classification = result.classification;\n                            }\n                            // Ajout du résultat au tableau reverseGeocodedLocations de geocodedLocation\n                            data.suggestedLocations.push(suggestedLocation);\n                        }\n                    } else {\n                        options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_FORMAT_3\")));\n                        return;\n                    }\n\n                    if (!data.suggestedLocations.length) {\n                        options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_FORMAT_3\")));\n                        return;\n                    }\n                }\n\n                if (!data) {\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_ANALYSE_2\"),\n                        type : ErrorService.TYPE_UNKERR,\n                        status : -1\n                    }));\n                    return;\n                }\n\n                // Si la réponse contenait une exception renvoyée par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : ErrorService.TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n        } else {\n            // si la réponse (xmlString) est vide, on appelle le callback d'erreur\n            options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        // si tout s'est bien passé, on appelle le callback de succès\n        options.onSuccess.call(options.scope, data);\n    }\n};\n\nexport default AutoCompleteResponseFactory;\n","/* global require */\n\nimport Logger from \"../Utils/LoggerByDefault\";\n// import __xmldom from \"xmldom\";\n\n/**\n * @classdesc\n *\n * Classe permettant d'écrire ou de lire du XML, sous forme de document DOM,\n * éventuellement selon des clés de lecture (readers) ou d'écriture (writers) spécifiques.\n *\n * @constructor\n * @alias Gp.Formats.XML\n *\n * @param {Object} [options] - options du format XML\n *\n * @param {Object} [options.reader] - Instance d'un Reader de service (AltiResponseReader, GeocodeRequestReader, etc.)\n *      utile pour interpréter le XML lorsque sa structure est connue.\n *      Ce reader doit comporter au moins une fonction statique read (root) permettant d'initialiser la lecture.\n *\n * @param {Object} [options.writers] - writers\n *\n * @param {String} [options.xmlString] - chaîne de caractère contenant du XML à interpréter.\n *\n * @private\n */\nfunction XML (options) {\n    if (!(this instanceof XML)) {\n        throw new TypeError(\"XML constructor cannot be called as a function.\");\n    }\n\n    // FIXME : notion de singleton\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur XML ()]\");\n\n    /**\n     * Chaîne de caractères contenant le texte XML\n     * @type {String}\n     */\n    this.xmlString = null;\n\n    /**\n     * DOM Element correspondant à la structure du XML.\n     * @type {DOMElement}\n     */\n    this.xmlDoc = null;\n\n    /**\n     * Objet contenant des fonctions de lecture des différentes balises XML.\n     * @type {Object}\n     */\n    this.reader = null;\n\n    // traitement des paramètres d'options s'il y en a\n    if (options) {\n        if (options.xmlString && typeof options.xmlString === \"string\") {\n            this.xmlString = options.xmlString;\n            // Si une chaine de caractère a été passée en entrée : on la transforme aussi en XML document\n            this.xmlDoc = __getXMLDOC(options.xmlString);\n        }\n        if (options.reader) {\n            this.setReader(options.reader);\n        }\n    }\n}\n\nXML.prototype = {\n\n    /**\n     * @lends module:XML\n     */\n\n    /*\n     * Constructeur (alias)\n     */\n    constructor : XML,\n\n    /**\n     * Méthode permettant de récupérer la chaîne de caractères associée au format XML\n     *\n     * @returns {String} xmlString - la chaîne de caractères correspondant au format XML\n     */\n    getXMLString : function () {\n        return this.xmlString;\n    },\n\n    /**\n     * Méthode permettant d'attribuer une chaîne de caractères au format XML (attribut xmlString).\n     * La méthode va aussi transformer cette chaîne de caractères en document XML,\n     * afin de remplir l'attribut xmlDoc.\n     *\n     * @param {String} xmlString - la chaîne de caractères correspondant au format XML\n     */\n    setXMLString : function (xmlString) {\n        if (xmlString && typeof xmlString === \"string\") {\n            this.xmlString = xmlString;\n            this.xmlDoc = __getXMLDOC(xmlString);\n        }\n    },\n\n    /**\n     * Méthode permettant de récupérer les readers associés au format XML, s'ils ont été définis\n     *\n     * @return {Object} readers - les readers associés au format XML, s'ils existent,\n     *      sous forme d'une collection de fonctions\n     */\n    getReader : function () {\n        return this.reader;\n    },\n\n    /**\n     * Méthode permettant d'attribuer des readers, sous la forme d'un objet de fonctions (node, data),\n     *      lorsqu'ils n'ont pas été définis lors de l'instanciation par exemple (new XML (options)).\n     *\n     * @param {Object} reader - Instance d'un Reader de service (AltiResponseReader, GeocodeRequestReader, etc.)\n     *      utile pour interpréter le XML lorsque sa structure est connue.\n     *      Ce reader doit comporter au moins une fonction statique read (root) permettant d'initialiser la lecture.\n     */\n    setReader : function (reader) {\n        if (reader && reader.read && typeof reader.read === \"function\") {\n            this.reader = reader;\n        }\n    },\n\n    /**\n     * Méthode permettant de récupérer le document XML associé au format, s'il existe.\n     *\n     * @return {DOMElement} xmlDoc - le document XML (DOM document node) s'il existe\n     */\n    getXMLDoc : function () {\n        return this.xmlDoc;\n    },\n\n    /**\n     * Setter\n     */\n    setXMLDoc : function (doc) {\n        this.xmlDoc = doc;\n    },\n    /**\n     * Méthode initialisant la lecture du XML, à partir d'un XML Document :\n     *      création d'un objet JavaScript contenant les informations du XML,\n     *      sauf dans le cas où il n'existe pas de XML Document à interpréter (retourne un objet vide).\n     *\n     * @return {Object} [parserOutput] - un objet JavaScript contenant les informations du XML :\n     * - soit toutes les informations si aucun reader n'a été spécifié à la création du format\n     * - soit les informations spécifiées dans le reader.\n     */\n    parse : function () {\n        // build xml document from xmlString\n        if (!this.xmlDoc && this.xmlString) {\n            this.xmlDoc = __getXMLDOC(this.xmlString);\n        }\n        if (this.xmlDoc) {\n            var root = __getRootNode(this.xmlDoc);\n            if (root) {\n                var parserOutput;\n                // call reader if exists\n                if (this.reader && this.reader.read) {\n                    parserOutput = this.reader.read(root);\n                } else {\n                    parserOutput = {};\n                    parserOutput[root.nodeName] = __readDefault(root);\n                }\n                return parserOutput;\n            } else {\n                return {};\n            }\n        }\n    }\n\n};\n\n/**\n * Méthode de la classe (privée) permettant de créer un XML Document à partir d'une chaîne de caractères XML,\n *      en utilisant DOMParser () lorsque c'est possible.\n *      For more information, see: https://dvcs.w3.org/hg/innerhtml/raw-file/tip/index.html#the-domparser-interface\n *\n * @private\n * @memberof XML\n * @method __getXMLDOC\n * @param {String} xmlString - xml string to be converted into DOM element\n * @return {DOMElement} - the corresponding XML Document\n */\nfunction __getXMLDOC (xmlString) {\n    if (typeof window === \"undefined\") {\n        // env. nodejs\n        var DOMParser = require(\"@xmldom/xmldom\").DOMParser; // __xmldom.DOMParser;\n        return new DOMParser().parseFromString(xmlString, \"text/xml\");\n    } else {\n        // env. browser\n\n        var parser;\n        var xmlDoc;\n        var errorMsg = \"Erreur lors du parsing de la réponse du service : XML non conforme\";\n\n        if (window.ActiveXObject) {\n            // Internet Explorer < 9\n            xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n            xmlDoc.async = false;\n            xmlDoc.loadXML(xmlString);\n            var parseError = xmlDoc.parseError;\n            if (parseError.errorCode) {\n                if (parseError.line && parseError.linepos) {\n                    errorMsg += \"( ligne \" + parseError.line + \", colonne \" + parseError.linepos;\n                }\n                if (parseError.reason) {\n                    errorMsg += \":  \" + parseError.reason + \")\";\n                }\n                throw new Error(errorMsg);\n            }\n            return xmlDoc;\n        } else if (window.DOMParser) {\n            // les autres (Chrome, Mozilla, IE >= 9)\n            parser = new window.DOMParser();\n            try {\n                xmlDoc = parser.parseFromString(xmlString, \"text/xml\");\n            } catch (e) {\n                // Internet Explorer browser raises exception if xmlString is not valid XML\n                if (e.message === \"SyntaxError\") {\n                    throw new Error(errorMsg);\n                } else {\n                    throw new Error(\"Erreur lors du parsing de la réponse du service : \" + e.message);\n                }\n            }\n            // look for parsing error in case no exception was raised\n            if (xmlDoc.getElementsByTagName(\"parsererror\").length > 0) {\n                var parsererror = xmlDoc.getElementsByTagName(\"parsererror\");\n                for (var i = 0; i < parsererror.length; i++) {\n                    var content = parsererror[i].innerHTML;\n                    // except in case parsererror is just because of huge xml, but parsing is done.\n                    if (content.indexOf(\"Huge input lookup\") === -1) {\n                        errorMsg += \"(\" + content + \")\";\n                        throw new Error(errorMsg);\n                    }\n                }\n            } else if (!xmlDoc.documentElement) { // may happen in chrome browser\n                throw new Error(errorMsg);\n            }\n            return xmlDoc;\n        } else {\n            // FIXME\n            throw new Error(\"Incompatible DOM Parser pour ce navigateur !\");\n        }\n    }\n}\n\n/**\n * Méthode de la classe (privée) permettant de récupérer le noeud racine du document,\n *      à partir d'un document node (nodeType=9), puis lecture de ce noeud (readNode)\n *\n * @private\n * @memberof XML\n * @method __getRootNode\n * @param {DOMElement} [xmlDoc] - a Document Node\n * @return {DOMElement} root - the document root node\n */\nfunction __getRootNode (xmlDoc) {\n    var root;\n    if (xmlDoc.nodeType === 9) {\n        // INFO : nodeType 9 represents the entire document (the root-node of the DOM tree)\n        root = xmlDoc.documentElement;\n    } else if (xmlDoc.nodeType === 1) {\n        root = xmlDoc;\n    }\n    return root;\n}\n\n/**\n * Méthode de la classe (privée) permettant de lire automatiquement un noeud XML,\n *      lorsqu'aucun reader spécifique n'a été spécifié (parser brut)\n *\n * @private\n * @memberof XML\n * @method readDefault\n * @param {DOMElement} node - a DOM element node\n * @example final data object looks like :\n *          data = {\n *              attributeName: attributeValue,\n *              childName: {\n *                  attributeName: attributeValue,\n *                  attributeName: attributeValue,\n *                  childName: {\n *                      \"textContent\": textContent\n *                  },\n *                  childName: {\n *                      childName: {\n *                          attributeName:attributeValue\n *                      }\n *                  }\n *              }\n *          }\n */\nfunction __readDefault (node) {\n    var data = {};\n\n    // if element node has attributes, set their values to data\n    if (node.attributes.length > 0) {\n        var dataAttributes = __getAttributes(node);\n        data[\"attributes\"] = dataAttributes;\n    }\n\n    // if element node has childNodes, read them and set them to data\n    if (node.hasChildNodes()) {\n        var childData = {};\n        var child;\n        var children = node.childNodes;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 3) { // TEXT_NODE\n                data[\"textContent\"] = child.nodeValue;\n            } else if (child.nodeType === 1) {\n                childData = __readDefault(child);\n\n                if (!data[child.nodeName]) {\n                    // store childData in an object\n                    data[child.nodeName] = childData;\n                } else {\n                    // in case several childNodes has the same name : store them in an array.\n                    // if data[nodeName] already exists but is not an array\n                    if (!Array.isArray(data[child.nodeName])) {\n                        var old = data[child.nodeName];\n                        data[child.nodeName] = [];\n                        data[child.nodeName].push(old);\n                    }\n                    data[child.nodeName].push(childData);\n                }\n            }\n            // TODO : manage other node types (4=CDATA, etc)\n        }\n    }\n\n    return data;\n}\n\n/**\n * Méthode de la classe (privée) permettant de récupérer les attributs d'un noeud élément\n *\n * @private\n * @memberof XML\n * @method __getAttributes\n * @param {DOMElement} node - noeud contenant l'attribut recherché\n * @return {Object} nodeAttributes - objet contenant les noms et valeurs des différents attributs\n */\nfunction __getAttributes (node) {\n    if (node.attributes.length > 0) {\n        var nodeAttributes = {};\n        var attributes = node.attributes;\n        for (var i = 0; i < attributes.length; i++) {\n            var attribute = attributes[i];\n            nodeAttributes[attribute.nodeName] = attribute.nodeValue;\n        }\n        return nodeAttributes;\n    }\n}\n\nexport default XML;\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.geom;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.sphere;","var MeasureToolBoxDOM = {\n\n    _toolboxId : \"GPtoolbox-measure-main\",\n    _buttonId : \"GPtoolbox-measure-button\",\n    _widgetId : \"GPtoolbox-measure-widget\",\n\n    /**\n    * get toolBox ID\n    * @param {Number} uid - uid\n    * @returns {String} id selector unique\n    */\n    getToolBoxID : function (uid) {\n        return (uid) ? this._toolboxId + \"-\" + uid : this._toolboxId;\n    },\n\n    /**\n    * get button ID\n    * @param {Number} uid - uid\n    * @returns {String} id selector unique\n    */\n    getButtonID : function (uid) {\n        return (uid) ? this._buttonId + \"-\" + uid : this._buttonId;\n    },\n\n    /**\n    * get toolBox Container for widget\n    * @param {Number} uid - uid\n    * @returns {String} id selector unique\n    */\n    getWidgetID : function (uid) {\n        return (uid) ? this._widgetId + \"-\" + uid : this._widgetId;\n    },\n\n    /**\n     * Main container (DOM)\n     * @param {Number} uid - uid\n     * @returns {DOMElement} DOM element\n     */\n    _createToolBoxContainerElement : function (uid) {\n        // <div id=\"GPtoolbox-measure-main\">\n        //   <button id=\"GPtoolbox-measure-button\">&#9776;</button>\n        //   <div id=\"GPtoolbox-measure-widget\">\n        //     <!-- HERE : widgets tools measures -->\n        //   </div>\n        // </div>\n        var container = document.createElement(\"div\");\n        container.id = this.getToolBoxID(uid);\n        container.className = \"GPshowAdvancedToolPicto\";\n\n        var button = document.createElement(\"button\");\n        button.id = this.getButtonID(uid);\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowToolBoxPicto gpf-btn gpf-btn-icon-toolbox fr-btn\";\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        var self = this;\n        button.addEventListener(\"click\", function (e) {\n            var status = (e.target.ariaPressed === \"true\");\n            e.target.setAttribute(\"aria-pressed\", !status);\n            this.blur(); // permet de perdre le focus !\n            var widget = document.getElementById(self.getWidgetID(uid));\n            if (widget.style.display === \"block\") {\n                widget.style.display = \"none\";\n            } else {\n                widget.style.display = \"block\";\n            }\n        });\n        container.appendChild(button);\n\n        var widget = document.createElement(\"div\");\n        widget.id = this.getWidgetID(uid);\n        widget.addEventListener(\"click\", function () {\n\n            /*\n                e.preventDefault();\n\n                // FIXME desactiver tous les outils sur\n                // l'ouverture/fermeture de la toolbox ?\n\n                var current = e.target.parentNode.getAttribute(\"for\");\n                var widgets = this.querySelectorAll(\"div > input\");\n                for (var i = 0; i < widgets.length; i++) {\n                    var id = widgets[i].id;\n\n                    if (document.getElementById(id) &&\n                        document.getElementById(id).checked &&\n                        document.querySelector(\"#\" + id + \" + label\")) {\n                            document.querySelector(\"#\" + id + \" + label\").click();\n                            // document.getElementById(id).checked = true;\n                    }\n\n                    if (current === id && widgets[i].checked) {\n                        widgets[i].checked = false;\n                    } else if (current === id && !widgets[i].checked) {\n                        widgets[i].checked = true;\n                    }\n                }\n            */\n\n        }, false);\n\n        container.appendChild(widget);\n\n        return container;\n    }\n};\n\nexport default MeasureToolBoxDOM;\n","// import CSS\nimport \"../../CSS/Controls/ToolBoxMeasure/GPFtoolBoxMeasure.css\";\n// import \"../../CSS/Controls/ToolBoxMeasure/GPFtoolBoxMeasureStyle.css\";\n// import local\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\n// DOM\nimport MeasureToolBoxDOM from \"./MeasureToolBoxDOM\";\n\nvar logger = Logger.getLogger(\"toolbox\");\n\n/**\n * @type {ol.control.MeasureToolBox}\n * MeasureToolBox - Boite à outils (ToolBox) pour les outils de mesures.\n * - distance\n * - aire\n * - azimut\n */\nvar MeasureToolBox = {\n\n    /**\n     * liste des uid/map (pour chaque toolbox)\n     * { map : uid }\n     * Ex. { \"map1\" : 465456456486845 }\n     */\n    _toolbox : {},\n\n    /**\n     * Ajout d'un controle dans la ToolBox.\n     * Creation de la toolbox si besoin...\n     *\n     * @param {ol.Map} map - map\n     * @param {ol.control.Control} ctrl - objet à ajouter\n     */\n    add : function (map, ctrl) {\n        logger.trace(\"ToolBox.add()\", ctrl);\n\n        if (!map) {\n            logger.trace(\"map doesn't exist !?\");\n            return;\n        }\n\n        // contexte d'execution\n        var context = typeof window !== \"undefined\" ? window : typeof self !== \"undefined\" ? self : null;\n        if (context) {\n            // Pour info\n            // l'objet ToolBox devrait être partagé avec les outils de mesures...,\n            // mais, ce n'est pas le cas pour le mode modules cad un module par extension.\n            // c'est pourquoi, on l'enregistre dans le contexte, qui lui est partagé (ex. window)\n            this._toolbox = context.gpShareMeasureToolBox || {};\n        }\n\n        var mapContainer = map.getTargetElement();\n        var mapDocument = mapContainer.ownerDocument;\n        var mapId = mapContainer.id;\n\n        if (!this._toolbox || Object.keys(this._toolbox).length === 0) {\n            this._toolbox = {};\n            this._toolbox[mapId] = ID.generate();\n        } else {\n            if (!this._toolbox[mapId]) {\n                this._toolbox[mapId] = ID.generate();\n            }\n        }\n\n        var uid = this._toolbox[mapId];\n        if (!mapDocument.getElementById(this.getToolBoxID(uid))) {\n            logger.trace(\"create toolbox !\");\n            // creation et ajout de la toolbox sur la map\n            var toolboxContainer = this._createToolBoxContainerElement(uid);\n            toolboxContainer.style.pointerEvents = \"auto\"; // ajout pour ol6\n            var overlaysContainer = mapContainer.getElementsByClassName(\"ol-overlaycontainer-stopevent\");\n            overlaysContainer[0].appendChild(toolboxContainer);\n            // mapContainer.appendChild(toolboxContainer);\n        }\n\n        // ajout du widget dans la toolbox\n        var widgetContainer = mapDocument.getElementById(this.getWidgetID(uid));\n        ctrl.setTarget(widgetContainer);\n        if (context) {\n            // Pour info\n            // on partage (enregistre) l'objet ToolBox dans le contexte d'execution !\n            context.gpShareMeasureToolBox = this._toolbox;\n        }\n        logger.trace(\"add control to toolbox !\");\n    }\n};\n\nUtils.assign(MeasureToolBox, MeasureToolBoxDOM);\n\nexport default MeasureToolBox;\n","// import OpenLayers\nimport Overlay from \"ol/Overlay\";\nimport { Draw as DrawInteraction } from \"ol/interaction\";\nimport {\n    Fill,\n    Stroke,\n    Style,\n    Circle\n} from \"ol/style\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\n// import local\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Interactions from \"../Utils/Interactions\";\n// import local with ol dependencies\nimport LayerSwitcher from \"../LayerSwitcher/LayerSwitcher\";\n\n// Derived from OpenLayers measure example\n// http://openlayers.org/en/latest/examples/measure.html\n\nvar logger = Logger.getLogger(\"measures\");\n\n/**\n * @type {ol.control.Measures}\n * @abstract\n * Measures Tools :\n * - length\n * - aera\n * - azimut\n */\nvar Measures = {\n\n    // ****************************************************************** //\n    // > Default Styles\n    // ****************************************************************** //\n\n    /*\n     * Pointer\n     */\n    DEFAULT_POINTER_STYLE : new Circle({\n        radius : 5,\n        stroke : new Stroke({\n            color : \"#002A50\",\n            width : 2\n        }),\n        fill : new Fill({\n            color : \"rgba(255, 155, 0, 0.7)\"\n        })\n    }),\n\n    /*\n     * Measures style line\n     */\n    DEFAULT_DRAW_START_STYLE : new Style({\n        fill : new Fill({\n            color : \"rgba(0, 183, 152, 0.2)\"\n        }),\n        stroke : new Stroke({\n            color : \"#002A50\",\n            lineDash : [10, 10],\n            width : 2\n        })\n    }),\n\n    /*\n     * Measures final style line\n     */\n    DEFAULT_DRAW_FINISH_STYLE : new Style({\n        fill : new Fill({\n            color : \"rgba(0, 183, 152, 0.3)\"\n        }),\n        stroke : new Stroke({\n            color : \"#002A50\",\n            width : 3\n        })\n    }),\n\n    // ****************************************************************** //\n    // > ToolBox : these tools work together\n    // ****************************************************************** //\n    // sample :\n    // tools[name_control][0].(active|instance|map)\n    // tools : {\n    //      MeasureLength : [\n    //          { active : true, instance : [Object MeasureLength], map : \"map1\" },\n    //          { active : true, instance : [Object MeasureLength], map : \"map2\" }\n    //      ],\n    //      MeasureArea : [],\n    //      MeasureAzimuth : []\n    // }\n    tools : {\n        MeasureLength : [],\n        MeasureArea : [],\n        MeasureAzimuth : []\n    },\n\n    // ****************************************************************** //\n    // > Variables\n    // ****************************************************************** //\n\n    /**\n     * Global measure draw interaction\n     * @type {ol.interaction.Draw}\n     */\n    measureDraw : null,\n\n    /**\n     * Global vector source for measure\n     * @type {ol.source.Vector}\n     */\n    measureSource : null,\n\n    /**\n     * Global vector layer for measure\n     * @type {ol.layer.Vector}\n     */\n    measureVector : null,\n\n    /**\n     * Event on removing map layer\n     * @type {ol.CollectionEventType}\n     */\n    eventLayerRemove : null,\n\n    /**\n     * Currently drawn feature.\n     * @type {ol.Feature}\n     */\n    sketch : null,\n\n    /**\n     * The measure tooltip element.\n     * @type {Element}\n     */\n    measureTooltipElement : null,\n\n    /**\n     * Overlay to show the measurement.\n     * @type {ol.Overlay}\n     */\n    measureTooltip : null,\n\n    /**\n     * TODO The help tooltip element.\n     * @type {Element}\n     */\n    helpTooltipElement : null,\n\n    /**\n     * TODO Overlay to show the help.\n     * @type {ol.Overlay}\n     */\n    helpTooltip : null,\n\n    // ****************************************************************** //\n    // > Methods Public\n    // ****************************************************************** //\n\n    /** Desactived Tool Measure */\n    clean : function () {\n        var _class = this.CLASSNAME;\n\n        logger.trace(\"[\" + _class + \"] deactived tool !\");\n        // sur la desactivation de l'outil de mesure\n        // on fait un nettoyage des ressources\n        // ainsi que le DOM\n        this.clearMeasure();\n        this.clearMeasureToolTip();\n        this.removeMeasureEvents();\n        this._pictoContainer.setAttribute(\"aria-pressed\", false);\n    },\n\n    // ****************************************************************** //\n    // > Methods Events\n    // ****************************************************************** //\n\n    /**\n     * Handle pointer move.\n     *\n     * @param {ol.MapBrowserEvent} e - The event.\n     */\n    onPointerMoveHandler : function (e) {\n        if (e.dragging) {\n            return;\n        }\n\n        /** @type {ol.Coordinate|undefined} */\n        var tooltipCoord = e.coordinate;\n\n        if (this.sketch) {\n            var output;\n            var geom = (this.sketch.getGeometry());\n            output = this.format((geom));\n            if (geom.getType() === \"LineString\") {\n                tooltipCoord = geom.getLastCoordinate();\n            } else if (geom.getType() === \"Polygon\") {\n                tooltipCoord = geom.getInteriorPoint().getCoordinates();\n            } else {\n                return;\n            }\n            this.measureTooltipElement.innerHTML = output;\n            this.measureTooltip.setPosition(tooltipCoord);\n        }\n    },\n\n    /**\n     * Main program !\n     * This method is called by event 'click' on control picto\n     *\n     * @param {Object} e - HTMLElement\n     * @param {String} type - LineString or Polygon\n     * @private\n     */\n    onShowMeasureClick : function (e, type) {\n        if (e.target.ariaPressed === \"true\") {\n            this.onPanelOpen();\n        }\n        var map = this.getMap();\n        var currentMapId = map.getTargetElement().id;\n\n        // contexte d'execution\n        var context = typeof window !== \"undefined\" ? window : typeof self !== \"undefined\" ? self : null;\n        if (context) {\n            // Pour info\n            // les objets de mesures ont du code partagé\n            // (afin de gerer les interactions entre eux).\n            // Dans un mode \"modules\", on partage cet objet (this.tools) via le contexte\n            // d'execution (ex. avec window)\n            this.tools = context.gpShareMeasures || {};\n        }\n\n        // desactivation des controles de mesures sur la carte courrante\n        var mySelf = this.CLASSNAME; // this.constructor.name : pas possible en mode minifié/manglifié !\n        for (var className in this.tools) {\n            if (this.tools.hasOwnProperty(className)) {\n                var measures = this.tools[className];\n                for (var i = 0; i < measures.length; i++) {\n                    var o = measures[i];\n                    if (o && o.active && className !== mySelf && o.map.id === currentMapId) {\n                        o.active = false;\n                        if (o.instance !== null) { // au cas où le controle a été supprimé !\n                            o.instance.clean();\n                        }\n                    }\n                }\n            }\n        }\n\n        // desactivation des autres interactions parasites\n        Interactions.unset(map, {\n            current : \"Measures\"\n        });\n\n        var opened = this._pictoContainer.ariaPressed;\n        if (opened === \"true\") {\n            this.addMeasureEvents();\n            this.initMeasureInteraction();\n            this.addMeasureInteraction(type);\n            for (var j = 0; j < this.tools[mySelf].length; j++) {\n                if (this.tools[mySelf][j].map.id === currentMapId) {\n                    this.tools[mySelf][j].active = true;\n                }\n            }\n        } else {\n            this.clearMeasure();\n            this.clearMeasureToolTip();\n            this.removeMeasureEvents();\n            for (var k = 0; k < this.tools[mySelf].length; k++) {\n                if (this.tools[mySelf][k].map.id === currentMapId) {\n                    this.tools[mySelf][k].active = false;\n                }\n            }\n        }\n    },\n\n    // ****************************************************************** //\n    // > Methods not Public\n    // ****************************************************************** //\n\n    /**\n     * Clear all dom tooltip of length, area or azimut object.\n     */\n    clearMeasureToolTip : function () {\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        var mapContainer = map.getTargetElement();\n        // au cas où il y'aurait plusieurs container de carte !\n        var overlays = mapContainer.getElementsByClassName(\"ol-overlaycontainer\");\n        for (var k = 0; k < overlays.length; k++) {\n            var nodes = overlays[k];\n            var len = nodes.children.length;\n            var nodesToRemove = [];\n            for (var i = 0; i < len; i++) {\n                var node = nodes.children[i];\n                if (node.children.length !== 0) {\n                    var child = node.children[0];\n                    if (child.className === \"GPmeasureTooltip GPmeasureTooltip-static\" ||\n                        child.className === \"GPmeasureTooltip GPmeasureTooltip-measure\") {\n                        nodesToRemove.push(node);\n                    }\n                }\n            }\n            for (var j = 0; j < nodesToRemove.length; j++) {\n                nodes.removeChild(nodesToRemove[j]);\n            }\n        }\n    },\n\n    /**\n     * Clear all length, area or azimut object.\n     */\n    clearMeasure : function () {\n        var map = this.getMap();\n\n        // FIXME !?\n        // if (this.measureTooltip) {\n        //     map.removeOverlay(this.measureTooltip);\n        //     this.measureTooltip = null;\n        // }\n\n        if (this.measureVector) {\n            map.removeLayer(this.measureVector);\n            this.measureVector = null;\n        }\n\n        if (this.measureDraw) {\n            map.removeInteraction(this.measureDraw);\n            this.measureDraw = null;\n        }\n    },\n\n    /**\n     * Creates a new measure tooltip\n     * FIXME bug d'affichage de la tooltip de saisie en cours si on ne termine pas\n     * la saisie  !?\n     *\n     * @param {ol.Map} map - The Map.\n     */\n    createMeasureTooltip : function (map) {\n        if (this.measureTooltipElement) {\n            this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement);\n        }\n\n        this.measureTooltipElement = document.createElement(\"div\");\n        this.measureTooltipElement.className = \"GPmeasureTooltip GPmeasureTooltip-measure\";\n\n        this.measureTooltip = new Overlay({\n            element : this.measureTooltipElement,\n            stopEvent : false,\n            offset : [0, -15],\n            positioning : \"bottom-center\"\n        });\n\n        map.addOverlay(this.measureTooltip);\n    },\n\n    /**\n     * TODO evolution\n     * Creates a new help tooltip\n     *\n     * @param {ol.Map} map - The Map.\n     */\n    createHelpTooltip : function (map) {\n        if (this.helpTooltipElement) {\n            this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement);\n        }\n\n        this.helpTooltipElement = document.createElement(\"div\");\n        this.helpTooltipElement.className = \"tooltip hidden\";\n\n        this.helpTooltip = new Overlay({\n            element : this.helpTooltipElement,\n            stopEvent : false,\n            offset : [15, 0],\n            positioning : \"center-left\"\n        });\n\n        map.addOverlay(this.helpTooltip);\n    },\n\n    /**\n     * Creates a style for drawing\n     *\n     * @param {Object} styles - styles.\n     */\n    createStylingMeasureInteraction : function (styles) {\n        this.options.styles = styles || {};\n\n        // style de depart\n        logger.trace(\"style start\", this.options.styles.start);\n\n        // Creation à partir des styles par défaut\n        var startStyleOpts = {\n            image : Measures.DEFAULT_POINTER_STYLE,\n            fill : Measures.DEFAULT_DRAW_START_STYLE.getFill(),\n            stroke : Measures.DEFAULT_DRAW_START_STYLE.getStroke()\n        };\n        // ecrasement à partir des propriétés renseignées\n        if (this.options.styles.hasOwnProperty(\"pointer\") && this.options.styles.pointer instanceof Image) {\n            startStyleOpts.image = this.options.styles.pointer;\n        }\n        if (this.options.styles.hasOwnProperty(\"start\") && this.options.styles.start instanceof Style) {\n            if (this.options.styles.start.getFill() != null) {\n                startStyleOpts.fill = this.options.styles.start.getFill();\n            }\n            if (this.options.styles.start.getStroke() != null) {\n                startStyleOpts.stroke = this.options.styles.start.getStroke();\n            }\n        }\n\n        this.options.styles.start = new Style(startStyleOpts);\n\n        // style de fin\n        logger.trace(\"style finish\", this.options.styles.finish);\n\n        var finishStyleOpts = {\n            fill : Measures.DEFAULT_DRAW_FINISH_STYLE.getFill(),\n            stroke : Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()\n        };\n        // ecrasement à partir des propriétés renseignées\n        if (this.options.styles.hasOwnProperty(\"finish\") && this.options.styles.finish instanceof Style) {\n            if (this.options.styles.finish.getFill() != null) {\n                finishStyleOpts.fill = this.options.styles.finish.getFill();\n            }\n            if (this.options.styles.finish.getStroke() != null) {\n                finishStyleOpts.stroke = this.options.styles.finish.getStroke();\n            }\n        }\n\n        this.options.styles.finish = new Style(finishStyleOpts);\n    },\n\n    /**\n     * Add the measure interaction\n     *\n     * @param {String} type - LineString or Polygon.\n     */\n    addMeasureInteraction : function (type) {\n        var map = this.getMap();\n\n        // Creates and adds the interaction\n        var self = this;\n        this.measureDraw = new DrawInteraction({\n            source : this.measureSource,\n            // condition : permet de gerer la suppression des derniers points saisis\n            condition : function (event) {\n                if (event.originalEvent.ctrlKey) {\n                    if (self.sketch) {\n                        this.removeLastPoint();\n                    }\n                    return false;\n                }\n                return true;\n            },\n            type : type,\n            style : this.options.styles.start || Measures.DEFAULT_DRAW_START_STYLE\n        });\n        this.measureDraw.setProperties({\n            name : \"Measures\",\n            source : this\n        });\n        map.addInteraction(this.measureDraw);\n\n        // Create tooltips\n        this.createMeasureTooltip(map);\n\n        // Event start measuring\n        this.measureDraw.on(\"drawstart\", (evt) => {\n            // set sketch\n            self.sketch = evt.feature;\n        });\n\n        // Event end measuring\n        this.measureDraw.on(\"drawend\", () => {\n            // FIXME MaJ de la tooltip en mode mobile !\n            if (self.sketch) {\n                var output;\n                var tooltipCoord;\n                var geom = (self.sketch.getGeometry());\n                output = self.format((geom));\n                if (geom.getType() === \"LineString\") {\n                    tooltipCoord = geom.getLastCoordinate();\n                } else if (geom.getType() === \"Polygon\") {\n                    tooltipCoord = geom.getInteriorPoint().getCoordinates();\n                } else {\n                    return;\n                }\n                self.measureTooltipElement.innerHTML = output;\n                self.measureTooltip.setPosition(tooltipCoord);\n            }\n\n            self.measureTooltipElement.className = \"GPmeasureTooltip GPmeasureTooltip-static\";\n            self.measureTooltip.setOffset([0, -7]);\n\n            // unset sketch\n            self.sketch = null;\n            // unset tooltip so that a new one can be created\n            self.measureTooltipElement = null;\n            self.createMeasureTooltip(map);\n        });\n    },\n\n    /**\n     * Init the measure interaction\n     */\n    initMeasureInteraction : function () {\n        var map = this.getMap();\n\n        this.measureSource = new VectorSource();\n\n        this.measureVector = new VectorLayer({\n            source : this.measureSource,\n            style : this.options.styles.finish || Measures.DEFAULT_DRAW_FINISH_STYLE\n        });\n\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant.\n        this.measureVector.gpResultLayerId = \"measure\";\n\n        map.addLayer(this.measureVector);\n\n        // Si un layer switcher est présent dans la carte, on lui affecte des informations pour cette couche\n        map.getControls().forEach(\n            (control) => {\n                if (control.CLASSNAME === \"LayerSwitcher\") {\n                    // un layer switcher est présent dans la carte\n                    var layerId = this.measureVector.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas déjà (si le titre est le numéro par défaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this.measureVector, {\n                                title : this.options.layerDescription.title,\n                                description : this.options.layerDescription.description\n                            }\n                        );\n                    }\n                }\n            }\n        );\n    }\n};\n\nexport default Measures;\n","import checkDsfr from \"../Utils/CheckDsfr\";\n\nvar ElevationPathDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPelevationPath\");\n        container.className = \"GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Show control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowElevationPathPictoElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var button = document.createElement(\"button\");\n        // INFO: Ajout d'une SPAN pour enlever des marges de 6px dans CHROMIUM (?!)\n        var span = document.createElement(\"span\");\n        button.appendChild(span);\n        button.id = this._addUID(\"GPshowElevationPathPicto\");\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-elevation fr-btn fr-btn--tertiary\";\n        button.setAttribute(\"aria-label\", \"Calculer un profil altimétrique\");\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie de saisie\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowElevationPathClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowElevationPathClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    // ################################################################### //\n    // ######################### Methods to Panel ######################## //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createElevationPathPanelHeaderElement\n     * don't call this._createElevationPathPanelProfilElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelElement : function () {\n        var dialog = document.createElement(\"dialog\");\n        dialog.id = this._addUID(\"GPelevationPathPanel\");\n        dialog.className = \"GPpanel gpf-panel fr-modal\";\n\n        // dialog.appendChild(this._createElevationPathPanelHeaderElement());\n        // dialog.appendChild(this._createElevationPathPanelProfilElement());\n\n        return dialog;\n    },\n\n    _createElevationPathPanelDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"gpf-panel__body fr-modal__body\";\n        return div;\n    },\n\n    _createDrawingButtonsPluginDiv : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"container-buttons-plugin fr-mx-2w\";\n        return div;\n    },\n    \n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelHeaderElement : function () {\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n\n        if (!checkDsfr()) {\n            var divInfo = document.createElement(\"button\");\n            divInfo.id = this._addUID(\"GPelevationPathPanelInfo\");\n            divInfo.className = \"GPpanelInfo gpf-btn gpf-btn-icon-info fr-btn fr-btn--secondary gpf-btn--secondary fr-m-1w\";\n            divInfo.title = \"Informations\";\n            // add event on click\n            if (divInfo.addEventListener) {\n                divInfo.addEventListener(\n                    \"click\",\n                    function () {\n                        self.onOpenElevationPathInfoClick();\n                    }\n                );\n            } else if (divInfo.attachEvent) {\n                // internet explorer\n                divInfo.attachEvent(\n                    \"onclick\",\n                    function () {\n                        self.onOpenElevationPathInfoClick();\n                    }\n                );\n            }\n            container.appendChild(divInfo);\n        }\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        divTitle.innerHTML = \"Profil Altimétrique\";\n        container.appendChild(divTitle);\n\n        var buttonReduce = document.createElement(\"button\");\n        buttonReduce.id = this._addUID(\"GPelevationPathPanelReduce\");\n        buttonReduce.className = \"GPpanelReduce gpf-btn gpf-btn-icon-reduce fr-btn fr-btn--secondary gpf-btn--secondary\";\n        buttonReduce.title = \"Masquer le panneau\";\n\n        if (buttonReduce.addEventListener) {\n            buttonReduce.addEventListener(\"click\", function (e) {\n                if (typeof self.onReduceElevationPathPanelClick === \"function\") {\n                    self.onReduceElevationPathPanelClick();\n                }\n            }, false);\n        } else if (buttonReduce.attachEvent) {\n            buttonReduce.attachEvent(\"onclick\", function (e) {\n                if (typeof self.onReduceElevationPathPanelClick === \"function\") {\n                    self.onReduceElevationPathPanelClick();\n                }\n            });\n        }\n        container.appendChild(buttonReduce);\n\n        var buttonClose = document.createElement(\"button\");\n        buttonClose.id = this._addUID(\"GPelevationPathPanelClose\");\n        buttonClose.className = \"GPpanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        buttonClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (buttonClose.addEventListener) {\n            buttonClose.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPshowElevationPathPicto\")).click();\n            }, false);\n        } else if (buttonClose.attachEvent) {\n            buttonClose.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPshowElevationPathPicto\")).click();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        buttonClose.appendChild(span);\n        container.appendChild(buttonClose);\n\n        return container;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelProfilElement : function () {\n        var wrapper = document.createElement(\"div\");\n        wrapper.className = \"GPelevationPathProfilWrapper\";\n        var div = document.createElement(\"div\");\n        div.id = \"GPelevationPathProfil\";\n        wrapper.appendChild(div);\n\n        return wrapper;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathWaitingElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPelevationPathCalcWaitingContainer\");\n        div.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPwaitingContainerInfo gpf-waiting_info\";\n        p.innerHTML = \"Recherche en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Create information Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathInformationsElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPelevationPathInformationsContainer\");\n        if (!checkDsfr()) {\n            div.className = \"GPelementHidden gpf-hidden\";\n        }\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPelevationPathInformations\";\n        p.innerHTML = \"Aucune information...\";\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Add a information into Panel\n     *\n     * @param {String} name - name of item\n     * @param {String} value - value of item\n     * @returns {DOMElement} DOM element\n     */\n    _addElevationPathInformationsItem : function (name, value) {\n        var div = document.getElementById(this._addUID(\"GPelevationPathInformationsContainer\"));\n\n        if (div) {\n            var p = document.createElement(\"p\");\n            p.className = \"GPelevationPathInformations\";\n            var nameEl = document.createElement(\"span\");\n            nameEl.innerText = name;\n            var valueEl = document.createElement(\"span\");\n            valueEl.innerText = value;\n            p.appendChild(nameEl);\n            p.appendChild(valueEl);\n            div.appendChild(p);\n        }\n\n        return div;\n    }\n};\n\nexport default ElevationPathDOM;\n","import checkDsfr from \"../Utils/CheckDsfr\";\n\n/* globals AmCharts, d3 */\nvar ProfileElevationPathDOM = {\n\n    /**\n     * Gets a css property from an element\n     *\n     * @private\n     * @param {HTMLElement} element The element to get the property from\n     * @param {String} property The css property\n     * @returns {String} The value of the property\n     *\n     * @see https://stackoverflow.com/questions/7444451/how-to-get-the-actual-rendered-font-when-its-not-defined-in-css\n     */\n    _getCssProperty : function (element, property) {\n        return window.getComputedStyle(element, null).getPropertyValue(property);\n    },\n\n    /**\n     * Uses canvas.measureText to compute and return the width of the given text of given font in pixels.\n     *\n     * @private\n     * @param {String} text The text to be rendered.\n     * @param {HTMLElement} container The container of the text\n     * @param {String} font The font of the container if known, format: 'weight size familiy'\n     * @returns {Number} The width of the text\n     *\n     * @see https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/21015393#21015393\n     */\n    _getTextWidth : function (text, container, font = null) {\n        // re-use canvas object for better performance\n        var canvas = /** ts-syntax */(this.canvas) || ((this.canvas) = document.createElement(\"canvas\"));\n        var context = canvas.getContext(\"2d\");\n        if (font === null) {\n            context.font = `${this._getCssProperty(container, \"font-weight\")} ${this._getCssProperty(container, \"font-size\")} ${this._getCssProperty(container, \"font-family\")}`;\n        } else {\n            context.font = font;\n        }\n\n        var metrics = context.measureText(text);\n        return metrics.width;\n    },\n\n    /**\n     * Converts a data point z to svg y coord\n     *\n     * @private\n     * @param {Object} z The z to convert.\n     * @param {Number} pathHeight The height of the path in the svg container in px\n     * @param {Number} minGraphZ Min z of the graph\n     * @param {Number} pxPerMZ Number of pixels per meter for the z (y) axis\n     * @returns {Number} The y svg coordinate of the point\n     *\n     */\n    _dataZToSvgY : function (z, pathHeight, minGraphZ, pxPerMZ) {\n        return pathHeight - (z - minGraphZ) * pxPerMZ - 0.5;\n    },\n\n    /**\n     * Converts a data point dist value to svg x coord\n     *\n     * @private\n     * @param {Number} dist The dist to convert\n     * @param {Number} svgWidth The witdth of the svg container in px\n     * @param {Number} pathWidth The witdth of the path in the svg container in px\n     * @param {Number} pxPerMX Number of pixels per meter for the x axis\n     * @returns {Array} The x svg coordinate of the point\n     *\n     */\n    _dataDistToSvgX : function (dist, svgWidth, pathWidth, pxPerMX) {\n        return (svgWidth - pathWidth) + dist * pxPerMX;\n    },\n\n    /**\n     * Converts a svg x coord to dist value\n     *\n     * @private\n     * @param {Number} svgX The dist to convert\n     * @param {Number} svgWidth The witdth of the svg container in px\n     * @param {Number} pathWidth The witdth of the path in the svg container in px\n     * @param {Number} pxPerMX Number of pixels per meter for the x axis\n     * @returns {Array} The dist value\n     *\n     */\n    _svgXToDataDist : function (svgX, svgWidth, pathWidth, pxPerMX) {\n        return (svgX + pathWidth - svgWidth) / pxPerMX;\n    },\n\n    /**\n     * Returns the index of value if it were inserted in sorted (by dist) array of data points.\n     *\n     * @private\n     * @param {Array} array Sorted array of data points (with dist property)\n     * @param {Number} value Value to test the index of.\n     * @returns {Number} The index the value would have.\n     *\n     */\n    _arrayBisect : function (array, value) {\n        let idx;\n        if (array.length === 0) {\n            return 0;\n        }\n        for (idx = 0; idx < array.length; idx++) {\n            if (value < array[idx].dist) {\n                return idx;\n            }\n        }\n        return idx - 1;\n    },\n\n    /**\n     * Display Profile function used by default : no additonal framework needed.\n     *\n     * @public\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     * @returns {DOMElement} profil container\n     */\n    displayProfileByDefault : function (data, container, context, className) {\n        var self = context;\n\n        if (!container) {\n            return;\n        }\n\n        if (!data) {\n            return;\n        }\n\n        const style = {\n            fontFamily : \"Arial\",\n            strokeColor : \"#0B6BA7\",\n            fillColor : \"#00B798\",\n            focusLineColor : \"#F90\",\n        };\n\n        if (checkDsfr()) {\n            style.fontFamily = \"Marianne\";\n            style.strokeColor = \"#2F4077\";\n            style.fillColor = \"#2F4077\";\n            style.focusLineColor = \"#639f6a\";\n        };\n\n        // on nettoie toujours...\n        while (container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n\n        const margin = {\n            top : 25,\n            right : 15,\n            bottom : 10,\n            left : 10\n        };\n\n        var _displayProfileOptions = self.options.displayProfileOptions;\n        var _points = data.points;\n\n        var sortedElev = JSON.parse(JSON.stringify(_points));\n        sortedElev.sort(function (e1, e2) {\n            return e1.z - e2.z;\n        });\n\n        var minZ = sortedElev[0].z;\n        var maxZ = sortedElev[sortedElev.length - 1].z;\n        var dist = data.distance;\n        let distUnit = \"m\";\n\n        const widgetDiv = document.createElement(\"div\");\n        widgetDiv.id = \"profileElevationByDefault\";\n        container.appendChild(widgetDiv);\n\n        // Détermination des tailles en pixels des éléments du widget\n        var clientWidth = window.getComputedStyle(container).getPropertyValue(\"width\").replace(/px/, \"\");\n        var clientHeight = window.getComputedStyle(container).getPropertyValue(\"height\").replace(/px/, \"\");\n        const widgetHeigth = clientHeight - margin.top - margin.bottom;\n        const widgetWidth = clientWidth - margin.left - margin.right;\n        // const widgetHeigth = container.clientHeight - margin.top - margin.bottom;\n        // const widgetWidth = container.clientWidth - margin.left - margin.right;\n\n        const zLabelWidth = 17;\n        const zGradWidth = this._getTextWidth(Math.round(maxZ).toLocaleString() + \",88\", container, `400 10 ${style.fontFamily}`);\n        const xLabelHeight = 17;\n        const xGradHeight = 15;\n\n        const minZguideHeigth = 15;\n        const minXguideWidth = this._getTextWidth(Math.round(dist).toLocaleString() + \",5\", container);\n        const minNumXGuides = 1;\n\n        const pathHeight = widgetHeigth - xLabelHeight - xGradHeight;\n        const pathWidth = widgetWidth - zLabelWidth - zGradWidth;\n\n        const elevationSvg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        elevationSvg.id = \"profileElevationByDefaultSvg\";\n        elevationSvg.setAttribute(\"style\", \"display: block; margin: auto; overflow: visible;\");\n        elevationSvg.setAttribute(\"viewBox\", `0 0 ${clientWidth} ${clientHeight}`);\n        elevationSvg.setAttribute(\"width\", \"100%\");\n        elevationSvg.setAttribute(\"height\", \"100%\");\n\n        // Détermination des guides en ordonnée :\n        const maxNumZguides = Math.floor(pathHeight / minZguideHeigth);\n        let gradZ;\n        // Traitement du cas altitude max = altitude min\n        if (maxZ === minZ) {\n            gradZ = 0.1;\n        } else {\n            gradZ = Math.pow(10, (Math.ceil(Math.log((maxZ - minZ) / maxNumZguides) / Math.log(10)))) / 2;\n        }\n        let minGraphZ = Math.floor(minZ / gradZ) * gradZ;\n        let maxGraphZ = Math.ceil(maxZ / gradZ) * gradZ;\n        // cas où le path atteint pile les graduations extremes : ajout d'une gradiation\n        if (maxGraphZ === maxZ) {\n            maxGraphZ += gradZ;\n        }\n        // cas où gradZ < 1 : nombres flottants capricieux...\n        minGraphZ = Math.round(minGraphZ * 100) / 100;\n        maxGraphZ = Math.round(maxGraphZ * 100) / 100;\n\n        let numZguides = Math.round((maxGraphZ - minGraphZ) / gradZ);\n\n        // Si plus de guides que le max, on passe à une graduation de 10**x en 10**x (et non 10**x / 2)\n        if (numZguides + 1 > maxNumZguides) {\n            gradZ = Math.pow(10, (Math.ceil(Math.log((maxZ - minZ) / maxNumZguides) / Math.log(10))));\n            minGraphZ = Math.floor(minZ / gradZ) * gradZ;\n            maxGraphZ = Math.ceil(maxZ / gradZ) * gradZ;\n            // cas où le path atteint pile les graduations extremes : ajout d'une gradiation\n            if (maxGraphZ === maxZ) {\n                maxGraphZ += gradZ;\n            }\n            // cas où gradZ < 1 : nombres flottants capricieux...\n            minGraphZ = Math.round(minGraphZ * 100) / 100;\n            maxGraphZ = Math.round(maxGraphZ * 100) / 100;\n            numZguides = Math.floor((maxGraphZ - minGraphZ) / gradZ);\n        }\n\n        numZguides = Math.max(Math.round(numZguides), 1);\n\n        const axisZ = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        axisZ.setAttribute(\"class\", \"profile-z-vertical\");\n\n        const guidesZ = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n\n        const gradZyOffsetPx = pathHeight / numZguides;\n        let pxPerMZ;\n        // Traitement du cas altitude max = altitude min\n        if (maxZ === minZ) {\n            pxPerMZ = pathHeight / 0.2;\n        } else {\n            pxPerMZ = pathHeight / (maxGraphZ - minGraphZ);\n        }\n\n        let gradZtext;\n        let yTextTranslation;\n        let yStrokeTranslation;\n        let gradZstroke;\n        let gradZpath;\n        let gradZgrad;\n        // Ajout des graduations au graphique\n        for (let i = 0; i <= numZguides; i++) {\n            gradZtext = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n            gradZtext.setAttribute(\"class\", \"profile-z-graduation\");\n            gradZtext.setAttribute(\"font-family\", style.fontFamily);\n            gradZtext.setAttribute(\"font-size\", \"10px\");\n            gradZtext.setAttribute(\"fill\", \"#5E5E5E\");\n            // Cas où gradZ < 1 : nombres flottants capricieux...\n            // Le Math.round est pour éviter des ennuis du genre 3 * 0.1 = 0.300000000000004\n            gradZtext.textContent = (Math.round(100 * (minGraphZ + i * gradZ)) / 100).toLocaleString();\n\n            yTextTranslation = pathHeight - i * gradZyOffsetPx;\n\n            gradZtext.setAttribute(\"transform\", `translate(${zLabelWidth + zGradWidth - 8}, ${yTextTranslation + 5})`);\n            gradZtext.setAttribute(\"text-anchor\", \"end\");\n            axisZ.appendChild(gradZtext);\n\n            yStrokeTranslation = Math.round(yTextTranslation) - 0.5;\n\n            gradZstroke = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n            gradZpath = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n            gradZpath.setAttribute(\"cs\", \"100,100\");\n            gradZpath.setAttribute(\"stroke-width\", \"1\");\n            if (i !== 0) {\n                gradZpath.setAttribute(\"stroke-opacity\", \"0.2\");\n            } else {\n                gradZpath.setAttribute(\"stroke-opacity\", \"1\");\n            }\n            gradZpath.setAttribute(\"stroke\", \"#000000\");\n            gradZpath.setAttribute(\"fill\", \"none\");\n            gradZpath.setAttribute(\"d\", `M${zLabelWidth + zGradWidth},${yStrokeTranslation} L${pathWidth + zLabelWidth + zGradWidth},${yStrokeTranslation}`);\n\n            gradZgrad = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n            gradZgrad.setAttribute(\"cs\", \"100,100\");\n            gradZgrad.setAttribute(\"stroke-width\", \"1\");\n            gradZgrad.setAttribute(\"stroke-opacity\", \"1\");\n            gradZgrad.setAttribute(\"stroke\", \"#000000\");\n            gradZgrad.setAttribute(\"fill\", \"none\");\n            gradZgrad.setAttribute(\"d\", `M${zLabelWidth + zGradWidth},${yStrokeTranslation} L${zLabelWidth + zGradWidth + 5},${yStrokeTranslation}`);\n            gradZgrad.setAttribute(\"transform\", \"translate(-5, 0)\");\n\n            gradZstroke.appendChild(gradZgrad);\n            gradZstroke.appendChild(gradZpath);\n            guidesZ.appendChild(gradZstroke);\n        }\n\n        var axisZLegend = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n        axisZLegend.setAttribute(\"class\", \"profile-z-legend\");\n        axisZLegend.setAttribute(\"font-family\", style.fontFamily);\n        axisZLegend.setAttribute(\"font-size\", \"11px\");\n        axisZLegend.setAttribute(\"fill\", \"#5E5E5E\");\n        axisZLegend.textContent = \"Altitude (m)\";\n\n        axisZLegend.setAttribute(\"transform\", `translate(${zLabelWidth - 8}, ${Math.round(pathHeight / 2)}) rotate(-90)`);\n        axisZLegend.setAttribute(\"text-anchor\", \"middle\");\n\n        axisZ.appendChild(axisZLegend);\n        elevationSvg.appendChild(axisZ);\n        elevationSvg.appendChild(guidesZ);\n\n        // Détermination des guides en abscisse :\n        // Passage éventuel en km\n        if (dist > 2000) {\n            dist /= 1000;\n            distUnit = \"km\";\n        }\n\n        const maxNumXguides = Math.floor(pathWidth / minXguideWidth);\n        let gradX = Math.pow(10, (Math.ceil(Math.log((dist) / maxNumXguides) / Math.log(10)))) / 2;\n        const maxGraphX = dist;\n\n        // Si plus de guides que le max, on passe à une graduation de 10**x en 10**x (et non 10**x / 2)\n        let numXguides = Math.floor(maxGraphX / gradX);\n        if (numXguides > maxNumXguides) {\n            gradX = Math.pow(10, (Math.ceil(Math.log((dist) / maxNumXguides) / Math.log(10))));\n            numXguides = Math.floor(maxGraphX / gradX);\n        } else if (numXguides < minNumXGuides) {\n            gradX = Math.pow(10, (Math.ceil(Math.log((dist) / maxNumXguides) / Math.log(10))) - 1);\n            numXguides = Math.floor(maxGraphX / gradX);\n        }\n\n        numXguides = Math.max(numXguides, 1);\n        const lastGradX = gradX * numXguides;\n\n        const axisX = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        axisX.setAttribute(\"class\", \"profile-x-vertical\");\n\n        const guidesX = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n\n        // Décalage des graduations pour que la dernière corresponde à la distance max\n        const pxPerMX = pathWidth / maxGraphX;\n        const xOffset = (maxGraphX - lastGradX) * pxPerMX;\n        const gradXxOffsetPx = Math.round((pathWidth - xOffset) / numXguides);\n\n        let gradXtext;\n        let xTextTranslation;\n        let xStrokeTranslation;\n        let gradXstroke;\n        let gradXpath;\n        let gradXgrad;\n        // Ajout des graduations au graphique\n        for (let i = 0; i <= numXguides + 1; i++) {\n            gradXtext = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n            gradXtext.setAttribute(\"class\", \"profile-x-graduation\");\n            gradXtext.setAttribute(\"font-family\", style.fontFamily);\n            gradXtext.setAttribute(\"font-size\", \"10px\");\n            gradXtext.setAttribute(\"fill\", \"#5E5E5E\");\n\n            // Exclusion du cas de la dernière graduation : correspond à la distance max : pas de texte\n            if (i !== numXguides + 1) {\n                // Cas où gradX < 1 : nombres flottants capricieux...\n                gradXtext.textContent = (Math.round(100 * i * gradX) / 100).toLocaleString();\n            }\n\n            xTextTranslation = zLabelWidth + zGradWidth + i * gradXxOffsetPx;\n            // Cas de la dernière graduation : correspond à la distance max\n            if (i === numXguides + 1) {\n                xTextTranslation = zLabelWidth + zGradWidth + pathWidth;\n            }\n\n            gradXtext.setAttribute(\"transform\", `translate(${xTextTranslation}, ${pathHeight + xGradHeight + 5})`);\n            gradXtext.setAttribute(\"text-anchor\", \"middle\");\n            axisX.appendChild(gradXtext);\n\n            xStrokeTranslation = xTextTranslation - 0.5;\n\n            gradXstroke = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n            gradXpath = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n            gradXpath.setAttribute(\"cs\", \"100,100\");\n            gradXpath.setAttribute(\"stroke-width\", \"1\");\n            if (i !== 0) {\n                gradXpath.setAttribute(\"stroke-opacity\", \"0.2\");\n            } else {\n                gradXpath.setAttribute(\"stroke-opacity\", \"1\");\n            }\n            gradXpath.setAttribute(\"stroke\", \"#000000\");\n            gradXpath.setAttribute(\"fill\", \"none\");\n            gradXpath.setAttribute(\"d\", `M${xStrokeTranslation},${pathHeight} L${xStrokeTranslation},0`);\n\n            gradXgrad = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n            gradXgrad.setAttribute(\"cs\", \"100,100\");\n            gradXgrad.setAttribute(\"stroke-width\", \"1\");\n            gradXgrad.setAttribute(\"stroke-opacity\", \"1\");\n            gradXgrad.setAttribute(\"stroke\", \"#000000\");\n            gradXgrad.setAttribute(\"fill\", \"none\");\n            gradXgrad.setAttribute(\"d\", `M${xStrokeTranslation},${pathHeight} L${xStrokeTranslation},${pathHeight - 5}`);\n            gradXgrad.setAttribute(\"transform\", \"translate(0, 5)\");\n\n            gradXstroke.appendChild(gradXgrad);\n            gradXstroke.appendChild(gradXpath);\n            guidesX.appendChild(gradXstroke);\n        }\n\n        var axisXLegend = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n        axisXLegend.setAttribute(\"class\", \"profile-x-legend\");\n        axisXLegend.setAttribute(\"font-family\", style.fontFamily);\n        axisXLegend.setAttribute(\"font-size\", \"11px\");\n        axisXLegend.setAttribute(\"fill\", \"#5E5E5E\");\n        axisXLegend.textContent = `Distance (${distUnit})`;\n\n        axisXLegend.setAttribute(\"transform\", `translate(${zLabelWidth + zGradWidth + pathWidth / 2}, ${pathHeight + xGradHeight + xLabelHeight + 3})`);\n        axisXLegend.setAttribute(\"text-anchor\", \"middle\");\n\n        axisX.appendChild(axisXLegend);\n        elevationSvg.appendChild(axisX);\n        elevationSvg.appendChild(guidesX);\n\n        const elevationPathG = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n\n        let factor = 1;\n        if (distUnit === \"km\") {\n            factor = 1000;\n        }\n\n        let pointX = this._dataDistToSvgX(_points[0].dist / factor, widgetWidth, pathWidth, pxPerMX);\n        let pointY = this._dataZToSvgY(_points[0].z, pathHeight, minGraphZ, pxPerMZ);\n        let pathD = `M${pointX},${pointY}`;\n\n        for (let i = 1; i < _points.length; i++) {\n            pointX = this._dataDistToSvgX(_points[i].dist / factor, widgetWidth, pathWidth, pxPerMX);\n            pointY = this._dataZToSvgY(_points[i].z, pathHeight, minGraphZ, pxPerMZ);\n            pathD += ` L${pointX},${pointY}`;\n        }\n\n        const pathPath = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n        pathPath.setAttribute(\"cs\", \"100,100\");\n        pathPath.setAttribute(\"stroke-width\", \"1\");\n        pathPath.setAttribute(\"stroke-opacity\", \"1\");\n        pathPath.setAttribute(\"stroke\", style.strokeColor);\n        pathPath.setAttribute(\"fill\", \"none\");\n        pathPath.setAttribute(\"d\", pathD);\n\n        // Fermeture du path pour le fill\n        pathD += ` L${pointX},${pathHeight}`;\n        pathD += ` L${widgetWidth - pathWidth},${pathHeight}`;\n\n        const pathFill = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n        pathFill.setAttribute(\"cs\", \"100,100\");\n        pathFill.setAttribute(\"stroke-width\", \"1\");\n        pathFill.setAttribute(\"stroke-opacity\", \"0\");\n        pathFill.setAttribute(\"stroke\", \"#000000\");\n        pathFill.setAttribute(\"fill\", style.fillColor);\n        pathFill.setAttribute(\"fill-opacity\", \"0.2\");\n        pathFill.setAttribute(\"d\", pathD);\n\n        elevationPathG.appendChild(pathPath);\n        elevationPathG.appendChild(pathFill);\n        elevationSvg.appendChild(elevationPathG);\n\n        // Mise en place de l'écouteur d'évènement : pour l'affichage dynamique\n        const dynamicsG = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n        // Pour écouter la position de la souris\n        const pathRectangle = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n        pathRectangle.setAttribute(\"width\", pathWidth);\n        pathRectangle.setAttribute(\"height\", pathHeight);\n        pathRectangle.setAttribute(\"transform\", `translate(${widgetWidth - pathWidth},0)`);\n        pathRectangle.setAttribute(\"visibility\", \"hidden\");\n        pathRectangle.setAttribute(\"pointer-events\", \"all\");\n\n        const sortedDist = JSON.parse(JSON.stringify(_points));\n        sortedDist.sort(function (e1, e2) {\n            return e1.dist - e2.dist;\n        });\n\n        const focusLineX = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n        focusLineX.setAttribute(\"id\", \"focusLineX\");\n        focusLineX.setAttribute(\"class\", \"focusLine-default\");\n        focusLineX.setAttribute(\"fill\", \"none\");\n        focusLineX.setAttribute(\"stroke\", style.focusLineColor);\n        focusLineX.setAttribute(\"stroke-width\", \"0.5px\");\n        focusLineX.setAttribute(\"visibility\", \"hidden\");\n\n        const focusLineY = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n        focusLineY.setAttribute(\"id\", \"focusLineY\");\n        focusLineY.setAttribute(\"class\", \"focusLine-default\");\n        focusLineY.setAttribute(\"fill\", \"none\");\n        focusLineY.setAttribute(\"stroke\", style.focusLineColor);\n        focusLineY.setAttribute(\"stroke-width\", \"0.5px\");\n        focusLineY.setAttribute(\"visibility\", \"hidden\");\n\n        const focusCircle = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\n        focusCircle.setAttribute(\"id\", \"focusCircle\");\n        focusCircle.setAttribute(\"r\", 4);\n        focusCircle.setAttribute(\"class\", \"circle-default focusCircle-default\");\n        focusCircle.setAttribute(\"fill\", style.focusLineColor);\n        focusCircle.setAttribute(\"visibility\", \"hidden\");\n\n        dynamicsG.appendChild(focusCircle);\n        dynamicsG.appendChild(focusLineX);\n        dynamicsG.appendChild(focusLineY);\n\n        // Tooltip\n        const tooltipDiv = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n        const altiSpan = document.createElementNS(\"http://www.w3.org/2000/svg\", \"tspan\");\n        const slopeSpan = document.createElementNS(\"http://www.w3.org/2000/svg\", \"tspan\");\n        const coordsSpan = document.createElementNS(\"http://www.w3.org/2000/svg\", \"tspan\");\n\n        tooltipDiv.setAttribute(\"style\", `text-align:center; max-width:220px; font-size:10px; color:#000000; font-family:${style.fontFamily}; z-index:50;`);\n        tooltipDiv.style.pointerEvents = \"none\";\n        tooltipDiv.style.position = \"fixed\";\n        // tooltipDiv.classList.add(\"tooltipInit\");\n        // IE...\n        tooltipDiv.setAttribute(\"class\", \"tooltipInit\");\n        tooltipDiv.setAttribute(\"text-anchor\", \"middle\");\n\n        widgetDiv.appendChild(tooltipDiv);\n\n        altiSpan.setAttribute(\"class\", \"altiPathValue\");\n        altiSpan.setAttribute(\"x\", \"0\");\n        altiSpan.setAttribute(\"dy\", \"-.7em\");\n\n        slopeSpan.setAttribute(\"class\", \"altiPathValue\");\n        slopeSpan.setAttribute(\"x\", \"0\");\n        slopeSpan.setAttribute(\"dy\", \"1em\");\n\n        coordsSpan.setAttribute(\"class\", \"altiPathCoords\");\n        coordsSpan.setAttribute(\"x\", \"0\");\n        coordsSpan.setAttribute(\"dy\", \"1em\");\n\n        tooltipDiv.appendChild(altiSpan);\n        if (_displayProfileOptions.currentSlope) {\n            tooltipDiv.appendChild(slopeSpan);\n        }\n        tooltipDiv.appendChild(coordsSpan);\n\n        const tooltipG = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n\n        dynamicsG.appendChild(tooltipG);\n\n        const tooltipBubble = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n        tooltipBubble.setAttribute(\"cs\", \"100,100\");\n        tooltipBubble.setAttribute(\"fill\", \"#FFFFFF\");\n        tooltipBubble.setAttribute(\"stroke\", \"#CCCCCC\");\n        tooltipBubble.setAttribute(\"fill-opacity\", \"0.8\");\n        tooltipBubble.setAttribute(\"stroke-width\", \"1\");\n        tooltipBubble.setAttribute(\"stroke-opacity\", \"1\");\n\n        const tooltipBubbleShadow = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n        tooltipBubbleShadow.setAttribute(\"cs\", \"100,100\");\n        tooltipBubbleShadow.setAttribute(\"fill\", \"#FFFFFF\");\n        tooltipBubbleShadow.setAttribute(\"stroke\", \"#000000\");\n        tooltipBubbleShadow.setAttribute(\"fill-opacity\", \"0\");\n        tooltipBubbleShadow.setAttribute(\"stroke-width\", \"1\");\n        tooltipBubbleShadow.setAttribute(\"stroke-opacity\", \"0.4\");\n        tooltipBubbleShadow.setAttribute(\"transform\", \"translate(1,1)\");\n\n        tooltipG.appendChild(tooltipBubbleShadow);\n        tooltipG.appendChild(tooltipBubble);\n        tooltipG.appendChild(tooltipDiv);\n\n        // tooltipG.classList.add(\"tooltipInit\");\n        // IE... deprecated\n        tooltipG.setAttribute(\"class\", \"tooltipInit\");\n        tooltipG.style.pointerEvents = \"none\";\n\n        function onMouseOver () {\n            focusLineX.setAttribute(\"visibility\", \"visible\");\n            focusLineY.setAttribute(\"visibility\", \"visible\");\n            focusCircle.setAttribute(\"visibility\", \"visible\");\n            className.__createProfileMarker(self, _points[0]);\n\n            // tooltips\n            tooltipDiv.classList.remove(\"tooltipInit\");\n            tooltipG.classList.remove(\"tooltipInit\");\n            tooltipDiv.classList.remove(\"tooltipFadeOut\");\n            tooltipG.classList.remove(\"tooltipFadeOut\");\n            tooltipDiv.classList.add(\"tooltipFadeIn\");\n            tooltipG.classList.add(\"tooltipFadeIn\");\n        }\n\n        function onMouseOut () {\n            focusLineX.setAttribute(\"visibility\", \"hidden\");\n            focusLineY.setAttribute(\"visibility\", \"hidden\");\n            focusCircle.setAttribute(\"visibility\", \"hidden\");\n            className.__removeProfileMarker(self);\n            // tooltips\n            tooltipDiv.classList.remove(\"tooltipFadeIn\");\n            tooltipG.classList.remove(\"tooltipFadeIn\");\n            tooltipDiv.classList.add(\"tooltipFadeOut\");\n            tooltipG.classList.add(\"tooltipFadeOut\");\n        }\n\n        function onMouseMove (e) {\n            const mousePoint = elevationSvg.createSVGPoint();\n            mousePoint.x = e.clientX;\n            mousePoint.y = e.clientY;\n            const svgMousePoint = mousePoint.matrixTransform(elevationSvg.getScreenCTM().inverse());\n            const mouseDist = this._svgXToDataDist(svgMousePoint.x, widgetWidth, pathWidth, pxPerMX) * factor;\n\n            // Math.max pour éviter de sortir de l'array\n            const distIndex = Math.max(1, this._arrayBisect(sortedDist, mouseDist));\n\n            const d0 = _points[distIndex - 1];\n            const d1 = _points[distIndex];\n            let d = d0;\n            if (mouseDist - d0.dist > d1.dist - mouseDist) {\n                d = d1;\n            }\n\n            const focusX = this._dataDistToSvgX(d.dist / factor, widgetWidth, pathWidth, pxPerMX);\n            const focusY = this._dataZToSvgY(d.z, pathHeight, minGraphZ, pxPerMZ);\n\n            // Mise à jour des éléments graphiques\n            focusCircle.setAttribute(\"cx\", focusX);\n            focusCircle.setAttribute(\"cy\", focusY);\n\n            focusLineX.setAttribute(\"x1\", focusX);\n            focusLineX.setAttribute(\"y1\", pathHeight);\n            focusLineX.setAttribute(\"x2\", focusX);\n            focusLineX.setAttribute(\"y2\", 0);\n\n            focusLineY.setAttribute(\"x1\", zLabelWidth + zGradWidth);\n            focusLineY.setAttribute(\"y1\", focusY);\n            focusLineY.setAttribute(\"x2\", pathWidth + zLabelWidth + zGradWidth);\n            focusLineY.setAttribute(\"y2\", focusY);\n\n            className.__updateProfileMarker(self, d);\n\n            // Mise à jour du tooltip\n            const altiSpanTxt = `Altitude : ${d.z.toLocaleString()} m`;\n            const slopeSpanTxt = `Pente : ${d.slope} %`;\n            const coordsSpanTxt = `(lat : ${d.lat.toLocaleString()} / lon : ${d.lon.toLocaleString()})`;\n\n            altiSpan.innerHTML = altiSpanTxt;\n            slopeSpan.innerHTML = slopeSpanTxt;\n            coordsSpan.innerHTML = coordsSpanTxt;\n\n            const tooltipTextWidth = Math.max(\n                this._getTextWidth(coordsSpanTxt, coordsSpan),\n                this._getTextWidth(altiSpanTxt, altiSpan)\n            );\n\n            let toolTipBubbleD;\n            if (d.dist > (dist * factor) / 2) {\n                toolTipBubbleD = `M -0.5 -0.5 l -6 6 l 0 16 l -${tooltipTextWidth + 10} 0 l 0 -44 l ${tooltipTextWidth + 10} 0 l 0 16 l 6 6`;\n                tooltipDiv.setAttribute(\"transform\", `translate(${-(tooltipTextWidth / 2 + 12)},0)`); // IE11 !\n            } else if (d.dist <= (dist * factor) / 2) {\n                toolTipBubbleD = `M -0.5 -0.5 l 6 6 l 0 16 l ${tooltipTextWidth + 10} 0 l 0 -44 l -${tooltipTextWidth + 10} 0 l 0 16 l -6 6`;\n                // Largeur de la fleche de la bulle du tooltip\n                tooltipDiv.setAttribute(\"transform\", `translate(${(tooltipTextWidth / 2 + 12)},0)`); // IE11 !\n            }\n\n            tooltipBubble.setAttribute(\"d\", toolTipBubbleD);\n            tooltipBubbleShadow.setAttribute(\"d\", toolTipBubbleD);\n\n            tooltipG.setAttribute(\"transform\", `translate(${focusX},${focusY})`); // IE11 !\n            tooltipG.style.transform = `translate(${focusX}px,${focusY}px)`;\n        }\n\n        pathRectangle.addEventListener(\"pointerover\", onMouseOver);\n        pathRectangle.addEventListener(\"pointerout\", onMouseOut);\n        pathRectangle.addEventListener(\"pointermove\", onMouseMove.bind(this));\n\n        dynamicsG.appendChild(pathRectangle);\n        elevationSvg.appendChild(dynamicsG);\n\n        widgetDiv.appendChild(elevationSvg);\n\n        return container;\n    },\n\n    /**\n     * Display Profile without graphical rendering (raw service response)\n     *\n     * @public\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     * @returns {DOMElement} profil container\n     */\n    displayProfileRaw : function (data, container, context, className) {\n        if (!container) {\n            return;\n        }\n\n        // on nettoie toujours...\n        while (container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n\n        var _points = (data && data.points) ? data.points : {};\n\n        var div = document.createElement(\"textarea\");\n        div.id = \"profilElevationResults\";\n        div.rows = 10;\n        div.cols = 50;\n        div.style.width = \"100%\";\n        div.innerHTML = JSON.stringify(_points, undefined, 4);\n        div.addEventListener(\"mouseover\", function (e) {\n            className.__customRawProfileMouseOverEvent(context, e);\n        });\n\n        // TODO\n        // for (var i = 0; i < _points.length; i++) {\n        //     var point = _points[i];\n        //     var divC  = document.createElement(\"code\");\n        //     divC.id = \"point_\" + i;\n        //     divC.innerHTML = JSON.stringify(point, undefined, 4);\n        //     div.appendChild(divC);\n        //     divC.addEventListener(\"mouseover\", function (e) {\n        //          className.__customRawProfileMouseOverEvent(context, e);\n        //     });\n        // }\n\n        container.appendChild(div);\n\n        return container;\n    },\n\n    /**\n     * Display Profile using D3 javascript framework. This method needs D3 libraries to be loaded.\n     *\n     * @public\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     * @returns {DOMElement} profil container\n     */\n    displayProfileLibD3 : function (data, container, context, className) {\n        var self = context;\n\n        if (!container) {\n            return;\n        }\n\n        if (!data) {\n            return;\n        }\n\n        // on nettoie toujours...\n        while (container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n\n        var _points = data.points;\n\n        if (data.distance > 2000) {\n            data.unit = \"km\";\n            for (let i = 0; i < _points.length; i++) {\n                _points[i].dist /= 1000;\n            }\n        }\n\n        var _displayProfileOptions = self.options.displayProfileOptions;\n\n        var margin = {\n            top : 20,\n            right : 20,\n            bottom : 30,\n            left : 40\n        };\n\n        var widgetWidth = window.getComputedStyle(container).getPropertyValue(\"width\");\n        var widgetHeigth = window.getComputedStyle(container).getPropertyValue(\"height\");\n        var width = widgetWidth.replace(/px/, \"\") - margin.left - margin.right;\n        var height = widgetHeigth.replace(/px/, \"\") - margin.top - margin.bottom;\n\n        var x = d3.scale.linear()\n            .range([0, width]);\n\n        var y = d3.scale.linear()\n            .range([height, 0]);\n\n        var xAxis = d3.svg.axis()\n            .scale(x)\n            .orient(\"bottom\")\n            .ticks(5);\n\n        var yAxis = d3.svg.axis()\n            .scale(y)\n            .orient(\"left\")\n            .ticks(5);\n\n        var line = d3.svg.line()\n            .interpolate(\"basis\")\n            .x(function (d) {\n                return x(d.dist);\n            })\n            .y(function (d) {\n                return y(d.z);\n            });\n\n        var area = d3.svg.area()\n            .interpolate(\"basis\")\n            .x(function (d) {\n                return x(d.dist);\n            })\n            .y0(height)\n            .y1(function (d) {\n                return y(d.z);\n            });\n\n        var svg = d3.select(container)\n            .append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var xDomain = d3.extent(_points, function (d) {\n            return d.dist;\n        });\n        x.domain(xDomain);\n\n        var yDomain = [\n            0,\n            d3.max(_points, function (d) {\n                return d.z;\n            })\n        ];\n        y.domain(yDomain);\n\n        svg.append(\"path\")\n            .datum(_points)\n            .attr(\"class\", \"area-d3\")\n            .attr(\"d\", area);\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis-d3\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis)\n            .append(\"text\")\n            .attr(\"y\", -15)\n            .attr(\"dy\", \".71em\")\n            .attr(\"x\", width)\n            .text(\"Distance (\" + data.unit + \")\");\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis-d3\")\n            .call(yAxis)\n            .append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 6)\n            .attr(\"dy\", \".71em\")\n            .text(\"Altitude (m)\");\n\n        svg.append(\"g\")\n            .attr(\"class\", \"grid-d3 vertical\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis\n                .orient(\"bottom\")\n                .tickSize(-height, 0, 0)\n                .tickFormat(\"\")\n            );\n\n        svg.append(\"g\")\n            .attr(\"class\", \"grid-d3 horizontal\")\n            .call(yAxis\n                .orient(\"left\")\n                .tickSize(-width, 0, 0)\n                .tickFormat(\"\")\n            );\n\n        svg.append(\"path\")\n            .datum(_points)\n            .attr(\"class\", \"line-d3\")\n            .attr(\"d\", line);\n\n        svg.selectAll(\"circle\")\n            .data(_points)\n            .enter()\n            .append(\"circle\")\n            .attr(\"cx\", function (d) {\n                return x(d.dist);\n            })\n            .attr(\"cy\", function (d) {\n                return y(d.z);\n            })\n            .attr(\"r\", 0)\n            .attr(\"class\", \"circle-d3\");\n\n        var focus = svg.append(\"g\").style(\"display\", \"none\");\n\n        focus.append(\"line\")\n            .attr(\"id\", \"focusLineX\")\n            .attr(\"class\", \"focusLine-d3\");\n        focus.append(\"line\")\n            .attr(\"id\", \"focusLineY\")\n            .attr(\"class\", \"focusLine-d3\");\n        focus.append(\"circle\")\n            .attr(\"id\", \"focusCircle\")\n            .attr(\"r\", 4)\n            .attr(\"class\", \"circle-d3 focusCircle-d3\");\n\n        var div = d3.select(container).append(\"div\")\n            .attr(\"class\", \"tooltip-d3\")\n            .style(\"opacity\", 0);\n\n        var bisectDist = d3.bisector(function (d) {\n            return d.dist;\n        }).left;\n\n        svg.append(\"rect\")\n            .attr(\"class\", \"overlay-d3\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .on(\"mouseover\", function () {\n                focus.style(\"display\", null);\n                className.__createProfileMarker(self, _points[0]);\n            })\n            .on(\"mouseout\", function () {\n                focus.style(\"display\", \"none\");\n                className.__removeProfileMarker(self);\n\n                // tooltips\n                div.transition()\n                    .duration(500)\n                    .style(\"opacity\", 0);\n            })\n            .on(\"mousemove\", function () {\n                var m = d3.mouse(this);\n                var distance = x.invert(m[0]);\n                // Math.max pour éviter de sortir de l'array\n                var i = Math.max(1, bisectDist(_points, distance));\n\n                var d0 = _points[i - 1];\n                var d1 = _points[i];\n                var d = distance - d0[0] > d1[0] - distance ? d1 : d0;\n\n                var xc = x(d.dist);\n                var yc = y(d.z);\n\n                focus.select(\"#focusCircle\")\n                    .attr(\"cx\", xc)\n                    .attr(\"cy\", yc);\n                focus.select(\"#focusLineX\")\n                    .attr(\"x1\", xc).attr(\"y1\", y(yDomain[0]))\n                    .attr(\"x2\", xc).attr(\"y2\", y(yDomain[1]));\n                focus.select(\"#focusLineY\")\n                    .attr(\"x1\", x(xDomain[0])).attr(\"y1\", yc)\n                    .attr(\"x2\", x(xDomain[1])).attr(\"y2\", yc);\n\n                className.__updateProfileMarker(self, d);\n\n                // tooltips\n                div.transition()\n                    .duration(200)\n                    .style(\"opacity\", 0.9);\n\n                var _message = \"\";\n                _message += \" Altitude : \" + d.z + \" m\";\n                if (_displayProfileOptions.currentSlope) {\n                    _message += \"<br/> Pente : \" + d.slope + \" %\";\n                }\n                _message += \"<br/> (Lat : \" + d.lat + \"/ Lon : \" + d.lon + \")\";\n\n                div.html(_message)\n                    .style(\"left\", (d3.event.pageX) + \"px\")\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            });\n\n        // return d3.selectAll(\"rect.overlay\")[0][0];\n        return svg;\n    },\n\n    /**\n     * Display Profile using Amcharts framework. This method needs AmCharts libraries to be loaded.\n     *\n     * @public\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     * @returns {DOMElement} profil container\n     */\n    displayProfileLibAmCharts : function (data, container, context, className) {\n        var self = context;\n\n        if (!container) {\n            return;\n        }\n\n        if (!data) {\n            return;\n        }\n\n        var _points = data.points;\n\n        var ballonText = \"<span class='altiPathValue'>[[title]] : [[value]]m</span><br/>\";\n        var currentSlope = self.options.displayProfileOptions.currentSlope;\n        if (currentSlope) {\n            ballonText += \"<span class='altiPathValue'>Pente : [[slope]] %</span><br/>\";\n        }\n        ballonText += \"<span class='altiPathCoords'>(Lat: [[lat]] / Lon:[[lon]])</span>\";\n\n        AmCharts.addInitHandler(function () {});\n\n        if (data.distance > 2000) {\n            data.unit = \"km\";\n            for (let i = 0; i < _points.length; i++) {\n                _points[i].dist /= 1000;\n            }\n        }\n\n        for (let i = 0; i < _points.length; i++) {\n            var dist = _points[i].dist;\n            var coeffArrond = 100;\n            if (dist > 100) {\n                coeffArrond = 1;\n            } else if (dist > 10) {\n                coeffArrond = 10;\n            }\n\n            // Correction arrondi distance totale\n            dist = Math.round(dist * coeffArrond) / coeffArrond;\n            _points[i].dist = dist;\n        }\n\n        var settings = {\n            type : \"serial\",\n            pathToImages : \"http://cdn.amcharts.com/lib/3/images/\",\n            categoryField : \"dist\",\n            autoMarginOffset : 0,\n            marginRight : 10,\n            marginTop : 10,\n            startDuration : 0,\n            color : \"#5E5E5E\",\n            fontSize : 8,\n            theme : \"light\",\n            thousandsSeparator : \"\",\n            numberFormatter : {\n                precision : -1,\n                decimalSeparator : \",\",\n                thousandsSeparator : \" \"\n            },\n            categoryAxis : {\n                color : \"#5E5E5E\",\n                gridPosition : \"start\",\n                minHorizontalGap : 40,\n                tickPosition : \"start\",\n                title : \"Distance (\" + data.unit + \")\",\n                titleColor : \"#5E5E5E\",\n                labelOffset : 0,\n                startOnAxis : true\n            },\n            chartCursor : {\n                animationDuration : 0,\n                bulletsEnabled : true,\n                bulletSize : 10,\n                categoryBalloonEnabled : false,\n                cursorColor : \"#F90\",\n                graphBulletAlpha : 1,\n                graphBulletSize : 1,\n                zoomable : false\n            },\n            trendLines : [],\n            graphs : [{\n                balloonColor : \"#CCCCCC\",\n                balloonText : ballonText,\n                bullet : \"round\",\n                bulletAlpha : 0,\n                bulletBorderColor : \"#FFF\",\n                bulletBorderThickness : 2,\n                bulletColor : \"#F90\",\n                bulletSize : 6,\n                hidden : false,\n                id : \"AmGraph-1\",\n                fillAlphas : 0.4,\n                fillColors : \"#C77A04\",\n                lineAlpha : 1,\n                lineColor : \"#C77A04\",\n                lineThickness : 1,\n                title : \"Altitude\",\n                valueField : \"z\"\n            }],\n            guides : [],\n            valueAxes : [{\n                id : \"ValueAxis-1\",\n                minVerticalGap : 20,\n                title : \"Altitude (m)\"\n            }],\n            balloon : {\n                borderColor : \"#CCCCCC\",\n                borderThickness : 1,\n                fillColor : \"#FFFFFF\",\n                showBullet : true\n            },\n            titles : [],\n            allLabels : [],\n            dataProvider : _points\n        };\n\n        var _containerProfile = AmCharts.makeChart(container, settings);\n\n        _containerProfile.addListener(\"changed\", function (e) {\n            var obj = e.chart.dataProvider[e.index];\n            className.__updateProfileMarker(self, obj);\n        });\n\n        return _containerProfile;\n    }\n};\n\nexport default ProfileElevationPathDOM;\n","/** globals AmCharts, d3 */\n// import CSS\nimport \"../../CSS/Controls/ElevationPath/GPFelevationPath.css\";\n// import \"../../CSS/Controls/ElevationPath/GPFelevationPathStyle.css\";\n// import OpenLayers\n// import Control from \"ol/control/Control\";\nimport Widget from \"../Widget\";\nimport Control from \"../Control\";\nimport {\n    Fill,\n    Icon,\n    Stroke,\n    Style,\n    Image,\n    Circle\n} from \"ol/style\";\nimport { Point } from \"ol/geom\";\nimport { Draw as DrawInteraction } from \"ol/interaction\";\nimport { transform as olTransformProj } from \"ol/proj\";\nimport { getDistance as olGetDistanceSphere } from \"ol/sphere\";\nimport Feature from \"ol/Feature\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\n// import geoportal library access\nimport Gp from \"geoportal-access-lib\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport ID from \"../../Utils/SelectorID\";\nimport Markers from \"../Utils/Markers\";\n// import local with ol dependencies\nimport Interactions from \"../Utils/Interactions\";\nimport MeasureToolBox from \"../ToolBoxMeasure/MeasureToolBox\";\nimport Measures from \"../Measures/Measures\";\nimport LayerSwitcher from \"../LayerSwitcher/LayerSwitcher\";\nimport ButtonExport from \"../Export/Export\";\nimport GeoJSONExtended from \"../../Formats/GeoJSON\";\n// DOM\nimport ElevationPathDOM from \"./ElevationPathDOM\";\nimport ProfileElevationPathDOM from \"./ProfileElevationPathDOM\";\n\nvar logger = Logger.getLogger(\"elevationpath\");\n\n/**\n * @classdesc\n *\n * Elevation Path Control. Allows users to draw a path on a Openlayers map see the elevation profile computed with geoportal elevation path web service along that path.\n *\n * @constructor\n * @alias ol.control.ElevationPath\n * @type {ol.control.ElevationPath}\n * @extends ol.control.Control\n * @param {Object} options - options for function call.\n * @param {Number} [options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {String} [options.apiKey] - API key for services call (isocurve and autocomplete services). The key \"calcul\" is used by default.\n * @param {Boolean} [options.active = false] - specify if control should be actived at startup. Default is false.\n * @param {Boolean} [options.ssl = true] - use of ssl or not (default true, service requested using https protocol)\n * @param {Boolean|Object} [options.export = false] - Specify if button \"Export\" is displayed. For the use of the options of the \"Export\" control, see {@link ol.control.Export}\n * @param {Object} [options.elevationOptions = {}] - elevation path service options. See {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~getAltitude Gp.Services.getAltitude()} for available options\n * @param {Object} [options.layerDescription = {}] - Layer informations to be displayed in LayerSwitcher widget (only if a LayerSwitcher is also added to the map)\n * @param {String} [options.layerDescription.title = \"Profil altimétrique\"] - Layer title to be displayed in LayerSwitcher\n * @param {String} [options.layerDescription.description = \"Mon profil altimétrique\"] - Layer description to be displayed in LayerSwitcher\n * @param {Object} [options.stylesOptions] - styles management\n * @param {Object} [options.stylesOptions.marker = {}] - styles management of marker displayed on map when the user follows the elevation path. Specified with an {@link https://openlayers.org/en/latest/apidoc/module-ol_style_Image-ImageStyle.html ol.style.Image} subclass object\n * @param {Object} [options.stylesOptions.draw = {}] - styles used when drawing. Specified with following properties.\n * @param {Object} [options.stylesOptions.draw.pointer = {}] - Style for mouse pointer when drawing the line. Specified with an {@link https://openlayers.org/en/latest/apidoc/module-ol_style_Image-ImageStyle.html ol.style.Image} subclass object.\n * @param {Object} [options.stylesOptions.draw.start = {}] - Line Style when drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/module-ol_style_Stroke-Stroke.html ol.style.Stroke} object.\n * @param {Object} [options.stylesOptions.draw.finish = {}] - Line Style when finished drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/module-ol_style_Stroke-Stroke.html ol.style.Stroke} object.\n * @param {Object} [options.displayProfileOptions = {}] - profile options.\n * @param {Boolean} [options.displayProfileOptions.totalDistance = true] - display the total distance of the path\n * @param {Boolean} [options.displayProfileOptions.greaterSlope = true] - display the greater slope into the graph\n * @param {Boolean} [options.displayProfileOptions.meanSlope = true] -  display the mean slope into the graph\n * @param {Boolean} [options.displayProfileOptions.ascendingElevation = true] -  display the ascending elevation into the graph\n * @param {Boolean} [options.displayProfileOptions.descendingElevation = true] -  display the descending elevation into the graph\n * @param {Boolean} [options.displayProfileOptions.currentSlope = true] -  display current slope value on profile mouseover\n * @param {Function} [options.displayProfileOptions.apply] - function to display profile if you want to cutomise it. By default, ([DISPLAY_PROFILE_BY_DEFAULT()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_BY_DEFAULT)) is used. Helper functions to use with D3 ([DISPLAY_PROFILE_LIB_D3()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_LIB_D3)) or AmCharts ([DISPLAY_PROFILE_LIB_AMCHARTS()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_LIB_AMCHARTS)) frameworks are also provided. You may also provide your own function.\n * @param {Object} [options.displayProfileOptions.target] - DOM container to use to display the profile.\n * @fires elevationpath:drawstart\n * @fires elevationpath:drawend\n * @fires elevationpath:compute\n * @fires export:compute\n * @example\n *\n * var measure = new ol.control.ElevationPath({\n *    export : false,\n *    stylesOptions : {\n *     draw : {\n *       finish : new ol.style.Stroke({\n *            color : \"rgba(0, 0, 0, 0.5)\",\n *            width : 2\n *       })\n *     },\n *    }\n *    displayProfileOptions : {\n *       apply : ol.control.ElevationPath.DISPLAY_PROFILE_RAW,\n *    }\n * });\n *\n * // if you want to pluggued the control Export with options :\n * var measure = new ol.control.ElevationPath({\n *    export : {\n *      name : \"export\",\n *      format : \"geojson\",\n *      title : \"Exporter\",\n *      menu : false\n *    }\n * });\n *\n * Exemples :\n * - displayProfileOptions.apply : null\n * - displayProfileOptions.apply : function (elevations, container, context) {  // do some stuff... }\n * - displayProfileOptions.apply : ol.control.ElevationPath.DISPLAY_PROFILE_{LIB_AMCHARTS | LIB_D3 | RAW}\n *\n */\nvar ElevationPath = class ElevationPath extends Control {\n\n    /**\n     * See {@link ol.control.ElevationPath}\n     * @module ElevationPath\n     * @alias module:~controls/ElevationPath\n     * @param {*} options - options\n     * @example\n     * import ElevationPath from \"gpf-ext-ol/controls/ElevationPath\"\n     * ou\n     * import { ElevationPath } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        logger.trace(\"ElevationPath()\");\n\n        /**\n         * options\n         * @private\n         */\n        options = options || {};\n\n        // call ol.control.Control constructor\n        super(options);\n\n        if (!(this instanceof ElevationPath)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"ElevationPath\";\n\n        // uuid\n        this._uid = options.id || ID.generate();\n\n        // container : HTMLElement\n        this._showContainer = null;\n        this._pictoButton = null;\n        this._panelContainer = null;\n        this._profileContainer = null;\n        this._waitingContainer = null;\n        this._infoContainer = null;\n\n        // timer sur la fenetre d'informations des données\n        this._timerHdlr = null;\n\n        // objet de type \"ol.style\"\n        this._drawStyleStart = null;\n        this._drawStyleFinish = null;\n        this._markerStyle = null;\n\n        // graph\n        this._profile = null;\n\n        // data elevations\n        this._data = {};\n\n        /* objet de type\n            \"ol.source.Vector\",\n            \"ol.layer.Vector\",\n            \"ol.interaction.Draw\"\n        */\n        this._measureSource = null;\n        this._measureVector = null;\n        this._measureDraw = null;\n\n        // objet de type ol.feature, saisie en cours\n        this._lastSketch = null;\n        this._currentSketch = null;\n\n        // objet de type ol.feature, marker\n        this._marker = null;\n\n        // initialisation du composant\n        this._initialize(options);\n\n        // creation du DOM container\n        this._container = this._initializeContainer();\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this._container) : this.element = this._container;\n\n        return this;\n    }\n\n    /**\n    * Styles applied by default if stylesOptions property is not set.\n    */\n    static DEFAULT_STYLES = {\n        // styling drawing by default\n        // see => Measures.DEFAULTS_STYLES\n        // stying marker to the profile by default\n        MARKER : new Icon({\n            src : Markers[\"lightOrange\"],\n            // image avec un mauvais ratio size 51/38 pixels\n            // src : \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAsCAYAAAAATWqyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABTtJREFUeNq8WGtsFUUU/rb3gtdCAykFG9AUDTQUKimhxUewEusrJYoBo4FfEgoqotHERH6oP9TGmJhIrIlWAf9hjAaEiME2pgFfVVpFii8sWqIQLLSx3EJLW7p+Z2Z2b2l7d/b23vZLTmZ2duacb2fmnDk7DlKA67rXs1hJKacsohRQppjXFygnKT9TDlH2O47zFzIFGnco91EOuqnjoBnr2Ow4FhIlLN6m3DykFTh3BGj/Doj/CfSe082xPCDnBmDWTUBeyXDVjZTHOUNHUiZCEs+weI0ySTV0/w0c2wa07gIungn+vOx8YN46oPhpYOp1Xms/5TmSeSMUERKImFnYqBoGuPRNL5LEW8BgX2rrmjWZZLYApS8BUW8r4T0zO5eTEjFr+S6lSjV0HgPqVwNdf6S30abNB+7aDeQWey3bKZtIxvU5DxvyrE/izJfAvuXpkxCIDtElOjWqjK2RM8LZWMbiG0oEnUc5kB7a14WMYvI04H56du5ieZKluZWz8r0/IyQh5TuKRH8cqFuTeRIC0Sm6xYbYok1j21+ahyhLVO3wC8D5VowbRLfY0FhibOulIavDLEoRZyD8sJDeMWBXKG5ZsIobsdDsg+OMq3u1m1u9KQo8zP45EqjRxOUpk6i50IRl4FuGjpZtwUoiMYa314GFj/EzIsN8n8v+C1e4kfvwcm+wnhsZY27xQ8oiWZpKrWRQB6tAElfxpKnjsCdGklDzG9HvpI/0DYLYEpsalVnmAAM6fgR62oMHl70C5N9mn3rpI32DILbEpkZ5ljlFgbPNFtebzij5VPhNKX1lTBASNtXSzPZ3cxCuvVOH7FTCu4yxeZDGbCES0z5+PniQ3uGpwTYmYTOWCPGTpgYP6u9OnYhtzBCbQkSH0NiM4EEdP6VOxDYmYbNLiJxQ1elFwYPaG3XQCn3QHddjgpCweUKI6K2bvzw4YROf//rJob6fZl/H2FRoFiINfqo3qyzYwD8MVIeYLw32J+8j76SP9A2C2BKbGg1CZL+EF/W4YKP9a3/fCeyhkrY9DOOXEu1SlzZ5J31sSNjqURm/OfQkY9qgvkYOvXhbuH0g505Oga7HT9rPF9+t5+pDL0ulwzt46FV5ROax+JUSRRtP0LoHMK64+xNg7iqVEVOKSKRVxRGpsKhRnaRD4SPjR0J0axKCGmP7ilQxm4X8d8xXmfvHJZlPkCR3WfODl9FLMlxCIhevSJ5Nwzo1XdKxYpe3hpmB6BKdmoS43VqPxIgsni+aWOg8biZ3f+nLmSMiuvKWek/P01az7QdLyNVT7lC/l59WAKcb0iMxhzpW1nvmvpDtSiKD1l9OkpnDgv8UyMWFU9wvTP8vdY6NhJwnD1JVtso2OiiLSeL0iJUbNfg6zikVVwRTyOn2HWOfjfLtHgnBhtFIJCViyNDZUatdmnGlaFPqJIoe1WM1aqlz71ivJbLNobgAA9zgu7nZ/vstHAk5WVdzaPRqmGC5lER6kjpV4OWJdq+1kkshSk4VH9izcy/bV66qSPQZV+0J9G7rTY6+XNmqHmYwyJVV24kse1X31dhKHdasygkzy+a64oC4nWr47F4e858nSbLv4V/KAe9JKpVDrx/SImLIXMOiRUKdujESl+49O8xVZxpXzVc/C/I/RxL/hgq8YYkYhev9q6kVO4d9B+sr3vdICNaHJTHWW8Ya/87wqy2uWwstUk/gTYw3aCRGOarMDfS67kfFWqSuIe9imAjQEC272nJHixYNaSvGRIIGN49ywbsZEw1zI11N6TZSHeaGORn+F2AAJtRIMx4t+hUAAAAASUVORK5CYII=\",\n            anchor : [0.5, 1],\n            snapToPixel : true\n        }),\n        // styling service results points by default\n        RESULTS : {\n            // INFO orienté maintenance !\n            imageRadius : 5,\n            imageFillColor : \"rgba(128, 128, 128, 0.2)\",\n            imageStrokeColor : \"rgba(0, 0, 0, 0.7)\",\n            imageStrokeWidth : 2\n        }\n        // FIXME ???\n        // PROFILE : {\n        //     type : \"serial\",\n        //     pathToImages : \"http://cdn.amcharts.com/lib/3/images/\",\n        //     categoryField : \"dist\",\n        //     autoMarginOffset : 0,\n        //     marginRight : 10,\n        //     marginTop : 10,\n        //     startDuration : 0,\n        //     color : \"#5E5E5E\",\n        //     fontSize : 10,\n        //     theme : \"light\",\n        //     thousandsSeparator : \"\",\n        //     categoryAxis : {\n        //         color : \"#5E5E5E\",\n        //         gridPosition : \"start\",\n        //         minHorizontalGap : 40,\n        //         tickPosition : \"start\",\n        //         title : \"Distance (km)\",\n        //         titleColor : \"#5E5E5E\",\n        //         startOnAxis : true\n        //     },\n        //     chartCursor : {\n        //         animationDuration : 0,\n        //         bulletsEnabled : true,\n        //         bulletSize : 10,\n        //         categoryBalloonEnabled : false,\n        //         cursorColor : \"#F90\",\n        //         graphBulletAlpha : 1,\n        //         graphBulletSize : 1,\n        //         zoomable : false\n        //     },\n        //     trendLines : [],\n        //     graphs : [\n        //         {\n        //             balloonColor : \"#CCCCCC\",\n        //             balloonText : \"<span class='altiPathValue'>[[title]] : [[value]]m</span><br/><span class='altiPathCoords'>(lat: [[lat]] / lon:[[lon]])</span>\",\n        //             bullet : \"round\",\n        //             bulletAlpha : 0,\n        //             bulletBorderColor : \"#FFF\",\n        //             bulletBorderThickness : 2,currentSlope\n        //             bulletColor : \"#F90\",\n        //             bulletSize : 6,\n        //             hidden : false,\n        //             id : \"AmGraph-1\",\n        //             fillAlphas : 0.4,\n        //             fillColors : \"#C77A04\",\n        //             lineAlpha : 1,\n        //             lineColor : \"#C77A04\",\n        //             lineThickness : 1,\n        //             title : \"Altitude\",\n        //             valueField : \"z\"\n        //         }\n        //     ],\n        //     guides : [],\n        //     valueAxes : [\n        //         {\n        //             id : \"ValueAxis-1\",\n        //             minVerticalGap : 20,\n        //             title : \"Altitude (m)\"\n        //         }\n        //     ],\n        //     allLabels : [],\n        //     balloon : {\n        //         borderColor : \"#CCCCCC\",\n        //         borderThickness : 1,\n        //         fillColor : \"#FFFFFF\",\n        //         showBullet : true\n        //     },\n        //     titles : []\n        // }\n    };\n\n    /**\n     * suppression du marker\n     *\n     * @param {Object} context - context\n     *\n     * @private\n     */\n    static __removeProfileMarker (context) {\n        var self = context;\n        // suppression de l'ancien marker\n        if (self._marker) {\n            self._measureSource.removeFeature(self._marker);\n            self._marker = null;\n        }\n    };\n\n    /**\n     * suppression du marker\n     *\n     * @param {Object} context - context\n     * @param {Object} d - d\n     *\n     * @private\n     */\n    static __createProfileMarker (context, d) {\n        var self = context;\n        // suppression de l'ancien marker\n        if (self._marker) {\n            self._measureSource.removeFeature(self._marker);\n            self._marker = null;\n        }\n        var map = self.getMap();\n        var proj = map.getView().getProjection();\n\n        var _coordinate = olTransformProj([d.lon, d.lat], \"EPSG:4326\", proj);\n        var _coordinateProj = self._measureSource\n            .getFeatures()[0]\n            .getGeometry()\n            .getClosestPoint(_coordinate);\n\n        var _geometry = new Point(_coordinateProj);\n\n        self._marker = new Feature({\n            geometry : _geometry\n        });\n        logger.trace(_geometry);\n\n        // style\n        self._marker.setStyle(self._markerStyle);\n\n        // ajout du marker sur la map\n        self._measureSource.addFeature(self._marker);\n    }\n\n    /**\n     * mise à jour du marker\n     *\n     * @param {Object} context - context\n     * @param {Object} d - data\n     *\n     * @private\n     */\n    static __updateProfileMarker (context, d) {\n        var self = context;\n        ElevationPath.__removeProfileMarker(self);\n        ElevationPath.__createProfileMarker(self, d);\n    }\n\n    /**\n     * TODO : customisation possible d'une opération sur le profil\n     *\n     * @param {Object} context - context\n     * @param {Object} d - data\n     *\n     * @private\n     */\n    static __customRawProfileOperation (context, d) {\n        logger.log(\"__customRawProfileOperation\");\n\n        var self = context;\n\n        var _pts = d.points;\n        var _proj = self.getMap().getView().getProjection();\n        for (var i = 0; i < _pts.length; i++) {\n            var obj = _pts[i];\n            var _coordinate = olTransformProj([obj.lon, obj.lat], \"EPSG:4326\", _proj);\n            var _geometry = new Point(_coordinate);\n\n            self._marker = new Feature({\n                geometry : _geometry\n            });\n            logger.trace(_geometry);\n\n            // TODO style en options ?\n            var styles = ElevationPath.DEFAULT_STYLES.RESULTS;\n            var _image = new Circle({\n                radius : styles.imageRadius,\n                stroke : new Stroke({\n                    color : styles.imageStrokeColor,\n                    width : styles.imageStrokeWidth\n                }),\n                fill : new Fill({\n                    color : styles.imageFillColor\n                })\n            });\n            self._marker.setStyle(new Style({\n                image : _image\n            }));\n\n            // ajout du marker sur la map\n            self._measureSource.addFeature(self._marker);\n        }\n    }\n\n    /**\n     * TODO : customisation possible d'une opération sur le profil\n     * Ex. Methode appélée dans le DOM : ProfileElevationPathDOM\n     *\n     * @param {Object} context - context\n     * @param {Object} e - event\n     * @private\n     */\n    static __customRawProfileMouseOverEvent (context, e) {\n        logger.log(\"__customRawProfileMouseOverEvent\", context, e);\n    }\n\n    /**\n     * display Profile using Amcharts framework. This method needs AmCharts libraries to be loaded.\n     *\n     * @param {Object} data - collection elevations\n     * @param {HTMLElement} container - container\n     * @param {Object} context - this control object\n     */\n    static DISPLAY_PROFILE_LIB_AMCHARTS (data, container, context) {\n        logger.trace(\"ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS\");\n\n        // Calcul du profile\n        if (typeof AmCharts === \"undefined\") {\n            logger.log(\"Lib. AmCharts is not loaded !\");\n            return;\n        }\n\n        var profile = ProfileElevationPathDOM.displayProfileLibAmCharts(data, container, context, ElevationPath);\n        // on sauvegarde le profil du container dans l'objet\n        if (profile) {\n            this._profile = profile;\n        }\n    }\n\n    /**\n     * display Profile using D3 javascript framework. This method needs D3 libraries to be loaded.\n     *\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     */\n    static DISPLAY_PROFILE_LIB_D3 (data, container, context) {\n        logger.trace(\"ElevationPath.DISPLAY_PROFILE_LIB_D3\");\n\n        // Calcul du profile\n        if (typeof d3 === \"undefined\") {\n            logger.log(\"Lib. D3 is not loaded !\");\n            return;\n        }\n\n        var profile = ProfileElevationPathDOM.displayProfileLibD3(data, container, context, ElevationPath);\n        // on sauvegarde le profil du container dans l'objet\n        if (profile) {\n            this._profile = profile;\n        }\n    }\n\n    /**\n     * display Profile without graphical rendering (raw service response)\n     *\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     */\n    static DISPLAY_PROFILE_RAW (data, container, context) {\n        logger.trace(\"ElevationPath.DISPLAY_PROFILE_RAW\");\n\n        var profile = ProfileElevationPathDOM.displayProfileRaw(data, container, context, ElevationPath);\n        // on sauvegarde le profil du container dans l'objet\n        if (profile) {\n            this._profile = profile;\n        }\n    };\n\n    /**\n     * Display Profile function used by default : no additonal framework needed.\n     *\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     */\n    static DISPLAY_PROFILE_BY_DEFAULT (data, container, context) {\n        logger.trace(\"ElevationPath.DISPLAY_PROFILE_BY_DEFAULT\");\n\n        var profile = ProfileElevationPathDOM.displayProfileByDefault(data, container, context, ElevationPath);\n        // on sauvegarde le profil du container dans l'objet\n        if (profile) {\n            this._profile = profile;\n        }\n    };\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n\n    /**\n     * Attach control to map. Overloaded ol.control.Control.setMap() method.\n     *\n     * @param {ol.Map} map - Map.\n     */\n    setMap (map) {\n        logger.trace(\"ElevationPath::setMap\");\n\n        if (map) {\n            // activation des interactions de dessin selon la valeur de\n            // l'option active\n            if (this.options.active) {\n                // on n'affiche pas la fenetre de profile s'il n'existe pas...\n                if (this._profile === null) {\n                    this._panelContainer.style.display = \"none\";\n                    // this._panelContainer.style.visibility = \"hidden\";\n                }\n                this._initMeasureInteraction(map);\n                this._addMeasureInteraction(map);\n            }\n\n            // ajout du composant dans une toolbox\n            if (!this.options.target && !this.options.position) {\n                MeasureToolBox.add(map, this);\n            }\n\n            // ajout d'un bouton d'export\n            if (this.options.export) {\n                var opts = Utils.assign({ control : this }, this.options.export);\n                this.export = new ButtonExport(opts);\n                this.export.render();\n                var self = this;\n                this.export.on(\"button:clicked\", (e) => {\n                    self.dispatchEvent({\n                        type : \"export:compute\",\n                        content : e.content\n                    });\n                });\n            }\n        }\n\n        // on appelle la méthode setMap originale d'OpenLayers\n        super.setMap(map);\n\n        // position\n        if (this.options.position) {\n            this.setPosition(this.options.position);\n        }\n\n        // reunion du bouton avec le précédent\n        if (this.options.gutter === false) {\n            this.getContainer().classList.add(\"gpf-button-no-gutter\");\n        }\n    };\n\n    /**\n     * Returns true if widget is actived (drawing),\n     * false otherwise\n     *\n     * @returns {Boolean} active - true or false\n     */\n    getActive () {\n        logger.trace(\"ElevationPath::getActive\");\n        return this.options.active;\n    }\n\n    /**\n     * Actived widget drawing or not\n     *\n     * @param {Boolean} active - true / false\n     */\n    setActive (active) {\n        logger.trace(\"ElevationPath::setActive\");\n        this.options.active = active;\n    }\n\n    /**\n     * Get elevation data\n     *\n     * @returns {Object} data - elevations\n     * @example\n     * {\n     *        type // \"elevationpath\"\n     *        greaterSlope // pente max\n     *        meanSlope  // pente moyenne\n     *        distancePlus // distance cumulée positive\n     *        distanceMinus // distance cumulée négative\n     *        ascendingElevation // dénivelé cumulée positive\n     *        descendingElevation // dénivelé cumulée négative\n     *        altMin // altitude min\n     *        altMax // altitude max\n     *        distance // distance totale\n     *        unit // unité des mesures de distance\n     *        points // elevations\n     *   }\n     */\n    getData () {\n        return Utils.assign({\n            type : \"elevationpath\"\n        }, this._data);\n    }\n\n    /**\n     * Set profile data\n     *\n     * @param {*} data - elevations\n     * @example\n     * {\n     *        greaterSlope // pente max\n     *        meanSlope  // pente moyenne\n     *        distancePlus // distance cumulée positive\n     *        distanceMinus // distance cumulée négative\n     *        ascendingElevation // dénivelé cumulée positive\n     *        descendingElevation // dénivelé cumulée négative\n     *        altMin // altitude min\n     *        altMax // altitude max\n     *        distance // distance totale\n     *        unit // unité des mesures de distance\n     *        points // elevations\n     * }\n     */\n    setData (data) {\n        this._data = data;\n    }\n\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this._container;\n    }\n\n    /**\n     * Get layer\n     *\n     * @returns {ol.layer.Vector} layer\n     */\n    getLayer () {\n        return this._measureVector;\n    }\n\n    /**\n     * Set layer\n     *\n     * @param {Object} layer - ol.layer.Vector profil layer\n     */\n    setLayer (layer) {\n        if (!layer) {\n            this._measureVector = null;\n            return;\n        }\n\n        if (!(layer instanceof VectorLayer)) {\n            logger.log(\"no valid layer given for hosting drawn features.\");\n            return;\n        }\n\n        // application des styles\n        layer.setStyle(this._drawStyleFinish);\n        // sauvegarde\n        this._measureVector = layer;\n        this._measureSource = layer.getSource();\n    }\n\n    /**\n     * Get vector layer\n     *\n     * @returns {String} geojson - GeoJSON format layer\n     */\n    getGeoJSON () {\n        var features = this._measureVector.getSource().getFeatures();\n\n        var Format = new GeoJSONExtended({\n            defaultStyle : this._drawStyleFinish\n        });\n        // INFO\n        // par defaut, webmercator ou \"EPSG:3857\"\n        var geojson = Format.writeFeatures(features, {\n            dataProjection : \"EPSG:4326\",\n            featureProjection : \"EPSG:3857\"\n        });\n\n        return geojson;\n    }\n\n    /**\n     * Get default style\n     *\n     * @returns {ol.style} style\n     */\n    getStyle () {\n        return this._drawStyleFinish;\n    }\n\n    /**\n     * clean\n     * @param {Boolean} remove - remove layer\n     */\n    clean (remove) {\n        logger.trace(\"ElevationPath::clean\");\n\n        var map = this.getMap();\n\n        // fenetre du profil\n        this._panelContainer.style.display = \"none\";\n        // this._panelContainer.style.visibility = \"hidden\";\n\n        // picto\n        this._pictoButton.setAttribute(\"aria-pressed\", false);\n\n        // this._removeMeasure();\n        this._removeProfile();\n        this._removeMeasureInteraction(map, typeof remove !== \"undefined\" ? remove : false);\n\n        this.setLayer();\n    }\n\n    /**\n     * This method is public.\n     * It allows to init the control.\n     * @fixme\n     */\n    init () {\n        // FIXME\n        // le panneau du profil ne peut pas afficher un profil si il est caché\n        // car le profil est calculé en fonction de la taille du panneau (clientHeight / clientWidth),\n        // et ces valeurs sont à 0 !?\n        this._pictoButton.setAttribute(\"aria-pressed\", true);\n        this._panelContainer.style.display = \"block\";\n        this._displayProfile(this._data);\n        this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n    }\n\n    // ################################################################### //\n    // ##################### init component ############################## //\n    // ################################################################### //\n\n    /**\n     * Initialize control (called by constructor)\n     *\n     * @param {Object} options - options\n     *\n     * @private\n     */\n    _initialize (options) {\n        logger.trace(\"ElevationPath::_initialize : \", options);\n\n        // liste des options\n        this.options = {\n            target : null,\n            render : null,\n            active : false,\n            apiKey : null,\n            export : false,\n            elevationOptions : {\n                outputFormat : \"json\"\n            },\n            layerDescription : {\n                title : \"Profil altimétrique\",\n                description : \"Mon profil altimétrique\"\n            },\n            displayProfileOptions : {\n                totalDistance : true,\n                greaterSlope : true,\n                meanSlope : true,\n                ascendingElevation : true,\n                descendingElevation : true,\n                currentSlope : true,\n                apply : null,\n                target : null\n            },\n            stylesOptions : {\n                profile : null,\n                draw : null,\n                marker : null\n            }\n        };\n\n        // merge with user options\n        Utils.mergeParams(this.options, options);\n\n        this.options.target = options.target || null;\n        // this.options.render = options.render || null;\n\n        // cle API sur le service\n        this.options.apiKey = options.apiKey;\n\n        // gestion de l'affichage du profil\n        var _profile = options.displayProfileOptions || {};\n\n        // bouton export\n        this.export = null;\n\n        // gestion de la fonction du profil\n        var displayFunction = _profile.apply;\n        this.options.displayProfileOptions.apply = (typeof displayFunction === \"function\")\n            ? displayFunction : ElevationPath.DISPLAY_PROFILE_BY_DEFAULT;\n\n        // gestion du container du profil\n        var displayContainer = _profile.target;\n        this.options.displayProfileOptions.target = (typeof displayContainer !== \"undefined\")\n            ? displayContainer : null;\n\n        // gestion des styles\n        var _styles = options.stylesOptions || {};\n\n        // FIXME ???\n        // gestion du style du profil\n        // var profileStyle = _styles.profile;\n        // this.options.stylesOptions.profile = ( typeof profileStyle === \"undefined\" || Object.keys(profileStyle).length === 0 ) ?\n        //     ElevationPath.DEFAULT_STYLES.PROFILE : profileStyle;\n        // this._createStylingProfile();\n\n        // gestion des styles du tracé\n        this.options.stylesOptions.draw = _styles.draw || {};\n        this._createStylingDraw();\n\n        // gestion des styles du marker\n        this.options.stylesOptions.marker = _styles.marker || {};\n        this._createStylingMarker();\n    }\n\n    /**\n     * initialize component container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     */\n    _initializeContainer () {\n        logger.trace(\"ElevationPath::_initializeContainer : \", this._uid);\n\n        // create main container\n        var container = this._createMainContainerElement();\n\n        var picto = this._pictoButton = this._createShowElevationPathPictoElement();\n        container.appendChild(picto);\n\n        // mode \"active\"\n        if (this.options.active) {\n            this._pictoButton.click();\n        }\n\n        // panneau\n        var panel = this._panelContainer = this._createElevationPathPanelElement();\n        var panelDiv = this._createElevationPathPanelDivElement();\n        panel.appendChild(panelDiv);\n\n        // header\n        var header = this._createElevationPathPanelHeaderElement();\n        panelDiv.appendChild(header);\n\n        // profile\n        var profile = this._createElevationPathPanelProfilElement();\n        this._profileContainer = profile.firstChild;\n        panelDiv.appendChild(profile);\n\n        // waiting\n        var waiting = this._waitingContainer = this._createElevationPathWaitingElement();\n        panelDiv.appendChild(waiting);\n\n        // info\n        var info = this._infoContainer = this._createElevationPathInformationsElement();\n        panelDiv.appendChild(info);\n\n        var plugin = this._createDrawingButtonsPluginDiv();\n        panelDiv.appendChild(plugin);\n\n        if (this.options.displayProfileOptions.target === null) {\n            container.appendChild(panel);\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ###################### init styles ################################ //\n    // ################################################################### //\n\n    /**\n     * create style marker object : \"ol.style\"\n     *\n     * @private\n     */\n    _createStylingMarker () {\n        logger.trace(\"ElevationPath::_createStylingMarker \");\n\n        var marker = ElevationPath.DEFAULT_STYLES.MARKER;\n        logger.trace(\"style marker\", marker);\n\n        // si marker n'est pas un objet ol.style.Image, on applique le\n        // style par défaut.\n        if (this.options.stylesOptions.marker instanceof Image) {\n            marker = this.options.stylesOptions.marker;\n        }\n\n        this._markerStyle = new Style({\n            image : marker\n        });\n    }\n\n    /**\n     * create style draw object : \"ol.style\"\n     *\n     * @private\n     */\n    _createStylingDraw () {\n        logger.trace(\"ElevationPath::_createStylingDraw\");\n\n        // on interprete les params pour y creer un objet ol.Style\n        var styles = this.options.stylesOptions.draw;\n\n        // style de depart\n        logger.trace(\"style start\", styles.start);\n\n        // Creation à partir des styles par défaut\n        var startStyleOpts = {\n            image : Measures.DEFAULT_POINTER_STYLE,\n            stroke : Measures.DEFAULT_DRAW_START_STYLE.getStroke()\n        };\n        // ecrasement à partir des propriétés renseignées\n        if (styles.hasOwnProperty(\"pointer\") && styles.pointer instanceof Image) {\n            startStyleOpts.image = styles.pointer;\n        }\n        if (styles.hasOwnProperty(\"start\") && styles.start instanceof Stroke) {\n            startStyleOpts.stroke = styles.start;\n        }\n\n        this._drawStyleStart = new Style(startStyleOpts);\n\n        // style de fin\n        logger.trace(\"style finish\", styles.finish);\n\n        var finishStyleOpts = {\n            stroke : Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()\n        };\n        // ecrasement à partir des propriétés renseignées\n        if (styles.hasOwnProperty(\"finish\") && styles.finish instanceof Stroke) {\n            finishStyleOpts.stroke = styles.finish;\n        }\n\n        this._drawStyleFinish = new Style(finishStyleOpts);\n    }\n\n    /**\n     * create style graph\n     * FIXME : à revoir car ne sert que pour AmCharts !?\n     *\n     * @private\n     */\n    _createStylingProfile () {\n        logger.trace(\"ElevationPath::_createStylingProfile\");\n\n        var userStyles = this.options.stylesOptions.profile;\n\n        logger.trace(\"style profile\", userStyles);\n\n        var defaultStyle = ElevationPath.DEFAULT_STYLES.PROFILE;\n        Object.keys(defaultStyle).forEach((key) => {\n            if (!userStyles.hasOwnProperty(key)) {\n                // si le style user n'existe pas, on ajoute celui par defaut\n                userStyles[key] = defaultStyle[key];\n            } else {\n                var _defaultStyle = defaultStyle[key];\n                if (typeof _defaultStyle === \"object\") {\n                    // on merge avec un objet,\n                    // les styles user ecrasent ceux par defaut...\n                    Utils.mergeParams(_defaultStyle, userStyles[key]);\n                    userStyles[key] = _defaultStyle;\n                }\n            }\n        });\n    }\n\n    // ################################################################### //\n    // ################### Map interactions management ################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this.onShowElevationPathClick,\n     * and initialize a vector layer, if widget is active.\n     *\n     * @param {ol.Map} map - Map\n     * @private\n     */\n    _initMeasureInteraction (map) {\n        logger.trace(\"ElevationPath::_initMeasureInteraction()\");\n\n        // var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        this._measureSource = new VectorSource();\n\n        this._measureVector = new VectorLayer({\n            source : this._measureSource,\n            style : this._drawStyleFinish\n        });\n\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant.\n        this._measureVector.gpResultLayerId = \"measure:profil\";\n\n        map.addLayer(this._measureVector);\n\n        // Si un layer switcher est présent dans la carte, on lui affecte des informations pour cette couche\n        map.getControls().forEach(\n            (control) => {\n                if (control instanceof LayerSwitcher) {\n                    // un layer switcher est présent dans la carte\n                    var layerId = this._measureVector.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas déjà (si le titre est le numéro par défaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this._measureVector, {\n                                title : this.options.layerDescription.title,\n                                description : this.options.layerDescription.description\n                            }\n                        );\n                    }\n                }\n            }\n        );\n    }\n\n    /**\n     * this method is called by this.onShowElevationPathClick,\n     * and add draw interaction to map, if widget is not active.\n     *\n     * @param {ol.Map} map - Map\n     * @private\n     */\n    _addMeasureInteraction (map) {\n        logger.trace(\"ElevationPath::_addMeasureInteraction()\");\n\n        // var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        // Creates and adds the interaction\n        this._measureDraw = new DrawInteraction({\n            source : this._measureSource,\n            type : \"LineString\",\n            style : this._drawStyleStart,\n            stopClick : true\n        });\n\n        this._measureDraw.setProperties({\n            name : \"ElevationPath\",\n            source : this\n        });\n\n        map.addInteraction(this._measureDraw);\n\n        // Event start\n        this._measureDraw.on(\"drawstart\", (evt) => {\n            logger.trace(\"drawstart\", evt);\n\n            // delete marker current\n            if (this._marker !== null) {\n                this._measureSource.removeFeature(this._marker);\n                this._marker = null;\n            }\n\n            // set new feature and remove last feature\n            if (this._lastSketch !== null) {\n                this._measureSource.removeFeature(this._lastSketch);\n                this._lastSketch = null;\n            }\n            this._currentSketch = evt.feature;\n\n            // and, all features\n            var _features = this._measureSource.getFeatures();\n            for (var i = 0; i < _features.length; i++) {\n                this._measureSource.removeFeature(_features[i]);\n            }\n            /**\n            * event triggered at the start of drawing input\n            * @event elevationpath:drawstart\n            */\n            this.dispatchEvent(\"elevationpath:drawstart\");\n        });\n\n        // Event end\n        this._measureDraw.on(\"drawend\", (evt) => {\n            logger.trace(\"drawend\", evt);\n            /**\n            * event triggered at the end of drawing input\n            * @event elevationpath:drawend\n            */\n            this.dispatchEvent(\"elevationpath:drawend\");\n\n            // set feature\n            this._lastSketch = this._currentSketch;\n\n            // Si il n'y a pas de surcharge utilisateur de la fonction de recuperation des\n            // resultats, on realise l'affichage du panneau\n            if (typeof this.options.elevationOptions.onSuccess === \"undefined\" && this.options.displayProfileOptions.target === null) {\n                this._panelContainer.style.display = \"block\";\n                // self._panelContainer.style.visibility = \"visible\";\n            }\n\n            // set an alti request and display results\n            this._measureDraw.setActive(false);\n            this._requestService();\n        });\n    }\n\n    /**\n     * this method is called by this.onShowElevationPathClick,\n     * and removes draw interaction from map (if exists)\n     * And removes layer too...\n     *\n     * @param {ol.Map} map - Map\n     * @param {Boolean} remove - Remove layer\n     * @private\n     */\n    _removeMeasureInteraction (map, remove) {\n        logger.trace(\"ElevationPath::_removeMeasureInteraction()\");\n\n        // var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        if (remove) {\n            if (this._measureVector) {\n                map.removeLayer(this._measureVector);\n                this._measureVector = null;\n            }\n        }\n\n        if (this._measureDraw) {\n            map.removeInteraction(this._measureDraw);\n            this._measureDraw = null;\n        }\n    }\n\n    // ################################################################### //\n    // ############################ Alti request ######################### //\n    // ################################################################### //\n\n    /**\n     * transforme geometry feature to position coordinate (service)\n     *\n     * @returns {Object[]} geometry\n     *\n     * @private\n     */\n    _getGeometry () {\n        // INFO\n        // on transmet toujours des coordonnées au service en EPSG:4326\n\n        if (this._currentSketch === null) {\n            logger.warn(\"Current Feature undefined !?\");\n            return;\n        }\n\n        var geometry = [];\n\n        var map = this.getMap();\n        var projSrc = map.getView().getProjection();\n        var projDest = \"EPSG:4326\";\n        var coordinates = this._currentSketch.getGeometry().getCoordinates();\n        for (var i = 0; i < coordinates.length; i++) {\n            var xy = coordinates[i];\n            var ll = xy;\n            // on transmet au service des coordonnées en EPSG:4326\n            if (projSrc !== projDest) {\n                ll = olTransformProj(xy, projSrc, projDest);\n            }\n            geometry.push({\n                lon : Math.round(ll[0] * 1e8) / 1e8,\n                lat : Math.round(ll[1] * 1e8) / 1e8\n            });\n        }\n\n        return geometry;\n    }\n\n    /**\n     * get geometry feature length\n     *\n     * @returns {Integer} length\n     *\n     * @private\n     */\n    _getLength () {\n        if (this._currentSketch === null) {\n            logger.warn(\"Current Feature undefined !?\");\n            return;\n        }\n\n        var length = 0;\n\n        var map = this.getMap();\n        var projSrc = map.getView().getProjection();\n        var projDest = \"EPSG:4326\";\n\n        var coordinates = this._currentSketch.getGeometry().getCoordinates();\n        for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n            var c1 = olTransformProj(coordinates[i], projSrc, projDest);\n            var c2 = olTransformProj(coordinates[i + 1], projSrc, projDest);\n            c1[0] = Math.round(c1[0] * 1e8) / 1e8;\n            c1[1] = Math.round(c1[1] * 1e8) / 1e8;\n            c2[0] = Math.round(c2[0] * 1e8) / 1e8;\n            c2[1] = Math.round(c2[1] * 1e8) / 1e8;\n            length += olGetDistanceSphere(c1, c2);\n        }\n\n        return length;\n    }\n\n    /**\n     * get geometry feature point coords in EPSG:4326 [lon, lat]\n     *\n     * @returns {Array} point coords in EPSG:4326 [lon, lat]\n     *\n     * @private\n     */\n    _getSketchCoords () {\n        if (this._currentSketch === null) {\n            logger.warn(\"Current Feature undefined !?\");\n            return;\n        }\n\n        var map = this.getMap();\n        var projSrc = map.getView().getProjection();\n        var projDest = \"EPSG:4326\";\n\n        var pointCoords = [];\n\n        var coordinates = this._currentSketch.getGeometry().getCoordinates();\n        for (var i = 0; i < coordinates.length; i++) {\n            var c1 = olTransformProj(coordinates[i], projSrc, projDest);\n            c1[0] = Math.round(c1[0] * 1e8) / 1e8;\n            c1[1] = Math.round(c1[1] * 1e8) / 1e8;\n            pointCoords.push(c1);\n        }\n\n        return pointCoords;\n    }\n\n    /**\n     * this method is called at the end of the path,\n     * it generates and sends alti request, then displays results\n     *\n     * @private\n     */\n    _requestService () {\n        logger.trace(\"ElevationPath::_requestService\");\n\n        // les coordonnées sont obligatoires\n        var geometry = this._getGeometry();\n        logger.trace(\"geometry\", geometry);\n        if (!geometry) {\n            logger.warn(\"missing geometry !?\");\n            return;\n        }\n\n        // on construit les options pour la requête\n        var options = {};\n\n        // on surcharge avec les options de l'utilisateur\n        Utils.mergeParams(options, this.options.elevationOptions);\n\n        // au cas où ...\n        Utils.mergeParams(options, {\n            apiKey : options.apiKey || this.options.apiKey\n        });\n\n        // si l'utilisateur a spécifié le paramètre ssl au niveau du control, on s'en sert\n        // true par défaut (https)\n        if (typeof options.ssl !== \"boolean\") {\n            if (typeof this.options.ssl === \"boolean\") {\n                options.ssl = this.options.ssl;\n            } else {\n                options.ssl = true;\n            }\n        }\n\n        Utils.mergeParams(options, {\n            ssl : options.ssl\n        });\n\n        // les callbacks\n        var self = this;\n\n        // gestion des callback\n        var bOnFailure = !!(this.options.elevationOptions.onFailure !== null && typeof this.options.elevationOptions.onFailure === \"function\"); // cast variable to boolean\n        var bOnSuccess = !!(this.options.elevationOptions.onSuccess !== null && typeof this.options.elevationOptions.onSuccess === \"function\");\n\n        // callback _requestServiceOnSuccess\n        var _requestServiceOnSuccess = function (result) {\n            logger.trace(result);\n            if (result) {\n                self._panelContainer.style.display = \"block\";\n                // self._panelContainer.style.visibility = \"visible\";\n                if (self._data) {\n                    self._data = {};\n                }\n                self._data = self._computeElevationMeasure(result.elevations);\n                self._displayProfile(self._data);\n                self._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n                self._waiting = false;\n                self._measureDraw.setActive(true);\n            }\n            if (bOnSuccess) {\n                self.options.elevationOptions.onSuccess.call(self, self.getData());\n            }\n        };\n\n        // callback _requestServiceOnFailure\n        var _requestServiceOnFailure = function (error) {\n            // on ferme le panneau en cas d'erreur !\n            self._panelContainer.style.display = \"none\";\n            // self._panelContainer.style.visibility = \"hidden\";\n            logger.error(error.message);\n            self._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n            self._waiting = false;\n            self._measureDraw.setActive(true);\n            if (bOnFailure) {\n                self.options.elevationOptions.onFailure.call(self, error);\n            }\n        };\n\n        Utils.mergeParams(options, {\n            onSuccess : _requestServiceOnSuccess,\n            onFailure : _requestServiceOnFailure\n        });\n\n        // le sampling est soit defini par l'utilisateur (opts),\n        // ou soit calculé dynamiquement...\n        var sampling = options.sampling || 200;\n\n        if (sampling > 0) {\n            Utils.mergeParams(options, {\n                sampling : sampling\n            });\n        }\n\n        // et enfin, la geometrie\n        Utils.mergeParams(options, {\n            positions : geometry\n        });\n\n        logger.trace(\"options du service\", options);\n\n        // mise en place de la patience\n        this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible\";\n\n        // Request altitude service\n        Gp.Services.getAltitude(options);\n    }\n\n    // ################################################################### //\n    // ########################## Profil display ######################### //\n    // ################################################################### //\n\n    /**\n     * this method computes results elevations (Z and distance)\n     *\n     * @param {Array} elevations - array of elevation\n     * @return {Array} elevations\n     * @private\n     */\n    _computeElevationMeasure (elevations) {\n        logger.trace(\"ElevationPath::_computeElevationMeasure\", elevations);\n\n        var _data = elevations;\n        var _unit = \"m\";\n\n        var _sketchPoints = this._getSketchCoords();\n        if (!_sketchPoints) {\n            return;\n        }\n        // Calcul de la distance au départ pour chaque point + arrondi des lat/lon\n        _data[0].dist = 0;\n        _data[0].slope = 0;\n        _data[0].oldlat = _data[0].lat;\n        _data[0].oldlon = _data[0].lon;\n        _data[0].lat = Math.round(_data[0].lat * 100000) / 100000;\n        _data[0].lon = Math.round(_data[0].lon * 100000) / 100000;\n\n        var _distanceMinus = 0;\n        var _distancePlus = 0;\n        var _ascendingElevation = 0;\n        var _descendingElevation = 0;\n        var _distance = 0;\n        var _slopes = 0;\n\n        var distances = [];\n        console.log(_data);\n        for (var i = 1; i < _data.length; i++) {\n            var a = [_data[i].lon, _data[i].lat];\n            var distanceToPrevious = olGetDistanceSphere(a, [_data[i-1].oldlon, _data[i-1].oldlat]);\n            var dist = distanceToPrevious + _distance;\n\n            var za = _data[i].z;\n            var zb = _data[i - 1].z;\n            if (za < 0) {\n                za = 0;\n            }\n            if (zb < 0) {\n                zb = 0;\n            }\n            var slope = za - zb;\n            if (slope < 0) {\n                _distanceMinus += distanceToPrevious;\n                _descendingElevation += slope;\n            } else if (slope > 0) {\n                _distancePlus += distanceToPrevious;\n                _ascendingElevation += slope;\n            }\n            _distance = dist;\n            _data[i].dist = dist;\n\n            distances.push(_distance);\n\n            _slopes += (slope) ? Math.abs(Math.round(slope / dist * 100)) : 0;\n            _data[i].slope = (slope) ? Math.abs(Math.round(slope / dist * 100)) : 0;\n\n            // EVOL ?\n            // cf. gradiant\n            // http://www.color-hex.com/color/00b798\n            var value = _data[i].slope;\n            if (value > 15 && value < 30) {\n                _data[i].color = \"#005b4c\";\n            } else if (value > 30 && value < 45) {\n                _data[i].color = \"#00362d\";\n            } else if (value > 45) {\n                _data[i].color = \"#00120f\";\n            } else {\n                _data[i].color = \"#00B798\";\n            }\n            _data[i].oldlat = _data[i].lat;\n            _data[i].oldlon = _data[i].lon;\n            _data[i].lat = Math.round(_data[i].lat * 100000) / 100000;\n            _data[i].lon = Math.round(_data[i].lon * 100000) / 100000;\n        }\n\n        // check distance totale\n        logger.trace(\"List Distances\", distances);\n\n        // Correction des altitudes aberrantes + arrondi des calculs de distance + ...\n        var _altMin = _data[0].z;\n        var _altMax = _data[0].z;\n        var _greaterSlope = _data[0].slope;\n\n        for (var ji = 0; ji < _data.length; ji++) {\n            var d = _data[ji];\n            if (d.z < -100) {\n                d.z = 0;\n            }\n            if (d.z > _altMax) {\n                _altMax = d.z;\n            }\n            if (d.z < _altMin) {\n                _altMin = d.z;\n            }\n\n            if (d.slope > _greaterSlope) {\n                _greaterSlope = d.slope;\n            }\n        }\n\n        return {\n            greaterSlope : _greaterSlope, // pente max\n            meanSlope : Math.round(_slopes / _data.length), // pente moyenne\n            distancePlus : _distancePlus, // distance cumulée positive\n            distanceMinus : _distanceMinus, // distance cumulée négative\n            ascendingElevation : _ascendingElevation, // dénivelé cumulée positive\n            descendingElevation : _descendingElevation, // dénivelé cumulée négative\n            altMin : _altMin.toLocaleString(), // altitude min TODO: inutile ?\n            altMax : _altMax.toLocaleString(), // altitude max TODO: inutile ?\n            distance : this._getLength(), // distance totale\n            unit : _unit, // unité des mesures de distance\n            points : _data\n        };\n    }\n\n    /**\n     * this method is called after service request (in case of success)\n     * and display results\n     *\n     * @param {Array} elevations - array of elevation\n     * @private\n     */\n    _displayProfile (elevations) {\n        logger.trace(\"ElevationPath::_displayProfile\", elevations);\n\n        this._updateInfoContainer();\n\n        // container\n        var container = this.options.displayProfileOptions.target;\n        if (container) {\n            container.appendChild(this._panelContainer);\n        }\n        container = this._profileContainer;\n\n        // TODO contexte ?\n        var context = this;\n\n        // fonction\n        var displayFunction = this.options.displayProfileOptions.apply;\n\n        // execution...\n        displayFunction.call(this, elevations, container, context);\n\n        var opts = this.options.displayProfileOptions;\n        var element = document.getElementById(\"GPelevationPathPanelInfo-\" + this._uid);\n        if (element) {\n            if (opts.totalDistance ||\n                opts.greaterSlope ||\n                opts.meanSlope ||\n                opts.ascendingElevation ||\n                opts.descendingElevation) {\n                // on affiche les informations\n                element.style.display = \"block\";\n            }\n        }\n\n        /**\n         * event triggered when the compute is finished\n         *\n         * @event elevationpath:compute\n         * @typedef {Object}\n         * @property {Object} type - event\n         * @property {Object} target - instance ElevationPath\n         * @example\n         * ElevationPath.on(\"elevationpath:compute\", function (e) {\n         *   console.log(e.target.getData());\n         * })\n         */\n        this.dispatchEvent({\n            type : \"elevationpath:compute\"\n        });\n    }\n\n    /**\n     * update info container\n     *\n     * @private\n     */\n    _updateInfoContainer () {\n        logger.trace(\"ElevationPath::_updateInfoContainer\");\n\n        // options d'affichage\n        var totalDistance = this.options.displayProfileOptions.totalDistance;\n        var meanSlope = this.options.displayProfileOptions.meanSlope;\n        var greaterSlope = this.options.displayProfileOptions.greaterSlope;\n        var ascendingElevation = this.options.displayProfileOptions.ascendingElevation;\n        var descendingElevation = this.options.displayProfileOptions.descendingElevation;\n\n        // clean\n        var div = this._infoContainer;\n        if (div.childElementCount) {\n            while (div.firstChild) {\n                div.removeChild(div.firstChild);\n            }\n        }\n\n        // creation des infomations\n        if (totalDistance) {\n            this._addElevationPathInformationsItem(\"Distance totale : \", Math.round(this._data.distance).toLocaleString() + \" m\");\n        }\n\n        if (ascendingElevation) {\n            this._addElevationPathInformationsItem(\"Dénivelé positif : \", this._data.ascendingElevation.toLocaleString() + \" m\");\n        }\n\n        if (descendingElevation) {\n            this._addElevationPathInformationsItem(\"Dénivelé négatif : \", this._data.descendingElevation.toLocaleString() + \" m\");\n        }\n\n        if (meanSlope) {\n            this._addElevationPathInformationsItem(\"Pente moyenne : \", this._data.meanSlope.toLocaleString() + \" %\");\n        }\n\n        if (greaterSlope) {\n            this._addElevationPathInformationsItem(\"Plus forte pente : \", this._data.greaterSlope.toLocaleString() + \" %\");\n        }\n    }\n\n    /**\n     * Remove measure\n     * @private\n     */\n    _removeMeasure () {\n        // sketch\n        this._lastSketch = null;\n        this._currentSketch = null;\n\n        if (this._measureSource) {\n            // marker\n            if (this._marker) {\n                this._measureSource.removeFeature(this._marker);\n                this._marker = null;\n            }\n\n            // all other features\n            var _features = this._measureSource.getFeatures();\n            for (var i = 0; i < _features.length; i++) {\n                this._measureSource.removeFeature(_features[i]);\n            }\n        }\n    }\n\n    /**\n     * Remove profile\n     * @private\n     */\n    _removeProfile () {\n        // graph\n        this._profile = null;\n\n        // on vide le container\n        if (this._profileContainer) {\n            while (this._profileContainer.firstChild) {\n                this._profileContainer.removeChild(this._profileContainer.firstChild);\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'click' on '' picto\n     * and enable or disable the entry of the path\n     *\n     * @param {Object} e - event\n     * @private\n     */\n    onShowElevationPathClick (e) {\n        var opened = this._pictoButton.ariaPressed;\n        if (opened === \"true\") {\n            this.onPanelOpen();\n        }\n\n        var map = this.getMap();\n        Interactions.unset(map, {\n            current : \"ElevationPath\"\n        });\n\n        // Activation/Desactivation des interactions de dessins\n        if (opened === \"true\") {\n            // on n'affiche pas la fenetre de profile s'il n'existe pas...\n            if (this._profile === null) {\n                this._panelContainer.style.display = \"none\";\n                // this._panelContainer.style.visibility = \"hidden\";\n            }\n            this._initMeasureInteraction(map);\n            this._addMeasureInteraction(map);\n        } else {\n            this._panelContainer.style.display = \"none\";\n            // HACK\n            // il est possible de faire passer une instruction via le DOM et les dataset :\n            // * data-remove-measure : true|false\n            // * data-remove-layer : true|false\n            if (e && e.target.dataset && e.target.dataset.removeMeasure) {\n                if (e.target.dataset.removeMeasure === \"true\") {\n                    this._removeMeasure();\n                } else {\n                    // sketch\n                    this._lastSketch = null;\n                    this._currentSketch = null;\n                }\n            } else {\n                this._removeMeasure();\n            }\n            this._removeProfile();\n\n            if (e && e.target.dataset && e.target.dataset.removeLayer) {\n                this._removeMeasureInteraction(map, (e.target.dataset.removeLayer === \"true\"));\n            } else {\n                this._removeMeasureInteraction(map, true);\n            }\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on '' picto\n     * (cf. this.),\n     * and display the panel info\n     *\n     * @private\n     */\n    onOpenElevationPathInfoClick () {\n        var div = this._infoContainer;\n\n        // show des informations !\n        if (div.className === \"GPelementVisible gpf-visible\") {\n            clearTimeout(this._timerHdlr);\n            div.className = \"GPelementHidden gpf-hidden\";\n        } else {\n            div.className = \"GPelevationPathInformationsContainerVisible\";\n        }\n\n        // hidden des informations !\n        this._timerHdlr = setTimeout(function () {\n            div.className = \"GPelementHidden gpf-hidden\";\n        }, 4000);\n    }\n\n};\n\n// on récupère les méthodes de la classe commune ElevationPath\nObject.assign(ElevationPath.prototype, ElevationPathDOM);\nObject.assign(ElevationPath.prototype, Widget);\n\nexport default ElevationPath;\n\n// Expose ElevationPath as ol.control.ElevationPath (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.ElevationPath = ElevationPath;\n}\n","module.exports = ol.interaction;","module.exports = ol.layer.VectorTile;","/**\n * Factory pour générer une reponse JSON à partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module AltiResponseFactory\n * @private\n * @alias Gp.Services.Alti.Response.AltiResponseFactory\n */\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport MRes from \"../../../Utils/MessagesResources\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport XML from \"../../../Formats/XML\";\nimport AltiResponseReader from \"../Formats/AltiResponseReader\";\nimport AltiResponse from \"./model/AltiResponse\";\nimport Elevation from \"./model/Elevation\";\n\nvar AltiResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"AltiResponseFactory\");\n        logger.trace([\"AltiResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                switch (options.outputFormat) {\n                    case \"xml\":\n                        logger.trace(\"analyze response : xml\");\n\n                        try {\n                            var p = new XML({\n                                reader : AltiResponseReader\n                            });\n\n                            if (typeof options.response === \"string\") {\n                                p.setXMLString(options.response);\n                            } else {\n                                p.setXMLDoc(options.response);\n                            }\n\n                            data = p.parse();\n\n                            if (!data) {\n                                throw new Error(MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION_2\"));\n                            }\n                        } catch (e) {\n                            var message = e.message;\n                            options.onError.call(options.scope, new ErrorService({\n                                message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", message),\n                                status : 200,\n                                type : ErrorService.TYPE_SRVERR\n                            }));\n                            return;\n                        }\n\n                        break;\n\n                    case \"json\":\n                        logger.trace(\"analyze response : json\");\n                        logger.trace(\"analyze response : \", typeof options.response);\n\n                        var JSONResponse = null;\n                        if (typeof options.response === \"string\") {\n                            JSONResponse = JSON.parse(options.response);\n                        } else {\n                            JSONResponse = options.response;\n                        }\n\n                        // le service renvoie t il une erreur ?\n                        if (JSONResponse && JSONResponse.error) {\n                            // ex. {\"error\": {\"code\": \"BAD_PARAMETER\",\"description\": \"The values () cannot be parsed as a valid longitude (double value such as -180 < lat < 180).\"}}\n                            options.onError.call(options.scope, new ErrorService({\n                                message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.error.description),\n                                status : 200,\n                                type : ErrorService.TYPE_SRVERR\n                            }));\n                            return;\n                        }\n\n                        // analyse de la reponse\n                        if (JSONResponse) {\n                            var elevations = JSONResponse.elevations;\n                            var altiResponse = new AltiResponse();\n                            var elevation;\n                            if (Array.isArray(elevations) && elevations.length) {\n                                for (var i = 0; i < elevations.length; i++) {\n                                    elevation = new Elevation();\n\n                                    if (typeof elevations[i] === \"object\") {\n                                        // elevations[i] est un objet elevation\n                                        if (elevations[i].lon) {\n                                            elevation.lon = elevations[i].lon;\n                                        }\n                                        if (elevations[i].lat) {\n                                            elevation.lat = elevations[i].lat;\n                                        }\n                                        if (elevations[i].z) {\n                                            elevation.z = elevations[i].z;\n                                        }\n                                        if (elevations[i].acc) {\n                                            elevation.acc = elevations[i].acc;\n                                        }\n                                        if (elevations[i].measures) {\n                                            elevation.measures = elevations[i].measures;\n                                        }\n                                    } else if (typeof elevations[i] === \"number\") {\n                                        // elevations[i] est un nombre, dans le cas de zonly=true notamment\n                                        elevation.z = elevations[i];\n                                    }\n\n                                    if (Array.isArray(altiResponse.elevations)) {\n                                        altiResponse.elevations.push(elevation);\n                                    }\n                                }\n                            }\n                            data = altiResponse;\n                        }\n\n                        if (!data) {\n                            options.onError.call(options.scope, new ErrorService({\n                                message : MRes.getMessage(\"SERVICE_RESPONSE_ANALYSE_2\"),\n                                type : ErrorService.TYPE_UNKERR,\n                                status : -1\n                            }));\n                            return;\n                        }\n                        break;\n\n                    default:\n                        options.onError.call(options.scope, new ErrorService({\n                            message : MRes.getMessage(\"SERVICE_RESPONSE_FORMAT_2\"),\n                            type : ErrorService.TYPE_UNKERR,\n                            status : -1\n                        }));\n                        return;\n                }\n\n                // Si la réponse contenait une exception renvoyée par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : ErrorService.TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                } else if (data.error) {\n                    var errorMess = data.error.description;\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", errorMess),\n                        type : ErrorService.TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n    }\n};\n\nexport default AltiResponseFactory;\n","module.exports = ol.Overlay;","module.exports = ol.style.Style;","'use strict';\n\nvar conventions = require('./conventions');\nvar dom = require('./dom');\nvar errors = require('./errors');\nvar entities = require('./entities');\nvar sax = require('./sax');\n\nvar DOMImplementation = dom.DOMImplementation;\n\nvar hasDefaultHTMLNamespace = conventions.hasDefaultHTMLNamespace;\nvar isHTMLMimeType = conventions.isHTMLMimeType;\nvar isValidMimeType = conventions.isValidMimeType;\nvar MIME_TYPE = conventions.MIME_TYPE;\nvar NAMESPACE = conventions.NAMESPACE;\nvar ParseError = errors.ParseError;\n\nvar XMLReader = sax.XMLReader;\n\n/**\n * Normalizes line ending according to <https://www.w3.org/TR/xml11/#sec-line-ends>,\n * including some Unicode \"newline\" characters:\n *\n * > XML parsed entities are often stored in computer files which,\n * > for editing convenience, are organized into lines.\n * > These lines are typically separated by some combination\n * > of the characters CARRIAGE RETURN (#xD) and LINE FEED (#xA).\n * >\n * > To simplify the tasks of applications, the XML processor must behave\n * > as if it normalized all line breaks in external parsed entities (including the document entity)\n * > on input, before parsing, by translating the following to a single #xA character:\n * >\n * > 1. the two-character sequence #xD #xA,\n * > 2. the two-character sequence #xD #x85,\n * > 3. the single character #x85,\n * > 4. the single character #x2028,\n * > 5. the single character #x2029,\n * > 6. any #xD character that is not immediately followed by #xA or #x85.\n *\n * @param {string} input\n * @returns {string}\n * @prettierignore\n */\nfunction normalizeLineEndings(input) {\n\treturn input.replace(/\\r[\\n\\u0085]/g, '\\n').replace(/[\\r\\u0085\\u2028\\u2029]/g, '\\n');\n}\n\n/**\n * @typedef Locator\n * @property {number} [columnNumber]\n * @property {number} [lineNumber]\n */\n\n/**\n * @typedef DOMParserOptions\n * @property {typeof assign} [assign]\n * The method to use instead of `conventions.assign`, which is used to copy values from\n * `options` before they are used for parsing.\n * @property {typeof DOMHandler} [domHandler]\n * For internal testing: The class for creating an instance for handling events from the SAX\n * parser.\n * *****Warning: By configuring a faulty implementation, the specified behavior can completely\n * be broken.*****.\n * @property {Function} [errorHandler]\n * DEPRECATED! use `onError` instead.\n * @property {function(level:ErrorLevel, message:string, context: DOMHandler):void}\n * [onError]\n * A function invoked for every error that occurs during parsing.\n *\n * If it is not provided, all errors are reported to `console.error`\n * and only `fatalError`s are thrown as a `ParseError`,\n * which prevents any further processing.\n * If the provided method throws, a `ParserError` is thrown,\n * which prevents any further processing.\n *\n * Be aware that many `warning`s are considered an error that prevents further processing in\n * most implementations.\n * @property {boolean} [locator=true]\n * Configures if the nodes created during parsing will have a `lineNumber` and a `columnNumber`\n * attribute describing their location in the XML string.\n * Default is true.\n * @property {(string) => string} [normalizeLineEndings]\n * used to replace line endings before parsing, defaults to exported `normalizeLineEndings`,\n * which normalizes line endings according to <https://www.w3.org/TR/xml11/#sec-line-ends>,\n * including some Unicode \"newline\" characters.\n * @property {Object} [xmlns]\n * The XML namespaces that should be assumed when parsing.\n * The default namespace can be provided by the key that is the empty string.\n * When the `mimeType` for HTML, XHTML or SVG are passed to `parseFromString`,\n * the default namespace that will be used,\n * will be overridden according to the specification.\n * @see {@link normalizeLineEndings}\n */\n\n/**\n * The DOMParser interface provides the ability to parse XML or HTML source code from a string\n * into a DOM `Document`.\n *\n * ***xmldom is different from the spec in that it allows an `options` parameter,\n * to control the behavior***.\n *\n * @class\n * @param {DOMParserOptions} [options]\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-parsing-and-serialization\n */\nfunction DOMParser(options) {\n\toptions = options || {};\n\tif (options.locator === undefined) {\n\t\toptions.locator = true;\n\t}\n\n\t/**\n\t * The method to use instead of `conventions.assign`, which is used to copy values from\n\t * `options`\n\t * before they are used for parsing.\n\t *\n\t * @type {conventions.assign}\n\t * @private\n\t * @see {@link conventions.assign}\n\t * @readonly\n\t */\n\tthis.assign = options.assign || conventions.assign;\n\n\t/**\n\t * For internal testing: The class for creating an instance for handling events from the SAX\n\t * parser.\n\t * *****Warning: By configuring a faulty implementation, the specified behavior can completely\n\t * be broken*****.\n\t *\n\t * @type {typeof DOMHandler}\n\t * @private\n\t * @readonly\n\t */\n\tthis.domHandler = options.domHandler || DOMHandler;\n\n\t/**\n\t * A function that is invoked for every error that occurs during parsing.\n\t *\n\t * If it is not provided, all errors are reported to `console.error`\n\t * and only `fatalError`s are thrown as a `ParseError`,\n\t * which prevents any further processing.\n\t * If the provided method throws, a `ParserError` is thrown,\n\t * which prevents any further processing.\n\t *\n\t * Be aware that many `warning`s are considered an error that prevents further processing in\n\t * most implementations.\n\t *\n\t * @type {function(level:ErrorLevel, message:string, context: DOMHandler):void}\n\t * @see {@link onErrorStopParsing}\n\t * @see {@link onWarningStopParsing}\n\t */\n\tthis.onError = options.onError || options.errorHandler;\n\tif (options.errorHandler && typeof options.errorHandler !== 'function') {\n\t\tthrow new TypeError('errorHandler object is no longer supported, switch to onError!');\n\t} else if (options.errorHandler) {\n\t\toptions.errorHandler('warning', 'The `errorHandler` option has been deprecated, use `onError` instead!', this);\n\t}\n\n\t/**\n\t * used to replace line endings before parsing, defaults to `normalizeLineEndings`\n\t *\n\t * @type {(string) => string}\n\t * @readonly\n\t */\n\tthis.normalizeLineEndings = options.normalizeLineEndings || normalizeLineEndings;\n\n\t/**\n\t * Configures if the nodes created during parsing will have a `lineNumber` and a\n\t * `columnNumber`\n\t * attribute describing their location in the XML string.\n\t * Default is true.\n\t *\n\t * @type {boolean}\n\t * @readonly\n\t */\n\tthis.locator = !!options.locator;\n\n\t/**\n\t * The default namespace can be provided by the key that is the empty string.\n\t * When the `mimeType` for HTML, XHTML or SVG are passed to `parseFromString`,\n\t * the default namespace that will be used,\n\t * will be overridden according to the specification.\n\t *\n\t * @type {Readonly<Object>}\n\t * @readonly\n\t */\n\tthis.xmlns = this.assign(Object.create(null), options.xmlns);\n}\n\n/**\n * Parses `source` using the options in the way configured by the `DOMParserOptions` of `this`\n * `DOMParser`. If `mimeType` is `text/html` an HTML `Document` is created,\n * otherwise an XML `Document` is created.\n *\n * __It behaves different from the description in the living standard__:\n * - Uses the `options` passed to the `DOMParser` constructor to modify the behavior.\n * - Any unexpected input is reported to `onError` with either a `warning`,\n * `error` or `fatalError` level.\n * - Any `fatalError` throws a `ParseError` which prevents further processing.\n * - Any error thrown by `onError` is converted to a `ParseError` which prevents further\n * processing - If no `Document` was created during parsing it is reported as a `fatalError`.\n * *****Warning: By configuring a faulty DOMHandler implementation,\n * the specified behavior can completely be broken*****.\n *\n * @param {string} source\n * The XML mime type only allows string input!\n * @param {string} [mimeType='application/xml']\n * the mimeType or contentType of the document to be created determines the `type` of document\n * created (XML or HTML)\n * @returns {Document}\n * The `Document` node.\n * @throws {ParseError}\n * for any `fatalError` or anything that is thrown by `onError`\n * @throws {TypeError}\n * for any invalid `mimeType`\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString\n * @see https://html.spec.whatwg.org/#dom-domparser-parsefromstring-dev\n */\nDOMParser.prototype.parseFromString = function (source, mimeType) {\n\tif (!isValidMimeType(mimeType)) {\n\t\tthrow new TypeError('DOMParser.parseFromString: the provided mimeType \"' + mimeType + '\" is not valid.');\n\t}\n\tvar defaultNSMap = this.assign(Object.create(null), this.xmlns);\n\tvar entityMap = entities.XML_ENTITIES;\n\tvar defaultNamespace = defaultNSMap[''] || null;\n\tif (hasDefaultHTMLNamespace(mimeType)) {\n\t\tentityMap = entities.HTML_ENTITIES;\n\t\tdefaultNamespace = NAMESPACE.HTML;\n\t} else if (mimeType === MIME_TYPE.XML_SVG_IMAGE) {\n\t\tdefaultNamespace = NAMESPACE.SVG;\n\t}\n\tdefaultNSMap[''] = defaultNamespace;\n\tdefaultNSMap.xml = defaultNSMap.xml || NAMESPACE.XML;\n\n\tvar domBuilder = new this.domHandler({\n\t\tmimeType: mimeType,\n\t\tdefaultNamespace: defaultNamespace,\n\t\tonError: this.onError,\n\t});\n\tvar locator = this.locator ? {} : undefined;\n\tif (this.locator) {\n\t\tdomBuilder.setDocumentLocator(locator);\n\t}\n\n\tvar sax = new XMLReader();\n\tsax.errorHandler = domBuilder;\n\tsax.domBuilder = domBuilder;\n\tvar isXml = !conventions.isHTMLMimeType(mimeType);\n\tif (isXml && typeof source !== 'string') {\n\t\tsax.errorHandler.fatalError('source is not a string');\n\t}\n\tsax.parse(this.normalizeLineEndings(String(source)), defaultNSMap, entityMap);\n\tif (!domBuilder.doc.documentElement) {\n\t\tsax.errorHandler.fatalError('missing root element');\n\t}\n\treturn domBuilder.doc;\n};\n\n/**\n * @typedef DOMHandlerOptions\n * @property {string} [mimeType=MIME_TYPE.XML_APPLICATION]\n * @property {string | null} [defaultNamespace=null]\n */\n/**\n * The class that is used to handle events from the SAX parser to create the related DOM\n * elements.\n *\n * Some methods are only implemented as an empty function,\n * since they are (at least currently) not relevant for xmldom.\n *\n * @class\n * @param {DOMHandlerOptions} [options]\n * @see http://www.saxproject.org/apidoc/org/xml/sax/ext/DefaultHandler2.html\n */\nfunction DOMHandler(options) {\n\tvar opt = options || {};\n\t/**\n\t * The mime type is used to determine if the DOM handler will create an XML or HTML document.\n\t * Only if it is set to `text/html` it will create an HTML document.\n\t * It defaults to MIME_TYPE.XML_APPLICATION.\n\t *\n\t * @type {string}\n\t * @see {@link MIME_TYPE}\n\t * @readonly\n\t */\n\tthis.mimeType = opt.mimeType || MIME_TYPE.XML_APPLICATION;\n\n\t/**\n\t * The namespace to use to create an XML document.\n\t * For the following reasons this is required:\n\t * - The SAX API for `startDocument` doesn't offer any way to pass a namespace,\n\t * since at that point there is no way for the parser to know what the default namespace from\n\t * the document will be.\n\t * - When creating using `DOMImplementation.createDocument` it is required to pass a\n\t * namespace,\n\t * to determine the correct `Document.contentType`, which should match `this.mimeType`.\n\t * - When parsing an XML document with the `application/xhtml+xml` mimeType,\n\t * the HTML namespace needs to be the default namespace.\n\t *\n\t * @type {string | null}\n\t * @private\n\t * @readonly\n\t */\n\tthis.defaultNamespace = opt.defaultNamespace || null;\n\n\t/**\n\t * @type {boolean}\n\t * @private\n\t */\n\tthis.cdata = false;\n\n\t/**\n\t * The last `Element` that was created by `startElement`.\n\t * `endElement` sets it to the `currentElement.parentNode`.\n\t *\n\t * Note: The sax parser currently sets it to white space text nodes between tags.\n\t *\n\t * @type {Element | Node | undefined}\n\t * @private\n\t */\n\tthis.currentElement = undefined;\n\n\t/**\n\t * The Document that is created as part of `startDocument`,\n\t * and returned by `DOMParser.parseFromString`.\n\t *\n\t * @type {Document | undefined}\n\t * @readonly\n\t */\n\tthis.doc = undefined;\n\n\t/**\n\t * The locator is stored as part of setDocumentLocator.\n\t * It is controlled and mutated by the SAX parser to store the current parsing position.\n\t * It is used by DOMHandler to set `columnNumber` and `lineNumber`\n\t * on the DOM nodes.\n\t *\n\t * @type {Readonly<Locator> | undefined}\n\t * @private\n\t * @readonly (the\n\t * sax parser currently sometimes set's it)\n\t */\n\tthis.locator = undefined;\n\t/**\n\t * @type {function (level:ErrorLevel ,message:string, context:DOMHandler):void}\n\t * @readonly\n\t */\n\tthis.onError = opt.onError;\n}\n\nfunction position(locator, node) {\n\tnode.lineNumber = locator.lineNumber;\n\tnode.columnNumber = locator.columnNumber;\n}\n\nDOMHandler.prototype = {\n\t/**\n\t * Either creates an XML or an HTML document and stores it under `this.doc`.\n\t * If it is an XML document, `this.defaultNamespace` is used to create it,\n\t * and it will not contain any `childNodes`.\n\t * If it is an HTML document, it will be created without any `childNodes`.\n\t *\n\t * @see http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\n\t */\n\tstartDocument: function () {\n\t\tvar impl = new DOMImplementation();\n\t\tthis.doc = isHTMLMimeType(this.mimeType) ? impl.createHTMLDocument(false) : impl.createDocument(this.defaultNamespace, '');\n\t},\n\tstartElement: function (namespaceURI, localName, qName, attrs) {\n\t\tvar doc = this.doc;\n\t\tvar el = doc.createElementNS(namespaceURI, qName || localName);\n\t\tvar len = attrs.length;\n\t\tappendElement(this, el);\n\t\tthis.currentElement = el;\n\n\t\tthis.locator && position(this.locator, el);\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tvar namespaceURI = attrs.getURI(i);\n\t\t\tvar value = attrs.getValue(i);\n\t\t\tvar qName = attrs.getQName(i);\n\t\t\tvar attr = doc.createAttributeNS(namespaceURI, qName);\n\t\t\tthis.locator && position(attrs.getLocator(i), attr);\n\t\t\tattr.value = attr.nodeValue = value;\n\t\t\tel.setAttributeNode(attr);\n\t\t}\n\t},\n\tendElement: function (namespaceURI, localName, qName) {\n\t\tthis.currentElement = this.currentElement.parentNode;\n\t},\n\tstartPrefixMapping: function (prefix, uri) {},\n\tendPrefixMapping: function (prefix) {},\n\tprocessingInstruction: function (target, data) {\n\t\tvar ins = this.doc.createProcessingInstruction(target, data);\n\t\tthis.locator && position(this.locator, ins);\n\t\tappendElement(this, ins);\n\t},\n\tignorableWhitespace: function (ch, start, length) {},\n\tcharacters: function (chars, start, length) {\n\t\tchars = _toString.apply(this, arguments);\n\t\t//console.log(chars)\n\t\tif (chars) {\n\t\t\tif (this.cdata) {\n\t\t\t\tvar charNode = this.doc.createCDATASection(chars);\n\t\t\t} else {\n\t\t\t\tvar charNode = this.doc.createTextNode(chars);\n\t\t\t}\n\t\t\tif (this.currentElement) {\n\t\t\t\tthis.currentElement.appendChild(charNode);\n\t\t\t} else if (/^\\s*$/.test(chars)) {\n\t\t\t\tthis.doc.appendChild(charNode);\n\t\t\t\t//process xml\n\t\t\t}\n\t\t\tthis.locator && position(this.locator, charNode);\n\t\t}\n\t},\n\tskippedEntity: function (name) {},\n\tendDocument: function () {\n\t\tthis.doc.normalize();\n\t},\n\t/**\n\t * Stores the locator to be able to set the `columnNumber` and `lineNumber`\n\t * on the created DOM nodes.\n\t *\n\t * @param {Locator} locator\n\t */\n\tsetDocumentLocator: function (locator) {\n\t\tif (locator) {\n\t\t\tlocator.lineNumber = 0;\n\t\t}\n\t\tthis.locator = locator;\n\t},\n\t//LexicalHandler\n\tcomment: function (chars, start, length) {\n\t\tchars = _toString.apply(this, arguments);\n\t\tvar comm = this.doc.createComment(chars);\n\t\tthis.locator && position(this.locator, comm);\n\t\tappendElement(this, comm);\n\t},\n\n\tstartCDATA: function () {\n\t\t//used in characters() methods\n\t\tthis.cdata = true;\n\t},\n\tendCDATA: function () {\n\t\tthis.cdata = false;\n\t},\n\n\tstartDTD: function (name, publicId, systemId, internalSubset) {\n\t\tvar impl = this.doc.implementation;\n\t\tif (impl && impl.createDocumentType) {\n\t\t\tvar dt = impl.createDocumentType(name, publicId, systemId, internalSubset);\n\t\t\tthis.locator && position(this.locator, dt);\n\t\t\tappendElement(this, dt);\n\t\t\tthis.doc.doctype = dt;\n\t\t}\n\t},\n\treportError: function (level, message) {\n\t\tif (typeof this.onError === 'function') {\n\t\t\ttry {\n\t\t\t\tthis.onError(level, message, this);\n\t\t\t} catch (e) {\n\t\t\t\tthrow new ParseError('Reporting ' + level + ' \"' + message + '\" caused ' + e, this.locator);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.error('[xmldom ' + level + ']\\t' + message, _locator(this.locator));\n\t\t}\n\t},\n\t/**\n\t * @see http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\n\t */\n\twarning: function (message) {\n\t\tthis.reportError('warning', message);\n\t},\n\terror: function (message) {\n\t\tthis.reportError('error', message);\n\t},\n\t/**\n\t * This function reports a fatal error and throws a ParseError.\n\t *\n\t * @param {string} message\n\t * - The message to be used for reporting and throwing the error.\n\t * @returns {never}\n\t * This function always throws an error and never returns a value.\n\t * @throws {ParseError}\n\t * Always throws a ParseError with the provided message.\n\t */\n\tfatalError: function (message) {\n\t\tthis.reportError('fatalError', message);\n\t\tthrow new ParseError(message, this.locator);\n\t},\n};\n\nfunction _locator(l) {\n\tif (l) {\n\t\treturn '\\n@#[line:' + l.lineNumber + ',col:' + l.columnNumber + ']';\n\t}\n}\n\nfunction _toString(chars, start, length) {\n\tif (typeof chars == 'string') {\n\t\treturn chars.substr(start, length);\n\t} else {\n\t\t//java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\n\t\tif (chars.length >= start + length || start) {\n\t\t\treturn new java.lang.String(chars, start, length) + '';\n\t\t}\n\t\treturn chars;\n\t}\n}\n\n/*\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\n * used method of org.xml.sax.ext.LexicalHandler:\n *  #comment(chars, start, length)\n *  #startCDATA()\n *  #endCDATA()\n *  #startDTD(name, publicId, systemId)\n *\n *\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\n *  #endDTD()\n *  #startEntity(name)\n *  #endEntity(name)\n *\n *\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\n * IGNORED method of org.xml.sax.ext.DeclHandler\n * \t#attributeDecl(eName, aName, type, mode, value)\n *  #elementDecl(name, model)\n *  #externalEntityDecl(name, publicId, systemId)\n *  #internalEntityDecl(name, value)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\n * IGNORED method of org.xml.sax.EntityResolver2\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\n *  #resolveEntity(publicId, systemId)\n *  #getExternalSubset(name, baseURI)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\n * IGNORED method of org.xml.sax.DTDHandler\n *  #notationDecl(name, publicId, systemId) {};\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\n */\n'endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl'.replace(\n\t/\\w+/g,\n\tfunction (key) {\n\t\tDOMHandler.prototype[key] = function () {\n\t\t\treturn null;\n\t\t};\n\t}\n);\n\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\nfunction appendElement(handler, node) {\n\tif (!handler.currentElement) {\n\t\thandler.doc.appendChild(node);\n\t} else {\n\t\thandler.currentElement.appendChild(node);\n\t}\n}\n\n/**\n * A method that prevents any further parsing when an `error`\n * with level `error` is reported during parsing.\n *\n * @see {@link DOMParserOptions.onError}\n * @see {@link onWarningStopParsing}\n */\nfunction onErrorStopParsing(level) {\n\tif (level === 'error') throw 'onErrorStopParsing';\n}\n\n/**\n * A method that prevents any further parsing when any `error` is reported during parsing.\n *\n * @see {@link DOMParserOptions.onError}\n * @see {@link onErrorStopParsing}\n */\nfunction onWarningStopParsing() {\n\tthrow 'onWarningStopParsing';\n}\n\nexports.__DOMHandler = DOMHandler;\nexports.DOMParser = DOMParser;\nexports.normalizeLineEndings = normalizeLineEndings;\nexports.onErrorStopParsing = onErrorStopParsing;\nexports.onWarningStopParsing = onWarningStopParsing;\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.format.KML;","// import openlayers\nimport olKML from \"ol/format/KML\";\nimport {\n    Fill,\n    Icon,\n    Stroke,\n    Style,\n    Text,\n    Circle\n} from \"ol/style\";\n// import local\nimport Styling from \"./Styling\";\nimport Color from \"../Utils/ColorUtils\";\nimport Logger from \"../Utils/LoggerByDefault\";\nimport Parser from \"../Utils/Parser\";\nimport Utils from \"../Utils/Helper\";\n\nvar logger = Logger.getLogger(\"extended KML format\");\n\n/**\n * @classdesc\n *\n * Extended Styles KML format to export (internal use only !)\n *\n * INFO\n * only ol.Control is a user-extendable class.\n * Everything else requires integration with the original openlayers source and a new ol.js\n * to be built with your new classes incorporated.\n *\n * SPEC\n * cf. https://developers.google.com/kml/forum/advanced\n *\n * ISSUES\n * cf. https://github.com/openlayers/openlayers/issues/4829\n * cf. https://github.com/openlayers/openlayers/issues/4460\n * cf. https://github.com/openlayers/openlayers/pull/5590\n * cf. https://github.com/openlayers/openlayers/issues/5229\n * cf. https://github.com/openlayers/openlayers/issues/3371\n *\n * @constructor\n * @alias ol.format.KMLExtended\n * @type {ol.format.KMLExtended}\n * @extends {ol.format.KML}\n * @param {Object} options - Options\n * @param {Object} [options.extensions] - Add properties to file root\n */\nvar KML = class KML extends olKML {\n\n    /**\n     * See {@link ol.format.KMLExtended}\n     * @module KMLExtended\n     * @alias module:~formats/KMLExtended\n     * @param {*} options - options\n     * @example\n     * import KMLExtended from \"gpf-ext-ol/formats/KMLExtended\"\n     * ou \n     * import { KMLExtended } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        super(options);\n\n        if (!(this instanceof KML)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        options = options || {};\n\n        // INFO\n        // source DOM (Document ou Node)\n        this.source = null;\n\n        // INFO\n        // gestion des extensions\n        this.extensions = options.extensions || null;\n\n        // INFO\n        // defaultStyle est un tableau d'objet de type Style\n        if (options.defaultStyle && !Array.isArray(options.defaultStyle)) {\n            options.defaultStyle = [options.defaultStyle];\n        }\n\n        if (options.defaultStyle === null || typeof options.defaultStyle === \"undefined\") {\n            options.defaultStyle = [];\n        }\n\n        return this;\n    }\n\n    /**\n     *\n     * En lecture, on surcharge la méthode readFeatures.\n     * ✔️ In : kml string + features du format original\n     * ✔️ Out : features étendus avec des styles, et des metadatas (name ou extendData)\n     * > on modifie les features du format original avec les fonctionnalités non gérées.\n     *\n     * En écriture, on surcharge la méthode writeFearures.\n     * ✔️ In : kml du format original + features étendus\n     * ✔️ Out : kml étendu avec des styles, et des metadatas (name ou extendData)\n     * > on modifie le kml généré par le format original avec les fonctionnalités que nous avons ajoutées aux features.\n     *\n     * Le principe\n     * On parse le kml, et on lit (get) ou on ajoute (set) des fonctionnalités.\n     *\n     * Les getters vont lire le kml (ex. LabelExtendStyle), et ajouter le style ainsi que le nom du label dans le feature original.\n     * getLabelIconStyle (appel des 2 fonctions suivantes)\n     * getLabelExtendStyle (New)\n     * getHotSpotIconStyle (Bug sur la lecture du  hotspot)\n     * getExtendData (New)\n     *\n     * Les setters vont écrire dans le dom du kml original les fonctionnalités ajoutées dans les features.\n     * setLabelExtendStyle (New)\n     * setHotSpotIconStyle (Bug sur l'écriture du hotspot)\n     * setNameData (Bug suppression de cette balise du format par défaut).\n     *\n     */\n\n    /**\n     * Fonction de lecture du KML avec fonction de traitement en fonction du type\n     * PlaceMark (Label ou Marker).\n     * Les traitements sont de 2 types :\n     *  - creation de styles étendus ou correctifs sur le KML\n     *  - ajout de styles étendus sur les features\n     *\n     * @param {DOMElement} kmlNode - kml nodes\n     * @param {Object[]} features - features\n     * @param {Object} process - process\n     *\n     * @example\n     * // ajoute des fonctionnalités dans le KML\n     * _processKml(kmlDoc, {\n     *   labelStyle : createStyleLabel,\n     *   iconStyle  : createStyleIcon\n     * });\n     *\n     * // lit des fonctionnalités du KML non impl. par OpenLayers\n     * _processKml(kmlNode, {\n     *   labelStyle : getStyleToFeatureLabel,\n     *   iconStyle  : getStyleToFeatureIcon,\n     *   extendedData : getExtendedData\n     * });\n     */\n    _processKml (kmlNode, features, process) {\n        var firstNodeLevel = (kmlNode.nodeName === \"#document\") ? kmlNode.childNodes[0].childNodes : kmlNode.childNodes;\n\n        // Si le DOM contient un seul objet, le noeud est directement un PlaceMark\n        // sinon, c'est un ensemble de noeuds PlaceMark contenus dans le noeud Document.\n        var nodes = firstNodeLevel;\n        for (var ik = 0; ik < firstNodeLevel.length; ik++) {\n            const element = firstNodeLevel[ik];\n            if (element.nodeName === \"Document\") {\n                nodes = element.childNodes;\n                break;\n            }\n            if (element.nodeName === \"Placemark\") {\n                nodes = [element];\n                break;\n            }\n        }\n\n        // On recherche les PlaceMark de type Point ayant un Style...\n        // Le style peut être placé directement dans le PlaceMark\n        // ou lié avec un id (share)\n        var stylesUrl = {}; // listes des styles\n        var index = -1; // index du features...\n        for (var i = 0; i < nodes.length; i++) {\n            var node = nodes[i];\n            switch (node.nodeName) {\n                case \"Style\":\n                    // INFO\n                    // pour le traitement des balises Styles liées avec styleUrl,\n                    // elles doivent être toujours déclarées avant les PlaceMark !\n                    // On ne prend en compte que celles qui sont identifiées via un ID !\n                    var id = node.attributes[0];\n                    if (id && id.nodeName === \"id\") {\n                        var _k = id.nodeValue;\n                        var _v = node;\n                        stylesUrl[_k] = _v;\n                    }\n                    break;\n\n                case \"Placemark\":\n\n                    index++;\n                    var types = node.childNodes; // Point, LineString, Polygon, Style, ...\n                    var point = false;\n                    var line = false;\n                    var poly = false;\n                    var domStyles = null; // dom\n                    var hdlDomStyle = null; // dom\n                    var domExtendedData = null; // dom\n                    var domNameTag = node; // dom\n                    for (var j = 0; j < types.length; j++) {\n                        switch (types[j].nodeName) {\n                            case \"Polygon\":\n                                poly = true;\n                                break;\n                            case \"LineString\":\n                                line = true;\n                                break;\n                            case \"Point\":\n                                point = true;\n                                break;\n                            case \"Style\":\n                                hdlDomStyle = types[j];\n                                domStyles = types[j].childNodes; // liste de styles\n                                break;\n                            case \"styleUrl\":\n                                // style avec lien vers...\n                                var _idStyle = types[j].textContent.slice(1);\n                                if (stylesUrl[_idStyle]) {\n                                    domStyles = stylesUrl[_idStyle].childNodes;\n                                }\n                                break;\n                            case \"ExtendedData\":\n                                domExtendedData = types[j].childNodes;\n                                break;\n                            case \"name\":\n                                domNameTag = null;\n                                break;\n                            default:\n                                // on ne traite pas les autres informations ...\n                                // car elles seront gérées par defaut par le format standard...\n                        }\n                    }\n\n                    // On traite les balises kml:extendedData pour tous les objets !\n                    if (domExtendedData) {\n                        logger.log(\"ExtendedData :\", domExtendedData);\n                        var fctExtend = process.extendedData;\n                        if (fctExtend && typeof fctExtend === \"function\") {\n                            fctExtend(features[index], domExtendedData);\n                        }\n                    }\n\n                    // On traite la balise kml:name\n                    if (domNameTag) {\n                        logger.log(\"Name :\", domNameTag);\n                        var fctName = process.nameData;\n                        if (fctName && typeof fctName === \"function\") {\n                            fctName(features[index], domNameTag);\n                        }\n                    }\n\n                    // On a un Marker avec un Style.\n                    // Il peut être associé avec un Label !\n                    // Les markers sans styles ne doivent pas être gérées par les styles par defaut\n                    // car le KML met en place une punaise google !\n                    if (point && domStyles && domStyles.length !== 0) {\n                        var labelStyleDom = null;\n                        var iconStyleDom = null;\n                        // On recherche le type de Style\n                        for (var k = 0; k < domStyles.length; k++) {\n                            switch (domStyles[k].nodeName) {\n                                case \"LabelStyle\":\n                                    labelStyleDom = domStyles[k];\n                                    break;\n                                case \"IconStyle\":\n                                    iconStyleDom = domStyles[k];\n                                    break;\n                                default:\n                                    // on ne traite pas les autres informations ...\n                            }\n                        }\n\n                        // Pour un label, il nous faut un titre !\n                        var labelName = features[index].getProperties().name;\n                        var labelDescription = features[index].getProperties().description;\n                        var value = labelName || labelDescription;\n                        logger.trace(value);\n\n                        // C'est uniquement un Label !\n                        if (!iconStyleDom && labelStyleDom) {\n                            var fctLabel = process.labelStyle;\n                            if (fctLabel && typeof fctLabel === \"function\") {\n                                fctLabel(features[index], labelStyleDom);\n                            }\n                        // C'est uniquement un marker !\n                        } else if (iconStyleDom && !labelStyleDom) {\n                            var fctIcon = process.iconStyle;\n                            if (fctIcon && typeof fctIcon === \"function\") {\n                                fctIcon(features[index], iconStyleDom);\n                            }\n                        // C'est un marker avec un label !\n                        } else if (iconStyleDom && labelStyleDom) {\n                            var fctIconLabel = process.iconLabelStyle;\n                            if (fctIconLabel && typeof fctIconLabel === \"function\") {\n                                fctIconLabel(features[index], iconStyleDom, labelStyleDom);\n                            }\n                        } else {\n                            // ...\n                        }\n                    } else {\n                        var feature = features[index];\n                        var style = feature.getStyle();\n                        if (style && typeof style === \"function\") {\n                            var fstyles = style.call(this, feature, 0);\n                            if (fstyles && fstyles.length !== 0) {\n                                style = fstyles[0];\n                            }\n                        }\n\n                        if (poly) {\n                            var fctPoly = process.polygonStyle;\n                            if (fctPoly && typeof fctPoly === \"function\") {\n                                fctPoly(features[index], domStyles);\n                            }\n                        }\n\n                        if (line) {\n                            var fctLine = process.lineStringStyle;\n                            if (fctLine && typeof fctLine === \"function\") {\n                                fctLine(features[index], domStyles);\n                            }\n                        }\n\n                        // INFO\n                        // On est sur un Point mais sans style dans le DOM.\n                        // On regarde le style dans le Feature : Icon ou Circle ?\n                        if (point && style) {\n                            var image = style.getImage();\n                            if (image && image instanceof Circle) {\n                                var fctCircle = process.circleStyle;\n                                if (fctCircle && typeof fctCircle === \"function\") {\n                                    fctCircle(features[index], hdlDomStyle);\n                                }\n                            } else if (image && image instanceof Icon) {\n                                var fctPoint = process.pointStyle;\n                                if (fctPoint && typeof fctPoint === \"function\") {\n                                    fctPoint(features[index], hdlDomStyle);\n                                }\n                            } else {\n                                // ...\n                            }\n                        }\n                    }\n                    break;\n                default:\n                    logger.trace(\"tag is not processing !\");\n            }\n        }\n    }\n\n    /**\n     * Write Extend for Features.\n     * This function overloads ol.format.KML.writeFeatures ...\n     *\n     * @see ol.format.KML.prototype.writeFeatures\n     * @param {Object[]} features - Features.\n     * @param {Object} options - Options.\n     *\n     * @return {String} kml string formatted\n     */\n    writeFeatures (features, options) {\n        logger.log(\"overload : ol.format.KML.writeFeatures\");\n        var kmlNode = super.writeFeaturesNode(features, options);\n        if (kmlNode === null) {\n            return null;\n        }\n\n        // on ajoute les extensions à la racine pour les metadonnées de calcul\n        if (this.hasOwnProperty(\"extensions\")) {\n            this._writeRootExtensions(kmlNode, this.extensions);\n        }\n\n        // On ajoute les styles étendus\n        var kmlStringExtended = this._writeExtendStylesFeatures(kmlNode, features, options);\n\n        // On realise un formattage du KML\n        var kmlStringFormatted = Parser.format(kmlStringExtended);\n        if (kmlStringFormatted === \"\") {\n            return null;\n        }\n\n        return kmlStringFormatted;\n    };\n\n    /**\n     * Write Extended Styles for each features\n     *\n     * @param {DOMElement} kmlNode - kml nodes\n     * @param {Object[]} features - features\n     * @param {Object} options - options\n     *\n     * @returns {String} kml string extended\n     *\n     * @private\n     */\n    _writeExtendStylesFeatures (kmlNode, features, options) {\n        // RGB Colors (RRGGBB) To KML Colors (AABBGGRR)\n        function __convertRGBColorsToKML (data, opacity) {\n            var strColor = data.toString(16);\n\n            if (strColor.charAt(0) === \"#\") {\n                strColor = strColor.slice(1);\n            }\n\n            opacity = opacity || 1;\n            opacity = parseInt(opacity * 255, 10);\n            opacity = opacity.toString(16);\n            var color = opacity;\n            color = color + strColor.substr(4, 2);\n            color = color + strColor.substr(2, 2);\n            color = color + strColor.substr(0, 2);\n            return color.toLowerCase();\n        }\n\n        /**\n         * C'est un Label !\n         * On va donc y ajouter qq styles sur le Label (police, halo, ...) :\n         * Insertion : PlaceMark>Style>LabelStyle\n         *\n         * @param {Object} feature - feature\n         * @param {DOMElement} node - node\n         *\n         * @example\n         *      <LabelStyleSimpleExtensionGroup fontFamily=\"Arial\" haloColor=\"16777215\" haloRadius=\"2\" haloOpacity=\"1\"/>\n         */\n        var __createExtendedStyleLabel = function (feature, node) {\n            logger.trace(\"label with style :\", node);\n\n            if (!feature) {\n                return;\n            }\n\n            // Si pas de style defini, c'est donc que l'on va utiliser celui par defaut...\n            if (feature.getStyle() instanceof Style) {\n                var textStyle = feature.getStyle().getText();\n                if (!textStyle) {\n                    return;\n                }\n\n                var _fontFamily = \"Sans\";\n                var _fontSize = \"16px\";\n                var _font = textStyle.getFont();\n                if (_font) {\n                    var splits = _font.split(\" \", 2);\n                    _fontSize = splits[0];\n                    _fontFamily = splits[1];\n                }\n\n                var strokeTextStyle = feature.getStyle().getText().getStroke();\n                if (!strokeTextStyle) {\n                    return;\n                }\n                if (strokeTextStyle instanceof Stroke) {\n                    var _haloColor = __convertRGBColorsToKML(\"#FFFFFF\"); // Par defaut\n                    var color = strokeTextStyle.getColor();\n                    // array ?\n                    if (Array.isArray(color)) {\n                        var cf = \"rgba(\";\n                        cf += color[0] + \",\";\n                        cf += color[1] + \",\";\n                        cf += color[2] + \",\";\n                        cf += color[3] + \")\";\n                        color = cf;\n                    }\n                    if (Color.isRGB(color)) {\n                        var colorHex = Color.rgbaToHex(color);\n                        _haloColor = __convertRGBColorsToKML(colorHex.hex, colorHex.opacity);\n                    } else {\n                        _haloColor = __convertRGBColorsToKML(color);\n                    }\n                    var _haloRadius = strokeTextStyle.getWidth() || \"0\";\n                    var _haloOpacity = \"1\"; // TODO lire param\n\n                    if (node && node.getElementsByTagName(\"LabelStyleSimpleExtensionGroup\").length === 0) {\n                        var labelExtended = document.createElementNS(kmlNode.namespaceURI, \"LabelStyleSimpleExtensionGroup\");\n                        labelExtended.setAttribute(\"fontSize\", _fontSize);\n                        labelExtended.setAttribute(\"fontFamily\", _fontFamily);\n                        labelExtended.setAttribute(\"haloColor\", _haloColor);\n                        labelExtended.setAttribute(\"haloRadius\", _haloRadius);\n                        labelExtended.setAttribute(\"haloOpacity\", _haloOpacity);\n                        node.appendChild(labelExtended);\n                    }\n                }\n\n                var fImageStyle = feature.getStyle().getImage();\n                if (!fImageStyle) {\n                    return;\n                }\n                if (fImageStyle instanceof Circle) {\n                    var strokeColor = null;\n                    var strokeWidth = null;\n                    if (fImageStyle.getStroke()) {\n                        strokeWidth = fImageStyle.getStroke().getWidth();\n                        strokeColor = fImageStyle.getStroke().getColor();\n                        // array ?\n                        if (Array.isArray(strokeColor)) {\n                            var cfs = \"rgba(\";\n                            cfs += strokeColor[0] + \",\";\n                            cfs += strokeColor[1] + \",\";\n                            cfs += strokeColor[2] + \",\";\n                            cfs += strokeColor[3] + \")\";\n                            strokeColor = cfs;\n                        }\n                        if (Color.isRGB(strokeColor)) {\n                            var strokeColorHex = Color.rgbaToHex(strokeColor);\n                            strokeColor = __convertRGBColorsToKML(strokeColorHex.hex, strokeColorHex.opacity);\n                        } else {\n                            strokeColor = __convertRGBColorsToKML(strokeColor);\n                        }\n                    }\n\n                    var fillColor = null;\n                    if (fImageStyle.getFill()) {\n                        fillColor = fImageStyle.getFill().getColor();\n                        // array ?\n                        if (Array.isArray(fillColor)) {\n                            var cff = \"rgba(\";\n                            cff += fillColor[0] + \",\";\n                            cff += fillColor[1] + \",\";\n                            cff += fillColor[2] + \",\";\n                            cff += fillColor[3] + \")\";\n                            fillColor = cff;\n                        }\n                        if (Color.isRGB(fillColor)) {\n                            var fillColorHex = Color.rgbaToHex(fillColor);\n                            fillColor = __convertRGBColorsToKML(fillColorHex.hex, fillColorHex.opacity);\n                        } else {\n                            fillColor = __convertRGBColorsToKML(fillColor);\n                        }\n                    }\n\n                    if (node && node.getElementsByTagName(\"ObjectSimpleExtensionGroup\").length === 0) {\n                        var iconExtended = document.createElementNS(kmlNode.namespaceURI, \"ObjectSimpleExtensionGroup\");\n                        iconExtended.setAttribute(\"type\", \"circle\"); // FIXME type circle only !\n                        iconExtended.setAttribute(\"radius\", fImageStyle.getRadius());\n                        iconExtended.setAttribute(\"fillColor\", fillColor);\n                        iconExtended.setAttribute(\"strokeColor\", strokeColor);\n                        iconExtended.setAttribute(\"strokeWidth\", strokeWidth);\n                        node.appendChild(iconExtended);\n                    }\n                }\n            }\n        };\n\n        /**\n         * C'est un marker !\n         * On va donc ajouter la balise hotspot :\n         *  Traiter le cas où les unités sont de type\n         *   - FRACTION\n         *   - PIXELS\n         *  Insertion du correctif dans le noeud : <PlaceMark><Style>IconStyle\n         *\n         * @param {Object} feature - ol feature\n         * @param {DOMElement} node - node\n         *\n         *  @example\n         *  <Style><IconStyle>\n         *      <hotSpot x=\"0.5\"  y=\"1\" xunits=\"fraction\" yunits=\"fraction\"/>\n         *  </IconStyle></Style>\n         */\n        var __createExtendedStyleIcon = function (feature, node) {\n            logger.trace(\"marker with style (hotspot):\", node);\n\n            if (!feature) {\n                return;\n            }\n\n            // Si pas de style defini, c'est donc que l'on va utiliser celui par defaut...\n            if (feature.getStyle() instanceof Style) {\n                var fImageStyle = feature.getStyle().getImage();\n\n                if (!fImageStyle) {\n                    return;\n                }\n\n                if (fImageStyle instanceof Icon) {\n                    var x = 0;\n                    var y = 0;\n                    var xunits = \"pixels\";\n                    var yunits = \"pixels\";\n\n                    var size = fImageStyle.getSize();\n                    var anchor = fImageStyle.getAnchor(); // pixels ! but anchor_ in the current unit !\n\n                    if (anchor.length) {\n                        x = anchor[0];\n                        y = anchor[1];\n                        if (yunits === \"fraction\") {\n                            y = (y === 1) ? 0 : 1 - y; // cf. fixme contribution à faire !\n                        } else {\n                            y = (yunits === \"pixels\" && y === size[1]) ? 0 : size[1] - y; // cf. fixme contribution à faire !\n                        }\n                    }\n\n                    if (node && node.getElementsByTagName(\"hotSpot\").length === 0) {\n                        var hotspot = document.createElementNS(kmlNode.namespaceURI, \"hotSpot\");\n                        hotspot.setAttribute(\"x\", x);\n                        hotspot.setAttribute(\"y\", y);\n                        hotspot.setAttribute(\"xunits\", xunits);\n                        hotspot.setAttribute(\"yunits\", yunits);\n                        node.appendChild(hotspot);\n                    }\n                }\n            }\n        };\n\n        /**\n         * ...\n         * @param {*} feature - feature\n         * @param {DOMElement} node - node\n         */\n        var __createExtendedStyleToCircle = function (feature, node) {\n            if (!feature) {\n                return;\n            }\n\n            // Si pas de style defini, c'est donc que l'on va utiliser celui par defaut...\n            if (feature.getStyle() instanceof Style) {\n                var fImageStyle = feature.getStyle().getImage();\n                if (!fImageStyle) {\n                    return;\n                }\n                if (fImageStyle instanceof Circle) {\n                    var strokeColor = null;\n                    var strokeWidth = null;\n                    if (fImageStyle.getStroke()) {\n                        strokeWidth = fImageStyle.getStroke().getWidth();\n                        strokeColor = fImageStyle.getStroke().getColor();\n                        // array ?\n                        if (Array.isArray(strokeColor)) {\n                            var cf = \"rgba(\";\n                            cf += strokeColor[0] + \",\";\n                            cf += strokeColor[1] + \",\";\n                            cf += strokeColor[2] + \",\";\n                            cf += strokeColor[3] + \")\";\n                            strokeColor = cf;\n                        }\n                        if (Color.isRGB(strokeColor)) {\n                            var colorHex = Color.rgbaToHex(strokeColor);\n                            strokeColor = __convertRGBColorsToKML(colorHex.hex, colorHex.opacity);\n                        } else {\n                            strokeColor = __convertRGBColorsToKML(strokeColor);\n                        }\n                    }\n\n                    var fillColor = null;\n                    if (fImageStyle.getFill()) {\n                        fillColor = fImageStyle.getFill().getColor();\n                        // array ?\n                        if (Array.isArray(fillColor)) {\n                            var cfi = \"rgba(\";\n                            cfi += fillColor[0] + \",\";\n                            cfi += fillColor[1] + \",\";\n                            cfi += fillColor[2] + \",\";\n                            cfi += fillColor[3] + \")\";\n                            fillColor = cfi;\n                        }\n                        if (Color.isRGB(fillColor)) {\n                            var fillColorImgHex = Color.rgbaToHex(fillColor);\n                            fillColor = __convertRGBColorsToKML(fillColorImgHex.hex, fillColorImgHex.opacity);\n                        } else {\n                            fillColor = __convertRGBColorsToKML(fillColor);\n                        }\n                    }\n\n                    if (node && node.getElementsByTagName(\"ObjectSimpleExtensionGroup\").length === 0) {\n                        var labelStyle = document.createElementNS(kmlNode.namespaceURI, \"LabelStyle\");\n                        var circleExtended = document.createElementNS(kmlNode.namespaceURI, \"ObjectSimpleExtensionGroup\");\n                        circleExtended.setAttribute(\"type\", \"circle\"); // FIXME type circle only !\n                        circleExtended.setAttribute(\"radius\", fImageStyle.getRadius());\n                        circleExtended.setAttribute(\"fillColor\", fillColor);\n                        circleExtended.setAttribute(\"strokeColor\", strokeColor);\n                        circleExtended.setAttribute(\"strokeWidth\", strokeWidth);\n                        labelStyle.appendChild(circleExtended);\n                        node.appendChild(labelStyle);\n                    }\n                }\n            }\n        };\n\n        /**\n         * ...\n         * @param {*} feature - feature\n         * @param {DOMElement} node - node\n         */\n        var __createExtendedStyleToPoint = function (feature, node) {};\n\n        // TODO\n        var __createExtendedStyleToIconLabel = function (feature, nodeIconStyle, nodeLabelStyle) {\n            logger.trace(\"write an icon with a label\");\n            __createExtendedStyleIcon(feature, nodeIconStyle);\n            __createExtendedStyleLabel(feature, nodeLabelStyle);\n        };\n\n        // TODO\n        var __setNameData = function (feature, tags) {\n            for (var i = 0; i < tags.length; i++) {\n                var tag = tags[i];\n                if (tag.nodeName === \"name\") {\n                    return;\n                }\n            }\n\n            var labelName = feature.getProperties().name;\n            if (labelName) {\n                var name = document.createElement(\"name\");\n                name.innerHTML = labelName;\n                tags.appendChild(name);\n            }\n        };\n\n        // TODO\n        var _setExtendedDataStyle = function (feature, node) {\n            if (node && node.length) {\n                var removeNodes = [];\n                for (var k = 0; k < node.length; k++) {\n                    const element = node[k];\n                    if (element.nodeName === \"Data\") {\n                        var key = element.getAttribute(\"name\");\n                        if (Styling.getListTags().includes(key)) {\n                            removeNodes.push(element);\n                        }\n                    }\n                }\n                if (removeNodes && removeNodes.length) {\n                    removeNodes.forEach(e => {\n                        e.remove();\n                    });\n                }\n            }\n        };\n\n        // On ajoute les styles étendus dans le DOM\n        this._processKml(kmlNode, features, {\n            labelStyle : __createExtendedStyleLabel,\n            iconStyle : __createExtendedStyleIcon,\n            iconLabelStyle : __createExtendedStyleToIconLabel,\n            circleStyle : __createExtendedStyleToCircle,\n            pointStyle : __createExtendedStyleToPoint,\n            nameData : __setNameData,\n            extendedData : _setExtendedDataStyle\n        });\n\n        // On convertit le DOM en String...\n        var kmlStringExtended = Parser.toString(kmlNode);\n        if (!kmlStringExtended) {\n            return null;\n        }\n\n        return kmlStringExtended;\n    };\n\n    /**\n     * ...\n     *\n     * @param {*} kmlNode - ...\n     * @param {*} extensions - ...\n     */\n    _writeRootExtensions (kmlNode, extensions) {\n        var extendDataElement = document.createElementNS(kmlNode.namespaceURI, \"ExtendedData\");\n        // on boucle sur toutes les clefs\n        for (const key in extensions) {\n            if (Object.hasOwnProperty.call(extensions, key)) {\n                const value = extensions[key];\n                var dataElement = document.createElementNS(kmlNode.namespaceURI, \"Data\");\n                dataElement.setAttribute(\"name\", key);\n                var data = document.createTextNode(JSON.stringify(value));\n                dataElement.appendChild(data);\n                extendDataElement.appendChild(dataElement);\n            }\n        }\n        // insertion en 1ere place !\n        var firstChild = kmlNode.firstChild;\n        kmlNode.insertBefore(extendDataElement, firstChild);\n    }\n\n    /**\n     * Read Extend for Features.\n     * This function overloads ol.format.KML.readFeatures ...\n     *\n     * @see ol.format.KML.prototype.readFeatures\n     * @param {Document|Node} source - Source.\n     * @param {olx.format.ReadOptions=} options - options.\n     * @return {Array.<ol.Feature>} Features.\n     */\n    readFeatures (source, options) {\n        logger.log(\"overload : ol.format.KML.readFeatures\");\n\n        // String ou Dom\n        if (typeof source === \"string\") {\n            this.source = Parser.parse(source);\n        } else if (source !== null) {\n            this.source = source;\n        }\n\n        var features = this._readExtendStylesFeatures(source, options);\n        logger.trace(\"Styles étendus\", features);\n\n        // On met à jour les attributs de style dans les features\n        features.forEach(feature => {\n            Styling.definePropertiesFromStyle(feature);\n        });\n\n        return features;\n    };\n\n    /**\n     * Read Extended Styles for each features\n     *\n     * @param {(Document|Node|ArrayBuffer|Object|String)} source - source\n     * @param {olx.format.ReadOptions=} options - options\n     *\n     * @returns {Object[]} features\n     *\n     * @private\n     */\n    _readExtendStylesFeatures (source, options) {\n        var features = super.readFeatures(source, options);\n\n        var kmlDoc = null;\n        var kmlString = \"\";\n\n        if (typeof source === \"string\") {\n            kmlString = source;\n        } else {\n            kmlString = source.documentElement.outerHTML;\n        }\n\n        // On 'deformatte' le KML afin d'eviter des pb de parsing...\n        kmlString = kmlString.replace(/\\n/g, \"\");\n        kmlString = kmlString.replace(/(>)\\s*(<)/g, \"$1$2\");\n\n        // On met en place un Parser sur le KML\n        kmlDoc = Parser.parse(kmlString);\n\n        if (kmlDoc === null) {\n            // au cas où...\n            return features;\n        }\n\n        // KML Colors (AABBGGRR) To RGB Colors (RRGGBB)\n        function __convertKMLColorsToRGB (data) {\n            var color = \"\";\n            color = color + data.substr(6, 2);\n            color = color + data.substr(4, 2);\n            color = color + data.substr(2, 2);\n            var hex = parseInt(color, 16).toString(16);\n            var comp = \"\";\n            var len = hex.length || 0;\n            for (var i = 0; i < (6 - len); i++) {\n                comp += \"0\";\n            }\n            hex = \"#\" + comp + hex;\n            return hex;\n        }\n\n        /**\n         * Gestion des styles étendus sur le Label\n         *\n         * @param {Object} feature - ol feature\n         * @param {DOMElement} node - node\n         *\n         * @example\n         * <Placemark>\n         *  <description>Un label</description>\n         *  <name>C'est un label étendu !</name>\n         *  <Style>\n         *    <IconStyle>\n         *      <Icon>\n         *        <href>data:image/png;base64,...</href>\n         *      </Icon>\n         *    </IconStyle>\n         *    <LabelStyle>\n         *      <color>ffffffff</color>\n         *      <colorMode>normal</colorMode>\n         *      <scale>1.85</scale>\n         *      <LabelStyleSimpleExtensionGroup haloColor=\"16711680\" haloRadius=\"5\" haloOpacity=\"1\"/>\n         *    </LabelStyle>\n         *  </Style>\n         *  <Point>\n         *    <coordinates>2,48</coordinates>\n         *  </Point>\n         * </Placemark>\n         */\n        var __getExtendedStyleToFeatureLabel = function (feature, node) {\n            logger.trace(\"label with style :\", node);\n\n            if (!feature) {\n                return;\n            }\n\n            // label\n            var _text = feature.getProperties().name;\n            var _color = __convertKMLColorsToRGB(\"ff000000\"); // \"#000000\"\n            var _colorHalo = \"#FFFFFF\";\n            var _radiusHalo = 0;\n            // var _opacityHalo = 1; // TODO\n            var _font = \"Sans\";\n            var _fontSize = \"16px\";\n\n            // cercle\n            var _circleType = null;\n            var _circleRadius = 5;\n            var _circleFillColor = \"#000000\";\n            var _circleStrokeColor = \"#ffffff\";\n            var _circleStrokeWidth = 1;\n\n            // On recherche les balises du Style\n            var bLabelStyleSimpleExtensionGroup = false;\n            var bObjectSimpleExtensionGroup = false;\n            var nodeStyles = node.childNodes;\n            for (var k = 0; k < nodeStyles.length; k++) {\n                switch (nodeStyles[k].nodeName) {\n                    case \"scale\":\n                        // TODO\n                        break;\n                    case \"colorMode\":\n                        // TODO\n                        break;\n                    case \"color\":\n                        _color = __convertKMLColorsToRGB(nodeStyles[k].textContent);\n                        break;\n                    case \"LabelStyleSimpleExtensionGroup\":\n                        bLabelStyleSimpleExtensionGroup = true;\n                        var attributs = nodeStyles[k].attributes;\n                        for (var l = 0; l < attributs.length; l++) {\n                            switch (attributs[l].nodeName) {\n                                case \"fontFamily\":\n                                    _font = attributs[l].nodeValue;\n                                    break;\n                                case \"fontSize\":\n                                    _fontSize = attributs[l].nodeValue;\n                                    break;\n                                case \"haloColor\":\n                                    _colorHalo = __convertKMLColorsToRGB(attributs[l].nodeValue);\n                                    break;\n                                case \"haloRadius\":\n                                    _radiusHalo = parseInt(attributs[l].nodeValue, 10);\n                                    break;\n                                case \"haloOpacity\":\n                                    // _opacityHalo = parseFloat(attributs[l].nodeValue);\n                                    // TODO opacité !\n                                    // if (_opacityHalo !== 1) {\n                                    //     _colorHalo = Color.hexToRgba(_colorHalo, _opacityHalo);\n                                    // }\n                                    break;\n                                default:\n                            }\n                        }\n                        break;\n                    case \"ObjectSimpleExtensionGroup\":\n                        bObjectSimpleExtensionGroup = true;\n                        var attributsExt = nodeStyles[k].attributes;\n                        for (var ll = 0; ll < attributsExt.length; ll++) {\n                            // type=\"circle\" radius=\"15\" fillColor=\"7f3737a0\" strokeColor=\"cc000000\" strokeWidth=\"2\"\n                            switch (attributsExt[ll].nodeName) {\n                                case \"type\":\n                                    _circleType = attributsExt[ll].nodeValue;\n                                    break;\n                                case \"radius\":\n                                    _circleRadius = parseInt(attributsExt[ll].nodeValue, 10);\n                                    break;\n                                case \"fillColor\":\n                                    var fillColorValue = attributsExt[ll].nodeValue;\n                                    var fillOpacity = Math.round((Color.num(fillColorValue.substr(0, 2)) / 255) * 10) / 10;\n                                    var fillColorHexa = __convertKMLColorsToRGB(fillColorValue);\n                                    _circleFillColor = Color.hexToRgba(fillColorHexa, fillOpacity);\n                                    break;\n                                case \"strokeColor\":\n                                    var strokeColorValue = attributsExt[ll].nodeValue;\n                                    var strokeOpacity = Math.round((Color.num(strokeColorValue.substr(0, 2)) / 255) * 10) / 10;\n                                    var strokeColorHexa = __convertKMLColorsToRGB(strokeColorValue);\n                                    _circleStrokeColor = Color.hexToRgba(strokeColorHexa, strokeOpacity);\n                                    break;\n                                case \"strokeWidth\":\n                                    _circleStrokeWidth = parseInt(attributsExt[ll].nodeValue, 10);\n                                    break;\n                                default:\n                            }\n                        }\n                        break;\n                    default:\n                        // on ne traite pas les autres informations ...\n                }\n            }\n\n            var StyleInstance = null;\n            if (bObjectSimpleExtensionGroup && _circleType === \"circle\") {\n                StyleInstance = new Circle({\n                    radius : _circleRadius,\n                    fill : new Fill({\n                        color : _circleFillColor\n                    }),\n                    stroke : new Stroke({\n                        color : _circleStrokeColor,\n                        width : _circleStrokeWidth\n                    })\n                });\n            } else if (bLabelStyleSimpleExtensionGroup) {\n                // INFO\n                // on ajoute une image magique 1x1 pixel invisible\n                // afin d'eviter l'affichage d'une punaise google !\n                StyleInstance = new Icon({\n                    src : \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=\",\n                    size : [51, 38],\n                    anchor : [25.5, 38],\n                    anchorOrigin : \"top-left\",\n                    anchorXUnits : \"pixels\",\n                    anchorYUnits : \"pixels\"\n                });\n            } else {\n                // ...\n            }\n            // On reconstruit le style !\n            feature.setStyle(new Style({\n                image : StyleInstance,\n                text : new Text({\n                    font : _fontSize + \" \" + _font,\n                    textAlign : \"left\",\n                    text : _text,\n                    // offsetX : 5, // FIXME valeur arbitraire MAIS esthétique !\n                    fill : new Fill({\n                        color : _color\n                    }),\n                    stroke : new Stroke({\n                        color : _colorHalo,\n                        width : _radiusHalo\n                    })\n                })\n            }));\n        };\n\n        /**\n         * Gestion des styles étendus sur un Marker\n         *\n         * > correctif sur la balise kml:hostSpot\n         * - problème avec 'hotspot y === 0' (?)\n         *\n         * @param {Object} feature - ol feature\n         * @param {DOMElement} node - node\n         *\n         * @example\n         * <Placemark>\n         *   <Style>\n         *     <IconStyle>\n         *       <Icon>\n         *         <href>data:image/png;base64,...</href>\n         *       </Icon>\n         *       <hotSpot x=\"25.5\" y=\"0\" xunits=\"pixels\" yunits=\"pixels\"/>\n         *     </IconStyle>\n         *   </Style>\n         *   <Point>\n         *     <coordinates>2,48</coordinates>\n         *   </Point>\n         * </Placemark>\n         */\n        var __getExtendedStyleToFeatureIcon = function (feature, node) {\n            logger.trace(\"hotspot :\", node);\n\n            // marker\n            var _src = null;\n            var _scale = null;\n            var _color = __convertKMLColorsToRGB(\"ffffffff\");\n\n            var _bSizeIcon = false;\n            var _sizeW = 51;\n            var _sizeH = 38;\n\n            var _bHotSpot = false;\n            var _anchorX = 25.5;\n            var _anchorXUnits = \"pixels\";\n            var _anchorY = 38;\n            var _anchorYUnits = \"pixels\";\n\n            var nodeStyles = node.childNodes;\n            var bIconStyle = false;\n            for (var k = 0; k < nodeStyles.length; k++) {\n                switch (nodeStyles[k].nodeName) {\n                    case \"Icon\":\n                        bIconStyle = true;\n                        var nodes = nodeStyles[k].childNodes;\n                        for (var i = 0; i < nodes.length; i++) {\n                            switch (nodes[i].nodeName) {\n                                case \"href\":\n                                    _src = nodes[i].textContent;\n                                    break;\n                                case \"gx:w\":\n                                    _bSizeIcon = true;\n                                    _sizeW = parseFloat(nodes[i].textContent);\n                                    break;\n                                case \"gx:h\":\n                                    _bSizeIcon = true;\n                                    _sizeH = parseFloat(nodes[i].textContent);\n                                    break;\n                                default:\n                            }\n                        }\n                        break;\n                    case \"hotSpot\":\n                        _bHotSpot = true;\n                        var attributs = nodeStyles[k].attributes;\n                        for (var l = 0; l < attributs.length; l++) {\n                            switch (attributs[l].nodeName) {\n                                case \"x\":\n                                    _anchorX = parseFloat(attributs[l].nodeValue);\n                                    break;\n                                case \"y\":\n                                    _anchorY = parseFloat(attributs[l].nodeValue);\n                                    break;\n                                case \"yunits\":\n                                    _anchorXUnits = attributs[l].nodeValue;\n                                    break;\n                                case \"xunits\":\n                                    _anchorYUnits = attributs[l].nodeValue;\n                                    break;\n                                default:\n                            }\n                        }\n                        break;\n                    case \"scale\":\n                        _scale = parseFloat(nodeStyles[k].textContent);\n                        break;\n                    case \"color\":\n                        _color = __convertKMLColorsToRGB(nodeStyles[k].textContent);\n                        break;\n                    default:\n                        // on ne traite pas les autres informations ...\n                }\n            }\n\n            var StyleInstance = null;\n            if (bIconStyle) {\n                // une image magique 1x1 pixel invisible\n                var optionsIcon = {\n                    src : _src || \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=\",\n                    color : _color,\n                    crossOrigin : \"anonymous\", // cf. https://gis.stackexchange.com/questions/121555/wms-server-with-cors-enabled/147403#147403\n                    scale : _scale || 1\n                };\n\n                if (_bSizeIcon) {\n                    Utils.mergeParams(optionsIcon, {\n                        size : [_sizeW, _sizeH]\n                    });\n                }\n\n                if (_bHotSpot) {\n                    Utils.mergeParams(optionsIcon, {\n                        anchor : [_anchorX, _anchorY],\n                        anchorOrigin : \"bottom-left\",\n                        anchorXUnits : _anchorXUnits || \"pixels\",\n                        anchorYUnits : _anchorYUnits || \"pixels\"\n                    });\n                }\n\n                StyleInstance = new Icon(optionsIcon);\n            }\n\n            // existe il déjà le style du label ?\n            var featureStyleFunction = feature.getStyleFunction();\n            if (featureStyleFunction) {\n                var _styles = featureStyleFunction(feature, 0);\n                if (_styles && !Array.isArray(_styles)) {\n                    _styles = [_styles];\n                }\n                if (_styles && _styles.length !== 0) {\n                    var _style = (_styles.length === 1) ? _styles[0] : _styles[_styles.length - 1];\n                    // on écrase l'icone magic du label !\n                    feature.setStyle(new Style({\n                        image : StyleInstance,\n                        text : _style.getText()\n                    }));\n                }\n            }\n        };\n\n        /**\n         * Gestion de la balise kml:ExtendedData\n         *\n         * @param {Object} feature - ol feature\n         * @param {DOMElement[]} extend - extend\n         *\n         * @example\n         * //--> Marker (Point), LineString, Polygon\n         * <ExtendedData>\n         *    <Data name=\"attributetitle\">\n         *        <displayName>title</displayName>\n         *        <value>Titre à concatener avec la valeur de la balise \"kml:description\"</value>\n         *    </Data>\n         * </ExtendedData>\n         * //--> Label\n         * <ExtendedData>\n         *    <Data name=\"label\">\n         *        <value>PARIS</value> // valeur à remplacer dans \"kml:name\"\n         *    </Data>\n         *    <Data name=\"attributetitle\">\n         *        <displayName>title</displayName>\n         *        <value>Titre à concatener avec la valeur de la balise \"kml:description\"</value>\n         *    </Data>\n         * </ExtendedData>\n         */\n        var __getExtendedData = function (feature, extend) {\n            logger.trace(\"extendData :\", extend);\n\n            if (!feature) {\n                return;\n            }\n\n            var props = {};\n\n            var _fname = feature.get(\"name\") || \"\";\n            var _fdescription = feature.get(\"description\") || \"\";\n            var _ftitle = null;\n            for (var i = 0; i < extend.length; i++) {\n                var data = extend[i];\n                var name = data.attributes[0]; // 1 seul attribut !\n                var nodes = data.childNodes;\n                if (name.nodeName === \"name\") {\n                    switch (name.nodeValue) {\n                        // compatibilité ancien geoportail !\n                        case \"label\":\n                            _fname = data.textContent;\n                            props.name = _fname;\n                            break;\n                        // compatibilité ancien geoportail !\n                        case \"title\":\n                        case \"attributetitle\":\n                            for (var j = 0; j < nodes.length; j++) {\n                                if (nodes[j].nodeName === \"value\") {\n                                    _ftitle = nodes[j].textContent;\n                                }\n                            }\n                            break;\n                        default:\n                            props[name.nodeValue] = data.textContent;\n                            break;\n                    }\n                }\n            }\n\n            // Modification des properties \"name\" et \"description\"\n            if (_ftitle) {\n                _fdescription = (_fdescription) ? _ftitle + \" : \" + _fdescription : _ftitle;\n                props.description = _fdescription;\n            }\n\n            if (Object.keys(props).length) {\n                feature.setProperties(props, true);\n            }\n        };\n\n        /**\n         * TODO\n         * ...\n         *\n         * @param {Object} feature - ol feature\n         * @param {DOMElement} nodeIconStyle - icon style\n         * @param {DOMElement} nodeLabelStyle - label style\n         * @example\n         * ...\n         */\n        var __getExtendedStyleToFeatureIconLabel = function (feature, nodeIconStyle, nodeLabelStyle) {\n            logger.trace(\"display icon and label\");\n            __getExtendedStyleToFeatureLabel(feature, nodeLabelStyle);\n            __getExtendedStyleToFeatureIcon(feature, nodeIconStyle);\n        };\n\n        // TODO...\n        var __getStyleToDefaultFeature = function (feature, node) {};\n\n        // On lit les styles étendus et on les ajoute aux features\n        this._processKml(kmlDoc, features, {\n            lineStringStyle : __getStyleToDefaultFeature,\n            polygonStyle : __getStyleToDefaultFeature,\n            pointStyle : __getStyleToDefaultFeature,\n            labelStyle : this.showPointNames_ ? __getExtendedStyleToFeatureLabel : null,\n            iconStyle : __getExtendedStyleToFeatureIcon,\n            iconLabelStyle : this.showPointNames_ ? __getExtendedStyleToFeatureIconLabel : __getExtendedStyleToFeatureIcon,\n            extendedData : __getExtendedData\n        });\n\n        return features;\n    };\n\n    /**\n     * ...\n     * @param {*} key ...\n     * @returns {Object} json\n     */\n    readRootExtensions (key) {\n        var value = {};\n        // Rechercher le tag avec la clef : geoportail:compute\n        // <ExtendedData>\n        //   <Data name=\"geoportail:compute\">{...}</Data>\n        // </ExtendedData>\n        var firstNodeLevelKml = (this.source.nodeName === \"#document\") ? this.source.childNodes[0] : this.source;\n        var childNodesLevel = firstNodeLevelKml.childNodes;\n        for (var i = 0; i < childNodesLevel.length; i++) {\n            var node1 = childNodesLevel[i];\n            if (node1.nodeName === \"ExtendedData\") {\n                var childNodesExtended = node1.childNodes;\n                for (var j = 0; j < childNodesExtended.length; j++) {\n                    var node2 = childNodesExtended[j];\n                    if (node2.nodeName === \"Data\") {\n                        var name = node2.attributes[0];\n                        if (name && name.nodeName === \"name\") {\n                            if (name.nodeValue === key) {\n                                value = JSON.parse(node2.textContent);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return value;\n    }\n\n};\n\nexport default KML;\n\n// Expose KML as ol.source.KMLExtended. (for a build bundle)\nif (window.ol && window.ol.format) {\n    window.ol.format.KMLExtended = KML;\n}\n","import * as Log from \"loglevel\";\n\n/**\n * @module LoggerByDefault\n * @alias module:~utils/Logger\n * @description\n * ...\n *\n * @example\n * import Logger from \"gpf-ext-ol/utils/LoggerByDefault\"\n * ou \n * import {Logger} from \"gpf-ext-ol\n * \n * Logger.getLogger();\n * Logger.disableAll();\n * Logger.enableAll();\n */\nvar LoggerByDefault = {\n    /**\n     * creation d'un logger statique\n     *\n     * @function getLogger\n     * @param {String} [name=\"default\"] - the logger name\n     * @returns {Object} logger\n     */\n    getLogger : function (name) {\n        // on définit process si non défini dans l'environnement\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    },\n    /**\n     * desactive tous les loggers\n     * @function disableAll\n     */\n    disableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.disableAll();\n            }\n        }\n    },\n    /**\n     * active tous les loggers\n     * @function enableAll\n     */\n    enableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.enableAll();\n            }\n        }\n    }\n};\n\nexport default LoggerByDefault;\n\n// Expose Export as ol.control.Catalog (for a build bundle)\nif (window.Gp) {\n    window.Gp.Logger = LoggerByDefault;\n}\n","\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport _ from \"../../../Utils/MessagesResources\";\nimport RouteParamREST from \"./model/RouteParamREST\";\n\n/**\n * @classdesc\n * Classe de gestion des requêtes de type REST sur le service de calcul d'itineraire\n * (uniquement en GET)\n *\n * @constructor\n * @alias Gp.Services.Route.Request.RouteRequestREST\n * @param {Object} options - options definies dans le composant Route\n *\n * @example\n * var options = {\n *      (...)\n * };\n *\n * @private\n */\nfunction RouteRequestREST (options) {\n    this.logger = Logger.getLogger(\"RouteRequestREST\");\n    this.logger.trace(\"[Constructeur RouteRequestREST ()]\");\n\n    if (!(this instanceof RouteRequestREST)) {\n        throw new TypeError(\"RouteRequestREST constructor cannot be called as a function.\");\n    }\n\n    // existance des options\n    if (!options) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    /** liste des options */\n    this.settings = options;\n}\n\nRouteRequestREST.prototype = {\n\n    /**\n     * @lends module:RouteRequestREST#\n     */\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RouteRequestREST,\n\n    /**\n     * Construction de la requête.\n     *\n     * @example\n     * // GET  out : origin=2.416907353809513,48.8465772142297&destination=2.4248037771493673,48.84591353161838\n     * // POST out : Not yet supported method POST !\n     * @returns {String} request\n     */\n    processRequestString : function () {\n        // INFO\n        // construction simple sans template...,\n        // mais en attendant que les services soient fixés, on taggue ce composant en mode PROTOTYPE !\n        this.logger.warn(\" PROTOTYPE !\");\n\n        // Mapping des options avec le service de l'API REST\n        var oParams = new RouteParamREST(this.settings);\n        var params = oParams.getParams();\n\n        var request = \"\";\n        for (var i = 0; i < params.length; i++) {\n            var o = params[i];\n            if (request) {\n                request += \"&\";\n            }\n            request += o.k + \"=\" + o.v;\n        }\n\n        // Exemple :\n        //  http://wxs.ign.fr/KEY/itineraire/rest/route.json?\n        //  origin=&\n        //  destination=&\n        //  waypoints=&\n        //  method=DISTANCE&\n        //  graph=Pieton&\n        //  graphName=Pieton&\n        //  exclusions=&\n        //  tolerance=10&\n        //  srs=\n\n        this.logger.trace(request);\n        this.requestString = request;\n\n        return this.requestString;\n    }\n};\n\nexport default RouteRequestREST;\n","/**\n * Response object for {@link module:Services~autoComplete Gp.Services.autoComplete ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.AutoComplete.SuggestedLocation>} suggestedLocations - SuggestedLocations array.\n *\n * @namespace\n * @alias Gp.Services.AutoCompleteResponse\n */\nfunction AutoCompleteResponse () {\n    if (!(this instanceof AutoCompleteResponse)) {\n        throw new TypeError(\"AutoCompleteResponse constructor cannot be called as a function.\");\n    }\n\n    this.suggestedLocations = [];\n}\n\nAutoCompleteResponse.prototype = {\n\n    constructor : AutoCompleteResponse\n\n};\n\nexport default AutoCompleteResponse;\n","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\nimport AltiRequest from \"./AltiRequest\";\n\n/**\n * @classdesc\n *\n * Classe de gestion des param. des requêtes de type POINT du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiElevationRequest\n * @param {Object} options - options\n * @param {Boolean}  options.zonly - false|true\n *\n * @private\n */\nfunction AltiElevationRequest (options) {\n    if (!(this instanceof AltiElevationRequest)) {\n        throw new TypeError(\"AltiElevationRequest constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"AltiElevationRequest\";\n\n    // appel du constructeur par heritage\n    AltiRequest.apply(this, arguments);\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur AltiElevationRequest ()]\");\n\n    /**\n     * Z uniquement.\n     * true|false\n     */\n    this.zonly = this.options.zonly || false; // test des options héritées !\n}\n\n/**\n * @lends module:AltiElevationRequest#\n */\n\nAltiElevationRequest.prototype = Object.create(AltiRequest.prototype, {\n\n    /**\n     * Setter/getter pour \"zonly\"\n     */\n    zonly : {\n        /** getter */\n        get : function () {\n            return this._zonly;\n        },\n        /** setter */\n        set : function (z) {\n            this._zonly = z;\n        }\n    }\n\n});\n\n/**\n * Constructeur (alias)\n */\nAltiElevationRequest.prototype.constructor = AltiElevationRequest;\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Array}\n */\nAltiElevationRequest.prototype.getData = function () {\n    // par glop..., appel de AltiRequest::getData () !\n    var map = [];\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    // map.push({k : \"delimiter\", v : this.delimiter}); // FIXME on retire le param \"delimiter\"\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"zonly\",\n        v : this.zonly\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n    map.push({\n        k : \"resource\",\n        v : this.resource\n    });\n\n    return map;\n};\n\nexport default AltiElevationRequest;\n","\n/**\n * Single location object returned by the underlying geocoding web service.\n *\n * @property {Gp.Point} position - Position of the location given in the requested coordinates system.\n * @property {String} type - location type \"StreetAddress\" (for an address), \"PositionOfInterest\" (for a place name) or \"CadastralParcel\" (for cadastral parcel).\n * @property {String} matchType - how geocoding is performed : \"street number\" (exact address), \"street enhanced\" (street number calculated by interpolation), \"street\" (only the street), \"city\" (only the city).\n * @property {Float} accuracy - Accuracy of the response towards the requested location between 0 (unaccurate) and 1 (exact match).\n * @property {Object} placeAttributes - Associative array matching the following attributes with their values given by the underlying web service :\n *\n * *Common attributes : *\n *\n * - **trueGeometry** - the 'real life' geometry if different from 'Point' type.\n *\n * *if type === \"StreetAddress\" :*\n *\n * - **number** - Street number.\n * - **postalCode** - PostCode\n * - **street** - Street name\n * - **city** - City\n * - **houseNumberInfos** - additional street number information\n * - **inseeCode** - INSEE Code\n *\n *\n * *if type === \"PositionOfInterest\" :*\n *\n * - **type** - Place name type\n * - **postalCode** - PostCode\n * - **toponyme** - Toponyme\n * - **extraFields** - additional place name properties\n * - **inseeCode** - INSEE Code\n *\n *\n * *si type = \"CadastralParcel\" :*\n *\n * - **codeCommuneAbs** - when a parcel comes from a city that was absorbed by another, code of that old city. \"000\" otherwise.\n * - **codeArrondissement** - arrondissement\n * - **identifiant** - cadastral parcel code\n * - **feuille** - Parcel Sheet (eg. \"1\").\n * - **numero** - Parcel Number (eg. \"0041\")\n * - **section** - Parcel Section (eg. \"0D\").\n * - **nomCommune** - Parcel municipality name.\n * - **codeCommune** - Parcel municipality.\n * - **codeDepartement** - Parcel Department.\n *\n * @namespace\n * @alias Gp.Services.Geocode.GeocodedLocation\n */\nfunction GeocodedLocation () {\n    if (!(this instanceof GeocodedLocation)) {\n        throw new TypeError(\"GeocodedLocation constructor cannot be called as a function.\");\n    }\n\n    this.position = null;\n\n    this.matchType = null;\n\n    this.placeAttributes = {};\n\n    this.type = null;\n\n    this.accuracy = null;\n\n    /**\n     * Nom de la classe : \"GeocodedLocation\"\n     * @type {String}\n     */\n    this.CLASSNAME = \"GeocodedLocation\";\n}\n\nGeocodedLocation.prototype = {\n\n    constructor : GeocodedLocation\n\n};\n\nexport default GeocodedLocation;\n","import Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport GeocodeRequestFactory from \"./Request/GeocodeRequestFactory\";\nimport GeocodeResponseFactory from \"./Response/GeocodeResponseFactory\";\n\n/**\n * @classdesc\n * Appel du service de géocodage inverse du Géoportail :\n *     envoi de la requête construite selon les paramètres en options,\n *     éventuellement parsing et analyse  de la réponse,\n *     retour d'une réponse en paramètre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.ReverseGeocode\n *\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {Object} options.position - Position du point de référence pour le calcul de proximité exprimée dans le système de référence spécifié par le srs.\n *      @param {Float} options.position.lon - Longitude du point de référence pour le calcul de proximité.\n *      @param {Float} options.position.lat - Latitude du point de référence pour le calcul de proximité.\n *\n * @param {Object} [options.filters] - Les propriétés possibles de cet objet.\n * @param {String} [options.filters.[proprietes du filtre]] - Critère supplémentaire pour filtrer la recherche sous la forme\n *      d'un couple clé/valeur à définir selon les possibilités du serveur ajouté à la requête.\n *      Le service de géocodage du Géoportail permet de filtrer les adresses postales avec les propriétés :\n *          \"postalCode\", \"inseeCode\", \"city\".\n *      Il permet également de filtrer les toponymes avec les propriétés :\n *          \"postalCode\", \"inseeCode\", \"type\".\n *      Enfin, il permet de filtrer les parcelles cadastrales avec les propriétés :\n *          \"codeDepartement\", \"codeCommune\", \"nomCommune\", \"codeCommuneAbs\", \"codeArrondissement\", \"section\", \"numero\", \"feuille\".\n *\n * @param {Object} [options.searchGeometry] - Emprise dans laquelle on souhaite effectuer la recherche.\n *      Les propriétés possibles de cet objet sont décrites ci-après.\n *      @param {String} options.searchGeometry.type   - Type de géometrie (Point|Circle|Linestring|Polygon)\n *      @param {Array.<Float>|Array.Array.<Float>} options.searchGeometry.coordinates - Coordonnées des points constituant la géométrie.\n *      @param {Float} options.searchGeometry.radius    - Rayon. Paramètre applicable uniquement pour le type 'Circle'.\n *\n * @param {String} [options.index = \"StreetAddress\"] - Type de l'objet recherché.\n *      Le service de géocodage du Géoportail permet de rechercher des 'PositionOfInterest' pour des toponymes, des 'StreetAddress'\n *      pour des adresses postales ou des 'CadastralParcel' pour des parcelles cadastrales. L'index 'location' permet une recherche\n *      multi-indexes en regroupant les indexes 'PositionOfInterest' et 'StreetAddress'.\n *      D'autres types pourront être rajoutés selon l'évolution du service.\n *      Par défaut, index = 'StreetAddress'.\n *\n * @param {Number} [options.maximumResponses] - Nombre de réponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par défaut. Si le serveur consulté est celui du Géoportail, la valeur par défaut sera donc celle du service : 20s.\n *\n * @param {Boolean} [options.returnTrueGeometry] - Booléen indiquant si l'on souhaite récupérer la géométrie vraie des objects géolocalisés.\n *      false par défaut.\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      proxyURL : null,\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      index : 'StreetAddress',\n *      searchGeometry : {\n *          type : Circle,\n *          coordinates : [48, 2],\n *          radius : 100\n *      },\n *      position : {lon:2 , lat:48.5},\n *      maximumResponses : 25,\n *   };\n *\n */\nfunction ReverseGeocode (options_) {\n    if (!(this instanceof ReverseGeocode)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"ReverseGeocode\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"ReverseGeocode\";\n\n    this.logger = Logger.getLogger(\"Gp.Services.ReverseGeocode\");\n    this.logger.trace(\"[Constructeur ReverseGeocode (options)]\");\n\n    var options = this.patchOptionConvertor(options_);\n    if (!options.serverUrl) {\n        options.serverUrl = DefaultUrlService.ReverseGeocode.newUrl();\n    }\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, [options]);\n\n    if (!options.searchGeometry) {\n        if (!options.position) {\n            throw new Error(_.getMessage(\"PARAM_MISSING\", \"searchGeometry\"));\n        }\n    } else {\n        this.options.searchGeometry = options.searchGeometry;\n    }\n\n    // on definit l'index par defaut\n    if (!options.index) {\n        this.options.index = options.index = \"StreetAddress\";\n    }\n\n    if (options.filters) {\n        var filter = Object.keys(options.filters);\n        for (var i = 0; i < filter.length; i++) {\n            var key = filter[i];\n            // on supprime les filtres vides\n            if (typeof options.filters[key] === \"undefined\" ||\n                (typeof options.filters[key] === \"object\" && Object.keys(options.filters[key]).length === 0) ||\n                (typeof options.filters[key] === \"string\" && options.filters[key].length === 0) ||\n                (Array.isArray(options.filters[key]) && options.filters[key].length === 0)\n            ) {\n                delete this.options.filters[key];\n            }\n        }\n    }\n\n    this.options.position = options.position;\n    this.options.index = options.index || \"StreetAddress\";\n    this.options.maximumResponses = options.maximumResponses || 20;\n}\n\n/**\n * @lends module:ReverseGeocode#\n */\nReverseGeocode.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nReverseGeocode.prototype.constructor = ReverseGeocode;\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Object} options_ - options du service\n * @return {Object} - options\n */\nReverseGeocode.prototype.patchOptionConvertor = function (options_) {\n    var options = options_;\n\n    if (options.filterOptions) {\n        this.logger.warn(\"The parameter 'filterOptions' is deprecated\");\n\n        if (options.filterOptions.type) {\n            this.logger.warn(\"The parameter 'filterOptions.type' is deprecated\");\n            if (!options.index) {\n                if (Array.isArray(options.filterOptions.type) && options.filterOptions.type.length > 0) {\n                    options.index = options.filterOptions.type[0];\n                } else {\n                    options.index = options.filterOptions.type;\n                }\n            }\n            delete options.filterOptions.type;\n        }\n\n        if (options.filterOptions.bbox) {\n            this.logger.warn(\"The parameter 'filterOptions.bbox' is deprecated\");\n            if (!options.searchGeometry) {\n                // convertir la geometrie\n                options.searchGeometry = this.bbox2Json(options.filterOptions.bbox);\n            }\n            delete options.filterOptions.bbox;\n        }\n\n        if (options.filterOptions.circle) {\n            this.logger.warn(\"The parameter 'filterOptions.circle' is deprecated\");\n            if (!options.searchGeometry) {\n                // convertir la geometrie\n                options.searchGeometry = this.circle2Json(options.filterOptions.circle);\n            }\n            delete options.filterOptions.circle;\n        }\n\n        if (options.filterOptions.polygon) {\n            this.logger.warn(\"The parameter 'filterOptions.polygon' is deprecated\");\n            if (!options.searchGeometry) {\n                // convertir la geometrie\n                options.searchGeometry = this.polygon2Json(options.filterOptions.polygon);\n            }\n            delete options.filterOptions.polygon;\n        }\n\n        if (!options.filters && Object.keys(options.filterOptions).length > 0) {\n            options.filters = options.filterOptions;\n        }\n\n        delete options.filterOptions;\n    }\n\n    if (options.position) {\n        if (options.position.x) {\n            this.logger.warn(\"The parameter 'position.x' is deprecated\");\n\n            if (!options.position.lon) {\n                options.position.lon = options.position.x;\n            }\n            delete options.position.x;\n        }\n\n        if (options.position.y) {\n            this.logger.warn(\"The parameter 'position.y' is deprecated\");\n\n            if (!options.position.lat) {\n                options.position.lat = options.position.y;\n            }\n            delete options.position.y;\n        }\n    }\n\n    if (options.srs) {\n        this.logger.warn(\"The parameter 'srs' is deprecated\");\n        delete options.srs;\n    }\n\n    return options;\n};\n\n/**\n * (overwrite)\n * Création de la requête\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nReverseGeocode.prototype.buildRequest = function (error, success) {\n    var options = {\n        httpMethod : this.options.httpMethod,\n        // options specifiques du service\n        geocodeMethod : \"reverse\",\n        searchGeometry : this.options.searchGeometry,\n        index : this.options.index,\n        position : this.options.position,\n        returnTrueGeometry : this.options.returnTrueGeometry,\n        maxResp : this.options.maximumResponses,\n        filters : this.options.filters\n    };\n\n    this.request = GeocodeRequestFactory.build(options);\n\n    // on teste si la requete a bien été construite !\n    (!this.request)\n        ? error.call(this, new ErrorService(_.getMessage(\"SERVICE_REQUEST_BUILD\")))\n        : success.call(this, this.request);\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nReverseGeocode.prototype.analyzeResponse = function (error, success) {\n    if (this.response) {\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        GeocodeResponseFactory.build(options);\n    } else {\n        error.call(this, new ErrorService(_.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Array} bbox - bbox\n * @return {Object} - geometrie au format json\n */\nReverseGeocode.prototype.bbox2Json = function (bbox) {\n    return {\n        type : \"Polygon\",\n        coordinates : [[\n            [bbox.left, bbox.top],\n            [bbox.right, bbox.top],\n            [bbox.right, bbox.bottom],\n            [bbox.left, bbox.bottom],\n            [bbox.left, bbox.top]\n        ]]\n    };\n};\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Object} circle - circle\n * @return {Object} - geometrie au format json\n */\nReverseGeocode.prototype.circle2Json = function (circle) {\n    return {\n        type : \"Circle\",\n        radius : circle.radius,\n        coordinates : [circle.x, circle.y]\n    };\n};\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Array} polygon - polygon\n * @return {Object} - geometrie au format json\n */\nReverseGeocode.prototype.polygon2Json = function (polygon) {\n    var jsonGeom = {\n        type : \"Polygon\",\n        coordinates : [[]]\n    };\n\n    for (var i = 0; i < polygon.length; ++i) {\n        jsonGeom.coordinates[0].push([polygon[i].x, polygon[i].y]);\n    }\n\n    return jsonGeom;\n};\n\n/**\n * Codes EPSG géographiques (lat/lon). Utiles car les coordonnées doivent être inversées.\n */\nReverseGeocode.geoEPSG = [\"EPSG:4326\"];\n\nexport default ReverseGeocode;\n","module.exports = ol.source.WMTS;","import Logger from \"./LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"draggable\");\n\n/**\n * @module Draggable\n * @alias module:~utils/Draggable\n * @fixme conflit entre la position et le mode draggable\n * @private\n * @description\n * ...\n *\n * @example\n * dragElement();\n */\nvar Draggable = {\n    /**\n    * A draggable HTML element with JavaScript and CSS.\n    *\n    * @function dragElement\n    * @param {DOMElement} element - element\n    * @param {DOMElement} header - header (optional)\n    * @param {DOMElement} container - container (optional)\n    * @see https://gist.github.com/stephanbogner/75de4e84687ae6065fb0a4d81917543e\n    * @see https://stackoverflow.com/questions/48097791/how-to-keep-a-draggable-element-from-being-moved-outside-a-boundary\n    * @example\n    *   // CSS :\n    *       // #element { position: absolute; }\n    *   // HTML :\n    *       // <div id=\"container\">\n    *       //   <div id=\"element\">\n    *       //     <div id=\"header\"/>\n    *       //      <div/> ...\n    *       //     </div>\n    *       //   </div>\n    *       // </div>\n    *   // JS :\n    *       var element = document.getElementById(\"element\");\n    *       Draggable.dragElement(element, header, container);\n    */\n    dragElement : function (element, header, container) {\n        // Adapted from https://www.w3schools.com/howto/howto_js_draggable.asp\n        let dragStartMouseX = 0, dragStartMouseY = 0, diffX = 0, diffY = 0, positionX = 0, positionY = 0;\n        if (header) {\n            header.addEventListener(\"mousedown\", dragMouseDown, true);\n        } else {\n            element.addEventListener(\"mousedown\", dragMouseDown, true);\n        }\n        var rect;\n        var viewport = {\n            bottom : 0,\n            left : 0,\n            right : 0,\n            top : 0,\n        };\n\n        function dragMouseDown (e) {\n            e = e || window.event;\n            e.preventDefault();\n\n            dragStartMouseX = e.clientX;\n            dragStartMouseY = e.clientY;\n\n            rect = element.getBoundingClientRect();\n            const viewPortRect = container.getBoundingClientRect();\n            viewport = {\n                bottom : viewPortRect.bottom,\n                left : viewPortRect.left,\n                right : viewPortRect.right,\n                top : viewPortRect.top,\n            };\n\n            document.addEventListener(\"mouseup\", closeDragElement, true);\n            document.addEventListener(\"mousemove\", elementDrag, true);\n        }\n\n        function closeDragElement () {\n            /* stop moving when mouse button is released: */\n            positionX -= diffX;\n            positionY -= diffY;\n            document.removeEventListener(\"mouseup\", closeDragElement, true);\n            document.removeEventListener(\"mousemove\", elementDrag, true);\n        }\n\n        function elementDrag (e) {\n            e = e || window.event;\n            // e.preventDefault();\n            let currentMouseX = e.clientX;\n            let currentMouseY = e.clientY;\n\n            let oldDiffX = diffX;\n            let oldDiffY = diffY;\n\n            diffX = dragStartMouseX - currentMouseX;\n            diffY = dragStartMouseY - currentMouseY;\n\n            var newLeft = rect.left - diffX;\n            var newTop = rect.top - diffY;\n\n            if (newLeft < viewport.left\n                || newTop < viewport.top\n                || newLeft + rect.width > viewport.right\n                || newTop + rect.height > viewport.bottom\n            ) {\n                // the element will hit the boundary, do nothing...\n                diffX = oldDiffX;\n                diffY = oldDiffY;\n            } else {\n                // set the element's new position:\n                let newX = positionX - diffX;\n                let newY = positionY - diffY;\n                element.style.transform = \"translate(\" + newX + \"px,\" + newY + \"px)\";\n            }\n        }\n    }\n};\n\nexport default Draggable;\n","\nimport Logger from \"../../../../Utils/LoggerByDefault\";\n\n/**\n * @classdesc\n * Classe de gestion des param. des requêtes du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiRequest\n * @param {Object} options - options\n * @param {Object}   options.positions - tableau de coordonnées lon/lat\n * @param {String}   options.delimiter - \"|\"\n * @param {Boolean}  options.indent - false|true\n * @param {String}   options.crs - \"CRS:84\"\n * @param {String}   options.format - \"JSON|XML\"\n *\n * @private\n */\nfunction AltiRequest (options) {\n    if (!(this instanceof AltiRequest)) {\n        throw new TypeError(\"AltiRequest constructor cannot be called as a function.\");\n    }\n\n    this.logger = Logger.getLogger();\n    this.logger.trace(\"[Constructeur AltiRequest ()]\");\n\n    /**\n     * Options en paramêtres du constructeur.\n     */\n    this.options = options || {};\n\n    /**\n     * Liste des coordonnées.\n     * @example\n     * var c = [{lon : \"\", lat : \"\"}, {lon : \"\", lat : \"\"}];\n     */\n    this.positions = this.options.positions || [];\n\n    /**\n     * Caractère de séparation.\n     * Par defaut, \"|\".\n     */\n    this.delimiter = this.options.delimiter || \"|\";\n\n    /**\n     * Indentation.\n     * true|false\n     */\n    this.indent = this.options.indent || false;\n\n    /**\n     * Projection.\n     * Par defaut, CRS:84.\n     */\n    this.crs = this.options.crs || \"CRS:84\";\n\n    /**\n     * format de sortie.\n     * Par defaut, \"json\".\n     */\n    this.format = this.options.format || \"json\";\n\n    /*\n     * Ressource utilisée\n    */\n    this.resource = this.options.resource;\n\n    /**\n     * Réponse détaillée (source & accuracy)\n     * true|false\n    */\n    this.measures = this.options.measures || false;\n}\n\n/**\n * CLASSNAME\n */\nAltiRequest.CLASSNAME = \"AltiRequest\";\n\nAltiRequest.prototype = {\n\n    /**\n     * @lends module:AltiRequest#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : AltiRequest,\n\n    /**\n     * Ajout d\"une liste de coordonnées.\n     *\n     * @param {Object[]} lstPosition - liste de positions\n     * @example\n     * obj.setPositions ([{lon : \"0.15\", lat : \"0.15\"}, {lon : \"1.15\", lat : \"1.15\"}]);\n     */\n    setPositions : function (lstPosition) {\n        var positions = [];\n        for (var i = 0; i < lstPosition.length; i++) {\n            var o = lstPosition[i];\n            if (o.lon && o.lat) {\n                positions.push(o);\n            }\n        }\n\n        this.positions = positions;\n    },\n\n    /**\n     * Liste des coordonnées.\n     *\n     * @param {Int} pos - position\n     * @returns {positions}\n     * @example\n     * obj.getPositions ();  // [{lon : \"\", lat : \"\"}, {lon : \"\", lat : \"\"}]\n     * obj.getPositions (0); // [{lon : \"\", lat : \"\"}]\n     */\n    getPositions : function (pos) {\n        // FIXME test if not a number !?\n        if (!pos) {\n            return this.positions;\n        }\n\n        var index = this.positions.length - 1;\n        if (pos > index || pos < index) {\n            this.logger.warn(\"index out of range !\");\n            return this.positions;\n        }\n\n        return this.positions[pos];\n    },\n\n    /**\n     * Ajout d\"une liste de coordonnées.\n     *\n     * @param {Object[]} lstPosition - liste de positions\n     * @example\n     * obj.addPositions ([{lon : \"0.15\", lat : \"0.15\"}, {lon : \"1.15\", lat : \"1.15\"}]);\n     */\n    addPositions : function (lstPosition) {\n        for (var i = 0; i < lstPosition.length; i++) {\n            var o = lstPosition[i];\n            if (o.lon && o.lat) {\n                this.positions.push(lstPosition[i]);\n            }\n        }\n    },\n\n    /**\n     * Retourne la liste des longitudes avec un caractère de séparation.\n     *\n     * @returns {String} - une liste de longitudes\n     * @example\n     * // out : 0.2367|2.1570|43.789|...\n     */\n    getLon : function () {\n        var lstLon = [];\n        for (var i = 0; i < this.positions.length; i++) {\n            lstLon.push(this.positions[i].lon);\n        }\n        this.logger.trace(lstLon);\n        return lstLon.join(this.delimiter);\n    },\n\n    /**\n     * Retourne la liste des lattitudes avec un caractère de séparation.\n     *\n     * @returns {String} - une liste de lattitudes\n     * @example\n     * // out : 0.2367|2.1570|43.789|...\n     */\n    getLat : function () {\n        var lstLat = [];\n        for (var i = 0; i < this.positions.length; i++) {\n            lstLat.push(this.positions[i].lat);\n        }\n        this.logger.trace(lstLat);\n        return lstLat.join(this.delimiter);\n    }\n\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]}\n */\nAltiRequest.prototype.getData = function () {\n    var map = [];\n\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    map.push({\n        k : \"delimiter\",\n        v : this.delimiter\n    });\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n\n    return map;\n};\n\nexport default AltiRequest;\n","/**\n * Interface de dialogue avec les webservices\n *\n * @module Protocols\n * @private\n * @alias Gp.Protocols\n */\nimport Helper from \"../Utils/Helper\";\nimport XHR from \"./XHR\";\nimport JSONP from \"./JSONP\";\n\nvar Protocol = {\n\n    /**\n     * Interface unique d\"envoi d\"une requête.\n     *\n     * @method send\n     * @static\n     * @param {Object} options - options generales\n     * @param {String} options.url      - url du service\n     * @param {String} options.method   - GET, POST, PUT, DELETE\n     * @param {String} options.protocol - XHR | JSONP\n     * @param {String} options.format   - format de la reponse du service : json, xml ou null (brute)...\n     * @param {String} options.wrap     - encapsuler la reponse du service dans du JSON : true|false (true par defaut sur le protocole JSONP)\n     * @param {String} options.callbackSuffix - suffixe de la fonction de callback (JSONP uniquement) (ex: si callbackSuffix=\"\", la fonction s'appellera \"callback\")\n     * @param {String} options.timeOut  - 0 ms\n     * @param {Boolean} options.nocache  - true|false\n     * @param {Object|String} options.data        - content (post) ou param (get)\n     * @param {Object|String} options.headers     - (post) ex. referer\n     * @param {Object|String} options.content - (post) ex. \"application/json\"\n     * @param {String} options.scope       - this (TODO)\n     * @param {Function} options.onResponse - callback\n     * @param {Function} options.onFailure - callback\n     * @param {Function} options.onTimeOut - callback\n     * @param {String} options.proxyUrl -  (TODO)\n     */\n    send : function (options) {\n        // INFO\n        // \"output\" - param est interne à la classe \"Protocol\" (parametrable via \"wrap\"), et à ajouter à l\"url\n        //      ce param est independant du service car il est géré par le filtre LUA :\n        //          ex. json|xml (json par defaut).\n        //          Ce param. permet d\"encapsuler du XML dans du JSON :\n        //              {http : {status:200, error:null},xml :\"réponse du service\"}\n        //          Utile pour les services qui ne repondent que du XML (ex. Geocodage)\n        //\n        // |-------------------------------------------------|\n        // |      \\service |      |     |                    |\n        // | output\\ format| json | xml |     remarques      |\n        // |--------\\------|------|-----|--------------------|\n        // |    json       | json | json| json/xml encapsulé |\n        // |    xml        | json | xml | param inactif      |\n        // |-------------------------------------------------|\n        // ex. le service demande une reponse native au \"format\" json et avec un \"output\" json.\n        // on a donc une reponse json encapsulé dans un json : ce qu'on ne souhaite pas !\n        // dans ce cas on ne renseigne pas output=json\n\n        // INFO\n        // \"wrap\" - choix d\"encapsuler ou non les reponses dans du JSON.\n        //      Par defaut, on encapsule uniquement les reponses sur le protocole JSONP (et qui sont en xml) !\n\n        // INFO\n        // \"callback\" - param est interne à la classe \"Protocol\" (non parametrable), et à ajouter à l\"url\n        //      ce param est independant du service car il est géré aussi par le filtre LUA :\n        //          ex. callback|null\n        //          Ce param. permet de renvoyer une reponse javascript :\n        //              callback ({http : {status:200, error:null},xml :\"réponse du service\"})\n        //          Ce param. est non renseigné par defaut car pour du JSONP, on utilise le\n        //          le protocol JSONP, et ce dernier implemente déjà le callback !\n\n        // settings par defaut\n        var settings = options || {\n            method : \"GET\",\n            // protocol : \"JSONP\",\n            protocol : \"XHR\",\n            timeOut : 0,\n            format : null,\n            wrap : true,\n            nocache : true,\n            output : \"json\",\n            callback : null,\n            callbackSuffix : null\n        };\n\n        // on determine l'environnement d'execution : browser ou non ?\n        // et on stoppe pour nodeJS... sur un protocole JSONP !\n        if (typeof window === \"undefined\" && options.protocol === \"JSONP\") {\n            console.log(\"Value (s) for parameter (s) 'protocol=JSONP (instead use XHR)' not supported to NodeJS\");\n            return;\n        }\n\n        if (options.protocol === \"XHR\" || options.format === \"json\") {\n            settings.wrap = false;\n        } else if (options.protocol === \"JSONP\" && options.format === \"xml\") {\n            settings.wrap = true;\n        }\n\n        settings.callback = null; // FIXME non géré !?\n        settings.output = settings.wrap ? \"json\" : null;\n\n        // on encapsule les reponses dans un objet JSON\n        if (settings.wrap) {\n            var params = {};\n            params.output = settings.output;\n            params.callback = settings.callback;\n            delete params.callback; // FIXME non géré !?\n            settings.url = Helper.normalyzeUrl(options.url, params);\n        }\n\n        // choix de l\"implementation :\n        // XHR ou JSONP\n        switch (settings.protocol) {\n            case \"XHR\":\n                // on normalise l'url (gestion du cache)\n                if (options.method === \"GET\" && options.nocache) {\n                    settings.url = Helper.normalyzeUrl(settings.url, {\n                        t : new Date().getTime()\n                    });\n                }\n                // appel du service en XHR\n                XHR.call(settings);\n                break;\n            case \"JSONP\":\n\n                // on normalise l'url si les params. sont renseignés dans la string|object \"data\"\n                if (settings.data) {\n                    settings.url = Helper.normalyzeUrl(settings.url, settings.data);\n                }\n\n                // appel du service en JSONP\n                JSONP.call(settings);\n                break;\n            default:\n                throw new Error(\"protocol not supported (XHR|JSONP) !\");\n        }\n    }\n\n};\n\nexport default Protocol;\n","'use strict';\n\nvar freeze = require('./conventions').freeze;\n\n/**\n * The entities that are predefined in every XML document.\n *\n * @see https://www.w3.org/TR/2006/REC-xml11-20060816/#sec-predefined-ent W3C XML 1.1\n * @see https://www.w3.org/TR/2008/REC-xml-20081126/#sec-predefined-ent W3C XML 1.0\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML\n *      Wikipedia\n */\nexports.XML_ENTITIES = freeze({\n\tamp: '&',\n\tapos: \"'\",\n\tgt: '>',\n\tlt: '<',\n\tquot: '\"',\n});\n\n/**\n * A map of all entities that are detected in an HTML document.\n * They contain all entries from `XML_ENTITIES`.\n *\n * @see {@link XML_ENTITIES}\n * @see {@link DOMParser.parseFromString}\n * @see {@link DOMImplementation.prototype.createHTMLDocument}\n * @see https://html.spec.whatwg.org/#named-character-references WHATWG HTML(5)\n *      Spec\n * @see https://html.spec.whatwg.org/entities.json JSON\n * @see https://www.w3.org/TR/xml-entity-names/ W3C XML Entity Names\n * @see https://www.w3.org/TR/html4/sgml/entities.html W3C HTML4/SGML\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Character_entity_references_in_HTML\n *      Wikipedia (HTML)\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Entities_representing_special_characters_in_XHTML\n *      Wikpedia (XHTML)\n */\nexports.HTML_ENTITIES = freeze({\n\tAacute: '\\u00C1',\n\taacute: '\\u00E1',\n\tAbreve: '\\u0102',\n\tabreve: '\\u0103',\n\tac: '\\u223E',\n\tacd: '\\u223F',\n\tacE: '\\u223E\\u0333',\n\tAcirc: '\\u00C2',\n\tacirc: '\\u00E2',\n\tacute: '\\u00B4',\n\tAcy: '\\u0410',\n\tacy: '\\u0430',\n\tAElig: '\\u00C6',\n\taelig: '\\u00E6',\n\taf: '\\u2061',\n\tAfr: '\\uD835\\uDD04',\n\tafr: '\\uD835\\uDD1E',\n\tAgrave: '\\u00C0',\n\tagrave: '\\u00E0',\n\talefsym: '\\u2135',\n\taleph: '\\u2135',\n\tAlpha: '\\u0391',\n\talpha: '\\u03B1',\n\tAmacr: '\\u0100',\n\tamacr: '\\u0101',\n\tamalg: '\\u2A3F',\n\tAMP: '\\u0026',\n\tamp: '\\u0026',\n\tAnd: '\\u2A53',\n\tand: '\\u2227',\n\tandand: '\\u2A55',\n\tandd: '\\u2A5C',\n\tandslope: '\\u2A58',\n\tandv: '\\u2A5A',\n\tang: '\\u2220',\n\tange: '\\u29A4',\n\tangle: '\\u2220',\n\tangmsd: '\\u2221',\n\tangmsdaa: '\\u29A8',\n\tangmsdab: '\\u29A9',\n\tangmsdac: '\\u29AA',\n\tangmsdad: '\\u29AB',\n\tangmsdae: '\\u29AC',\n\tangmsdaf: '\\u29AD',\n\tangmsdag: '\\u29AE',\n\tangmsdah: '\\u29AF',\n\tangrt: '\\u221F',\n\tangrtvb: '\\u22BE',\n\tangrtvbd: '\\u299D',\n\tangsph: '\\u2222',\n\tangst: '\\u00C5',\n\tangzarr: '\\u237C',\n\tAogon: '\\u0104',\n\taogon: '\\u0105',\n\tAopf: '\\uD835\\uDD38',\n\taopf: '\\uD835\\uDD52',\n\tap: '\\u2248',\n\tapacir: '\\u2A6F',\n\tapE: '\\u2A70',\n\tape: '\\u224A',\n\tapid: '\\u224B',\n\tapos: '\\u0027',\n\tApplyFunction: '\\u2061',\n\tapprox: '\\u2248',\n\tapproxeq: '\\u224A',\n\tAring: '\\u00C5',\n\taring: '\\u00E5',\n\tAscr: '\\uD835\\uDC9C',\n\tascr: '\\uD835\\uDCB6',\n\tAssign: '\\u2254',\n\tast: '\\u002A',\n\tasymp: '\\u2248',\n\tasympeq: '\\u224D',\n\tAtilde: '\\u00C3',\n\tatilde: '\\u00E3',\n\tAuml: '\\u00C4',\n\tauml: '\\u00E4',\n\tawconint: '\\u2233',\n\tawint: '\\u2A11',\n\tbackcong: '\\u224C',\n\tbackepsilon: '\\u03F6',\n\tbackprime: '\\u2035',\n\tbacksim: '\\u223D',\n\tbacksimeq: '\\u22CD',\n\tBackslash: '\\u2216',\n\tBarv: '\\u2AE7',\n\tbarvee: '\\u22BD',\n\tBarwed: '\\u2306',\n\tbarwed: '\\u2305',\n\tbarwedge: '\\u2305',\n\tbbrk: '\\u23B5',\n\tbbrktbrk: '\\u23B6',\n\tbcong: '\\u224C',\n\tBcy: '\\u0411',\n\tbcy: '\\u0431',\n\tbdquo: '\\u201E',\n\tbecaus: '\\u2235',\n\tBecause: '\\u2235',\n\tbecause: '\\u2235',\n\tbemptyv: '\\u29B0',\n\tbepsi: '\\u03F6',\n\tbernou: '\\u212C',\n\tBernoullis: '\\u212C',\n\tBeta: '\\u0392',\n\tbeta: '\\u03B2',\n\tbeth: '\\u2136',\n\tbetween: '\\u226C',\n\tBfr: '\\uD835\\uDD05',\n\tbfr: '\\uD835\\uDD1F',\n\tbigcap: '\\u22C2',\n\tbigcirc: '\\u25EF',\n\tbigcup: '\\u22C3',\n\tbigodot: '\\u2A00',\n\tbigoplus: '\\u2A01',\n\tbigotimes: '\\u2A02',\n\tbigsqcup: '\\u2A06',\n\tbigstar: '\\u2605',\n\tbigtriangledown: '\\u25BD',\n\tbigtriangleup: '\\u25B3',\n\tbiguplus: '\\u2A04',\n\tbigvee: '\\u22C1',\n\tbigwedge: '\\u22C0',\n\tbkarow: '\\u290D',\n\tblacklozenge: '\\u29EB',\n\tblacksquare: '\\u25AA',\n\tblacktriangle: '\\u25B4',\n\tblacktriangledown: '\\u25BE',\n\tblacktriangleleft: '\\u25C2',\n\tblacktriangleright: '\\u25B8',\n\tblank: '\\u2423',\n\tblk12: '\\u2592',\n\tblk14: '\\u2591',\n\tblk34: '\\u2593',\n\tblock: '\\u2588',\n\tbne: '\\u003D\\u20E5',\n\tbnequiv: '\\u2261\\u20E5',\n\tbNot: '\\u2AED',\n\tbnot: '\\u2310',\n\tBopf: '\\uD835\\uDD39',\n\tbopf: '\\uD835\\uDD53',\n\tbot: '\\u22A5',\n\tbottom: '\\u22A5',\n\tbowtie: '\\u22C8',\n\tboxbox: '\\u29C9',\n\tboxDL: '\\u2557',\n\tboxDl: '\\u2556',\n\tboxdL: '\\u2555',\n\tboxdl: '\\u2510',\n\tboxDR: '\\u2554',\n\tboxDr: '\\u2553',\n\tboxdR: '\\u2552',\n\tboxdr: '\\u250C',\n\tboxH: '\\u2550',\n\tboxh: '\\u2500',\n\tboxHD: '\\u2566',\n\tboxHd: '\\u2564',\n\tboxhD: '\\u2565',\n\tboxhd: '\\u252C',\n\tboxHU: '\\u2569',\n\tboxHu: '\\u2567',\n\tboxhU: '\\u2568',\n\tboxhu: '\\u2534',\n\tboxminus: '\\u229F',\n\tboxplus: '\\u229E',\n\tboxtimes: '\\u22A0',\n\tboxUL: '\\u255D',\n\tboxUl: '\\u255C',\n\tboxuL: '\\u255B',\n\tboxul: '\\u2518',\n\tboxUR: '\\u255A',\n\tboxUr: '\\u2559',\n\tboxuR: '\\u2558',\n\tboxur: '\\u2514',\n\tboxV: '\\u2551',\n\tboxv: '\\u2502',\n\tboxVH: '\\u256C',\n\tboxVh: '\\u256B',\n\tboxvH: '\\u256A',\n\tboxvh: '\\u253C',\n\tboxVL: '\\u2563',\n\tboxVl: '\\u2562',\n\tboxvL: '\\u2561',\n\tboxvl: '\\u2524',\n\tboxVR: '\\u2560',\n\tboxVr: '\\u255F',\n\tboxvR: '\\u255E',\n\tboxvr: '\\u251C',\n\tbprime: '\\u2035',\n\tBreve: '\\u02D8',\n\tbreve: '\\u02D8',\n\tbrvbar: '\\u00A6',\n\tBscr: '\\u212C',\n\tbscr: '\\uD835\\uDCB7',\n\tbsemi: '\\u204F',\n\tbsim: '\\u223D',\n\tbsime: '\\u22CD',\n\tbsol: '\\u005C',\n\tbsolb: '\\u29C5',\n\tbsolhsub: '\\u27C8',\n\tbull: '\\u2022',\n\tbullet: '\\u2022',\n\tbump: '\\u224E',\n\tbumpE: '\\u2AAE',\n\tbumpe: '\\u224F',\n\tBumpeq: '\\u224E',\n\tbumpeq: '\\u224F',\n\tCacute: '\\u0106',\n\tcacute: '\\u0107',\n\tCap: '\\u22D2',\n\tcap: '\\u2229',\n\tcapand: '\\u2A44',\n\tcapbrcup: '\\u2A49',\n\tcapcap: '\\u2A4B',\n\tcapcup: '\\u2A47',\n\tcapdot: '\\u2A40',\n\tCapitalDifferentialD: '\\u2145',\n\tcaps: '\\u2229\\uFE00',\n\tcaret: '\\u2041',\n\tcaron: '\\u02C7',\n\tCayleys: '\\u212D',\n\tccaps: '\\u2A4D',\n\tCcaron: '\\u010C',\n\tccaron: '\\u010D',\n\tCcedil: '\\u00C7',\n\tccedil: '\\u00E7',\n\tCcirc: '\\u0108',\n\tccirc: '\\u0109',\n\tCconint: '\\u2230',\n\tccups: '\\u2A4C',\n\tccupssm: '\\u2A50',\n\tCdot: '\\u010A',\n\tcdot: '\\u010B',\n\tcedil: '\\u00B8',\n\tCedilla: '\\u00B8',\n\tcemptyv: '\\u29B2',\n\tcent: '\\u00A2',\n\tCenterDot: '\\u00B7',\n\tcenterdot: '\\u00B7',\n\tCfr: '\\u212D',\n\tcfr: '\\uD835\\uDD20',\n\tCHcy: '\\u0427',\n\tchcy: '\\u0447',\n\tcheck: '\\u2713',\n\tcheckmark: '\\u2713',\n\tChi: '\\u03A7',\n\tchi: '\\u03C7',\n\tcir: '\\u25CB',\n\tcirc: '\\u02C6',\n\tcirceq: '\\u2257',\n\tcirclearrowleft: '\\u21BA',\n\tcirclearrowright: '\\u21BB',\n\tcircledast: '\\u229B',\n\tcircledcirc: '\\u229A',\n\tcircleddash: '\\u229D',\n\tCircleDot: '\\u2299',\n\tcircledR: '\\u00AE',\n\tcircledS: '\\u24C8',\n\tCircleMinus: '\\u2296',\n\tCirclePlus: '\\u2295',\n\tCircleTimes: '\\u2297',\n\tcirE: '\\u29C3',\n\tcire: '\\u2257',\n\tcirfnint: '\\u2A10',\n\tcirmid: '\\u2AEF',\n\tcirscir: '\\u29C2',\n\tClockwiseContourIntegral: '\\u2232',\n\tCloseCurlyDoubleQuote: '\\u201D',\n\tCloseCurlyQuote: '\\u2019',\n\tclubs: '\\u2663',\n\tclubsuit: '\\u2663',\n\tColon: '\\u2237',\n\tcolon: '\\u003A',\n\tColone: '\\u2A74',\n\tcolone: '\\u2254',\n\tcoloneq: '\\u2254',\n\tcomma: '\\u002C',\n\tcommat: '\\u0040',\n\tcomp: '\\u2201',\n\tcompfn: '\\u2218',\n\tcomplement: '\\u2201',\n\tcomplexes: '\\u2102',\n\tcong: '\\u2245',\n\tcongdot: '\\u2A6D',\n\tCongruent: '\\u2261',\n\tConint: '\\u222F',\n\tconint: '\\u222E',\n\tContourIntegral: '\\u222E',\n\tCopf: '\\u2102',\n\tcopf: '\\uD835\\uDD54',\n\tcoprod: '\\u2210',\n\tCoproduct: '\\u2210',\n\tCOPY: '\\u00A9',\n\tcopy: '\\u00A9',\n\tcopysr: '\\u2117',\n\tCounterClockwiseContourIntegral: '\\u2233',\n\tcrarr: '\\u21B5',\n\tCross: '\\u2A2F',\n\tcross: '\\u2717',\n\tCscr: '\\uD835\\uDC9E',\n\tcscr: '\\uD835\\uDCB8',\n\tcsub: '\\u2ACF',\n\tcsube: '\\u2AD1',\n\tcsup: '\\u2AD0',\n\tcsupe: '\\u2AD2',\n\tctdot: '\\u22EF',\n\tcudarrl: '\\u2938',\n\tcudarrr: '\\u2935',\n\tcuepr: '\\u22DE',\n\tcuesc: '\\u22DF',\n\tcularr: '\\u21B6',\n\tcularrp: '\\u293D',\n\tCup: '\\u22D3',\n\tcup: '\\u222A',\n\tcupbrcap: '\\u2A48',\n\tCupCap: '\\u224D',\n\tcupcap: '\\u2A46',\n\tcupcup: '\\u2A4A',\n\tcupdot: '\\u228D',\n\tcupor: '\\u2A45',\n\tcups: '\\u222A\\uFE00',\n\tcurarr: '\\u21B7',\n\tcurarrm: '\\u293C',\n\tcurlyeqprec: '\\u22DE',\n\tcurlyeqsucc: '\\u22DF',\n\tcurlyvee: '\\u22CE',\n\tcurlywedge: '\\u22CF',\n\tcurren: '\\u00A4',\n\tcurvearrowleft: '\\u21B6',\n\tcurvearrowright: '\\u21B7',\n\tcuvee: '\\u22CE',\n\tcuwed: '\\u22CF',\n\tcwconint: '\\u2232',\n\tcwint: '\\u2231',\n\tcylcty: '\\u232D',\n\tDagger: '\\u2021',\n\tdagger: '\\u2020',\n\tdaleth: '\\u2138',\n\tDarr: '\\u21A1',\n\tdArr: '\\u21D3',\n\tdarr: '\\u2193',\n\tdash: '\\u2010',\n\tDashv: '\\u2AE4',\n\tdashv: '\\u22A3',\n\tdbkarow: '\\u290F',\n\tdblac: '\\u02DD',\n\tDcaron: '\\u010E',\n\tdcaron: '\\u010F',\n\tDcy: '\\u0414',\n\tdcy: '\\u0434',\n\tDD: '\\u2145',\n\tdd: '\\u2146',\n\tddagger: '\\u2021',\n\tddarr: '\\u21CA',\n\tDDotrahd: '\\u2911',\n\tddotseq: '\\u2A77',\n\tdeg: '\\u00B0',\n\tDel: '\\u2207',\n\tDelta: '\\u0394',\n\tdelta: '\\u03B4',\n\tdemptyv: '\\u29B1',\n\tdfisht: '\\u297F',\n\tDfr: '\\uD835\\uDD07',\n\tdfr: '\\uD835\\uDD21',\n\tdHar: '\\u2965',\n\tdharl: '\\u21C3',\n\tdharr: '\\u21C2',\n\tDiacriticalAcute: '\\u00B4',\n\tDiacriticalDot: '\\u02D9',\n\tDiacriticalDoubleAcute: '\\u02DD',\n\tDiacriticalGrave: '\\u0060',\n\tDiacriticalTilde: '\\u02DC',\n\tdiam: '\\u22C4',\n\tDiamond: '\\u22C4',\n\tdiamond: '\\u22C4',\n\tdiamondsuit: '\\u2666',\n\tdiams: '\\u2666',\n\tdie: '\\u00A8',\n\tDifferentialD: '\\u2146',\n\tdigamma: '\\u03DD',\n\tdisin: '\\u22F2',\n\tdiv: '\\u00F7',\n\tdivide: '\\u00F7',\n\tdivideontimes: '\\u22C7',\n\tdivonx: '\\u22C7',\n\tDJcy: '\\u0402',\n\tdjcy: '\\u0452',\n\tdlcorn: '\\u231E',\n\tdlcrop: '\\u230D',\n\tdollar: '\\u0024',\n\tDopf: '\\uD835\\uDD3B',\n\tdopf: '\\uD835\\uDD55',\n\tDot: '\\u00A8',\n\tdot: '\\u02D9',\n\tDotDot: '\\u20DC',\n\tdoteq: '\\u2250',\n\tdoteqdot: '\\u2251',\n\tDotEqual: '\\u2250',\n\tdotminus: '\\u2238',\n\tdotplus: '\\u2214',\n\tdotsquare: '\\u22A1',\n\tdoublebarwedge: '\\u2306',\n\tDoubleContourIntegral: '\\u222F',\n\tDoubleDot: '\\u00A8',\n\tDoubleDownArrow: '\\u21D3',\n\tDoubleLeftArrow: '\\u21D0',\n\tDoubleLeftRightArrow: '\\u21D4',\n\tDoubleLeftTee: '\\u2AE4',\n\tDoubleLongLeftArrow: '\\u27F8',\n\tDoubleLongLeftRightArrow: '\\u27FA',\n\tDoubleLongRightArrow: '\\u27F9',\n\tDoubleRightArrow: '\\u21D2',\n\tDoubleRightTee: '\\u22A8',\n\tDoubleUpArrow: '\\u21D1',\n\tDoubleUpDownArrow: '\\u21D5',\n\tDoubleVerticalBar: '\\u2225',\n\tDownArrow: '\\u2193',\n\tDownarrow: '\\u21D3',\n\tdownarrow: '\\u2193',\n\tDownArrowBar: '\\u2913',\n\tDownArrowUpArrow: '\\u21F5',\n\tDownBreve: '\\u0311',\n\tdowndownarrows: '\\u21CA',\n\tdownharpoonleft: '\\u21C3',\n\tdownharpoonright: '\\u21C2',\n\tDownLeftRightVector: '\\u2950',\n\tDownLeftTeeVector: '\\u295E',\n\tDownLeftVector: '\\u21BD',\n\tDownLeftVectorBar: '\\u2956',\n\tDownRightTeeVector: '\\u295F',\n\tDownRightVector: '\\u21C1',\n\tDownRightVectorBar: '\\u2957',\n\tDownTee: '\\u22A4',\n\tDownTeeArrow: '\\u21A7',\n\tdrbkarow: '\\u2910',\n\tdrcorn: '\\u231F',\n\tdrcrop: '\\u230C',\n\tDscr: '\\uD835\\uDC9F',\n\tdscr: '\\uD835\\uDCB9',\n\tDScy: '\\u0405',\n\tdscy: '\\u0455',\n\tdsol: '\\u29F6',\n\tDstrok: '\\u0110',\n\tdstrok: '\\u0111',\n\tdtdot: '\\u22F1',\n\tdtri: '\\u25BF',\n\tdtrif: '\\u25BE',\n\tduarr: '\\u21F5',\n\tduhar: '\\u296F',\n\tdwangle: '\\u29A6',\n\tDZcy: '\\u040F',\n\tdzcy: '\\u045F',\n\tdzigrarr: '\\u27FF',\n\tEacute: '\\u00C9',\n\teacute: '\\u00E9',\n\teaster: '\\u2A6E',\n\tEcaron: '\\u011A',\n\tecaron: '\\u011B',\n\tecir: '\\u2256',\n\tEcirc: '\\u00CA',\n\tecirc: '\\u00EA',\n\tecolon: '\\u2255',\n\tEcy: '\\u042D',\n\tecy: '\\u044D',\n\teDDot: '\\u2A77',\n\tEdot: '\\u0116',\n\teDot: '\\u2251',\n\tedot: '\\u0117',\n\tee: '\\u2147',\n\tefDot: '\\u2252',\n\tEfr: '\\uD835\\uDD08',\n\tefr: '\\uD835\\uDD22',\n\teg: '\\u2A9A',\n\tEgrave: '\\u00C8',\n\tegrave: '\\u00E8',\n\tegs: '\\u2A96',\n\tegsdot: '\\u2A98',\n\tel: '\\u2A99',\n\tElement: '\\u2208',\n\telinters: '\\u23E7',\n\tell: '\\u2113',\n\tels: '\\u2A95',\n\telsdot: '\\u2A97',\n\tEmacr: '\\u0112',\n\temacr: '\\u0113',\n\tempty: '\\u2205',\n\temptyset: '\\u2205',\n\tEmptySmallSquare: '\\u25FB',\n\temptyv: '\\u2205',\n\tEmptyVerySmallSquare: '\\u25AB',\n\temsp: '\\u2003',\n\temsp13: '\\u2004',\n\temsp14: '\\u2005',\n\tENG: '\\u014A',\n\teng: '\\u014B',\n\tensp: '\\u2002',\n\tEogon: '\\u0118',\n\teogon: '\\u0119',\n\tEopf: '\\uD835\\uDD3C',\n\teopf: '\\uD835\\uDD56',\n\tepar: '\\u22D5',\n\teparsl: '\\u29E3',\n\teplus: '\\u2A71',\n\tepsi: '\\u03B5',\n\tEpsilon: '\\u0395',\n\tepsilon: '\\u03B5',\n\tepsiv: '\\u03F5',\n\teqcirc: '\\u2256',\n\teqcolon: '\\u2255',\n\teqsim: '\\u2242',\n\teqslantgtr: '\\u2A96',\n\teqslantless: '\\u2A95',\n\tEqual: '\\u2A75',\n\tequals: '\\u003D',\n\tEqualTilde: '\\u2242',\n\tequest: '\\u225F',\n\tEquilibrium: '\\u21CC',\n\tequiv: '\\u2261',\n\tequivDD: '\\u2A78',\n\teqvparsl: '\\u29E5',\n\terarr: '\\u2971',\n\terDot: '\\u2253',\n\tEscr: '\\u2130',\n\tescr: '\\u212F',\n\tesdot: '\\u2250',\n\tEsim: '\\u2A73',\n\tesim: '\\u2242',\n\tEta: '\\u0397',\n\teta: '\\u03B7',\n\tETH: '\\u00D0',\n\teth: '\\u00F0',\n\tEuml: '\\u00CB',\n\teuml: '\\u00EB',\n\teuro: '\\u20AC',\n\texcl: '\\u0021',\n\texist: '\\u2203',\n\tExists: '\\u2203',\n\texpectation: '\\u2130',\n\tExponentialE: '\\u2147',\n\texponentiale: '\\u2147',\n\tfallingdotseq: '\\u2252',\n\tFcy: '\\u0424',\n\tfcy: '\\u0444',\n\tfemale: '\\u2640',\n\tffilig: '\\uFB03',\n\tfflig: '\\uFB00',\n\tffllig: '\\uFB04',\n\tFfr: '\\uD835\\uDD09',\n\tffr: '\\uD835\\uDD23',\n\tfilig: '\\uFB01',\n\tFilledSmallSquare: '\\u25FC',\n\tFilledVerySmallSquare: '\\u25AA',\n\tfjlig: '\\u0066\\u006A',\n\tflat: '\\u266D',\n\tfllig: '\\uFB02',\n\tfltns: '\\u25B1',\n\tfnof: '\\u0192',\n\tFopf: '\\uD835\\uDD3D',\n\tfopf: '\\uD835\\uDD57',\n\tForAll: '\\u2200',\n\tforall: '\\u2200',\n\tfork: '\\u22D4',\n\tforkv: '\\u2AD9',\n\tFouriertrf: '\\u2131',\n\tfpartint: '\\u2A0D',\n\tfrac12: '\\u00BD',\n\tfrac13: '\\u2153',\n\tfrac14: '\\u00BC',\n\tfrac15: '\\u2155',\n\tfrac16: '\\u2159',\n\tfrac18: '\\u215B',\n\tfrac23: '\\u2154',\n\tfrac25: '\\u2156',\n\tfrac34: '\\u00BE',\n\tfrac35: '\\u2157',\n\tfrac38: '\\u215C',\n\tfrac45: '\\u2158',\n\tfrac56: '\\u215A',\n\tfrac58: '\\u215D',\n\tfrac78: '\\u215E',\n\tfrasl: '\\u2044',\n\tfrown: '\\u2322',\n\tFscr: '\\u2131',\n\tfscr: '\\uD835\\uDCBB',\n\tgacute: '\\u01F5',\n\tGamma: '\\u0393',\n\tgamma: '\\u03B3',\n\tGammad: '\\u03DC',\n\tgammad: '\\u03DD',\n\tgap: '\\u2A86',\n\tGbreve: '\\u011E',\n\tgbreve: '\\u011F',\n\tGcedil: '\\u0122',\n\tGcirc: '\\u011C',\n\tgcirc: '\\u011D',\n\tGcy: '\\u0413',\n\tgcy: '\\u0433',\n\tGdot: '\\u0120',\n\tgdot: '\\u0121',\n\tgE: '\\u2267',\n\tge: '\\u2265',\n\tgEl: '\\u2A8C',\n\tgel: '\\u22DB',\n\tgeq: '\\u2265',\n\tgeqq: '\\u2267',\n\tgeqslant: '\\u2A7E',\n\tges: '\\u2A7E',\n\tgescc: '\\u2AA9',\n\tgesdot: '\\u2A80',\n\tgesdoto: '\\u2A82',\n\tgesdotol: '\\u2A84',\n\tgesl: '\\u22DB\\uFE00',\n\tgesles: '\\u2A94',\n\tGfr: '\\uD835\\uDD0A',\n\tgfr: '\\uD835\\uDD24',\n\tGg: '\\u22D9',\n\tgg: '\\u226B',\n\tggg: '\\u22D9',\n\tgimel: '\\u2137',\n\tGJcy: '\\u0403',\n\tgjcy: '\\u0453',\n\tgl: '\\u2277',\n\tgla: '\\u2AA5',\n\tglE: '\\u2A92',\n\tglj: '\\u2AA4',\n\tgnap: '\\u2A8A',\n\tgnapprox: '\\u2A8A',\n\tgnE: '\\u2269',\n\tgne: '\\u2A88',\n\tgneq: '\\u2A88',\n\tgneqq: '\\u2269',\n\tgnsim: '\\u22E7',\n\tGopf: '\\uD835\\uDD3E',\n\tgopf: '\\uD835\\uDD58',\n\tgrave: '\\u0060',\n\tGreaterEqual: '\\u2265',\n\tGreaterEqualLess: '\\u22DB',\n\tGreaterFullEqual: '\\u2267',\n\tGreaterGreater: '\\u2AA2',\n\tGreaterLess: '\\u2277',\n\tGreaterSlantEqual: '\\u2A7E',\n\tGreaterTilde: '\\u2273',\n\tGscr: '\\uD835\\uDCA2',\n\tgscr: '\\u210A',\n\tgsim: '\\u2273',\n\tgsime: '\\u2A8E',\n\tgsiml: '\\u2A90',\n\tGt: '\\u226B',\n\tGT: '\\u003E',\n\tgt: '\\u003E',\n\tgtcc: '\\u2AA7',\n\tgtcir: '\\u2A7A',\n\tgtdot: '\\u22D7',\n\tgtlPar: '\\u2995',\n\tgtquest: '\\u2A7C',\n\tgtrapprox: '\\u2A86',\n\tgtrarr: '\\u2978',\n\tgtrdot: '\\u22D7',\n\tgtreqless: '\\u22DB',\n\tgtreqqless: '\\u2A8C',\n\tgtrless: '\\u2277',\n\tgtrsim: '\\u2273',\n\tgvertneqq: '\\u2269\\uFE00',\n\tgvnE: '\\u2269\\uFE00',\n\tHacek: '\\u02C7',\n\thairsp: '\\u200A',\n\thalf: '\\u00BD',\n\thamilt: '\\u210B',\n\tHARDcy: '\\u042A',\n\thardcy: '\\u044A',\n\thArr: '\\u21D4',\n\tharr: '\\u2194',\n\tharrcir: '\\u2948',\n\tharrw: '\\u21AD',\n\tHat: '\\u005E',\n\thbar: '\\u210F',\n\tHcirc: '\\u0124',\n\thcirc: '\\u0125',\n\thearts: '\\u2665',\n\theartsuit: '\\u2665',\n\thellip: '\\u2026',\n\thercon: '\\u22B9',\n\tHfr: '\\u210C',\n\thfr: '\\uD835\\uDD25',\n\tHilbertSpace: '\\u210B',\n\thksearow: '\\u2925',\n\thkswarow: '\\u2926',\n\thoarr: '\\u21FF',\n\thomtht: '\\u223B',\n\thookleftarrow: '\\u21A9',\n\thookrightarrow: '\\u21AA',\n\tHopf: '\\u210D',\n\thopf: '\\uD835\\uDD59',\n\thorbar: '\\u2015',\n\tHorizontalLine: '\\u2500',\n\tHscr: '\\u210B',\n\thscr: '\\uD835\\uDCBD',\n\thslash: '\\u210F',\n\tHstrok: '\\u0126',\n\thstrok: '\\u0127',\n\tHumpDownHump: '\\u224E',\n\tHumpEqual: '\\u224F',\n\thybull: '\\u2043',\n\thyphen: '\\u2010',\n\tIacute: '\\u00CD',\n\tiacute: '\\u00ED',\n\tic: '\\u2063',\n\tIcirc: '\\u00CE',\n\ticirc: '\\u00EE',\n\tIcy: '\\u0418',\n\ticy: '\\u0438',\n\tIdot: '\\u0130',\n\tIEcy: '\\u0415',\n\tiecy: '\\u0435',\n\tiexcl: '\\u00A1',\n\tiff: '\\u21D4',\n\tIfr: '\\u2111',\n\tifr: '\\uD835\\uDD26',\n\tIgrave: '\\u00CC',\n\tigrave: '\\u00EC',\n\tii: '\\u2148',\n\tiiiint: '\\u2A0C',\n\tiiint: '\\u222D',\n\tiinfin: '\\u29DC',\n\tiiota: '\\u2129',\n\tIJlig: '\\u0132',\n\tijlig: '\\u0133',\n\tIm: '\\u2111',\n\tImacr: '\\u012A',\n\timacr: '\\u012B',\n\timage: '\\u2111',\n\tImaginaryI: '\\u2148',\n\timagline: '\\u2110',\n\timagpart: '\\u2111',\n\timath: '\\u0131',\n\timof: '\\u22B7',\n\timped: '\\u01B5',\n\tImplies: '\\u21D2',\n\tin: '\\u2208',\n\tincare: '\\u2105',\n\tinfin: '\\u221E',\n\tinfintie: '\\u29DD',\n\tinodot: '\\u0131',\n\tInt: '\\u222C',\n\tint: '\\u222B',\n\tintcal: '\\u22BA',\n\tintegers: '\\u2124',\n\tIntegral: '\\u222B',\n\tintercal: '\\u22BA',\n\tIntersection: '\\u22C2',\n\tintlarhk: '\\u2A17',\n\tintprod: '\\u2A3C',\n\tInvisibleComma: '\\u2063',\n\tInvisibleTimes: '\\u2062',\n\tIOcy: '\\u0401',\n\tiocy: '\\u0451',\n\tIogon: '\\u012E',\n\tiogon: '\\u012F',\n\tIopf: '\\uD835\\uDD40',\n\tiopf: '\\uD835\\uDD5A',\n\tIota: '\\u0399',\n\tiota: '\\u03B9',\n\tiprod: '\\u2A3C',\n\tiquest: '\\u00BF',\n\tIscr: '\\u2110',\n\tiscr: '\\uD835\\uDCBE',\n\tisin: '\\u2208',\n\tisindot: '\\u22F5',\n\tisinE: '\\u22F9',\n\tisins: '\\u22F4',\n\tisinsv: '\\u22F3',\n\tisinv: '\\u2208',\n\tit: '\\u2062',\n\tItilde: '\\u0128',\n\titilde: '\\u0129',\n\tIukcy: '\\u0406',\n\tiukcy: '\\u0456',\n\tIuml: '\\u00CF',\n\tiuml: '\\u00EF',\n\tJcirc: '\\u0134',\n\tjcirc: '\\u0135',\n\tJcy: '\\u0419',\n\tjcy: '\\u0439',\n\tJfr: '\\uD835\\uDD0D',\n\tjfr: '\\uD835\\uDD27',\n\tjmath: '\\u0237',\n\tJopf: '\\uD835\\uDD41',\n\tjopf: '\\uD835\\uDD5B',\n\tJscr: '\\uD835\\uDCA5',\n\tjscr: '\\uD835\\uDCBF',\n\tJsercy: '\\u0408',\n\tjsercy: '\\u0458',\n\tJukcy: '\\u0404',\n\tjukcy: '\\u0454',\n\tKappa: '\\u039A',\n\tkappa: '\\u03BA',\n\tkappav: '\\u03F0',\n\tKcedil: '\\u0136',\n\tkcedil: '\\u0137',\n\tKcy: '\\u041A',\n\tkcy: '\\u043A',\n\tKfr: '\\uD835\\uDD0E',\n\tkfr: '\\uD835\\uDD28',\n\tkgreen: '\\u0138',\n\tKHcy: '\\u0425',\n\tkhcy: '\\u0445',\n\tKJcy: '\\u040C',\n\tkjcy: '\\u045C',\n\tKopf: '\\uD835\\uDD42',\n\tkopf: '\\uD835\\uDD5C',\n\tKscr: '\\uD835\\uDCA6',\n\tkscr: '\\uD835\\uDCC0',\n\tlAarr: '\\u21DA',\n\tLacute: '\\u0139',\n\tlacute: '\\u013A',\n\tlaemptyv: '\\u29B4',\n\tlagran: '\\u2112',\n\tLambda: '\\u039B',\n\tlambda: '\\u03BB',\n\tLang: '\\u27EA',\n\tlang: '\\u27E8',\n\tlangd: '\\u2991',\n\tlangle: '\\u27E8',\n\tlap: '\\u2A85',\n\tLaplacetrf: '\\u2112',\n\tlaquo: '\\u00AB',\n\tLarr: '\\u219E',\n\tlArr: '\\u21D0',\n\tlarr: '\\u2190',\n\tlarrb: '\\u21E4',\n\tlarrbfs: '\\u291F',\n\tlarrfs: '\\u291D',\n\tlarrhk: '\\u21A9',\n\tlarrlp: '\\u21AB',\n\tlarrpl: '\\u2939',\n\tlarrsim: '\\u2973',\n\tlarrtl: '\\u21A2',\n\tlat: '\\u2AAB',\n\tlAtail: '\\u291B',\n\tlatail: '\\u2919',\n\tlate: '\\u2AAD',\n\tlates: '\\u2AAD\\uFE00',\n\tlBarr: '\\u290E',\n\tlbarr: '\\u290C',\n\tlbbrk: '\\u2772',\n\tlbrace: '\\u007B',\n\tlbrack: '\\u005B',\n\tlbrke: '\\u298B',\n\tlbrksld: '\\u298F',\n\tlbrkslu: '\\u298D',\n\tLcaron: '\\u013D',\n\tlcaron: '\\u013E',\n\tLcedil: '\\u013B',\n\tlcedil: '\\u013C',\n\tlceil: '\\u2308',\n\tlcub: '\\u007B',\n\tLcy: '\\u041B',\n\tlcy: '\\u043B',\n\tldca: '\\u2936',\n\tldquo: '\\u201C',\n\tldquor: '\\u201E',\n\tldrdhar: '\\u2967',\n\tldrushar: '\\u294B',\n\tldsh: '\\u21B2',\n\tlE: '\\u2266',\n\tle: '\\u2264',\n\tLeftAngleBracket: '\\u27E8',\n\tLeftArrow: '\\u2190',\n\tLeftarrow: '\\u21D0',\n\tleftarrow: '\\u2190',\n\tLeftArrowBar: '\\u21E4',\n\tLeftArrowRightArrow: '\\u21C6',\n\tleftarrowtail: '\\u21A2',\n\tLeftCeiling: '\\u2308',\n\tLeftDoubleBracket: '\\u27E6',\n\tLeftDownTeeVector: '\\u2961',\n\tLeftDownVector: '\\u21C3',\n\tLeftDownVectorBar: '\\u2959',\n\tLeftFloor: '\\u230A',\n\tleftharpoondown: '\\u21BD',\n\tleftharpoonup: '\\u21BC',\n\tleftleftarrows: '\\u21C7',\n\tLeftRightArrow: '\\u2194',\n\tLeftrightarrow: '\\u21D4',\n\tleftrightarrow: '\\u2194',\n\tleftrightarrows: '\\u21C6',\n\tleftrightharpoons: '\\u21CB',\n\tleftrightsquigarrow: '\\u21AD',\n\tLeftRightVector: '\\u294E',\n\tLeftTee: '\\u22A3',\n\tLeftTeeArrow: '\\u21A4',\n\tLeftTeeVector: '\\u295A',\n\tleftthreetimes: '\\u22CB',\n\tLeftTriangle: '\\u22B2',\n\tLeftTriangleBar: '\\u29CF',\n\tLeftTriangleEqual: '\\u22B4',\n\tLeftUpDownVector: '\\u2951',\n\tLeftUpTeeVector: '\\u2960',\n\tLeftUpVector: '\\u21BF',\n\tLeftUpVectorBar: '\\u2958',\n\tLeftVector: '\\u21BC',\n\tLeftVectorBar: '\\u2952',\n\tlEg: '\\u2A8B',\n\tleg: '\\u22DA',\n\tleq: '\\u2264',\n\tleqq: '\\u2266',\n\tleqslant: '\\u2A7D',\n\tles: '\\u2A7D',\n\tlescc: '\\u2AA8',\n\tlesdot: '\\u2A7F',\n\tlesdoto: '\\u2A81',\n\tlesdotor: '\\u2A83',\n\tlesg: '\\u22DA\\uFE00',\n\tlesges: '\\u2A93',\n\tlessapprox: '\\u2A85',\n\tlessdot: '\\u22D6',\n\tlesseqgtr: '\\u22DA',\n\tlesseqqgtr: '\\u2A8B',\n\tLessEqualGreater: '\\u22DA',\n\tLessFullEqual: '\\u2266',\n\tLessGreater: '\\u2276',\n\tlessgtr: '\\u2276',\n\tLessLess: '\\u2AA1',\n\tlesssim: '\\u2272',\n\tLessSlantEqual: '\\u2A7D',\n\tLessTilde: '\\u2272',\n\tlfisht: '\\u297C',\n\tlfloor: '\\u230A',\n\tLfr: '\\uD835\\uDD0F',\n\tlfr: '\\uD835\\uDD29',\n\tlg: '\\u2276',\n\tlgE: '\\u2A91',\n\tlHar: '\\u2962',\n\tlhard: '\\u21BD',\n\tlharu: '\\u21BC',\n\tlharul: '\\u296A',\n\tlhblk: '\\u2584',\n\tLJcy: '\\u0409',\n\tljcy: '\\u0459',\n\tLl: '\\u22D8',\n\tll: '\\u226A',\n\tllarr: '\\u21C7',\n\tllcorner: '\\u231E',\n\tLleftarrow: '\\u21DA',\n\tllhard: '\\u296B',\n\tlltri: '\\u25FA',\n\tLmidot: '\\u013F',\n\tlmidot: '\\u0140',\n\tlmoust: '\\u23B0',\n\tlmoustache: '\\u23B0',\n\tlnap: '\\u2A89',\n\tlnapprox: '\\u2A89',\n\tlnE: '\\u2268',\n\tlne: '\\u2A87',\n\tlneq: '\\u2A87',\n\tlneqq: '\\u2268',\n\tlnsim: '\\u22E6',\n\tloang: '\\u27EC',\n\tloarr: '\\u21FD',\n\tlobrk: '\\u27E6',\n\tLongLeftArrow: '\\u27F5',\n\tLongleftarrow: '\\u27F8',\n\tlongleftarrow: '\\u27F5',\n\tLongLeftRightArrow: '\\u27F7',\n\tLongleftrightarrow: '\\u27FA',\n\tlongleftrightarrow: '\\u27F7',\n\tlongmapsto: '\\u27FC',\n\tLongRightArrow: '\\u27F6',\n\tLongrightarrow: '\\u27F9',\n\tlongrightarrow: '\\u27F6',\n\tlooparrowleft: '\\u21AB',\n\tlooparrowright: '\\u21AC',\n\tlopar: '\\u2985',\n\tLopf: '\\uD835\\uDD43',\n\tlopf: '\\uD835\\uDD5D',\n\tloplus: '\\u2A2D',\n\tlotimes: '\\u2A34',\n\tlowast: '\\u2217',\n\tlowbar: '\\u005F',\n\tLowerLeftArrow: '\\u2199',\n\tLowerRightArrow: '\\u2198',\n\tloz: '\\u25CA',\n\tlozenge: '\\u25CA',\n\tlozf: '\\u29EB',\n\tlpar: '\\u0028',\n\tlparlt: '\\u2993',\n\tlrarr: '\\u21C6',\n\tlrcorner: '\\u231F',\n\tlrhar: '\\u21CB',\n\tlrhard: '\\u296D',\n\tlrm: '\\u200E',\n\tlrtri: '\\u22BF',\n\tlsaquo: '\\u2039',\n\tLscr: '\\u2112',\n\tlscr: '\\uD835\\uDCC1',\n\tLsh: '\\u21B0',\n\tlsh: '\\u21B0',\n\tlsim: '\\u2272',\n\tlsime: '\\u2A8D',\n\tlsimg: '\\u2A8F',\n\tlsqb: '\\u005B',\n\tlsquo: '\\u2018',\n\tlsquor: '\\u201A',\n\tLstrok: '\\u0141',\n\tlstrok: '\\u0142',\n\tLt: '\\u226A',\n\tLT: '\\u003C',\n\tlt: '\\u003C',\n\tltcc: '\\u2AA6',\n\tltcir: '\\u2A79',\n\tltdot: '\\u22D6',\n\tlthree: '\\u22CB',\n\tltimes: '\\u22C9',\n\tltlarr: '\\u2976',\n\tltquest: '\\u2A7B',\n\tltri: '\\u25C3',\n\tltrie: '\\u22B4',\n\tltrif: '\\u25C2',\n\tltrPar: '\\u2996',\n\tlurdshar: '\\u294A',\n\tluruhar: '\\u2966',\n\tlvertneqq: '\\u2268\\uFE00',\n\tlvnE: '\\u2268\\uFE00',\n\tmacr: '\\u00AF',\n\tmale: '\\u2642',\n\tmalt: '\\u2720',\n\tmaltese: '\\u2720',\n\tMap: '\\u2905',\n\tmap: '\\u21A6',\n\tmapsto: '\\u21A6',\n\tmapstodown: '\\u21A7',\n\tmapstoleft: '\\u21A4',\n\tmapstoup: '\\u21A5',\n\tmarker: '\\u25AE',\n\tmcomma: '\\u2A29',\n\tMcy: '\\u041C',\n\tmcy: '\\u043C',\n\tmdash: '\\u2014',\n\tmDDot: '\\u223A',\n\tmeasuredangle: '\\u2221',\n\tMediumSpace: '\\u205F',\n\tMellintrf: '\\u2133',\n\tMfr: '\\uD835\\uDD10',\n\tmfr: '\\uD835\\uDD2A',\n\tmho: '\\u2127',\n\tmicro: '\\u00B5',\n\tmid: '\\u2223',\n\tmidast: '\\u002A',\n\tmidcir: '\\u2AF0',\n\tmiddot: '\\u00B7',\n\tminus: '\\u2212',\n\tminusb: '\\u229F',\n\tminusd: '\\u2238',\n\tminusdu: '\\u2A2A',\n\tMinusPlus: '\\u2213',\n\tmlcp: '\\u2ADB',\n\tmldr: '\\u2026',\n\tmnplus: '\\u2213',\n\tmodels: '\\u22A7',\n\tMopf: '\\uD835\\uDD44',\n\tmopf: '\\uD835\\uDD5E',\n\tmp: '\\u2213',\n\tMscr: '\\u2133',\n\tmscr: '\\uD835\\uDCC2',\n\tmstpos: '\\u223E',\n\tMu: '\\u039C',\n\tmu: '\\u03BC',\n\tmultimap: '\\u22B8',\n\tmumap: '\\u22B8',\n\tnabla: '\\u2207',\n\tNacute: '\\u0143',\n\tnacute: '\\u0144',\n\tnang: '\\u2220\\u20D2',\n\tnap: '\\u2249',\n\tnapE: '\\u2A70\\u0338',\n\tnapid: '\\u224B\\u0338',\n\tnapos: '\\u0149',\n\tnapprox: '\\u2249',\n\tnatur: '\\u266E',\n\tnatural: '\\u266E',\n\tnaturals: '\\u2115',\n\tnbsp: '\\u00A0',\n\tnbump: '\\u224E\\u0338',\n\tnbumpe: '\\u224F\\u0338',\n\tncap: '\\u2A43',\n\tNcaron: '\\u0147',\n\tncaron: '\\u0148',\n\tNcedil: '\\u0145',\n\tncedil: '\\u0146',\n\tncong: '\\u2247',\n\tncongdot: '\\u2A6D\\u0338',\n\tncup: '\\u2A42',\n\tNcy: '\\u041D',\n\tncy: '\\u043D',\n\tndash: '\\u2013',\n\tne: '\\u2260',\n\tnearhk: '\\u2924',\n\tneArr: '\\u21D7',\n\tnearr: '\\u2197',\n\tnearrow: '\\u2197',\n\tnedot: '\\u2250\\u0338',\n\tNegativeMediumSpace: '\\u200B',\n\tNegativeThickSpace: '\\u200B',\n\tNegativeThinSpace: '\\u200B',\n\tNegativeVeryThinSpace: '\\u200B',\n\tnequiv: '\\u2262',\n\tnesear: '\\u2928',\n\tnesim: '\\u2242\\u0338',\n\tNestedGreaterGreater: '\\u226B',\n\tNestedLessLess: '\\u226A',\n\tNewLine: '\\u000A',\n\tnexist: '\\u2204',\n\tnexists: '\\u2204',\n\tNfr: '\\uD835\\uDD11',\n\tnfr: '\\uD835\\uDD2B',\n\tngE: '\\u2267\\u0338',\n\tnge: '\\u2271',\n\tngeq: '\\u2271',\n\tngeqq: '\\u2267\\u0338',\n\tngeqslant: '\\u2A7E\\u0338',\n\tnges: '\\u2A7E\\u0338',\n\tnGg: '\\u22D9\\u0338',\n\tngsim: '\\u2275',\n\tnGt: '\\u226B\\u20D2',\n\tngt: '\\u226F',\n\tngtr: '\\u226F',\n\tnGtv: '\\u226B\\u0338',\n\tnhArr: '\\u21CE',\n\tnharr: '\\u21AE',\n\tnhpar: '\\u2AF2',\n\tni: '\\u220B',\n\tnis: '\\u22FC',\n\tnisd: '\\u22FA',\n\tniv: '\\u220B',\n\tNJcy: '\\u040A',\n\tnjcy: '\\u045A',\n\tnlArr: '\\u21CD',\n\tnlarr: '\\u219A',\n\tnldr: '\\u2025',\n\tnlE: '\\u2266\\u0338',\n\tnle: '\\u2270',\n\tnLeftarrow: '\\u21CD',\n\tnleftarrow: '\\u219A',\n\tnLeftrightarrow: '\\u21CE',\n\tnleftrightarrow: '\\u21AE',\n\tnleq: '\\u2270',\n\tnleqq: '\\u2266\\u0338',\n\tnleqslant: '\\u2A7D\\u0338',\n\tnles: '\\u2A7D\\u0338',\n\tnless: '\\u226E',\n\tnLl: '\\u22D8\\u0338',\n\tnlsim: '\\u2274',\n\tnLt: '\\u226A\\u20D2',\n\tnlt: '\\u226E',\n\tnltri: '\\u22EA',\n\tnltrie: '\\u22EC',\n\tnLtv: '\\u226A\\u0338',\n\tnmid: '\\u2224',\n\tNoBreak: '\\u2060',\n\tNonBreakingSpace: '\\u00A0',\n\tNopf: '\\u2115',\n\tnopf: '\\uD835\\uDD5F',\n\tNot: '\\u2AEC',\n\tnot: '\\u00AC',\n\tNotCongruent: '\\u2262',\n\tNotCupCap: '\\u226D',\n\tNotDoubleVerticalBar: '\\u2226',\n\tNotElement: '\\u2209',\n\tNotEqual: '\\u2260',\n\tNotEqualTilde: '\\u2242\\u0338',\n\tNotExists: '\\u2204',\n\tNotGreater: '\\u226F',\n\tNotGreaterEqual: '\\u2271',\n\tNotGreaterFullEqual: '\\u2267\\u0338',\n\tNotGreaterGreater: '\\u226B\\u0338',\n\tNotGreaterLess: '\\u2279',\n\tNotGreaterSlantEqual: '\\u2A7E\\u0338',\n\tNotGreaterTilde: '\\u2275',\n\tNotHumpDownHump: '\\u224E\\u0338',\n\tNotHumpEqual: '\\u224F\\u0338',\n\tnotin: '\\u2209',\n\tnotindot: '\\u22F5\\u0338',\n\tnotinE: '\\u22F9\\u0338',\n\tnotinva: '\\u2209',\n\tnotinvb: '\\u22F7',\n\tnotinvc: '\\u22F6',\n\tNotLeftTriangle: '\\u22EA',\n\tNotLeftTriangleBar: '\\u29CF\\u0338',\n\tNotLeftTriangleEqual: '\\u22EC',\n\tNotLess: '\\u226E',\n\tNotLessEqual: '\\u2270',\n\tNotLessGreater: '\\u2278',\n\tNotLessLess: '\\u226A\\u0338',\n\tNotLessSlantEqual: '\\u2A7D\\u0338',\n\tNotLessTilde: '\\u2274',\n\tNotNestedGreaterGreater: '\\u2AA2\\u0338',\n\tNotNestedLessLess: '\\u2AA1\\u0338',\n\tnotni: '\\u220C',\n\tnotniva: '\\u220C',\n\tnotnivb: '\\u22FE',\n\tnotnivc: '\\u22FD',\n\tNotPrecedes: '\\u2280',\n\tNotPrecedesEqual: '\\u2AAF\\u0338',\n\tNotPrecedesSlantEqual: '\\u22E0',\n\tNotReverseElement: '\\u220C',\n\tNotRightTriangle: '\\u22EB',\n\tNotRightTriangleBar: '\\u29D0\\u0338',\n\tNotRightTriangleEqual: '\\u22ED',\n\tNotSquareSubset: '\\u228F\\u0338',\n\tNotSquareSubsetEqual: '\\u22E2',\n\tNotSquareSuperset: '\\u2290\\u0338',\n\tNotSquareSupersetEqual: '\\u22E3',\n\tNotSubset: '\\u2282\\u20D2',\n\tNotSubsetEqual: '\\u2288',\n\tNotSucceeds: '\\u2281',\n\tNotSucceedsEqual: '\\u2AB0\\u0338',\n\tNotSucceedsSlantEqual: '\\u22E1',\n\tNotSucceedsTilde: '\\u227F\\u0338',\n\tNotSuperset: '\\u2283\\u20D2',\n\tNotSupersetEqual: '\\u2289',\n\tNotTilde: '\\u2241',\n\tNotTildeEqual: '\\u2244',\n\tNotTildeFullEqual: '\\u2247',\n\tNotTildeTilde: '\\u2249',\n\tNotVerticalBar: '\\u2224',\n\tnpar: '\\u2226',\n\tnparallel: '\\u2226',\n\tnparsl: '\\u2AFD\\u20E5',\n\tnpart: '\\u2202\\u0338',\n\tnpolint: '\\u2A14',\n\tnpr: '\\u2280',\n\tnprcue: '\\u22E0',\n\tnpre: '\\u2AAF\\u0338',\n\tnprec: '\\u2280',\n\tnpreceq: '\\u2AAF\\u0338',\n\tnrArr: '\\u21CF',\n\tnrarr: '\\u219B',\n\tnrarrc: '\\u2933\\u0338',\n\tnrarrw: '\\u219D\\u0338',\n\tnRightarrow: '\\u21CF',\n\tnrightarrow: '\\u219B',\n\tnrtri: '\\u22EB',\n\tnrtrie: '\\u22ED',\n\tnsc: '\\u2281',\n\tnsccue: '\\u22E1',\n\tnsce: '\\u2AB0\\u0338',\n\tNscr: '\\uD835\\uDCA9',\n\tnscr: '\\uD835\\uDCC3',\n\tnshortmid: '\\u2224',\n\tnshortparallel: '\\u2226',\n\tnsim: '\\u2241',\n\tnsime: '\\u2244',\n\tnsimeq: '\\u2244',\n\tnsmid: '\\u2224',\n\tnspar: '\\u2226',\n\tnsqsube: '\\u22E2',\n\tnsqsupe: '\\u22E3',\n\tnsub: '\\u2284',\n\tnsubE: '\\u2AC5\\u0338',\n\tnsube: '\\u2288',\n\tnsubset: '\\u2282\\u20D2',\n\tnsubseteq: '\\u2288',\n\tnsubseteqq: '\\u2AC5\\u0338',\n\tnsucc: '\\u2281',\n\tnsucceq: '\\u2AB0\\u0338',\n\tnsup: '\\u2285',\n\tnsupE: '\\u2AC6\\u0338',\n\tnsupe: '\\u2289',\n\tnsupset: '\\u2283\\u20D2',\n\tnsupseteq: '\\u2289',\n\tnsupseteqq: '\\u2AC6\\u0338',\n\tntgl: '\\u2279',\n\tNtilde: '\\u00D1',\n\tntilde: '\\u00F1',\n\tntlg: '\\u2278',\n\tntriangleleft: '\\u22EA',\n\tntrianglelefteq: '\\u22EC',\n\tntriangleright: '\\u22EB',\n\tntrianglerighteq: '\\u22ED',\n\tNu: '\\u039D',\n\tnu: '\\u03BD',\n\tnum: '\\u0023',\n\tnumero: '\\u2116',\n\tnumsp: '\\u2007',\n\tnvap: '\\u224D\\u20D2',\n\tnVDash: '\\u22AF',\n\tnVdash: '\\u22AE',\n\tnvDash: '\\u22AD',\n\tnvdash: '\\u22AC',\n\tnvge: '\\u2265\\u20D2',\n\tnvgt: '\\u003E\\u20D2',\n\tnvHarr: '\\u2904',\n\tnvinfin: '\\u29DE',\n\tnvlArr: '\\u2902',\n\tnvle: '\\u2264\\u20D2',\n\tnvlt: '\\u003C\\u20D2',\n\tnvltrie: '\\u22B4\\u20D2',\n\tnvrArr: '\\u2903',\n\tnvrtrie: '\\u22B5\\u20D2',\n\tnvsim: '\\u223C\\u20D2',\n\tnwarhk: '\\u2923',\n\tnwArr: '\\u21D6',\n\tnwarr: '\\u2196',\n\tnwarrow: '\\u2196',\n\tnwnear: '\\u2927',\n\tOacute: '\\u00D3',\n\toacute: '\\u00F3',\n\toast: '\\u229B',\n\tocir: '\\u229A',\n\tOcirc: '\\u00D4',\n\tocirc: '\\u00F4',\n\tOcy: '\\u041E',\n\tocy: '\\u043E',\n\todash: '\\u229D',\n\tOdblac: '\\u0150',\n\todblac: '\\u0151',\n\todiv: '\\u2A38',\n\todot: '\\u2299',\n\todsold: '\\u29BC',\n\tOElig: '\\u0152',\n\toelig: '\\u0153',\n\tofcir: '\\u29BF',\n\tOfr: '\\uD835\\uDD12',\n\tofr: '\\uD835\\uDD2C',\n\togon: '\\u02DB',\n\tOgrave: '\\u00D2',\n\tograve: '\\u00F2',\n\togt: '\\u29C1',\n\tohbar: '\\u29B5',\n\tohm: '\\u03A9',\n\toint: '\\u222E',\n\tolarr: '\\u21BA',\n\tolcir: '\\u29BE',\n\tolcross: '\\u29BB',\n\toline: '\\u203E',\n\tolt: '\\u29C0',\n\tOmacr: '\\u014C',\n\tomacr: '\\u014D',\n\tOmega: '\\u03A9',\n\tomega: '\\u03C9',\n\tOmicron: '\\u039F',\n\tomicron: '\\u03BF',\n\tomid: '\\u29B6',\n\tominus: '\\u2296',\n\tOopf: '\\uD835\\uDD46',\n\toopf: '\\uD835\\uDD60',\n\topar: '\\u29B7',\n\tOpenCurlyDoubleQuote: '\\u201C',\n\tOpenCurlyQuote: '\\u2018',\n\toperp: '\\u29B9',\n\toplus: '\\u2295',\n\tOr: '\\u2A54',\n\tor: '\\u2228',\n\torarr: '\\u21BB',\n\tord: '\\u2A5D',\n\torder: '\\u2134',\n\torderof: '\\u2134',\n\tordf: '\\u00AA',\n\tordm: '\\u00BA',\n\torigof: '\\u22B6',\n\toror: '\\u2A56',\n\torslope: '\\u2A57',\n\torv: '\\u2A5B',\n\toS: '\\u24C8',\n\tOscr: '\\uD835\\uDCAA',\n\toscr: '\\u2134',\n\tOslash: '\\u00D8',\n\toslash: '\\u00F8',\n\tosol: '\\u2298',\n\tOtilde: '\\u00D5',\n\totilde: '\\u00F5',\n\tOtimes: '\\u2A37',\n\totimes: '\\u2297',\n\totimesas: '\\u2A36',\n\tOuml: '\\u00D6',\n\touml: '\\u00F6',\n\tovbar: '\\u233D',\n\tOverBar: '\\u203E',\n\tOverBrace: '\\u23DE',\n\tOverBracket: '\\u23B4',\n\tOverParenthesis: '\\u23DC',\n\tpar: '\\u2225',\n\tpara: '\\u00B6',\n\tparallel: '\\u2225',\n\tparsim: '\\u2AF3',\n\tparsl: '\\u2AFD',\n\tpart: '\\u2202',\n\tPartialD: '\\u2202',\n\tPcy: '\\u041F',\n\tpcy: '\\u043F',\n\tpercnt: '\\u0025',\n\tperiod: '\\u002E',\n\tpermil: '\\u2030',\n\tperp: '\\u22A5',\n\tpertenk: '\\u2031',\n\tPfr: '\\uD835\\uDD13',\n\tpfr: '\\uD835\\uDD2D',\n\tPhi: '\\u03A6',\n\tphi: '\\u03C6',\n\tphiv: '\\u03D5',\n\tphmmat: '\\u2133',\n\tphone: '\\u260E',\n\tPi: '\\u03A0',\n\tpi: '\\u03C0',\n\tpitchfork: '\\u22D4',\n\tpiv: '\\u03D6',\n\tplanck: '\\u210F',\n\tplanckh: '\\u210E',\n\tplankv: '\\u210F',\n\tplus: '\\u002B',\n\tplusacir: '\\u2A23',\n\tplusb: '\\u229E',\n\tpluscir: '\\u2A22',\n\tplusdo: '\\u2214',\n\tplusdu: '\\u2A25',\n\tpluse: '\\u2A72',\n\tPlusMinus: '\\u00B1',\n\tplusmn: '\\u00B1',\n\tplussim: '\\u2A26',\n\tplustwo: '\\u2A27',\n\tpm: '\\u00B1',\n\tPoincareplane: '\\u210C',\n\tpointint: '\\u2A15',\n\tPopf: '\\u2119',\n\tpopf: '\\uD835\\uDD61',\n\tpound: '\\u00A3',\n\tPr: '\\u2ABB',\n\tpr: '\\u227A',\n\tprap: '\\u2AB7',\n\tprcue: '\\u227C',\n\tprE: '\\u2AB3',\n\tpre: '\\u2AAF',\n\tprec: '\\u227A',\n\tprecapprox: '\\u2AB7',\n\tpreccurlyeq: '\\u227C',\n\tPrecedes: '\\u227A',\n\tPrecedesEqual: '\\u2AAF',\n\tPrecedesSlantEqual: '\\u227C',\n\tPrecedesTilde: '\\u227E',\n\tpreceq: '\\u2AAF',\n\tprecnapprox: '\\u2AB9',\n\tprecneqq: '\\u2AB5',\n\tprecnsim: '\\u22E8',\n\tprecsim: '\\u227E',\n\tPrime: '\\u2033',\n\tprime: '\\u2032',\n\tprimes: '\\u2119',\n\tprnap: '\\u2AB9',\n\tprnE: '\\u2AB5',\n\tprnsim: '\\u22E8',\n\tprod: '\\u220F',\n\tProduct: '\\u220F',\n\tprofalar: '\\u232E',\n\tprofline: '\\u2312',\n\tprofsurf: '\\u2313',\n\tprop: '\\u221D',\n\tProportion: '\\u2237',\n\tProportional: '\\u221D',\n\tpropto: '\\u221D',\n\tprsim: '\\u227E',\n\tprurel: '\\u22B0',\n\tPscr: '\\uD835\\uDCAB',\n\tpscr: '\\uD835\\uDCC5',\n\tPsi: '\\u03A8',\n\tpsi: '\\u03C8',\n\tpuncsp: '\\u2008',\n\tQfr: '\\uD835\\uDD14',\n\tqfr: '\\uD835\\uDD2E',\n\tqint: '\\u2A0C',\n\tQopf: '\\u211A',\n\tqopf: '\\uD835\\uDD62',\n\tqprime: '\\u2057',\n\tQscr: '\\uD835\\uDCAC',\n\tqscr: '\\uD835\\uDCC6',\n\tquaternions: '\\u210D',\n\tquatint: '\\u2A16',\n\tquest: '\\u003F',\n\tquesteq: '\\u225F',\n\tQUOT: '\\u0022',\n\tquot: '\\u0022',\n\trAarr: '\\u21DB',\n\trace: '\\u223D\\u0331',\n\tRacute: '\\u0154',\n\tracute: '\\u0155',\n\tradic: '\\u221A',\n\traemptyv: '\\u29B3',\n\tRang: '\\u27EB',\n\trang: '\\u27E9',\n\trangd: '\\u2992',\n\trange: '\\u29A5',\n\trangle: '\\u27E9',\n\traquo: '\\u00BB',\n\tRarr: '\\u21A0',\n\trArr: '\\u21D2',\n\trarr: '\\u2192',\n\trarrap: '\\u2975',\n\trarrb: '\\u21E5',\n\trarrbfs: '\\u2920',\n\trarrc: '\\u2933',\n\trarrfs: '\\u291E',\n\trarrhk: '\\u21AA',\n\trarrlp: '\\u21AC',\n\trarrpl: '\\u2945',\n\trarrsim: '\\u2974',\n\tRarrtl: '\\u2916',\n\trarrtl: '\\u21A3',\n\trarrw: '\\u219D',\n\trAtail: '\\u291C',\n\tratail: '\\u291A',\n\tratio: '\\u2236',\n\trationals: '\\u211A',\n\tRBarr: '\\u2910',\n\trBarr: '\\u290F',\n\trbarr: '\\u290D',\n\trbbrk: '\\u2773',\n\trbrace: '\\u007D',\n\trbrack: '\\u005D',\n\trbrke: '\\u298C',\n\trbrksld: '\\u298E',\n\trbrkslu: '\\u2990',\n\tRcaron: '\\u0158',\n\trcaron: '\\u0159',\n\tRcedil: '\\u0156',\n\trcedil: '\\u0157',\n\trceil: '\\u2309',\n\trcub: '\\u007D',\n\tRcy: '\\u0420',\n\trcy: '\\u0440',\n\trdca: '\\u2937',\n\trdldhar: '\\u2969',\n\trdquo: '\\u201D',\n\trdquor: '\\u201D',\n\trdsh: '\\u21B3',\n\tRe: '\\u211C',\n\treal: '\\u211C',\n\trealine: '\\u211B',\n\trealpart: '\\u211C',\n\treals: '\\u211D',\n\trect: '\\u25AD',\n\tREG: '\\u00AE',\n\treg: '\\u00AE',\n\tReverseElement: '\\u220B',\n\tReverseEquilibrium: '\\u21CB',\n\tReverseUpEquilibrium: '\\u296F',\n\trfisht: '\\u297D',\n\trfloor: '\\u230B',\n\tRfr: '\\u211C',\n\trfr: '\\uD835\\uDD2F',\n\trHar: '\\u2964',\n\trhard: '\\u21C1',\n\trharu: '\\u21C0',\n\trharul: '\\u296C',\n\tRho: '\\u03A1',\n\trho: '\\u03C1',\n\trhov: '\\u03F1',\n\tRightAngleBracket: '\\u27E9',\n\tRightArrow: '\\u2192',\n\tRightarrow: '\\u21D2',\n\trightarrow: '\\u2192',\n\tRightArrowBar: '\\u21E5',\n\tRightArrowLeftArrow: '\\u21C4',\n\trightarrowtail: '\\u21A3',\n\tRightCeiling: '\\u2309',\n\tRightDoubleBracket: '\\u27E7',\n\tRightDownTeeVector: '\\u295D',\n\tRightDownVector: '\\u21C2',\n\tRightDownVectorBar: '\\u2955',\n\tRightFloor: '\\u230B',\n\trightharpoondown: '\\u21C1',\n\trightharpoonup: '\\u21C0',\n\trightleftarrows: '\\u21C4',\n\trightleftharpoons: '\\u21CC',\n\trightrightarrows: '\\u21C9',\n\trightsquigarrow: '\\u219D',\n\tRightTee: '\\u22A2',\n\tRightTeeArrow: '\\u21A6',\n\tRightTeeVector: '\\u295B',\n\trightthreetimes: '\\u22CC',\n\tRightTriangle: '\\u22B3',\n\tRightTriangleBar: '\\u29D0',\n\tRightTriangleEqual: '\\u22B5',\n\tRightUpDownVector: '\\u294F',\n\tRightUpTeeVector: '\\u295C',\n\tRightUpVector: '\\u21BE',\n\tRightUpVectorBar: '\\u2954',\n\tRightVector: '\\u21C0',\n\tRightVectorBar: '\\u2953',\n\tring: '\\u02DA',\n\trisingdotseq: '\\u2253',\n\trlarr: '\\u21C4',\n\trlhar: '\\u21CC',\n\trlm: '\\u200F',\n\trmoust: '\\u23B1',\n\trmoustache: '\\u23B1',\n\trnmid: '\\u2AEE',\n\troang: '\\u27ED',\n\troarr: '\\u21FE',\n\trobrk: '\\u27E7',\n\tropar: '\\u2986',\n\tRopf: '\\u211D',\n\tropf: '\\uD835\\uDD63',\n\troplus: '\\u2A2E',\n\trotimes: '\\u2A35',\n\tRoundImplies: '\\u2970',\n\trpar: '\\u0029',\n\trpargt: '\\u2994',\n\trppolint: '\\u2A12',\n\trrarr: '\\u21C9',\n\tRrightarrow: '\\u21DB',\n\trsaquo: '\\u203A',\n\tRscr: '\\u211B',\n\trscr: '\\uD835\\uDCC7',\n\tRsh: '\\u21B1',\n\trsh: '\\u21B1',\n\trsqb: '\\u005D',\n\trsquo: '\\u2019',\n\trsquor: '\\u2019',\n\trthree: '\\u22CC',\n\trtimes: '\\u22CA',\n\trtri: '\\u25B9',\n\trtrie: '\\u22B5',\n\trtrif: '\\u25B8',\n\trtriltri: '\\u29CE',\n\tRuleDelayed: '\\u29F4',\n\truluhar: '\\u2968',\n\trx: '\\u211E',\n\tSacute: '\\u015A',\n\tsacute: '\\u015B',\n\tsbquo: '\\u201A',\n\tSc: '\\u2ABC',\n\tsc: '\\u227B',\n\tscap: '\\u2AB8',\n\tScaron: '\\u0160',\n\tscaron: '\\u0161',\n\tsccue: '\\u227D',\n\tscE: '\\u2AB4',\n\tsce: '\\u2AB0',\n\tScedil: '\\u015E',\n\tscedil: '\\u015F',\n\tScirc: '\\u015C',\n\tscirc: '\\u015D',\n\tscnap: '\\u2ABA',\n\tscnE: '\\u2AB6',\n\tscnsim: '\\u22E9',\n\tscpolint: '\\u2A13',\n\tscsim: '\\u227F',\n\tScy: '\\u0421',\n\tscy: '\\u0441',\n\tsdot: '\\u22C5',\n\tsdotb: '\\u22A1',\n\tsdote: '\\u2A66',\n\tsearhk: '\\u2925',\n\tseArr: '\\u21D8',\n\tsearr: '\\u2198',\n\tsearrow: '\\u2198',\n\tsect: '\\u00A7',\n\tsemi: '\\u003B',\n\tseswar: '\\u2929',\n\tsetminus: '\\u2216',\n\tsetmn: '\\u2216',\n\tsext: '\\u2736',\n\tSfr: '\\uD835\\uDD16',\n\tsfr: '\\uD835\\uDD30',\n\tsfrown: '\\u2322',\n\tsharp: '\\u266F',\n\tSHCHcy: '\\u0429',\n\tshchcy: '\\u0449',\n\tSHcy: '\\u0428',\n\tshcy: '\\u0448',\n\tShortDownArrow: '\\u2193',\n\tShortLeftArrow: '\\u2190',\n\tshortmid: '\\u2223',\n\tshortparallel: '\\u2225',\n\tShortRightArrow: '\\u2192',\n\tShortUpArrow: '\\u2191',\n\tshy: '\\u00AD',\n\tSigma: '\\u03A3',\n\tsigma: '\\u03C3',\n\tsigmaf: '\\u03C2',\n\tsigmav: '\\u03C2',\n\tsim: '\\u223C',\n\tsimdot: '\\u2A6A',\n\tsime: '\\u2243',\n\tsimeq: '\\u2243',\n\tsimg: '\\u2A9E',\n\tsimgE: '\\u2AA0',\n\tsiml: '\\u2A9D',\n\tsimlE: '\\u2A9F',\n\tsimne: '\\u2246',\n\tsimplus: '\\u2A24',\n\tsimrarr: '\\u2972',\n\tslarr: '\\u2190',\n\tSmallCircle: '\\u2218',\n\tsmallsetminus: '\\u2216',\n\tsmashp: '\\u2A33',\n\tsmeparsl: '\\u29E4',\n\tsmid: '\\u2223',\n\tsmile: '\\u2323',\n\tsmt: '\\u2AAA',\n\tsmte: '\\u2AAC',\n\tsmtes: '\\u2AAC\\uFE00',\n\tSOFTcy: '\\u042C',\n\tsoftcy: '\\u044C',\n\tsol: '\\u002F',\n\tsolb: '\\u29C4',\n\tsolbar: '\\u233F',\n\tSopf: '\\uD835\\uDD4A',\n\tsopf: '\\uD835\\uDD64',\n\tspades: '\\u2660',\n\tspadesuit: '\\u2660',\n\tspar: '\\u2225',\n\tsqcap: '\\u2293',\n\tsqcaps: '\\u2293\\uFE00',\n\tsqcup: '\\u2294',\n\tsqcups: '\\u2294\\uFE00',\n\tSqrt: '\\u221A',\n\tsqsub: '\\u228F',\n\tsqsube: '\\u2291',\n\tsqsubset: '\\u228F',\n\tsqsubseteq: '\\u2291',\n\tsqsup: '\\u2290',\n\tsqsupe: '\\u2292',\n\tsqsupset: '\\u2290',\n\tsqsupseteq: '\\u2292',\n\tsqu: '\\u25A1',\n\tSquare: '\\u25A1',\n\tsquare: '\\u25A1',\n\tSquareIntersection: '\\u2293',\n\tSquareSubset: '\\u228F',\n\tSquareSubsetEqual: '\\u2291',\n\tSquareSuperset: '\\u2290',\n\tSquareSupersetEqual: '\\u2292',\n\tSquareUnion: '\\u2294',\n\tsquarf: '\\u25AA',\n\tsquf: '\\u25AA',\n\tsrarr: '\\u2192',\n\tSscr: '\\uD835\\uDCAE',\n\tsscr: '\\uD835\\uDCC8',\n\tssetmn: '\\u2216',\n\tssmile: '\\u2323',\n\tsstarf: '\\u22C6',\n\tStar: '\\u22C6',\n\tstar: '\\u2606',\n\tstarf: '\\u2605',\n\tstraightepsilon: '\\u03F5',\n\tstraightphi: '\\u03D5',\n\tstrns: '\\u00AF',\n\tSub: '\\u22D0',\n\tsub: '\\u2282',\n\tsubdot: '\\u2ABD',\n\tsubE: '\\u2AC5',\n\tsube: '\\u2286',\n\tsubedot: '\\u2AC3',\n\tsubmult: '\\u2AC1',\n\tsubnE: '\\u2ACB',\n\tsubne: '\\u228A',\n\tsubplus: '\\u2ABF',\n\tsubrarr: '\\u2979',\n\tSubset: '\\u22D0',\n\tsubset: '\\u2282',\n\tsubseteq: '\\u2286',\n\tsubseteqq: '\\u2AC5',\n\tSubsetEqual: '\\u2286',\n\tsubsetneq: '\\u228A',\n\tsubsetneqq: '\\u2ACB',\n\tsubsim: '\\u2AC7',\n\tsubsub: '\\u2AD5',\n\tsubsup: '\\u2AD3',\n\tsucc: '\\u227B',\n\tsuccapprox: '\\u2AB8',\n\tsucccurlyeq: '\\u227D',\n\tSucceeds: '\\u227B',\n\tSucceedsEqual: '\\u2AB0',\n\tSucceedsSlantEqual: '\\u227D',\n\tSucceedsTilde: '\\u227F',\n\tsucceq: '\\u2AB0',\n\tsuccnapprox: '\\u2ABA',\n\tsuccneqq: '\\u2AB6',\n\tsuccnsim: '\\u22E9',\n\tsuccsim: '\\u227F',\n\tSuchThat: '\\u220B',\n\tSum: '\\u2211',\n\tsum: '\\u2211',\n\tsung: '\\u266A',\n\tSup: '\\u22D1',\n\tsup: '\\u2283',\n\tsup1: '\\u00B9',\n\tsup2: '\\u00B2',\n\tsup3: '\\u00B3',\n\tsupdot: '\\u2ABE',\n\tsupdsub: '\\u2AD8',\n\tsupE: '\\u2AC6',\n\tsupe: '\\u2287',\n\tsupedot: '\\u2AC4',\n\tSuperset: '\\u2283',\n\tSupersetEqual: '\\u2287',\n\tsuphsol: '\\u27C9',\n\tsuphsub: '\\u2AD7',\n\tsuplarr: '\\u297B',\n\tsupmult: '\\u2AC2',\n\tsupnE: '\\u2ACC',\n\tsupne: '\\u228B',\n\tsupplus: '\\u2AC0',\n\tSupset: '\\u22D1',\n\tsupset: '\\u2283',\n\tsupseteq: '\\u2287',\n\tsupseteqq: '\\u2AC6',\n\tsupsetneq: '\\u228B',\n\tsupsetneqq: '\\u2ACC',\n\tsupsim: '\\u2AC8',\n\tsupsub: '\\u2AD4',\n\tsupsup: '\\u2AD6',\n\tswarhk: '\\u2926',\n\tswArr: '\\u21D9',\n\tswarr: '\\u2199',\n\tswarrow: '\\u2199',\n\tswnwar: '\\u292A',\n\tszlig: '\\u00DF',\n\tTab: '\\u0009',\n\ttarget: '\\u2316',\n\tTau: '\\u03A4',\n\ttau: '\\u03C4',\n\ttbrk: '\\u23B4',\n\tTcaron: '\\u0164',\n\ttcaron: '\\u0165',\n\tTcedil: '\\u0162',\n\ttcedil: '\\u0163',\n\tTcy: '\\u0422',\n\ttcy: '\\u0442',\n\ttdot: '\\u20DB',\n\ttelrec: '\\u2315',\n\tTfr: '\\uD835\\uDD17',\n\ttfr: '\\uD835\\uDD31',\n\tthere4: '\\u2234',\n\tTherefore: '\\u2234',\n\ttherefore: '\\u2234',\n\tTheta: '\\u0398',\n\ttheta: '\\u03B8',\n\tthetasym: '\\u03D1',\n\tthetav: '\\u03D1',\n\tthickapprox: '\\u2248',\n\tthicksim: '\\u223C',\n\tThickSpace: '\\u205F\\u200A',\n\tthinsp: '\\u2009',\n\tThinSpace: '\\u2009',\n\tthkap: '\\u2248',\n\tthksim: '\\u223C',\n\tTHORN: '\\u00DE',\n\tthorn: '\\u00FE',\n\tTilde: '\\u223C',\n\ttilde: '\\u02DC',\n\tTildeEqual: '\\u2243',\n\tTildeFullEqual: '\\u2245',\n\tTildeTilde: '\\u2248',\n\ttimes: '\\u00D7',\n\ttimesb: '\\u22A0',\n\ttimesbar: '\\u2A31',\n\ttimesd: '\\u2A30',\n\ttint: '\\u222D',\n\ttoea: '\\u2928',\n\ttop: '\\u22A4',\n\ttopbot: '\\u2336',\n\ttopcir: '\\u2AF1',\n\tTopf: '\\uD835\\uDD4B',\n\ttopf: '\\uD835\\uDD65',\n\ttopfork: '\\u2ADA',\n\ttosa: '\\u2929',\n\ttprime: '\\u2034',\n\tTRADE: '\\u2122',\n\ttrade: '\\u2122',\n\ttriangle: '\\u25B5',\n\ttriangledown: '\\u25BF',\n\ttriangleleft: '\\u25C3',\n\ttrianglelefteq: '\\u22B4',\n\ttriangleq: '\\u225C',\n\ttriangleright: '\\u25B9',\n\ttrianglerighteq: '\\u22B5',\n\ttridot: '\\u25EC',\n\ttrie: '\\u225C',\n\ttriminus: '\\u2A3A',\n\tTripleDot: '\\u20DB',\n\ttriplus: '\\u2A39',\n\ttrisb: '\\u29CD',\n\ttritime: '\\u2A3B',\n\ttrpezium: '\\u23E2',\n\tTscr: '\\uD835\\uDCAF',\n\ttscr: '\\uD835\\uDCC9',\n\tTScy: '\\u0426',\n\ttscy: '\\u0446',\n\tTSHcy: '\\u040B',\n\ttshcy: '\\u045B',\n\tTstrok: '\\u0166',\n\ttstrok: '\\u0167',\n\ttwixt: '\\u226C',\n\ttwoheadleftarrow: '\\u219E',\n\ttwoheadrightarrow: '\\u21A0',\n\tUacute: '\\u00DA',\n\tuacute: '\\u00FA',\n\tUarr: '\\u219F',\n\tuArr: '\\u21D1',\n\tuarr: '\\u2191',\n\tUarrocir: '\\u2949',\n\tUbrcy: '\\u040E',\n\tubrcy: '\\u045E',\n\tUbreve: '\\u016C',\n\tubreve: '\\u016D',\n\tUcirc: '\\u00DB',\n\tucirc: '\\u00FB',\n\tUcy: '\\u0423',\n\tucy: '\\u0443',\n\tudarr: '\\u21C5',\n\tUdblac: '\\u0170',\n\tudblac: '\\u0171',\n\tudhar: '\\u296E',\n\tufisht: '\\u297E',\n\tUfr: '\\uD835\\uDD18',\n\tufr: '\\uD835\\uDD32',\n\tUgrave: '\\u00D9',\n\tugrave: '\\u00F9',\n\tuHar: '\\u2963',\n\tuharl: '\\u21BF',\n\tuharr: '\\u21BE',\n\tuhblk: '\\u2580',\n\tulcorn: '\\u231C',\n\tulcorner: '\\u231C',\n\tulcrop: '\\u230F',\n\tultri: '\\u25F8',\n\tUmacr: '\\u016A',\n\tumacr: '\\u016B',\n\tuml: '\\u00A8',\n\tUnderBar: '\\u005F',\n\tUnderBrace: '\\u23DF',\n\tUnderBracket: '\\u23B5',\n\tUnderParenthesis: '\\u23DD',\n\tUnion: '\\u22C3',\n\tUnionPlus: '\\u228E',\n\tUogon: '\\u0172',\n\tuogon: '\\u0173',\n\tUopf: '\\uD835\\uDD4C',\n\tuopf: '\\uD835\\uDD66',\n\tUpArrow: '\\u2191',\n\tUparrow: '\\u21D1',\n\tuparrow: '\\u2191',\n\tUpArrowBar: '\\u2912',\n\tUpArrowDownArrow: '\\u21C5',\n\tUpDownArrow: '\\u2195',\n\tUpdownarrow: '\\u21D5',\n\tupdownarrow: '\\u2195',\n\tUpEquilibrium: '\\u296E',\n\tupharpoonleft: '\\u21BF',\n\tupharpoonright: '\\u21BE',\n\tuplus: '\\u228E',\n\tUpperLeftArrow: '\\u2196',\n\tUpperRightArrow: '\\u2197',\n\tUpsi: '\\u03D2',\n\tupsi: '\\u03C5',\n\tupsih: '\\u03D2',\n\tUpsilon: '\\u03A5',\n\tupsilon: '\\u03C5',\n\tUpTee: '\\u22A5',\n\tUpTeeArrow: '\\u21A5',\n\tupuparrows: '\\u21C8',\n\turcorn: '\\u231D',\n\turcorner: '\\u231D',\n\turcrop: '\\u230E',\n\tUring: '\\u016E',\n\turing: '\\u016F',\n\turtri: '\\u25F9',\n\tUscr: '\\uD835\\uDCB0',\n\tuscr: '\\uD835\\uDCCA',\n\tutdot: '\\u22F0',\n\tUtilde: '\\u0168',\n\tutilde: '\\u0169',\n\tutri: '\\u25B5',\n\tutrif: '\\u25B4',\n\tuuarr: '\\u21C8',\n\tUuml: '\\u00DC',\n\tuuml: '\\u00FC',\n\tuwangle: '\\u29A7',\n\tvangrt: '\\u299C',\n\tvarepsilon: '\\u03F5',\n\tvarkappa: '\\u03F0',\n\tvarnothing: '\\u2205',\n\tvarphi: '\\u03D5',\n\tvarpi: '\\u03D6',\n\tvarpropto: '\\u221D',\n\tvArr: '\\u21D5',\n\tvarr: '\\u2195',\n\tvarrho: '\\u03F1',\n\tvarsigma: '\\u03C2',\n\tvarsubsetneq: '\\u228A\\uFE00',\n\tvarsubsetneqq: '\\u2ACB\\uFE00',\n\tvarsupsetneq: '\\u228B\\uFE00',\n\tvarsupsetneqq: '\\u2ACC\\uFE00',\n\tvartheta: '\\u03D1',\n\tvartriangleleft: '\\u22B2',\n\tvartriangleright: '\\u22B3',\n\tVbar: '\\u2AEB',\n\tvBar: '\\u2AE8',\n\tvBarv: '\\u2AE9',\n\tVcy: '\\u0412',\n\tvcy: '\\u0432',\n\tVDash: '\\u22AB',\n\tVdash: '\\u22A9',\n\tvDash: '\\u22A8',\n\tvdash: '\\u22A2',\n\tVdashl: '\\u2AE6',\n\tVee: '\\u22C1',\n\tvee: '\\u2228',\n\tveebar: '\\u22BB',\n\tveeeq: '\\u225A',\n\tvellip: '\\u22EE',\n\tVerbar: '\\u2016',\n\tverbar: '\\u007C',\n\tVert: '\\u2016',\n\tvert: '\\u007C',\n\tVerticalBar: '\\u2223',\n\tVerticalLine: '\\u007C',\n\tVerticalSeparator: '\\u2758',\n\tVerticalTilde: '\\u2240',\n\tVeryThinSpace: '\\u200A',\n\tVfr: '\\uD835\\uDD19',\n\tvfr: '\\uD835\\uDD33',\n\tvltri: '\\u22B2',\n\tvnsub: '\\u2282\\u20D2',\n\tvnsup: '\\u2283\\u20D2',\n\tVopf: '\\uD835\\uDD4D',\n\tvopf: '\\uD835\\uDD67',\n\tvprop: '\\u221D',\n\tvrtri: '\\u22B3',\n\tVscr: '\\uD835\\uDCB1',\n\tvscr: '\\uD835\\uDCCB',\n\tvsubnE: '\\u2ACB\\uFE00',\n\tvsubne: '\\u228A\\uFE00',\n\tvsupnE: '\\u2ACC\\uFE00',\n\tvsupne: '\\u228B\\uFE00',\n\tVvdash: '\\u22AA',\n\tvzigzag: '\\u299A',\n\tWcirc: '\\u0174',\n\twcirc: '\\u0175',\n\twedbar: '\\u2A5F',\n\tWedge: '\\u22C0',\n\twedge: '\\u2227',\n\twedgeq: '\\u2259',\n\tweierp: '\\u2118',\n\tWfr: '\\uD835\\uDD1A',\n\twfr: '\\uD835\\uDD34',\n\tWopf: '\\uD835\\uDD4E',\n\twopf: '\\uD835\\uDD68',\n\twp: '\\u2118',\n\twr: '\\u2240',\n\twreath: '\\u2240',\n\tWscr: '\\uD835\\uDCB2',\n\twscr: '\\uD835\\uDCCC',\n\txcap: '\\u22C2',\n\txcirc: '\\u25EF',\n\txcup: '\\u22C3',\n\txdtri: '\\u25BD',\n\tXfr: '\\uD835\\uDD1B',\n\txfr: '\\uD835\\uDD35',\n\txhArr: '\\u27FA',\n\txharr: '\\u27F7',\n\tXi: '\\u039E',\n\txi: '\\u03BE',\n\txlArr: '\\u27F8',\n\txlarr: '\\u27F5',\n\txmap: '\\u27FC',\n\txnis: '\\u22FB',\n\txodot: '\\u2A00',\n\tXopf: '\\uD835\\uDD4F',\n\txopf: '\\uD835\\uDD69',\n\txoplus: '\\u2A01',\n\txotime: '\\u2A02',\n\txrArr: '\\u27F9',\n\txrarr: '\\u27F6',\n\tXscr: '\\uD835\\uDCB3',\n\txscr: '\\uD835\\uDCCD',\n\txsqcup: '\\u2A06',\n\txuplus: '\\u2A04',\n\txutri: '\\u25B3',\n\txvee: '\\u22C1',\n\txwedge: '\\u22C0',\n\tYacute: '\\u00DD',\n\tyacute: '\\u00FD',\n\tYAcy: '\\u042F',\n\tyacy: '\\u044F',\n\tYcirc: '\\u0176',\n\tycirc: '\\u0177',\n\tYcy: '\\u042B',\n\tycy: '\\u044B',\n\tyen: '\\u00A5',\n\tYfr: '\\uD835\\uDD1C',\n\tyfr: '\\uD835\\uDD36',\n\tYIcy: '\\u0407',\n\tyicy: '\\u0457',\n\tYopf: '\\uD835\\uDD50',\n\tyopf: '\\uD835\\uDD6A',\n\tYscr: '\\uD835\\uDCB4',\n\tyscr: '\\uD835\\uDCCE',\n\tYUcy: '\\u042E',\n\tyucy: '\\u044E',\n\tYuml: '\\u0178',\n\tyuml: '\\u00FF',\n\tZacute: '\\u0179',\n\tzacute: '\\u017A',\n\tZcaron: '\\u017D',\n\tzcaron: '\\u017E',\n\tZcy: '\\u0417',\n\tzcy: '\\u0437',\n\tZdot: '\\u017B',\n\tzdot: '\\u017C',\n\tzeetrf: '\\u2128',\n\tZeroWidthSpace: '\\u200B',\n\tZeta: '\\u0396',\n\tzeta: '\\u03B6',\n\tZfr: '\\u2128',\n\tzfr: '\\uD835\\uDD37',\n\tZHcy: '\\u0416',\n\tzhcy: '\\u0436',\n\tzigrarr: '\\u21DD',\n\tZopf: '\\u2124',\n\tzopf: '\\uD835\\uDD6B',\n\tZscr: '\\uD835\\uDCB5',\n\tzscr: '\\uD835\\uDCCF',\n\tzwj: '\\u200D',\n\tzwnj: '\\u200C',\n});\n\n/**\n * @deprecated\n * Use `HTML_ENTITIES` instead.\n * @see {@link HTML_ENTITIES}\n */\nexports.entityMap = exports.HTML_ENTITIES;\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.events.condition;","import ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport GeocodeUtils from \"../../Utils/GeocodeUtils\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\nvar logger = Logger.getLogger(\"RouteDOM\");\n\nvar RouteDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProute\");\n        container.className = \"GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Show route control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRoutePictoElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var button = document.createElement(\"button\");\n        // INFO: Ajout d'une SPAN pour enlever des marges de 6px dans CHROMIUM (?!)\n        var span = document.createElement(\"span\");\n        button.appendChild(span);\n        button.id = this._addUID(\"GPshowRoutePicto\");\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowRoutePicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-route fr-btn fr-btn--tertiary\";\n        button.setAttribute(\"aria-label\", \"Ouvrir le calcul d'itinéraire\");\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie du calcul d'itiniraire\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowRoutePanelClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowRoutePanelClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    // ################################################################### //\n    // ################## Methods to display Inputs Panel ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createRoutePanelHeaderElement\n     * don't call this._createRoutePanelFormElement\n     * don't call this._createRoutePanelResultsElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelElement : function () {\n        var dialog = document.createElement(\"dialog\");\n        dialog.id = this._addUID(\"GProutePanel\");\n        dialog.className = \"GPpanel gpf-panel fr-modal\";\n\n        // dialog.appendChild(this._createRoutePanelHeaderElement());\n        // dialog.appendChild(this._createRoutePanelFormElement());\n        // dialog.appendChild(this._createRoutePanelResultsElement());\n\n        return dialog;\n    },\n\n    _createRoutePanelDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"gpf-panel__body fr-modal__body\";\n        return div;\n    },\n\n    _createDrawingButtonsPluginDiv : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"container-buttons-plugin fr-mx-2w\";\n        return div;\n    },\n    \n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelHeaderElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        div.innerHTML = \"Calcul d'itinéraire\";\n        container.appendChild(div);\n\n        var divClose = document.createElement(\"button\");\n        divClose.id = this._addUID(\"GProutePanelClose\");\n        divClose.className = \"GPpanelClose GProutePanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        divClose.title = \"Masquer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPshowRoutePicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPshowRoutePicto\")).click();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        divClose.appendChild(span);\n\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Create Footer Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFooterElement : function () {\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelFooter gpf-panel__footer fr-modal__footer\";\n\n        return container;\n    },\n\n    /**\n     * Create Point label\n     *\n     * @param {String} innerHTML text to display\n     * @param {Boolean} display should the label be dsiplayed?\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormPointLabel : function (innerHTML, display = true) {\n        var p = document.createElement(\"p\");\n        p.innerHTML = innerHTML;\n        var classesToAdd = !display ? \" GPelementHidden gpf-hidden\" : \"\";\n        p.className = \"GProutePointLabelP gpf-label fr-label\" + classesToAdd;\n\n        return p;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GProuteForm\");\n        form.className = \"gpf-panel__content fr-modal__content\";\n        form.setAttribute(\"onkeypress\", \"return event.keyCode != 13;\"); // FIXME hack pour desactiver l'execution via 'enter' au clavier !\n\n        form.addEventListener(\"submit\", function (e) {\n            logger.log(e);\n            e.preventDefault();\n\n            // points\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n\n            // Must have at least two origin points\n            var start = points[0].childNodes[0].id;\n            var end = points[points.length - 1].childNodes[0].id;\n            var startID = ID.index(start);\n            var endID = ID.index(end);\n\n            if ((document.getElementById(self._addUID(\"GPlocationOrigin_\" + startID)).value === \"\" &&\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + startID)).value === \"\") ||\n                (document.getElementById(self._addUID(\"GPlocationOrigin_\" + endID)).value === \"\" &&\n                    document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + endID)).value === \"\")) {\n                return false;\n            }\n\n            // Send stages to results panel\n            self._addRouteResultsStagesValuesElement(points);\n\n            // on peut récuperer les valeurs utiles pour les transmettre au service d'iti...\n            // - le mode de calcul\n            // - le mode de transport\n            // - les exclusions\n            // Les points sont déjà stockés dans l'application.\n\n            // computation mode params\n            var modeComputation = null;\n            if (document.getElementById(self._addUID(\"GProuteComputationChoice\"))) {\n                // plus rapide ?\n                if (document.getElementById(self._addUID(\"GProuteComputationFastest\"))) {\n                    if (document.getElementById(self._addUID(\"GProuteComputationFastest\")).checked) {\n                        modeComputation = document.getElementById(self._addUID(\"GProuteComputationFastest\")).value;\n                    }\n                }\n                // plus court ?\n                if (document.getElementById(self._addUID(\"GProuteComputationShortest\"))) {\n                    if (document.getElementById(self._addUID(\"GProuteComputationShortest\")).checked) {\n                        modeComputation = document.getElementById(self._addUID(\"GProuteComputationShortest\")).value;\n                    }\n                }\n            }\n\n            // transport mode params\n            var modeTransport = null;\n            // voiture ?\n            if (document.getElementById(self._addUID(\"GProuteTransportCar\"))) {\n                if (document.getElementById(self._addUID(\"GProuteTransportCar\")).checked) {\n                    modeTransport = document.getElementById(self._addUID(\"GProuteTransportCar\")).value;\n                }\n            }\n            // pieton ?\n            if (document.getElementById(self._addUID(\"GProuteTransportPedestrian\"))) {\n                if (document.getElementById(self._addUID(\"GProuteTransportPedestrian\")).checked) {\n                    modeTransport = document.getElementById(self._addUID(\"GProuteTransportPedestrian\")).value;\n                }\n            }\n\n            // exclusions params\n            var exclusions = [];\n            var exclusionsElement = document.getElementsByClassName(\"GProuteExclusionsOption\");\n            for (var j = 0; j < exclusionsElement.length; j++) {\n                var id = exclusionsElement[j].htmlFor;\n                var el = document.getElementById(id);\n                if (!el.checked) {\n                    exclusions.push(el.value);\n                }\n            }\n\n            self.onRouteComputationSubmit({\n                computation : modeComputation,\n                transport : modeTransport,\n                exclusions : exclusions\n            });\n\n            // FIXME mise à jour du controle dans le composant JS !\n            // document.getElementById(self._addUID(\"GProuteForm\")).className = \"GPelementHidden\";\n            // document.getElementById(self._addUID(\"GProuteResultsPanel\")).className = \"\";\n\n            return false;\n        });\n\n        return form;\n    },\n\n    /**\n     * Create Results Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelResultsElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProuteResultsPanel\");\n        container.className = \"GPelementHidden gpf-hidden\";\n\n        container.appendChild(this._createRouteResultsStagesElement());\n        container.appendChild(this._createRouteResultsElement());\n        container.appendChild(this._createRouteShowResultsDetailsElement());\n        container.appendChild(this._createRouteResultsDetailsElement());\n\n        return container;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteWaitingElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteCalcWaitingContainer\");\n        div.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPwaitingContainerInfo gpf-waiting_info\";\n        p.innerHTML = \"Recherche en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############### Methods to the window results ##################### //\n    // ################################################################### //\n\n    /**\n     * Create Results Stages\n     * (results dynamically generate !)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsStagesElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteResultsStages\");\n        return div;\n    },\n\n    /**\n     * Add Stages Results\n     *\n     * @param {DOMElement} points - list of points\n     */\n    _addRouteResultsStagesValuesElement : function (points) {\n        document.getElementById(this._addUID(\"GProuteResultsStages\")).innerHTML = \"\";\n        for (var i = 0; i < points.length; i++) {\n            var tag = points[i].childNodes[0].id;\n            var id = ID.index(tag);\n            if (document.getElementById(this._addUID(\"GPlocationPoint_\" + id)).className === \"GPflexInput GPlocationStageFlexInput gpf-flex\") {\n                var resultStage = document.createElement(\"div\");\n                resultStage.className = \"GProuteResultsStages fr-my-1w\";\n                var resultStageLabel = document.createElement(\"span\");\n                resultStageLabel.className = \"GProuteResultStageLabel\";\n                resultStageLabel.innerHTML = document.getElementById(this._addUID(\"GPlocationOriginLabel_\" + id)).innerHTML + \" : \";\n                resultStage.appendChild(resultStageLabel);\n                var resultStageValue = document.createElement(\"span\");\n                resultStageValue.className = \"GProuteResultStageValue\";\n                var elementCoords = document.getElementById(this._addUID(\"GPlocationOriginCoords_\" + id));\n                var stageCoords = elementCoords.value;\n                if (stageCoords !== null && stageCoords !== \"\") {\n                    resultStageValue.innerHTML = stageCoords;\n                } else {\n                    resultStageValue.innerHTML = document.getElementById(this._addUID(\"GPlocationOrigin_\" + id)).value;\n                }\n                resultStage.appendChild(resultStageValue);\n                if (resultStageValue.innerHTML !== \"\") {\n                    document.getElementById(this._addUID(\"GProuteResultsStages\")).appendChild(resultStage);\n                }\n            }\n        }\n    },\n\n    /**\n     * Create Show Results\n     * see event!\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsElement : function () {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProuteResults\");\n\n        // FIXME Route results are dynamically filled in Javascript by route service\n        var divValue = document.createElement(\"div\");\n        divValue.id = this._addUID(\"GProuteResultsValues\");\n        container.appendChild(divValue);\n\n        var divMode = document.createElement(\"div\");\n        divMode.id = this._addUID(\"GProuteResultsMode\");\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GProuteResultsComputationSelect\");\n        select.className = \"GPselect gpf-select fr-select\";\n        // gestionnaire d'evenement :\n        // on stocke la valeur du mode de calcul, et on relance le calcul d'itiniraire\n        select.addEventListener(\"change\", function (e) {\n            self.onRouteModeComputationChangeAndRun(e);\n        });\n\n        var computes = [{\n            code : \"fastest\",\n            label : \"Plus rapide\"\n        }, {\n            code : \"shortest\",\n            label : \"Plus court\"\n        }];\n\n        for (var i = 0; i < computes.length; i++) {\n            var option = document.createElement(\"option\");\n            option.value = computes[i].code;\n            option.text = computes[i].label;\n            select.appendChild(option);\n        }\n        divMode.appendChild(select);\n        container.appendChild(divMode);\n\n        var divNew = document.createElement(\"div\");\n        divNew.id = this._addUID(\"GProuteResultsNew\");\n        divNew.className = \"GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary\";\n        divNew.title = \"Modifier le calcul\";\n        divNew.addEventListener(\"click\", function (e) {\n            document.getElementById(self._addUID(\"GProuteResultsPanel\")).className = \"GPelementHidden gpf-hidden\";\n            document.getElementById(self._addUID(\"GProuteForm\")).className = \"gpf-panel__content fr-modal__content\";\n            self.onShowRouteResultsNewClick(e);\n        });\n        container.appendChild(divNew);\n\n        return container;\n    },\n\n    /**\n     * Add Results Duration and Distance\n     * (results dynamically generate !)\n     * see event!\n     * @param {Number} distance - distance\n     * @param {Number} duration - duration\n     * @param {Function} fconvert - fconvert\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _addRouteResultsValuesElement : function (distance, duration, fconvert) {\n        var div = document.getElementById(this._addUID(\"GProuteResultsValues\"));\n\n        // clean !\n        if (div.childElementCount) {\n            while (div.firstChild) {\n                div.removeChild(div.firstChild);\n            }\n        }\n\n        var containerDistance = document.createElement(\"div\");\n        containerDistance.className = \"GProuteResultsValue\";\n\n        var labelDistance = document.createElement(\"label\");\n        labelDistance.className = \"GProuteResultsValueLabel\";\n        labelDistance.innerHTML = \"Distance :\";\n        containerDistance.appendChild(labelDistance);\n\n        var distanceLabel = 0;\n        var isKm = parseInt(distance / 1000, 10);\n\n        if (!isKm) {\n            distanceLabel = Math.round(distance) + \" m\";\n        } else {\n            var distanceArrondi = Math.round(distance);\n            distanceArrondi = distanceArrondi / 1000;\n            distanceLabel = distanceArrondi + \" km\";\n        }\n\n        var divDistance = document.createElement(\"div\");\n        divDistance.id = this._addUID(\"GProuteResultsValueDist\");\n        divDistance.innerHTML = distanceLabel;\n        containerDistance.appendChild(divDistance);\n\n        div.appendChild(containerDistance);\n\n        var containerDuration = document.createElement(\"div\");\n        containerDuration.className = \"GProuteResultsValue\";\n\n        var labelDuration = document.createElement(\"label\");\n        labelDuration.className = \"GProuteResultsValueLabel\";\n        labelDuration.innerHTML = \"Durée :\";\n        containerDuration.appendChild(labelDuration);\n\n        var divDuration = document.createElement(\"div\");\n        divDuration.id = this._addUID(\"GProuteResultsValueDist\");\n        divDuration.innerHTML = fconvert(duration);\n        containerDuration.appendChild(divDuration);\n\n        div.appendChild(containerDuration);\n\n        return div;\n    },\n\n    /**\n     * Create Show Results Details\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteShowResultsDetailsElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"GProuteResultsShowDetailsDiv gpf-flex fr-checkbox-group fr-m-1w\";\n        if (!checkDsfr()) {\n            var divBorderUp = document.createElement(\"div\");\n            divBorderUp.className = \"GPfakeBorder GPfakeBorderLeft\";\n            div.appendChild(divBorderUp);\n        }\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GProuteResultsShowDetails\");\n        input.type = \"checkbox\";\n        div.appendChild(input);\n        var labelShow = document.createElement(\"label\");\n        labelShow.className = \"gpf-label fr-label\";\n        labelShow.htmlFor = this._addUID(\"GProuteResultsShowDetails\");\n        labelShow.innerHTML = \"Afficher le détail\";\n        div.appendChild(labelShow);\n        if (!checkDsfr()) {\n            var labelHide = document.createElement(\"label\");\n            labelHide.htmlFor = this._addUID(\"GProuteResultsShowDetails\");\n            labelHide.innerHTML = \"Masquer le détail\";\n            div.appendChild(labelHide);\n            var divBorderDown = document.createElement(\"div\");\n            divBorderDown.className = \"GPfakeBorder\";\n            div.appendChild(divBorderDown);\n        }\n        return div;\n    },\n\n    /**\n     *  Create Results Details\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsDetailsElement : function () {\n        // <!-- Route results details are dynamically filled in Javascript by route service -->\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteResultsDetails\");\n        return div;\n    },\n\n    /**\n     *  Add Results Details\n     * (results dynamically generate !)\n     * @param {Object[]} instructions - instructions\n     * @param {Function} fconvert - fconvert\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _addRouteResultsDetailsElement : function (instructions, fconvert) {\n        // contexte\n        var context = this;\n\n        var div = document.getElementById(this._addUID(\"GProuteResultsDetails\"));\n\n        // clean !\n        if (div.childElementCount) {\n            while (div.firstChild) {\n                div.removeChild(div.firstChild);\n            }\n        }\n\n        // calcul des valeurs cumulé !\n        var distanceCumul = 0;\n        var durationCumul = 0;\n\n        /* jshint -W083 */\n        for (var i = 0; i < instructions.length; i++) {\n            var id = i + 1;\n\n            var o = instructions[i];\n\n            var divNum = document.createElement(\"div\");\n            divNum.className = \"GProuteResultsDetailsNumber\";\n            divNum.innerHTML = id + \".\";\n            div.appendChild(divNum);\n\n            durationCumul += parseFloat(o.duration);\n            distanceCumul += parseFloat(o.distance);\n\n            var distance = 0;\n            var isCumulKm = parseInt(distanceCumul / 1000, 10);\n            if (!isCumulKm) {\n                distance = Math.round(distanceCumul) + \" m\";\n            } else {\n                var distanceArrondi = Math.round(distanceCumul);\n                distanceArrondi = distanceArrondi / 1000;\n                distance = distanceArrondi + \" km\";\n            }\n\n            var divIns = document.createElement(\"div\");\n            divIns.className = \"GProuteResultsDetailsInstruction\";\n            divIns.id = this._addUID(\"GProuteResultsDetailsInstruction_\" + id);\n            divIns.title = \"distance : \" + distance + \" / \" + \"temps : \" + fconvert(durationCumul);\n            divIns.innerHTML = o.instruction;\n\n            divIns.addEventListener(\"mouseover\", function (e) {\n                context.onRouteResultsDetailsMouseOver(e);\n            });\n            divIns.addEventListener(\"mouseout\", function (e) {\n                context.onRouteResultsDetailsMouseOut(e);\n            });\n            divIns.addEventListener(\"click\", function (e) {\n                // mode mobile !\n                if (typeof context.onRouteResultsDetailsClick === \"function\") {\n                    context.onRouteResultsDetailsClick(e);\n                }\n            });\n            div.appendChild(divIns);\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ################### Methods to the form points #################### //\n    // ################# OVERWRITTEN BY LOCATIONSELECTOR ! ################# //\n\n    /**\n     * Create Point\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     * @param {Integer} n - n\n     * @param {String} text - text\n     * @param {Boolean} visibility - visibility\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormPointElement : function (n, text, visibility) {\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = \"GProutePoint\" + n;\n        div.className = (visibility) ? \"GPflexInput GProuteStageFlexInput\" : \"GPflexInput GProuteStageFlexInputHidden\";\n\n        var labelOrigin = document.createElement(\"label\");\n        labelOrigin.id = \"GProuteOriginLabel\" + n;\n        labelOrigin.htmlFor = \"GProuteOrigin\" + n;\n        labelOrigin.innerHTML = text;\n        labelOrigin.addEventListener(\"click\", function () {\n            var i = this.id.charAt(this.id.length - 1);\n            document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n            for (var j = 1; j < 8; j++) {\n                document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n            }\n            document.getElementById(\"GProuteForm\").className = \"gpf-panel__content fr-modal__content\";\n            document.getElementById(\"GProuteOriginPointer\" + i).checked = false;\n            document.getElementById(\"GProuteOrigin\" + i).className = \"GPelementVisible gpf-visible\";\n            document.getElementById(\"GProuteOriginCoords\" + i).className = \"GPelementHidden gpf-hidden\";\n        });\n        div.appendChild(labelOrigin);\n\n        var inputOrigin = document.createElement(\"input\");\n        inputOrigin.id = \"GProuteOrigin\" + n;\n        inputOrigin.className = \"GPelementVisible gpf-visible\";\n        inputOrigin.type = \"text\";\n        inputOrigin.placeholder = \"Saisir une adresse, un lieu...\";\n        inputOrigin.addEventListener(\"keyup\", function (e) {\n            var charCode = e.which || e.keyCode;\n            if (charCode === 13 || charCode === 10) {\n                return;\n            }\n            var i = this.id.charAt(this.id.length - 1);\n            if (document.getElementById(\"GProuteOrigin\" + i).value.length > 2) {\n                document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"block\";\n            } else {\n                document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on récupère la valeur de saisie pour une requête sur le service d'autocompletion.\n            // le resultat de la requête nous permet de recuperer les coordonnées du point...\n            context.onAutoCompleteSearchText(e);\n        });\n        inputOrigin.addEventListener(\"blur\", function () {\n            var i = this.id.charAt(this.id.length - 1);\n            document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"none\";\n        });\n        div.appendChild(inputOrigin);\n\n        var inputOriginCoord = document.createElement(\"input\");\n        inputOriginCoord.id = \"GProuteOriginCoords\" + n;\n        inputOriginCoord.className = \"GPelementHidden gpf-hidden\";\n        inputOriginCoord.type = \"text\";\n        inputOriginCoord.disabled = true;\n        div.appendChild(inputOriginCoord);\n\n        var inputOriginPointer = document.createElement(\"input\");\n        inputOriginPointer.id = \"GProuteOriginPointer\" + n;\n        inputOriginPointer.type = \"checkbox\";\n        div.appendChild(inputOriginPointer);\n\n        var labelOriginPointer = document.createElement(\"label\");\n        labelOriginPointer.id = \"GProuteOriginPointerImg\" + n;\n        labelOriginPointer.htmlFor = \"GProuteOriginPointer\" + n;\n        labelOriginPointer.className = \"GProuteOriginPointerImg\";\n        labelOriginPointer.title = \"Pointer un lieu sur la carte\";\n        labelOriginPointer.addEventListener(\"click\", function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n            var i = this.id.charAt(this.id.length - 1);\n            var j;\n            for (j = 1; j < 8; j++) {\n                if (i !== j) {\n                    document.getElementById(\"GProuteOriginPointer\" + j).checked = false;\n                    if (document.getElementById(\"GProuteOriginCoords\" + j).value === \"Pointer un lieu sur la carte\") {\n                        document.getElementById(\"GProuteOriginCoords\" + j).value = \"\";\n                        document.getElementById(\"GProuteOrigin\" + j).className = \"GPelementVisible gpf-visible\";\n                        document.getElementById(\"GProuteOriginCoords\" + j).className = \"GPelementHidden gpf-hidden\";\n                    }\n                }\n            }\n            if (document.getElementById(\"GProuteOriginPointer\" + i).checked) {\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n                for (j = 1; j < 8; j++) {\n                    document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n                }\n                document.getElementById(\"GProuteForm\").className = \"gpf-panel__content fr-modal__content\";\n                document.getElementById(\"GProuteOriginPointer\" + i).checked = false;\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GPelementVisible gpf-visible\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GPelementHidden gpf-hidden\";\n            } else {\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"Pointer un lieu sur la carte\";\n                for (j = 1; j < 8; j++) {\n                    if (i === j) {\n                        document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n                    } else {\n                        document.getElementById(\"GProutePoint\" + j).style.display = \"none\";\n                    }\n                }\n                document.getElementById(\"GProuteForm\").className = \"GProuteFormMini gpf-panel__content fr-modal__content\";\n                document.getElementById(\"GProuteOriginPointer\" + i).checked = true;\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GPelementVisible gpf-visible\";\n            }\n            // gestionnaire d'evenement :\n            // on stocke la valeur du point, utilisée pour la requête sur le service de calcul d'itiniraire\n            context.onRouteMapPointClick(evt);\n        });\n        div.appendChild(labelOriginPointer);\n\n        return div;\n    },\n\n    /**\n     * Create Remove Point tag\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     * @param {Integer} n - n\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormRemoveStageElement : function (n) {\n        // contexte d'execution\n        var context = this;\n\n        var divRm = document.createElement(\"div\");\n        divRm.id = \"GProuteStageRemove\" + n;\n        divRm.className = \"GProuteStageRemove\";\n        divRm.title = \"Supprimer l'étape\";\n        if (n !== 1 && n !== 7) {\n            divRm.addEventListener(\"click\", function (e) {\n                var i = this.id.charAt(this.id.length - 1);\n                document.getElementById(\"GProutePoint\" + i).className = \"GPflexInput GProuteStageFlexInputHidden\";\n                document.getElementById(\"GProuteOrigin\" + i).value = \"\";\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GPelementVisible gpf-visible\";\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(\"GProuteStageAdd\").style.display = \"\";\n                // Moving up exclusions picto\n                // var exclusionsPictoTop = document.getElementById(\"GPshowRouteExclusionsPicto\").style.top;\n                // document.getElementById(\"GPshowRouteExclusionsPicto\").style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                // gestionnaire d'evenement :\n                // on supprime le point, utilisé pour la requête sur le service d'itiniraire\n                context.onRouteRemovePointClick(e);\n            });\n        }\n        return divRm;\n    },\n\n    /**\n     * Create Add Point tag\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormAddStageElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var divAdd = document.createElement(\"div\");\n        divAdd.id = \"GProuteStageAdd\";\n        divAdd.title = \"Ajouter une étape\";\n        divAdd.addEventListener(\"click\", function (e) {\n            var lastStage = 1;\n            var nbStages = 0;\n            for (var i = 2; i < 7; i++) {\n                if (document.getElementById(\"GProutePoint\" + i).className === \"GPflexInput GProuteStageFlexInputHidden\") {\n                    if (lastStage === 1) {\n                        lastStage = i;\n                    }\n                } else {\n                    nbStages++;\n                }\n            }\n            if (lastStage < 7) {\n                document.getElementById(\"GProutePoint\" + lastStage).className = \"GPflexInput GProuteStageFlexInput\";\n                // Moving down exclusions picto\n                // var exclusionsPictoTop = document.getElementById(\"GPshowRouteExclusionsPicto\").style.top;\n                // document.getElementById(\"GPshowRouteExclusionsPicto\").style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n            }\n            if (nbStages === 4) {\n                document.getElementById(\"GProuteStageAdd\").style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on ajoute le point, utilisé pour la requête sur le service d'itiniraire\n            context.onRouteAddPointClick(e);\n        });\n\n        return divAdd;\n    },\n\n    /**\n     * Create Results autocompletion to the point\n     * see event!\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     * @param {Integer} n - n\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormAutoCompleteListElement : function (n) {\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = \"GProuteAutoCompleteList\" + n;\n        div.className = \"GPadvancedAutoCompleteList\";\n\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function (e) {\n                context.onAutoCompletedResultsItemClick(e);\n                document.getElementById(\"GProuteAutoCompleteList\" + n).style.display = \"none\";\n            }, false);\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function (e) {\n                context.onAutoCompletedResultsItemClick(e);\n                document.getElementById(\"GProuteAutoCompleteList\" + n).style.display = \"none\";\n            });\n        }\n\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        // <div class=\"GPautoCompleteProposal\">...</div>\n\n        return div;\n    },\n\n    /**\n     * Autocompletion result to a point.\n     * Proposals are dynamically filled in Javascript by autocomplete service\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     *\n     * @param {Object} location - suggested location results\n     * @param {Number} n  - number of the point\n     * @param {Number} id - ID\n     */\n    _createRouteAutoCompletedLocationElement : function (location, n, id) {\n        var container = document.getElementById(\"GProuteAutoCompleteList\" + n);\n\n        var div = document.createElement(\"div\");\n        div.id = \"AutoCompletedLocation\" + id;\n        div.className = \"GPautoCompleteProposal\";\n        div.innerHTML = GeocodeUtils.getSuggestedLocationFreeform(location);\n\n        container.appendChild(div);\n    },\n\n    // ################################################################### //\n    // ############## Methods to the choice mode into form ############### //\n    // ################################################################### //\n\n    /**\n     * Create Mode choice transport\n     * see event !\n     * FIXME event not useful\n     * @param {String[]} transports - transports\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormModeChoiceTransportElement : function (transports) {\n        // contexte d'execution\n        var context = this;\n\n        var divContainer = document.createElement(\"div\");\n        divContainer.id = this._addUID(\"GProuteTransportChoice\");\n\n        var label = document.createElement(\"label\");\n        label.className = \"GProuteModeLabel gpf-label fr-label\";\n        label.innerHTML = \"Choisir un mode de déplacement\";\n        divContainer.appendChild(label);\n\n        var divRadio = document.createElement(\"div\");\n        divRadio.className = \"gpf-radio-btn-group\";\n        /* jshint -W083 */\n        for (var i = 0; i < transports.length; i++) {\n            var transport = transports[i];\n\n            var div = document.createElement(\"div\");\n            div.className = \"GProuteTransportChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w\";\n\n            if (transport === \"Voiture\") {\n                var inputCar = document.createElement(\"input\");\n                inputCar.id = this._addUID(\"GProuteTransportCar\");\n                inputCar.type = \"radio\";\n                inputCar.name = \"GProuteTransport\";\n                inputCar.value = \"Voiture\";\n                if (i === 0) {\n                    inputCar.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requête sur le service de calcul d'itiniraire\n                if (inputCar.addEventListener) {\n                    inputCar.addEventListener(\"change\", function (e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                } else if (inputCar.attachEvent) {\n                    inputCar.attachEvent(\"onchange\", function (e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                }\n                div.appendChild(inputCar);\n\n                var labelCar = document.createElement(\"label\");\n                labelCar.className = \"GProuteTransportImg gpf-label fr-label\";\n                labelCar.htmlFor = this._addUID(\"GProuteTransportCar\");\n                labelCar.title = \"Voiture\";\n                labelCar.innerHTML = \"Voiture\";\n                div.appendChild(labelCar);\n            }\n\n            if (transport === \"Pieton\") {\n                var inputPedestrian = document.createElement(\"input\");\n                inputPedestrian.id = this._addUID(\"GProuteTransportPedestrian\");\n                inputPedestrian.type = \"radio\";\n                inputPedestrian.name = \"GProuteTransport\";\n                inputPedestrian.value = \"Pieton\";\n                if (i === 0) {\n                    inputPedestrian.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requête sur le service de calcul d'itiniraire\n                if (inputPedestrian.addEventListener) {\n                    inputPedestrian.addEventListener(\"change\", function (e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                } else if (inputPedestrian.attachEvent) {\n                    inputPedestrian.attachEvent(\"onchange\", function (e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                }\n                div.appendChild(inputPedestrian);\n\n                var labelPedestrian = document.createElement(\"label\");\n                labelPedestrian.className = \"GProuteTransportImg gpf-label fr-label\";\n                labelPedestrian.htmlFor = this._addUID(\"GProuteTransportPedestrian\");\n                labelPedestrian.title = \"Piéton\";\n                labelPedestrian.innerHTML = \"Piéton\";\n                div.appendChild(labelPedestrian);\n            }\n\n            divRadio.appendChild(div);\n        }\n        divContainer.appendChild(divRadio);\n\n        return divContainer;\n    },\n\n    /**\n     * Create Mode choice computation\n     * see event!\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormModeChoiceComputeElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var divContainer = document.createElement(\"div\");\n        divContainer.id = this._addUID(\"GProuteComputationChoice\");\n        divContainer.className = \"fr-mt-2w\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GProuteComputationLabel gpf-label fr-label\";\n        label.innerHTML = \"Mode de calcul\";\n        divContainer.appendChild(label);\n\n        var divRadio = document.createElement(\"div\");\n        divRadio.className = \"gpf-radio-btn-group\";\n\n        var div = document.createElement(\"div\");\n        div.className = \"GProuteComputationChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w\";\n        var inputFastest = document.createElement(\"input\");\n        inputFastest.id = this._addUID(\"GProuteComputationFastest\");\n        inputFastest.type = \"radio\";\n        inputFastest.name = \"GProuteComputation\";\n        inputFastest.value = \"fastest\";\n        inputFastest.checked = true;\n        // gestionnaire d'evenement :\n        // on stocke le mode de transport,\n        // utilisation pour la requête sur le service de calcul d'itiniraire\n        if (inputFastest.addEventListener) {\n            inputFastest.addEventListener(\"change\", function (e) {\n                context.onRouteModeComputationChange(e);\n            });\n        } else if (inputFastest.attachEvent) {\n            inputFastest.attachEvent(\"onchange\", function (e) {\n                context.onRouteModeComputationChange(e);\n            });\n        }\n        div.appendChild(inputFastest);\n\n        var labelFastest = document.createElement(\"label\");\n        labelFastest.className = \"gpf-label fr-label\";\n        labelFastest.htmlFor = this._addUID(\"GProuteComputationFastest\");\n        labelFastest.title = \"Plus rapide\";\n        labelFastest.innerHTML = \"Plus rapide\";\n        div.appendChild(labelFastest);\n        divRadio.appendChild(div);\n\n        var div2 = document.createElement(\"div\");\n        div2.className = \"GProuteComputationChoice gpf-flex gpf-radio-group fr-radio-group fr-my-1w\";\n        var inputShortest = document.createElement(\"input\");\n        inputShortest.id = this._addUID(\"GProuteComputationShortest\");\n        inputShortest.type = \"radio\";\n        inputShortest.name = \"GProuteComputation\";\n        inputShortest.value = \"shortest\";\n        // gestionnaire d'evenement :\n        // on stocke le mode de transport,\n        // utilisation pour la requête sur le service de calcul d'itiniraire\n        if (inputShortest.addEventListener) {\n            inputShortest.addEventListener(\"change\", function (e) {\n                context.onRouteModeComputationChange(e);\n            });\n        } else if (inputShortest.attachEvent) {\n            inputShortest.attachEvent(\"onchange\", function (e) {\n                context.onRouteModeComputationChange(e);\n            });\n        }\n        div2.appendChild(inputShortest);\n\n        var labelShortest = document.createElement(\"label\");\n        labelShortest.className = \"gpf-label fr-label\";\n        labelShortest.htmlFor = this._addUID(\"GProuteComputationShortest\");\n        labelShortest.title = \"Plus court\";\n        labelShortest.innerHTML = \"Plus court\";\n        div2.appendChild(labelShortest);\n\n        divRadio.appendChild(div2);\n        divContainer.appendChild(divRadio);\n\n        return divContainer;\n    },\n\n    // ################################################################### //\n    // ################# Methods to the choice exclusions ################ //\n    // ################################################################### //\n\n    /**\n     * Label to Exclusions Options\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRouteExclusionsPictoElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var button = document.createElement(\"button\");\n        button.id = this._addUID(\"GPshowRouteExclusionsPicto\");\n        var hidden = \"\";\n        if (checkDsfr()) {\n            hidden = \"GPelementHidden gpf-hidden\";\n        }\n        button.className = `GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowRouteExclusionsPicto ${hidden} gpf-btn fr-btn--sm fr-btn--tertiary gpf-btn--tertiary fr-icon-arrow-down-fill`;\n        button.title = \"Exclusions\";\n        // button.style.top = \"185px\";\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", true);\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu des options des exclusions\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                e.preventDefault();\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowRouteExclusionsClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                e.preventDefault();\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowRouteExclusionsClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Create Container to Exclusions\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormExclusionsElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteExclusions\");\n        div.className = \"fr-mt-2w\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GProuteExclusionsLabel fr-label\";\n        label.innerHTML = \"Passages autorisés\";\n        div.appendChild(label);\n\n        // div.appendChild(this._createRoutePanelFormExclusionOptionsElement());\n\n        return div;\n    },\n\n    /**\n     * Create Exclusions Options\n     * see event !\n     * FIXME event not useful\n     * @param {Object[]} exclusions - exclusions\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormExclusionOptionsElement : function (exclusions) {\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GProuteExclusionsOptions gpf-flex fr-checkbox-group fr-m-1w\";\n\n        /* jshint -W083 */\n        for (var value in exclusions) {\n            if (exclusions.hasOwnProperty(value)) {\n                var status = exclusions[value];\n                switch (value) {\n                    case \"toll\":\n                        var inputToll = document.createElement(\"input\");\n                        inputToll.id = this._addUID(\"GProuteExclusionsToll\");\n                        inputToll.type = \"checkbox\";\n                        inputToll.value = \"Toll\";\n                        inputToll.name = \"Peage\";\n                        inputToll.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputToll.addEventListener) {\n                            inputToll.addEventListener(\"change\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputToll.attachEvent) {\n                            inputToll.attachEvent(\"onchange\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputToll);\n\n                        var labelToll = document.createElement(\"label\");\n                        labelToll.className = \"GProuteExclusionsOption\";\n                        labelToll.htmlFor = this._addUID(\"GProuteExclusionsToll\");\n                        labelToll.innerHTML = \"Péages\";\n                        div.appendChild(labelToll);\n                        break;\n\n                    case \"tunnel\":\n                        var inputTunnel = document.createElement(\"input\");\n                        inputTunnel.id = this._addUID(\"GProuteExclusionsTunnel\");\n                        inputTunnel.type = \"checkbox\";\n                        inputTunnel.value = \"Tunnel\";\n                        inputTunnel.name = \"Tunnel\";\n                        inputTunnel.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputTunnel.addEventListener) {\n                            inputTunnel.addEventListener(\"change\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputTunnel.attachEvent) {\n                            inputTunnel.attachEvent(\"onchange\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputTunnel);\n\n                        var labelTunnel = document.createElement(\"label\");\n                        labelTunnel.className = \"GProuteExclusionsOption\";\n                        labelTunnel.htmlFor = this._addUID(\"GProuteExclusionsTunnel\");\n                        labelTunnel.innerHTML = \"Tunnels\";\n                        div.appendChild(labelTunnel);\n                        break;\n\n                    case \"bridge\":\n                        var inputBridge = document.createElement(\"input\");\n                        inputBridge.id = this._addUID(\"GProuteExclusionsBridge\");\n                        inputBridge.type = \"checkbox\";\n                        inputBridge.value = \"Bridge\";\n                        inputBridge.name = \"Ponts\";\n                        inputBridge.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputBridge.addEventListener) {\n                            inputBridge.addEventListener(\"change\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputBridge.attachEvent) {\n                            inputBridge.attachEvent(\"onchange\", function (e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputBridge);\n\n                        var labelBridge = document.createElement(\"label\");\n                        labelBridge.className = \"GProuteExclusionsOption\";\n                        labelBridge.htmlFor = this._addUID(\"GProuteExclusionsBridge\");\n                        labelBridge.innerHTML = \"Ponts\";\n                        div.appendChild(labelBridge);\n                        break;\n                }\n            }\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############################### Submit Form ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteSubmitFormElement : function () {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GProuteSubmit\");\n        input.className = \"GPsubmit gpf-btn gpf-btn-icon-submit fr-btn\";\n        input.type = \"submit\";\n        input.value = \"Calculer l'itinéraire\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ############################### Reset picto ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Reset Picto Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteFormResetElement : function () {\n        var self = this;\n\n        var buttonReset = document.createElement(\"button\");\n        buttonReset.id = this._addUID(\"GProuteReset\");\n        buttonReset.title = \"Réinitialiser les paramètres\";\n        buttonReset.className = \"GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary\";\n        buttonReset.title = \"Réinitialiser les paramètres\";\n        buttonReset.setAttribute(\"tabindex\", \"0\");\n        buttonReset.setAttribute(\"aria-pressed\", false);\n        buttonReset.addEventListener(\"click\", function (e) {\n            var status = (e.target.ariaPressed === \"true\");\n            e.target.setAttribute(\"aria-pressed\", !status);\n            self.onRouteResetClick(e);\n        });\n\n        return buttonReset;\n    }\n};\n\nexport default RouteDOM;\n","// import CSS\nimport \"../../CSS/Controls/Route/GPFroute.css\";\n// import \"../../CSS/Controls/Route/GPFrouteStyle.css\";\n// import OpenLayers\n// import Control from \"ol/control/Control\";\nimport Widget from \"../Widget\";\nimport Control from \"../Control\";\nimport { unByKey as olObservableUnByKey } from \"ol/Observable\";\nimport Overlay from \"ol/Overlay\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\n// import GeoJSON from \"ol/format/GeoJSON\";\nimport { pointerMove as eventPointerMove } from \"ol/events/condition\";\nimport { Select as SelectInteraction } from \"ol/interaction\";\nimport {\n    Stroke,\n    Style\n} from \"ol/style\";\nimport { transformExtent as olTransformExtentProj } from \"ol/proj\";\n// import geoportal library access\nimport Gp from \"geoportal-access-lib\";\n// import local\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Utils from \"../../Utils/Helper\";\nimport SelectorID from \"../../Utils/SelectorID\";\nimport Markers from \"../Utils/Markers\";\nimport Draggable from \"../../Utils/Draggable\";\nimport Interactions from \"../Utils/Interactions\";\nimport MathUtils from \"../../Utils/MathUtils\";\n// import local with ol dependencies\nimport LocationSelector from \"../LocationSelector/LocationSelector\";\nimport ButtonExport from \"../Export/Export\";\nimport LayerSwitcher from \"../LayerSwitcher/LayerSwitcher\";\nimport GeoJSONExtended from \"../../Formats/GeoJSON\";\n// DOM\nimport RouteDOM from \"./RouteDOM\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\nvar logger = Logger.getLogger(\"route\");\n\n/**\n * @classdesc\n *\n * Route Control.\n *\n * @constructor\n * @alias ol.control.Route\n * @type {ol.control.Route}\n * @extends {ol.control.Control}\n * @param {Object} options - route control options\n * @param {Number} [options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {String}  [options.apiKey] - API key for services call (route and autocomplete services). The key \"calcul\" is used by default.\n * @param {Boolean} [options.ssl = true] - use of ssl or not (default true, service requested using https protocol)\n * @param {Boolean} [options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Boolean} [options.draggable = false] - Specify if widget is draggable\n * @param {Boolean|Object} [options.export = false] - Specify if button \"Export\" is displayed. For the use of the options of the \"Export\" control, see {@link ol.control.Export}\n * @param {Object}  [options.exclusions = {\"toll\" : false, \"tunnel\" : false, \"bridge\" : false}] - list of exclusions with status (true = checked). By default : no exclusions checked.\n * @param {Array}   [options.graphs = [\"Voiture\", \"Pieton\"]] - list of resources, by default : [\"Voiture\", \"Pieton\"]. The first element is selected.\n * @param {Object} [options.routeOptions = {}] - route service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~route Gp.Services.route()} to know all route options.\n * @param {Object} [options.autocompleteOptions = {}] - autocomplete service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options\n * @param {Object} [options.markersOpts] - options to use your own markers. Object properties can be \"departure\", \"stages\" or \"arrival\". Corresponding value is an object with following properties :\n * @param {String} [options.markersOpts.url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.markersOpts.offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see http://openlayers.org/en/latest/apidoc/ol.Overlay.html)\n * @param {Object} [options.layerDescription = {}] - Layer informations to be displayed in LayerSwitcher widget (only if a LayerSwitcher is also added to the map)\n * @param {String} [options.layerDescription.title = \"Itinéraire\"] - Layer title to be displayed in LayerSwitcher\n * @param {String} [options.layerDescription.description = \"Itinéraire basé sur un graphe\"] - Layer description to be displayed in LayerSwitcher\n * @fires route:drawstart\n * @fires route:drawend\n * @fires route:compute\n * @fires route:compute\n * @fires route:newresults\n * @example\n *  var route = ol.control.Route({\n *      \"collapsed\" : true\n *      \"draggable\" : true,\n *      \"export\"    : false,\n *      \"exclusions\" : {\n *         \"toll\" : true,\n *         \"bridge\" : false,\n *         \"tunnel\" : true\n *      },\n *      \"graphs\" : ['Pieton', 'Voiture'],\n *      \"markersOpts\" : {\n *          \"departure\" : {\n *              \"url\" : \"...\",\n *              \"offset\" : [0,0]\n *          },\n *          \"stages\" : {\n *              \"url\" : \"...\",\n *              \"offset\" : [0,0]\n *          },\n *          \"arrival\" : {\n *              \"url\" : \"...\",\n *              \"offset\" : [0,0]\n *          }\n *      }\n *      \"autocompleteOptions\" : {},\n *      \"routeOptions\" : {}\n *  });\n *\n *  // if you want to pluggued the control Export with options :\n *  var route = new ol.control.Route({\n *    export : {\n *      name : \"export\",\n *      format : \"geojson\",\n *      title : \"Exporter\",\n *      menu : false\n *    }\n *  });\n */\nvar Route = class Route extends Control {\n\n    /**\n     * See {@link ol.control.Route}\n     * @module Route\n     * @alias module:~controls/Route\n     * @param {*} options - options\n     * @example\n     * import Route from \"gpf-ext-ol/controls/Route\"\n     * ou\n     * import { Route } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {};\n\n        // call ol.control.Control constructor\n        super(options);\n\n        if (!(this instanceof Route)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"Route\";\n        // initialisation du composant\n        this.initialize(options);\n\n        // Widget main DOM container\n        this._container = this._createMainContainerElement();\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this._container) : this.element = this._container;\n\n        return this;\n    }\n\n    /**\n     * Overwrite OpenLayers setMap method\n     *\n     * @param {ol.Map} map - Map.\n     */\n    setMap (map) {\n        if (map) {\n            // enrichissement du DOM du container\n            this._container = this._initContainer(map);\n            this.element = this._container;\n\n            // ajout d'un bouton d'export\n            if (this.options.export) {\n                var opts = Utils.assign({ control : this }, this.options.export);\n                this.export = new ButtonExport(opts);\n                this.export.render();\n                var self = this;\n                this.export.on(\"button:clicked\", (e) => {\n                    self.dispatchEvent({\n                        type : \"export:compute\",\n                        content : e.content\n                    });\n                });\n            }\n\n            // mode \"draggable\"\n            if (this.draggable) {\n                Draggable.dragElement(\n                    this._panelRouteContainer,\n                    this._panelHeaderRouteContainer,\n                    map.getTargetElement()\n                );\n            }\n\n            // mode \"collapsed\"\n            if (!this.collapsed) {\n                this._showRouteButton.setAttribute(\"aria-pressed\", true);\n            }\n        }\n\n        // on appelle la méthode setMap originale d'OpenLayers\n        super.setMap(map);\n\n        // position\n        if (this.options.position) {\n            this.setPosition(this.options.position);\n        }\n\n        // reunion du bouton avec le précédent\n        if (this.options.gutter === false) {\n            this.getContainer().classList.add(\"gpf-button-no-gutter\");\n        }\n    };\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n\n    /**\n     * Returns true if widget is collapsed (minimized), false otherwise\n     *\n     * @returns {Boolean} collapsed - true if widget is collapsed\n     */\n    getCollapsed () {\n        return this.collapsed;\n    }\n\n    /**\n     * Collapse or display widget main container\n     *\n     * @param {Boolean} collapsed - True to collapse widget, False to display it\n     */\n    setCollapsed (collapsed) {\n        if (collapsed === undefined) {\n            logger.log(\"[ERROR] Route:setCollapsed - missing collapsed parameter\");\n            return;\n        }\n        if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n            return;\n        }\n        if (collapsed) {\n            document.getElementById(\"GProutePanelClose-\" + this._uid).click();\n        } else {\n            this._showRouteButton.click();\n        }\n        this.collapsed = collapsed;\n    }\n\n    /**\n     * Get vector layer where geoJson route is drawn\n     *\n     * @returns {Object} layer - ol.layer.Vector route layer\n     */\n    getLayer () {\n        return this._geojsonSections;\n    }\n\n    /**\n     * Set vector layer where route geometry is drawn\n     *\n     * @param {Object} layer - ol.layer.Vector route layer\n     */\n    setLayer (layer) {\n        if (!layer) {\n            this._geojsonSections = null;\n            return;\n        }\n\n        if (!(layer instanceof VectorLayer)) {\n            logger.log(\"no valid layer given for hosting drawn features.\");\n            return;\n        }\n\n        // application des styles\n        layer.setStyle(this._defaultFeatureStyle);\n        // sauvegarde\n        this._geojsonSections = layer;\n    }\n\n    /**\n     * Get vector layer\n     *\n     * @returns {String} geojson - GeoJSON format layer\n     */\n    getGeoJSON () {\n        return JSON.stringify(this._geojsonObject);\n    }\n\n    /**\n     * Set vector layer\n     *\n     * @param {String} geojson - GeoJSON format layer\n     */\n    setGeoJSON (geojson) {\n        try {\n            this._geojsonObject = JSON.parse(geojson);\n        } catch (e) {\n            logger.log(\"no valid geojson given :\" + e.message);\n        }\n    }\n\n    /**\n     * Get route informations\n     *\n     * @returns {Object} data - route informations\n     */\n    getData () {\n        var points = [];\n        for (let index = 0; index < this._currentPoints.length; index++) {\n            const p = this._currentPoints[index];\n            points.push(p.getCoordinate());\n        }\n        var data = {\n            type : \"route\",\n            points : points,\n            transport : this._currentTransport,\n            exclusions : this._currentExclusions,\n            computation : this._currentComputation,\n            results : {}\n        };\n        Utils.assign(data.results, this._currentRouteInformations);\n        return data;\n    }\n\n    /**\n     * Set route data\n     *\n     * @param {Object} data - control informations\n     * @param {String} data.transport - transport type\n     * @param {String} data.computation - computation type\n     * @param {Array} data.exclusions - list of exclusions\n     * @param {Array} data.points - list of points : [[lon, lat]]\n     * @param {Object} data.results - service response\n     */\n    setData (data) {\n        // INFO\n        // transmettre toutes les informations necessaires pour reconstruire le panneau de resultats\n        this._currentTransport = data.transport;\n        this._currentComputation = data.computation;\n        this._currentExclusions = data.exclusions;\n        // ajout des nouvelles coordonnnées\n        for (var j = 0; j < data.points.length; j++) {\n            const c = data.points[j];\n            if (c) {\n                this._currentPoints[j].setCoordinate(c, \"EPSG:4326\");\n            }\n        }\n        // INFO\n        // nettoyer les points du calcul précedent\n        for (var i = 0; i < this._currentPoints.length; i++) {\n            var point = this._currentPoints[i];\n            if (point.getCoordinate()) {\n                // clean de l'objet sans declencher les evenements qui suppriment la couche précedente !\n                // /!\\ point.clear()\n                // point.clearResults();\n                // clean du dom\n                var id = (i + 1) + \"-\" + this._uid;\n                var coordinate = point.getCoordinate()[1].toFixed(4) + \" / \" + point.getCoordinate()[0].toFixed(4);\n                document.getElementById(\"GPlocationOriginCoords_\" + id).value = coordinate;\n                document.getElementById(\"GPlocationOrigin_\" + id).value = coordinate;\n                // document.getElementById(\"GPlocationPoint_\" + id).style.cssText = \"\";\n                if (i > 0 && i < 6) {\n                    // on masque les points intermediaires\n                    document.getElementById(\"GPlocationPoint_\" + id).className = \"GPflexInput GPelementHidden gpf-flex gpf-hidden \";\n                }\n            }\n        }\n        this._currentRouteInformations = data.results;\n    }\n\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this._container;\n    }\n\n    /**\n     * Get default style\n     *\n     * @returns {ol.style} style\n     */\n    getStyle () {\n        return this._defaultFeatureStyle;\n    }\n\n    /**\n     * This method is public.\n     * It allows to init the control.\n     */\n    init () {\n        // INFO\n        // reconstruire le panneau de resultats sans lancer de calcul\n        // * construire la liste des points (cf. RouteDOM._createRoutePanelFormElement())\n        // * construire les resultats\n\n        // init points\n        for (let index = 0; index < this._currentPoints.length; index++) {\n            const point = this._currentPoints[index];\n            var id = index + 1;\n            var coordinate = point.getCoordinate();\n            if (coordinate) {\n                var input = document.getElementById(\"GPlocationOrigin_\" + id + \"-\" + this._uid);\n                input.value = coordinate[1].toFixed(4) + \" / \" + coordinate[0].toFixed(4);\n                if (index > 0 && index < 6) {\n                    document.getElementById(\"GPlocationPoint_\" + id + \"-\" + this._uid).className = \"GPflexInput GPlocationStageFlexInput gpf-flex\";\n                }\n            }\n        }\n\n        // add points into panel\n        var points = document.getElementsByClassName(\"GPlocationPoint-\" + this._uid);\n        this._addRouteResultsStagesValuesElement(points);\n\n        // set transport mode\n        var transportdiv;\n        if (this._currentTransport === \"Pieton\") {\n            transportdiv = document.getElementById(\"GProuteTransportPedestrian-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        } else {\n            transportdiv = document.getElementById(\"GProuteTransportCar-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        }\n\n        // set computation mode\n        var computationdiv = document.getElementById(\"GProuteComputationSelect-\" + this._uid);\n        if (computationdiv) {\n            computationdiv.value = this._currentComputation;\n        }\n\n        // set exclusions\n        var tollInput = document.getElementById(\"GProuteExclusionsToll-\" + this._uid);\n        if (tollInput) {\n            if (this._currentExclusions.indexOf(\"toll\") !== -1) {\n                tollInput.checked = false;\n            } else {\n                tollInput.checked = true;\n            }\n        }\n\n        var tunnelInput = document.getElementById(\"GProuteExclusionsTunnel-\" + this._uid);\n        if (tunnelInput) {\n            if (this._currentExclusions.indexOf(\"tunnel\") !== -1) {\n                tunnelInput.checked = false;\n            } else {\n                tunnelInput.checked = true;\n            }\n        }\n\n        var bridgeInput = document.getElementById(\"GProuteExclusionsBridge-\" + this._uid);\n        if (bridgeInput) {\n            if (this._currentExclusions.indexOf(\"bridge\") !== -1) {\n                bridgeInput.checked = false;\n            } else {\n                bridgeInput.checked = true;\n            }\n        }\n\n        var distance = this._currentRouteInformations.totalDistance;\n        var duration = this._currentRouteInformations.totalTime;\n\n        // Détails avec simplifications des troncons\n        var instructions = this._simplifiedInstructions(this._currentRouteInformations.routeInstructions);\n\n        if (instructions) {\n            this._fillRouteResultsDetailsContainer(distance, duration, instructions);\n        }\n\n        // affichage du panneau de details du controle !\n        this._formRouteContainer.className = \"GPelementHidden gpf-hidden gpf-panel__content fr-modal__content\";\n        this._hideWaitingContainer();\n        this._resultsRouteContainer.className = \"\";\n    }\n\n    /**\n     * Clean UI : reinit control\n     */\n    clean () {\n        this._currentTransport = null;\n        this._currentExclusions = [];\n        this._currentComputation = null;\n\n        for (var i = 0; i < this._currentPoints.length; i++) {\n            this._currentPoints[i].clear();\n        }\n\n        this._removeRouteStepLocations();\n        this._clearRouteInputOptions();\n        this._clearRouteResultsDetails();\n\n        this.setLayer();\n\n        this._formRouteContainer.className = \"gpf-panel__content fr-modal__content\";\n        this._resultsRouteContainer.className = \"GPelementHidden gpf-hidden\";\n    }\n\n    // ################################################################### //\n    // ##################### init component ############################## //\n    // ################################################################### //\n\n    /**\n     * Initialize route control (called by Route constructor)\n     *\n     * @param {Object} options - constructor options\n     * @private\n     */\n    initialize (options) {\n        this._checkInputOptions(options);\n\n        // set default options\n        this.options = {\n            collapsed : true,\n            draggable : false,\n            export : false,\n            graphs : [\"Pieton\", \"Voiture\"],\n            exclusions : {\n                toll : false,\n                tunnel : false,\n                bridge : false\n            },\n            routeOptions : {},\n            autocompleteOptions : {},\n            layerDescription : {\n                title : \"Itinéraire\",\n                description : \"Itinéraire basé sur un graphe\"\n            }\n        };\n\n        // merge with user options\n        Utils.assign(this.options, options);\n\n        // cas particulier des markers par défaut\n        var defaultMarkersOpts = {\n            departure : {\n                url : Markers[\"red\"],\n                offset : Markers.defaultOffset\n            },\n            stages : {\n                url : Markers[\"lightOrange\"],\n                offset : Markers.defaultOffset\n            },\n            arrival : {\n                url : Markers[\"darkOrange\"],\n                offset : Markers.defaultOffset\n            }\n        };\n        // on récupère les options de chaque type de marker si spécifié\n        this.options.markersOpts = Utils.assign(defaultMarkersOpts, options.markersOpts);\n\n        /** {Boolean} specify if Route control is collapsed (true) or not (false) */\n        this.collapsed = this.options.collapsed;\n\n        /** {Boolean} specify if Route control is draggable (true) or not (false) */\n        this.draggable = this.options.draggable;\n\n        this._uid = this.options.id || SelectorID.generate();\n\n        // containers principaux\n        this._showRouteButton = null;\n        this._panelRouteContainer = null;\n        this._panelHeaderRouteContainer = null;\n        this._waitingContainer = null;\n        this._formRouteContainer = null;\n        this._resultsRouteContainer = null;\n        this._showRouteExclusionsElement = null;\n\n        // liste de points selectionnée\n        this._currentPoints = [];\n\n        // Mode de transport selectionné : 'Voiture' ou 'Pieton'\n        this._currentTransport = null;\n        this._initTransport();\n\n        // Mode de calcul selectionné : 'Plus rapide' ou 'plus court'\n        this._currentComputation = null;\n        this._initComputation();\n\n        // Exclusions selectionnées : Tunnel, Toll et Bridge\n        this._currentExclusions = [];\n        this._initExclusions();\n\n        // si un calcul est en cours ou non\n        this._waiting = false;\n        // timer pour cacher la patience après un certain temps\n        this._timer = null;\n\n        // la geometrie du parcours\n        this._geojsonRoute = null;\n\n        // la geometrie des troncons\n        this._geojsonSections = null;\n\n        // la geometrie des troncons au format GeoJSON\n        this._geojsonObject = null;\n\n        // bouton export\n        this.export = null;\n\n        // le container de la popup (pour les troncons selectionnés)\n        this._popupContent = null;\n        this._popupDiv = this._initPopupDiv();\n        // l'overlay ol.Overlay correspondant à la popup (pour les troncons selectionnés)\n        this._popupOverlay = null;\n\n        // ol.interaction.Select associées à la couche des résultats (troncons)\n        this._resultsSelectInteraction = null;\n        this._resultsHoverInteraction = null;\n\n        // styles pour les sélections des features\n        this._defaultFeatureStyle = new Style({\n            stroke : new Stroke({\n                color : \"rgba(0,183,152,0.9)\",\n                width : 12\n            })\n        });\n        this._selectedFeatureStyle = new Style({\n            stroke : new Stroke({\n                color : \"rgba(255,102,0,0.9)\",\n                width : 12\n            })\n        });\n\n        // reponse du service\n        // Ex. {\n        //   totalTime, totalDistance, bbox, routeGeometry,\n        //   routeInstructions : [{duration, distance, code, instruction, bbox, geometry}]\n        // }\n        this._currentRouteInformations = null;\n\n        // liste des ressources avec droits par service\n        // Ex. {\n        //   \"Route\" : {\n        //       key : \"ger4g456re45er456t4er5ge5\",\n        //       resources : [\"Pieton\", \"Voiture\"]\n        //   }\n        // }\n        this._resources = {};\n\n        // listener key for event on pointermove or moveend map\n        this.listenerKey = null;\n    }\n\n    /**\n     * this method is called by this.initialize()\n     *\n     * @param {Object} options - options\n     *\n     * @private\n     */\n    _checkInputOptions (options) {\n        // vérification des options\n        // mode de transport\n        if (options.graphs) {\n            // on ne permet pas de passer un tableau vide : on spécifie au moins un graph\n            if (Array.isArray(options.graphs) && options.graphs.length) {\n                for (var i = 0; i < options.graphs.length; i++) {\n                    if (typeof options.graphs[i] === \"string\") {\n                        if (options.graphs[i].toLowerCase() === \"pieton\") {\n                            options.graphs[i] = \"Pieton\";\n                        }\n                        if (options.graphs[i].toLowerCase() === \"voiture\") {\n                            options.graphs[i] = \"Voiture\";\n                        }\n                    } else {\n                        logger.log(\"[ol.control.Route] ERROR : parameter 'graphs' elements should be of type 'string'\");\n                        options.graphs[i] = null;\n                    }\n                }\n            } else {\n                logger.warn(\"'graphs' parameter should be an array\");\n                options.graphs = null;\n            }\n        }\n\n        // collapsed\n        if (options.collapsed === \"true\") {\n            options.collapsed = true;\n        }\n        if (options.collapsed === \"false\") {\n            options.collapsed = false;\n        }\n    }\n\n    /**\n     * initialize component container (DOM)\n     *\n     * @param {Object} map - the map\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     */\n    _initContainer (map) {\n        // get main container\n        var container = this._container;\n        if (container.childElementCount > 0) {\n            return container;\n        }\n\n        var picto = this._showRouteButton = this._createShowRoutePictoElement();\n        container.appendChild(picto);\n\n        var routePanel = this._panelRouteContainer = this._createRoutePanelElement();\n        var routePanelDiv = this._createRoutePanelDivElement();\n        routePanel.appendChild(routePanelDiv);\n\n        // header form\n        var routeHeader = this._panelHeaderRouteContainer = this._createRoutePanelHeaderElement();\n        routePanelDiv.appendChild(routeHeader);\n\n        // form\n        var routeForm = this._formRouteContainer = this._createRoutePanelFormElement();\n\n        // form: menu des modes\n        routeForm.appendChild(this._createRoutePanelFormModeChoiceTransportElement(this.options.graphs));\n\n        // form: menu des points\n        var points = this._createRoutePanelFormPointsElement(map);\n        for (var i = 0; i < points.length; i++) {\n            routeForm.appendChild(points[i]);\n        }\n\n        routeForm.appendChild(this._createRoutePanelFormModeChoiceComputeElement());\n\n        // form: menu des exclusions\n        this._showRouteExclusionsElement = this._createShowRouteExclusionsPictoElement();\n        routeForm.appendChild(this._showRouteExclusionsElement);\n        var exclusion = this._createRoutePanelFormExclusionsElement();\n        exclusion.appendChild(this._createRoutePanelFormExclusionOptionsElement(this.options.exclusions));\n        routeForm.appendChild(exclusion);\n\n        var panelFooter = this._createRoutePanelFooterElement();\n        routeForm.appendChild(panelFooter);\n\n        if (!checkDsfr()) {\n            var buttonReset = this._createRouteFormResetElement();\n            panelFooter.appendChild(buttonReset);\n        }\n\n        // form: bouton du calcul\n        var buttonSubmit = this._createRouteSubmitFormElement();\n        panelFooter.appendChild(buttonSubmit);\n\n        routePanelDiv.appendChild(routeForm);\n\n        // results\n        var routeResults = this._resultsRouteContainer = this._createRoutePanelResultsElement();\n        routePanelDiv.appendChild(routeResults);\n        \n        var plugin = this._createDrawingButtonsPluginDiv();\n        routePanelDiv.appendChild(plugin);\n\n        // waiting\n        var waiting = this._waitingContainer = this._createRouteWaitingElement();\n        routePanelDiv.appendChild(waiting);\n\n        container.appendChild(routePanel);\n        // hide autocomplete suggested locations on container click\n        if (container.addEventListener) {\n            container.addEventListener(\"click\", (e) => this._hideRouteSuggestedLocations(e));\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ####################### init application ########################## //\n    // ################################################################### //\n\n    /**\n     * this method is called by the constructor and initialize transport mode\n     * (\"Voiture\" ou \"Pieton\")\n     *\n     * @private\n     */\n    _initTransport () {\n        // Mode de transport selectionné\n        this._currentTransport = \"Pieton\"; // par defaut\n\n        // par defaut\n        var transport = this.options.graphs;\n        if (!transport || transport.length === 0) {\n            this.options.graphs = [\"Pieton\", \"Voiture\"];\n        }\n\n        // option\n        if (Array.isArray(transport) && transport.length) {\n            // FIXME pb si le 1er graphe n'est pas une ressource connue !\n            if (transport[0] === \"Voiture\" || transport[0] === \"Pieton\") {\n                this._currentTransport = transport[0];\n            }\n        }\n\n        // TODO option sur le service\n        var serviceOptions = this.options.routeOptions;\n        if (serviceOptions.graph) {\n            this._currentTransport = serviceOptions.graph;\n        }\n    }\n\n    /**\n     * this method is called by the constructor and initialize computation mode\n     * (fastest or shortest)\n     *\n     * @private\n     */\n    _initComputation () {\n        // Mode de calcul selectionné\n        this._currentComputation = \"fastest\"; // par defaut\n\n        // TODO option sur le service\n        var serviceOptions = this.options.routeOptions;\n        if (serviceOptions.routePreference) {\n            this._currentComputation = serviceOptions.routePreference;\n        }\n    }\n\n    /**\n     * this method is called by the constructor and initialize exclusions\n     *\n     * @private\n     */\n    _initExclusions () {\n        // Exclusions selectionnées : Tunnel, Toll et Bridge\n        this._currentExclusions = []; // par defaut\n\n        // par defaut\n        var exclusion = this.options.exclusions;\n        if (!exclusion || (typeof exclusion === \"object\" && Object.keys(exclusion).length === 0)) {\n            this.options.exclusions = {\n                toll : false,\n                tunnel : false,\n                bridge : false\n            };\n        }\n\n        // option\n        if (exclusion && typeof exclusion === \"object\" && Object.keys(exclusion).length) {\n            for (var k in exclusion) {\n                if (exclusion.hasOwnProperty(k)) {\n                    if (exclusion[k]) {\n                        this._currentExclusions.push(k);\n                    }\n                }\n            }\n        }\n\n        // TODO option sur le service\n        var serviceOptions = this.options.routeOptions;\n        if (Array.isArray(serviceOptions.exclusions)) {\n            this._currentExclusions = serviceOptions.exclusions;\n        }\n    }\n\n    /**\n     * this method is called by this.initialize() and initialize popup div\n     * (to display results information on route result click)\n     *\n     * @return {Object} element - DOM element for popup\n     * @private\n     */\n    _initPopupDiv () {\n        var context = this;\n        var element = document.createElement(\"div\");\n        element.className = \"gp-feature-info-div\";\n        var closer = document.createElement(\"button\");\n        closer.className = \"gp-styling-button closer\";\n        // on closer click : remove popup\n        closer.onclick = function () {\n            if (context._popupOverlay != null) {\n                context._popupOverlay.setPosition(undefined);\n            }\n            return false;\n        };\n        this._popupContent = document.createElement(\"div\");\n        this._popupContent.className = \"gp-features-content-div\";\n        element.appendChild(this._popupContent);\n        element.appendChild(closer);\n\n        return element;\n    }\n\n    // ################################################################### //\n    // ############################## DOM ################################ //\n    // ################################################################### //\n\n    /**\n     * Create List Points\n     * Overwrite RouteDOM method !\n     *\n     * @param {Object} map - the map\n     *\n     * @returns {Array} List DOM element\n     * @private\n     */\n    _createRoutePanelFormPointsElement (map) {\n        var points = [];\n        var count = 1;\n\n        // point de depart\n        var start = new LocationSelector({\n            apiKey : this.options.apiKey || null,\n            tag : {\n                id : count,\n                label : \"Départ\",\n                groupId : this._uid,\n                markerOpts : this.options.markersOpts[\"departure\"],\n                display : true\n            },\n            autocompleteOptions : this.options.autocompleteOptions || null\n        });\n        start.setMap(map);\n        // on ajoute des écouteurs d'évènements (en plus de ceux de LocationSelector),\n        // pour prendre en compte les CSS spécifiques de GProuteForm\n        this._addFormPointsEventListeners(start);\n        points.push(this._createRoutePanelFormPointLabel(\"Départ\"));\n        points.push(start._container);\n        this._currentPoints.push(start);\n\n        // points intermediaires\n        for (count = 2; count < 7; count++) {\n            var step = new LocationSelector({\n                apiKey : this.options.apiKey || null,\n                tag : {\n                    id : count,\n                    label : \"Etape \" + (count-1),\n                    groupId : this._uid,\n                    markerOpts : this.options.markersOpts[\"stages\"],\n                    display : false,\n                    removeOption : true\n                },\n                autocompleteOptions : this.options.autocompleteOptions || null\n            });\n            step.setMap(map);\n            this._addFormPointsEventListeners(step);\n            points.push(this._createRoutePanelFormPointLabel(\"Étape\", false));\n            points.push(step._container);\n            this._currentPoints.push(step);\n        }\n\n        // point d'arrivée\n        var end = new LocationSelector({\n            apiKey : this.options.apiKey || null,\n            tag : {\n                id : count,\n                label : \"Arrivée\",\n                groupId : this._uid,\n                markerOpts : this.options.markersOpts[\"arrival\"],\n                display : true,\n                addOption : true\n            },\n            autocompleteOptions : this.options.autocompleteOptions || null\n        });\n        end.setMap(map);\n        this._addFormPointsEventListeners(end);\n        points.push(this._createRoutePanelFormPointLabel(\"Arrivée\"));\n        points.push(end._container);\n        this._currentPoints.push(end);\n\n        return points;\n    }\n\n    /**\n     * Attach events listeners to route form points (locationSelector)\n     *\n     * @param {Object} formPoint - route form point (locationSelector)\n     * @private\n     */\n    _addFormPointsEventListeners (formPoint) {\n        if (!formPoint) {\n            return;\n        }\n\n        if (formPoint._buttonLabel.addEventListener) {\n            // display form on origin label click\n            formPoint._buttonLabel.addEventListener(\n                \"click\",\n                (e) => this.onRouteOriginLabelClick(e)\n            );\n            // minimize form on input show pointer, and set map event listeners (see this.onRouteOriginPointerClick)\n            formPoint._inputShowPointer.addEventListener(\n                \"click\",\n                (e) => this.onRouteOriginPointerClick(e, formPoint)\n            );\n            if (formPoint._removePointElement) {\n                formPoint._removePointElement.addEventListener(\n                    \"click\",\n                    (e) => {\n                        logger.trace(\"click on _removePointElement\", e);\n                        // Moving up exclusions picto\n                        // var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                        // context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                    }\n                );\n            }\n            if (formPoint._addPointElement) {\n                formPoint._addPointElement.addEventListener(\n                    \"click\",\n                    (e) => {\n                        logger.trace(\"click on _addPointElement\", e);\n                        // Moving down exclusions picto\n                        // var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                        // context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n                    }\n                );\n            }\n        } else if (formPoint._buttonLabel.attachEvent) {\n            // attachEvent: Internet explorer event listeners management\n            formPoint._buttonLabel.attachEvent(\n                \"onclick\",\n                (e) => this.onRouteOriginLabelClick(e)\n            );\n            formPoint._inputShowPointer.attachEvent(\n                \"onclick\",\n                (e) => this.onRouteOriginPointerClick(e, formPoint)\n            );\n            if (formPoint._removePointElement) {\n                formPoint._removePointElement.attachEvent(\n                    \"onclick\",\n                    (e) => {\n                        // Moving up exclusions picto\n                        // var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                        // context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                    }\n                );\n            }\n            if (formPoint._addPointElement) {\n                formPoint._addPointElement.attachEvent(\n                    \"onclick\",\n                    (e) => {\n                        // Moving down exclusions picto\n                        // var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                        // context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n                    }\n                );\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'submit' on 'GProuteForm' tag form\n     * (cf. this._createRoutePanelFormElement), and it displays the results.\n     *\n     * @param {Object} options - options\n     * @private\n     */\n    onRouteComputationSubmit (options) {\n        logger.log(\"onRouteComputationSubmit\", options);\n\n        // FIXME on lance une requête en EPSG:4326, les coordonnées\n        // doivent donc être du type cad en lat/lon.\n        // or, BUG du service du calcul d'itineraire car les\n        // coordonnées envoyées doivent être en lon/lat avec une SRS en EPSG:4326 !?\n        // sinon, ça plante...\n\n        // Liste des points\n        var points = this._currentPoints;\n\n        // - point de depart (info: points[0].getCoordinate est du type [lon, lat], en EPSG:4326)\n        var start;\n        if (points[0] && points[0].getCoordinate) {\n            var startCoordinate = points[0].getCoordinate();\n            start = {\n                x : startCoordinate[0],\n                y : startCoordinate[1]\n            };\n            logger.log(\"start\", start);\n        }\n\n        // - point d'arrivée\n        var end;\n        var endPoint = points[points.length - 1];\n        if (endPoint && endPoint.getCoordinate) {\n            var endCoordinate = endPoint.getCoordinate();\n            end = {\n                x : endCoordinate[0],\n                y : endCoordinate[1]\n            };\n            logger.log(\"end\", end);\n        }\n\n        // - les étapes\n        var step = [];\n        for (var i = 1; i < points.length - 1; i++) {\n            if (points[i] && points[i].getCoordinate) {\n                var iCoordinate = points[i].getCoordinate();\n                if (iCoordinate) {\n                    var coordinate = {\n                        x : iCoordinate[0],\n                        y : iCoordinate[1]\n                    };\n                    logger.log(\"step\", coordinate);\n                    step.push(coordinate);\n                }\n            }\n        }\n\n        // valeurs selectionnées\n        this._currentTransport = options.transport;\n        this._currentComputation = options.computation;\n        this._currentExclusions = options.exclusions;\n\n        // on recupere les éventuelles options du service passées par l'utilisateur\n        var routeOptions = this.options.routeOptions;\n\n        // OVERLOAD : la resource bd-topo-osrm ne gère pas le calcul piéton en mode fastest\n        // dans ce cas, on utilise valhalla dans le cas d'une utilisation par défaut du widget\n        // sans paramétrage de resource explicitement demandé\n        var routeResource;\n        if (!routeOptions.resource) {\n            if (this._currentComputation === \"fastest\" && this._currentTransport === \"Pieton\") {\n                routeResource = \"bdtopo-valhalla\";\n            }\n        } else {\n            routeResource = routeOptions.resource;\n        }\n\n        // gestion du protocole et du timeout\n        // le timeout est indispensable sur le protocole JSONP.\n        var _protocol = routeOptions.protocol || \"XHR\";\n        var _timeout = routeOptions.timeOut || 0;\n        if (_protocol === \"JSONP\" && _timeout === 0) {\n            // FIXME le timeout est obligatoire pour ce type de protocole...\n            _timeout = 15000;\n        }\n\n        // gestion des callback\n        var bOnFailure = !!(routeOptions.onFailure !== null && typeof routeOptions.onFailure === \"function\"); // cast variable to boolean\n        var bOnSuccess = !!(routeOptions.onSuccess !== null && typeof routeOptions.onSuccess === \"function\");\n\n        // on met en place l'affichage des resultats dans la fenetre de resultats.\n        var context = this;\n        this._requestRouting({\n            startPoint : start,\n            endPoint : end,\n            viaPoints : step,\n            graph : routeOptions.graph || this._currentTransport,\n            routePreference : routeOptions.routePreference || this._currentComputation,\n            exclusions : routeOptions.exclusions || this._currentExclusions,\n            geometryInInstructions : true,\n            distanceUnit : \"m\",\n            timeOut : _timeout,\n            protocol : _protocol,\n            resource : routeResource,\n            // callback onSuccess\n            onSuccess : function (results) {\n                logger.log(results);\n                if (results) {\n                    context._fillRouteResultsDetails(results);\n                }\n                if (bOnSuccess) {\n                    routeOptions.onSuccess.call(context, results);\n                }\n            },\n            // callback onFailure\n            onFailure : function (error) {\n                context._hideWaitingContainer();\n                context._clearRouteResultsDetails();\n                logger.log(error.message);\n                if (bOnFailure) {\n                    routeOptions.onFailure.call(context, error);\n                }\n            }\n        });\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPlocationOriginLabel' label\n     * and set 'GProuteForm' CSS class to \"\" (normal)\n     *\n     * @param {Object} routeControl - context : route Control (this)\n     * @private\n     */\n    onRouteOriginLabelClick () {\n        this._formRouteContainer.className = \"gpf-panel__content gpf-mobile-form fr-modal__content\";\n        // on désactive l'écouteur d'événements sur la carte (pour ne pas placer un marker au clic)\n        // map.un(\n        //     \"click\",\n        //     () => {\n        //         // on ne rétablit pas le mode \"normal\" si on est dans le panel des résultats (où className = \"GProuteComponentHidden\")\n        //         if (this._formRouteContainer.className === \"GProuteFormMini\") {\n        //             this._formRouteContainer.className = \"gpf-panel__content fr-modal__content\";\n        //         }\n        //     }\n        // );\n        olObservableUnByKey(this.listenerKey);\n        this.dispatchEvent(\"route:drawend\");\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPlocationOriginPointerImg' label\n     * and display or minimize 'GProuteForm', using CSS class (\"GProuteFormMini\" or \"\")\n     *\n     * @param {Object} e - context : route Control (equivalent to this)\n     * @param {Object} locationSelector - context : locationSelector input (one of this._currentPoints)\n     * @private\n     */\n    onRouteOriginPointerClick (e, locationSelector) {\n        var map = this.getMap();\n        if (locationSelector._inputShowPointerContainer.checked) {\n            // au click sur l'input pour pointer sur la carte: on minimise le formulaire\n            this._formRouteContainer.className = \"GProuteFormMini gpf-panel__content fr-modal__content\";\n            e.target.parentElement.parentElement.classList.add(\"selected\");\n            // et au clic sur la carte, on réaffichera le formulaire \"normal\"\n            this.listenerKey = map.on(\n                \"click\",\n                () => {\n                    e.target.parentElement.parentElement.classList.remove(\"selected\");\n                    // on ne rétablit pas le mode \"normal\" si on est dans le panel des résultats (où className = \"GProuteComponentHidden\")\n                    if (this._formRouteContainer.className === \"GProuteFormMini gpf-panel__content fr-modal__content\") {\n                        this._formRouteContainer.className = \"gpf-panel__content fr-modal__content\";\n                    }\n                    olObservableUnByKey(this.listenerKey);\n                    /**\n                    * event triggered at the end of drawing input\n                    *\n                    * @event route:drawend\n                    */\n                    this.dispatchEvent(\"route:drawend\");\n                }\n            );\n            /**\n            * event triggered at the start of drawing input\n            *\n            * @event route:drawstart\n            */\n            this.dispatchEvent(\"route:drawstart\");\n        } else {\n            // si on déselectionne le pointer, on rétablit le formulaire en mode normal\n            this._formRouteContainer.className = \"\";\n            // et on enlève l'écouteur d'évènement sur la carte\n            // map.un(\n            //     \"click\",\n            //     () => {\n            //         // on ne rétablit pas le mode \"normal\" si on est dans le panel des résultats (où className = \"GProuteComponentHidden\")\n            //         if (this._formRouteContainer.className === \"GProuteFormMini\") {\n            //             this._formRouteContainer.className = \"gpf-panel__content fr-modal__content\";\n            //         }\n            //     }\n            // );\n            olObservableUnByKey(this.listenerKey);\n            this.dispatchEvent(\"route:drawend\");\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPshowRoutePicto'\n     * tag label (cf. this._createShowRoutePictoElement),\n     * and it cleans all value of input.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onShowRoutePanelClick (e) {\n        var opened = this._showRouteButton.ariaPressed;\n        if (opened === \"true\") {\n            this.onPanelOpen();\n        }\n        var map = this.getMap();\n        // on supprime toutes les interactions\n        Interactions.unset(map);\n        // clean !\n        if (!this._geojsonSections && !this._waiting) {\n            this._clear();\n        }\n        this.collapsed = !(opened === \"true\");\n        // on génère nous même l'evenement OpenLayers de changement de pté\n        // (utiliser ol.control.Route.on(\"change:collapsed\", function ) pour s'abonner à cet évènement)\n        this.dispatchEvent(\"change:collapsed\");\n\n        // on recalcule la position\n        if (this.options.position && !this.collapsed) {\n            this.updatePosition(this.options.position);\n        }\n    }\n\n    /**\n     * this method is called by event 'change' on 'GProuteComputationSelect' tag select\n     * (cf. this._createRoutePanelFormModeChoiceComputeElement).\n     * this value is saved as a parameter for the service route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteModeComputationChange (e) {\n        var value = e.target.value;\n\n        if (!value) {\n            return;\n        }\n\n        logger.log(value);\n        this._currentComputation = value;\n    }\n\n    /**\n     * this method is called by event 'change' on 'GProuteResultsComputationSelect' tag select\n     * (cf. this._createRouteResultsElement).\n     * this value is saved as a parameter for the service route,\n     * and this launches the route request !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteModeComputationChangeAndRun (e) {\n        // event choice computation\n        this.onRouteModeComputationChange(e);\n\n        // clean avant un nouveau calcul !\n        this._clearRouteResultsDetails();\n        this._clearRouteResultsGeometry();\n        this._clearRouteResultsFeatureGeometry();\n\n        // submit request\n        this.onRouteComputationSubmit({\n            computation : this._currentComputation,\n            transport : this._currentTransport,\n            exclusions : this._currentExclusions\n        });\n    }\n\n    /**\n     * this method is called by event 'change' on 'GProuteTransportCar' or 'GProuteTransportPedestrian' tag input\n     * (cf. this._createRoutePanelFormModeChoiceTransportElement).\n     * this value is saved as a parameter for the service route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteModeTransportChange (e) {\n        var value = e.target.value;\n        if (!value) {\n            return;\n        }\n        this._currentTransport = value;\n    }\n\n    /**\n     * TODO this method is called by event 'click' on 'GPshowRouteExclusionsPicto' tag input\n     * (cf. this._createShowRouteExclusionsPictoElement), and it displays the panel options of exclusions.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onShowRouteExclusionsClick (e) {\n        logger.log(\"onShowRouteExclusionsClick\", e);\n        // FIXME not use ?!\n    }\n\n    /**\n     * this method is called by event 'change' on 'GProuteExclusionsToll'\n     * or 'GProuteExclusionsTunnel' or 'GProuteExclusionsBridge' tag input\n     * (cf. this._createRoutePanelFormExclusionOptionsElement).\n     * this value is saved as a parameter for the service route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteExclusionsChange (e) {\n        var value = e.target.value;\n        var checked = e.target.checked;\n\n        if (!value || (typeof value !== \"string\")) {\n            return;\n        }\n        value = value.toLowerCase();\n\n        var bFound = false;\n        var iFound = null;\n        for (var i = 0; i < this._currentExclusions.length; i++) {\n            if (this._currentExclusions[i] === value) {\n                iFound = i;\n                bFound = true;\n            }\n        }\n        // on l'ajoute si la valeur n'existe pas et est déselectionnée\n        // info : checked = passage autorisé (ce n'est pas une exclusion)\n        if (!bFound && !checked) {\n            this._currentExclusions.push(value);\n        }\n        // on la retire si la valeur existe et est selectionnée\n        if (bFound && checked) {\n            this._currentExclusions.splice(iFound, 1);\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GProuteReset'\n     * tag label (cf. this._createRouteFormResetElement),\n     * and it cleans all route input options and results.\n     *\n     * @private\n     */\n    onRouteResetClick () {\n        // clear points\n        var currentPoints = this._currentPoints;\n        for (var i = 0; i < currentPoints.length; i++) {\n            currentPoints[i].clear();\n        }\n\n        // clear results\n        this._clear();\n\n        this._clearRouteInputOptions();\n    }\n\n    /**\n     * this method is called by event 'click' on 'GProuteSubmit'\n     * tag label (cf. this._createRouteSubmitFormElement),\n     * and it cleans the route geometry.\n     *\n     * @private\n     */\n    onShowRouteResultsNewClick () {\n        // clean avant un nouveau calcul !\n        this._clearRouteResultsDetails();\n        this._clearRouteResultsGeometry();\n        this._clearRouteResultsFeatureGeometry();\n        /**\n        * event triggered when user clear points to compute route\n        *\n        * @event route:newresults\n        */\n        this.dispatchEvent(\"route:newresults\");\n    }\n\n    /**\n     * this method is called by event 'mouseover' on 'GProuteResultsDetailsInstruction_'\n     * tag label (cf. this._addRouteResultsDetailsElement),\n     * and it makes a style on feature route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteResultsDetailsMouseOver (e) {\n        // récupération de l'id de l'instruction survolée\n        var tagid = e.target.id; // ex GProuteResultsDetailsInstruction_125\n        var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 125\n\n        // on passe le texte en gras\n        if (e.target.classList) {\n            e.target.classList.add(\"GProuteResultsDetailsInstructionHighlight\");\n        }\n\n        if (!this._geojsonSections) {\n            return;\n        }\n\n        // on récupère l'entité correspondante à l'instruction survolée\n        var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));\n        // et on lui affecte un nouveau style\n        f.setStyle(this._selectedFeatureStyle);\n    }\n\n    /**\n     * this method is called by event 'mouseout' on 'GProuteResultsDetailsInstruction_'\n     * tag label (cf. this._addRouteResultsDetailsElement),\n     * and it deletes a style on feature route.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onRouteResultsDetailsMouseOut (e) {\n        // récupération de l'id de l'instruction survolée\n        var tagid = e.target.id; // ex GProuteResultsDetailsInstruction_125\n        var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 125\n\n        // on repasse le texte en style normal\n        if (e.target.classList) {\n            e.target.classList.remove(\"GProuteResultsDetailsInstructionHighlight\");\n        }\n\n        if (!this._geojsonSections) {\n            return;\n        }\n        // on récupère l'entité correspondante à l'instruction qui était survolée\n        var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));\n        // et on lui réaffecte un style normal\n        f.setStyle(null);\n    }\n\n    // ################################################################### //\n    // ########################### Routing ############################### //\n    // ############## (methods to request and results) ################### //\n\n    /**\n     * this method is called by this.onRouteComputationSubmit()\n     * and executes a request to the service.\n     *\n     * @param {Object} options - route service request options\n     * @param {Function} options.onSuccess - callback\n     * @param {Function} options.onFailure - callback\n     * @private\n     */\n    _requestRouting (options) {\n        // on ne fait pas de requête si on n'a pas renseigné de parametres !\n        if (!options || (typeof options === \"object\" && Object.keys(options).length === 0)) {\n            return;\n        }\n\n        // on ne fait pas de requête si\n        // - la parametre 'startPoint' est vide !\n        if (!options.startPoint) {\n            return;\n        }\n        // - la parametre 'endPoint' est vide !\n        if (!options.endPoint) {\n            return;\n        }\n\n        // cas où la clef API n'est pas renseignée dans les options du service,\n        // on utilise celle renseignée au niveau du controle (calcul par défaut)\n        options.apiKey = this.options.routeOptions.apiKey || this.options.apiKey;\n\n        // si l'utilisateur a spécifié le paramètre ssl au niveau du control, on s'en sert\n        // true par défaut (https)\n        if (typeof options.ssl !== \"boolean\") {\n            if (typeof this.options.ssl === \"boolean\") {\n                options.ssl = this.options.ssl;\n            } else {\n                options.ssl = true;\n            }\n        }\n        logger.log(options);\n\n        // mise en place de la patience\n        this._displayWaitingContainer();\n\n        // appel du service de calcul d'itinéraires\n        Gp.Services.route(options);\n    }\n\n    /**\n     * this method is called by this.onRouteComputationSubmit() (in case of route computation success)\n     * and fills the container of the route instructions list, distance and time\n     * information, also, constructs the geometry route.\n     *\n     * @param {Object} results - results of the route calculation\n     *\n     * @private\n     */\n    _fillRouteResultsDetails (results) {\n        // 1. Affichage des distances et durées\n        var distance = results.totalDistance;\n        var duration = results.totalTime;\n        // Détails avec simplifications des troncons\n        var instructions = this._simplifiedInstructions(results.routeInstructions);\n        // var instructions = results.routeInstructions;\n\n        if (instructions) {\n            this._fillRouteResultsDetailsContainer(distance, duration, instructions);\n        }\n\n        // 2. Affichage des géométries\n        // Geometrie simplifiée (si renseignée)\n        var geometry = results.routeGeometry;\n        if (geometry) {\n            this._fillRouteResultsDetailsGeometry(geometry, this._defaultFeatureStyle);\n        }\n\n        // Geometries des tronçon (si renseignée)\n        if (instructions && instructions[0].geometry) {\n            this._fillRouteResultsDetailsFeatureGeometry(instructions, this._defaultFeatureStyle);\n        }\n\n        // 3. Zoom sur l'emprise de l'itinéraire (si spécifiée)\n        var bbox = results.bbox;\n        if (bbox) {\n            var map = this.getMap();\n            var bounds = [bbox.left, bbox.bottom, bbox.right, bbox.top];\n            // reprojection dans la projection de la carte (bbox initialement en EPSG:4326)\n            var mapProj = map.getView().getProjection().getCode();\n            if (mapProj !== \"EPSG:4326\") {\n                bounds = olTransformExtentProj(bounds, \"EPSG:4326\", mapProj);\n            }\n            map.getView().fit(bounds, map.getSize());\n        }\n\n        // sauvegarde de l'etat des resultats\n        this._currentRouteInformations = results;\n\n        /**\n         * event triggered when the compute is finished\n         *\n         * @event route:compute\n         * @property {Object} type - event\n         * @property {Object} target - instance Route\n         * @example\n         * Route.on(\"route:compute\", function (e) {\n         *   console.log(e.target.getData());\n         * })\n         */\n        this.dispatchEvent({\n            type : \"route:compute\"\n        });\n\n        // mise à jour du controle !\n        this._formRouteContainer.className = \"GPelementHidden gpf-hidden gpf-panel__content fr-modal__content\";\n        this._hideWaitingContainer();\n        this._resultsRouteContainer.className = \"\";\n    }\n\n    /**\n     * this method is called by this._fillRouteResultsDetails()\n     * and fills the container of the route instructions list, distance and time\n     * information.\n     *\n     * @param {Number} distance - distance\n     * @param {Number} duration - duration\n     * @param {Object[]} instructions - list of instructions\n     *\n     * @private\n     */\n    _fillRouteResultsDetailsContainer (distance, duration, instructions) {\n        // Distance et Durée\n        this._resultsRouteValuesContainer = this._addRouteResultsValuesElement(distance, duration, MathUtils.convertSecondsToTime);\n\n        // Détails\n        this._resultsRouteDetailsContainer = this._addRouteResultsDetailsElement(instructions, MathUtils.convertSecondsToTime);\n    }\n\n    /**\n     * this method is called by this._fillRouteResultsDetails()\n     * and constructs the geometry route.\n     *\n     * @param {Object} geometry - geoJSON object for route geometry\n     * @param {Object} style - route ol.style.Style object\n     * @private\n     */\n    _fillRouteResultsDetailsGeometry (geometry, style) {\n        this._clearRouteResultsGeometry();\n\n        var map = this.getMap();\n\n        if (!geometry) {\n            return;\n        }\n\n        // création de l'objet geoJSON\n        var geojsonObject = {\n            type : \"FeatureCollection\",\n            features : [\n                {\n                    type : \"Feature\",\n                    crs : {\n                        type : \"name\",\n                        properties : {\n                            name : \"EPSG:4326\"\n                        }\n                    },\n                    geometry : geometry\n                }\n            ]\n        };\n\n        var geojsonformat = new GeoJSONExtended({\n            defaultDataProjection : \"EPSG:4326\",\n            defaultStyle : style\n\n        });\n        var features = geojsonformat.readFeatures(\n            geojsonObject, {\n                dataProjection : \"EPSG:4326\",\n                featureProjection : \"EPSG:3857\"\n            }\n        );\n\n        // ajout de la géométrie comme nouvelle couche vecteur à la carte\n        this._geojsonRoute = new VectorLayer({\n            source : new VectorSource({\n                features : features\n            }),\n            style : style,\n            title : \"Mon Itinéraire\"\n        });\n        map.addLayer(this._geojsonRoute);\n    }\n\n    /**\n     * this method is called by this._fillRouteResultsDetails()\n     * and constructs the geometries street with informations.\n     *\n     * @param {Array} instructions - route instructions list (containing geoJSON geometry)\n     * @param {Object} style - route ol.style.Style object\n     * @private\n     */\n    _fillRouteResultsDetailsFeatureGeometry (instructions, style) {\n        this._clearRouteResultsFeatureGeometry();\n\n        var map = this.getMap();\n\n        // 1. création de l'objet geoJSON\n        this._geojsonObject = {\n            type : \"FeatureCollection\",\n            crs : {\n                type : \"name\",\n                properties : {\n                    name : \"EPSG:4326\"\n                }\n            },\n            features : []\n        };\n\n        // 2. Remplissage de l'objet geoJSON : ajout des géométries de chaque instruction\n        for (var i = 0; i < instructions.length; i++) {\n            var o = instructions[i];\n            var id = i + 1;\n\n            var coords = o.geometry.coordinates;\n            for (var j = 0; j < coords.length; j++) {\n                // remarque : les coordonnées sont au format string, à convertir en nombres\n                if (typeof coords[j][0] === \"string\") {\n                    coords[j][0] = parseFloat(coords[j][0]);\n                    coords[j][1] = parseFloat(coords[j][1]);\n                }\n            }\n\n            this._geojsonObject.features.push({\n                type : \"Feature\",\n                geometry : o.geometry,\n                properties : {\n                    popupContent : \"(\" + id + \") distance : \" + MathUtils.convertDistance(o.distance) +\n                        \" / temps : \" + MathUtils.convertSecondsToTime(o.duration)\n                },\n                id : id\n            });\n        }\n\n        // Ajout du point de depart du tracé\n        this._geojsonObject.features.push({\n            type : \"Feature\",\n            geometry : {\n                type : \"Point\",\n                coordinates : this._currentPoints[0].getCoordinate()\n            },\n            properties : {\n                description : \"Point de départ\",\n                \"marker-symbol\" : this.options.markersOpts.departure.url\n            }\n        });\n\n        // Ajout des points d'étapes\n        for (var k = 1; k < this._currentPoints.length - 1; k++) {\n            if (this._currentPoints[k] && this._currentPoints[k].getCoordinate) {\n                var coordinates = this._currentPoints[k].getCoordinate();\n                if (coordinates) {\n                    this._geojsonObject.features.push({\n                        type : \"Feature\",\n                        geometry : {\n                            type : \"Point\",\n                            coordinates : coordinates\n                        },\n                        properties : {\n                            description : \"Point d'étape\",\n                            \"marker-symbol\" : this.options.markersOpts.stages.url\n                        }\n                    });\n                }\n            }\n        }\n\n        // Ajout du point d'arrivée du tracé\n        this._geojsonObject.features.push({\n            type : \"Feature\",\n            geometry : {\n                type : \"Point\",\n                coordinates : this._currentPoints[this._currentPoints.length - 1].getCoordinate()\n            },\n            properties : {\n                description : \"Point d'arrivée\",\n                \"marker-symbol\" : this.options.markersOpts.arrival.url\n            }\n        });\n\n        // Création du format GeoJSON, avec reprojection des géométries\n        var geojsonformat = new GeoJSONExtended({\n            defaultDataProjection : \"EPSG:4326\",\n            defaultStyle : style\n        });\n        var mapProj = this.getMap().getView().getProjection().getCode();\n        var features = geojsonformat.readFeatures(\n            this._geojsonObject, {\n                dataProjection : \"EPSG:4326\",\n                featureProjection : mapProj\n            }\n        );\n\n        // 3. Ajout du tracé de l'itinéraire (geoJSON) comme nouvelle couche vecteur à la carte\n        this._geojsonSections = new VectorLayer({\n            source : new VectorSource({\n                features : features\n            }),\n            style : style,\n            opacity : 0.9,\n            title : \"Mon Itinéraire\"\n        });\n\n        var graph;\n        if (this._currentTransport === \"Pieton\") {\n            graph = \"piéton\";\n            this._geojsonSections.gpResultLayerId = \"compute:Pieton$OGC:OPENLS;Itineraire\";\n        } else {\n            graph = \"voiture\";\n            this._geojsonSections.gpResultLayerId = \"compute:Voiture$OGC:OPENLS;Itineraire\";\n        }\n        // ajout à la carte\n        map.addLayer(this._geojsonSections);\n\n        // 4. Si un layer switcher est présent dans la carte, on lui affecte des informations pour cette couche\n        map.getControls().forEach(\n            (control) => {\n                if (control instanceof LayerSwitcher) {\n                    // un layer switcher est présent dans la carte\n                    var layerId = this._geojsonSections.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas déjà (si le titre est le numéro par défaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this._geojsonSections, {\n                                title : this.options.layerDescription.title + \" (\" + graph + \")\",\n                                description : this.options.layerDescription.description\n                            }\n                        );\n                    }\n                }\n            },\n            this\n        );\n\n        // 5. Ajout de popups aux troncons\n        // Création de l'interaction : survol des features (=troncons de l'itinéraire)\n        this._resultsHoverInteraction = new SelectInteraction({\n            condition : eventPointerMove,\n            layers : [this._geojsonSections],\n            style : this._selectedFeatureStyle\n        });\n        this._resultsHoverInteraction.on(\n            \"select\",\n            (e) => this._onResultsFeatureMouseOver(e)\n        );\n        map.addInteraction(this._resultsHoverInteraction);\n\n        // Création de l'interaction : selection des features (=troncons de l'itinéraire)\n        this._resultsSelectInteraction = new SelectInteraction({\n            layers : [this._geojsonSections],\n            style : this._selectedFeatureStyle\n        });\n        this._resultsSelectInteraction.on(\n            \"select\",\n            (e) => this._onResultsFeatureSelect(e)\n        );\n        map.addInteraction(this._resultsSelectInteraction);\n    }\n\n    /**\n     * this method is called on route features hover\n     * and highlight instruction label\n     *\n     * @param {Object} e - event\n     *\n     * @private\n     */\n    _onResultsFeatureMouseOver (e) {\n        if (e.selected.length !== 0) {\n            // si on a bien survolé un tronçon, on surligne l'instruction correspondante\n            var f = e.selected[0];\n            var selectedInstruction = document.getElementById(\"GProuteResultsDetailsInstruction_\" + f.getId() + \"-\" + this._uid);\n            if (selectedInstruction && selectedInstruction.classList) {\n                selectedInstruction.classList.add(\"GProuteResultsDetailsInstructionHighlight\");\n            }\n        }\n\n        // si on déselectionne un tronçon (mouseout), on rétablit un style normal pour l'instruction\n        if (e.deselected.length !== 0) {\n            var deselectedFeature = e.deselected[0];\n            // on repasse l'instruction correspondante en normal\n            var deSelectedInstruction = document.getElementById(\"GProuteResultsDetailsInstruction_\" + deselectedFeature.getId() + \"-\" + this._uid);\n            if (deSelectedInstruction && deSelectedInstruction.classList) {\n                deSelectedInstruction.classList.remove(\"GProuteResultsDetailsInstructionHighlight\");\n            }\n        }\n    }\n\n    /**\n     * this method is called on route features select\n     * and set a popup with feature information\n     *\n     * @param {Object} e - on select event\n     * @private\n     */\n    _onResultsFeatureSelect (e) {\n        var map = this.getMap();\n        if (e.selected.length !== 0) {\n            // si on a sélectionné un troncon, on lui ajoute une popup\n            var f = e.selected[0];\n            this._popupContent.innerHTML = f.getProperties().popupContent;\n\n            if (!this._popupOverlay) {\n                // ajout de la popup a la carte comme un overlay\n                this._popupOverlay = new Overlay({\n                    element : this._popupDiv,\n                    positioning : \"bottom-center\",\n                    position : e.mapBrowserEvent.coordinate\n                });\n                map.addOverlay(this._popupOverlay);\n            } else {\n                // si l'overlay est déjà créé, on modifie juste sa position\n                this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate);\n            }\n        } else {\n            // si aucun troncon n'est sélectionné (click à côté du tracé),\n            // on fait disparaitre la popup si elle existe\n            if (this._popupOverlay != null) {\n                this._popupOverlay.setPosition(undefined);\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ############################# Clean ############################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this.onShowRoutePanelClick()\n     * and it clears all elements (reinit).\n     *\n     * @private\n     */\n    _clear () {\n        this._currentTransport = null;\n        this._currentExclusions = [];\n        this._currentComputation = null;\n\n        // les resultats\n        this._clearRouteResultsDetails();\n        // la geometrie\n        this._clearRouteResultsGeometry();\n        this._clearRouteResultsFeatureGeometry();\n        // les points\n        for (var i = 0; i < this._currentPoints.length; i++) {\n            this._currentPoints[i].clear();\n        }\n        // suppression des points intermédiaires\n        this._removeRouteStepLocations();\n    }\n\n    /**\n     * this method is called by this.onRouteResetClick()\n     * and it clears all options inputs (reinit).\n     *\n     * @private\n     */\n    _clearRouteInputOptions () {\n        // reinit options to default\n        this._initTransport();\n        this._initComputation();\n        this._initExclusions();\n\n        // set transport mode to default\n        var transportdiv;\n        if (this._currentTransport === \"Pieton\") {\n            transportdiv = document.getElementById(\"GProuteTransportPedestrian-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        } else {\n            transportdiv = document.getElementById(\"GProuteTransportCar-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        }\n\n        // set computation mode to default\n        var computationdiv = document.getElementById(\"GProuteComputationSelect-\" + this._uid);\n        if (computationdiv) {\n            computationdiv.value = this._currentComputation;\n        }\n\n        // set exclusions to default\n        var tollInput = document.getElementById(\"GProuteExclusionsToll-\" + this._uid);\n        if (tollInput) {\n            if (this._currentExclusions.indexOf(\"toll\") !== -1) {\n                tollInput.checked = false;\n            } else {\n                tollInput.checked = true;\n            }\n        }\n\n        var tunnelInput = document.getElementById(\"GProuteExclusionsTunnel-\" + this._uid);\n        if (tunnelInput) {\n            if (this._currentExclusions.indexOf(\"tunnel\") !== -1) {\n                tunnelInput.checked = false;\n            } else {\n                tunnelInput.checked = true;\n            }\n        }\n\n        var bridgeInput = document.getElementById(\"GProuteExclusionsBridge-\" + this._uid);\n        if (bridgeInput) {\n            if (this._currentExclusions.indexOf(\"bridge\") !== -1) {\n                bridgeInput.checked = false;\n            } else {\n                bridgeInput.checked = true;\n            }\n        }\n    }\n\n    /**\n     * this method is called by this._clear()\n     * and it removes step location inputs (excepted departure and arrival)\n     *\n     * @private\n     */\n    _removeRouteStepLocations () {\n        var points = document.querySelectorAll(\"div[id^=\\\"GPlocationPoint\\\"]\");\n        if (points.length !== 0) {\n            var goodPoints = [];\n            for (var k = 0; k < points.length; k++) {\n                if (points[k].id.indexOf(this._uid) !== -1) {\n                    goodPoints.push(points[k]);\n                }\n            }\n            // on boucle sur les points intermédiaires\n            for (var i = 1; i < (goodPoints.length - 1); i++) {\n                // on va regarder les classes associées\n                var classList = goodPoints[i].classList;\n                if (classList.length !== 0) {\n                    for (var j = 0; j < classList.length; j++) {\n                        if (classList[j] === \"GPlocationStageFlexInput\") {\n                            // si l'élément est visible, on le supprime en simulant un clic sur la croix (x)\n                            document.getElementById(this._addUID(\"GPlocationStageRemove_\" + (i + 1))).click();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * this method is called by this.onRouteComputationSubmit() (in case of failure)\n     * and it clears all route instructions.\n     *\n     * @private\n     */\n    _clearRouteResultsDetails () {\n        this._currentRouteInformations = null;\n\n        // doit on nettoyer le container \"GProuteResultsDetails\" ?\n        // il sera de toute façon écrasé par la prochaine requête...\n        if (this._resultsRouteDetailsContainer) {\n            var detailsDiv = this._resultsRouteDetailsContainer;\n            if (detailsDiv.childElementCount) {\n                while (detailsDiv.firstChild) {\n                    detailsDiv.removeChild(detailsDiv.firstChild);\n                }\n            }\n        }\n\n        if (this._resultsRouteValuesContainer) {\n            var valuesDiv = this._resultsRouteValuesContainer;\n            if (valuesDiv.childElementCount) {\n                while (valuesDiv.firstChild) {\n                    valuesDiv.removeChild(valuesDiv.firstChild);\n                }\n            }\n        }\n    }\n\n    /**\n     * this method is called by this.onRouteComputationSubmit()\n     * and it clears all route geometries.\n     *\n     * @private\n     */\n    _clearRouteResultsGeometry () {\n        var map = this.getMap();\n\n        if (this._geojsonRoute != null) {\n            map.removeLayer(this._geojsonRoute);\n            this._geojsonRoute = null;\n        }\n    }\n\n    /**\n     * this method is called by this.onRouteComputationSubmit()\n     * and it clears all route geometries.\n     *\n     * @private\n     */\n    _clearRouteResultsFeatureGeometry () {\n        var map = this.getMap();\n\n        // on retire la couche itinéraire de la carte\n        if (this._geojsonSections != null) {\n            map.removeLayer(this._geojsonSections);\n            this._geojsonSections = null;\n            this._geojsonObject = null;\n        }\n        // on retire l'overlay de la popup de la carte\n        if (this._popupOverlay != null) {\n            map.removeOverlay(this._popupOverlay);\n            this._popupOverlay = null;\n        }\n        // et les interactions liées à cette couche\n        if (this._resultsSelectInteraction != null) {\n            map.removeInteraction(this._resultsSelectInteraction);\n            this._resultsSelectInteraction = null;\n        }\n        if (this._resultsHoverInteraction != null) {\n            map.removeInteraction(this._resultsHoverInteraction);\n            this._resultsHoverInteraction = null;\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on control main container\n     * and hide suggested Locations (unless target is an autocomplete input)\n     *\n     * @param {Object} e - event\n     *\n     * @private\n     */\n    _hideRouteSuggestedLocations (e) {\n        // si on clique sur un input de saisie de locationSelector\n        if (e.target && e.target.id && e.target.id.indexOf(\"GPlocationOrigin_\") !== -1) {\n            // on récupère le numéro du point\n            var pointId = parseInt(e.target.id.split(\"_\")[1][0], 10) - 1;\n            // et on cache les autres résultats d'autocomplétion (sauf celui sur lequel on clique)\n            for (var j = 0; j < this._currentPoints.length; j++) {\n                if (j !== parseInt(pointId, 10)) {\n                    this._currentPoints[j]._hideSuggestedLocation();\n                }\n            }\n        } else {\n            // si on clique ailleurs dans le DOM du control, on cache tous les résultats d'autocomplétion\n            for (var i = 0; i < this._currentPoints.length; i++) {\n                this._currentPoints[i]._hideSuggestedLocation();\n            }\n        }\n    }\n\n    /**\n     * this method displays waiting container and sets a timeout\n     *\n     * @private\n     */\n    _displayWaitingContainer () {\n        this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible\";\n        this._waiting = true;\n\n        // mise en place d'un timeout pour réinitialiser le panel (cacher la patience)\n        // si on est toujours en attente (si la requête est bloquée par exemple)\n        // ceci est vrai, uniquement sur le protocole JSONP !\n        var opts = this.options.routeOptions;\n        if (opts && opts.timeOut) {\n            if (this._timer) {\n                clearTimeout(this._timer);\n                this._timer = null;\n            }\n            var context = this;\n            this._timer = setTimeout(function () {\n                if (context._waiting === true) {\n                    context._hideWaitingContainer();\n                } else {\n                    if (context._timer) {\n                        clearTimeout(context._timer);\n                    }\n                }\n            }, 16000);\n        }\n    }\n\n    /**\n     * this method hides waiting container and clears timeout\n     *\n     * @private\n     */\n    _hideWaitingContainer () {\n        if (this._waiting) {\n            this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n            this._waiting = false;\n            var opts = this.options.routeOptions;\n            if (opts && opts.timeOut) {\n                clearTimeout(this._timer);\n                this._timer = null;\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ########################## Geometry ############################### //\n    // ################################################################### //\n\n    /**\n     * simplified instructions\n     *\n     * @param {Object[]} instructions - list of instructions\n     *\n     * @returns {Object[]} simplified instructions\n     *\n     * @private\n     */\n    _simplifiedInstructions (instructions) {\n        var newInstructions = [];\n\n        // cas où...\n        var current = instructions[0];\n        if (instructions.length === 1) {\n            newInstructions.push(current);\n        }\n\n        for (var i = 1; i < instructions.length; i++) {\n            var o = instructions[i];\n            if (o.instruction === current.instruction) {\n                current.distance = (parseFloat(o.distance) + parseFloat(current.distance)).toString();\n                current.duration = (parseFloat(o.duration) + parseFloat(current.duration)).toString();\n                for (var j = 1; j < o.geometry.coordinates.length; j++) {\n                    current.geometry.coordinates.push(o.geometry.coordinates[j]);\n                }\n            } else {\n                newInstructions.push(current);\n                current = o;\n                // last\n                if (i === instructions.length - 1) {\n                    newInstructions.push(o);\n                    current = null;\n                }\n            }\n        }\n        logger.log(newInstructions);\n        return newInstructions;\n    }\n    \n};\n\n// on récupère les méthodes de la classe commune ReverseGeocodingDOM\nObject.assign(Route.prototype, RouteDOM);\nObject.assign(Route.prototype, Widget);\n\nexport default Route;\n\n// Expose Route as ol.control.Route (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.Route = Route;\n}\n","/**\n * @module SelectorID\n * @alias module:~utils/SelectorID\n * @private\n * @description\n * formalisme d'un tag ID :\n * -> NAME(_ORDER)-1460636385836\n *\n * @example\n * Ex.\n *   GProutePoints-1460636385836\n *   GProutePoint_10-1460636385836\n */\nvar SelectorID = {\n\n    /**\n     * Construction d'un identifiant statique basé sur le timestamp,\n     * et qui s'incremente de +1 à chaque appel\n     * @function generate\n     */\n    generate : (function () {\n        var timestamp = Math.floor(Date.now());\n        return function () {\n            return timestamp++;\n        };\n    })(),\n\n    /**\n     * nom du tag\n     * @function name\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    name : function (id) {\n        var name = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i === -1) {\n            name = id;\n        } else {\n            name = id.substring(0, i);\n        }\n\n        return name;\n    },\n\n    /**\n     * numero d'identifiant du tag\n     *\n     * @function index\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    index : function (id) {\n        var index = null;\n\n        var name = this.name(id);\n        // if (name !== id) {\n        var i = name.lastIndexOf(\"_\");\n        if (i !== -1) {\n            index = name.substring(i + 1);\n        }\n        // }\n\n        return index;\n    },\n\n    /**\n     * uuid du tag\n     *\n     * @function uuid\n     * @param {String} id - the id\n     * @returns {String} uuid\n     */\n    uuid : function (id) {\n        var uuid = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i !== -1) {\n            uuid = parseInt(id.substring(i + 1), 10);\n        }\n\n        return uuid;\n    }\n\n};\n\nexport default SelectorID;\n","import Logger from \"../../../Utils/LoggerByDefault\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport RouteRequestREST from \"./RouteRequestREST\";\n\n/**\n * Creation d'une requête REST en mode POST ou GET\n * (Factory)\n *\n * @module RouteRequestFactory\n * @alias Gp.Services.Route.Request.RouteRequestFactory\n * @private\n */\nvar RouteRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Route\n     *\n     * @example\n     *   // utilisation avec les callback\n     *   var options = {\n     *      (...)\n     *      onSuccess : function (response) {},\n     *      onError : function (error) {},\n     *      // spécifique au service\n     *      startPoint : {\n     *          x : 42.1121,\n     *          y : 1.5557\n     *      },\n     *      endPoint : {\n     *          x : 42.1121,\n     *          y : 1.5557\n     *      },\n     *      provideBbox : false,\n     *      exclusions : [\"bridge\", \"tunnel\", \"toll\"],\n     *      distanceUnit : \"km\",\n     *      graph : \"Voiture\",\n     *      geometryInInstructions : false,\n     *      routePreference : \"fastest\"\n     *   };\n     *   RouteRequestFactory.build(options);\n     *\n     *   // utilisation sans callback\n     *   var options = {...};\n     *   try {\n     *      var result = RouteRequestFactory.build(options);\n     *      if (! result) { throw new Error(\"...\"):}\n     *   } catch (e) {\n     *      // todo\n     *   }\n     * @returns {String} request\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"RouteRequestFactory\");\n        logger.trace([\"RouteRequestFactory::build()\"]);\n\n        var request = null;\n\n        var settings = options || {};\n\n        // gestion des callback\n        var bOnError = !!(options.onError !== null && typeof options.onError === \"function\");\n\n        var message = null;\n\n        // FIXME les exceptions ne sont pas 'catchées' sur le constructeur !\n        var myReq = new RouteRequestREST(settings);\n        if (!myReq.processRequestString()) {\n            message = \"Error process request (rest) !\";\n            if (bOnError) {\n                options.onError.call(options.scope, new ErrorService(message));\n                return;\n            }\n            throw new Error(message);\n        }\n        request = myReq.requestString;\n\n        return request;\n    }\n};\n\nexport default RouteRequestFactory;\n","import Logger from \"../../../Utils/LoggerByDefault\";\nimport GeocodeRequestREST from \"./GeocodeRequestREST\";\n\n/**\n * Creation d'une requête\n * (Factory)\n *\n * @module GeocodeRequestFactory\n * @alias Gp.Services.Geocode.Request.GeocodeRequestFactory\n * @private\n */\nvar GeocodeRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Geocode\n     *\n     * @example\n     *   var options = {\n     *      // options specifiques du service\n     *      geocodeMethod:\n     *      query:\n     *      filters:\n     *      maximumResponses:\n     *   };\n     *   var result = GeocodeRequestFactory.build(options);\n     *   if (!result) {\n     *       // error...\n     *   }\n     * @returns {String} request\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"GeocodeRequestFactory\");\n        logger.trace([\"GeocodeRequestFactory::build()\"]);\n\n        var settings = options || {};\n\n        var myReq = new GeocodeRequestREST(settings);\n        if (!myReq.processRequestString()) {\n            throw new Error(\"Error process request (rest) !\");\n        }\n        var request = myReq.requestString;\n\n        logger.trace(request);\n\n        return request;\n    }\n};\n\nexport default GeocodeRequestFactory;\n","/* jshint multistr : true */\n\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport _ from \"../../../Utils/MessagesResources\";\nimport AltiElevationRequest from \"./model/AltiElevationRequest\";\nimport AltiProfilRequest from \"./model/AltiProfilRequest\";\n\n/**\n * @classdesc\n * Classe de gestion des requêtes de type REST sur le service altimetrique.\n *\n * @todo Le service Alti n'implemente pas le POST !?\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiRequestREST\n * @param {Object} options - options\n * @param {Object}   options.param.positions - tableau de coordonnées lon/lat\n * @param {String}   options.param.delimiter - '|'\n * @param {Boolean}  options.param.indent - false|true\n * @param {String}   options.param.crs - 'CRS:84'\n * @param {String}   options.param.sampling - 3\n * @param {String}   options.param.resource - 'rge_alti_corse2a_float32_zip_lamb93'\n * @param {Boolean}  options.param.zonly - false|true\n * @param {Boolean}  options.param.measures - false|true\n * @param {String}   options.param.format - \"JSON|XML\"\n * @param {String}   options.type - \"Profil|Elevation\"\n * @param {String}   options.method - GET|POST\n *\n * @example\n *      var options = {\n *           type : 'Profil', // Elevation\n *           method : 'GET',  // par defaut\n *           param : {\n *               positions : [\n *                   {lon:'1.11', lat:'1.11'},\n *                   {lon:'1.10', lat:'1.10'},\n *                   {lon:'1.12', lat:'1.12'}\n *               ],\n *               delimiter : \";\",         // par defaut\n *               indent    : true,        // par defaut\n *               crs       : 'EPSG:4326', // par defaut\n *               format    : 'json',      // par defaut (only to POST)\n *               sampling  : 3 ,          // par defaut (only use by Profil)\n *               zonly     : false        // par defaut (only use by Elevation)\n *               measures  : false        // par defaut (only use by Elevation)\n *           }\n *      };\n *\n *      var result;\n *      try {\n *          var obj = new AltiRequestREST (options);\n *          if (! obj.processRequestString ()) {\n *              throw new Error(\"Request empty !?\")\n *          }\n *          result = obj.requestString;\n *      } catch (e) {\n *          // exceptions...\n *      }\n * @private\n */\nfunction AltiRequestREST (options) {\n    this.logger = Logger.getLogger(\"AltiRequestREST\");\n    this.logger.trace(\"[Constructeur AltiRequestREST ()]\");\n\n    if (!(this instanceof AltiRequestREST)) {\n        throw new TypeError(\"AltiRequestREST constructor cannot be called as a function.\");\n    }\n\n    this.options = options || {};\n\n    // existance des options\n    if (!this.options) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    // type de requete : Altitude ou Profil\n    // (param. à determiner en fonction des parametres d'entrée)\n    if (!this.options.type) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"type (Elevation or Profil)\"));\n    }\n\n    // construction du modele de requête\n    // (test du type d'objet candidat)\n    this.DataObject = null;\n    switch (this.options.type) {\n        case \"Elevation\":\n            this.DataObject = new AltiElevationRequest(this.options.param);\n            break;\n        case \"Profil\":\n            this.DataObject = new AltiProfilRequest(this.options.param);\n            break;\n        default:\n            throw new Error(_.getMessage(\"PARAM_TYPE\", \"type (Elevation or Profil)\"));\n    }\n\n    /**\n     * methode.\n     * Par defaut, \"GET\".\n     */\n    this.method = this.options.method || \"GET\";\n}\n\nAltiRequestREST.prototype = {\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : AltiRequestREST,\n\n    /**\n     * Template de la requête.\n     */\n    template : {\n        get : {\n            // FIXME on retire le param 'delimiter' : &delimiter='__DELIMITER__'\n            value : \"lon=__LON__&lat=__LAT__&indent=__INDENT__&crs='__CRS__'&resource=__RESOURCE__&measures=__MEASURES__\",\n            input : {\n                point : \"&zonly=__ZONLY__\",\n                profil : \"&sampling=__SAMPLING__\"\n            }\n        },\n        post : {\n            // FIXME on retire le param 'delimiter' : delimiter='__DELIMITER__'\\n\\\n            value : \"lon=__LON__\\n\" +\n                \"lat=__LAT__\\n\" +\n                \"indent=__INDENT__\\n\" +\n                \"crs='__CRS__'\\n\" +\n                \"resource='__RESOURCE__'\\n\" +\n                \"measures='__MEASURES__'\\n\",\n            input : {\n                point : \"zonly=__ZONLY__\\n\",\n                profil : \"sampling=__SAMPLING__\"\n            }\n        }\n    },\n\n    /**\n     * Construction de la requête.\n     *\n     * @example\n     * // GET  out : lon=0.2367,2.1570&lat=48.0551,46.6077&delimiter=,&indent=true&zonly=true&crs='CRS:84'\n     * // POST out : Not yet supported method POST !\n     * @returns {String}\n     */\n    processRequestString : function () {\n        this.logger.trace(\"AltiRequestREST::processRequestString ()\");\n\n        var template = \"\";\n        if (this.method === \"POST\") {\n            template = this.template.post.value;\n        } else if (this.method === \"GET\") {\n            template = this.template.get.value;\n        }\n\n        template = template.replace(/__LON__/g, this.DataObject.getLon());\n        template = template.replace(/__LAT__/g, this.DataObject.getLat());\n        // FIXME on retire le param 'delimiter'\n        // template = template.replace(/__DELIMITER__/g, this.DataObject.delimiter);\n        template = template.replace(/__INDENT__/g, this.DataObject.indent);\n        template = template.replace(/__CRS__/g, this.DataObject.crs);\n        template = template.replace(/__RESOURCE__/g, this.DataObject.resource);\n        template = template.replace(/__MEASURES__/g, this.DataObject.measures);\n\n        // ajout +\n        template = template + this.__addDataInputs();\n        this.logger.trace(\"traduction tmpl\", template);\n\n        // sauvegarde\n        this.requestString = template;\n\n        return this.requestString;\n    },\n\n    /**\n     * Ajout de parametres spécifiques (ex. zonly)\n     *\n     * @returns {String}\n     */\n    __addDataInputs : function () {\n        this.logger.trace(\"AltiRequestREST::addDataInput ()\");\n\n        var myTemplate;\n        if (this.method === \"POST\") {\n            myTemplate = this.template.post;\n        } else if (this.method === \"GET\") {\n            myTemplate = this.template.get;\n        } else {\n            throw new Error(\"No other HTTP method supported by the service !\");\n        }\n\n        var tmpl = null;\n        if (this.DataObject.CLASSNAME === \"AltiElevationRequest\") {\n            tmpl = myTemplate.input.point;\n            return tmpl.replace(/__ZONLY__/g, this.DataObject.zonly.toString());\n        } else if (this.DataObject.CLASSNAME === \"AltiProfilRequest\") {\n            tmpl = myTemplate.input.profil;\n            return tmpl.replace(/__SAMPLING__/g, this.DataObject.sampling);\n        } else {\n            throw new Error(\"No other object supported than elevation or profil !?\");\n        }\n    }\n};\n\nexport default AltiRequestREST;\n","/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    var then$$1 = void 0;\n    try {\n      then$$1 = value.then;\n    } catch (error) {\n      reject(promise, error);\n      return;\n    }\n    handleMaybeThenable(promise, value, then$$1);\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = true;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n    } catch (e) {\n      succeeded = false;\n      error = e;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (succeeded === false) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = void 0;\n      var error = void 0;\n      var didError = false;\n      try {\n        _then = entry.then;\n      } catch (e) {\n        didError = true;\n        error = e;\n      }\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        if (didError) {\n          reject(promise, error);\n        } else {\n          handleMaybeThenable(promise, entry, _then);\n        }\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n//# sourceMappingURL=es6-promise.map\n","module.exports = ol.style.Fill;","\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport ProcessIsoCurveRequest from \"./Request/ProcessIsoCurveRequest\";\nimport ProcessIsoCurveResponseFactory from \"./Response/ProcessIsoCurveResponseFactory\";\n\n/**\n * @classdesc\n * Appel du service d'isochrone/distance du Géoportail :\n *     envoi de la requête construite selon les paramètres en options,\n *     éventuellement parsing et analyse  de la réponse,\n *     retour d'une réponse en paramètre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.ProcessIsoCurve\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {String} options.resource - La ressource utilisée pour le calcul : bdtopo-valhalla (par défaut) ou bdtopo-pgr.\n *\n * @param {String} options.outputFormat - Le format de la réponse du service iso : 'json' uniquement et par défaut.\n *\n * @param {Object} options.position - Point de départ du calcul.\n *      Coordonnées exprimées en longitudes, latitudes (EPSG:4326)\n *      @param {Float} options.position.x - Abcisse du point de départ du calcul d'isochrone/distance.\n *      @param {Float} options.position.y - Ordonnée du point de départ du calcul d'isochrone/distance.\n *\n * @param {String} options.srs - Projection.\n *      Système de coordonnées dans lequel les coordonnées du point « location » sont exprimées et\n *      dans lequel la géométrie de la courbe résultante sera exprimée.\n *      Par défaut, le système de coordonnées utilisé sera « EPSG:4326 ».\n *\n * @param {String} [options.graph = \"voiture\"] - Nom du graphe à utiliser pour le calcul (« Pieton » ou « Voiture »).\n *      La valeur par défaut est : «voiture»\n *\n * @param {Array.<String>} [options.exclusions] - DEPRECATED: Ce paramètre est conservé pour une rétrocompatibilité de l'api. Le nouveau paramètre à utiliser est options.constraints.\n *      Critères d'exclusions à appliquer pour le calcul.\n *      On précise ici le type de tronçons que l'on ne veut pas que l'isochrone/distance emprunte\n *      (valeurs possibles : « toll » (éviter les péages), « bridge », « tunnel »).\n *\n * @param {Object[]} [options.constraints] - Critères de contraintes à appliquer sur un itinéraire. Les valeurs disponibles dépendent de la ressource utilisée. Il est donc utile de regarder le getCapabilities.\n *      @param {String} [options.constraints.constraintType] - Type de la contrainte. Généralement \"banned\".\n *      @param {String} [options.constraints.key] - Clé de la contrainte. Généralement \"wayType\".\n *      @param {String} [options.constraints.operator] - Opérateur de la contrainte. Généralement \"=\".\n *      @param {String} [options.constraints.value] - Valeur de la contrainte. Généralement \"autoroute\".\n *\n * @param {String} [options.method = \"time\"] - Méthode utilisée pour le calcul de la courbe iso.\n *      Les valeurs possible sont \"time\" pour un calcul d'isochrone, \"distance\" pour un calcul d'isodistance.\n *      Pas de valeur spécifié équivaut à un calcul d'isochrone.\n *\n * @param {String} [options.distanceUnit = \"m\"] - Indique si la distance doit être exprimée en km ou m dans la réponse (\"m\" or \"km\").\n *\n * @param {String} [options.timeUnit = \"second\"] - Indique si la durée doit être exprimée en seconde, minute ou heure dans la réponse (\"standard\", \"second\", \"minute\", \"hour\"). Il peut-être formatté hh:mm::ss avec la valeur standard.\n *\n * @param {Float} options.time - Durée maximum (exprimée en secondes) à utiliser pour le calcul de la courbe à partir du ou jusqu'au point « location ».\n *      Ce paramètre doit être renseigné si l'option \"méthod\" a la valeur \"time\".\n *      Si l'option method n'est pas renseignée, ce paramètre doit être renseigné.\n *\n * @param {Float} options.distance - Distance maximum (exprimée en metres) à utiliser pour le calcul de la courbe à partir du ou j'usqu'au point « location ».\n *      Ce paramètre doit être renseigné si l'option \"méthod\" a la valeur \"DISTANCE\".\n *      Si l'option \"method\" n'est pas renseignée, ce paramètre sera ignoré.\n *\n * @param {Boolean} [options.reverse = false] - Indique si la géométrie résultante doit être lissée (« true ») pour ne pas avoir d'effet d'escalier.\n *      Par défaut, la valeur « false » est appliquée.\n *\n * @param {Boolean} [options.smoothing = false] - Indique si la géométrie résultante doit être lissée (« true ») pour ne pas avoir d'effet d'escalier.\n *      Par défaut, la valeur « false » est appliquée.\n *\n * @param {Boolean} [options.holes = false] - Indique si la géométrie résultante (surface) doit être retournée avec des trous (« true »).\n *      Par défaut, la valeur « false » est appliquée.\n *\n * @example\n *   var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      position : {\n *           x : 2.3242664298058053,\n *           y : 48.86118017324745\n *      },\n *      resource : bdtopo-valhalla,\n *      distance : 200,\n *      [time : ]\n *      method : \"distance\",\n *      graph : \"voiture\",\n *      reverse : false\n *  };\n */\n\nfunction ProcessIsoCurve (options) {\n    if (!(this instanceof ProcessIsoCurve)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"ProcessIsoCurve\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"ProcessIsoCurve\";\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, arguments);\n\n    this.logger = Logger.getLogger(\"Gp.Services.ProcessIsoCurve\");\n    this.logger.trace(\"[Constructeur ProcessIsoCurve (options)]\");\n\n    if (!options.position) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"position\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.position.x === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"position.x\"));\n    }\n\n    if (options.position.y === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"position.y\"));\n    }\n\n    if (!options.time && !options.distance) {\n        throw new Error(\"Parameter (s) 'distance' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance\");\n    }\n\n    // si on a que le paramètre \"distance\" en entrée, on calcule une isodistance.\n    // Le paramètre \"méthode\" doit pour avoir une réponse du service, être passé à \"distance\"\n    if (!options.time && options.distance) {\n        this.options.method = \"distance\";\n        // on supprime l'éventuel attribut time, résidu d'un appel antérieur\n        if (this.options.time) {\n            delete this.options.time;\n        }\n    }\n\n    // si on a que le paramètre \"time\" en entrée, on calcule une isochrone.\n    // Le paramètre \"méthode\" doit pour avoir une réponse du service, être passé à \"time\"\n    if (options.time && !options.distance) {\n        this.options.method = \"time\";\n        // on supprime l'éventuel attribut time, résidu d'un appel antérieur\n        if (this.options.distance) {\n            delete this.options.distance;\n        }\n    }\n\n    // au cas où on a ni l'un, ni l'autre...\n    this.options.method = this.options.method || \"time\";\n\n    // options par defaut du service\n    // TODO: modifier la ressource lors de la mise en production du service\n    this.options.resource = options.resource || \"bdtopo-valhalla\";\n    this.options.exclusions = options.exclusions || [];\n    this.options.reverse = options.reverse || false;\n    this.options.srs = options.srs || \"EPSG:4326\";\n    this.options.distanceUnit = options.distanceUnit || \"m\";\n    this.options.timeUnit = options.timeUnit || \"second\";\n\n    // options depreciees\n    if (options.smoothing) {\n        this.logger.warn(\"options.smoothing is DEPRECATED\");\n    }\n    this.options.smoothing = false;\n    if (options.holes) {\n        this.logger.warn(\"options.holes is DEPRECATED\");\n    }\n    this.options.holes = false;\n\n    // Gestion du graphe\n    if (options.graph) {\n        if (options.graph === \"Voiture\") {\n            this.options.graph = \"car\";\n        }\n        if (options.graph === \"Pieton\") {\n            this.options.graph = \"pedestrian\";\n        }\n    } else {\n        this.options.graph = \"car\";\n    }\n\n    // Gestions des contraintes\n    this.options.constraints = [];\n    if (options.constraints) {\n        if (Array.isArray(options.constraints)) {\n            for (var k = 0; k < options.constraints.length; k++) {\n                this.options.constraints.push(options.constraints[k]);\n            }\n        } else {\n            throw new Error(_.getMessage(\"PARAM_TYPE\", \"constraints\"));\n        }\n    }\n\n    // Gestion de l'ancien paramètre exclusions\n    var constraintTunnel = {};\n    var constraintPont = {};\n    var constraintAutoroute = {};\n    if (options.exclusions) {\n        if (options.exclusions.length !== 0) {\n            this.logger.warn(\"options.exclusions is DEPRECATED !!\");\n            for (var c = 0; c < options.exclusions.length; c++) {\n                if (typeof options.exclusions[c] === \"string\") {\n                    options.exclusions[c] = options.exclusions[c].toLowerCase();\n                } else {\n                    // on ne crée pas une erreur pour rétro-compatibilité avec les anciennes versions\n                    continue;\n                }\n                if (options.exclusions[c] === \"toll\") {\n                    constraintAutoroute.constraintType = \"banned\";\n                    constraintAutoroute.key = \"wayType\";\n                    constraintAutoroute.operator = \"=\";\n                    constraintAutoroute.value = \"autoroute\";\n                    this.options.constraints.push(constraintAutoroute);\n                }\n                if (options.exclusions[c] === \"tunnel\") {\n                    constraintTunnel.constraintType = \"banned\";\n                    constraintTunnel.key = \"wayType\";\n                    constraintTunnel.operator = \"=\";\n                    constraintTunnel.value = \"tunnel\";\n                    this.options.constraints.push(constraintTunnel);\n                }\n                if (options.exclusions[c] === \"bridge\") {\n                    constraintPont.constraintType = \"banned\";\n                    constraintPont.key = \"wayType\";\n                    constraintPont.operator = \"=\";\n                    constraintPont.value = \"pont\";\n                    this.options.constraints.push(constraintPont);\n                }\n            }\n        }\n    }\n\n    // on passe l'option outputFormat en minuscules afin d'éviter des exceptions.\n    this.options.outputFormat = (typeof options.outputFormat === \"string\") ? options.outputFormat.toLowerCase() : \"json\";\n    if (options.outputFormat && options.outputFormat !== \"json\") {\n        throw new Error(_.getMessage(\"PARAM_NOT_SUPPORT\", \"outputFormat\"));\n    }\n    this.options.outputFormat = \"json\";\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseignée, il faut utiliser les urls par defaut\n    if (!this.options.serverUrl) {\n        var urlFound = DefaultUrlService.ProcessIsoCurve.newUrl();\n        if (!urlFound) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = urlFound;\n        this.logger.trace(\"Serveur URL par defaut : \" + this.options.serverUrl);\n    }\n}\n\n/**\n * @lends module:ProcessIsoCurve#\n */\nProcessIsoCurve.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nProcessIsoCurve.prototype.constructor = ProcessIsoCurve;\n\n/**\n * Création de la requête (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nProcessIsoCurve.prototype.buildRequest = function (error, success) {\n    try {\n        var oIsoCurve = new ProcessIsoCurveRequest(this.options);\n        if (!oIsoCurve.processRequestString()) {\n            throw new Error(_.getMessage(\"SERVICE_REQUEST_BUILD\"));\n        }\n\n        this.request = oIsoCurve.requestString;\n    } catch (e) {\n        error.call(this, new ErrorService(e.message));\n        return;\n    }\n\n    success.call(this, this.request);\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} onError   - callback des erreurs\n * @param {Function} onSuccess - callback de succès de l'analyse de la réponse\n */\nProcessIsoCurve.prototype.analyzeResponse = function (onError, onSuccess) {\n    if (this.response) {\n        var options = {\n            response : this.response,\n            outputFormat : this.options.outputFormat,\n            rawResponse : this.options.rawResponse,\n            onSuccess : onSuccess,\n            onError : onError,\n            scope : this\n        };\n\n        ProcessIsoCurveResponseFactory.build(options);\n    } else {\n        onError.call(this, new ErrorService(_.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\nexport default ProcessIsoCurve;\n","module.exports = ol.style.Stroke;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.format.GPX;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.geom.MultiLineString;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.geom.LineString;","// import openlayers\nimport olGPX from \"ol/format/GPX\";\n// import Geometry\nimport MultiLineString from \"ol/geom/MultiLineString\";\nimport LineString from \"ol/geom/LineString\";\n// import local\nimport Styling from \"./Styling\";\nimport Parser from \"../Utils/Parser\";\n\n/**\n * @classdesc\n *\n * Extended Styles GPX format to export (internal use only !)\n *\n * SPEC\n * cf. https://www.topografix.com/gpx.asp\n *\n *\n * @constructor\n * @alias ol.format.GPXExtended\n * @extends {ol.format.GPX}\n * @type {ol.format.GPXExtended}\n * @param {Object} options - Options\n * @param {Object} [options.defaultStyle] - Styles by default\n * @param {String} [options.orderBy] - Sort by key the feature before writing. By default, no sorting\n * @param {Object} [options.extensions] - Add properties to file root\n * @param {function} [options.readExtensions] - Reading extensions (native)\n */\nvar GPX = class GPX extends olGPX {\n\n    /**\n     * See {@link ol.format.GPXExtended}\n     * @module GPXExtended\n     * @alias module:~formats/GPXExtended\n     * @param {*} options - options\n     * @example\n     * import GPXExtended from from \"gpf-ext-ol/formats/GPXExtended\"\n     * ou \n     * import { GPXExtended } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        super(options);\n\n        if (!(this instanceof GPX)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this.options = options || {};\n\n        // INFO\n        // surcharge de la callback : readExtensions\n        if (this.options.readExtensions && typeof this.options.readExtensions === \"function\") {\n            var clbk = this.options.readExtensions; // callback definie par l'utilisateur\n            this.options.readExtensions = function (feature, node) {\n                this.readExtensions(feature, node);\n                clbk.call(this, feature, node);\n            };\n        } else {\n            this.options.readExtensions = this.readExtensions;\n        }\n\n        // INFO\n        // defaultStyle est un objet de type Style\n        if (this.options.defaultStyle === null || typeof this.options.defaultStyle === \"undefined\") {\n            this.options.defaultStyle = {};\n        }\n\n        this.source = null;\n\n        return this;\n    }\n\n    /**\n     * Read Extend Styles for Features.\n     * This function overloads ol.format.GPX.readFeatures ...\n     *\n     * @see ol.format.GPX.prototype.readFeatures\n     * @param {Document|Node} source - Source.\n     * @param {olx.format.ReadOptions=} options - options.\n     * @return {Array.<ol.Feature>} Features.\n     */\n    readFeatures (source, options) {\n        // INFO\n        // le travail de lecture des extensions du format est porté\n        // par la callback des options : readExtensions\n        var features = super.readFeatures(source, options);\n\n        // String ou Dom\n        if (typeof source === \"string\") {\n            this.source = Parser.parse(source);\n        } else if (source !== null) {\n            this.source = source;\n        }\n\n        // INFO\n        // on applique les styles par defaut definis avec l'option defaultStyle\n        // sauf sur les features qui possèdent des extensions.\n        // les features avec extensions sont traité au préalable\n        // dans la callback des options : readExtensions\n        var self = this;\n        features.forEach(function (feature, index, array) {\n            feature.setId(index + 1);\n            // HACK : enregistrement de la description de la balise 'desc' du format GPX\n            var value = feature.getProperties().desc;\n            if (value) {\n                feature.setProperties({\n                    description : value\n                });\n            }\n            var featureStyleFunction = feature.getStyleFunction();\n            if (!featureStyleFunction) {\n                var styleFunction = Styling.defineStyleFunctionByDefault(self.options.defaultStyle);\n                if (styleFunction) {\n                    feature.setStyle(styleFunction);\n                }\n            }\n        });\n        return features;\n    }\n\n    /**\n     * Write Extend Styles for Features.\n     * This function overloads ol.format.GPX.writeFeatures ...\n     *\n     * @see ol.format.GPX.prototype.writeFeatures\n     * @param {Object[]} features - Features.\n     * @param {Object} options - Options.\n     *\n     * @return {String} Result or null.\n     */\n    writeFeatures (features, options) {\n        // INFO\n        // il n'est pas possible de surcharger les parsers d'OpenLayers (private),\n        // on decide de (re)parser la sortie d'OpenLayers afin d'y placer les balises\n        // d'extensions\n\n        // on met à jour les properties de styles\n        features.forEach(function (feature, index, array) {\n            // HACK : enregistrement de la description dans la balise 'desc' du format GPX\n            var value = feature.getProperties().description;\n            if (value) {\n                feature.setProperties({\n                    desc : value\n                });\n            }\n\n            Styling.definePropertiesFromStyle(feature);\n\n            // HACK : Le type surfacique n'existe pas au format GPX,\n            // on doit la transformer en un lineaire.\n            // Par contre, on garde un trace de la transformation :\n            // * le style surfacique\n            // * le type de geometrie initiale\n            var type = feature.getGeometry().getType();\n            if (type === \"Polygon\") {\n                // creation d'une copie pour ne pas modifier les features de carte\n                var fp = feature.clone();\n                fp.set(\"type\", type);\n                fp.setGeometry(new LineString(feature.getGeometry().getCoordinates()));\n                features.push(fp);\n                // feature à supprimer de l'export\n                array.splice(index, 1);\n            } else if (type === \"MultiPolygon\") {\n                // creation d'une copie pour ne pas modifier les features de carte\n                var fm = feature.clone();\n                fm.set(\"type\", type);\n                fm.setGeometry(new MultiLineString(feature.getGeometry().getCoordinates()));\n                features.push(fm);\n                // feature à supprimer de l'export\n                array.splice(index, 1);\n            }\n        });\n\n        // tri des features en fonction de la balise \"number\" || \"id\" || \"order\"\n        if (this.options.orderBy !== undefined) {\n            var key = this.options.orderBy;\n            if (key) {\n                var sortFct = function (a, b) {\n                    var cmpA = a.get(key) || 0;\n                    var cmpB = b.get(key) || 0;\n                    return cmpA.toString().localeCompare(cmpB.toString(), undefined, { numeric : true });\n                };\n                features.sort(sortFct);\n            }\n        }\n\n        // nodes\n        var gpxNode = super.writeFeaturesNode(features, options);\n        if (gpxNode === null) {\n            return null;\n        }\n\n        // on ajoute les extensions à la racine pour les metadonnées de calcul\n        if (this.options.hasOwnProperty(\"extensions\")) {\n            this.writeRootExtensions_(gpxNode, this.options.extensions);\n        }\n\n        // INFO\n        // à chaque fois qu'un style est trouvé dans un feature,\n        // on appelle la fonction d'insertion des balises extensions dans le DOM.\n        this.processExtensions_(gpxNode, features, {\n            extensions : this.writeExtensions_\n        });\n\n        // dom -> string\n        var gpxStringExtended = Parser.toString(gpxNode);\n        if (!gpxStringExtended) {\n            return null;\n        }\n\n        // format string\n        var gpxStringFormatted = Parser.format(gpxStringExtended);\n        if (gpxStringFormatted === \"\") {\n            return null;\n        }\n\n        return gpxStringFormatted;\n    }\n\n    /**\n     * Callback to read extensions from options : readExtensions\n     *\n     * @param {*} feature - ...\n     * @param {*} node - ...\n     */\n    readExtensions (feature, node) {\n        var _node = node;\n        // recherche de la properties de type Node ou Element\n        // si le node n'est pas renseigné...\n        if (!node) {\n            var props = feature.getProperties();\n            for (const key in props) {\n                if (Object.hasOwnProperty.call(props, key)) {\n                    const element = props[key];\n                    if (element instanceof Node) {\n                        _node = element;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (!_node) {\n            // eslint-disable-next-line no-console\n            console.warn(\"node not found !\");\n            return;\n        }\n\n        // ex. de nodes :\n        // <extensions>\n        //     <marker-size>medium</marker-size>\n        //     <marker-symbol></marker-symbol>\n        //     <marker-color>#ffffff</marker-color>\n        // </extensions>\n        for (var index = 0; index < _node.childNodes.length; index++) {\n            var element = _node.childNodes[index];\n            if (element.nodeType === 1) {\n                feature.set(element.nodeName, element.textContent);\n            }\n        }\n\n        // cas particulier du format GPX :\n        // il n'existe pas de surfacique sur ce format, mais il est possible de forcer\n        // la transformation en polygone pour des besoins particuliers de visualisation\n        Styling.APPLY_CONVERT_GEOM_GPX = true;\n        var style = Styling.defineStyleFromProperties(feature);\n        if (style) {\n            feature.setStyle(style);\n        }\n    }\n\n    /**\n     * ...\n     * @param {*} key ...\n     * @returns {Object} json\n     * @todo\n     */\n    readRootExtensions (key) {\n        var value = {};\n        // Rechercher :\n        // <metadata>\n        //   <extensions xmlns=\"http://www.w3.org/1999/xhtml\">\n        //     <data name=\"geoportail:compute\">{...}</data>\n        //   </extensions>\n        // </metadata>\n\n        var firstNodeLevelGpx = this.source.childNodes[0]; // gpx\n        var searchChildNodesMeta = firstNodeLevelGpx.childNodes; // search metadata\n        for (var k = 0; k < searchChildNodesMeta.length; k++) {\n            var nodeMeta = searchChildNodesMeta[k];\n            if (nodeMeta.nodeName === \"metadata\") {\n                var searchChildNodesExt = nodeMeta.childNodes; // search extensions\n                for (var i = 0; i < searchChildNodesExt.length; i++) {\n                    var nodeExt = searchChildNodesExt[i];\n                    if (nodeExt.nodeName === \"extensions\") {\n                        var searchChildNodesData = nodeExt.childNodes; // search data\n                        for (var j = 0; j < searchChildNodesData.length; j++) {\n                            var nodeData = searchChildNodesData[j];\n                            if (nodeData.nodeName === \"data\") {\n                                var name = nodeData.attributes[0];\n                                if (name && name.nodeName === \"name\") {\n                                    if (name.nodeValue === key) {\n                                        value = JSON.parse(nodeData.textContent);\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return value;\n    }\n\n    /**\n     * ...\n     *\n     * @param {*} doc - ...\n     * @param {*} extensions - ...\n     * @param {Boolean} [xml=false] - write tag xml or json\n     */\n    writeRootExtensions_ (doc, extensions, xml) {\n        // TODO namespace ?\n        var metadata = document.createElement(\"metadata\");\n        var extensionsRoot = document.createElement(\"extensions\");\n        // INFO\n        // convert JSON to XML (dom)\n        // * type string :\n        // { typestring: \"string\" } -> <typestring>string</typestring>\n        //\n        // * type object :\n        // { typeobject: { typestring1: \"string\", typestring2: \"string\" } }\n        // -> <typeobject>\n        //      <typestring1>string</typestring1>\n        //      <typestring2>string</typestring2>\n        //    </typeobject>\n        //\n        // * type array :\n        // { typearray : [\"item1\", \"item2\"] }\n        // -> <typearray type=\"array\" index=2>\n        //      <value>item1</value>\n        //      <value>item2</value>\n        //    </typearray>\n        //\n        // * type array of array\n        // -> <typearray type=\"array\" index=1>\n        //      <value type=\"array\" index=2>\n        //          <value>1</value>\n        //          <value>2</value>\n        //      </value>\n        //    </typearray>\n        //\n        // * type array of object\n        // -> <typearray type=\"array\" index=2>\n        //      <value>\n        //          <typestring1>string</typestring1>\n        //          <typestring2>string</typestring2>\n        //      </value>\n        //      <value>\n        //          <typestring1>string</typestring1>\n        //          <typestring2>string</typestring2>\n        //      </value>\n        //    </typearray>\n        function toDOM (node, json) {\n            for (const key in json) {\n                if (Object.hasOwnProperty.call(json, key)) {\n                    var element = json[key] || \"\"; // au cas où...\n                    var tag = document.createElement(key);\n                    // eslint-disable-next-line valid-typeof\n                    if (typeof element === \"string\" || typeof element === \"number\") {\n                        tag.innerHTML = element;\n                        node.appendChild(tag);\n                    } else if (element instanceof Array) {\n                        tag.setAttribute(\"type\", \"array\");\n                        tag.setAttribute(\"index\", element.length);\n                        for (let index = 0; index < element.length; index++) {\n                            var item = element[index] || \"\"; // au cas où...\n                            var n = document.createElement(\"value\");\n                            if (typeof item === \"string\" || typeof item === \"number\") {\n                                n.innerHTML = item;\n                                tag.appendChild(n);\n                            } else if (item instanceof Array) {\n                                n.setAttribute(\"type\", \"array\");\n                                n.setAttribute(\"index\", item.length);\n                                for (let i = 0; i < item.length; i++) {\n                                    var value = item[i] || \"\"; // au cas où...\n                                    var k = document.createElement(\"value\");\n                                    if (typeof value === \"string\" || typeof value === \"number\") {\n                                        k.innerHTML = value;\n                                        n.appendChild(k);\n                                    }\n                                }\n                                tag.appendChild(n);\n                            } else if (item instanceof Object) {\n                                tag.appendChild(toDOM(n, item));\n                            } else {\n                                // \"Unknown element !\"\n                            }\n                        }\n                        node.appendChild(tag);\n                    } else if (element instanceof Object) {\n                        node.appendChild(toDOM(tag, element));\n                    } else {\n                        // \"Unknown element !\"\n                    }\n                }\n            }\n            return node;\n        }\n\n        if (xml) {\n            // structure xml\n            toDOM(extensionsRoot, extensions);\n        } else {\n            // structure json par defaut\n            // ex.\n            // <metadata>\n            //   <extensions xmlns=\"http://www.w3.org/1999/xhtml\">\n            //     <data name=\"geoportail:compute\">{...}</data>\n            //   </extensions>\n            // </metadata>\n            for (const key in extensions) {\n                if (Object.hasOwnProperty.call(extensions, key)) {\n                    const value = extensions[key];\n                    var dataElement = document.createElement(\"data\");\n                    dataElement.setAttribute(\"name\", key);\n                    var data = document.createTextNode(JSON.stringify(value));\n                    dataElement.appendChild(data);\n                    extensionsRoot.appendChild(dataElement);\n                }\n            }\n        }\n        metadata.appendChild(extensionsRoot);\n        // insertion en 1ere place !\n        var firstChild = doc.firstChild;\n        doc.insertBefore(metadata, firstChild);\n    }\n\n    /**\n     * ...\n     *\n     * @param {Object} feature - ...\n     * @param {DOMElement} node - ...\n     * @private\n     */\n    writeExtensions_ (feature, node) {\n        // creation du DOM\n        var extensionsNode = document.createElementNS(node.parentNode.namespaceURI, \"extensions\");\n        Styling.getListTags().forEach(key => {\n            if (feature.get(key)) {\n                var extension = document.createElementNS(node.parentNode.namespaceURI, key);\n                extension.innerHTML = feature.get(key);\n                extensionsNode.appendChild(extension);\n            }\n        });\n        node.appendChild(extensionsNode);\n    }\n\n    /**\n     * ...\n     *\n     * @param {DOMElement} doc - ...\n     * @param {Object} features - ...\n     * @param {Object} actions - ...\n     * @private\n     */\n    processExtensions_ (doc, features, actions) {\n        // INFO\n        // OpenLayers ne gère pas tous les tags du format GPX : ex. metadata\n        // Liste des tags :\n        // * wpt\n        // * rte\n        // * trk\n        // On peut y placer nos balises extensions.\n\n        var index = -1;\n        var nodes = doc.childNodes;\n        for (var i = 0; i < nodes.length; i++) {\n            var node = nodes[i];\n            switch (node.nodeName) {\n                case \"wpt\":\n                case \"rte\":\n                case \"trk\":\n                    index++;\n                    var feature = features[index];\n                    var style = feature.getStyle();\n                    if (style) {\n                        var fct = actions.extensions;\n                        if (fct && typeof fct === \"function\") {\n                            fct(feature, node);\n                        }\n                    }\n                    break;\n                case \"metadata\":\n                    break;\n                default:\n                    // on ne devrait jamais passer à ce niveau !?\n                    // eslint-disable-next-line no-console\n                    console.warn(\"nodename unknown :\", node.nodeName);\n                    break;\n            }\n        }\n    }\n\n};\n\nexport default GPX;\n\n// Expose GPX as ol.source.GPXExtended. (for a build bundle)\nif (window.ol && window.ol.format) {\n    window.ol.format.GPXExtended = GPX;\n}\n","module.exports = ol.format.GeoJSON;","\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport _ from \"../../Utils/MessagesResources\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\nimport CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport RouteRequestFactory from \"./Request/RouteRequestFactory\";\nimport RouteResponseFactory from \"./Response/RouteResponseFactory\";\n\n/**\n * @classdesc\n * Appel du service d'itinéraire du Géoportail :\n *     envoi de la requête construite selon les paramètres en options,\n *     éventuellement parsing et analyse  de la réponse,\n *     retour d'une réponse en paramètre de la fonction onSuccess.\n *\n * @alias Gp.Services.Route\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {String} options.resource - La ressource utilisée pour le calcul. Ce paramètre devrait être obligatoire car il l'est dans l'appel au service. Mais il ne l'est pas pour des raisons de rétrocompatibilité.\n *\n * @param {String} options.outputFormat - Le format de la réponse du service itineraire : 'json' uniquement et par défaut.\n *\n * @param {String} [options.routePreference = \"fastest\"] - Mode de calcul à utiliser :\n * - le plus rapide « fastest »\n * - le plus court « shortest »\n * Par défaut : « fastest ».\n *\n * @param {Object} options.startPoint - Point de départ du calcul. Coordonnées exprimées en longitudes, latitudes (EPSG:4326)\n * @param {Float} options.startPoint.x - Abcisse du point de départ du calcul d'itinéraire.\n * @param {Float} options.startPoint.y - Ordonnée du point de départ du calcul d'itinéraire.\n *\n * @param {Object} options.endPoint - Point d'arrivée du calcul. Coordonnées exprimées en longitudes, latitudes (EPSG:4326)\n * @param {Float} options.endPoint.x - Abcisse du point d'arrivée du calcul d'itinéraire.\n * @param {Float} options.endPoint.y - Ordonnée du point d'arrivée du calcul d'itinéraire.\n *\n * @param {Object[]} [options.viaPoints] - Liste de point ({x:Float,y:Float}) intermédaires que l'itinéraire doit emprunter dans l'ordre du tableau.\n *      Coordonnées exprimées en longitudes, latitudes (EPSG:4326) :{x:float, y:float}\n *\n * @param {String} [options.graph = \"voiture\"] - Type de graphe utilisé : \"Voiture\" ou \"Pieton\".\n *      Détermine le profil de vitesses utilisé pour le calcul ainsi que les tronçons autorisés ou non.\n *      Par défaut, c'est la valeur \"Voiture\" qui sera utilisée.\n *\n * @param {String[]} [options.exclusions] - DEPRECATED: Critères d'exclusions à appliquer pour le calcul. (correspond au paramètre \"avoidFeature\" d'OpenLS)\n *      On précise ici le type de tronçons que l'on ne veut pas que l'itinéraire emprunte\n *      (valeurs possibles : « toll » (éviter les péages), « bridge », « tunnel »).\n *      Ce paramètre est conservé pour une rétrocompatibilité de l'api. Le nouveau paramètre à utiliser est options.constraints\n *\n * @param {Object[]} [options.constraints] - Critères de contraintes à appliquer sur un itinéraire. Les valeurs disponibles dépendent de la ressource utilisée. Il est donc utile de regarder le getCapabilities.\n * @param {String} [options.constraints.constraintType] - Type de la contrainte. Généralement \"banned\".\n * @param {String} [options.constraints.key] - Clé de la contrainte. Généralement \"wayType\".\n * @param {String} [options.constraints.operator] - Opérateur de la contrainte. Généralement \"=\".\n * @param {String} [options.constraints.value] - Valeur de la contrainte. Généralement \"autoroute\".\n *\n * @param {Boolean} [options.geometryInInstructions = false] - Indique si la géométrie de l'itinéraire doit être reprise morceau par morceau dans les instructions.\n *      (correspond au paramètre \"provideGeometry\" d'OpenLS) Par défaut : false.\n *\n * @param {Boolean} [options.provideBbox = true] - Indique si les instructions doivent être localisées par une bbox dans la réponse.\n *      Par défaut : true.\n *\n * @param {String} [options.distanceUnit = \"m\"] - Indique si la distance doit être exprimée en km ou m dans la réponse.\n *      Par défaut : m.\n * @param {String} [options.timeUnit = \"second\"] - Indique si la durée doit être exprimée en seconde, minute ou heure dans la réponse. Il peut-être formatté hh:mm::ss avec la valeur standard.\n *      Les valeurs possibles sont \"standard\", \"second\", \"minute\" ou \"hour\".\n *      Par défaut : \"standard\".\n *\n * @param {String} [options.srs] - Système de coordonnées dans lequel les paramètres géographiques en entrée et la réponse du service sont exprimés.\n *      Pas de valeur par défaut. Si le serveur consulté est celui du Géoportail, la valeur par défaut sera donc celle du service : 'EPSG:4326'.\n *\n * @param {String[]} [options.waysAttributes] - Nom des attributs des voies. Les valeurs disponibles dépendent de la ressource utilisée. Il est donc utile de regarder le getCapabilities.\n *\n * @example\n *  var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'XHR',\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      resource : 'bdtopo'\n *      outputFormat : 'json',\n *      startPoint : {\n *          x : 42.1121,\n *          y : 1.5557\n *      },\n *      endPoint : {\n *          x : 42.1121,\n *          y : 1.5557\n *      },\n *      provideBbox : true,\n *      exclusions : [\"Bridge\", \"Tunnel\", \"Toll\"],\n *      distanceUnit : \"km\",\n *      graph : \"Voiture\",\n *      geometryInInstructions : true,\n *      routePreference : \"fastest\"\n *  };\n *\n */\nfunction Route (options) {\n    if (!(this instanceof Route)) {\n        throw new TypeError(_.getMessage(\"CLASS_CONSTRUCTOR\", \"Route\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"Route\";\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, arguments);\n\n    this.logger = Logger.getLogger(\"Gp.Services.Route\");\n    this.logger.trace(\"[Constructeur Route (options)]\");\n\n    if (!options.startPoint) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"startPoint\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.startPoint.x === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"startPoint.x\"));\n    }\n\n    if (options.startPoint.y === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"startPoint.y\"));\n    }\n\n    if (!options.endPoint) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"endPoint\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.endPoint.x === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"endPoint.x\"));\n    }\n\n    if (options.endPoint.y === null) {\n        throw new Error(_.getMessage(\"PARAM_MISSING\", \"endPoint.y\"));\n    }\n\n    // options par defaut\n\n    // on passe l'option outputFormat en minuscules afin d'éviter des exceptions.\n    if (options.outputFormat && options.outputFormat !== \"json\") {\n        this.logger.warn(\"options.outputFormat could only be json\");\n    }\n    this.options.outputFormat = \"json\";\n\n    this.options.resource = options.resource || \"bdtopo-osrm\";\n    this.options.startPoint = options.startPoint;\n    this.options.endPoint = options.endPoint;\n    this.options.viaPoints = options.viaPoints || [];\n    this.options.routePreference = options.routePreference || \"fastest\";\n    /** Gestion des anciennes valeurs de graph */\n    if (options.graph) {\n        if (options.graph === \"Voiture\") {\n            this.options.graph = \"car\";\n        }\n        if (options.graph === \"Pieton\") {\n            this.options.graph = \"pedestrian\";\n        }\n    } else {\n        this.options.graph = \"car\";\n    }\n    this.options.constraints = [];\n    if (options.constraints) {\n        if (Array.isArray(options.constraints)) {\n            for (var k = 0; k < options.constraints.length; k++) {\n                this.options.constraints.push(options.constraints[k]);\n            }\n        } else {\n            throw new Error(_.getMessage(\"PARAM_TYPE\", \"constraints\"));\n        }\n    }\n\n    /** Gestion de l'ancien paramètre exclusion */\n    var constraintTunnel = {};\n    var constraintPont = {};\n    var constraintAutoroute = {};\n    if (options.exclusions) {\n        if (options.exclusions.length !== 0) {\n            this.logger.warn(\"options.exclusions is DEPRECATED !!\");\n            for (var c = 0; c < options.exclusions.length; c++) {\n                if (typeof options.exclusions[c] === \"string\") {\n                    options.exclusions[c] = options.exclusions[c].toLowerCase();\n                } else {\n                    // on ne crée pas une erreur pour rétro-compatibilité avec les anciennes versions\n                    continue;\n                }\n                if (options.exclusions[c] === \"toll\") {\n                    constraintAutoroute.constraintType = \"banned\";\n                    constraintAutoroute.key = \"wayType\";\n                    constraintAutoroute.operator = \"=\";\n                    constraintAutoroute.value = \"autoroute\";\n                    this.options.constraints.push(constraintAutoroute);\n                }\n                if (options.exclusions[c] === \"tunnel\") {\n                    constraintTunnel.constraintType = \"banned\";\n                    constraintTunnel.key = \"wayType\";\n                    constraintTunnel.operator = \"=\";\n                    constraintTunnel.value = \"tunnel\";\n                    this.options.constraints.push(constraintTunnel);\n                }\n                if (options.exclusions[c] === \"bridge\") {\n                    constraintPont.constraintType = \"banned\";\n                    constraintPont.key = \"wayType\";\n                    constraintPont.operator = \"=\";\n                    constraintPont.value = \"pont\";\n                    this.options.constraints.push(constraintPont);\n                }\n            }\n        }\n    }\n\n    this.options.geometryInInstructions = options.geometryInInstructions || false;\n    this.options.provideBbox = options.provideBbox || true;\n    this.options.distanceUnit = options.distanceUnit || \"m\";\n    this.options.timeUnit = options.timeUnit || \"second\";\n    this.options.expectedStartTime = null; // FIXME not yet implemented !\n    this.options.srs = options.srs || \"EPSG:4326\";\n    this.options.waysAttributes = options.waysAttributes || [];\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseignée, il faut utiliser les urls par defaut\n    if (!this.options.serverUrl) {\n        var UrlByDefault = DefaultUrlService.Route.newUrl();\n\n        if (!UrlByDefault) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = UrlByDefault;\n        this.logger.trace(\"Serveur URL par defaut : \" + this.options.serverUrl);\n    }\n}\n\n/**\n * @lends module:Route#\n */\nRoute.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nRoute.prototype.constructor = Route;\n\n/**\n * (overwrite)\n * Création de la requête\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nRoute.prototype.buildRequest = function (error, success) {\n    var options = {\n        // spécifique au service\n        resource : this.options.resource,\n        startPoint : this.options.startPoint,\n        endPoint : this.options.endPoint,\n        viaPoints : this.options.viaPoints,\n        provideBbox : this.options.provideBbox,\n        constraints : this.options.constraints,\n        distanceUnit : this.options.distanceUnit,\n        timeUnit : this.options.timeUnit,\n        graph : this.options.graph,\n        geometryInInstructions : this.options.geometryInInstructions,\n        routePreference : this.options.routePreference,\n        srs : this.options.srs,\n        waysAttributes : this.options.waysAttributes\n    };\n\n    this.request = RouteRequestFactory.build(options);\n\n    // on teste si la requete a bien été construite !\n    if (!this.request) {\n        error.call(this, new ErrorService(_.getMessage(\"SERVICE_REQUEST_BUILD\")));\n    } else {\n        success.call(this, this.request);\n    }\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nRoute.prototype.analyzeResponse = function (error, success) {\n    // INFO\n    // Factory pour masquer la complexité du retour du service\n\n    if (this.response) {\n        var options = {\n            distanceUnit : this.options.distanceUnit,\n            timeUnit : this.options.timeUnit,\n            response : this.response,\n            outputFormat : this.options.outputFormat, // utile pour parser la string en mode XHR : JSON ou XML !\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this,\n            geometryInInstructions : this.options.geometryInInstructions\n        };\n\n        RouteResponseFactory.build(options);\n    } else {\n        error.call(this, new ErrorService(_.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\nexport default Route;\n","module.exports = ol.control.Control;","\n/**\n * Single Route Instruction object.\n *\n * @property {String} code - Instruction code :\n *\n * - \"F\" : Straight forward\n * - \"B\" : U-turn\n * - \"L\" : turn left\n * - \"R\" : turn right\n * - \"BL\" : turn left strongly\n * - \"BR\" : turn right strongly\n * - \"FL\" : turn lightly to the left\n * - \"FR\" : turn lightly to the right\n * - \"round_about_entry\" : round about entry\n * - \"round_about_exit\" : round about exit\n *\n * @property {String} instruction - Instruction text : translated code + street name\n * @property {Object} geometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the street.\n * @property {Float} distance - Length of the instruction. Expressed in km or m, depending on distanceUnit parameter.\n * @property {Float} duration - Instruction duration in seconds.\n *\n * @namespace\n * @alias Gp.Services.Route.RouteInstruction\n */\nfunction RouteInstruction () {\n    if (!(this instanceof RouteInstruction)) {\n        throw new TypeError(\"RouteInstruction constructor cannot be called as a function.\");\n    }\n\n    this.duration = null;\n\n    this.distance = null;\n\n    this.code = null;\n\n    this.instruction = null;\n\n    this.geometry = null; // FIXME can be null if option 'geometryInInstructions' is false !\n}\n\nRouteInstruction.prototype = {\n\n    constructor : RouteInstruction\n\n};\n\nexport default RouteInstruction;\n","// cette classe contient les URLs par defaut des services.\n//  DefaultUrlService.Alti.url(key)[elevation-json]\n//  DefaultUrlService.Alti.url(key)[elevation-xml]\n//  DefaultUrlService.Alti.url(key)[profil-json]\n//  DefaultUrlService.Alti.url(key)[profil-xml]\n//  DefaultUrlService.ProcessIsoCurve.url(key)\n//  DefaultUrlService.AutoComplete.url(key)\n//  DefaultUrlService.ReverseGeocode.url(key)\n//  DefaultUrlService.Geocode.url(key)\n//  DefaultUrlService.Route.url(key)\n\n// Example :\n//\n// DefaultUrlService.Alti.url('alti')[elevation-json]\n//  output {String} -> http://wxs.ign.fr/calcul/alti/rest/elevation.json\n//\n// DefaultUrlService.Alti.url('calcul')\n// output {Object|String}\n// -> http://wxs.ign.fr/calcul/alti/rest/elevation.json\n// -> http://wxs.ign.fr/calcul/alti/rest/elevation.xml\n// -> http://wxs.ign.fr/calcul/alti/rest/elevationLine.json\n// -> http://wxs.ign.fr/calcul/alti/rest/elevationLine.xml\n//\n// ssl by default.\n//\n// Force to not do ssl :\n// DefaultUrlService.ssl = false;\n//\n// DefaultUrlService.AutoComplete.url('calcul')\n// output {Object|String}\n// -> https://wxs.ign.fr/calcul/ols/apis/completion\n\n/**\n * Default Geoportal web services URLs access.\n *\n * @namespace\n * @alias Gp.Services.DefaultUrl\n */\nvar DefaultUrlService = {\n\n    /** if set true, require the use of https protocol */\n    ssl : true,\n\n    /**\n    * base new-url of geoplateforme services (ssl protocol management)\n    * @param {String} path - path\n    * @returns {String} url\n    */\n    newUrl : function (path) {\n        var NEW_GPF_HOSTNAME = \"data.geopf.fr\";\n\n        // comportement par défaut => https\n        // sinon, il est fixé par l'option 'ssl' (false => http)\n        var _protocol;\n        if (DefaultUrlService.ssl === false) {\n            _protocol = \"http://\";\n        } else {\n            _protocol = \"https://\";\n        }\n\n        return _protocol + NEW_GPF_HOSTNAME + path;\n    },\n\n    /**\n     * Elevation web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns elevation service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols (\"elevation-json\", \"elevation-xml\", \"profil-json\" or \"profil-xml\").\n     */\n    Alti : {\n        new_key : {\n            // rest\n            \"elevation-json\" : \"/altimetrie/1.0/calcul/alti/rest/elevation.json\",\n            \"elevation-xml\" : \"/altimetrie/1.0/calcul/alti/rest/elevation.xml\",\n            \"profil-json\" : \"/altimetrie/1.0/calcul/alti/rest/elevationLine.json\",\n            \"profil-xml\" : \"/altimetrie/1.0/calcul/alti/rest/elevationLine.xml\"\n        },\n\n        /**\n        * newurl from geoplateforme service\n        * @param {String} key - key\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return {\n                // rest\n                \"elevation-json\" : DefaultUrlService.newUrl(this.new_key[\"elevation-json\"]),\n                \"elevation-xml\" : DefaultUrlService.newUrl(this.new_key[\"elevation-xml\"]),\n                \"profil-json\" : DefaultUrlService.newUrl(this.new_key[\"profil-json\"]),\n                \"profil-xml\" : DefaultUrlService.newUrl(this.new_key[\"profil-xml\"])\n            };\n        }\n    },\n    /**\n     * IsoCurve web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns isocurve service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols (\"iso-json\" or \"iso-xml\").\n     */\n    ProcessIsoCurve : {\n\n        new_key : \"/navigation/isochrone\",\n\n        /**\n        * url from geoplateforme service\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return DefaultUrlService.newUrl(this.new_key);\n        }\n    },\n    /**\n     * Config web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns config service default urls with or without geoportal access key given as a parameter.\n     */\n    Config : {\n        _key : \"https://raw.githubusercontent.com/IGNF/geoportal-configuration/new-url/dist/\",\n        /**\n        * url\n        * @param {String} key - key\n        * @returns {String} url\n        */\n        url : function (key) {\n            // key must be an array of one or several keys\n            if (!Array.isArray(key)) {\n                key = key.split(\",\");\n            }\n            // not homogeneous with others geoportal services URLs\n            var url = [];\n            for (var i = 0; i < key.length; i++) {\n                url[i] = this._key + key[i] + \"Config.json\";\n            }\n            return url;\n        }\n    },\n    /**\n     * Autocompletion web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns autocomplete service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    AutoComplete : {\n        new_key : \"/geocodage/completion\",\n\n        /**\n        * url from geoplateforme service\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return DefaultUrlService.newUrl(this.new_key);\n        }\n    },\n    /**\n     * Reverse geocoding web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns reverse geocoding service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    ReverseGeocode : {\n        new_key : \"/geocodage/reverse\",\n\n        /**\n        * url from geoplateforme service\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return DefaultUrlService.newUrl(this.new_key);\n        }\n    },\n    /**\n     * Geocoding web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns geocoding service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    Geocode : {\n        new_key : \"/geocodage/search\",\n\n        /**\n        * url from geoplateforme service\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return DefaultUrlService.newUrl(this.new_key);\n        }\n    },\n    /**\n     * Routing web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns routing service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols.\n     */\n    Route : {\n        new_key : \"/navigation/itineraire\",\n\n        /**\n        * url from geoplateforme service\n        * @returns {String} url\n        */\n        newUrl : function () {\n            return DefaultUrlService.newUrl(this.new_key);\n        }\n    }\n};\n\nexport default DefaultUrlService;\n","/**\n * Errors raised by API for one among three reasons : wrong API usage, underlying service error or unknown reason.\n *\n * @property {String} message - Error message\n * @property {Number} status - Error status : when {@link Gp.Error.TYPE_SRVERR}, gives the [HTTP status of the underlying web service response]{@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes} ; -1 otherwise.\n * @property {String} type - Error type ({@link Gp.Error.TYPE_SRVERR}, {@link Gp.Error.TYPE_USEERR} or {@link Gp.Error.TYPE_UNKERR}).\n *\n * @namespace\n * @alias Gp.Error\n * @param {Object|String} error - Options for creating error object. Can be a String (message) or an Object.\n * @param {String} error.message - Error message to return to user.\n * @param {enum} [error.type=TYPE_UNKERR] - Error type\n * @param {status} [error.status=-1] - Error status : when {@link Gp.Error.TYPE_SRVERR}, gives the [HTTP status of the underlying web service response]{@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes}.\n *\n */\nfunction ErrorService (error) {\n    if (!(this instanceof ErrorService)) {\n        throw new TypeError(\"ErrorService constructor cannot be called as a function.\");\n    }\n\n    var e = error;\n    if (typeof error === \"string\" || error instanceof String) {\n        this.message = error;\n        this.status = -1;\n        this.type = ErrorService.TYPE_UNKERR;\n    } else {\n        this.message = e.message || \"undefined!?\";\n        this.type = e.type;\n        this.status = e.status || -1;\n    }\n\n    this.name = \"ErrorService\";\n    this.stack = (new Error()).stack;\n}\n\n/**\n * Error raised when underlying geoportal service answers on error.\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_SRVERR = \"SERVICE_ERROR\";\n/**\n * Error raised when funcion use is inappropriate\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_USEERR = \"USAGE_ERROR\";\n/**\n * Error raised when API can't perform the job for a reason other than the two other ones.\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_UNKERR = \"UNKNOWN_ERROR\";\n\n/**\n * @lends module:ErrorService\n */\nErrorService.prototype = Object.create(Error.prototype, {\n    constructor : {\n        value : ErrorService,\n        writable : true,\n        configurable : true\n    }\n});\n\nexport default ErrorService;\n","import Logger from \"../../../Utils/LoggerByDefault\";\nimport MRes from \"../../../Utils/MessagesResources\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport ProcessIsoCurveResponse from \"./model/ProcessIsoCurveResponse\";\n\n/**\n * Factory pour générer une reponse JSON à partir d'un JSON\n * (Factory)\n *\n * @module ProcessIsoCurveResponseFactory\n * @alias Gp.Services.ProcessIsoCurve.Response.ProcessIsoCurveResponseFactory\n * @private\n */\nvar ProcessIsoCurveResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant ProcessIsoCurve\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"ProcessIsoCurveResponseFactory\");\n        logger.trace([\"ProcessIsoCurveResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                logger.trace(\"analyze response : json\");\n\n                var JSONResponse;\n                if (typeof options.response === \"string\") {\n                    JSONResponse = JSON.parse(options.response);\n                } else {\n                    JSONResponse = options.response;\n                }\n\n                // analyse de la reponse\n                // création de l'objet de réponse\n                data = new ProcessIsoCurveResponse();\n\n                // remplissage de l'objet créé avec les attribtuts de la réponse du service\n                if (JSONResponse) {\n                    if (JSONResponse.costType === \"distance\") {\n                        data.time = \"\";\n                        data.distance = JSONResponse.costValue;\n                    } else {\n                        data.time = JSONResponse.costValue;\n                        data.distance = \"\";\n                    }\n\n                    data.message = \"\";\n                    data.id = \"\";\n                    data.srs = JSONResponse.crs;\n                    data.geometry = JSONResponse.geometry;\n                    var coords = JSONResponse.point.split(\",\");\n                    if (data.location) {\n                        data.location.x = coords[0];\n                        data.location.y = coords[1];\n                    }\n                } else {\n                    options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_ANALYSE\", options.response)));\n                    return;\n                }\n\n                // info : en cas de problèmes de droits (clé invalide ou autre), la réponse est au format XML !!\n                // ex. <ExceptionReport><Exception exceptionCode=\"MissingParameter\">Key does not exist or has expired</Exception></ExceptionReport>\n                // mais le statut est 403, l'erreur est donc remontée plus tôt.\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : ErrorService.TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n        } else {\n            // si la réponse est vide, on appelle le callback d'erreur\n            options.onError.call(options.scope, new ErrorService(MRes.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        // si tout s'est bien passé, on appelle le callback de succès\n        options.onSuccess.call(options.scope, data);\n    }\n};\n\nexport default ProcessIsoCurveResponseFactory;\n","var ExportDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this.uid) ? id + \"-\" + this.uid : id;\n        return uid;\n    }\n};\n\nexport default ExportDOM;\n","// import CSS\nimport \"../../CSS/Controls/Export/GPFexport.css\";\n// import \"../../CSS/Controls/Export/GPFexportStyle.css\";\n\n// import OpenLayers\nimport Widget from \"../Widget\";\nimport Control from \"ol/control/Control\";\n\n// import local\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Utils from \"../../Utils/Helper\";\n\n// import local with ol dependencies\nimport KMLExtended from \"../../Formats/KML\";\nimport GeoJSONExtended from \"../../Formats/GeoJSON\";\nimport GPXExtended from \"../../Formats/GPX\";\n\n// DOM\nimport ExportDOM from \"./ExportDOM\";\n\nvar logger = Logger.getLogger(\"export\");\n\n/**\n * @classdesc\n *\n * button that will plug into a widget and export the contents of the calculation\n *\n * @constructor\n * @alias ol.control.Export\n * @param {Object} options - options for function call.\n * @param {Number} [options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {String} [options.download = \"true\"] - triggering the download of the file\n * @param {String} [options.format = \"geojson\"] - geojson / kml / gpx\n * @param {String} [options.name = \"export\"] - export name file\n * @param {String} [options.description = \"export\"] - export description put into file\n * @param {String} [options.title = \"Exporter\"] - button name\n * @param {String} [options.kind = \"secondary\"] - button type : primary | secondary | tertiary\n * @param {Boolean} [options.menu = false] - displays the menu\n * @param {Object} [options.menuOptions] - options of the menu.\n * @param {Boolean} [options.menuOptions.outside = false] - displays all element outside of menu\n * @param {Boolean} [options.menuOptions.above = false] - displays menu above or not of the button\n * @param {Boolean} [options.menuOptions.labelName = true] - displays the label name\n * @param {Boolean} [options.menuOptions.labelDesc = true] - displays the label description\n * @param {Boolean} [options.menuOptions.selectFormat = true] - displays the select format\n * @param {String} [options.direction = \"row\"] - buttons and menus layout\n * @param {Object} [options.icons] - icons\n * @param {String} [options.icons.menu = \"\\u2630 \"] - displays the menu icon, or otherwise left blank if you don't want it\n * @param {String} [options.icons.button = \"export\"] - displays the button icon : save or export icon, or otherwise left blank if you don't want it\n * @param {Function} [options.callback] - with a callback, the implementation is your responsibility\n * @param {DOMElement} [options.target] - target where the button will plug in. By default, the target is 'container-buttons-plugin' into the wikdget\n * @param {Object} [options.control] - instance of control\n * @param {Object} [options.layer] - the layer instance is retrieved from the control, but you can defined it\n * @fires button:clicked \n * @example\n * // pluggued widget Export into control Isocurve\n * var iso = new ol.control.Isocurve();\n * map.addControl(iso);\n *\n * // method : call render()\n * var export = new ButtonExport();\n * export.setDownload(true);\n * export.setControl(iso);\n * export.setTarget(<!-- DOMElement -->);\n * export.setName(\"export\");\n * export.setFormat(\"geojson\");\n * export.setDescription(\"Export Isochrone\");\n * export.setTitle(\"Exporter\");\n * export.setMenu(true);\n * export.setMenuOptions({\n *   outside : false,\n *   labelName : true,\n *   labelDesc : true,\n *   selectFormat : true\n * });\n * export.render(); // <-- direct call to render function !\n * export.on(\"button:clicked\", (data) => { console.log(data); });\n *\n * // method : call map.addControl()\n * var export = new ButtonExport();\n * export.setDownload(true);\n * export.setControl(iso);\n * export.setTarget(<!-- DOMElement -->);\n * export.setName(\"export\");\n * export.setFormat(\"geojson\");\n * export.setDescription(\"Export Isochrone\");\n * export.setTitle(\"Exporter\");\n * export.setKind(\"secondary\");\n * export.setMenu(false);\n * export.on(\"button:clicked\", (data) => { console.log(data); });\n * map.addControl(export); // <-- using the OpenLayers mechanism, don't call to render function !\n *\n * // use control options instead of setters\n * var export = new ButtonExport({\n *   download : true,\n *   control : iso,\n *   target : <!-- DOMElement -->,\n *   name : \"export\",\n *   description : \"Export Isochrone\",\n *   format : \"geojson\",\n *   title : \"Exporter\",\n *   menu : false,\n *   callback : (content, layer) => {\n *      console.log(content, layer);\n *   }\n * });\n * map.addControl(export);\n *\n * // method with passing option into the control Isocurve\n * var iso = new ol.control.Isocurve({ export : true });\n * // with control options :\n * var iso = new ol.control.Isocurve({ export : {\n *   download : false,\n *   name : \"save-iso\",\n *   format : \"geojson\",\n *   title : \"Sauvegarde\",\n *   menu : true\n * }});\n */\nclass ButtonExport extends Control {\n\n    /**\n     * See {@link ol.control.Export}\n     * @module ButtonExport\n     * @alias module:~controls/ButtonExport\n     * @param {Object} [options] - options\n     * @example\n     * import ButtonExport from \"gpf-ext-ol/controls/ButtonExport\"\n     * ou \n     * import { ButtonExport } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {\n            layer : null,\n            control : null,\n            target : null,\n            format : \"geojson\",\n            name : \"export\",\n            description : \"export\",\n            title : \"Exporter\",\n            kind : \"secondary\",\n            menu : false,\n            icons : {\n                menu : \"\\u2630 \",\n                button : \"\"\n            },\n            callback : null\n        };\n\n        logger.trace(\"[constructor] Export\", options);\n\n        super({\n            element : document.createElement(\"div\"),\n            render : options.render,\n            target : null\n        });\n\n        if (!(this instanceof ButtonExport)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"Export\";\n        /**\n         * Response to the export of the route calculation\n         * (only for jsdoc)\n         *\n         * @example\n         * // GeoJSON format\n         * {\n         *   \"type\":\"FeatureCollection\",\n         *   \"features\":[...],\n         *   \"geoportail:compute\":{\n         *     \"points\":[ [2.588024210134887, 48.84192678293002 ] ],\n         *     \"transport\":\"Voiture\",\n         *     \"exclusions\":[...],\n         *     \"computation\":\"fastest\",\n         *     \"results\":{ <!-- Service --> }\n         * }\n         *\n         * @see {@link https://ignf.github.io/geoportal-access-lib/latest/jsdoc/Gp.Services.RouteResponse.html|Service}\n         */\n        // eslint-disable-next-line no-undef\n        this.EXPORT_ROUTE = {};\n\n        /**\n         * Response to the export of the isochron calculation\n         * (only for jsdoc)\n         *\n         * @example\n         * // GeoJSON format\n         * {\n         *    \"type\":\"FeatureCollection\",\n         *    \"features\":[...],\n         *    \"geoportail:compute\":{\n         *       \"transport\":\"Pieton\",\n         *       \"computation\":\"time\",\n         *       \"exclusions\":[\n         *\n         *       ],\n         *       \"direction\":\"departure\",\n         *       \"point\":[ 2.587835382718464, 48.84192678293002 ],\n         *       \"results\":{\n         *          \"message\":\"\",\n         *          \"id\":\"\",\n         *          \"location\":{\n         *             \"x\":\"2.587835382718464\",\n         *             \"y\":\"48.84192678293002\"\n         *          },\n         *          \"srs\":\"EPSG:4326\",\n         *          \"geometry\":{\n         *             \"type\":\"Polygon\",\n         *             \"coordinates\":[[...]]\n         *          },\n         *         \"time\":180,\n         *         \"distance\":\"\"\n         *      }\n         *    }\n         * }\n         *\n         * @see {@link https://ignf.github.io/geoportal-access-lib/latest/jsdoc/Gp.Services.IsoCurveResponse.html|Service}\n         */\n        // eslint-disable-next-line no-undef\n        this.EXPORT_ISOCHRON = {};\n\n        /**\n         * Response to the export of the profile calculation\n         * (only for jsdoc)\n         *\n         * @example\n         * // GeoJSON format\n         * {\n         *  \"type\":\"FeatureCollection\",\n         *   \"features\":[...],\n         *   \"geoportail:compute\":{\n         *      \"greaterSlope\":76,\n         *      \"meanSlope\":7,\n         *      \"distancePlus\":84,\n         *      \"distanceMinus\":48,\n         *      \"ascendingElevation\":5,\n         *      \"descendingElevation\":-4,\n         *      \"altMin\":\"92,04\",\n         *      \"altMax\":\"96,71\",\n         *      \"distance\":163,\n         *      \"unit\":\"m\",\n         *      \"points\":[\n         *        {\n         *            \"z\":95.68,\n         *            \"lon\":2.5874,\n         *            \"lat\":48.8419,\n         *            \"acc\":2.5,\n         *            \"dist\":0,\n         *            \"slope\":0\n         *         }\n         *      ]\n         *   }\n         * }\n         *\n         * @see {@link https://ignf.github.io/geoportal-access-lib/latest/jsdoc/Gp.Services.AltiResponse.html|Service}\n         */\n        // eslint-disable-next-line no-undef\n        this.EXPORT_PROFILE = {};\n\n        // id unique\n        this.uid = options.id || ID.generate();\n\n        // export\n        this.extension = null;\n        this.mimeType = null;\n\n        // dom\n        this.container = null;\n        this.button = null;\n        this.buttonOptions = null;\n        this.inputName = null;\n        this.inputDesc = null;\n        this.menu = null;\n        this.menuClassHidden = \"GPelementHidden gpf-hidden\";\n\n        this.initOptions(options);\n        this.initContainer();\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n\n    /**\n     * Render DOM\n     *\n     * @public\n     */\n    render () {\n        // container principal\n        if (!this.options.target) {\n            if (this.options.control) {\n                // insertion du composant dans le panneau du controle\n                var containerMain = this.options.control.getContainer();\n                var containerPlug = containerMain.querySelector(\".container-buttons-plugin\");\n                // ex. GP(iso|route)Panel-\n                this.options.target = containerPlug || containerMain.lastChild;\n            }\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n    }\n\n    // ################################################################### //\n    // #################### privates methods ############################# //\n    // ################################################################### //\n\n    /**\n     * Initialize options\n     * (called by constructor)\n     *\n     * @param {Object} options - options\n     * @private\n     */\n    initOptions (options) {\n        this.options = {\n            layer : null,\n            control : null,\n            target : null,\n            download : true,\n            format : \"geojson\",\n            name : \"export\",\n            description : \"export\",\n            title : \"Exporter\",\n            kind : \"secondary\",\n            direction : \"row\",\n            menu : false,\n            menuOptions : {\n                above : false, // au dessus ou en dessous du bouton !\n                outside : false,\n                labelName : true,\n                labelDesc : true,\n                selectFormat : true\n            },\n            icons : {\n                menu : \"\\u2630 \", // FIXME à supprimer !\n                button : \"export\"\n            },\n            callback : null\n        };\n\n        // merge with user options\n        var icons = Utils.assign(this.options.icons, options.icons);\n        var menuOptions = Utils.assign(this.options.menuOptions, options.menuOptions);\n        Utils.assign(this.options, options);\n        Utils.assign(this.options.icons, icons);\n        Utils.assign(this.options.menuOptions, menuOptions);\n\n        logger.debug(this.options);\n        \n        if (this.options.layer) {\n            // TODO test...\n        }\n\n        if (this.options.control) {\n            // TODO test...\n        }\n\n        if (this.options.target) {\n            // TODO test...\n        }\n\n        var format = this.options.format;\n        (format) ? this.setFormat(format) : this.setFormat(\"\");\n\n        if (!this.options.name) {\n            this.setName(\"export\");\n        }\n\n        if (!this.options.description) {\n            this.setDescription(\"export\");\n        }\n\n        if (!this.options.title) {\n            this.setTitle(\"Exporter\");\n        }\n\n        if (!this.options.kind) {\n            this.setKind(\"secondary\");\n        }\n\n        if (this.options.menu === undefined) {\n            this.setMenu(false);\n        }\n    }\n\n    /**\n     * Initialize container\n     * (called by constructor)\n     *\n     * @private\n     * @todo menu des options\n     */\n    initContainer () {\n        // afficher l'icone du menu\n        var title = this.options.title;\n        if (this.options.menu) {\n            title = this.options.icons.menu + this.options.title;\n        }\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPexportContainer\");\n        div.className = \"GPexportMenuContainer gpf-export-menu-container gpf-export-menu-container-row-reverse\";\n\n        if (this.options.direction === \"column\") {\n            div.classList.replace(\"gpf-export-menu-container-row-reverse\", \"gpf-export-menu-container-column-reverse\");\n        }\n        \n        // menu des options\n        // > GPexportMenuHidden : pas de menu pour le mode classic !\n        var menu = this.stringToHTML(`\n            <div class=\"GPexportMenuHidden gpf-accordion fr-accordion ${this.menuClassHidden}\">\n                <h3 class=\"gpf-accordion__title fr-accordion__title\">\n                    <button type=\"button\" \n                        id=\"GPexportBtnMenuContent-${this.uid}\"\n                        class=\"gpf-accordion__btn fr-accordion__btn\" \n                        aria-expanded=\"false\" aria-controls=\"GPexportMenuContent-${this.uid}\">options</button>\n                </h3>\n                <div id=\"GPexportMenuContent-${this.uid}\"\n                    class=\"GPexportMenuContent fr-collapse fr-mx-2w\">\n                    <div id=\"GPexportMenuName-${this.uid}\" \n                        class=\"GPexportMenuName\">\n                        <label class=\"GPlabel gpf-label fr-label\" for=\"GPexportMenuInputName-${this.uid}\" title=\"Nom\">Nom</label>\n                        <input type=\"text\" id=\"GPexportMenuInputName-${this.uid}\" class=\"GPinput gpf-input fr-input\">\n                    </div>\n                    <div id=\"GPexportMenuDesc-${this.uid}\"\n                        class=\"GPexportMenuDesc\">\n                        <label class=\"GPlabel gpf-label fr-label\" for=\"GPexportMenuInputDesc-${this.uid}\" title=\"Description\">Description</label>\n                        <input type=\"text\" id=\"GPexportMenuInputDesc-${this.uid}\" class=\"GPinput gpf-input fr-input\">\n                    </div>\n                    <div id=\"GPexportMenuFormat-${this.uid}\">\n                        <label class=\"GPlabel gpf-label fr-label\" title=\"Formats\">Formats</label>\n                        <div class=\"GPexportMenuFormat fr-radio-group fr-m-1w\">\n                            <input type=\"radio\" \n                                id=\"GPmenuFormatGeojson-${this.uid}\"\n                                name=\"format\" \n                                value=\"geojson\">\n                            <label class=\"fr-label container\" for=\"GPmenuFormatGeojson-${this.uid}\">GeoJSON\n                                <span class=\"checkmark\"></span>\n                            </label>\n                        </div>\n                        <div class=\"GPexportMenuFormat fr-radio-group fr-m-1w\">\n                            <input type=\"radio\" \n                                id=\"GPmenuFormatKml-${this.uid}\"\n                                name=\"format\" \n                                value=\"kml\">\n                            <label class=\"fr-label container\" for=\"GPmenuFormatKml-${this.uid}\">KML\n                                <span class=\"checkmark\"></span>\n                            </label>\n                        </div>\n                        <div class=\"GPexportMenuFormat fr-radio-group fr-m-1w\">\n                            <input type=\"radio\" \n                                id=\"GPmenuFormatGpx-${this.uid}\"\n                                name=\"format\" \n                                value=\"gpx\">\n                            <label class=\"fr-label container\" for=\"GPmenuFormatGpx-${this.uid}\">GPX\n                                <span class=\"checkmark\"></span>\n                            </label>\n                        </div>\n                    </div>\n                    <div id=\"GPexportMenuButtons-${this.uid}\" \n                        class=\"GPexportMenuButtons\">\n                        <button \n                            type=\"button\"\n                            id=\"GPexportMenuButtonValidate-${this.uid}\" \n                            class=\"GPexportMenuButtonValidate GPsubmit gpf-btn gpf-btn-icon-export-validate fr-btn fr-btn--secondary fr-m-1w\">\n                            Valider\n                        </button>\n                        <button \n                            type=\"button\"\n                            id=\"GPexportMenuButtonCancel-${this.uid}\" \n                            class=\"GPexportMenuButtonIconCancel GPsubmit gpf-btn gpf-btn-icon-export-cancel fr-btn fr-btn--secondary fr-m-1w\">\n                            Annuler\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `);\n\n        this.menu = menu.firstChild;\n        if (this.menu) {\n            if (this.options.menu) {\n                var className = this.menu.className;\n                this.menu.className = className.replace(this.menuClassHidden, \"\");\n            }\n            var format = this.options.format.toUpperCase();\n            var radios = this.menu.querySelectorAll(`input[type=radio][name=\"format\"]`);\n            for (let i = 0; i < radios.length; i++) {\n                var radio = radios[i];\n                // radio checked par defaut\n                if (radio.id.toUpperCase().includes(format)) {\n                    radio.checked = true;\n                }\n                // ecouteur pour changer de format\n                radio.addEventListener(\"change\", (e) => this.onChangeRadioFormat(e));\n            }\n\n            this.buttonOptions = this.menu.querySelector(\"#GPexportBtnMenuContent-\" + this.uid);\n            if (this.buttonOptions) {\n                this.buttonOptions.addEventListener(\"click\", (e) => this.onClickButtonToggleOptions(e));\n            }\n\n            this.inputName = this.menu.querySelector(\"#GPexportMenuInputName-\" + this.uid);\n            this.inputDesc = this.menu.querySelector(\"#GPexportMenuInputDesc-\" + this.uid);\n            this.inputName.addEventListener(\"change\", (e) => this.onChangeInputName(e));\n            this.inputName.addEventListener(\"focusin\", (e) => this.onFocusInputName(e));\n            this.inputDesc.addEventListener(\"change\", (e) => this.onChangeInputDesc(e));\n            this.inputDesc.addEventListener(\"focusin\", (e) => this.onFocusInputDesc(e));\n\n            var btnValidate = this.menu.querySelector(\"#GPexportMenuButtonValidate-\" + this.uid);\n            btnValidate.addEventListener(\"click\", (e) => this.onClickButtonValidate(e));\n            var btnCancel = this.menu.querySelector(\"#GPexportMenuButtonCancel-\" + this.uid);\n            btnCancel.addEventListener(\"click\", (e) => this.onClickButtonCancel(e));\n        \n            // les options du menu\n            if (this.options.menuOptions) {\n                if (this.options.menuOptions.outside) {\n                    this.menu.classList.remove(\"gpf-accordion\", \"fr-accordion\");\n                    var divButton = this.menu.querySelector(\"#GPexportBtnMenuContent-\" + this.uid);\n                    divButton.classList.add(\"gpf-hidden\");\n                    var divContent = this.menu.querySelector(\"#GPexportMenuContent-\" + this.uid);\n                    divContent.classList.remove(\"fr-collapse\");\n                    var divButtons = this.menu.querySelector(\"#GPexportMenuButtons-\" + this.uid);\n                    divButtons.classList.add(\"gpf-hidden\");\n                }\n                if (this.options.menuOptions.above) {\n                    div.classList.replace(\"gpf-export-menu-container-row-reverse\", \"gpf-export-menu-container-row\");\n                    div.classList.replace(\"gpf-export-menu-container-column-reverse\", \"gpf-export-menu-container-column\");\n                }\n                if (!this.options.menuOptions.labelName) {\n                    var divName = this.menu.querySelector(\"#GPexportMenuName-\" + this.uid);\n                    divName.classList.add(\"gpf-hidden\");\n                }\n                if (!this.options.menuOptions.labelDesc) {\n                    var divDesc = this.menu.querySelector(\"#GPexportMenuDesc-\" + this.uid);\n                    divDesc.classList.add(\"gpf-hidden\");\n                }\n                if (!this.options.menuOptions.selectFormat) {\n                    var divFormat = this.menu.querySelector(\"#GPexportMenuFormat-\" + this.uid);\n                    divFormat.classList.add(\"gpf-hidden\");\n                }\n            }\n        }\n        div.appendChild(this.menu);\n\n        // bouton Exporter\n        // utiliser les templates literals avec la substitution ${...}\n        var button = this.stringToHTML(`\n            <button \n                type=\"button\"\n                id=\"${this._addUID(\"GPexportButton\")}\" \n                class=\"GPexportButtonExportIcon GPsubmit gpf-btn gpf-btn-icon-export-submit fr-btn fr-m-1w\">\n                ${title}\n            </button>\n        `);\n\n        // add event click button\n        this.button = button.firstChild;\n        if (this.button) {\n            this.button.addEventListener(\"click\", (e) => this.onClickButtonExport(e));\n        }\n        // primary | secondary | tertiary\n        switch (this.options.kind) {\n            case \"tertiary\":\n                this.button.classList.add(\"fr-btn--tertiary\", \"gpf-btn--tertiary\");\n                break;\n            case \"secondary\":\n                this.button.classList.add(\"fr-btn--secondary\", \"gpf-btn--secondary\");\n                break;\n            case \"primary\":\n            default:\n                this.button.classList.add(\"fr-btn--primary\", \"gpf-btn--primary\");\n                break;\n        }\n        // icon button\n        if (!this.options.icons.button) {\n            this.button.classList.remove(\"GPexportButtonExportIcon\", \"gpf-btn-icon-export-submit\");\n        } else {\n            switch (this.options.icons.button) {\n                case \"export\":\n                    break;\n                case \"save\":\n                    this.button.classList.replace(\"GPexportButtonExportIcon\", \"GPexportButtonSaveIcon\");\n                    this.button.classList.replace(\"gpf-btn-icon-export-submit\", \"gpf-btn-icon-save-submit\");\n                    break;\n                default:\n                    this.button.classList.remove(\"GPexportButtonExportIcon\", \"gpf-btn-icon-export-submit\");\n                    break;\n            }\n        }\n        div.appendChild(this.button);\n        \n        this.container = div;\n    }\n\n    /**\n     * ...\n     *\n     * @param {String} str - ...\n     * @returns {DOMElement} - ...\n     * @private\n     */\n    stringToHTML (str) {\n        var support = function () {\n            if (!window.DOMParser) {\n                return false;\n            }\n            var parser = new DOMParser();\n            try {\n                parser.parseFromString(\"x\", \"text/html\");\n            } catch (err) {\n                return false;\n            }\n            return true;\n        };\n\n        // If DOMParser is supported, use it\n        if (support()) {\n            var parser = new DOMParser();\n            var doc = parser.parseFromString(str, \"text/html\");\n            return doc.body;\n        }\n\n        // Otherwise, fallback to old-school method\n        var dom = document.createElement(\"div\");\n        dom.innerHTML = str;\n        return dom;\n    }\n\n    /**\n     * ...\n     * @returns {Boolean} - ...\n     * @private\n     */\n    isPluggableControl () {\n        // tester toutes les méthodes des widgets pluggable\n        // la méthode getData() n'est pas obligatoire car certains widgets\n        // n'ont pas de configuration.\n        if (this.options.control &&\n            typeof this.options.control.getContainer === \"function\" &&\n            typeof this.options.control.getLayer === \"function\") {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * ...\n     * @param {Object} layer - ...\n     * @param {Object} [data] - ...\n     * @param {Object} [style] - ...\n     * @returns {String} - ...\n     * @private\n     */\n    exportFeatures (layer, data, style) {\n        var result = null;\n        if (!layer) {\n            logger.warn(\"Impossible to export : no layer is hosting features.\");\n            return result;\n        }\n        if (!layer.getSource() ||\n            !layer.getSource().getFeatures() ||\n            !layer.getSource().getFeatures().length) {\n            logger.warn(\"Impossible to export : no features found.\");\n            return result;\n        }\n\n        // INFO\n        // les styles sont bien transmis pour l'outil de dessin\n        // mais, ce n'est pas toujours le cas pour certains widgets !?\n        // donc, on y ajoute les styles par defaut...\n        layer.getSource().getFeatures().forEach((feature) => {\n            var style = feature.getStyle();\n            if (!style && this.options.control && typeof this.options.control.getStyle === \"function\") {\n                feature.setStyle(this.options.control.getStyle());\n            }\n        });\n\n        // ajouter les metadonnées de calcul et de configuration\n        var options = {\n            defaultStyle : style,\n            extensions : {}\n        };\n        if (data) {\n            // properties ajoutées à la racine :\n            // ex. \"geoportail:compute\" : {}\n            options.extensions = {\n                \"geoportail:compute\" : data\n            };\n        }\n\n        if (this.options.description) {\n            options.extensions.description = (this.inputDesc && this.inputDesc.value) ? this.inputDesc.value : this.options.description;\n        }\n\n        var ClassName = null;\n        switch (this.options.format.toUpperCase()) {\n            case \"KML\":\n                options.writeStyles = true;\n                options.showPointNames = true;\n                ClassName = new KMLExtended(options);\n                break;\n            case \"GPX\":\n                ClassName = new GPXExtended(options);\n                break;\n            case \"GEOJSON\":\n                ClassName = new GeoJSONExtended(options);\n                break;\n            default:\n                break;\n        }\n\n        if (!ClassName) {\n            logger.warn(\"Impossible to export : format unknown !?\");\n            return result;\n        }\n\n        var featProj = layer.getSource().getProjection();\n\n        // INFO\n        // on determine la projection de la carte\n        // si le composant a été ajouté sur la carte via le mécanisme d'OpenLayer...\n        var map = this.getMap();\n        if (map) {\n            featProj = featProj || map.getView().getProjection();\n        }\n\n        var features = layer.getSource().getFeatures();\n\n        // INFO\n        // par defaut, webmercator ou \"EPSG:3857\"\n        result = ClassName.writeFeatures(features, {\n            dataProjection : \"EPSG:4326\",\n            featureProjection : featProj || \"EPSG:3857\"\n        });\n\n        return result;\n    }\n    // ################################################################### //\n    // ######################## event dom ################################ //\n    // ################################################################### //\n\n    /**\n     * ...\n     * @param {*} e - Click\n     */\n    onClickButtonExport (e) {\n        if (!this.isPluggableControl()) {\n            logger.warn(\"Componant not pluggable with the control !\");\n            // return;\n        }\n\n        var layer = (this.options.control && this.options.control.getLayer !== undefined) ? this.options.control.getLayer() : this.options.layer;\n        var data = (this.options.control && this.options.control.getData !== undefined) ? this.options.control.getData() : {};\n        var style = (this.options.control && this.options.control.getStyle !== undefined) ? this.options.control.getStyle() : {};\n\n        var content = this.exportFeatures(layer, data, style);\n        if (!content || content === \"null\") {\n            return;\n        }\n\n        /**\n         * event triggered when the export is finished\n         *\n         * @event button:clicked\n         * @typedef {Object}\n         * @property {Object} type - event\n         * @property {Object} target - instance Export\n         * @property {String} content - export data\n         * @property {String} name - name\n         * @property {String} description - description\n         * @property {String} format - format : kml, geojson, ...\n         * @property {Object} layer - layer\n         * @example\n         * Export.on(\"button:clicked\", function (e) {\n         *   console.log(e.target);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"button:clicked\",\n            content : content,\n            name : this.options.name,\n            description : this.options.description,\n            format : this.options.format,\n            layer : layer\n        });\n\n        if (this.options.download) {\n            var link = document.createElement(\"a\");\n            // determiner le bon charset !\n            var charset = \"utf-8\";\n            link.setAttribute(\"href\", \"data:\" + this.mimeType + \";charset=\" + charset + \",\" + encodeURIComponent(content));\n            link.setAttribute(\"download\", this.options.name + this.extension);\n            if (document.createEvent) {\n                var event = document.createEvent(\"MouseEvents\");\n                event.initEvent(\"click\", true, true);\n                link.dispatchEvent(event);\n            } else {\n                link.click();\n            }\n        }\n\n        if (this.options.callback && typeof this.options.callback === \"function\") {\n            this.options.callback(content, layer);\n        }\n    }\n\n    /**\n     * \n     * @param {*} e - Click\n     */\n    onChangeRadioFormat (e) {\n        this.setFormat(e.target.value);\n    }\n\n    /**\n     * \n     * @param {*} e - Click\n     */\n    onChangeInputName (e) {\n        this.setName(e.target.value);\n    }\n\n    onFocusInputName (e) {\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n        if (this.options.control && typeof this.options.control.disable === \"function\") {\n            this.options.control.disable();\n        }\n    }\n\n    /**\n     * \n     * @param {*} e - Click\n     */\n    onChangeInputDesc (e) {\n        this.setDescription(e.target.value);\n    }\n\n    onFocusInputDesc (e) {\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n        if (this.options.control && typeof this.options.control.disable === \"function\") {\n            this.options.control.disable();\n        }\n    }\n\n    /**\n     * \n     * @param {*} e - Click\n     */\n    onClickButtonToggleOptions (e) {\n        e.target.ariaExpanded = !(e.target.ariaExpanded === \"true\");\n        var collapse = this.menu.querySelector(\"#\" + e.target.getAttribute(\"aria-controls\"));\n        if (!collapse) {\n            return;\n        }\n        if (e.target.ariaExpanded === \"true\") {\n            collapse.classList.add(\"fr-collapse--expanded\");\n            this.menu.classList.add(\"gpf-full-container\");\n            this.menu.classList.add(\"gpf-accordion--opened\");\n            collapse.classList.remove(\"GPelementHidden\");\n        } else {\n            collapse.classList.remove(\"fr-collapse--expanded\");\n            this.menu.classList.remove(\"gpf-full-container\");\n            this.menu.classList.remove(\"gpf-accordion--opened\");\n            collapse.classList.add(\"GPelementHidden\");\n        }\n    }\n\n    onClickButtonValidate (e) {\n        this.setName(this.inputName.value);\n        this.setDescription(this.inputDesc.value);\n        this.buttonOptions.click();\n    }\n\n    onClickButtonCancel (e) {\n        this.inputName.value = \"\";\n        this.inputDesc.value = \"\";\n        this.buttonOptions.click();\n    }\n\n    // ################################################################### //\n    // ################# public getters/setters ########################## //\n    // ################################################################### //\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    /**\n     * ...\n     * @param {Object} control - ...\n     * @public\n     */\n    setControl (control) {\n        this.options.control = control;\n    }\n\n    /**\n     * ...\n     * @param {DOMElement} target - ...\n     * @public\n     */\n    setTarget (target) {\n        this.options.target = target;\n    }\n\n    /**\n     * ...\n     * @param {String} format - ...\n     * @public\n     */\n    setFormat (format) {\n        this.options.format = format.toUpperCase();\n        switch (this.options.format) {\n            case \"KML\":\n                this.extension = \".kml\";\n                this.mimeType = \"application/vnd.google-earth.kml+xml\";\n                break;\n            case \"GPX\":\n                this.extension = \".gpx\";\n                this.mimeType = \"application/gpx+xml\";\n                break;\n            case \"GEOJSON\":\n                this.extension = \".geojson\";\n                this.mimeType = \"application/geo+json\";\n                break;\n            default:\n                // redefine format by default !\n                this.options.format = \"GEOJSON\";\n                this.extension = \".geojson\";\n                this.mimeType = \"application/geo+json\";\n                break;\n        }\n    }\n\n    /**\n     * ...\n     * @param {String} name - ...\n     * @public\n     */\n    setName (name) {\n        this.options.name = name;\n    }\n\n    /**\n     * ...\n     * @param {String} desc - ...\n     * @public\n     */\n    setDescription (desc) {\n        this.options.description = desc;\n    }\n\n    /**\n     * ...\n     * @param {String} title - ...\n     * @public\n     */\n    setTitle (title) {\n        this.options.title = title;\n        if (this.button) {\n            // afficher l'icone du menu / titre\n            this.button.textContent = (this.options.menu) ? this.options.icons.menu + title : title;\n        }\n    }\n\n    /**\n     * ...\n     * @param {String} type - ...\n     * @public\n     */\n    setKind (type) {\n        this.options.kind = type;\n        if (this.button) {\n            this.button.classList.remove(\"fr-btn--tertiary\", \"gpf-btn--tertiary\");\n            this.button.classList.remove(\"fr-btn--secondary\", \"gpf-btn--secondary\");\n            switch (this.options.kind) {\n                case \"tertiary\":\n                    this.button.classList.add(\"fr-btn--tertiary\", \"gpf-btn--tertiary\");\n                    break;\n                case \"secondary\":\n                    this.button.classList.add(\"fr-btn--secondary\", \"gpf-btn--secondary\");\n                    break;\n                case \"primary\":\n                default:\n                    this.button.classList.add(\"fr-btn--primary\", \"gpf-btn--primary\");\n                    break;\n            }\n        }\n    }\n\n    /**\n     * ...\n     * @param {Boolean} active - ...\n     * @public\n     */\n    setMenu (active) {\n        this.options.menu = active;\n        if (this.button) {\n            // afficher l'icone du menu / titre\n            this.button.textContent = (this.options.menu) ? this.options.icons.menu + this.options.title : this.options.title;\n        }\n        if (this.menu && this.options.menu) {\n            // afficher le menu\n            var className = this.menu.className;\n            this.menu.className = className.replace(this.menuClassHidden, \"\");\n            // format par defaut\n            var format = this.options.format.toUpperCase();\n            var radios = this.menu.querySelectorAll(`input[type=radio][name=\"format\"]`);\n            for (let i = 0; i < radios.length; i++) {\n                var radio = radios[i];\n                if (radio.id.toUpperCase().includes(format)) {\n                    radio.checked = true;\n                }\n            }\n        }\n    }\n\n    /**\n     * ...\n     * @param {Object} opts - ...\n     * @todo ...\n     */\n    setMenuOptions (opts) {\n\n    }\n\n    /**\n     * ...\n     * @param {*} layer  - ...\n     * @public\n     */\n    setLayer (layer) {\n        this.options.layer = layer;\n    }\n\n    /**\n     * ...\n     * @param {Boolean} value - ...\n     * @public\n     */\n    setDownload (value) {\n        this.options.download = value;\n    }\n\n};\n\n// on récupère les méthodes de la classe DOM\nObject.assign(ButtonExport.prototype, ExportDOM);\nObject.assign(ButtonExport.prototype, Widget);\n\nexport default ButtonExport;\n\n// Expose Export as ol.control.Export (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.Export = ButtonExport;\n}\n","/**\n * Creation d'une requête en REST ou WPS\n * (Factory)\n *\n * @module AltiRequestFactory\n * @alias Gp.Services.Alti.Request.AltiRequestFactory\n * @private\n */\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport AltiRequestREST from \"./AltiRequestREST\";\nimport AltiRequestWPS from \"./AltiRequestWPS\";\n\nvar AltiRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      httpMethod : 'GET', // GET|POST\n     *      onSuccess : function (response) {},\n     *      onError : function (error) {},\n     *      scope : this,\n     *      positions : [{lon:, lat:}, {lon:, lat:}],\n     *      outputFormat : 'json' // json|xml\n     *      sampling : 3,\n     *      api : 'REST', // REST|WPS\n     *      zonly : false // false|true\n     *   };\n     *\n     */\n    build : function (options) {\n        // logger\n        var logger = Logger.getLogger(\"AltiRequestFactory\");\n        logger.trace([\"AltiRequestFactory::build()\"]);\n\n        var request = null;\n\n        // on factorise les options par groupe;\n        // - global,\n        // - param, les params pour les data inputs\n        // - wps, les param du service\n        // - callback\n\n        var settings = {\n            // ajout des valeurs par defaut spécifiques au service\n            type : options.sampling ? \"Profil\" : \"Elevation\",\n            method : options.httpMethod,\n            param : {\n                positions : null,\n                delimiter : null, // FIXME par defaut, on ne le met pas en place car ça fait planter la requête !?\n                indent : null, // par defaut\n                crs : null, // par defaut\n                format : null, // (only to POST)\n                sampling : null, // (only use by Profil)\n                zonly : null, // (only use by Elevation)\n                measures : null // (only use by Elevation)\n            }\n        };\n\n        // surcharge des valeurs obligatoires\n        settings.param.positions = options.positions;\n        settings.param.format = options.outputFormat;\n        settings.param.sampling = options.sampling;\n        settings.param.zonly = options.zonly;\n        settings.param.measures = options.measures;\n        settings.param.resource = options.resource;\n\n        // gestion des callback\n        var bOnError = !!(options.onError !== null && typeof options.onError === \"function\"); // cast variable to boolean\n        var bOnSuccess = !!(options.onSuccess !== null && typeof options.onSuccess === \"function\");\n\n        var message = null;\n        switch (options.api) {\n            case \"REST\":\n                // FIXME les exceptions ne sont pas 'catchées' sur le constructeur !\n                var myReq = new AltiRequestREST(settings);\n                if (!myReq.processRequestString()) {\n                    message = \"Error in process request (rest) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new ErrorService(message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                request = myReq.requestString;\n                break;\n            case \"WPS\":\n                // ajout des valeurs par defaut spécifiques au service WPS\n                settings.wps = {\n                    service : null, // par defaut\n                    version : null, // par defaut\n                    identifier : null, // par defaut\n                    rawdataoutput : null, // par defaut\n                    request : null // par defaut\n                };\n\n                request = AltiRequestWPS.build(settings);\n                if (!request) {\n                    message = \"Error in process request (wps) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new ErrorService(message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                break;\n            default:\n                message = \"Type of API is not supported by service (REST or WPS) !\";\n                if (bOnError) {\n                    options.onError.call(options.scope, new ErrorService(message));\n                    return;\n                }\n                throw new Error(message);\n        }\n\n        if (bOnSuccess) {\n            options.onSuccess.call(options.scope, request);\n        }\n\n        return request;\n    }\n};\n\nexport default AltiRequestFactory;\n","'use strict';\nvar conventions = require('./conventions');\nexports.assign = conventions.assign;\nexports.hasDefaultHTMLNamespace = conventions.hasDefaultHTMLNamespace;\nexports.isHTMLMimeType = conventions.isHTMLMimeType;\nexports.isValidMimeType = conventions.isValidMimeType;\nexports.MIME_TYPE = conventions.MIME_TYPE;\nexports.NAMESPACE = conventions.NAMESPACE;\n\nvar errors = require('./errors');\nexports.DOMException = errors.DOMException;\nexports.DOMExceptionName = errors.DOMExceptionName;\nexports.ExceptionCode = errors.ExceptionCode;\nexports.ParseError = errors.ParseError;\n\nvar dom = require('./dom');\nexports.Attr = dom.Attr;\nexports.CDATASection = dom.CDATASection;\nexports.CharacterData = dom.CharacterData;\nexports.Comment = dom.Comment;\nexports.Document = dom.Document;\nexports.DocumentFragment = dom.DocumentFragment;\nexports.DocumentType = dom.DocumentType;\nexports.DOMImplementation = dom.DOMImplementation;\nexports.Element = dom.Element;\nexports.Entity = dom.Entity;\nexports.EntityReference = dom.EntityReference;\nexports.LiveNodeList = dom.LiveNodeList;\nexports.NamedNodeMap = dom.NamedNodeMap;\nexports.Node = dom.Node;\nexports.NodeList = dom.NodeList;\nexports.Notation = dom.Notation;\nexports.ProcessingInstruction = dom.ProcessingInstruction;\nexports.Text = dom.Text;\nexports.XMLSerializer = dom.XMLSerializer;\n\nvar domParser = require('./dom-parser');\nexports.DOMParser = domParser.DOMParser;\nexports.normalizeLineEndings = domParser.normalizeLineEndings;\nexports.onErrorStopParsing = domParser.onErrorStopParsing;\nexports.onWarningStopParsing = domParser.onWarningStopParsing;\n","module.exports = ol.proj;","\n/**\n * Single measure object returned by underlying web service if measures = true and zonly = false\n *\n * @property {String} source_name - Name of the source\n * @property {String} source_measure - Name of the measure\n * @property {Float} z - Point elevation.\n * @property {Float} acc - Accuracy of elevation for this point. (only if zonly=false)\n *\n * @namespace\n * @alias Gp.Services.Alti.Measure\n */\nfunction Measure () {\n    if (!(this instanceof Measure)) {\n        throw new TypeError(\"Measure constructor cannot be called as a function.\");\n    }\n\n    this.source_name = null;\n    this.source_measure = null;\n    this.z = null;\n    this.acc = null;\n}\n\nMeasure.prototype = {\n\n    constructor : Measure\n\n};\n\nexport default Measure;\n","const exceptions = [\"GPoverviewMap\", \"GPfullScreen\"];\n\nfunction getSameSideOpenedPanel (position, openedPanelID) {\n    // on ajoute aux exceptions le panel qui vient d'être ouvert\n    var exceptionPanel = [...exceptions, openedPanelID];\n    var controlPanels = [];\n    if (position && position.includes(\"left\")) {\n        var bottomLeft = document.getElementById(\"position-container-bottom-left\");\n        var topLeft = document.getElementById(\"position-container-top-left\");\n        controlPanels = [...bottomLeft.children, ...topLeft.children];\n    }\n    if (position && position.includes(\"right\")) {\n        var bottomRight = document.getElementById(\"position-container-bottom-right\");\n        var topRight = document.getElementById(\"position-container-top-right\");\n        controlPanels = [...bottomRight.children, ...topRight.children];\n    }\n    // on ne ferme que les panles déjà ouverts qui ne sont pas exceptions\n    return controlPanels.filter(p => {\n        var panelID = p.id.match(/(\\w+)-[0-9]+/)[1];\n        var isException = exceptionPanel.includes(panelID);\n        var isOpened = p.getElementsByTagName(\"button\")[0].getAttribute(\"aria-pressed\");\n        if (isOpened === \"true\" && !isException) {\n            return p;\n        }\n    });\n}\n\nvar PanelManager = function (position, openedPanelID) {\n    var openedPanel = getSameSideOpenedPanel(position, openedPanelID);\n    if (openedPanel.length > 0) {\n        openedPanel[0].getElementsByTagName(\"button\")[0].click();\n    }\n};\n\nexport default PanelManager;\n","import checkDsfr from \"../Utils/CheckDsfr\";\n\nvar IsoDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPisochron\");\n        container.className = \"GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Show iso control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoPictoElement : function () {\n        // contexte d'execution\n        var context = this;\n\n        var button = document.createElement(\"button\");\n        // INFO: Ajout d'une SPAN pour enlever des marges de 6px dans CHROMIUM (?!)\n        var span = document.createElement(\"span\");\n        button.appendChild(span);\n        button.id = this._addUID(\"GPshowIsochronPicto\");\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowIsochronPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-isocurve fr-btn fr-btn--tertiary\";\n        button.setAttribute(\"aria-label\", \"Calculer une isochrone\");\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie du calcul d'isochrone\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowIsoPanelClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                context.onShowIsoPanelClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    // ################################################################### //\n    // ################## Methods to display Inputs Panel ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createIsoPanelHeaderElement\n     * don't call this._createIsoPanelFormElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelElement : function () {\n        var dialog = document.createElement(\"dialog\");\n        dialog.id = this._addUID(\"GPisochronPanel\");\n        dialog.className = \"GPpanel gpf-panel fr-modal\";\n\n        // dialog.appendChild(this._createIsoPanelHeaderElement());\n        // dialog.appendChild(this._createIsoPanelFormElement());\n\n        return dialog;\n    },\n\n    _createIsoPanelDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"gpf-panel__body fr-modal__body\";\n        return div;\n    },\n\n    _createDrawingButtonsPluginDiv : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"container-buttons-plugin fr-mx-2w\";\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelHeaderElement : function () {\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        div.innerHTML = \"Calcul d'isochrone\";\n        container.appendChild(div);\n\n        // on desactive l'impl. reduction de la fenetre\n        // var divReduce  = document.createElement(\"div\");\n        // divReduce.id = this._addUID(\"GPisochronPanelReduce\");\n        // divReduce.className = \"GPpanelReduce\";\n        // divReduce.title = \"Masquer le panneau\";\n        //\n        // if (divReduce.addEventListener) {\n        //     divReduce.addEventListener(\"click\", function () {\n        //         if ( typeof self.onReduceIsoPanelClick === \"function\") {\n        //             document.getElementById(self._addUID(\"GPshowIsochron\")).checked = false;\n        //             self.onReduceIsoPanelClick();\n        //         }\n        //     }, false);\n        // } else if (divReduce.attachEvent) {\n        //     divReduce.attachEvent(\"onclick\", function () {\n        //         if ( typeof self.onReduceIsoPanelClick === \"function\") {\n        //             document.getElementById(self._addUID(\"GPshowIsochron\")).checked = false;\n        //             self.onReduceIsoPanelClick();\n        //         }\n        //     });\n        // }\n        // container.appendChild(divReduce);\n\n        var divClose = document.createElement(\"button\");\n        divClose.id = this._addUID(\"GPisochronPanelClose\");\n        divClose.className = \"GPpanelClose GPisochronPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPshowIsochronPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPshowIsochronPicto\")).click();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        divClose.appendChild(span);\n\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPisochronForm\");\n        form.className = \"GPform gpf-panel__content gpf-mobile-form fr-modal__content\";\n\n        form.addEventListener(\"submit\", function (e) {\n            e.preventDefault();\n            self.onIsoComputationSubmit(e);\n            return false;\n        });\n\n        return form;\n    },\n\n    /**\n     * Create Results Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelResultsElement : function () {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPisoResultsPanel\");\n        container.className = \"GPelementHidden gpf-hidden\";\n\n        var divNew = document.createElement(\"div\");\n        divNew.id = this._addUID(\"GPisoResultsNew\");\n        divNew.className = \"GPresetPicto gpf-btn gpf-btn-icon-reset fr-btn fr-btn--secondary gpf-btn--secondary fr-m-2w\";\n        divNew.title = \"Modifier le calcul\";\n        divNew.addEventListener(\"click\", function (e) {\n            document.getElementById(self._addUID(\"GPisoResultsPanel\")).className = \"GPelementHidden gpf-hidden\";\n            document.getElementById(self._addUID(\"GPisochronForm\")).className = \"gpf-panel__content fr-modal__content\";\n            self.onShowIsoResultsNewClick(e);\n        });\n        container.appendChild(divNew);\n        \n        return container;\n    },\n\n    /**\n     * Add Results Duration and Distance\n     * (results dynamically generate !)\n     * see event!\n     * @param {Object} results - resultats renvoyé par le service d'isochrone\n     * @param {Object} computeOptions - options données au service d'isochrone\n     * @param {Function} fconvert - fconvert\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _addIsoResultsValuesElement : function (results, computeOptions, fconvert) {\n        var distance = results.distance;\n        var duration = results.time;\n        var origin = results.location;\n        var mode = computeOptions.graph;\n        var type = computeOptions.method;\n        var exclusions = computeOptions.exclusions;\n\n        var div = document.getElementById(this._addUID(\"GPisoResultsPanel\"));\n        \n        // Nettoyage de la div des metadonnées du précédent calcul\n        if (div.childElementCount && div.firstChild.id === this._addUID(\"GPisoResultsValueDiv\")) {\n            div.removeChild(div.firstChild);\n        }\n\n        // Création de la div des metadonnées du calcul\n        var isoResultsValueDiv = document.createElement(\"div\");\n        isoResultsValueDiv.id = this._addUID(\"GPisoResultsValueDiv\");\n        isoResultsValueDiv.className = \"fr-m-2w\";\n\n        // Affichage du type de calcul\n        \n        var containerType = document.createElement(\"div\");\n        containerType.className = \"GPisoResultsValue\";\n\n        var labelType = document.createElement(\"label\");\n        labelType.className = \"GPisoResultsValueLabel\";\n        labelType.innerHTML = \"Type :\";\n        containerType.appendChild(labelType);\n\n        var divType = document.createElement(\"div\");\n        divType.id = this._addUID(\"GPisoResultsValueType\");\n        if (type === \"time\") {\n            divType.innerHTML = \"temps\";\n        } else {\n            divType.innerHTML = \"distance\";\n        }\n        containerType.appendChild(divType);\n\n        isoResultsValueDiv.appendChild(containerType);\n\n        // Affichage du graphe utilisé\n\n        var containerMode = document.createElement(\"div\");\n        containerMode.className = \"GPisoResultsValue\";\n\n        var labelMode = document.createElement(\"label\");\n        labelMode.className = \"GPisoResultsValueLabel\";\n        labelMode.innerHTML = \"Mode :\";\n        containerMode.appendChild(labelMode);\n\n        var divMode = document.createElement(\"div\");\n        divMode.id = this._addUID(\"GPisoResultsValueMode\");\n        divMode.innerHTML = mode;\n        containerMode.appendChild(divMode);\n\n        isoResultsValueDiv.appendChild(containerMode);\n\n        // Affichage coords de l'origine du calcul\n        var containerOrigin = document.createElement(\"div\");\n        containerOrigin.className = \"GPisoResultsValue\";\n\n        var labelOrigin = document.createElement(\"label\");\n        labelOrigin.className = \"GPisoResultsValueLabel\";\n        labelOrigin.innerHTML = \"Centre :\";\n        containerOrigin.appendChild(labelOrigin);\n\n        var divOrigin = document.createElement(\"div\");\n        divOrigin.id = this._addUID(\"GPisoResultsValueOrigin\");\n        divOrigin.innerHTML = parseFloat(origin.x).toFixed(4) + \", \" + parseFloat(origin.y).toFixed(4);\n        containerOrigin.appendChild(divOrigin);\n\n        isoResultsValueDiv.appendChild(containerOrigin);\n\n        // Affichage distance de l'isodistance en cas d'isodistance\n        if (distance && distance.length !== 0) {\n            var containerDistance = document.createElement(\"div\");\n            containerDistance.className = \"GPisoResultsValue\";\n    \n            var labelDistance = document.createElement(\"label\");\n            labelDistance.className = \"GPisoResultsValueLabel\";\n            labelDistance.innerHTML = \"Distance :\";\n            containerDistance.appendChild(labelDistance);\n    \n            var distanceLabel = 0;\n            var isKm = parseInt(distance / 1000, 10);\n    \n            if (!isKm) {\n                distanceLabel = Math.round(distance) + \" m\";\n            } else {\n                var distanceArrondi = Math.round(distance);\n                distanceArrondi = distanceArrondi / 1000;\n                distanceLabel = distanceArrondi + \" km\";\n            }\n    \n            var divDistance = document.createElement(\"div\");\n            divDistance.id = this._addUID(\"GPisoResultsValueDist\");\n            divDistance.innerHTML = distanceLabel;\n            containerDistance.appendChild(divDistance);\n    \n            isoResultsValueDiv.appendChild(containerDistance);\n        }\n\n        // Affichage durée de l'isochrone en cas d'isochrone\n        if (duration && duration.length !== 0) {\n            var containerDuration = document.createElement(\"div\");\n            containerDuration.className = \"GPisoResultsValue\";\n    \n            var labelDuration = document.createElement(\"label\");\n            labelDuration.className = \"GPisoResultsValueLabel\";\n            labelDuration.innerHTML = \"Durée :\";\n            containerDuration.appendChild(labelDuration);\n    \n            var divDuration = document.createElement(\"div\");\n            divDuration.id = this._addUID(\"GPisoResultsValueTime\");\n            divDuration.innerHTML = fconvert(duration);\n            containerDuration.appendChild(divDuration);\n    \n            isoResultsValueDiv.appendChild(containerDuration);\n        }\n\n        // Affichage des éventuelles exclusions\n\n        if (exclusions.length > 0) {\n            var containerExclusions = document.createElement(\"div\");\n            containerExclusions.className = \"GPisoResultsValue\";\n    \n            var labelExclusions = document.createElement(\"label\");\n            labelExclusions.className = \"GPisoResultsValueLabel\";\n            labelExclusions.innerHTML = \"Exclusions :\";\n            containerExclusions.appendChild(labelExclusions);\n    \n            var divExclusions = document.createElement(\"div\");\n            divExclusions.id = this._addUID(\"GPisoResultsValueExclusions\");\n                \n            divExclusions.innerHTML = exclusions.join(\", \");\n            containerExclusions.appendChild(divExclusions);\n    \n            isoResultsValueDiv.appendChild(containerExclusions);\n        }\n\n        // ajout de la div des résultats en premier élément\n        div.prepend(isoResultsValueDiv);\n        return div;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoWaitingElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronCalcWaitingContainer\");\n        div.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPwaitingContainerInfo gpf-waiting_info\";\n        p.innerHTML = \"Recherche en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Create Footer Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFooterElement : function () {\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelFooter gpf-panel__footer fr-modal__footer\";\n\n        return container;\n    },\n\n    /**\n     * Create Point label\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormPointLabel : function () {\n        var p = document.createElement(\"p\");\n        p.id = this._addUID(\"GPisochronPointLabelP\");\n        p.className = \"gpf-label fr-label\";\n        p.innerHTML = \"Départ\";\n\n        return p;\n    },\n\n    // ################################################################### //\n    // ############# Methods to the type choice into form ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container to type choice\n     *\n     * FIXME\n     * don't call this._createIsoPanelFormTypeChoiceChronElement\n     * don't call this._createIsoPanelFormTypeChoiceDistElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronChoice\");\n        div.className = \"fr-mt-2w\";\n\n        // div.appendChild(this._createIsoPanelFormTypeChoiceChronElement());\n        // div.appendChild(this._createIsoPanelFormTypeChoiceDistElement());\n\n        return div;\n    },\n\n    /**\n     * Create Type choice Chron\n     * see event !\n     * FIXME event not useful\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceChronElement : function (checked) {\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisochronChoiceAlt gpf-flex gpf-flex-isocurve gpf-radio-group fr-radio-group\";\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronChoiceAltChron\");\n        input.name = \"GPisochronChoiceMode\";\n        input.type = \"radio\";\n        input.checked = !!(checked);\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function (e) {\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPflexInput gpf-flex fr-mt-1w\";\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronValueChronLabelP\")).className = \"gpf-label fr-label\";\n                document.getElementById(self._addUID(\"GPisochronValueDistLabelP\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronSubmit\")).value = \"Calculer l'isochrone\";\n                self.onIsoTypeChoiceChange(e);\n            }, false);\n        } else if (input.attachEvent) {\n            input.attachEvent(\"onchange\", function () {\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPflexInput gpf-flex fr-mt-1w\";\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronValueChronLabelP\")).className = \"gpf-label fr-label\";\n                document.getElementById(self._addUID(\"GPisochronValueDistLabelP\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronSubmit\")).value = \"Calculer l'isochrone\";\n                self.onIsoTypeChoiceChange();\n            });\n        }\n        // info: Internet explorer support\n        input.value = \"isochron\";\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisochronChoiceAltImg gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPisochronChoiceAltChron\");\n        label.innerHTML = \"Durée\";\n        label.title = \"Durée\";\n        div.appendChild(label);\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPisochronChoiceAltChronTxt\");\n        span.className = \"gpf-hidden\";\n        span.innerHTML = \"Durée\";\n        if (span.addEventListener) {\n            span.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltChron\")).click();\n            }, false);\n        } else if (span.attachEvent) {\n            span.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltChron\")).click();\n            });\n        }\n        div.appendChild(span);\n\n        return div;\n    },\n\n    /**\n     * Create Type choice Dist\n     * see event !\n     * FIXME event not useful\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceDistElement : function (checked) {\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisochronChoiceAlt gpf-flex gpf-flex-isocurve gpf-radio-group fr-radio-group\";\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronChoiceAltDist\");\n        input.name = \"GPisochronChoiceMode\";\n        input.type = \"radio\";\n        input.checked = !!(checked);\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function (e) {\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPflexInput gpf-flex fr-mt-1w\";\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronValueDistLabelP\")).className = \"gpf-label fr-label\";\n                document.getElementById(self._addUID(\"GPisochronValueChronLabelP\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronSubmit\")).value = \"Calculer l'isodistance\";\n                self.onIsoTypeChoiceChange(e);\n            }, false);\n        } else if (input.attachEvent) {\n            input.attachEvent(\"onchange\", function () {\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPflexInput gpf-flex fr-mt-1w\";\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronValueDistLabelP\")).className = \"gpf-label fr-label\";\n                document.getElementById(self._addUID(\"GPisochronValueChronLabelP\")).className = \"GPelementHidden gpf-hidden\";\n                document.getElementById(self._addUID(\"GPisochronSubmit\")).value = \"Calculer l'isodistance\";\n                self.onIsoTypeChoiceChange();\n            });\n        }\n        // info: Internet explorer support\n        input.value = \"isodistance\";\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisochronChoiceAltImg gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPisochronChoiceAltDist\");\n        label.innerHTML = \"Distance\";\n        label.title = \"Distance\";\n\n        div.appendChild(label);\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPisochronChoiceAltDistTxt\");\n        span.className = \"gpf-hidden\";\n        span.innerHTML = \"Distance\";\n        if (span.addEventListener) {\n            span.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltDist\")).click();\n            }, false);\n        } else if (span.attachEvent) {\n            span.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltDist\")).click();\n            });\n        }\n        div.appendChild(span);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############### Methods to the value iso into form ################ //\n    // ################################################################### //\n\n    /**\n     * Create isochron inputs label\n     * see event !\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormLabelIsochronElement : function (checked) {\n        var context = this;\n        var p = document.createElement(\"p\");\n        p.id = this._addUID(\"GPisochronValueChronLabelP\");\n        p.className = (checked) ? \"gpf-label fr-label\" : \"GPelementHidden gpf-hidden\";\n        p.innerHTML = \"Définir un temps de trajet\";\n\n        return p;\n    },\n\n    /**\n     * Create isochron inputs values\n     * see event !\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormValueIsochronElement : function (checked) {\n        // contexte\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronValueChron\");\n        div.className = (checked) ? \"GPflexInput gpf-flex fr-mt-1w\" : \"GPelementHidden gpf-hidden\";\n\n        var input1 = document.createElement(\"input\");\n        input1.id = this._addUID(\"GPisochronValueChronInput1\");\n        input1.className = \"gpf-input fr-input\";\n        input1.min = \"0\";\n        input1.step = \"1\";\n        input1.value = \"0\";\n        input1.type = \"number\";\n        input1.title = \"Temps\";\n        if (input1.addEventListener) {\n            input1.addEventListener(\"change\", function (e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeHourChange(e);\n                }\n            });\n        } else if (input1.attachEvent) {\n            input1.attachEvent(\"onchange\", function (e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeHourChange(e);\n                }\n            });\n        }\n        div.appendChild(input1);\n\n        var label1 = document.createElement(\"label\");\n        label1.innerHTML = \"h\";\n        label1.className = \"gpf-label fr-label\";\n        div.appendChild(label1);\n\n        var input2 = document.createElement(\"input\");\n        input2.id = this._addUID(\"GPisochronValueChronInput2\");\n        input2.className = \"gpf-input fr-input\";\n        input2.min = \"0\";\n        input2.max = \"59\";\n        input2.step = \"1\";\n        input2.value = \"0\";\n        input2.type = \"number\";\n        input2.title = \"Heures\";\n        if (input2.addEventListener) {\n            input2.addEventListener(\"change\", function (e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeMinuteChange(e);\n                }\n            });\n        } else if (input2.attachEvent) {\n            input2.attachEvent(\"onchange\", function (e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeMinuteChange(e);\n                }\n            });\n        }\n        div.appendChild(input2);\n\n        var label2 = document.createElement(\"label\");\n        label2.innerHTML = \"min\";\n        label2.className = \"gpf-label fr-label\";\n        div.appendChild(label2);\n\n        return div;\n    },\n\n    /**\n     * Create isodistance inputs label\n     * see event !\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormLabelIsodistanceElement : function (checked) {\n        var context = this;\n        var p = document.createElement(\"p\");\n        p.id = this._addUID(\"GPisochronValueDistLabelP\");\n        p.className = (checked) ? \"gpf-label fr-label\" : \"GPelementHidden gpf-hidden\";\n        p.innerHTML = \"Définir une distance\";\n\n        return p;\n    },\n\n    /**\n     * Create isodistance inputs values\n     * see event !\n     * @param {Boolean} checked - checked\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormValueIsodistanceElement : function (checked) {\n        // contexte\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronValueDist\");\n        div.className = (checked) ? \"GPflexInput gpf-flex fr-mt-1w\" : \"GPelementHidden gpf-hidden\";\n\n        var input1 = document.createElement(\"input\");\n        input1.id = this._addUID(\"GPisochronValueDistInput\");\n        input1.className = \"gpf-input fr-input fr-ml-1w\";\n        input1.min = \"0\";\n        input1.step = \"any\";\n        input1.value = \"0\";\n        input1.type = \"number\";\n        input1.title = \"Distance\";\n        if (input1.addEventListener) {\n            input1.addEventListener(\"change\", function (e) {\n                if (typeof context.onIsoValueDistChange === \"function\") {\n                    context.onIsoValueDistChange(e);\n                }\n            });\n        } else if (input1.attachEvent) {\n            input1.attachEvent(\"onchange\", function (e) {\n                if (typeof context.onIsoValueDistChange === \"function\") {\n                    context.onIsoValueDistChange(e);\n                }\n            });\n        }\n        div.appendChild(input1);\n\n        var label1 = document.createElement(\"label\");\n        label1.innerHTML = \"km\";\n        label1.className = \"gpf-label fr-label\";\n        div.appendChild(label1);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############ Methods to the mode choice into form ################# //\n    // ################################################################### //\n\n    /**\n     * Create Mode choice transport\n     * see event !\n     * FIXME event not useful\n     * @param {Array} transports - transports in a list\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormModeChoiceTransportElement : function (transports) {\n        // contexte d'execution\n        var context = this;\n\n        var divContainer = document.createElement(\"div\");\n        divContainer.id = this._addUID(\"GPisochronTransportChoice\");\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisochronModeLabel gpf-label fr-label\";\n        label.innerHTML = \"Choisir un mode de déplacement\";\n        divContainer.appendChild(label);\n\n        var radioContainer = document.createElement(\"div\");\n\n        /* jshint -W083 */\n        for (var i = 0; i < transports.length; i++) {\n            var transport = transports[i];\n\n            var div = document.createElement(\"div\");\n            div.className = \"GPisochronTransportChoice gpf-flex gpf-radio-group fr-radio-group\";\n\n            if (transport === \"Voiture\") {\n                var inputCar = document.createElement(\"input\");\n                inputCar.id = this._addUID(\"GPisochronTransportCar\");\n                inputCar.type = \"radio\";\n                inputCar.name = \"GPisochronTransport\";\n                if (i === 0) {\n                    inputCar.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requête sur le service de calcul d'itiniraire\n                if (inputCar.addEventListener) {\n                    inputCar.addEventListener(\"change\", function (e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                } else if (inputCar.attachEvent) {\n                    inputCar.attachEvent(\"onchange\", function (e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                }\n                // info : internet explorer support\n                inputCar.value = \"Voiture\";\n                div.appendChild(inputCar);\n\n                var labelCar = document.createElement(\"label\");\n                labelCar.className = \"GPisochronTransportImg gpf-label fr-label\";\n                labelCar.htmlFor = this._addUID(\"GPisochronTransportCar\");\n                labelCar.title = \"Voiture\";\n                labelCar.innerHTML = \"Voiture\";\n                div.appendChild(labelCar);\n            }\n\n            if (transport === \"Pieton\") {\n                var inputPedestrian = document.createElement(\"input\");\n                inputPedestrian.id = this._addUID(\"GPisochronTransportPedestrian\");\n                inputPedestrian.type = \"radio\";\n                inputPedestrian.name = \"GPisochronTransport\";\n                if (i === 0) {\n                    inputPedestrian.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requête sur le service de calcul d'itiniraire\n                if (inputPedestrian.addEventListener) {\n                    inputPedestrian.addEventListener(\"change\", function (e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                } else if (inputPedestrian.attachEvent) {\n                    inputPedestrian.attachEvent(\"onchange\", function (e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                }\n                // info : internet explorer support\n                inputPedestrian.value = \"Pieton\";\n                div.appendChild(inputPedestrian);\n\n                var labelPedestrian = document.createElement(\"label\");\n                labelPedestrian.className = \"GPisochronTransportImg gpf-label fr-label\";\n                labelPedestrian.htmlFor = this._addUID(\"GPisochronTransportPedestrian\");\n                labelPedestrian.title = \"Piéton\";\n                labelPedestrian.innerHTML = \"Piéton\";\n                div.appendChild(labelPedestrian);\n            }\n\n            radioContainer.appendChild(div);\n        }\n        divContainer.appendChild(radioContainer);\n\n        return divContainer;\n    },\n\n    /**\n     * Create Mode choice direction\n     * see event!\n     *\n     * @param {Array} directions - directions to display in list (\"Departure\", \"Arrival\"). First element will be selected by default\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormModeChoiceDirectionElement : function (directions) {\n        // contexte d'execution\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronDirectionChoice\");\n        div.className = \"fr-my-2w\";\n\n        var label = document.createElement(\"label\");\n        label.innerHTML = \"Définir un sens de parcours\";\n        label.className = \"fr-label\";\n        div.appendChild(label);\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GPisochronDirectionSelect\");\n        select.className = \"GPselect gpf-select fr-select\";\n        select.title = \"Sens de parcours\";\n        // gestionnaire d'evenement :\n        // on stocke la valeur du mode de calcul,\n        // utilisation pour la requête sur le service de calcul d'iso\n        select.addEventListener(\"change\", function (e) {\n            self.onIsoModeDirectionChange(e);\n        });\n\n        for (var i = 0; i < directions.length; i++) {\n            var direction = directions[i];\n            if (direction.toLowerCase() === \"departure\") {\n                var departureOption = document.createElement(\"option\");\n                if (i === 0) {\n                    departureOption.selected = \"selected\";\n                }\n                departureOption.value = \"departure\";\n                departureOption.text = \"Départ\";\n                select.appendChild(departureOption);\n            }\n            if (direction.toLowerCase() === \"arrival\") {\n                var arrivalOption = document.createElement(\"option\");\n                if (i === 0) {\n                    arrivalOption.selected = \"selected\";\n                }\n                arrivalOption.value = \"arrival\";\n                arrivalOption.text = \"Arrivée\";\n                select.appendChild(arrivalOption);\n            }\n        }\n        div.appendChild(select);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ################# Methods to the choice exclusions ################ //\n    // ################################################################### //\n\n    /**\n     * Label to Exclusions Options\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoExclusionsPictoElement : function () {\n        var self = this;\n\n        var button = document.createElement(\"button\");\n        button.id = this._addUID(\"GPshowIsoExclusionsPicto\");\n        var hidden = \"\";\n        if (checkDsfr()) {\n            hidden = \"GPelementHidden gpf-hidden\";\n        }\n        button.className = `GPshowAdvancedToolPicto GPshowMoreOptionsImage GPshowMoreOptions GPshowIsoExclusionsPicto ${hidden} gpf-btn fr-btn--sm fr-btn--tertiary gpf-btn--tertiary fr-icon-arrow-down-fill`;\n        button.title = \"Exclusions\";\n        // button.style.top = \"240px\";\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", true);\n\n        // Close all results and panels when minimizing the widget\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                e.preventDefault();\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                self.onShowIsoSettingsClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                e.preventDefault();\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                self.onShowIsoSettingsClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    /**\n     * Create Container to Exclusions\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormExclusionsElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisoExclusions\");\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisoExclusionsLabel gpf-label fr-label\";\n        label.innerHTML = \"Passages autorisés\";\n        div.appendChild(label);\n\n        // div.appendChild(this._createIsoPanelFormExclusionOptionsElement());\n\n        return div;\n    },\n\n    /**\n     * Create Exclusions Options\n     * see event !\n     * FIXME event not useful\n     * @param {Array} exclusions - exclusions to display in list\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormExclusionOptionsElement : function (exclusions) {\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisoExclusionsOptions gpf-flex fr-checkbox-group fr-m-1w\";\n\n        /* jshint -W083 */\n        for (var value in exclusions) {\n            if (exclusions.hasOwnProperty(value)) {\n                var status = exclusions[value];\n                switch (value) {\n                    case \"toll\":\n                        var inputToll = document.createElement(\"input\");\n                        inputToll.id = this._addUID(\"GPisoExclusionsToll\");\n                        inputToll.type = \"checkbox\";\n                        inputToll.name = \"Péages\";\n                        inputToll.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputToll.addEventListener) {\n                            inputToll.addEventListener(\"change\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputToll.attachEvent) {\n                            inputToll.attachEvent(\"onchange\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputToll.value = \"Toll\";\n                        div.appendChild(inputToll);\n\n                        var labelToll = document.createElement(\"label\");\n                        labelToll.className = \"GPisoExclusionsOption\";\n                        labelToll.htmlFor = this._addUID(\"GPisoExclusionsToll\");\n                        labelToll.innerHTML = \"Péages\";\n                        div.appendChild(labelToll);\n                        break;\n\n                    case \"tunnel\":\n                        var inputTunnel = document.createElement(\"input\");\n                        inputTunnel.id = this._addUID(\"GPisoExclusionsTunnel\");\n                        inputTunnel.type = \"checkbox\";\n                        inputTunnel.name = \"Tunnel\";\n                        inputTunnel.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputTunnel.addEventListener) {\n                            inputTunnel.addEventListener(\"change\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputTunnel.attachEvent) {\n                            inputTunnel.attachEvent(\"onchange\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputTunnel.value = \"Tunnel\";\n                        div.appendChild(inputTunnel);\n\n                        var labelTunnel = document.createElement(\"label\");\n                        labelTunnel.className = \"GPisoExclusionsOption\";\n                        labelTunnel.htmlFor = this._addUID(\"GPisoExclusionsTunnel\");\n                        labelTunnel.innerHTML = \"Tunnels\";\n                        div.appendChild(labelTunnel);\n                        break;\n\n                    case \"bridge\":\n                        var inputBridge = document.createElement(\"input\");\n                        inputBridge.id = this._addUID(\"GPisoExclusionsBridge\");\n                        inputBridge.type = \"checkbox\";\n                        inputBridge.name = \"Ponts\";\n                        inputBridge.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requête sur le service de calcul d'itiniraire\n                        if (inputBridge.addEventListener) {\n                            inputBridge.addEventListener(\"change\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputBridge.attachEvent) {\n                            inputBridge.attachEvent(\"onchange\", function (e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputBridge.value = \"Bridge\";\n                        div.appendChild(inputBridge);\n\n                        var labelBridge = document.createElement(\"label\");\n                        labelBridge.className = \"GPisoExclusionsOption\";\n                        labelBridge.htmlFor = this._addUID(\"GPisoExclusionsBridge\");\n                        labelBridge.innerHTML = \"Ponts\";\n                        div.appendChild(labelBridge);\n                        break;\n                }\n            }\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############################### Submit Form ####################### //\n    // ################################################################### //\n\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoSubmitFormElement : function () {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronSubmit\");\n        input.className = \"GPsubmit gpf-btn fr-btn\";\n        input.type = \"submit\";\n        input.value = \"Calculer l'isochrone\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ############################### Reset picto ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Reset Picto Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoFormResetElement : function () {\n        var self = this;\n\n        var buttonReset = document.createElement(\"button\");\n        buttonReset.id = this._addUID(\"GPisochronReset\");\n        buttonReset.className = \"GPresetPicto GPisochronReset gpf-btn gpf-btn-icon-reset gpf-btn-icon-isocurve-reset fr-btn fr-btn--secondary gpf-btn--secondary\";\n        buttonReset.title = \"Réinitialiser les paramètres\";\n        buttonReset.setAttribute(\"tabindex\", \"0\");\n        buttonReset.setAttribute(\"aria-pressed\", false);\n\n        buttonReset.addEventListener(\"click\", function (e) {\n            var status = (e.target.ariaPressed === \"true\");\n            e.target.setAttribute(\"aria-pressed\", !status);\n            self.onIsoResetClick(e);\n        });\n\n        return buttonReset;\n    }\n};\n\nexport default IsoDOM;\n","// import CSS\nimport \"../../CSS/Controls/Isochron/GPFisochron.css\";\n// import \"../../CSS/Controls/Isochron/GPFisochronStyle.css\";\n// import OpenLayers\n// import Control from \"ol/control/Control\";\nimport Widget from \"../Widget\";\nimport Control from \"../Control\";\nimport { unByKey as olObservableUnByKey } from \"ol/Observable\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\n// import GeoJSON from \"ol/format/GeoJSON\";\nimport {\n    Fill,\n    Stroke,\n    Style\n} from \"ol/style\";\n// import geoportal library access\nimport Gp from \"geoportal-access-lib\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport SelectorID from \"../../Utils/SelectorID\";\nimport Markers from \"../Utils/Markers\";\nimport Draggable from \"../../Utils/Draggable\";\nimport Interactions from \"../Utils/Interactions\";\nimport MathUtils from \"../../Utils/MathUtils\";\n// import local with ol dependencies\nimport LayerSwitcher from \"../LayerSwitcher/LayerSwitcher\";\nimport LocationSelector from \"../LocationSelector/LocationSelector\";\nimport ButtonExport from \"../Export/Export\";\nimport GeoJSONExtended from \"../../Formats/GeoJSON\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\n// DOM\nimport IsocurveDOM from \"./IsocurveDOM\";\n\nvar logger = Logger.getLogger(\"isocurve\");\n\n/**\n * @classdesc\n *\n * Isocurve Control.\n *\n * @constructor\n * @alias ol.control.Isocurve\n * @type {ol.control.Isocurve}\n * @extends {ol.control.Control}\n * @param {Object} options - Isocurve control options\n * @param {Number} [options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {String} [options.apiKey] - API key for services call (isocurve and autocomplete services). The key \"calcul\" is used by default.\n * @param {Boolean} [options.ssl = true] - use of ssl or not (default true, service requested using https protocol)\n * @param {Boolean} [options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Boolean} [options.draggable = false] - Specify if widget is draggable\n * @param {Boolean|Object} [options.export = false] - Specify if button \"Export\" is displayed. For the use of the options of the \"Export\" control, see {@link ol.control.Export}\n * @param {Object}  [options.exclusions = {\"toll\" : false, \"tunnel\" : false, \"bridge\" : false}] - list of exclusions with status (true = checked). By default : no exclusions checked.\n * @param {Array}   [options.graphs = [\"Voiture\", \"Pieton\"]] - list of graph resources to be used for isocurve calculation, by default : [\"Voiture\", \"Pieton\"]. Possible values are \"Voiture\" and \"Pieton\". The first element is selected.\n * @param {Array}   [options.methods = [\"time\", \"distance\"]] - list of methods, by default : [\"time\", \"distance\"]. Possible values are \"time\" and \"distance\". The first element is selected by default.\n * @param {Array}   [options.directions = [\"departure\", \"arrival\"]] - list of directions to be displayed, by default : [\"departure\", \"arrival\"]. The first element is selected by default. Possible values are \"departure\" and \"arrival\".\n *      Directions enable to specify if input location point will be used as a departure point (\"departure\") or as an arrival point (\"arrival\")\n * @param {Object} [options.isocurveOptions = {}] - isocurve service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~isoCurve Gp.Services.isoCurve()} to know all isocurve options.\n * @param {Object} [options.autocompleteOptions = {}] - autocomplete service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options\n * @param {Object} [options.markerOpts] - options to use your own marker. Default is a lightOrange marker.\n * @param {String} [options.markerOpts.url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.markerOpts.offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see http://openlayers.org/en/latest/apidoc/ol.Overlay.html)\n * @param {Object} [options.layerDescription = {}] - Layer informations to be displayed in LayerSwitcher widget (only if a LayerSwitcher is also added to the map)\n * @param {String} [options.layerDescription.title = \"Isochrone/Isodistance\"] - Layer title to be displayed in LayerSwitcher\n * @param {String} [options.layerDescription.description = \"isochrone/isodistance basé sur un graphe\"] - Layer description to be displayed in LayerSwitcher\n * @fires isocurve:drawstart\n * @fires isocurve:drawend\n * @fires isocurve:compute\n * @fires export:compute\n * @example\n *  var iso = ol.control.Isocurve({\n *      \"collapsed\" : false,\n *      \"draggable\" : true,\n *      \"export\"    : false,\n *      \"methods\" : [\"time\", \"distance\"],\n *      \"exclusions\" : {\n *         \"toll\" : true,\n *         \"bridge\" : false,\n *         \"tunnel\" : true\n *      },\n *      \"graphs\" : [\"Pieton\", \"Voiture\"],\n *      \"markerOpts\" : {\n *          \"url\" : \"...\",\n *          \"offset\" : [0,0]\n *      }\n *      \"isocurveOptions\" : {},\n *      \"autocompleteOptions\" : {}\n *  });\n *\n *  // if you want to pluggued the control Export with options :\n *  var iso = new ol.control.Isocurve({\n *    export : {\n *      name : \"export\",\n *      format : \"geojson\",\n *      title : \"Exporter\",\n *      menu : false\n *    }\n *  });\n */\nvar Isocurve = class Isocurve extends Control {\n\n    /**\n     * See {@link ol.control.Isocurve}\n     * @module Isocurve\n     * @alias module:~controls/Isocurve\n     * @param {*} options - options\n     * @example\n     * import Isocurve from from \"gpf-ext-ol/controls/Isocurve\"\n     * ou\n     * import { Isocurve } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {};\n\n        // call ol.control.Control constructor\n        super(options);\n\n        if (!(this instanceof Isocurve)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"Isocurve\";\n        // initialisation du composant\n        this.initialize(options);\n\n        // // Widget main DOM container\n        this._container = this._createMainContainerElement();\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this._container) : this.element = this._container;\n\n        return this;\n    }\n\n    /**\n     * Overwrite OpenLayers setMap method\n     *\n     * @param {ol.Map} map - Map.\n     */\n    setMap (map) {\n        if (map) {\n            // enrichissement du DOM du container lors de l'ajout à la carte\n            this._container = this._initContainer(map);\n\n            // ajout d'un bouton d'export\n            if (this.options.export) {\n                var opts = Utils.assign({ control : this }, this.options.export);\n                this.export = new ButtonExport(opts);\n                this.export.render();\n                var self = this;\n                this.export.on(\"button:clicked\", (e) => {\n                    self.dispatchEvent({\n                        type : \"export:compute\",\n                        content : e.content\n                    });\n                });\n            }\n\n            // mode \"draggable\"\n            if (this.draggable) {\n                Draggable.dragElement(\n                    this._IsoPanelContainer,\n                    this._IsoPanelHeaderContainer,\n                    map.getTargetElement()\n                );\n            }\n\n            // mode \"collapsed\"\n            if (!this.collapsed) {\n                this._pictoIsoButton.setAttribute(\"aria-pressed\", true);\n            }\n        }\n\n        // on appelle la méthode setMap originale d'OpenLayers\n        super.setMap(map);\n\n        // position\n        if (this.options.position) {\n            this.setPosition(this.options.position);\n        }\n\n        // reunion du bouton avec le précédent\n        if (this.options.gutter === false) {\n            this.getContainer().classList.add(\"gpf-button-no-gutter\");\n        }\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n\n    /**\n     * Returns true if widget is collapsed (minimized), false otherwise\n     *\n     * @returns {Boolean} collapsed - true if widget is collapsed\n     */\n    getCollapsed () {\n        return this.collapsed;\n    }\n\n    /**\n     * Collapse or display widget main container\n     *\n     * @param {Boolean} collapsed - True to collapse widget, False to display it\n     */\n    setCollapsed (collapsed) {\n        if (collapsed === undefined) {\n            logger.log(\"[ERROR] Isocurve:setCollapsed - missing collapsed parameter\");\n            return;\n        }\n        if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n            return;\n        }\n        if (collapsed) {\n            document.getElementById(\"GPisochronPanelClose-\" + this._uid).click();\n        } else {\n            this._pictoIsoButton.click();\n        }\n        this.collapsed = collapsed;\n    }\n\n    /**\n     * Get vector layer where Isocurve geometry is drawn\n     *\n     * @returns {Object} layer - ol.layer.Vector isocurve layer\n     */\n    getLayer () {\n        return this._geojsonLayer;\n    }\n\n    /**\n     * Set vector layer where Isocurve geometry is drawn\n     *\n     * @param {Object} layer - ol.layer.Vector isocurve layer\n     */\n    setLayer (layer) {\n        if (!layer) {\n            this._geojsonLayer = null;\n            return;\n        }\n\n        if (!(layer instanceof VectorLayer)) {\n            logger.log(\"no valid layer given for hosting drawn features.\");\n            return;\n        }\n\n        // application des styles\n        layer.setStyle(this._defaultFeatureStyle);\n\n        // sauvegarde\n        this._geojsonLayer = layer;\n    }\n\n    /**\n     * Get vector layer\n     *\n     * @returns {String} geojson - GeoJSON format layer\n     */\n    getGeoJSON () {\n        return JSON.stringify(this._geojsonObject);\n    }\n\n    /**\n     * Set vector layer\n     *\n     * @param {String} geojson - GeoJSON format layer\n     */\n    setGeoJSON (geojson) {\n        try {\n            this._geojsonObject = JSON.parse(geojson);\n        } catch (e) {\n            logger.log(\"no valid geojson given :\" + e.message);\n        }\n    }\n\n    /**\n     * Get isocurve data\n     *\n     * @returns {Object} data - process results\n     */\n    getData () {\n        var data = {\n            type : \"isocurve\",\n            transport : this._currentTransport,\n            computation : this._currentComputation,\n            exclusions : this._currentExclusions,\n            direction : this._currentDirection,\n            point : this._originPoint.getCoordinate(), // lon/lat wgs84\n            results : {}\n        };\n        Utils.assign(data.results, this._currentIsoResults);\n        return data;\n    }\n\n    /**\n     * Set isocurve data\n     *\n     * @param {Object} data - control informations\n     * @param {String} data.transport - transport type\n     * @param {String} data.computation - computation type\n     * @param {Array} data.exclusions - list of exclusions\n     * @param {String} data.direction - direction type\n     * @param {Array} data.point - [lon, lat]\n     * @param {Object} data.results - service response\n     */\n    setData (data) {\n        this._currentTransport = data.transport;\n        this._currentComputation = data.computation;\n        this._currentExclusions = data.exclusions;\n        this._currentDirection = data.direction;\n        // INFO\n        // > this._originPoint.clear();\n        // l'utilisation de cette méthode declenche des evenements qui retirent la couche en cours !\n        // (cf. _createIsoPanelFormPointElement),\n        var inputPointer = document.getElementById(\"GPlocationOriginPointer_\" + 1 + \"-\" + this._uid);\n        inputPointer.checked = true;\n        var inputCoordsDOM = document.getElementById(\"GPlocationOrigin_\" + 1 + \"-\" + this._uid);\n        var inputCoords = document.getElementById(\"GPlocationOriginCoords_\" + 1 + \"-\" + this._uid);\n        inputCoords.value = data.point;\n        inputCoordsDOM.value = data.point[1].toFixed(4) + \" / \" + data.point[0].toFixed(4);\n        this._originPoint.setCoordinate(data.point, \"EPSG:4326\");\n        this._currentIsoResults = data.results;\n    }\n\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this._container;\n    }\n\n    /**\n     * Get default style\n     *\n     * @returns {ol.style} style\n     */\n    getStyle () {\n        return this._defaultFeatureStyle;\n    }\n\n    /**\n     * This method is public.\n     * It allows to control the execution of a traitment.\n     *\n     * @param {Array} position - position in the projection map [ x, y ]\n     * @param {Object} value - distance in km or hours-minutes\n     * @param {Object} options - options = {...}\n     */\n    compute (position, value, options) {\n        this._clear();\n\n        var opened = this._pictoIsoButton.ariaPressed;\n        if (!(opened === \"true\")) {\n            this._pictoIsoButton.click();\n        }\n\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        // Les options par defauts\n        var settings = {\n            direction : \"departure\",\n            method : \"time\",\n            transport : \"Voiture\",\n            exclusions : []\n        };\n\n        // On recupere les options\n        Utils.assign(settings, options);\n\n        this._originPoint.setCoordinate(position);\n        var coordinate = this._originPoint.getCoordinate();\n\n        var input = document.getElementById(\"GPlocationOrigin_\" + 1 + \"-\" + this._uid);\n        input.value = coordinate[0].toFixed(4) + \" / \" + coordinate[1].toFixed(4);\n\n        this._currentTransport = settings.transport;\n        if (settings.transport === \"Voiture\") {\n            document.getElementById(\"GPisochronTransportCar-\" + this._uid).checked = true;\n        } else {\n            document.getElementById(\"GPisochronTransportPedestrian-\" + this._uid).checked = true;\n        }\n\n        this._currentExclusions = settings.exclusions;\n\n        this._currentComputation = settings.method;\n        if (settings.method === \"time\") {\n            var time = value.split(\".\");\n            this._currentTimeHour = time[0] || 0;\n            document.getElementById(\"GPisochronValueChronInput1-\" + this._uid).value = this._currentTimeHour;\n            this._currentTimeMinute = time[1] || 0;\n            document.getElementById(\"GPisochronValueChronInput2-\" + this._uid).value = this._currentTimeMinute;\n            document.getElementById(\"GPisochronChoiceAltChron-\" + this._uid).click();\n        } else {\n            this._currentDistance = value;\n            document.getElementById(\"GPisochronValueDistInput-\" + this._uid).value = this._currentDistance;\n            document.getElementById(\"GPisochronChoiceAltDist-\" + this._uid).click();\n        }\n\n        this._currentDirection = settings.direction;\n        (settings.direction === \"departure\")\n            ? document.getElementById(\"GPisochronDirectionSelect-\" + this._uid).selectedIndex = 0 : document.getElementById(\"GPisochronDirectionSelect-\" + this._uid).selectedIndex = 1;\n\n        this.onIsoComputationSubmit();\n    }\n\n    /**\n     * This method is public.\n     * It allows to init the control.\n     */\n    init () {\n        // point\n        var coordinate = this._originPoint.getCoordinate();\n\n        var input = document.getElementById(\"GPlocationOrigin_\" + 1 + \"-\" + this._uid);\n        input.value = coordinate[1].toFixed(4) + \" / \" + coordinate[0].toFixed(4);\n\n        // transport\n        if (this._currentTransport === \"Voiture\") {\n            document.getElementById(\"GPisochronTransportCar-\" + this._uid).checked = true;\n        } else {\n            document.getElementById(\"GPisochronTransportPedestrian-\" + this._uid).checked = true;\n        }\n\n        // method\n        if (this._currentComputation === \"time\") {\n            var minutes = this._currentIsoResults.time / 60;\n            this._currentTimeHour = Math.floor(minutes / 60);\n            document.getElementById(\"GPisochronValueChronInput1-\" + this._uid).value = this._currentTimeHour;\n            this._currentTimeMinute = Math.round(((minutes / 60) - this._currentTimeHour) * 60);\n            document.getElementById(\"GPisochronValueChronInput2-\" + this._uid).value = this._currentTimeMinute;\n            document.getElementById(\"GPisochronChoiceAltChron-\" + this._uid).click();\n        } else {\n            this._currentDistance = this._currentIsoResults.distance / 1000;\n            document.getElementById(\"GPisochronValueDistInput-\" + this._uid).value = this._currentDistance;\n            document.getElementById(\"GPisochronChoiceAltDist-\" + this._uid).click();\n        }\n\n        // direction\n        (this._currentDirection === \"departure\")\n            ? document.getElementById(\"GPisochronDirectionSelect-\" + this._uid).selectedIndex = 0 : document.getElementById(\"GPisochronDirectionSelect-\" + this._uid).selectedIndex = 1;\n    \n        this._resultsIsoContainer.className = \"\";\n    }\n\n    /**\n     * Clean UI : reinit control\n     */\n    clean () {\n        this._clearIsoInputs();\n        // INFO\n        // le comportement est surchargé, ceci supprime la couche !?\n        // cf. _createIsoPanelFormPointElement()\n        this._originPoint.clearResults();\n        document.getElementById(\"GPlocationPoint_1-\" + this._uid).style.cssText = \"\";\n        document.getElementById(\"GPlocationOriginCoords_1-\" + this._uid).value = \"\";\n        document.getElementById(\"GPlocationOrigin_1-\" + this._uid).value = \"\";\n        document.getElementById(\"GPlocationPoint_1-\" + this._uid).style.cssText = \"\";\n        document.getElementById(\"GPlocationOriginPointer_1-\" + this._uid).checked = false;\n        document.getElementById(\"GPlocationOrigin_1-\" + this._uid).className = \"GPlocationOriginVisible gpf-visible\";\n        document.getElementById(\"GPlocationOriginCoords_1-\" + this._uid).className = \"GPlocationOriginHidden gpf-hidden\";\n        this._currentIsoResults = null;\n        this.setLayer();\n\n        this._resultsIsoContainer.className = \"GPelementHidden gpf-hidden\";\n    }\n\n    // ################################################################### //\n    // ##################### init component ############################## //\n    // ################################################################### //\n\n    /**\n     * Initialize Isocurve control (called by Isocurve constructor)\n     *\n     * @param {Object} options - constructor options\n     * @private\n     */\n    initialize (options) {\n        this._checkInputOptions(options);\n\n        // set default options\n        this.options = {\n            collapsed : true,\n            draggable : false,\n            export : false,\n            methods : [\"time\", \"distance\"],\n            graphs : [\"Pieton\", \"Voiture\"],\n            exclusions : {\n                toll : false,\n                tunnel : false,\n                bridge : false\n            },\n            directions : [\"departure\", \"arrival\"],\n            markerOpts : {\n                url : Markers[\"lightOrange\"],\n                offset : Markers.defaultOffset\n            },\n            isocurveOptions : {},\n            autocompleteOptions : {},\n            layerDescription : {\n                title : \"Isochrone/Isodistance\",\n                description : \"isochrone/isodistance basé sur un graphe\"\n            }\n        };\n\n        // merge with user options\n        Utils.assign(this.options, options);\n\n        /** {Boolean} specify if isocurve control is collapsed (true) or not (false) */\n        this.collapsed = this.options.collapsed;\n\n        /** {Boolean} specify if isocurve control is draggable (true) or not (false) */\n        this.draggable = this.options.draggable;\n\n        // identifiant du contrôle : utile pour suffixer les identifiants CSS (pour gérer le cas où il y en a plusieurs dans la même page)\n        this._uid = this.options.id || SelectorID.generate();\n\n        // Options du service paramétrables via l'interface (graph, method, exclusions)\n        // Mode de transport selectionné : 'Voiture' ou 'Pieton'\n        this._currentTransport = null;\n        this._initTransport();\n        // Mode de calcul selectionné : 'time' (isochron) ou 'distance' (isodistance)\n        this._currentComputation = null;\n        this._initComputation();\n        // Exclusions selectionnées : Tunnel, Toll et Bridge\n        this._currentExclusions = [];\n        this._initExclusions();\n        // sens de parcours : \"departure\" ou \"arrival\"\n        this._currentDirection = null;\n        this._initDirection();\n\n        // point de saisie\n        this._originPoint = null;\n\n        // containers principaux\n        this._pictoIsoButton = null;\n        this._waitingContainer = null;\n        this._formContainer = null;\n        this._resultsIsoContainer = null;\n        this._IsoPanelContainer = null;\n        this._IsoPanelHeaderContainer = null;\n\n        // les résultats du calcul\n        this._currentIsoResults = null;\n\n        // la géométrie\n        this._geojsonLayer = null;\n        this._geojsonObject = null;\n\n        // bouton export\n        this.export = null;\n\n        // si un calcul est en cours ou non\n        this._waiting = false;\n        // timer pour cacher la patience après un certain temps\n        this._timer = null;\n\n        // styles pour les sélections des features\n        this._defaultFeatureStyle = new Style({\n            fill : new Fill({\n                color : \"rgba(0, 183, 152, 0.7)\"\n            }),\n            stroke : new Stroke({\n                color : \"rgba(0, 183, 152, 0)\",\n                width : 1\n            })\n        });\n\n        // liste des ressources avec droits par service\n        // Ex. {\n        //   \"Isocurve\" : {\n        //       key : \"ger4g456re45er456t4er5ge5\",\n        //       resources : [\"Pieton\", \"Voiture\"]\n        //   }\n        // }\n        this._resources = {};\n\n        // listener key for event click on map\n        this.listenerKey = null;\n    }\n\n    /**\n     * this method is called by this.initialize()\n     *\n     * @param {Object} options - options\n     *\n     * @private\n     */\n    _checkInputOptions (options) {\n        // vérification des options\n        // on ne permet pas de n'afficher aucun mode de calcul ou aucun mode de transport ?\n        var i;\n\n        // modes de calcul\n        if (options.methods) {\n            if (Array.isArray(options.methods)) {\n                // on ne permet pas de passer un tableau vide : on spécifie au moins une méthode\n                if (options.methods.length === 0) {\n                    options.methods = null;\n                } else {\n                    for (i = 0; i < options.methods.length; i++) {\n                        if (typeof options.methods[i] !== \"string\") {\n                            logger.log(\"[ol.control.Isocurve] ERROR : parameter 'methods' elements should be of type 'string'\");\n                        }\n                    }\n                }\n            } else {\n                logger.warn(\"'methods' parameter should be an array\");\n                options.methods = null;\n            }\n        }\n\n        // mode de transport\n        if (options.graphs) {\n            if (Array.isArray(options.graphs)) {\n                // on ne permet pas de passer un tableau vide : on spécifie au moins un graph\n                if (options.graphs.length === 0) {\n                    options.graphs = null;\n                } else {\n                    for (i = 0; i < options.graphs.length; i++) {\n                        if (typeof options.graphs[i] !== \"string\") {\n                            logger.log(\"[ol.control.Isocurve] ERROR : parameter 'graphs' elements should be of type 'string'\");\n                        } else {\n                            if (options.graphs[i].toLowerCase() === \"pieton\") {\n                                options.graphs[i] = \"Pieton\";\n                            }\n                            if (options.graphs[i].toLowerCase() === \"voiture\") {\n                                options.graphs[i] = \"Voiture\";\n                            }\n                        }\n                    }\n                }\n            } else {\n                logger.warn(\"'graphs' parameter should be an array\");\n                options.graphs = null;\n            }\n        }\n\n        // sens du parcours\n        if (options.directions) {\n            if (Array.isArray(options.directions)) {\n                // on ne permet pas de passer un tableau vide : on spécifie au moins une direction\n                if (options.directions.length === 0) {\n                    options.directions = null;\n                } else {\n                    for (i = 0; i < options.directions.length; i++) {\n                        if (typeof options.directions[i] !== \"string\") {\n                            logger.log(\"[ol.control.Isocurve] ERROR : parameter 'directions' elements should be of type 'string'\");\n                        }\n                    }\n                }\n            } else {\n                logger.warn(\"'directions' parameter should be an array\");\n                options.directions = null;\n            }\n        }\n\n        // collapsed\n        if (options.collapsed === \"true\") {\n            options.collapsed = true;\n        }\n        if (options.collapsed === \"false\") {\n            options.collapsed = false;\n        }\n    }\n\n    /**\n     * this method is called by this.initialize() and initialize transport mode\n     * (\"Voiture\" ou \"Pieton\")\n     *\n     * @private\n     */\n    _initTransport () {\n        // Mode de transport selectionné\n        this._currentTransport = \"Piéton\"; // par defaut\n\n        // par defaut\n        var transports = this.options.graphs;\n        if (!transports || transports.length === 0) {\n            this.options.graphs = [\"Pieton\", \"Voiture\"];\n        }\n\n        // option\n        if (Array.isArray(transports) && transports.length) {\n            // FIXME pb si le 1er graphe n'est pas une ressource connue !\n            if (transports[0] === \"Voiture\" || transports[0] === \"Pieton\") {\n                this._currentTransport = transports[0];\n            }\n        }\n\n        // si l'utilisateur a spécifié un graph dans le service, on surcharge les options du widget\n        var serviceOptions = this.options.isocurveOptions;\n        if (serviceOptions.graph) {\n            this._currentTransport = serviceOptions.graph;\n        }\n    }\n\n    /**\n     * this method is called by this.initialize() and initialize computation mode\n     * (time or distance)\n     *\n     * @private\n     */\n    _initComputation () {\n        // Mode de calcul selectionné\n        this._currentComputation = \"time\"; // par defaut\n\n        // par defaut\n        var methods = this.options.methods;\n        if (!methods || methods.length === 0) {\n            this.options.methods = [\"time\", \"distance\"];\n        }\n\n        // option\n        if (Array.isArray(methods) && methods.length) {\n            // FIXME pb si le 1er graphe n'est pas une ressource connue !\n            if (methods[0] === \"time\" || methods[0] === \"distance\") {\n                this._currentComputation = methods[0];\n            }\n        }\n\n        // si l'utilisateur a spécifié une méthode dans le service, on surcharge les options du widget\n        var serviceOptions = this.options.isocurveOptions;\n        if (serviceOptions.method) {\n            this._currentComputation = serviceOptions.method;\n        }\n        if (serviceOptions.time) {\n            this._currentComputation = \"time\";\n        }\n        if (serviceOptions.distance) {\n            this._currentComputation = \"distance\";\n        }\n    }\n\n    /**\n     * this method is called by this.initialize() and initialize direction mode\n     * (departure or arrival)\n     *\n     * @private\n     */\n    _initDirection () {\n        // Mode de calcul selectionné\n        this._currentDirection = \"departure\"; // par defaut\n\n        // par defaut\n        var directions = this.options.directions;\n        if (!directions || directions.length === 0) {\n            this.options.directions = [\"departure\", \"arrival\"];\n        }\n\n        // option\n        if (Array.isArray(directions) && directions.length) {\n            // FIXME pb si le 1er graphe n'est pas une ressource connue !\n            if (directions[0] === \"departure\" || directions[0] === \"arrival\") {\n                this._currentDirection = directions[0];\n            }\n        }\n\n        // si l'utilisateur a spécifié une méthode dans le service, on surcharge les options du widget\n        var serviceOptions = this.options.isocurveOptions;\n        if (!serviceOptions.reverse) {\n            this._currentDirection = \"departure\";\n        }\n        if (serviceOptions.reverse === true) {\n            this._currentDirection = \"arrival\";\n            this.options.directions = [\"arrival\", \"departure\"];\n        }\n    }\n\n    /**\n     * this method is called by this.initialize() and initialize exclusions\n     *\n     * @private\n     */\n    _initExclusions () {\n        // Exclusions selectionnées : Tunnel, Toll et Bridge\n        this._currentExclusions = []; // par defaut\n\n        // par defaut\n        var exclusion = this.options.exclusions;\n        if (!exclusion || (typeof exclusion === \"object\" && Object.keys(exclusion).length === 0)) {\n            this.options.exclusions = {\n                toll : false,\n                tunnel : false,\n                bridge : false\n            };\n        }\n\n        // option\n        if (exclusion && typeof exclusion === \"object\" && Object.keys(exclusion).length) {\n            for (var k in exclusion) {\n                if (exclusion.hasOwnProperty(k)) {\n                    if (exclusion.k) {\n                        this._currentExclusions.push(k);\n                    }\n                }\n            }\n        }\n\n        // si l'utilisateur a spécifié des exclusions dans le service, on surcharge les options du widget\n        var serviceOptions = this.options.isocurveOptions;\n        if (Array.isArray(serviceOptions.exclusions)) {\n            this._currentExclusions = serviceOptions.exclusions;\n        }\n    }\n\n    // ################################################################### //\n    // ######################## DOM initialize ########################### //\n    // ################################################################### //\n\n    /**\n     * initialize component container (DOM)\n     *\n     * @param {Object} map - the map\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     */\n    _initContainer (map) {\n        // get main container\n        var container = this._container;\n        if (container.childElementCount > 0) {\n            return container;\n        }\n\n        var picto = this._pictoIsoButton = this._createShowIsoPictoElement();\n        container.appendChild(picto);\n\n        // panneau\n        var panel = this._IsoPanelContainer = this._createIsoPanelElement();\n        var panelDiv = this._createIsoPanelDivElement();\n        panel.appendChild(panelDiv);\n\n        // header\n        var header = this._IsoPanelHeaderContainer = this._createIsoPanelHeaderElement();\n        panelDiv.appendChild(header);\n\n        // form\n        var form = this._formContainer = this._createIsoPanelFormElement();\n\n        form.appendChild(this._createIsoPanelFormModeChoiceTransportElement(this.options.graphs));\n\n        // form: input de saisie de la localisation (fonction de Isocurve, voir ci-dessous)\n        form.appendChild(this._createIsoPanelFormPointLabel());\n        var point = this._createIsoPanelFormPointElement(map);\n        form.appendChild(point);\n\n        var isoChronChecked = false;\n        var isoDistChecked = false;\n        var typeChoice = this._createIsoPanelFormTypeChoiceElement();\n        for (var i = 0; i < this.options.methods.length; i++) {\n            if (this.options.methods[i] === \"time\") {\n                isoChronChecked = (i === 0);\n                typeChoice.appendChild(this._createIsoPanelFormTypeChoiceChronElement(isoChronChecked));\n            }\n            if (this.options.methods[i] === \"distance\") {\n                isoDistChecked = (i === 0);\n                typeChoice.appendChild(this._createIsoPanelFormTypeChoiceDistElement(isoDistChecked));\n            }\n        }\n        form.appendChild(typeChoice);\n\n        // form: menu du choix des valeurs\n        form.appendChild(this._createIsoPanelFormLabelIsochronElement(isoChronChecked));\n        form.appendChild(this._createIsoPanelFormValueIsochronElement(isoChronChecked));\n        form.appendChild(this._createIsoPanelFormLabelIsodistanceElement(isoDistChecked));\n        form.appendChild(this._createIsoPanelFormValueIsodistanceElement(isoDistChecked));\n\n        // FIXME : doit on passer le paramètre defaultDirection ?\n        form.appendChild(this._createIsoPanelFormModeChoiceDirectionElement(this.options.directions));\n\n        // form: menu des exclusions\n        if (this.options.exclusions && (typeof this.options.exclusions === \"object\") && (Object.keys(this.options.exclusions).length !== 0)) {\n            form.appendChild(this._createShowIsoExclusionsPictoElement());\n            var exclusion = this._createIsoPanelFormExclusionsElement();\n            exclusion.appendChild(this._createIsoPanelFormExclusionOptionsElement(this.options.exclusions));\n            form.appendChild(exclusion);\n        }\n\n        // footer\n        var footer = this._createIsoPanelFooterElement();\n        form.appendChild(footer);\n\n        if (!checkDsfr()) {\n            var buttonReset = this._createIsoFormResetElement();\n            footer.appendChild(buttonReset);\n        }\n\n        // form: bouton du calcul\n        var buttonSubmit = this._submitContainer = this._createIsoSubmitFormElement();\n        footer.appendChild(buttonSubmit);\n\n        panelDiv.appendChild(form);\n\n        // panel results\n        var isoResults = this._resultsIsoContainer = this._createIsoPanelResultsElement();\n        panelDiv.appendChild(isoResults);\n\n        var plugin = this._createDrawingButtonsPluginDiv();\n        panelDiv.appendChild(plugin);\n        \n        // waiting\n        var waiting = this._waitingContainer = this._createIsoWaitingElement();\n        panel.appendChild(waiting);\n\n        container.appendChild(panel);\n\n        // hide autocomplete suggested locations on container click\n        if (container.addEventListener) {\n            container.addEventListener(\"click\", (e) => this._hideIsoSuggestedLocations(e));\n        }\n\n        return container;\n    }\n\n    /**\n     * Create start point\n     *\n     * @param {Object} map - the map\n     *\n     * @returns {Object} DOM element\n     * @private\n     */\n    _createIsoPanelFormPointElement (map) {\n        this._originPoint = new LocationSelector({\n            apiKey : this.options.apiKey || null,\n            tag : {\n                id : 1,\n                groupId : this._uid,\n                markerOpts : this.options.markerOpts,\n                display : true\n            },\n            autocompleteOptions : this.options.autocompleteOptions || null\n        });\n        this._originPoint.setMap(map);\n        // a la sélection d'un nouveau point, on réinitialise aussi le tracé\n        var self = this;\n        // click sur le pointer\n        document.getElementById(\"GPlocationOriginPointerImg_1-\" + this._uid).onclick = function () {\n            self._clearGeojsonLayer();\n            var map = self.getMap();\n            if (self._originPoint._inputShowPointerContainer.checked) {\n                // au click sur l'input pour pointer sur la carte: on minimise le formulaire\n                self._formContainer.className = \"GPisochronFormMini gpf-panel__content fr-modal__content\";\n                // et au clic sur la carte, on réaffichera le formulaire \"normal\"\n                this.listenerKey = map.on(\n                    \"click\",\n                    () => {\n                        self._formContainer.className = \"gpf-panel__content fr-modal__content\";\n                        self.dispatchEvent(\"isocurve:drawend\");\n                    }\n                );\n            } else {\n                // si on déselectionne le pointer, on rétablit le formulaire en mode normal\n                self._formContainer.className = \"gpf-panel__content fr-modal__content\";\n                // et on enlève l'écouteur d'évènement sur la carte\n                // map.un(\"click\", () => { self._formContainer.className = \"\"; });\n                olObservableUnByKey(this.listenerKey);\n            }\n            /**\n            * event triggered at the start of drawing input\n            *\n            * @event isocurve:drawstart\n            */\n            self.dispatchEvent(\"isocurve:drawstart\");\n        };\n        // click sur le label\n        document.getElementById(\"GPlocationOriginLabel_1-\" + this._uid).onclick = function () {\n            self._clearGeojsonLayer();\n            self._formContainer.className = \"gpf-panel__content fr-modal__content\";\n            // on désactive l'écouteur d'événements sur la carte (pour ne pas placer un marker au clic)\n            map.un(\n                \"click\",\n                () => {\n                    self._formContainer.className = \"gpf-panel__content fr-modal__content\";\n                }\n            );\n            self.dispatchEvent(\"isocurve:drawend\");\n        };\n        // click sur la zone de saisie\n        document.getElementById(\"GPlocationOrigin_1-\" + this._uid).onclick = function () {\n            self._clearGeojsonLayer();\n            /**\n            * event triggered at the end of drawing input\n            *\n            * @event isocurve:drawend\n            */\n            self.dispatchEvent(\"isocurve:drawend\");\n        };\n        return this._originPoint._container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'submit' on 'GPisochronForm' tag form\n     * (cf. this._createIsoPanelFormElement),\n     * and call isocurve service to display results\n     *\n     * @private\n     */\n    onIsoComputationSubmit () {\n        // si on n'a pas de valeur récupérée pour notre point origine, on ne fait rien\n        if (!this._originPoint || !this._originPoint.getCoordinate || !this._originPoint.getCoordinate()) {\n            logger.log(\"[Isocurve] Missing position parameter to submit isocurve request\");\n            return;\n        }\n\n        // récupération de l'origine\n        var positionCoordinates = this._originPoint.getCoordinate();\n        var position = {\n            x : positionCoordinates[0],\n            y : positionCoordinates[1]\n        };\n        logger.log(\"origin : \", position);\n\n        // récupération du temps ou de la distance\n        var time;\n        var distance;\n        if (this._currentComputation.toLowerCase() === \"time\") {\n            var timeHourInput = document.getElementById(\"GPisochronValueChronInput1-\" + this._uid);\n            var hours = parseInt(timeHourInput.value, 10);\n            if (isNaN && isNaN(hours)) {\n                hours = 0;\n            }\n            var timeMinutesInput = document.getElementById(\"GPisochronValueChronInput2-\" + this._uid);\n            var minutes = parseInt(timeMinutesInput.value, 10);\n            if (isNaN && isNaN(minutes)) {\n                minutes = 0;\n            }\n            // durée exprimée en secondes\n            time = hours * 3600 + minutes * 60;\n            logger.log(\"time : \" + time);\n        }\n        if (this._currentComputation.toLowerCase() === \"distance\") {\n            var distInput = document.getElementById(\"GPisochronValueDistInput-\" + this._uid);\n            // distance exprimée en mètres\n            distance = parseFloat(distInput.value) * 1000;\n            logger.log(\"distance : \" + distance);\n        }\n\n        // si on n'a pas de valeur de calcul renseignée, on ne lance pas la requête.\n        if (!time && !distance) {\n            logger.log(\"[Isocurve] Missing time or distance parameter to submit isocurve request\");\n            return;\n        }\n\n        // on recupere les éventuelles options du service passées par l'utilisateur\n        var options = this.options.isocurveOptions || {};\n\n        // gestion du protocole et du timeout\n        // le timeout est indispensable sur le protocole JSONP.\n        var _protocol = options.protocol || \"XHR\";\n        var _timeout = options.timeOut || 0;\n        if (_protocol === \"JSONP\" && _timeout === 0) {\n            // FIXME le timeout est obligatoire pour ce type de protocole...\n            _timeout = 15000;\n        }\n\n        // gestion des callback\n        var bOnFailure = !!(options.onFailure !== null && typeof options.onFailure === \"function\"); // cast variable to boolean\n        var bOnSuccess = !!(options.onSuccess !== null && typeof options.onSuccess === \"function\");\n\n        // on met en place l'affichage des resultats dans la fenetre de resultats.\n        var context = this;\n        var isoRequestOptions = {\n            position : position,\n            graph : options.graph || this._currentTransport,\n            exclusions : options.exclusions || this._currentExclusions,\n            method : options.method || this._currentComputation,\n            smoothing : options.smoothing || true,\n            timeOut : _timeout,\n            protocol : _protocol,\n            resource : options.resource,\n            // callback onSuccess\n            onSuccess : function (results) {\n                logger.log(results);\n                if (results) {\n                    context._fillIsoResultsDetails(results, isoRequestOptions);\n                    context._drawIsoResults(results);\n                }\n                if (bOnSuccess) {\n                    options.onSuccess.call(context, results);\n                }\n            },\n            // callback onFailure\n            onFailure : function (error) {\n                // FIXME mise à jour du controle mais le service ne repond pas en 200 !?\n                context._hideWaitingContainer();\n                logger.log(error.message);\n                if (bOnFailure) {\n                    options.onFailure.call(context, error);\n                }\n            }\n        };\n        if ((this._currentDirection.toLowerCase() === \"arrival\") || (options.reverse)) {\n            isoRequestOptions.reverse = true;\n        }\n        if (time) {\n            isoRequestOptions.time = time;\n        }\n        if (distance) {\n            isoRequestOptions.distance = distance;\n        }\n\n        this._requestIsoCurve(isoRequestOptions);\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPshowIsochronPicto' picto\n     * (cf. this._createShowIsoPictoElement),\n     * and clear inputs and previous isocurve drawings\n     *\n     * @param { event } e évènement associé au clic\n     * @private\n     */\n    onShowIsoPanelClick (e) {\n        var opened = this._pictoIsoButton.ariaPressed;\n        if (opened === \"true\") {\n            this.onPanelOpen();\n        }\n\n        var map = this.getMap();\n        // on supprime toutes les interactions\n        Interactions.unset(map);\n        this.collapsed = !(opened === \"true\");\n        // on génère nous même l'evenement OpenLayers de changement de propriété\n        // (utiliser ol.control.Isocurve.on(\"change:collapsed\", function ) pour s'abonner à cet évènement)\n        this.dispatchEvent(\"change:collapsed\");\n        // on recalcule la position\n        if (this.options.position && !this.collapsed) {\n            this.updatePosition(this.options.position);\n        }\n    }\n\n    /**\n     * this method is called by event 'change' on 'GPisochronChoiceAltDist' or 'GPisochronChoiceAltChron'\n     * input (cf. this._createIsoPanelFormTypeChoiceElement),\n     * and updates current computation mode\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onIsoTypeChoiceChange (e) {\n        var value = e.target.value;\n        if (!value) {\n            return;\n        }\n        if (value === \"isodistance\") {\n            this._currentComputation = \"distance\";\n        }\n        if (value === \"isochron\") {\n            this._currentComputation = \"time\";\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPisochronTransportPedestrian' or 'GPisochronTransportCar'\n     * input (cf. this._createIsoPanelFormModeChoiceTransportElement),\n     * and updates current transport mode\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onIsoModeTransportChange (e) {\n        var value = e.target.value;\n        if (!value) {\n            return;\n        }\n        this._currentTransport = value;\n    }\n\n    /**\n     * this method is called by event 'change' on 'GPisochronDirectionSelect' select\n     * (cf. this._createIsoPanelFormModeChoiceDirectionElement),\n     * and updates current direction mode\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onIsoModeDirectionChange (e) {\n        var value = e.target.value;\n        if (!value) {\n            return;\n        }\n        if (value.toLowerCase() === \"arrival\") {\n            document.getElementById(\"GPisochronPointLabelP-\" + this._uid).innerHTML = \"Arrivée\";\n        } else {\n            document.getElementById(\"GPisochronPointLabelP-\" + this._uid).innerHTML = \"Départ\";\n        }\n        this._currentDirection = value;\n    }\n\n    /**\n     * this method is called by event 'change' on 'GPIsoExclusionsToll'\n     * or 'GPIsoeExclusionsTunnel' or 'GPIsoExclusionsBridge' tag input\n     * (cf. this._createIsoPanelFormExclusionOptionsElement).\n     * this value is saved as a parameter for the service isocurve.\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onIsoExclusionsChange (e) {\n        var value = e.target.value;\n        var checked = e.target.checked;\n\n        if (!value) {\n            return;\n        }\n\n        var bFound = false;\n        var iFound = null;\n        for (var i = 0; i < this._currentExclusions.length; i++) {\n            if (deepEqual(this._currentExclusions[i], value.toLowerCase())) {\n                iFound = i;\n                bFound = true;\n            }\n        }\n        // on l'ajoute si la valeur n'existe pas et est selectionnée\n        if (!bFound && !checked) {\n            this._currentExclusions.push(value.toLowerCase());\n        }\n        // on la retire si la valeur existe et est deselectionnée\n        if (bFound && checked) {\n            this._currentExclusions[iFound] = null;\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPisoReset'\n     * tag label (cf. this._createIsoFormResetElement),\n     * and it cleans all isochron input options and results.\n     *\n     * @private\n     */\n    onIsoResetClick () {\n        // clear\n        this._clear();\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPIsoSubmit'\n     * tag label (cf. this._createIsoSubmitFormElement),\n     * and it cleans the isochrone geometry.\n     *\n     * @private\n     */\n    onShowIsoResultsNewClick () {\n        // clean avant un nouveau calcul !\n        this._clearGeojsonLayer();\n        /**\n        * event triggered when user clear points to compute isochrone\n        *\n        * @event route:newresults\n        */\n        this.dispatchEvent(\"iso:newresults\");\n    }\n\n    /**\n     * ...\n     * @private\n     */\n    onShowIsoSettingsClick () {}\n\n    // ################################################################### //\n    // ######################## isocurve calculation ##################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this.onIsoComputationSubmit\n     * and executes a request to the service.\n     *\n     * @param {Object} options - isocurve service request options\n     * @private\n     */\n    _requestIsoCurve (options) {\n        // on ne fait pas de requête si on n'a pas renseigné de parametres !\n        if (!options || ((typeof options === \"object\") && (Object.keys(options).length === 0))) {\n            return;\n        }\n        // on ne fait pas de requête si on n'a pas de point d'origine\n        if (!options.position) {\n            return;\n        }\n\n        // si l'utilisateur a spécifié le paramètre ssl au niveau du control, on s'en sert\n        // true par défaut (https)\n        if (typeof options.ssl !== \"boolean\") {\n            if (typeof this.options.ssl === \"boolean\") {\n                options.ssl = this.options.ssl;\n            } else {\n                options.ssl = true;\n            }\n        }\n\n        logger.log(options);\n\n        // on efface une éventuelle précédente couche\n        this._clearGeojsonLayer();\n\n        // mise en place de la patience\n        this._displayWaitingContainer();\n\n        // appel du service de calcul d'isochrones\n        Gp.Services.isoCurve(options);\n    }\n\n    /**\n     * this method is called by this.onIsoComputationSubmit() (in case of route computation success)\n     * and fills the container of the iso compute results with its metadata\n     * information, also, constructs the geometry isochrone.\n     *\n     * @param {Object} results - results of the iso calculation\n     * @param {Object} computeOptions - options of the iso calculation\n     *\n     * @private\n     */\n    _fillIsoResultsDetails (results, computeOptions) {\n        // 1. Affichage des distances et durées\n        this._fillIsoResultsDetailsContainer(results, computeOptions);\n\n        // sauvegarde de l'etat des resultats\n        this._currentIsoInformations = results;\n\n        /**\n         * event triggered when the compute is finished\n         *\n         * @event iso:compute\n         * @property {Object} type - event\n         * @property {Object} target - instance Iso\n         * @example\n         * Iso.on(\"iso:compute\", function (e) {\n         *   console.log(e.target.getData());\n         * })\n         */\n        this.dispatchEvent({\n            type : \"iso:compute\"\n        });\n\n        // mise à jour du controle !\n        this._formContainer.className = \"GPelementHidden gpf-hidden gpf-panel__content fr-modal__content\";\n        this._hideWaitingContainer();\n        this._resultsIsoContainer.className = \"gpf-flex GPflex\";\n    }\n\n    /**\n     * this method is called by this._fillIsoResultsDetails()\n     * and fills the container of the iso compute results with its metadata\n     * information.\n     *\n     * @param {Object} results - Resultats renvoyés par le service d'isochrone\n     * @param {Object} computeOptions - options of the iso calculation\n     * \n     * @private\n     */\n    _fillIsoResultsDetailsContainer (results, computeOptions) {\n        this._resultsIsoValuesContainer = this._addIsoResultsValuesElement(results, computeOptions, MathUtils.convertSecondsToTime);\n    }\n\n    /**\n     * this method is called by this.onIsoComputationSubmit (in case of success)\n     * and draw isocurve results geometry on map\n     *\n     * @param {Object} results - isocurve response results\n     * @private\n     */\n    _drawIsoResults (results) {\n        // sauvegarde de l'etat des resultats\n        this._currentIsoResults = results;\n        // cache la patience\n        this._hideWaitingContainer();\n\n        if (!results.geometry) {\n            return;\n        }\n\n        var map = this.getMap();\n\n        // 1. création de l'objet geoJSON\n        this._geojsonObject = {\n            type : \"FeatureCollection\",\n            crs : {\n                type : \"name\",\n                properties : {\n                    name : \"EPSG:4326\"\n                }\n            },\n            features : [\n                {\n                    type : \"Feature\",\n                    crs : {\n                        type : \"name\",\n                        properties : {\n                            name : \"EPSG:4326\"\n                        }\n                    },\n                    geometry : results.geometry\n                }\n            ]\n        };\n        this._geojsonObject.features.push({\n            type : \"Feature\",\n            geometry : {\n                type : \"Point\",\n                coordinates : this._originPoint.getCoordinate()\n            },\n            properties : {\n                description : \"Point d'origine\",\n                \"marker-symbol\" : this.options.markerOpts.url\n            }\n        });\n        var geojsonformat = new GeoJSONExtended({\n            defaultDataProjection : \"EPSG:4326\",\n            defaultStyle : this._defaultFeatureStyle\n        });\n        var mapProj = map.getView().getProjection().getCode();\n        var features = geojsonformat.readFeatures(\n            this._geojsonObject, {\n                dataProjection : \"EPSG:4326\",\n                featureProjection : mapProj\n            }\n        );\n\n        // 2. ajout de la géométrie comme nouvelle couche vecteur à la carte\n        var method = (this._currentComputation === \"time\") ? \"Isochrone\" : \"Isodistance\";\n\n        this._geojsonLayer = new VectorLayer({\n            source : new VectorSource({\n                features : features\n            }),\n            style : this._defaultFeatureStyle,\n            opacity : 0.9,\n            title : \"Mon \" + method\n        });\n        // ajout d'un identifiant à la couche\n        var graph;\n        if (this._currentTransport === \"Pieton\") {\n            graph = \"piéton\";\n            this._geojsonLayer.gpResultLayerId = \"compute:Pieton$GEOPORTAIL:GPP:Isocurve\";\n        } else {\n            graph = \"voiture\";\n            this._geojsonLayer.gpResultLayerId = \"compute:Voiture$GEOPORTAIL:GPP:Isocurve\";\n        }\n        // ajout à la carte\n        map.addLayer(this._geojsonLayer);\n\n        /**\n         * event triggered when the compute is finished\n         *\n         * @event isocurve:compute\n         * @typedef {Object}\n         * @property {Object} type - event\n         * @property {Object} target - instance Isocurve\n         * @example\n         * Isocurve.on(\"isocurve:compute\", function (e) {\n         *   console.log(e.target.getData());\n         * })\n         */\n        this.dispatchEvent({\n            type : \"isocurve:compute\"\n        });\n\n        // 3. Zoom sur l'emprise de la geometry\n        if (features[0] && features[0].getGeometry() && features[0].getGeometry().getExtent()) {\n            var extent = features[0].getGeometry().getExtent();\n            map.getView().fit(extent, map.getSize());\n        }\n\n        // 5. Si un layer switcher est présent dans la carte, on lui affecte des informations pour cette couche\n        var method = (this._currentComputation === \"time\") ? \"Isochrone\" : \"Isodistance\";\n        map.getControls().forEach(\n            (control) => {\n                if (control instanceof LayerSwitcher) {\n                    // un layer switcher est présent dans la carte\n                    var layerId = this._geojsonLayer.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas déjà (si le titre est le numéro par défaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this._geojsonLayer, {\n                                title : this.options.layerDescription.title + \" (\" + method + \"/\" + graph + \")\",\n                                description : this.options.layerDescription.description\n                            }\n                        );\n                    }\n                }\n            }\n        );\n    }\n\n    // ################################################################### //\n    // ############################# Clean ############################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this.onShowIsoPanelClick()\n     * and it clears all elements (reinit).\n     *\n     * @private\n     */\n    _clear () {\n        // clear inputs\n        this._clearIsoInputs();\n\n        // clear origin point (and marker)\n        this._originPoint.clear();\n\n        // remove geometry layer\n        this._clearGeojsonLayer();\n\n        // clear results\n        this._currentIsoResults = null;\n    }\n\n    /**\n     * this method is called by this._clear()\n     * and it clears all input elements (dist and time)\n     *\n     * @private\n     */\n    _clearIsoInputs () {\n        // 1. clear inputs\n        // clear time inputs (if exists) :\n        // hours\n        var timeHourInput = document.getElementById(\"GPisochronValueChronInput1-\" + this._uid);\n        if (timeHourInput) {\n            timeHourInput.value = \"0\";\n        }\n        // minutes\n        var timeMinutesInput = document.getElementById(\"GPisochronValueChronInput2-\" + this._uid);\n        if (timeMinutesInput) {\n            timeMinutesInput.value = \"0\";\n        }\n        // clear distance input (if exists)\n        var distInput = document.getElementById(\"GPisochronValueDistInput-\" + this._uid);\n        if (distInput) {\n            distInput.value = \"0\";\n        }\n\n        // 2. reinit options to default\n        this._initTransport();\n        this._initComputation();\n        this._initDirection();\n        this._initExclusions();\n\n        // 3. set transport mode to default\n        var transportdiv;\n        if (this._currentTransport === \"Pieton\") {\n            transportdiv = document.getElementById(\"GPisochronTransportPedestrian-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        } else {\n            transportdiv = document.getElementById(\"GPisochronTransportCar-\" + this._uid);\n            if (transportdiv) {\n                transportdiv.checked = \"true\";\n            }\n        }\n\n        // 4. set computation mode to default (distance or time)\n        var computationdiv;\n        if (this._currentComputation.toLowerCase() === \"distance\") {\n            computationdiv = document.getElementById(\"GPisochronChoiceAltDist-\" + this._uid);\n            if (computationdiv) {\n                computationdiv.checked = \"true\";\n            }\n            if (document.getElementById(\"GPisochronValueDist-\" + this._uid)) {\n                document.getElementById(\"GPisochronValueDist-\" + this._uid).className = \"GPflexInput gpf-flex\";\n            }\n            if (document.getElementById(\"GPisochronValueChron-\" + this._uid)) {\n                document.getElementById(\"GPisochronValueChron-\" + this._uid).className = \"GPelementHidden gpf-hidden\";\n            }\n        } else {\n            computationdiv = document.getElementById(\"GPisochronChoiceAltChron-\" + this._uid);\n            if (computationdiv) {\n                computationdiv.checked = \"true\";\n            }\n            if (document.getElementById(\"GPisochronValueChron-\" + this._uid)) {\n                document.getElementById(\"GPisochronValueChron-\" + this._uid).className = \"GPflexInput gpf-flex\";\n            }\n            if (document.getElementById(\"GPisochronValueDist-\" + this._uid)) {\n                document.getElementById(\"GPisochronValueDist-\" + this._uid).className = \"GPelementHidden gpf-hidden\";\n            }\n        }\n\n        // 5. set direction mode to default (arrival or departure)\n        var directionSelect = document.getElementById(\"GPisochronDirectionSelect-\" + this._uid);\n        if (directionSelect) {\n            directionSelect.value = this._currentDirection;\n        }\n        if (directionSelect.value.toLowerCase() === \"arrival\") {\n            document.getElementById(\"GPisochronPointLabelP-\" + this._uid).innerHTML = \"Arrivée\";\n        } else {\n            document.getElementById(\"GPisochronPointLabelP-\" + this._uid).innerHTML = \"Départ\";\n        }\n\n        // 6. set exclusions to default\n        var tollInput = document.getElementById(\"GPisoExclusionsToll-\" + this._uid);\n        if (tollInput) {\n            if (this._currentExclusions.indexOf(\"toll\") !== -1) {\n                tollInput.checked = false;\n            } else {\n                tollInput.checked = true;\n            }\n        }\n        var tunnelInput = document.getElementById(\"GPisoExclusionsTunnel-\" + this._uid);\n        if (tunnelInput) {\n            if (this._currentExclusions.indexOf(\"tunnel\") !== -1) {\n                tunnelInput.checked = false;\n            } else {\n                tunnelInput.checked = true;\n            }\n        }\n        var bridgeInput = document.getElementById(\"GPisoExclusionsBridge-\" + this._uid);\n        if (bridgeInput) {\n            if (this._currentExclusions.indexOf(\"bridge\") !== -1) {\n                bridgeInput.checked = false;\n            } else {\n                bridgeInput.checked = true;\n            }\n        }\n    }\n\n    /**\n     * this method is called by this.onIsoComputationSubmit (in case of failure)\n     * and it clears all geometries\n     *\n     * @private\n     */\n    _clearGeojsonLayer () {\n        var map = this.getMap();\n        // remove layer\n        if (this._geojsonLayer) {\n            map.removeLayer(this._geojsonLayer);\n            this._geojsonLayer = null;\n        }\n        // remove geojson object\n        this._geojsonObject = null;\n    }\n\n    /**\n     * this method is called by event 'click' on control main container\n     * and hide suggested Locations (unless target is an autocomplete input)\n     *\n     * @param {Object} e - event\n     *\n     * @private\n     */\n    _hideIsoSuggestedLocations (e) {\n        // si on clique sur l'input de saisie du point d'origine\n        if (e.target && e.target.id && e.target.id.indexOf(\"GPlocationOrigin_\") !== -1) {\n\n        } else {\n            // si on clique ailleurs dans le DOM du control, on cache tous les résultats d'autocomplétion\n            this._originPoint._hideSuggestedLocation();\n        }\n    }\n\n    /**\n     * this method displays waiting container and sets a timeout\n     *\n     * @private\n     */\n    _displayWaitingContainer () {\n        this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible\";\n        this._waiting = true;\n\n        // mise en place d'un timeout pour réinitialiser le panel (cacher la patience)\n        // si on est toujours en attente (si la requête est bloquée par exemple)\n        var opts = this.options.isocurveOptions;\n        if (opts && opts.timeOut) {\n            if (this._timer) {\n                clearTimeout(this._timer);\n                this._timer = null;\n            }\n            var context = this;\n            this._timer = setTimeout(function () {\n                if (context._waiting === true) {\n                    context._hideWaitingContainer();\n                } else {\n                    if (context._timer) {\n                        clearTimeout(context._timer);\n                    }\n                }\n            }, 16000);\n        }\n    }\n\n    /**\n     * this method hides waiting container and clears timeout\n     *\n     * @private\n     */\n    _hideWaitingContainer () {\n        if (this._waiting) {\n            this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n            this._waiting = false;\n            var opts = this.options.isocurveOptions;\n            if (opts && opts.timeOut) {\n                clearTimeout(this._timer);\n                this._timer = null;\n            }\n        }\n    }\n\n};\n\n// on récupère les méthodes de la classe commune MousePosition\nObject.assign(Isocurve.prototype, IsocurveDOM);\nObject.assign(Isocurve.prototype, Widget);\n\nexport default Isocurve;\n\n// Expose Isocurve as ol.control.Isocurve (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.Isocurve = Isocurve;\n}\n\nconst deepEqual = function (x, y) {\n    if (x === y) {\n        return true;\n    } else if ((typeof x === \"object\" && x != null) && (typeof y === \"object\" && y != null)) {\n        if (Object.keys(x).length !== Object.keys(y).length) {\n            return false;\n        }\n\n        for (var prop in x) {\n            if (y.hasOwnProperty(prop)) {\n                if (!deepEqual(x[prop], y[prop])) {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        }\n        return true;\n    } else {\n        return false;\n    }\n};\n","import Logger from \"./LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"parser\");\n\n/**\n* @module Parser\n* @alias module:~utils/Parser\n* @description\n* ...\n*\n* @example\n* parse();\n* toString();\n*/\nvar Parser = {\n\n    /**\n     * ...\n     *\n     * @param {String} xml - XML string\n     * @returns {DOMElement} doc\n     */\n    parse : function (xml) {\n        var doc = null;\n        var parser = null;\n        var scope = typeof window !== \"undefined\" ? window : null;\n\n        if (typeof exports === \"object\" && window === null) {\n            // code for nodejs\n            var DOMParser = require(\"@xmldom/xmldom\").DOMParser;\n            parser = new DOMParser();\n            doc = parser.parseFromString(xml, \"text/xml\");\n        } else if (scope.DOMParser) {\n            // code for modern browsers\n            parser = new scope.DOMParser();\n            doc = parser.parseFromString(xml, \"text/xml\");\n        } else if (scope.ActiveXObject) {\n            // code for old IE browsers\n            doc = new scope.ActiveXObject(\"Microsoft.XMLDOM\");\n            doc.async = false;\n            doc.loadXML(xml);\n        } else {\n            logger.log(\"Incompatible environment for DOM Parser !\");\n        }\n\n        var errorNode = doc.querySelector(\"parsererror\");\n        if (errorNode) {\n            // INFO parsing failed\n            // eslint-disable-next-line no-console\n            console.error(errorNode);\n            return null;\n        }\n\n        logger.trace(doc);\n        return doc;\n    },\n\n    /**\n     * ...\n     *\n     * @param {DOMElement} doc - doc\n     * @returns {String} XML string\n     */\n    toString : function (doc) {\n        // TODO\n        // try catch pour les exceptions !\n        // cf. https://developer.mozilla.org/en-US/docs/Web/API/XMLSerializer/serializeToString\n        var oSerializer = new XMLSerializer();\n        var xml = oSerializer.serializeToString(doc);\n\n        logger.trace(xml);\n        return xml;\n    },\n\n    /**\n     * ...\n     * cf. https://stackoverflow.com/questions/376373/pretty-printing-xml-with-javascript/\n     *\n     * @param {String} xml - XML string\n     * @returns {String} XML string formatted\n     */\n    format : function (xml) {\n        var reg = /(>)\\s*(<)(\\/*)/g; // updated Mar 30, 2015\n        var wsexp = / *(.*) +\\n/g;\n        var contexp = /(<.+>)(.+\\n)/g;\n        xml = xml.replace(reg, \"$1\\n$2$3\").replace(wsexp, \"$1\\n\").replace(contexp, \"$1\\n$2\");\n        var formatted = \"\";\n        var lines = xml.split(\"\\n\");\n        var indent = 0;\n        var lastType = \"other\";\n        // 4 types of tags - single, closing, opening, other (text, doctype, comment) - 4*4 = 16 transitions\n        var transitions = {\n            \"single->single\" : 0,\n            \"single->closing\" : -1,\n            \"single->opening\" : 0,\n            \"single->other\" : 0,\n            \"closing->single\" : 0,\n            \"closing->closing\" : -1,\n            \"closing->opening\" : 0,\n            \"closing->other\" : 0,\n            \"opening->single\" : 1,\n            \"opening->closing\" : 0,\n            \"opening->opening\" : 1,\n            \"opening->other\" : 1,\n            \"other->single\" : 0,\n            \"other->closing\" : -1,\n            \"other->opening\" : 0,\n            \"other->other\" : 0\n        };\n\n        for (var i = 0; i < lines.length; i++) {\n            var ln = lines[i];\n            var single = Boolean(ln.match(/<.+\\/>/)); // is this line a single tag? ex. <br />\n            var closing = Boolean(ln.match(/<\\/.+>/)); // is this a closing tag? ex. </a>\n            var opening = Boolean(ln.match(/<[^!].*>/)); // is this even a tag (that's not <!something>)\n            var type = single ? \"single\" : closing ? \"closing\" : opening ? \"opening\" : \"other\";\n            var fromTo = lastType + \"->\" + type;\n            lastType = type;\n            var padding = \"\";\n\n            indent += transitions[fromTo];\n            for (var j = 0; j < indent; j++) {\n                padding += \"\\t\";\n            }\n            if (fromTo === \"opening->closing\") {\n                formatted = formatted.substr(0, formatted.length - 1) + ln + \"\\n\"; // substr removes line break (\\n) from prev loop\n            } else {\n                formatted += padding + ln + \"\\n\";\n            }\n        }\n\n        logger.trace(formatted);\n        return formatted;\n    }\n};\n\nexport default Parser;\n","import CommonService from \"../CommonService\";\nimport DefaultUrlService from \"../DefaultUrlService\";\nimport AutoCompleteResponseFactory from \"./Response/AutoCompleteResponseFactory\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport MR from \"../../Utils/MessagesResources\";\nimport Helper from \"../../Utils/Helper\";\nimport ErrorService from \"../../Exceptions/ErrorService\";\n\n/**\n * @classdesc\n * Appel du service d'autocomplétion du Géoportail :\n * envoi de la requête construite selon les paramètres en options,\n * éventuellement parsing et analyse  de la réponse,\n * retour d'une réponse en paramètre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.AutoComplete\n *\n * @param {Object} options - options spécifiques au service (+ les options heritées)\n *\n * @param {String} options.text - La chaîne de caractère à compléter.\n *      Cette chaîne n'est pas \"URL encodée\".\n *      C'est l'API qui s'occupe de l'encoder pour l'inclure dans la requête.\n *\n * @param {Array.<String>} [options.type = [\"StreetAddress\"]] - Type de l'objet recherché.\n *      Le service d'autocomplétion du Géoportail permet de rechercher des toponymes 'PositionOfInterest' et/ou des adresses postales 'StreetAddress'.\n *      D'autres types pourront être rajoutés selon l'évolution du service.\n *      Par défaut, type = ['StreetAddress'].\n *\n * @param {String} [options.territory] - Limitation de la zone de recherche de localisants.\n *      Le service d'autocomplétion du Géoportail permet de limiter la recherche à la métropole et la Corse : options.territory = 'METROPOLE',\n *      DOMS TOMS : options.territory = 'DOMTOM', ou à un département : options.territory = '31'\n *      Pas de valeur par défaut.\n *      La valeur par défaut est donc celle du service.\n *      Le service d'autocomplétion du Géoportail renvoie toutes les informations quand aucun territoire n'est spécifié.\n *\n * @param {Number} [options.maximumResponses = 10] - Nombre de réponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par défaut.\n *      La valeur par défaut sera donc celle du service : 10.\n *\n * @example\n *   var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spécifique au service\n *      text : \"\",\n *      type : \"StreetAddress\",\n *      territory : 'METROPOLE',\n *      maximumResponses : 10\n *   };\n */\nfunction AutoComplete (options_) {\n    if (!(this instanceof AutoComplete)) {\n        throw new TypeError(MR.getMessage(\"CLASS_CONSTRUCTOR\", \"AutoComplete\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"AutoComplete\";\n\n    this.logger = Logger.getLogger(\"Gp.Services.AutoComplete\");\n    this.logger.trace(\"[Constructeur AutoComplete (options)]\");\n\n    var options = this.patchOptionConvertor(options_);\n\n    if (!options.serverUrl) {\n        options.serverUrl = DefaultUrlService.AutoComplete.newUrl();\n    }\n\n    // appel du constructeur par heritage\n    CommonService.apply(this, arguments);\n\n    if (!options.text) {\n        throw new Error(MR.getMessage(\"PARAM_MISSING\", \"text\"));\n    }\n\n    // ajout des options spécifiques au service\n    this.options.text = options.text;\n\n    // on definit des parametres par defaut\n    if (!options.type) {\n        options.type = [\"StreetAddress,PositionOfInterest\"];\n    }\n\n    this.options.type = options.type;\n    this.options.territory = options.terr || \"\";\n    this.options.maximumResponses = options.maximumResponses || 10;\n\n    // INFO\n    // le service ne repond pas en mode POST (405 Method Not Allowed)\n    if (this.options.protocol === \"XHR\" && this.options.httpMethod === \"POST\") {\n        this.logger.warn(\"Le service ne gére pas le mode d'interrogation en POST, on bascule sur du GET !\");\n        this.options.httpMethod = \"GET\"; // on surcharge !\n    }\n\n    // attributs d'instances\n\n    /**\n     * Format forcé de la réponse du service : \"json\"\n     * sauf si l'on souhaite une reponse brute (options.rawResponse)\n     */\n    this.options.outputFormat = (this.options.rawResponse) ? \"\" : \"json\";\n}\n\n/**\n * @lends module:AutoComplete#\n */\n\nAutoComplete.prototype = Object.create(CommonService.prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nAutoComplete.prototype.constructor = AutoComplete;\n\n/**\n * Patch pour la convertion des options vers le nouveau formalisme.\n *\n * @param {Object} options_ - options du service\n * @return {Object} - options\n */\nAutoComplete.prototype.patchOptionConvertor = function (options_) {\n    const options = options_;\n\n    if (options.filterOptions) {\n        this.logger.warn(\"The parameter 'filterOptions' is deprecated\");\n\n        if (options.filterOptions.type) {\n            this.logger.warn(\"The parameter 'filterOptions.type' is deprecated\");\n            if (!options.type) {\n                options.type = options.filterOptions.type;\n            }\n        }\n\n        if (options.filterOptions.territory) {\n            this.logger.warn(\"The parameter 'filterOptions.territory' is deprecated\");\n            if (!options.terr) {\n                options.terr = options.filterOptions.territory;\n            }\n        }\n\n        delete options.filterOptions;\n    }\n\n    return options;\n};\n\n/**\n * (overwrite)\n * Création de la requête\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAutoComplete.prototype.buildRequest = function (error, success) {\n    // ex.\n    // http://wxs.ign.fr/CLEF/ols/apis/completion?\n    // text=Brie-Comt&\n    // type=StreetAddress,PositionOfInterest&\n    // territory=METROPOLE&\n    // maximumResponses=10\n\n    // traitement des param KPV sous forme de tableau\n    var territory = \"\";\n    if (this.options.territory) {\n        territory = this.options.territory;\n    }\n\n    var type = \"\";\n    if (this.options.type) {\n        type = this.options.type.join(\",\");\n    }\n\n    // normalisation de la requete avec param KPV\n    this.request = Helper.normalyzeParameters({\n        text : encodeURIComponent(this.options.text),\n        type : type,\n        terr : territory,\n        maximumResponses : this.options.maximumResponses\n    });\n\n    (!this.request)\n        ? error.call(this, new ErrorService(MR.getMessage(\"SERVICE_REQUEST_BUILD\")))\n        : success.call(this, this.request);\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback de succès de l'analyse de la réponse\n */\nAutoComplete.prototype.analyzeResponse = function (error, success) {\n    if (this.response) {\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onSuccess : success,\n            onError : error,\n            scope : this\n        };\n\n        AutoCompleteResponseFactory.build(options);\n    } else {\n        error.call(this, new ErrorService(MR.getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\nexport default AutoComplete;\n","/**\n * Factory pour générer une reponse JSON à partir d'un XML\n * (Factory)\n *\n * @module GeocodeResponseFactory\n * @alias Gp.Services.Geocode.Response.GeocodeResponseFactory\n * @private\n */\n// import Logger from \"../../../Utils/LoggerByDefault\";\nimport ErrorService from \"../../../Exceptions/ErrorService\";\nimport MRes from \"../../../Utils/MessagesResources\";\nimport GeocodeResponseParser from \"../Formats/GeocodeResponseParser\";\n\nvar GeocodeReponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Geocode\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n        // data de type GeocodeResponse\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                data = options.response;\n            } else {\n                try {\n                    const parser = new GeocodeResponseParser();\n                    data = parser.parse(options.response);\n\n                    if (!data) {\n                        throw new Error(\"L'analyse de la réponse du service !?\");\n                    }\n                } catch (e) {\n                    var message = e.message;\n                    if (typeof options.response === \"string\") {\n                        message += \"('\" + options.response + \"')\";\n                    } else {\n                        message += \"('\" + options.response.documentElement.innerHTML + \"')\";\n                    }\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_ANALYSE\", message),\n                        type : ErrorService.TYPE_UNKERR,\n                        status : -1\n                    }));\n                    return;\n                }\n\n                // Si la réponse contenait une exception renvoyée par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new ErrorService({\n                        message : MRes.getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : ErrorService.TYPE_SRVERR,\n                        status : 200 // FIXME : 200 ?\n                    }));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new ErrorService({\n                message : MRes.getMessage(\"SERVICE_RESPONSE_EMPTY\"),\n                type : ErrorService.TYPE_SRVERR,\n                status : -1 // FIXME : status response\n            }));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n    }\n};\n\nexport default GeocodeReponseFactory;\n","module.exports = ol.style.Text;","// import openlayers\nimport olGeoJSON from \"ol/format/GeoJSON\";\n// import local\nimport Styling from \"./Styling\";\n\n/**\n * @classdesc\n *\n * Extended Styles GeoJSON format to export (internal use only !)\n *\n * SPEC\n * cf. https://github.com/mapbox/simplestyle-spec/\n * cf. https://geojson.org/\n *\n *\n * @constructor\n * @alias ol.format.GeoJSONExtended\n * @extends {ol.format.GeoJSON}\n * @type {ol.format.GeoJSONExtended}\n * @param {Object} options - Options\n * @param {Object} [options.defaultStyle] - Styles by default\n * @param {Object} [options.extensions] - Add properties to file root\n */\nvar GeoJSON = class GeoJSON extends olGeoJSON {\n\n    /**\n     * See {@link ol.format.GeoJSONExtended}\n     * @module GeoJSONExtended\n     * @alias module:~formats/GeoJSONExtended\n     * @param {*} options - options\n     * @example\n     * import GeoJSONExtended from \"gpf-ext-ol/formats/GeoJSONExtended\"\n     * ou \n     * import { GeoJSONExtended } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        super(options);\n\n        if (!(this instanceof GeoJSON)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this.options = options || {};\n\n        // INFO\n        // defaultStyle est un objet de type Style\n        if (this.options.defaultStyle === null || typeof this.options.defaultStyle === \"undefined\") {\n            this.options.defaultStyle = {};\n        }\n\n        this.source = null;\n\n        return this;\n    }\n\n    /**\n     * Read Extend Styles for Features.\n     * This function overloads ol.format.GeoJSON.readFeatures ...\n     *\n     * @see ol.format.GeoJSON.prototype.readFeatures\n     * @param {Object|String} source - Source.\n     * @param {olx.format.ReadOptions} [options] - Options.\n     * @return {Array.<ol.Feature>} Features.\n     */\n    readFeatures (source, options) {\n        var features = super.readFeatures(source, options);\n\n        // String ou Object\n        if (typeof source === \"string\") {\n            this.source = JSON.parse(source);\n        } else if (source !== null) {\n            this.source = source;\n        }\n\n        features.forEach((feature) => {\n            var featureStyleFunction = feature.getStyleFunction();\n            // existe t il déjà une fonction de style ?\n            // si oui, on l'applique !\n            if (featureStyleFunction) {\n                var styles = featureStyleFunction.call(this, feature, 0);\n                if (styles && styles.length !== 0) {\n                    feature.setStyle(styles[0]);\n                }\n            } else {\n                // à ce niveau, il n'existe pas de styles, donc :\n                // soit, on applique les styles par defaut\n                // soit, on prend en compte les styles definis dans les properties / tag du fichier\n                // les styles définis ecrasent les styles par defaut...\n                var style = Styling.defineStyleFromProperties(feature);\n                if (style) {\n                    feature.setStyle(style);\n                } else {\n                    // si aucun style disponible, on utilisera le style par defaut defini\n                    // par l'utilisateur ou l'application\n                    var styleFunction = Styling.defineStyleFunctionByDefault(this.options.defaultStyle);\n                    if (styleFunction) {\n                        feature.setStyle(styleFunction);\n                        Styling.definePropertiesFromStyle(feature);\n                    }\n                }\n            }\n        });\n\n        return features;\n    }\n\n    /**\n     * Write Extend Styles for Features.\n     * This function overloads ol.format.GeoJSON.writeFeatures ...\n     *\n     * @see ol.format.GeoJSON.prototype.writeFeatures\n     * @param {Array.<ol.Feature>} features - Features.\n     * @param {Object} [options] - Options.\n     *\n     * @return {String} Result.\n     */\n    writeFeatures (features, options) {\n        // on met à jour les properties de styles\n        features.forEach(function (feature) {\n            Styling.definePropertiesFromStyle(feature);\n        });\n\n        var geoJSONObject = this.writeFeaturesObject(features, options);\n\n        // ajout des properties à la racine du fichier\n        // ex. options : {\n        //   extensions : { /* liste des objets à ajouter */ }\n        // }\n        if (this.options.hasOwnProperty(\"extensions\")) {\n            Object.assign(geoJSONObject, this.options.extensions);\n        }\n\n        return JSON.stringify(geoJSONObject);\n    }\n\n    /**\n     * ...\n     * @param {*} key ...\n     * @returns {Object} json\n     */\n    readRootExtensions (key) {\n        return this.source[key];\n    }\n\n};\n\nexport default GeoJSON;\n\n// Expose GeoJSON as ol.source.GeoJSONExtended. (for a build bundle)\nif (window.ol && window.ol.format) {\n    window.ol.format.GeoJSONExtended = GeoJSON;\n}\n","\nimport Logger from \"../../../Utils/LoggerByDefault\";\nimport _ from \"../../../Utils/MessagesResources\";\nimport ProcessIsoCurveParam from \"./model/ProcessIsoCurveParam\";\n\n/**\n * @classdesc\n * Classe de gestion des requêtes sur le service de calcul d'isoschrone/isodistance.\n *  Les requêtes peuvent être en mode GET ou POST,\n *  et le format de sorti est en JSON.\n *\n * @constructor\n * @alias Gp.Services.ProcessIsoCurve.Request.ProcessIsoCurveRequest\n * @param {Object} options - options\n *\n * @example\n * var options = {\n *      httpMethod : 'GET', // GET|POST\n *      // spécifique au service\n *      position : {\n *          x : 2.3242664298058053,\n *          y : 48.86118017324745\n *      },\n *      graph : \"car\",\n *      method : 'time',\n *      time : 1000, //distance : 200\n *      reverse : false,\n *      srs : 'EPSG:4326'\n *  };\n *\n * try {\n *\n *      var oIsoCurve = new ProcessIsoCurveRequest (options);\n *      if (!oIsoCurve.processRequestString ()) {\n *          // error\n *      }\n *\n *      var request = oIsoCurve.requestString;\n *\n * } catch (e) {\n *      // error\n * }\n * @private\n */\nfunction ProcessIsoCurveRequest (options) {\n    this.logger = Logger.getLogger(\"ProcessIsoCurveRequest\");\n    this.logger.trace(\"[Constructeur ProcessIsoCurveRequest ()]\");\n\n    if (!(this instanceof ProcessIsoCurveRequest)) {\n        throw new TypeError(\"ProcessIsoCurveRequest constructor cannot be called as a function.\");\n    }\n\n    // existance des options\n    if (!options) {\n        throw new Error(_.getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    /**\n     * Liste des options\n     */\n    this.settings = options;\n\n    /**\n     * Mode HTPP.\n     * Par defaut, \"GET\".\n     * @type {String}\n     */\n    this.mode = this.settings.httpMethod || \"GET\";\n}\n\nProcessIsoCurveRequest.prototype = {\n\n    /**\n     * @lends module:ProcessIsoCurveRequest#\n     */\n\n    /**\n     * Requête\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : ProcessIsoCurveRequest,\n\n    /**\n     * Construction de la requête.\n     *\n     * @example\n     * // GET  out :\n     *   //  (http://wxs.ign.fr/KEY/isochrone?)\n     *   //  resource=&\n     *   //  point=&\n     *   //  costValue=&\n     *   //  costType=&\n     *   //  profile=&\n     *   //  constraints=&\n     *   //  direction=&\n     *   //  crs=\n     *\n     * // POST out :\n     * {\n     *  resource: \"bduni-idf-pgr\",\n     *  point: \"2.337306,48.849319\",\n     *  costValue: 100,\n     *  costType: \"time\",\n     *  profile: \"car\",\n     *  constraints: [{\n     *      constraintType: \"banned\",\n     *      key: \"ways_type\",\n     *      operator: \"=\",\n     *      value: \"autoroute\"\n     *  }]\n     * }\n     *\n     * @returns {String} request\n     */\n    processRequestString : function () {\n        var request = \"\";\n        var i = 0;\n\n        switch (this.mode) {\n            case \"GET\":\n                this.logger.trace(\"Process GET Request\");\n\n                // Mapping des options avec le service de l'API REST\n                var oParams = new ProcessIsoCurveParam(this.settings);\n                var params = oParams.getParams();\n\n                for (i = 0; i < params.length; i++) {\n                    var o = params[i];\n                    if (request) {\n                        request += \"&\";\n                    }\n                    request += o.k + \"=\" + o.v;\n                }\n\n                break;\n\n            case \"POST\":\n                this.logger.trace(\"Process POST Request\");\n                // creation du JSON\n                var postRequest = {};\n\n                postRequest.resource = this.settings.resource;\n\n                postRequest.point = this.settings.position.x + \",\" + this.settings.position.y;\n\n                if (this.settings.method === \"distance\") {\n                    postRequest.costType = \"distance\";\n                    postRequest.costValue = this.settings.distance;\n                } else {\n                    postRequest.costType = \"time\";\n                    postRequest.costValue = this.settings.time;\n                }\n\n                postRequest.profile = this.settings.graph;\n\n                if (this.settings.reverse) {\n                    postRequest.direction = \"arrival\";\n                } else {\n                    postRequest.direction = \"departure\";\n                }\n\n                postRequest.constraints = this.settings.constraints;\n\n                postRequest.distanceUnit = this.settings.distanceUnit;\n\n                postRequest.timeUnit = this.settings.timeUnit;\n\n                postRequest.crs = this.settings.srs;\n\n                // conversion en chaîne de caractères\n                request = JSON.stringify(postRequest);\n                break;\n\n            default:\n                this.logger.error(\"No other HTTP method supported by the service !\");\n        }\n\n        this.logger.trace(request);\n        this.requestString = request;\n\n        return this.requestString;\n    }\n};\n\nexport default ProcessIsoCurveRequest;\n","// import Logger from \"../../../Utils/LoggerByDefault\";\nimport MR from \"../../../Utils/MessagesResources\";\nimport ErrSrv from \"../../../Exceptions/ErrorService\";\nimport GeocodeResponse from \"../Response/model/GeocodeResponse\";\nimport GeocodedLocation from \"../Response/model/GeocodedLocation\";\n\n/**\n * Fonction retournant un objet contenant des clés de lecture (readers)\n *      qui permettent de parser des réponses XML du service de géocodage direct du Géoportail\n *      afin de récupérer les résultats retournés.\n * @module GeocodeResponseParser\n * @alias Gp.Services.Geocode.Formats.GeocodeResponseParser\n * @private\n */\n\n/**\n * @classdesc\n *\n * Classe permettant de parser une réponse GeoJSON\n *\n * @constructor\n * @alias Gp.Formats.GeocodeResponseParser\n *\n * @private\n */\nfunction GeocodeResponseParser () {\n    if (!(this instanceof GeocodeResponseParser)) {\n        throw new TypeError(\"GeocodeResponseParser constructor cannot be called as a function.\");\n    }\n}\n\nGeocodeResponseParser.prototype = {\n\n    /**\n     * @lends module:GeocodeResponseParser\n     */\n\n    /*\n     * Constructeur (alias)\n     */\n    constructor : GeocodeResponseParser,\n\n    /**\n     * Méthode permettant de lancer la lecture d'une réponse GeoJSON,\n     *\n     * @param {String} json - réponse au format GeoJSON\n     * @return {Object} geocodeResponse|exceptionReport : l'objet contenant les informations de la réponse GeoJSON,\n     *      sous la forme d'un objet GeocodeResponse, ou un objet littéral exceptionReport si le service a renvoyé une exception.\n     */\n    parse : function (json) {\n        var geocodeResponse = new GeocodeResponse();\n\n        const obj = JSON.parse(json);\n\n        if (obj.type === \"FeatureCollection\") {\n            for (var i = 0; i < obj.features.length; ++i) {\n                _parseFeature(obj.features[i], geocodeResponse);\n            }\n        } else if (obj.type === \"Feature\") {\n            _parseFeature(obj, geocodeResponse);\n        } else if (obj.type === \"SERVICE_ERROR\") {\n            return _parseError(obj);\n        } else {\n            var mess = MR.getMessage(\"SERVICE_RESPONSE_ANALYSE\", obj.type);\n            throw new ErrSrv({\n                message : mess,\n                type : ErrSrv.TYPE_UNKERR,\n                status : 200\n            });\n        }\n\n        return geocodeResponse;\n    }\n};\n\n/**\n * Méthode permettant de parser un feature\n *\n * @private\n *\n * @param {Object} feature\n * @param {Object} geocodeResponse\n *\n * @memberof GeocodeResponseParser\n * @return {Object} objet GeocodedLocation\n */\nfunction _parseFeature (feature, geocodeResponse) {\n    var location = new GeocodedLocation();\n    if (feature.geometry && feature.geometry.type === \"Point\") {\n        location.position = {\n            lon : feature.geometry.coordinates[0],\n            lat : feature.geometry.coordinates[1]\n        };\n    }\n    if (feature.properties) {\n        for (var prop in feature.properties) {\n            if (prop === \"score\") {\n                location.accuracy = feature.properties[prop];\n            } else if (prop === \"_type\") {\n                if (feature.properties[prop] === \"address\") {\n                    location.type = \"StreetAddress\";\n                } else if (feature.properties[prop] === \"poi\") {\n                    location.type = \"PositionOfInterest\";\n                } else if (feature.properties[prop] === \"parcel\" || feature.properties[prop] === \"cadastral\") {\n                    location.type = \"CadastralParcel\";\n                }\n            } else {\n                location.placeAttributes[prop] = feature.properties[prop];\n            }\n        }\n        if (feature.properties._type === \"address\") {\n            location.matchType = feature.properties.number !== undefined && feature.properties.number !== null ? \"street number\" : \"street\";\n        }\n    }\n    geocodeResponse.locations.push(location);\n}\n\n/**\n * Méthode permettant de parser une erreur\n *\n * @private\n *\n * @param {Object} error\n *\n * @memberof GeocodeResponseParser\n * @return {Object}\n */\nfunction _parseError (error) {\n    return {\n        exceptionReport : error\n    };\n}\n\nexport default GeocodeResponseParser;\n","\n/**\n * Single SuggestedLocation Object returned by underlying web service.\n * Each suggested location represents a street address (\"StreetAddress\") or a place name (\"PositionOfInterest\").\n *\n * @property {String} type - Suggested location type : \"StreetAddress\" ou \"PositionOfInterest\"\n * @property {Gp.Point} position - Position of the suggested location given in requested coordinates system.\n * @property {String} commune - Suggested municipality\n * @property {String} fullText - Full text representation of the suggested location.\n * @property {String} postalCode - Suggested location postcode\n * @property {Integer} classification - Number used to classify the importance of the place where is the suggested location from 1 (most important) to 7 (less important).\n * @property {String} street - Street name of the suggested location (\"StreetAddress\" only).\n * @property {String} kind - Nature of the suggested location : \"prefecture\", \"monument\", \"commune\", ... for instance (\"PositionOfInterest\" only).\n *\n * @namespace\n * @alias Gp.Services.AutoComplete.SuggestedLocation\n */\nfunction SuggestedLocation () {\n    if (!(this instanceof SuggestedLocation)) {\n        throw new TypeError(\"SuggestedLocation constructor cannot be called as a function.\");\n    }\n\n    /* REPONSE :\n        {\n           \"status\" : \"OK\",\n           \"results\" : [\n              {\n                 \"country\":\"PositionOfInterest\",\n                 \"x\":-1.559185,\n                 \"y\":47.952603,\n                 \"city\":\"Brie\",\n                 \"zipcode\":\"35150\",\n                 \"street\":\"corbe\",\n                 \"kind\":\"Lieu-dit habité\",\n                 \"fulltext\":\"corbe, 35150 Brie\",\n                 \"classification\":6\n              },\n              {\n                 \"country\":\"StreetAddress\",\n                 \"x\":1.538295,\n                 \"y\":43.19646,\n                 \"city\":\"Brie\",\n                 \"zipcode\":\"09700\",\n                 \"street\":\"courreste\",\n                 \"kind\":\"\",\n                 \"fulltext\":\"courreste, 09700 Brie\",\n                 \"classification\":7\n              }\n           ]\n        }\n    */\n\n    /* REPONSE EN ERREUR\n        {\n            status : \"ERROR\",\n            results : [ ]\n        }\n    */\n\n    /**\n     * Suggested location type : \"StreetAddress\" ou \"PositionOfInterest\"\n     * @type {String}\n     */\n    this.type = null;\n\n    /**\n     * Position of the suggested location given in requested coordinates system.\n     * @type {Gp.Point}\n     */\n    this.position = {\n        x : null,\n        y : null\n    };\n\n    /**\n     * Suggested municipality\n     * @type {String}\n     */\n    this.commune = null;\n\n    /**\n     * Full text representation of the suggested location.\n     * @type {String}\n     */\n    this.fullText = null;\n\n    /**\n     * Suggested location postcode\n     * @type {Number}\n     */\n    this.postalCode = null;\n\n    /**\n     * Number used to classify the importance of the place where is the suggested location from 1 (most important) to 7 (less important).\n     * @type {Integer}\n     */\n    this.classification = null;\n\n    /**\n     * Street name of the suggested location (\"StreetAddress\" only).\n     * @type {String}\n     */\n    this.street = null;\n\n    /**\n     * Place name of the suggested location (\"PositionOfInterest\" only).\n     * @type {String}\n     */\n    this.poi = null;\n\n    /**\n     * Nature of the suggested location : \"prefecture\", \"monument\", \"commune\", ... for instance (\"PositionOfInterest\" only).\n     * @type {String}\n     */\n    this.kind = null;\n}\n\nSuggestedLocation.prototype = {\n\n    constructor : SuggestedLocation\n};\n\nexport default SuggestedLocation;\n","\n/**\n * Response object for {@link module:Services~getConfig Gp.Services.getConfig ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Object} generalOptions - General properties for default map configuration resources.\n * @property {Object} generalOptions.apiKeys - Object that associates apiKey (s) with an array of resources IDs availables with that key.\n * @property {String} generalOptions.title - Underlying web service Title.\n * @property {String} generalOptions.defaultGMLGFIStyle - XSL URL used by default to translate an XML GetFeatureInfo response into an HTML array.\n * @property {String} generalOptions.theme - default theme (FIXME : for what ?)\n * @property {Array.<Float>} generalOptions.wgs84Resolutions - geographical resolutions Array for each [zoom level of the Geoportal platform]{@link http://api.ign.fr/tech-docs-js/webmaster/layers.html#Geoportal_resolutions} from 0 to 21. Expressed in degrees/pixel.\n * @property {Object} layers - Associative array mapping resources availables IDs (keys) with their properties (values given as {@link Gp.Services.Config.Layer}).\n * @property {Object} tileMatrixSets - Associative Array mapping TileMatrixSets IDs (keys) availables with their properties (values given as {@link Gp.Services.Config.TileMatrixSet}).\n *\n * @namespace\n * @alias Gp.Services.GetConfigInterface\n */\nfunction ConfigInterface () {\n    if (!(this instanceof ConfigInterface)) {\n        throw new TypeError(\"ConfigInterface constructor cannot be called as a function.\");\n    }\n\n    this.generalOptions = {\n        apiKeys : {},\n        title : null,\n        defaultGMLGFIStyle : null,\n        theme : null,\n        wgs84Resolutions : []\n    };\n\n    this.layers = {};\n\n    this.tileMatrixSets = {};\n}\n\nConfigInterface.prototype = {\n\n    /*\n     * Constructor (alias)\n     */\n    constructor : ConfigInterface,\n\n    /**\n     * Check if config is loaded for a given key\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Boolean} isKeyConfLoaded - true if config of the key is already loaded, false otherwise\n     */\n    isKeyConfLoaded : function (apiKey) {\n        if (!apiKey) {\n            return;\n        }\n        if (this.generalOptions.apiKeys[apiKey]) {\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Returns an array of Geoportal layers identifiers, corresponding to an API contract key.\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Array} apiKeys - Array of geoportal layers identifiers\n     */\n    getLayersId : function (apiKey) {\n        return this.generalOptions.apiKeys[apiKey];\n    },\n\n    /**\n     * Returns the id of a Geoportal layer with its name and its service.\n     *\n     * @param {String} layerName - name of the layer (ex. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n     * @param {String} service   - name of the service (ex. \"WMS\" ou \"WMTS\")\n     * @returns {String} Id of the layer (ex. \"ORTHOIMAGERY.ORTHOPHOTOS$GEOPORTAIL:OGC:WMTS\")\n     */\n    getLayerId : function (layerName, service) {\n        if (!layerName || !service) {\n            return;\n        }\n        var layerId = null;\n\n        // layer\n        // key : [layerName]$[contexte]:OGC:[service]\n        // ex : \"ORTHOIMAGERY.ORTHOPHOTOS$GEOPORTAIL:OGC:WMTS\"\n\n        // service\n        // key : [layerName]$[contexte];[service]\n        // ex : PositionOfInterest$OGC:OPENLS;ReverseGeocode\n\n        if (this.layers) {\n            var layers = this.layers;\n            for (var key in layers) {\n                if (layers.hasOwnProperty(key)) {\n                    var parts = key.split(\"$\");\n                    if (layerName === parts[0]) {\n                        if (parts[1]) {\n                            var servicePartsLayer = parts[1].split(\":\");\n                            var servicePartsService = parts[1].split(\";\");\n\n                            if (servicePartsService[1] === service.toUpperCase()) {\n                                layerId = key;\n                                break;\n                            }\n                            if (servicePartsLayer[2] === service.toUpperCase()) {\n                                layerId = key;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (!layerId) {\n            return;\n        }\n        return layerId;\n    },\n\n    /**\n     * Returns an associative array of Geoportal layers configurations, corresponding to an API contract key.\n     * If no key is specified, all layers from configuration are returned.\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Object} layers - Object which properties are layers identifiers.\n     */\n    getLayersConf : function (apiKey) {\n        var layers = {};\n        var layersIdArray = this.getLayersId(apiKey);\n        if (layersIdArray) {\n            for (var i = 0; i < layersIdArray.length; i++) {\n                var lyrId = layersIdArray[i];\n                layers[lyrId] = this.layers[lyrId];\n            }\n        }\n        return layers;\n    },\n\n    /**\n     * Returns a geoportal layer configuration, given its identifier\n     *\n     * @param {String} layerId - Geoportal layer identifier (e.g. \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n     * @return {Object} layer - Layer configuration\n     * @see Gp.Services.Config.Layer\n     */\n    getLayerConf : function (layerId) {\n        if (!this.layers) {\n            return;\n        }\n        return this.layers[layerId];\n    },\n\n    /**\n     * Get all parameters needed to display a WFS, WMS or WMTS layer given its name, its service and its key\n     *\n     * @param {String} layerName - name of the layer (ex. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n     * @param {String} service   - name of the service (ex. \"WMS\" ou \"WMTS\")\n     * @param {String} [apiKey]  - Contract API key\n     * @returns {Object} params  - params of the service (WFS, WMS or WMTS) for the given layer\n     * @returns {String} params.url        - Url of the service to reach to display the layer\n     * @returns {String} params.version    - Version of the service\n     * @returns {String} params.styles     - Default style of the layer\n     * @returns {String} params.format     - Default format of the layer\n     * @returns {String} params.projection - Default projection of the layer\n     * @returns {Number} params.minScale   - Min scale denominator of the layer\n     * @returns {Number} params.maxScale   - Max scale denominator of the layer\n     * @returns {Gp.BBox} params.extent    - Extent of the layer, in the projection of the layer\n     * @returns {Array} params.legends     - Array of legends associated to the layer\n     * @returns {Array} params.title       - Name of the layer, readable by a human\n     * @returns {Array} params.description - Description of the layer\n     * @returns {String} params.[TMSLink]          - Id of the Tile Matrix Set (TMS), in the case of WMTS layer\n     * @returns {Gp.Point} params.[matrixOrigin]   - Originof the tile matrix (top left corner), in the case of WMTS layer\n     * @returns {Array} params.[nativeResolutions] - Array with the resolution of each level of the tile matrix set, in the case of WMTS layer\n     * @returns {Array} params.[matrixIds]         - Array with the ID of each level of the tile matrix set, in the case of WMTS layer\n     */\n    getLayerParams : function (layerName, service) {\n        var params = {};\n\n        if ((service === \"WMS\" || Object.keys(this.tileMatrixSets).length !== 0) && Object.keys(this.layers).length !== 0) {\n            // get the layerId of the layer\n            var layerId = this.getLayerId(layerName, service);\n\n            if (layerId) {\n                // get the layer Conf Object\n                var layerConf = this.getLayerConf(layerId);\n\n                var keys = this.getLayerKey(layerId);\n                if (keys.length === 0) {\n                    return;\n                }\n\n                // get services params\n                for (var i = 0; i < keys.length; i++) {\n                    // only one serverUrl is saved in Gp.Config : with multiKeys, we have to retrieve the key used in the serverUrl property\n                    if (layerConf.serviceParams.serverUrl[keys[i]]) {\n                        params.url = layerConf.serviceParams.serverUrl[keys[i]];\n                    }\n                }\n\n                if (service !== \"WFS\") {\n                    const wmsTypeRegex = /\\/v\\//;\n                    // WMS vector style always empty (not in getCap)\n                    if (wmsTypeRegex.test(params.url)) {\n                        params.styles = \" \";\n                    } else {\n                        // WMS raster style is defined in getCap\n                        params.styles = layerConf.styles[0].name;\n                    }\n                }\n\n                params.version = layerConf.serviceParams.version;\n                params.format = (layerConf.formats && layerConf.formats.length) ? layerConf.formats[0].name : \"\";\n                params.projection = layerConf.defaultProjection;\n\n                // get layer info and constraints\n                params.minScale = layerConf.globalConstraint.minScaleDenominator;\n                params.maxScale = layerConf.globalConstraint.maxScaleDenominator;\n                params.extent = layerConf.globalConstraint.bbox;\n                params.legends = layerConf.legends;\n                params.title = layerConf.title;\n                params.description = layerConf.description;\n\n                if (service === \"WMS\") {\n                    params.metadata = layerConf.metadata;\n                }\n\n                // Informations  non disponibles avec les getCap\n                // params.metadata = layerConf.getMetadata();\n                // params.originators = layerConf.getOriginators();\n                // params.quicklookUrl = layerConf.getQuicklookUrl();\n\n                // WMTS : get the tileMatrixSetLimits\n                if (layerConf.wmtsOptions) {\n                    params.tileMatrixSetLimits = layerConf.wmtsOptions.tileMatrixSetLimits;\n                    var TMSLink = layerConf.wmtsOptions.tileMatrixSetLink;\n                    if (TMSLink) {\n                        params.TMSLink = TMSLink;\n                        var tmsConf = this.getTMSConf(TMSLink);\n                        // Get matrix origin : Gp.Point = Object{x:Float, y:Float}\n                        // params.matrixOrigin = tmsConf.getTopLeftCorner();\n                        params.matrixIds = Object.keys(tmsConf.tileMatrices);\n                        params.tileMatrices = tmsConf.tileMatrices;\n                        // by default, pseudo mercator resolutions\n                        params.nativeResolutions = tmsConf.nativeResolutions || this.getTMSConf(\"PM\").nativeResolutions;\n                    }\n                }\n            }\n        }\n        return params;\n    },\n\n    /**\n     * Get the contract key(s) associated to a given layer.\n     *\n     * @param {String} layerId - Geoportal layer identifier (e.g. \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n     * @return {Array} layerKey - array of key(s) associated to the given layer\n     */\n    getLayerKey : function (layerId) {\n        var layerKey = [];\n        if (this.generalOptions && this.generalOptions.apiKeys && Object.keys(this.generalOptions.apiKeys).length !== 0) {\n            var resourcesByKey = this.generalOptions.apiKeys;\n            for (var key in resourcesByKey) {\n                var resourcesArray = resourcesByKey[key];\n                resourcesArray.forEach(function (arrayLayerId) {\n                    if (arrayLayerId === layerId) {\n                        layerKey.push(key);\n                    }\n                });\n            }\n        }\n        return layerKey;\n    },\n\n    /**\n     * Returns an associative array of Tile Matrix Sets configurations.\n     *\n     * @return {Object} tileMatrixSets - Object which properties are TMS identifiers\n     *\n     */\n    getTileMatrixSets : function () {\n        return this.tileMatrixSets;\n    },\n\n    /**\n     * Returns a Tile Matrix Sets configuration, given its identifier.\n     *\n     * @param {String} tmsID - Tile Matrix Set identifier (e.g. : \"PM\")\n     * @return {Object} tileMatrixSet - Tile Matrix Set configuration\n     * @see Gp.Services.Config.TileMatrixSet\n     */\n    getTMSConf : function (tmsID) {\n        if (!this.tileMatrixSets) {\n            return;\n        }\n        return this.tileMatrixSets[tmsID];\n    },\n\n    /**\n     * Get global constraints for a given Layer : extent, minScale, maxScale, projection\n     *\n     * @param {String} layerId - Geoportal layer identifier (e.g. \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n     * @returns {Object} params - layer constraints\n     * @returns {String} params.projection - default layer projection\n     * @returns {Number} params.minScale   - layer min scale denominator\n     * @returns {Number} params.maxScale   - layer max scale denominator\n     * @returns {Gp.BBox} params.extent    - layer extent expressed in the layer projection\n     */\n    getGlobalConstraints : function (layerId) {\n        var params = {};\n\n        if (layerId) {\n            // get layer configuration object\n            var layerConf = this.getLayerConf(layerId);\n            params.projection = layerConf.defaultProjection;\n            params.minScale = layerConf.globalConstraint.minScaleDenominator;\n            params.maxScale = layerConf.globalConstraint.maxScaleDenominator;\n            params.extent = layerConf.globalConstraint.bbox;\n        }\n\n        return params;\n    }\n\n};\n\nexport default ConfigInterface;\n","module.exports = ol.Feature;","var Marker = {\n    lightOrange : \"data:image/png;base64,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IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjkyYWVkNjM2LWY3MDMtNDAzOC1hNzM4LWZiYzYxYzZlMTljNCIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NWMzZWI3NC0zYWRmLTRkYzUtOWZjZS1iODQ4NTc3Nzg4ODQiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NjI3ZDg3NC1lZDIyLTRiZTUtYTlkNS00NDlmMzVhZDIxYzgiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE5Mjc4OTUzMDYiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphM2U3ZWQ1MS0xNTI4LTRhYjAtODVjOS0zNzNkNzgxZGM2ZmMiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI1OjI3KzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PofUkY4AAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGRuA4VZTAAAFcElEQVRYw82YW2xbVRaGv7XP8bHjXByHQkNhWigdVX1AikRBMBoQ8wASl4fRqPDAAxIPKAVxeRqQRohHBEVCaoGKUBCl4qHcNKCZVKMRRQxtgTaACLRKqlwB14NzM2ni2D2XvXjgBFXQOnFiA1uy/HB89u9/7bX+vf4l1HnpK57hTNCE0AzqAS5gAAuEID5KiWSiLPf4tp7YUjcSu4yLZzdi2IJyNXANcBlwAdAKzAHTwDhwDKEPywC+GZWHbPi7IKOvZIWguAnlr8BtwJ+AxDJeDYCPgF6Ed0hkh+Weov5mZLTHJMDeBjwYk0itYJtKTOpZML3SbYNfnYz2SBr0buARYENcFytdFvga2AGyT7p14Vcjoz3ShOgdKDuAi+pUewpMIDyCypvSreWGk9HdroOEV2F4A1hfTxGJCX2D5U7U/UzuD6NaXq49NRJhBsOjwMVLEtE4gaL4W5cV3IsxPEoizDT0ZLTHcSH6M/BWLLlVwpQKuPzhb+i8sRkv04Y/e5rvPigxtnM9trKU2k0D28A5LN3RsmXbrbFOU8DtQLpqfJqu97nh6TydmzvwWpOI8VDbxqbrkmz62yk+/Ps6yoe8KkeV/hHHfgrMNyrNEkBX1SAktgRs3T7ApV1rSWayiEkDLmLSJDNZLu1ay9btAyS2BEsEuWuZ99WKyRhgHeCcn8wGw/qbOnAS3jmfOwmP9Td1kNhQDduJcUwjyciS0RJXMMkWkPPUo/z4XFxZRhZII8mEwFCsT+f5xXTE7FAOteduItVaZodyhNPVZDeKccJGkxmsChIMOvTt6aRSzIP+7A9rRKWYp29PJ8GgsyqcVauZSADaj+IDTecWvBlD4e01HKjM07XtOOuuy+A2X0BYmib/8SxfvLWRYm8LdqZaCvkI/SDBci6nld0ze7KCLa4F3gSurR4MB5x1FnMhiCeor9hJiPKmWpbGp3EU2IbJFuTe5XfStbczLxgP7K0IPcCFDWhnJoFuMAek2/oNbWdku/WxHATejT1JPZcPvINysFYiK+gAFkXTK6H+MyhXADeseJ9fmrVDM6X080/+p1M2/yFsD1zjEIauEeMAqNpQE16oaKiqwfjYeLk+fuYl10HDq7DsBTavxs8o6FzFKez/dM3rLx9LjUyVxcb7yVkfzmpXFbACJURHIxgyxkyu1ml6qL0Z4YX4xl7Jfrrgm9Ov9bX/e++x1tHCgkQ11lgELGA4sBp3iHRbH5GDwJPAFLXo6KJnDmTh/aG2w2/3t47VSGQxs1zAE9U2s9pEjx3hXuBloCa7G1rxv8o3f/7SkUz/UFFWMqGRWMpHAqsDbl00KGotIXM7MawF7gKSS5oJJRospI7v+rD96Ikp8aV2EgrkVPW4OnIy6SVL9ZubvZgyaOVyYDfwl2oNqVWiXNEb231oTe+/BrzvK9Gy01MFyoiOKzIEmqsEfjGf/39U1yHgosJFUXhlFMl+z9E/nkvhVNHZsjux+9Caf77RnyzMBaJLmW4RrWAlB3Y4Uh13HLOA4wQjo6O2IRPNxVV4JuG5Et2SSelzjtFLzsZQ0NIZ8/2rx7K9+/paxqbKvyh4Bc4AFQxzau23Dow7FS+nHmfEUz05OqINH8+evXJPJVOuE93XkY4eSziaXcQpB2b+vZNt7+/8IPPl2OxPRMJ4dDsLzIho3hpzamJ6aqJ0ei6qtZAasmZ2OS1RyOMd6egBIzSFVoKj4y1Hnvhv+8cD02ZOkEmgIKITVnXKWDs1ksvNrgbTbRSZ46cypY50aWcllIsyKXvr8GTyi9f6WvePFGVQhO8EPW2NzI+OfV2pF2bDTgbg8D/aJeVUspd1BK3/G24u7/skO3+iYP3h3LdhI/B+AGodUpo8WKwoAAAAAElFTkSuQmCC\",\n    darkOrange : \"data:image/png;base64,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czpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjIxNDZjMzUzLWIxZjItNGVjOC04NzQ3LTIwMGEyYWExM2ViMyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NGViNmI2Ni03Y2I2LTRkZGUtYTI3OS01MGY0ZWFiZGFhODAiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1ODRhM2VjZC1kNGFmLTQ3NjItYjA1ZS04ODk2MGQ4ZTk0Y2MiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE5MDM3ODI2MTQiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxYzNjOGRkZi1kMjVkLTQ4YzQtYTAwYS0yMmU3ZDYwMzg1YjYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI1OjAzKzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PuhCAHgAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGQOTjc4FAAAFdklEQVRYw82YW2gcZRTHf+eb2dlkc9lsrFYr2notfSgWxKKiog8VvIFI9UFQEaWtYPFJfREfRRSEeqlttViLD/WGisYXrShWpfWC1WpSN5eN3cZumkuTzWY3c/mOD9lI0WSTTXbVA8M8zMz3n//5zvl/5xyhxqb3ewYvaERpAvUAFzCABUIQH6GAHyvKa76tJbbUjMRW4+LbC7GsQbgCWA+sAs4AWoA8MAxkgEMo32LoxDO98oIN/xdk9IGUYEYvRrgduAW4Gogt4NMA+BroQHkfm+qW3aP6n5HRTSYG9hZga5lEwyKWKZVJvQCmQ3bZ4F8no5skAXov8BiwspwXizUL9APPgOyVXTr5r5HRzdKI1TsRngHOqlHuKTCI8hhG3padWqw7GX3IddDwcixvAefXUkTKhH7HcBfifi8vh1E1H1cfGkGYxPI4cM68RGw5zf3y3S7IuedgeZwgTNZ1Z3Sz46LRNcA7Zcmd25yGgPWP/M7q65toTLZSHBvn6OcFDm07n6g0n9oNAxsR54DsjBYs2251QWAbgFuBREX/tF3rc9+zA6xa3U5jSxwxHmpbueyqOOvvOM7rj67g1JfedFTNagngVtR+B0zUK8xiwLqKTmhcE3Dblk4uXbecRDKFmATgIiZBIpni0nXLuW1LJ41rgnmcvG6B59WiyRhgBeDM+UZipWHthnbcmDf7b8Y81m5oJ7GyErZTxjH1JCPzesu4ghtvBpkjH2X6uXFlAVEg9SMjhEAamFsyp4Yjcuks1s6uXdZacuksU8OVZDcC0mW8OpFRQqBruvqdwwpdDh+9cjaF0QHQv/2wRhRGB6afdzkVkKZxtDoyVaqZBKCHEXygcXafjhi63l3G9tIEGzYe4ZKrksSbzmCqMEz6mzE+eedC+juaiUYqhZCPchgkqKB4SzxntqQEO7oceBu4srIzHIitsMTOBOMJ1leCkxAMmEpRWt6Vg8BGTConOxZeSVdfzmwxHmpvRtkJnFmHcuYksBkxH8tO69e1nJEd1sdhP/BBuUippfnA+3jsr5ZI9TnzV33mFcB/DuEi4LpFr/PPZu3LkanES08fOltWnxe2Ba5xCEPXiHEAVG2oMS9UNFTVINOXKdamn3nQdSC8HMMeYPVS+hkFzQdObl9m2Zu7+xt6hkKx5fXktGumdNXyZQUKiPZGkDbGnFxqp+kh9kaUHeUTezHr6WRkxt/oa/toT39Lby6QqMoci4BJDB8vpTtEdlkflf3A08AQ1ejoTM8cyeRnudYD72Zb+qokMhNZLuCJaqtZaqDLLi0i7EHYDVTV7oZW/J9PNf3wanfycLoki5nQSFnKewKrnW5NNMhtKRDlt6EsB+4G4vM2/UrUNd5w5Pl028FfiuJL9SQUyKrqEXXkaNyLF2o3N9vUYKB0AbAduKFSQWqVKFv0+rYfXdbx4aB3qqQLDk8VKCKaUSQNmi0F/ujAwB9RTYeAMwoXabg2QvZ5jl4ym8Ip6FjgDm7/bdl7bw3Ec/lItEJyWyAS0RJWsmC7I9WM45hJHCfo6e21dZlozlju3pjnSnRT0tMXHdFzT8dQ0EJoTr2eSXXs7W/uG/pnwiswBZQw5NXaYw5knJKXVY8p8VSP9vZo3cezp1v2nniDK9FD7V70RMxoaganGJmJT0+0frbtt+RPfVN/EQnLo9sxYEREB6wxxweHhwYL4/mo2kSqi43c5zRH8GS7Fz1shMZQJTg41PzVU7+2fdNZNHlBTgI5ER20qkPG2qGebHZsSTpULzJH8slCe6ywrWTlrGTM3tw9Ef/xjUzLvp6idIlwQtBxa2Sit6+/VCvMuu0MwIE726RBSqlViaDli6Gm4t6e1MQveet3Z4+F9cD7Ewo4WRJBbaaSAAAAAElFTkSuQmCC\",\n    red : \"data:image/png;base64,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293bv2fa/f0ASM5yljz/NiUAAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOmI5YjA2YTAwLWZkOTQtNDc5MC1hNzIzLTlkMGUwNGRiNTRlNyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1MTQ3ZGU5Yi1kOTA0LTRlNWYtYjIyYy0wZmMzOGRmMWI3ZGEiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4YzBjNTI2YS1lYTkyLTQxYWItODM5Yy05OWFhYTM0YjdlYzciCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE2NDAxNTU0MjYiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowMjQ4MDc5ZS1kMTYyLTQxZmItOGViYS1lMzY2NTRiNGRjMjYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjIwOjQwKzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PkaovgIAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPFCiKn0kIAAAFfUlEQVRYw82YTWxc1RXHf+e+N2/GH+Px2IEEV02AgqIsIkwgoYS2ahepVGCBUOiCRRdsAAnECthErBBCICGFj4gqRQqBRSABUrVm1URtCSATJ5ASZCPHH0kGgx1/xJl5nvH7uIcFY4iIM/GzZyhHenqL994993/u+f/fOUeos+nNnkHCJoQWRD0UFzCARYhQCVB8NFWWTwNbT99SNxC3GZfIXg9sADYDWxCuRekEskARYQplFPgEOAr045ph6bXRzwKM3pEX5mduQLkHuAvYCqSW8GkIfAT0IBwknT8lH87o/w2M3mpSqL0LeLQKIrOMZSpVUC8hpkf6bPiTg9FbpBn0L8ATwLoqL5ZrFjgNPAeyV47p3E8GRjdLE6r3oTwHXF0n7ikwgfAEIvvlqJYbDkY3uw4a3YLyNrC2niJSBXQG4c+Ie0yORnGSj5OnRhzlUJ4ErrkikBAoAjPVe7ik4F6D8iRxlGvoyegmx4X4NwgHgM6a8fUyIfc8doZbf99Ca66N0uwF+v7tc3DnWoJK6gqep1C2g3NEjsdLlm03GXSbAe4GmmvGZ91vA3Y8P8aN6ztoyaYxxsPaNrbcnmbbvV/x9ONdnPnA+w71otaMcDfYPqDUmDQTUgjdNYPQsSHkgYf62di9mmwujzHNgIsxzWRzeTZ2r+aBh/rp2BDWDLLQjSzpf7VMMIpB6QKcy77Tuc6wdVsHbspbfJspj63bOuhcV8u3g9KFJtufWQbHakfLdQUv3YrI4qwQ+e65616Jr6mknE4KJgIGgctLZnEq5vRgAWsXLyKttZweLFCcqiW7cdVP1DgwQoQwUNPJxIDDG7vXMDszBvqjDWvM7MwYb+xew8SAUzNowgCSDEwyNVMJQU8AAdC06DvBtOG/76xirlLi3u0nufn2HJmWTir+FJ9+PMu7B66nr6eVYLpWCgUoJ0DCGoq3wv/MbXkhmlkN7Ad+XTMY4kBTl6XlKnA8IQ4U/xyUx8wlB3ZpKvcC23Hz49K79Ep6GeWM8VB7J8pfgasaUM6cAx5EzPvSZ4OGljNy1AYIh4C/L6lASWYBcBCHQ0mBJOfM94rk+WjwAsKvgN8te51LK7kPpm3zK89OrZH1v4zaQ9c4RJFrxDgAqjbSlBcpGqlqODoyWq5TP1OtnoU9wPqV9DMKWlRnfJ+/6q3XKpmhSRVbXU8uuhb6Hq1eVsBHdDiGQWPMuZV1mpuMB/aPCK8CXcsMjs6pufCm3/7PPZXs8LhKnJBjMTCH4f2VdIfIcRsgcgh4FpgkiY4u9Mwqc4fn2468M58dSQhkIbNcwBPVNrPSRJdjWgb2AK8BidrdSCX4PGw5/re53IlBK8uZ0EhVyodCq/1uXTTIzfrExZ0oq4H7gfQSmv54IMqcfNFv7/0ilkCSg1CgoKon1ZEv017ar9/cbEvGEFeuQ9mF8IdaBamFuBB7I7tKq3r+EXjnK0tPTxUoIzqqyCBooRIGM2NjX8d1HQIuKFys0cYY2eeJ3riYwinorHUndvmr3nt7Pj1eVNEa5LZALKIVrBTAnopVRx3HzOE44dDwsG3IRHPBxrtTnkv8p5yjLzvoLy72oaC+mvOvz+V79pZbRyYvJbwC80AFQ1GtPevAqFPxCuoxL57ql8ND2vDx7MVW2JTOuMQPdxDvSInmF/yU1ZT+Nd92eGcp97+RH4BE1XHHLDAtomPWmK8mpiYn/AvFOCmRGmLTm53WOOKpDhM/YqApQsLe+dYPnym1f9xvTVGQc8C4iE5Y1Ulj7eRQoTC7Ih1qFJiTQc7vwN9ZUbk6Z+ydp6L0Z2+Ws/uGrAyI8I2gF6yR0vDI6Uq9fDbsZACO3NQuGa3kr3XC7H+ClvJeP1/6IrbBqbNno0b4+xbMlmARngcRbAAAAABJRU5ErkJggg==\",\n    turquoiseBlue : \"data:image/png;base64,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/MUi8H5G35QHBm+BvjV3bu1znD4AWZpV+gY4OARGS5S97vHu3u65/XunPb8fN2tyj8UDOK0AAA0aaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjEwNGNlNWFhLTE1YzctNGI4Yi1iOGU1LTFmYWQyNWFiYzBhZCIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkNDMyZTY1Zi0xOThhLTQxM2EtYWYyMy1jNzhlNzczNGRlN2QiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyNzExODVkMi03MWZiLTRhZDMtYTJmMi1iNjM3OWU3MDc1OTEiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE2ODQ5NDE4NjYyMzgzMjQiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1NGFiYzNkYS1lZWJiLTRlZjctYjdjNS04ZDRjODY5OGVjODMiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTA1LTI0VDE3OjI0OjI2KzAyOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pj0tlUwAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfnBRgPGBru/VeEAAAABmJLR0QA/wD/AP+gvaeTAAAFO0lEQVRYw9WYe2xTVRzHTx97dYS5B1UHa+/tY12dDoOKWyIGlfgHkCkSNTHGwHxA3NiAP/A5x4CMKEzdYL29YyAyBxKQZbI+NvYIaowaH9Ogi2GRbGjcFrbBNrq2a2/9nq5LCFnbbfSOeZJPTs/t6Tm/7/39zu+cU0IiXc7WSImNX0BsZiVYAhigmah5tHklsZrjSYtJSuZtaeSiiJU3gHUwfC9oARfBIHBP1DzaPH1eRuzmp0E6aTgSNX9EWMwSvOkMGPgG+CpguG8a0H7nA78zkMYqye0V0lYXDSHrYUw7cE5TxM04/b+38+vJ+RPRt0eIjVeAAhhyCQizFDKJEBjndaCY49Di4+CRlzFxfwSE3Ciol9i4DSBujoRUy7HIszFxdwSF3CioBy8qm1g5ufhirHwyJqwHrrDGWTlg8hFL1URN2+EF0XFPkyYuSWwhUVgnT2CygXBG3dFcM7bz1/au1u7OK9/93eWidUlHe1dCc810EsUAsXOPQZCI3rGZ6Wb4EXAEM0SCUFnZduz6T/09l4bHXYOCz+f0+XxeWg+7XYM/4vnKtlqHJHSIOrAHlYMFYmawRNCKycaDGZLVfMRdf/nPDpfXM+abotDnpy93dtzXfNgdZg+im2uimJ6h66UTeIMZsrat1jvkdPRRb/imLt4hl6N3DfqFEIPvOMzDJYspJsWfbUKEyFNttcKoyzkKo4UgYoRRt3OE9guT1br984nsmQ7gCWbIipaj4xeu9v/hFQTPlG7B89+u9v9O+4UQQ8f/BSlaVM8kgBOhji4p9mpvwQ+Wfwddjp6bQw2u8g44HT3535/tTUa/0Eccvg4sFDE1m2PBZkx2LVRqVcLQvG/PDDX1/tVxze38x+UZH6O1He28b764qgwtxOcf327eBGLFE9NikiD3qzDZhVBJgCJH3KubDnkfbD4s5Jw74qM1bcvDnxq8/vHt1SrS9InIJ2m7OQ4UYsKhCB9lJqHj0gPsHJzPvsS9w8rRRPDptI40M8PlH9fOJ5M5K008rsZmIwi5gc4QN9Zja8zn+5epch9PTFepU1iGuVunVqeyS9g0iv8zy96l0WiSjIsXx28iJEJhaONkMGB5YP14bkmI1SzIz1T0pRa9VKnNzCjUMcwWUAS2BtgWYLJN+xTo1OyrOhW7xsAwqnSGkd3i+uGjkT5Xw6DLt3AdEKQNB4YXbdtwQpuVuRtG7pwhxWA7vJgRib0nDuSDvtkIkjYcHE3aVWjRLL9/zyyETPK2Vq3OidAaOhiPDLcbxo3MRIik0eReWPnO15pHHiqbpYhS6hkNw7wAz0To6GM5hAzH3wkDa6b7x4bEwnkUfMnP6idX7Nex7GxElIDNerV6hU6jSdbp9RHck2w0w/FaGGoJm7KtnCfmWNlF1fOrK3Q6bekMRFABO7QM8yxewFLUi+5JSxPpAmcxy0gjt1Rytir4NcHKCfJTH/al5j1j1hr0pWEML55YD+x2GP6cVqNZZjQYEvUsG4vP4v8jKju5L1p6qnytxGKa6qogyOorBpVbXvxMe69xdxABb9I0DAGvIIRWp7NsBsJIoWVZKfaXuf+jMKp2b6z8+Adb4aErNwpCCh5J2pnfoH0ga08g7invBfaQjXjjuQifhyEgLdNolJP5UqR17y+QnSwvk1i565OZK6F8RzubvWwvDH8LvKZnmHXY8HKws+sNLJtI5muJ/7hYElOzJ1V+fN9R7CVDClPJOVXuqo06vS4HQjTwgDKDZRXk/1JiD7wrieFLk6T1lczCXUVK7aPZinS9XrTw+Q+Tql7SUmvGuQAAAABJRU5ErkJggg==\",\n    defaultOffset : [-25.5, -32]\n};\n\nexport default Marker;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = ol.Collection;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.tilegrid.WMTS;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.format.MVT;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.format.WMSCapabilities;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.format.WMTSCapabilities;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.layer.Tile;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.source.VectorTile;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.source.TileJSON;","var $version = 8;\nvar $root = {\n\tversion: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: [\n\t\t\t8\n\t\t]\n\t},\n\tname: {\n\t\ttype: \"string\"\n\t},\n\tmetadata: {\n\t\ttype: \"*\"\n\t},\n\tcenter: {\n\t\ttype: \"array\",\n\t\tvalue: \"number\"\n\t},\n\tcenterAltitude: {\n\t\ttype: \"number\"\n\t},\n\tzoom: {\n\t\ttype: \"number\"\n\t},\n\tbearing: {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tperiod: 360,\n\t\tunits: \"degrees\"\n\t},\n\tpitch: {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tunits: \"degrees\"\n\t},\n\troll: {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tunits: \"degrees\"\n\t},\n\tlight: {\n\t\ttype: \"light\"\n\t},\n\tsky: {\n\t\ttype: \"sky\"\n\t},\n\tprojection: {\n\t\ttype: \"projection\"\n\t},\n\tterrain: {\n\t\ttype: \"terrain\"\n\t},\n\tsources: {\n\t\trequired: true,\n\t\ttype: \"sources\"\n\t},\n\tsprite: {\n\t\ttype: \"sprite\"\n\t},\n\tglyphs: {\n\t\ttype: \"string\"\n\t},\n\ttransition: {\n\t\ttype: \"transition\"\n\t},\n\tlayers: {\n\t\trequired: true,\n\t\ttype: \"array\",\n\t\tvalue: \"layer\"\n\t}\n};\nvar sources = {\n\t\"*\": {\n\t\ttype: \"source\"\n\t}\n};\nvar source = [\n\t\"source_vector\",\n\t\"source_raster\",\n\t\"source_raster_dem\",\n\t\"source_geojson\",\n\t\"source_video\",\n\t\"source_image\"\n];\nvar source_vector = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvector: {\n\t\t\t}\n\t\t}\n\t},\n\turl: {\n\t\ttype: \"string\"\n\t},\n\ttiles: {\n\t\ttype: \"array\",\n\t\tvalue: \"string\"\n\t},\n\tbounds: {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 4,\n\t\t\"default\": [\n\t\t\t-180,\n\t\t\t-85.051129,\n\t\t\t180,\n\t\t\t85.051129\n\t\t]\n\t},\n\tscheme: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\txyz: {\n\t\t\t},\n\t\t\ttms: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"xyz\"\n\t},\n\tminzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 0\n\t},\n\tmaxzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 22\n\t},\n\tattribution: {\n\t\ttype: \"string\"\n\t},\n\tpromoteId: {\n\t\ttype: \"promoteId\"\n\t},\n\tvolatile: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\t\"*\": {\n\t\ttype: \"*\"\n\t}\n};\nvar source_raster = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\traster: {\n\t\t\t}\n\t\t}\n\t},\n\turl: {\n\t\ttype: \"string\"\n\t},\n\ttiles: {\n\t\ttype: \"array\",\n\t\tvalue: \"string\"\n\t},\n\tbounds: {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 4,\n\t\t\"default\": [\n\t\t\t-180,\n\t\t\t-85.051129,\n\t\t\t180,\n\t\t\t85.051129\n\t\t]\n\t},\n\tminzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 0\n\t},\n\tmaxzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 22\n\t},\n\ttileSize: {\n\t\ttype: \"number\",\n\t\t\"default\": 512,\n\t\tunits: \"pixels\"\n\t},\n\tscheme: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\txyz: {\n\t\t\t},\n\t\t\ttms: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"xyz\"\n\t},\n\tattribution: {\n\t\ttype: \"string\"\n\t},\n\tvolatile: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\t\"*\": {\n\t\ttype: \"*\"\n\t}\n};\nvar source_raster_dem = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\t\"raster-dem\": {\n\t\t\t}\n\t\t}\n\t},\n\turl: {\n\t\ttype: \"string\"\n\t},\n\ttiles: {\n\t\ttype: \"array\",\n\t\tvalue: \"string\"\n\t},\n\tbounds: {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 4,\n\t\t\"default\": [\n\t\t\t-180,\n\t\t\t-85.051129,\n\t\t\t180,\n\t\t\t85.051129\n\t\t]\n\t},\n\tminzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 0\n\t},\n\tmaxzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 22\n\t},\n\ttileSize: {\n\t\ttype: \"number\",\n\t\t\"default\": 512,\n\t\tunits: \"pixels\"\n\t},\n\tattribution: {\n\t\ttype: \"string\"\n\t},\n\tencoding: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tterrarium: {\n\t\t\t},\n\t\t\tmapbox: {\n\t\t\t},\n\t\t\tcustom: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"mapbox\"\n\t},\n\tredFactor: {\n\t\ttype: \"number\",\n\t\t\"default\": 1\n\t},\n\tblueFactor: {\n\t\ttype: \"number\",\n\t\t\"default\": 1\n\t},\n\tgreenFactor: {\n\t\ttype: \"number\",\n\t\t\"default\": 1\n\t},\n\tbaseShift: {\n\t\ttype: \"number\",\n\t\t\"default\": 0\n\t},\n\tvolatile: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\t\"*\": {\n\t\ttype: \"*\"\n\t}\n};\nvar source_geojson = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tgeojson: {\n\t\t\t}\n\t\t}\n\t},\n\tdata: {\n\t\trequired: true,\n\t\ttype: \"*\"\n\t},\n\tmaxzoom: {\n\t\ttype: \"number\",\n\t\t\"default\": 18\n\t},\n\tattribution: {\n\t\ttype: \"string\"\n\t},\n\tbuffer: {\n\t\ttype: \"number\",\n\t\t\"default\": 128,\n\t\tmaximum: 512,\n\t\tminimum: 0\n\t},\n\tfilter: {\n\t\ttype: \"*\"\n\t},\n\ttolerance: {\n\t\ttype: \"number\",\n\t\t\"default\": 0.375\n\t},\n\tcluster: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\tclusterRadius: {\n\t\ttype: \"number\",\n\t\t\"default\": 50,\n\t\tminimum: 0\n\t},\n\tclusterMaxZoom: {\n\t\ttype: \"number\"\n\t},\n\tclusterMinPoints: {\n\t\ttype: \"number\"\n\t},\n\tclusterProperties: {\n\t\ttype: \"*\"\n\t},\n\tlineMetrics: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\tgenerateId: {\n\t\ttype: \"boolean\",\n\t\t\"default\": false\n\t},\n\tpromoteId: {\n\t\ttype: \"promoteId\"\n\t}\n};\nvar source_video = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvideo: {\n\t\t\t}\n\t\t}\n\t},\n\turls: {\n\t\trequired: true,\n\t\ttype: \"array\",\n\t\tvalue: \"string\"\n\t},\n\tcoordinates: {\n\t\trequired: true,\n\t\ttype: \"array\",\n\t\tlength: 4,\n\t\tvalue: {\n\t\t\ttype: \"array\",\n\t\t\tlength: 2,\n\t\t\tvalue: \"number\"\n\t\t}\n\t}\n};\nvar source_image = {\n\ttype: {\n\t\trequired: true,\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\timage: {\n\t\t\t}\n\t\t}\n\t},\n\turl: {\n\t\trequired: true,\n\t\ttype: \"string\"\n\t},\n\tcoordinates: {\n\t\trequired: true,\n\t\ttype: \"array\",\n\t\tlength: 4,\n\t\tvalue: {\n\t\t\ttype: \"array\",\n\t\t\tlength: 2,\n\t\t\tvalue: \"number\"\n\t\t}\n\t}\n};\nvar layer = {\n\tid: {\n\t\ttype: \"string\",\n\t\trequired: true\n\t},\n\ttype: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tfill: {\n\t\t\t},\n\t\t\tline: {\n\t\t\t},\n\t\t\tsymbol: {\n\t\t\t},\n\t\t\tcircle: {\n\t\t\t},\n\t\t\theatmap: {\n\t\t\t},\n\t\t\t\"fill-extrusion\": {\n\t\t\t},\n\t\t\traster: {\n\t\t\t},\n\t\t\thillshade: {\n\t\t\t},\n\t\t\tbackground: {\n\t\t\t}\n\t\t},\n\t\trequired: true\n\t},\n\tmetadata: {\n\t\ttype: \"*\"\n\t},\n\tsource: {\n\t\ttype: \"string\"\n\t},\n\t\"source-layer\": {\n\t\ttype: \"string\"\n\t},\n\tminzoom: {\n\t\ttype: \"number\",\n\t\tminimum: 0,\n\t\tmaximum: 24\n\t},\n\tmaxzoom: {\n\t\ttype: \"number\",\n\t\tminimum: 0,\n\t\tmaximum: 24\n\t},\n\tfilter: {\n\t\ttype: \"filter\"\n\t},\n\tlayout: {\n\t\ttype: \"layout\"\n\t},\n\tpaint: {\n\t\ttype: \"paint\"\n\t}\n};\nvar layout = [\n\t\"layout_fill\",\n\t\"layout_line\",\n\t\"layout_circle\",\n\t\"layout_heatmap\",\n\t\"layout_fill-extrusion\",\n\t\"layout_symbol\",\n\t\"layout_raster\",\n\t\"layout_hillshade\",\n\t\"layout_background\"\n];\nvar layout_background = {\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_fill = {\n\t\"fill-sort-key\": {\n\t\ttype: \"number\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_circle = {\n\t\"circle-sort-key\": {\n\t\ttype: \"number\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_heatmap = {\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_line = {\n\t\"line-cap\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tbutt: {\n\t\t\t},\n\t\t\tround: {\n\t\t\t},\n\t\t\tsquare: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"butt\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"line-join\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tbevel: {\n\t\t\t},\n\t\t\tround: {\n\t\t\t},\n\t\t\tmiter: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"miter\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-miter-limit\": {\n\t\ttype: \"number\",\n\t\t\"default\": 2,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"line-join\": \"miter\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"line-round-limit\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1.05,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"line-join\": \"round\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"line-sort-key\": {\n\t\ttype: \"number\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_symbol = {\n\t\"symbol-placement\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tpoint: {\n\t\t\t},\n\t\t\tline: {\n\t\t\t},\n\t\t\t\"line-center\": {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"point\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"symbol-spacing\": {\n\t\ttype: \"number\",\n\t\t\"default\": 250,\n\t\tminimum: 1,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"symbol-placement\": \"line\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"symbol-avoid-edges\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"symbol-sort-key\": {\n\t\ttype: \"number\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"symbol-z-order\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tauto: {\n\t\t\t},\n\t\t\t\"viewport-y\": {\n\t\t\t},\n\t\t\tsource: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"auto\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-allow-overlap\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t{\n\t\t\t\t\"!\": \"icon-overlap\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-overlap\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tnever: {\n\t\t\t},\n\t\t\talways: {\n\t\t\t},\n\t\t\tcooperative: {\n\t\t\t}\n\t\t},\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-ignore-placement\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-optional\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-rotation-alignment\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t},\n\t\t\tauto: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"auto\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-size\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tunits: \"factor of the original icon size\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-text-fit\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tnone: {\n\t\t\t},\n\t\t\twidth: {\n\t\t\t},\n\t\t\theight: {\n\t\t\t},\n\t\t\tboth: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"none\",\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-text-fit-padding\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 4,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"icon-text-fit\": [\n\t\t\t\t\t\"both\",\n\t\t\t\t\t\"width\",\n\t\t\t\t\t\"height\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-image\": {\n\t\ttype: \"resolvedImage\",\n\t\ttokens: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-rotate\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tperiod: 360,\n\t\tunits: \"degrees\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-padding\": {\n\t\ttype: \"padding\",\n\t\t\"default\": [\n\t\t\t2\n\t\t],\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-keep-upright\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t{\n\t\t\t\t\"icon-rotation-alignment\": \"map\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"line\",\n\t\t\t\t\t\"line-center\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-offset\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tcenter: {\n\t\t\t},\n\t\t\tleft: {\n\t\t\t},\n\t\t\tright: {\n\t\t\t},\n\t\t\ttop: {\n\t\t\t},\n\t\t\tbottom: {\n\t\t\t},\n\t\t\t\"top-left\": {\n\t\t\t},\n\t\t\t\"top-right\": {\n\t\t\t},\n\t\t\t\"bottom-left\": {\n\t\t\t},\n\t\t\t\"bottom-right\": {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"center\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-pitch-alignment\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t},\n\t\t\tauto: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"auto\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-pitch-alignment\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t},\n\t\t\tauto: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"auto\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-rotation-alignment\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t},\n\t\t\t\"viewport-glyph\": {\n\t\t\t},\n\t\t\tauto: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"auto\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-field\": {\n\t\ttype: \"formatted\",\n\t\t\"default\": \"\",\n\t\ttokens: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-font\": {\n\t\ttype: \"array\",\n\t\tvalue: \"string\",\n\t\t\"default\": [\n\t\t\t\"Open Sans Regular\",\n\t\t\t\"Arial Unicode MS Regular\"\n\t\t],\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-size\": {\n\t\ttype: \"number\",\n\t\t\"default\": 16,\n\t\tminimum: 0,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-max-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 10,\n\t\tminimum: 0,\n\t\tunits: \"ems\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-line-height\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1.2,\n\t\tunits: \"ems\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-letter-spacing\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tunits: \"ems\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-justify\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tauto: {\n\t\t\t},\n\t\t\tleft: {\n\t\t\t},\n\t\t\tcenter: {\n\t\t\t},\n\t\t\tright: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"center\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-radial-offset\": {\n\t\ttype: \"number\",\n\t\tunits: \"ems\",\n\t\t\"default\": 0,\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\t\"property-type\": \"data-driven\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t}\n\t},\n\t\"text-variable-anchor\": {\n\t\ttype: \"array\",\n\t\tvalue: \"enum\",\n\t\tvalues: {\n\t\t\tcenter: {\n\t\t\t},\n\t\t\tleft: {\n\t\t\t},\n\t\t\tright: {\n\t\t\t},\n\t\t\ttop: {\n\t\t\t},\n\t\t\tbottom: {\n\t\t\t},\n\t\t\t\"top-left\": {\n\t\t\t},\n\t\t\t\"top-right\": {\n\t\t\t},\n\t\t\t\"bottom-left\": {\n\t\t\t},\n\t\t\t\"bottom-right\": {\n\t\t\t}\n\t\t},\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"point\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-variable-anchor-offset\": {\n\t\ttype: \"variableAnchorOffsetCollection\",\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"point\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tcenter: {\n\t\t\t},\n\t\t\tleft: {\n\t\t\t},\n\t\t\tright: {\n\t\t\t},\n\t\t\ttop: {\n\t\t\t},\n\t\t\tbottom: {\n\t\t\t},\n\t\t\t\"top-left\": {\n\t\t\t},\n\t\t\t\"top-right\": {\n\t\t\t},\n\t\t\t\"bottom-left\": {\n\t\t\t},\n\t\t\t\"bottom-right\": {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"center\",\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"!\": \"text-variable-anchor\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-max-angle\": {\n\t\ttype: \"number\",\n\t\t\"default\": 45,\n\t\tunits: \"degrees\",\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"line\",\n\t\t\t\t\t\"line-center\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-writing-mode\": {\n\t\ttype: \"array\",\n\t\tvalue: \"enum\",\n\t\tvalues: {\n\t\t\thorizontal: {\n\t\t\t},\n\t\t\tvertical: {\n\t\t\t}\n\t\t},\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"point\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-rotate\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tperiod: 360,\n\t\tunits: \"degrees\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-padding\": {\n\t\ttype: \"number\",\n\t\t\"default\": 2,\n\t\tminimum: 0,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-keep-upright\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": true,\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"text-rotation-alignment\": \"map\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"symbol-placement\": [\n\t\t\t\t\t\"line\",\n\t\t\t\t\t\"line-center\"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-transform\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tnone: {\n\t\t\t},\n\t\t\tuppercase: {\n\t\t\t},\n\t\t\tlowercase: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"none\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-offset\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tunits: \"ems\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"!\": \"text-radial-offset\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-allow-overlap\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t{\n\t\t\t\t\"!\": \"text-overlap\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-overlap\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tnever: {\n\t\t\t},\n\t\t\talways: {\n\t\t\t},\n\t\t\tcooperative: {\n\t\t\t}\n\t\t},\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-ignore-placement\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-optional\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": false,\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_raster = {\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar layout_hillshade = {\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n};\nvar filter = {\n\ttype: \"array\",\n\tvalue: \"*\"\n};\nvar filter_operator = {\n\ttype: \"enum\",\n\tvalues: {\n\t\t\"==\": {\n\t\t},\n\t\t\"!=\": {\n\t\t},\n\t\t\">\": {\n\t\t},\n\t\t\">=\": {\n\t\t},\n\t\t\"<\": {\n\t\t},\n\t\t\"<=\": {\n\t\t},\n\t\t\"in\": {\n\t\t},\n\t\t\"!in\": {\n\t\t},\n\t\tall: {\n\t\t},\n\t\tany: {\n\t\t},\n\t\tnone: {\n\t\t},\n\t\thas: {\n\t\t},\n\t\t\"!has\": {\n\t\t}\n\t}\n};\nvar geometry_type = {\n\ttype: \"enum\",\n\tvalues: {\n\t\tPoint: {\n\t\t},\n\t\tLineString: {\n\t\t},\n\t\tPolygon: {\n\t\t}\n\t}\n};\nvar function_stop = {\n\ttype: \"array\",\n\tminimum: 0,\n\tmaximum: 24,\n\tvalue: [\n\t\t\"number\",\n\t\t\"color\"\n\t],\n\tlength: 2\n};\nvar expression$1 = {\n\ttype: \"array\",\n\tvalue: \"*\",\n\tminimum: 1\n};\nvar light = {\n\tanchor: {\n\t\ttype: \"enum\",\n\t\t\"default\": \"viewport\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"property-type\": \"data-constant\",\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t}\n\t},\n\tposition: {\n\t\ttype: \"array\",\n\t\t\"default\": [\n\t\t\t1.15,\n\t\t\t210,\n\t\t\t30\n\t\t],\n\t\tlength: 3,\n\t\tvalue: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t}\n\t},\n\tcolor: {\n\t\ttype: \"color\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": \"#ffffff\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\tintensity: {\n\t\ttype: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": 0.5,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t}\n};\nvar sky = {\n\t\"sky-color\": {\n\t\ttype: \"color\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": \"#88C6FC\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"horizon-color\": {\n\t\ttype: \"color\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": \"#ffffff\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"fog-color\": {\n\t\ttype: \"color\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": \"#ffffff\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"fog-ground-blend\": {\n\t\ttype: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": 0.5,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"horizon-fog-blend\": {\n\t\ttype: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": 0.8,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"sky-horizon-blend\": {\n\t\ttype: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": 0.8,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t},\n\t\"atmosphere-blend\": {\n\t\ttype: \"number\",\n\t\t\"property-type\": \"data-constant\",\n\t\t\"default\": 0.8,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\ttransition: true\n\t}\n};\nvar terrain = {\n\tsource: {\n\t\ttype: \"string\",\n\t\trequired: true\n\t},\n\texaggeration: {\n\t\ttype: \"number\",\n\t\tminimum: 0,\n\t\t\"default\": 1\n\t}\n};\nvar projection = {\n\ttype: {\n\t\ttype: \"projectionDefinition\",\n\t\t\"default\": \"mercator\",\n\t\t\"property-type\": \"data-constant\",\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t}\n\t}\n};\nvar paint = [\n\t\"paint_fill\",\n\t\"paint_line\",\n\t\"paint_circle\",\n\t\"paint_heatmap\",\n\t\"paint_fill-extrusion\",\n\t\"paint_symbol\",\n\t\"paint_raster\",\n\t\"paint_hillshade\",\n\t\"paint_background\"\n];\nvar paint_fill = {\n\t\"fill-antialias\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"fill-pattern\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-outline-color\": {\n\t\ttype: \"color\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"fill-pattern\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"fill-antialias\": true\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"fill-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-pattern\": {\n\t\ttype: \"resolvedImage\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"cross-faded-data-driven\"\n\t}\n};\nvar paint_line = {\n\t\"line-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"line-pattern\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"line-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"line-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"line-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-gap-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-offset\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-blur\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"line-dasharray\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"line widths\",\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"line-pattern\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"cross-faded\"\n\t},\n\t\"line-pattern\": {\n\t\ttype: \"resolvedImage\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"cross-faded-data-driven\"\n\t},\n\t\"line-gradient\": {\n\t\ttype: \"color\",\n\t\ttransition: false,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"line-dasharray\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"!\": \"line-pattern\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tsource: \"geojson\",\n\t\t\t\thas: {\n\t\t\t\t\tlineMetrics: true\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"line-progress\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"color-ramp\"\n\t}\n};\nvar paint_circle = {\n\t\"circle-radius\": {\n\t\ttype: \"number\",\n\t\t\"default\": 5,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-blur\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"circle-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"circle-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"circle-pitch-scale\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"circle-pitch-alignment\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"viewport\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"circle-stroke-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-stroke-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"circle-stroke-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t}\n};\nvar paint_heatmap = {\n\t\"heatmap-radius\": {\n\t\ttype: \"number\",\n\t\t\"default\": 30,\n\t\tminimum: 1,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"heatmap-weight\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"heatmap-intensity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"heatmap-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": [\n\t\t\t\"interpolate\",\n\t\t\t[\n\t\t\t\t\"linear\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"heatmap-density\"\n\t\t\t],\n\t\t\t0,\n\t\t\t\"rgba(0, 0, 255, 0)\",\n\t\t\t0.1,\n\t\t\t\"royalblue\",\n\t\t\t0.3,\n\t\t\t\"cyan\",\n\t\t\t0.5,\n\t\t\t\"lime\",\n\t\t\t0.7,\n\t\t\t\"yellow\",\n\t\t\t1,\n\t\t\t\"red\"\n\t\t],\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"heatmap-density\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"color-ramp\"\n\t},\n\t\"heatmap-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n};\nvar paint_symbol = {\n\t\"icon-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-halo-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"rgba(0, 0, 0, 0)\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-halo-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-halo-blur\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"icon-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"icon-image\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"icon-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"icon-image\",\n\t\t\t\"icon-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\toverridable: true,\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-halo-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"rgba(0, 0, 0, 0)\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-halo-width\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-halo-blur\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"text-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\trequires: [\n\t\t\t\"text-field\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"text-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"text-field\",\n\t\t\t\"text-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n};\nvar paint_raster = {\n\t\"raster-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-hue-rotate\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tperiod: 360,\n\t\ttransition: true,\n\t\tunits: \"degrees\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-brightness-min\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-brightness-max\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-saturation\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: -1,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-contrast\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: -1,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-resampling\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tlinear: {\n\t\t\t},\n\t\t\tnearest: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"linear\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"raster-fade-duration\": {\n\t\ttype: \"number\",\n\t\t\"default\": 300,\n\t\tminimum: 0,\n\t\ttransition: false,\n\t\tunits: \"milliseconds\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n};\nvar paint_hillshade = {\n\t\"hillshade-illumination-direction\": {\n\t\ttype: \"number\",\n\t\t\"default\": 335,\n\t\tminimum: 0,\n\t\tmaximum: 359,\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"hillshade-illumination-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"viewport\",\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"hillshade-exaggeration\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0.5,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"hillshade-shadow-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"hillshade-highlight-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#FFFFFF\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"hillshade-accent-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n};\nvar paint_background = {\n\t\"background-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"background-pattern\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"background-pattern\": {\n\t\ttype: \"resolvedImage\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"cross-faded\"\n\t},\n\t\"background-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n};\nvar transition = {\n\tduration: {\n\t\ttype: \"number\",\n\t\t\"default\": 300,\n\t\tminimum: 0,\n\t\tunits: \"milliseconds\"\n\t},\n\tdelay: {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\tunits: \"milliseconds\"\n\t}\n};\nvar promoteId = {\n\t\"*\": {\n\t\ttype: \"string\"\n\t}\n};\nvar v8Spec = {\n\t$version: $version,\n\t$root: $root,\n\tsources: sources,\n\tsource: source,\n\tsource_vector: source_vector,\n\tsource_raster: source_raster,\n\tsource_raster_dem: source_raster_dem,\n\tsource_geojson: source_geojson,\n\tsource_video: source_video,\n\tsource_image: source_image,\n\tlayer: layer,\n\tlayout: layout,\n\tlayout_background: layout_background,\n\tlayout_fill: layout_fill,\n\tlayout_circle: layout_circle,\n\tlayout_heatmap: layout_heatmap,\n\t\"layout_fill-extrusion\": {\n\tvisibility: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tvisible: {\n\t\t\t},\n\t\t\tnone: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"visible\",\n\t\t\"property-type\": \"constant\"\n\t}\n},\n\tlayout_line: layout_line,\n\tlayout_symbol: layout_symbol,\n\tlayout_raster: layout_raster,\n\tlayout_hillshade: layout_hillshade,\n\tfilter: filter,\n\tfilter_operator: filter_operator,\n\tgeometry_type: geometry_type,\n\t\"function\": {\n\texpression: {\n\t\ttype: \"expression\"\n\t},\n\tstops: {\n\t\ttype: \"array\",\n\t\tvalue: \"function_stop\"\n\t},\n\tbase: {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0\n\t},\n\tproperty: {\n\t\ttype: \"string\",\n\t\t\"default\": \"$zoom\"\n\t},\n\ttype: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tidentity: {\n\t\t\t},\n\t\t\texponential: {\n\t\t\t},\n\t\t\tinterval: {\n\t\t\t},\n\t\t\tcategorical: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"exponential\"\n\t},\n\tcolorSpace: {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\trgb: {\n\t\t\t},\n\t\t\tlab: {\n\t\t\t},\n\t\t\thcl: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"rgb\"\n\t},\n\t\"default\": {\n\t\ttype: \"*\",\n\t\trequired: false\n\t}\n},\n\tfunction_stop: function_stop,\n\texpression: expression$1,\n\tlight: light,\n\tsky: sky,\n\tterrain: terrain,\n\tprojection: projection,\n\tpaint: paint,\n\tpaint_fill: paint_fill,\n\t\"paint_fill-extrusion\": {\n\t\"fill-extrusion-opacity\": {\n\t\ttype: \"number\",\n\t\t\"default\": 1,\n\t\tminimum: 0,\n\t\tmaximum: 1,\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-extrusion-color\": {\n\t\ttype: \"color\",\n\t\t\"default\": \"#000000\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t{\n\t\t\t\t\"!\": \"fill-extrusion-pattern\"\n\t\t\t}\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-extrusion-translate\": {\n\t\ttype: \"array\",\n\t\tvalue: \"number\",\n\t\tlength: 2,\n\t\t\"default\": [\n\t\t\t0,\n\t\t\t0\n\t\t],\n\t\ttransition: true,\n\t\tunits: \"pixels\",\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-extrusion-translate-anchor\": {\n\t\ttype: \"enum\",\n\t\tvalues: {\n\t\t\tmap: {\n\t\t\t},\n\t\t\tviewport: {\n\t\t\t}\n\t\t},\n\t\t\"default\": \"map\",\n\t\trequires: [\n\t\t\t\"fill-extrusion-translate\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t},\n\t\"fill-extrusion-pattern\": {\n\t\ttype: \"resolvedImage\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"cross-faded-data-driven\"\n\t},\n\t\"fill-extrusion-height\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\tunits: \"meters\",\n\t\ttransition: true,\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-extrusion-base\": {\n\t\ttype: \"number\",\n\t\t\"default\": 0,\n\t\tminimum: 0,\n\t\tunits: \"meters\",\n\t\ttransition: true,\n\t\trequires: [\n\t\t\t\"fill-extrusion-height\"\n\t\t],\n\t\texpression: {\n\t\t\tinterpolated: true,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\",\n\t\t\t\t\"feature\",\n\t\t\t\t\"feature-state\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-driven\"\n\t},\n\t\"fill-extrusion-vertical-gradient\": {\n\t\ttype: \"boolean\",\n\t\t\"default\": true,\n\t\ttransition: false,\n\t\texpression: {\n\t\t\tinterpolated: false,\n\t\t\tparameters: [\n\t\t\t\t\"zoom\"\n\t\t\t]\n\t\t},\n\t\t\"property-type\": \"data-constant\"\n\t}\n},\n\tpaint_line: paint_line,\n\tpaint_circle: paint_circle,\n\tpaint_heatmap: paint_heatmap,\n\tpaint_symbol: paint_symbol,\n\tpaint_raster: paint_raster,\n\tpaint_hillshade: paint_hillshade,\n\tpaint_background: paint_background,\n\ttransition: transition,\n\t\"property-type\": {\n\t\"data-driven\": {\n\t\ttype: \"property-type\"\n\t},\n\t\"cross-faded\": {\n\t\ttype: \"property-type\"\n\t},\n\t\"cross-faded-data-driven\": {\n\t\ttype: \"property-type\"\n\t},\n\t\"color-ramp\": {\n\t\ttype: \"property-type\"\n\t},\n\t\"data-constant\": {\n\t\ttype: \"property-type\"\n\t},\n\tconstant: {\n\t\ttype: \"property-type\"\n\t}\n},\n\tpromoteId: promoteId\n};\n\nconst refProperties = ['type', 'source', 'source-layer', 'minzoom', 'maxzoom', 'filter', 'layout'];\n\nfunction deref(layer, parent) {\n    const result = {};\n    for (const k in layer) {\n        if (k !== 'ref') {\n            result[k] = layer[k];\n        }\n    }\n    refProperties.forEach((k) => {\n        if (k in parent) {\n            result[k] = parent[k];\n        }\n    });\n    return result;\n}\n/**\n * Given an array of layers, some of which may contain `ref` properties\n * whose value is the `id` of another property, return a new array where\n * such layers have been augmented with the 'type', 'source', etc. properties\n * from the parent layer, and the `ref` property has been removed.\n *\n * The input is not modified. The output may contain references to portions\n * of the input.\n *\n * @private\n * @param {Array<Layer>} layers\n * @returns {Array<Layer>}\n */\nfunction derefLayers(layers) {\n    layers = layers.slice();\n    const map = Object.create(null);\n    for (let i = 0; i < layers.length; i++) {\n        map[layers[i].id] = layers[i];\n    }\n    for (let i = 0; i < layers.length; i++) {\n        if ('ref' in layers[i]) {\n            layers[i] = deref(layers[i], map[layers[i].ref]);\n        }\n    }\n    return layers;\n}\n\n/**\n * Deeply compares two object literals.\n *\n * @private\n */\nfunction deepEqual(a, b) {\n    if (Array.isArray(a)) {\n        if (!Array.isArray(b) || a.length !== b.length)\n            return false;\n        for (let i = 0; i < a.length; i++) {\n            if (!deepEqual(a[i], b[i]))\n                return false;\n        }\n        return true;\n    }\n    if (typeof a === 'object' && a !== null && b !== null) {\n        if (!(typeof b === 'object'))\n            return false;\n        const keys = Object.keys(a);\n        if (keys.length !== Object.keys(b).length)\n            return false;\n        for (const key in a) {\n            if (!deepEqual(a[key], b[key]))\n                return false;\n        }\n        return true;\n    }\n    return a === b;\n}\n\n/**\n * The main reason for this method is to allow type check when adding a command to the array.\n * @param commands - The commands array to add to\n * @param command - The command to add\n */\nfunction addCommand(commands, command) {\n    commands.push(command);\n}\nfunction addSource(sourceId, after, commands) {\n    addCommand(commands, { command: 'addSource', args: [sourceId, after[sourceId]] });\n}\nfunction removeSource(sourceId, commands, sourcesRemoved) {\n    addCommand(commands, { command: 'removeSource', args: [sourceId] });\n    sourcesRemoved[sourceId] = true;\n}\nfunction updateSource(sourceId, after, commands, sourcesRemoved) {\n    removeSource(sourceId, commands, sourcesRemoved);\n    addSource(sourceId, after, commands);\n}\nfunction canUpdateGeoJSON(before, after, sourceId) {\n    let prop;\n    for (prop in before[sourceId]) {\n        if (!Object.prototype.hasOwnProperty.call(before[sourceId], prop))\n            continue;\n        if (prop !== 'data' && !deepEqual(before[sourceId][prop], after[sourceId][prop])) {\n            return false;\n        }\n    }\n    for (prop in after[sourceId]) {\n        if (!Object.prototype.hasOwnProperty.call(after[sourceId], prop))\n            continue;\n        if (prop !== 'data' && !deepEqual(before[sourceId][prop], after[sourceId][prop])) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction diffSources(before, after, commands, sourcesRemoved) {\n    before = before || {};\n    after = after || {};\n    let sourceId;\n    // look for sources to remove\n    for (sourceId in before) {\n        if (!Object.prototype.hasOwnProperty.call(before, sourceId))\n            continue;\n        if (!Object.prototype.hasOwnProperty.call(after, sourceId)) {\n            removeSource(sourceId, commands, sourcesRemoved);\n        }\n    }\n    // look for sources to add/update\n    for (sourceId in after) {\n        if (!Object.prototype.hasOwnProperty.call(after, sourceId))\n            continue;\n        if (!Object.prototype.hasOwnProperty.call(before, sourceId)) {\n            addSource(sourceId, after, commands);\n        }\n        else if (!deepEqual(before[sourceId], after[sourceId])) {\n            if (before[sourceId].type === 'geojson' && after[sourceId].type === 'geojson' && canUpdateGeoJSON(before, after, sourceId)) {\n                addCommand(commands, { command: 'setGeoJSONSourceData', args: [sourceId, after[sourceId].data] });\n            }\n            else {\n                // no update command, must remove then add\n                updateSource(sourceId, after, commands, sourcesRemoved);\n            }\n        }\n    }\n}\nfunction diffLayerPropertyChanges(before, after, commands, layerId, klass, command) {\n    before = before || {};\n    after = after || {};\n    for (const prop in before) {\n        if (!Object.prototype.hasOwnProperty.call(before, prop))\n            continue;\n        if (!deepEqual(before[prop], after[prop])) {\n            commands.push({ command, args: [layerId, prop, after[prop], klass] });\n        }\n    }\n    for (const prop in after) {\n        if (!Object.prototype.hasOwnProperty.call(after, prop) || Object.prototype.hasOwnProperty.call(before, prop))\n            continue;\n        if (!deepEqual(before[prop], after[prop])) {\n            commands.push({ command, args: [layerId, prop, after[prop], klass] });\n        }\n    }\n}\nfunction pluckId(layer) {\n    return layer.id;\n}\nfunction indexById(group, layer) {\n    group[layer.id] = layer;\n    return group;\n}\nfunction diffLayers(before, after, commands) {\n    before = before || [];\n    after = after || [];\n    // order of layers by id\n    const beforeOrder = before.map(pluckId);\n    const afterOrder = after.map(pluckId);\n    // index of layer by id\n    const beforeIndex = before.reduce(indexById, {});\n    const afterIndex = after.reduce(indexById, {});\n    // track order of layers as if they have been mutated\n    const tracker = beforeOrder.slice();\n    // layers that have been added do not need to be diffed\n    const clean = Object.create(null);\n    let layerId;\n    let beforeLayer;\n    let afterLayer;\n    let insertBeforeLayerId;\n    let prop;\n    // remove layers\n    for (let i = 0, d = 0; i < beforeOrder.length; i++) {\n        layerId = beforeOrder[i];\n        if (!Object.prototype.hasOwnProperty.call(afterIndex, layerId)) {\n            addCommand(commands, { command: 'removeLayer', args: [layerId] });\n            tracker.splice(tracker.indexOf(layerId, d), 1);\n        }\n        else {\n            // limit where in tracker we need to look for a match\n            d++;\n        }\n    }\n    // add/reorder layers\n    for (let i = 0, d = 0; i < afterOrder.length; i++) {\n        // work backwards as insert is before an existing layer\n        layerId = afterOrder[afterOrder.length - 1 - i];\n        if (tracker[tracker.length - 1 - i] === layerId)\n            continue;\n        if (Object.prototype.hasOwnProperty.call(beforeIndex, layerId)) {\n            // remove the layer before we insert at the correct position\n            addCommand(commands, { command: 'removeLayer', args: [layerId] });\n            tracker.splice(tracker.lastIndexOf(layerId, tracker.length - d), 1);\n        }\n        else {\n            // limit where in tracker we need to look for a match\n            d++;\n        }\n        // add layer at correct position\n        insertBeforeLayerId = tracker[tracker.length - i];\n        addCommand(commands, { command: 'addLayer', args: [afterIndex[layerId], insertBeforeLayerId] });\n        tracker.splice(tracker.length - i, 0, layerId);\n        clean[layerId] = true;\n    }\n    // update layers\n    for (let i = 0; i < afterOrder.length; i++) {\n        layerId = afterOrder[i];\n        beforeLayer = beforeIndex[layerId];\n        afterLayer = afterIndex[layerId];\n        // no need to update if previously added (new or moved)\n        if (clean[layerId] || deepEqual(beforeLayer, afterLayer))\n            continue;\n        // If source, source-layer, or type have changes, then remove the layer\n        // and add it back 'from scratch'.\n        if (!deepEqual(beforeLayer.source, afterLayer.source) || !deepEqual(beforeLayer['source-layer'], afterLayer['source-layer']) || !deepEqual(beforeLayer.type, afterLayer.type)) {\n            addCommand(commands, { command: 'removeLayer', args: [layerId] });\n            // we add the layer back at the same position it was already in, so\n            // there's no need to update the `tracker`\n            insertBeforeLayerId = tracker[tracker.lastIndexOf(layerId) + 1];\n            addCommand(commands, { command: 'addLayer', args: [afterLayer, insertBeforeLayerId] });\n            continue;\n        }\n        // layout, paint, filter, minzoom, maxzoom\n        diffLayerPropertyChanges(beforeLayer.layout, afterLayer.layout, commands, layerId, null, 'setLayoutProperty');\n        diffLayerPropertyChanges(beforeLayer.paint, afterLayer.paint, commands, layerId, null, 'setPaintProperty');\n        if (!deepEqual(beforeLayer.filter, afterLayer.filter)) {\n            addCommand(commands, { command: 'setFilter', args: [layerId, afterLayer.filter] });\n        }\n        if (!deepEqual(beforeLayer.minzoom, afterLayer.minzoom) || !deepEqual(beforeLayer.maxzoom, afterLayer.maxzoom)) {\n            addCommand(commands, { command: 'setLayerZoomRange', args: [layerId, afterLayer.minzoom, afterLayer.maxzoom] });\n        }\n        // handle all other layer props, including paint.*\n        for (prop in beforeLayer) {\n            if (!Object.prototype.hasOwnProperty.call(beforeLayer, prop))\n                continue;\n            if (prop === 'layout' || prop === 'paint' || prop === 'filter' ||\n                prop === 'metadata' || prop === 'minzoom' || prop === 'maxzoom')\n                continue;\n            if (prop.indexOf('paint.') === 0) {\n                diffLayerPropertyChanges(beforeLayer[prop], afterLayer[prop], commands, layerId, prop.slice(6), 'setPaintProperty');\n            }\n            else if (!deepEqual(beforeLayer[prop], afterLayer[prop])) {\n                addCommand(commands, { command: 'setLayerProperty', args: [layerId, prop, afterLayer[prop]] });\n            }\n        }\n        for (prop in afterLayer) {\n            if (!Object.prototype.hasOwnProperty.call(afterLayer, prop) || Object.prototype.hasOwnProperty.call(beforeLayer, prop))\n                continue;\n            if (prop === 'layout' || prop === 'paint' || prop === 'filter' ||\n                prop === 'metadata' || prop === 'minzoom' || prop === 'maxzoom')\n                continue;\n            if (prop.indexOf('paint.') === 0) {\n                diffLayerPropertyChanges(beforeLayer[prop], afterLayer[prop], commands, layerId, prop.slice(6), 'setPaintProperty');\n            }\n            else if (!deepEqual(beforeLayer[prop], afterLayer[prop])) {\n                addCommand(commands, { command: 'setLayerProperty', args: [layerId, prop, afterLayer[prop]] });\n            }\n        }\n    }\n}\n/**\n * Diff two stylesheet\n *\n * Creates semanticly aware diffs that can easily be applied at runtime.\n * Operations produced by the diff closely resemble the maplibre-gl-js API. Any\n * error creating the diff will fall back to the 'setStyle' operation.\n *\n * Example diff:\n * [\n *     { command: 'setConstant', args: ['@water', '#0000FF'] },\n *     { command: 'setPaintProperty', args: ['background', 'background-color', 'black'] }\n * ]\n *\n * @private\n * @param {*} [before] stylesheet to compare from\n * @param {*} after stylesheet to compare to\n * @returns Array list of changes\n */\nfunction diff(before, after) {\n    if (!before)\n        return [{ command: 'setStyle', args: [after] }];\n    let commands = [];\n    try {\n        // Handle changes to top-level properties\n        if (!deepEqual(before.version, after.version)) {\n            return [{ command: 'setStyle', args: [after] }];\n        }\n        if (!deepEqual(before.center, after.center)) {\n            commands.push({ command: 'setCenter', args: [after.center] });\n        }\n        if (!deepEqual(before.centerAltitude, after.centerAltitude)) {\n            commands.push({ command: 'setCenterAltitude', args: [after.centerAltitude] });\n        }\n        if (!deepEqual(before.zoom, after.zoom)) {\n            commands.push({ command: 'setZoom', args: [after.zoom] });\n        }\n        if (!deepEqual(before.bearing, after.bearing)) {\n            commands.push({ command: 'setBearing', args: [after.bearing] });\n        }\n        if (!deepEqual(before.pitch, after.pitch)) {\n            commands.push({ command: 'setPitch', args: [after.pitch] });\n        }\n        if (!deepEqual(before.roll, after.roll)) {\n            commands.push({ command: 'setRoll', args: [after.roll] });\n        }\n        if (!deepEqual(before.sprite, after.sprite)) {\n            commands.push({ command: 'setSprite', args: [after.sprite] });\n        }\n        if (!deepEqual(before.glyphs, after.glyphs)) {\n            commands.push({ command: 'setGlyphs', args: [after.glyphs] });\n        }\n        if (!deepEqual(before.transition, after.transition)) {\n            commands.push({ command: 'setTransition', args: [after.transition] });\n        }\n        if (!deepEqual(before.light, after.light)) {\n            commands.push({ command: 'setLight', args: [after.light] });\n        }\n        if (!deepEqual(before.terrain, after.terrain)) {\n            commands.push({ command: 'setTerrain', args: [after.terrain] });\n        }\n        if (!deepEqual(before.sky, after.sky)) {\n            commands.push({ command: 'setSky', args: [after.sky] });\n        }\n        if (!deepEqual(before.projection, after.projection)) {\n            commands.push({ command: 'setProjection', args: [after.projection] });\n        }\n        // Handle changes to `sources`\n        // If a source is to be removed, we also--before the removeSource\n        // command--need to remove all the style layers that depend on it.\n        const sourcesRemoved = {};\n        // First collect the {add,remove}Source commands\n        const removeOrAddSourceCommands = [];\n        diffSources(before.sources, after.sources, removeOrAddSourceCommands, sourcesRemoved);\n        // Push a removeLayer command for each style layer that depends on a\n        // source that's being removed.\n        // Also, exclude any such layers them from the input to `diffLayers`\n        // below, so that diffLayers produces the appropriate `addLayers`\n        // command\n        const beforeLayers = [];\n        if (before.layers) {\n            before.layers.forEach((layer) => {\n                if ('source' in layer && sourcesRemoved[layer.source]) {\n                    commands.push({ command: 'removeLayer', args: [layer.id] });\n                }\n                else {\n                    beforeLayers.push(layer);\n                }\n            });\n        }\n        commands = commands.concat(removeOrAddSourceCommands);\n        // Handle changes to `layers`\n        diffLayers(beforeLayers, after.layers, commands);\n    }\n    catch (e) {\n        // fall back to setStyle\n        console.warn('Unable to compute style diff:', e);\n        commands = [{ command: 'setStyle', args: [after] }];\n    }\n    return commands;\n}\n\n// Note: Do not inherit from Error. It breaks when transpiling to ES5.\nclass ValidationError {\n    constructor(key, value, message, identifier) {\n        this.message = (key ? `${key}: ` : '') + message;\n        if (identifier)\n            this.identifier = identifier;\n        if (value !== null && value !== undefined && value.__line__) {\n            this.line = value.__line__;\n        }\n    }\n}\n\n// Note: Do not inherit from Error. It breaks when transpiling to ES5.\nclass ParsingError {\n    constructor(error) {\n        this.error = error;\n        this.message = error.message;\n        const match = error.message.match(/line (\\d+)/);\n        this.line = match ? parseInt(match[1], 10) : 0;\n    }\n}\n\nfunction extendBy(output, ...inputs) {\n    for (const input of inputs) {\n        for (const k in input) {\n            output[k] = input[k];\n        }\n    }\n    return output;\n}\n\nclass ExpressionParsingError extends Error {\n    constructor(key, message) {\n        super(message);\n        this.message = message;\n        this.key = key;\n    }\n}\n\n/**\n * Tracks `let` bindings during expression parsing.\n * @private\n */\nclass Scope {\n    constructor(parent, bindings = []) {\n        this.parent = parent;\n        this.bindings = {};\n        for (const [name, expression] of bindings) {\n            this.bindings[name] = expression;\n        }\n    }\n    concat(bindings) {\n        return new Scope(this, bindings);\n    }\n    get(name) {\n        if (this.bindings[name]) {\n            return this.bindings[name];\n        }\n        if (this.parent) {\n            return this.parent.get(name);\n        }\n        throw new Error(`${name} not found in scope.`);\n    }\n    has(name) {\n        if (this.bindings[name])\n            return true;\n        return this.parent ? this.parent.has(name) : false;\n    }\n}\n\nconst NullType = { kind: 'null' };\nconst NumberType = { kind: 'number' };\nconst StringType = { kind: 'string' };\nconst BooleanType = { kind: 'boolean' };\nconst ColorType = { kind: 'color' };\nconst ProjectionDefinitionType = { kind: 'projectionDefinition' };\nconst ObjectType = { kind: 'object' };\nconst ValueType = { kind: 'value' };\nconst ErrorType = { kind: 'error' };\nconst CollatorType = { kind: 'collator' };\nconst FormattedType = { kind: 'formatted' };\nconst PaddingType = { kind: 'padding' };\nconst ResolvedImageType = { kind: 'resolvedImage' };\nconst VariableAnchorOffsetCollectionType = { kind: 'variableAnchorOffsetCollection' };\nfunction array(itemType, N) {\n    return {\n        kind: 'array',\n        itemType,\n        N\n    };\n}\nfunction typeToString(type) {\n    if (type.kind === 'array') {\n        const itemType = typeToString(type.itemType);\n        return typeof type.N === 'number' ?\n            `array<${itemType}, ${type.N}>` :\n            type.itemType.kind === 'value' ? 'array' : `array<${itemType}>`;\n    }\n    else {\n        return type.kind;\n    }\n}\nconst valueMemberTypes = [\n    NullType,\n    NumberType,\n    StringType,\n    BooleanType,\n    ColorType,\n    ProjectionDefinitionType,\n    FormattedType,\n    ObjectType,\n    array(ValueType),\n    PaddingType,\n    ResolvedImageType,\n    VariableAnchorOffsetCollectionType\n];\n/**\n * Returns null if `t` is a subtype of `expected`; otherwise returns an\n * error message.\n * @private\n */\nfunction checkSubtype(expected, t) {\n    if (t.kind === 'error') {\n        // Error is a subtype of every type\n        return null;\n    }\n    else if (expected.kind === 'array') {\n        if (t.kind === 'array' &&\n            ((t.N === 0 && t.itemType.kind === 'value') || !checkSubtype(expected.itemType, t.itemType)) &&\n            (typeof expected.N !== 'number' || expected.N === t.N)) {\n            return null;\n        }\n    }\n    else if (expected.kind === t.kind) {\n        return null;\n    }\n    else if (expected.kind === 'value') {\n        for (const memberType of valueMemberTypes) {\n            if (!checkSubtype(memberType, t)) {\n                return null;\n            }\n        }\n    }\n    return `Expected ${typeToString(expected)} but found ${typeToString(t)} instead.`;\n}\nfunction isValidType(provided, allowedTypes) {\n    return allowedTypes.some(t => t.kind === provided.kind);\n}\nfunction isValidNativeType(provided, allowedTypes) {\n    return allowedTypes.some(t => {\n        if (t === 'null') {\n            return provided === null;\n        }\n        else if (t === 'array') {\n            return Array.isArray(provided);\n        }\n        else if (t === 'object') {\n            return provided && !Array.isArray(provided) && typeof provided === 'object';\n        }\n        else {\n            return t === typeof provided;\n        }\n    });\n}\n/**\n * Verify whether the specified type is of the same type as the specified sample.\n *\n * @param provided Type to verify\n * @param sample Sample type to reference\n * @returns `true` if both objects are of the same type, `false` otherwise\n * @example basic types\n * if (verifyType(outputType, ValueType)) {\n *     // type narrowed to:\n *     outputType.kind; // 'value'\n * }\n * @example array types\n * if (verifyType(outputType, array(NumberType))) {\n *     // type narrowed to:\n *     outputType.kind; // 'array'\n *     outputType.itemType; // NumberTypeT\n *     outputType.itemType.kind; // 'number'\n * }\n */\nfunction verifyType(provided, sample) {\n    if (provided.kind === 'array' && sample.kind === 'array') {\n        return provided.itemType.kind === sample.itemType.kind && typeof provided.N === 'number';\n    }\n    return provided.kind === sample.kind;\n}\n\n// See https://observablehq.com/@mbostock/lab-and-rgb\nconst Xn = 0.96422, Yn = 1, Zn = 0.82521, t0 = 4 / 29, t1 = 6 / 29, t2 = 3 * t1 * t1, t3 = t1 * t1 * t1, deg2rad = Math.PI / 180, rad2deg = 180 / Math.PI;\nfunction constrainAngle(angle) {\n    angle = angle % 360;\n    if (angle < 0) {\n        angle += 360;\n    }\n    return angle;\n}\nfunction rgbToLab([r, g, b, alpha]) {\n    r = rgb2xyz(r);\n    g = rgb2xyz(g);\n    b = rgb2xyz(b);\n    let x, z;\n    const y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn);\n    if (r === g && g === b) {\n        x = z = y;\n    }\n    else {\n        x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n        z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n    }\n    const l = 116 * y - 16;\n    return [(l < 0) ? 0 : l, 500 * (x - y), 200 * (y - z), alpha];\n}\nfunction rgb2xyz(x) {\n    return (x <= 0.04045) ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\nfunction xyz2lab(t) {\n    return (t > t3) ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\nfunction labToRgb([l, a, b, alpha]) {\n    let y = (l + 16) / 116, x = isNaN(a) ? y : y + a / 500, z = isNaN(b) ? y : y - b / 200;\n    y = Yn * lab2xyz(y);\n    x = Xn * lab2xyz(x);\n    z = Zn * lab2xyz(z);\n    return [\n        xyz2rgb(3.1338561 * x - 1.6168667 * y - 0.4906146 * z), // D50 -> sRGB\n        xyz2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n        xyz2rgb(0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n        alpha,\n    ];\n}\nfunction xyz2rgb(x) {\n    x = (x <= 0.00304) ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055;\n    return (x < 0) ? 0 : (x > 1) ? 1 : x; // clip to 0..1 range\n}\nfunction lab2xyz(t) {\n    return (t > t1) ? t * t * t : t2 * (t - t0);\n}\nfunction rgbToHcl(rgbColor) {\n    const [l, a, b, alpha] = rgbToLab(rgbColor);\n    const c = Math.sqrt(a * a + b * b);\n    const h = Math.round(c * 10000) ? constrainAngle(Math.atan2(b, a) * rad2deg) : NaN;\n    return [h, c, l, alpha];\n}\nfunction hclToRgb([h, c, l, alpha]) {\n    h = isNaN(h) ? 0 : h * deg2rad;\n    return labToRgb([l, Math.cos(h) * c, Math.sin(h) * c, alpha]);\n}\n// https://drafts.csswg.org/css-color-4/#hsl-to-rgb\nfunction hslToRgb([h, s, l, alpha]) {\n    h = constrainAngle(h);\n    s /= 100;\n    l /= 100;\n    function f(n) {\n        const k = (n + h / 30) % 12;\n        const a = s * Math.min(l, 1 - l);\n        return l - a * Math.max(-1, Math.min(k - 3, 9 - k, 1));\n    }\n    return [f(0), f(8), f(4), alpha];\n}\n\n/**\n * CSS color parser compliant with CSS Color 4 Specification.\n * Supports: named colors, `transparent` keyword, all rgb hex notations,\n * rgb(), rgba(), hsl() and hsla() functions.\n * Does not round the parsed values to integers from the range 0..255.\n *\n * Syntax:\n *\n * <alpha-value> = <number> | <percentage>\n *         <hue> = <number> | <angle>\n *\n *         rgb() = rgb( <percentage>{3} [ / <alpha-value> ]? ) | rgb( <number>{3} [ / <alpha-value> ]? )\n *         rgb() = rgb( <percentage>#{3} , <alpha-value>? )    | rgb( <number>#{3} , <alpha-value>? )\n *\n *         hsl() = hsl( <hue> <percentage> <percentage> [ / <alpha-value> ]? )\n *         hsl() = hsl( <hue>, <percentage>, <percentage>, <alpha-value>? )\n *\n * Caveats:\n *   - <angle> - <number> with optional `deg` suffix; `grad`, `rad`, `turn` are not supported\n *   - `none` keyword is not supported\n *   - comments inside rgb()/hsl() are not supported\n *   - legacy color syntax rgba() is supported with an identical grammar and behavior to rgb()\n *   - legacy color syntax hsla() is supported with an identical grammar and behavior to hsl()\n *\n * @param input CSS color string to parse.\n * @returns Color in sRGB color space, with `red`, `green`, `blue`\n * and `alpha` channels normalized to the range 0..1,\n * or `undefined` if the input is not a valid color string.\n */\nfunction parseCssColor(input) {\n    input = input.toLowerCase().trim();\n    if (input === 'transparent') {\n        return [0, 0, 0, 0];\n    }\n    // 'white', 'black', 'blue'\n    const namedColorsMatch = namedColors[input];\n    if (namedColorsMatch) {\n        const [r, g, b] = namedColorsMatch;\n        return [r / 255, g / 255, b / 255, 1];\n    }\n    // #f0c, #f0cf, #ff00cc, #ff00ccff\n    if (input.startsWith('#')) {\n        const hexRegexp = /^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/;\n        if (hexRegexp.test(input)) {\n            const step = input.length < 6 ? 1 : 2;\n            let i = 1;\n            return [\n                parseHex(input.slice(i, i += step)),\n                parseHex(input.slice(i, i += step)),\n                parseHex(input.slice(i, i += step)),\n                parseHex(input.slice(i, i + step) || 'ff'),\n            ];\n        }\n    }\n    // rgb(128 0 0), rgb(50% 0% 0%), rgba(255,0,255,0.6), rgb(255 0 255 / 60%), rgb(100% 0% 100% /.6)\n    if (input.startsWith('rgb')) {\n        const rgbRegExp = /^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/;\n        const rgbMatch = input.match(rgbRegExp);\n        if (rgbMatch) {\n            const [_, // eslint-disable-line @typescript-eslint/no-unused-vars\n            r, // <numeric>\n            rp, // %         (optional)\n            f1, // ,         (optional)\n            g, // <numeric>\n            gp, // %         (optional)\n            f2, // ,         (optional)\n            b, // <numeric>\n            bp, // %         (optional)\n            f3, // ,|/       (optional)\n            a, // <numeric> (optional)\n            ap, // %         (optional)\n            ] = rgbMatch;\n            const argFormat = [f1 || ' ', f2 || ' ', f3].join('');\n            if (argFormat === '  ' ||\n                argFormat === '  /' ||\n                argFormat === ',,' ||\n                argFormat === ',,,') {\n                const valFormat = [rp, gp, bp].join('');\n                const maxValue = (valFormat === '%%%') ? 100 :\n                    (valFormat === '') ? 255 : 0;\n                if (maxValue) {\n                    const rgba = [\n                        clamp(+r / maxValue, 0, 1),\n                        clamp(+g / maxValue, 0, 1),\n                        clamp(+b / maxValue, 0, 1),\n                        a ? parseAlpha(+a, ap) : 1,\n                    ];\n                    if (validateNumbers(rgba)) {\n                        return rgba;\n                    }\n                    // invalid numbers\n                }\n                // values must be all numbers or all percentages\n            }\n            return; // comma optional syntax requires no commas at all\n        }\n    }\n    // hsl(120 50% 80%), hsla(120deg,50%,80%,.9), hsl(12e1 50% 80% / 90%)\n    const hslRegExp = /^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/;\n    const hslMatch = input.match(hslRegExp);\n    if (hslMatch) {\n        const [_, // eslint-disable-line @typescript-eslint/no-unused-vars\n        h, // <numeric>\n        f1, // ,         (optional)\n        s, // <numeric>\n        f2, // ,         (optional)\n        l, // <numeric>\n        f3, // ,|/       (optional)\n        a, // <numeric> (optional)\n        ap, // %         (optional)\n        ] = hslMatch;\n        const argFormat = [f1 || ' ', f2 || ' ', f3].join('');\n        if (argFormat === '  ' ||\n            argFormat === '  /' ||\n            argFormat === ',,' ||\n            argFormat === ',,,') {\n            const hsla = [\n                +h,\n                clamp(+s, 0, 100),\n                clamp(+l, 0, 100),\n                a ? parseAlpha(+a, ap) : 1,\n            ];\n            if (validateNumbers(hsla)) {\n                return hslToRgb(hsla);\n            }\n            // invalid numbers\n        }\n        // comma optional syntax requires no commas at all\n    }\n}\nfunction parseHex(hex) {\n    return parseInt(hex.padEnd(2, hex), 16) / 255;\n}\nfunction parseAlpha(a, asPercentage) {\n    return clamp(asPercentage ? (a / 100) : a, 0, 1);\n}\nfunction clamp(n, min, max) {\n    return Math.min(Math.max(min, n), max);\n}\n/**\n * The regular expression for numeric values is not super specific, and it may\n * happen that it will accept a value that is not a valid number. In order to\n * detect and eliminate such values this function exists.\n *\n * @param array Array of uncertain numbers.\n * @returns `true` if the specified array contains only valid numbers, `false` otherwise.\n */\nfunction validateNumbers(array) {\n    return !array.some(Number.isNaN);\n}\n/**\n * To generate:\n * - visit {@link https://www.w3.org/TR/css-color-4/#named-colors}\n * - run in the console:\n * @example\n * copy(`{\\n${[...document.querySelector('.named-color-table tbody').children].map((tr) => `${tr.cells[2].textContent.trim()}: [${tr.cells[4].textContent.trim().split(/\\s+/).join(', ')}],`).join('\\n')}\\n}`);\n */\nconst namedColors = {\n    aliceblue: [240, 248, 255],\n    antiquewhite: [250, 235, 215],\n    aqua: [0, 255, 255],\n    aquamarine: [127, 255, 212],\n    azure: [240, 255, 255],\n    beige: [245, 245, 220],\n    bisque: [255, 228, 196],\n    black: [0, 0, 0],\n    blanchedalmond: [255, 235, 205],\n    blue: [0, 0, 255],\n    blueviolet: [138, 43, 226],\n    brown: [165, 42, 42],\n    burlywood: [222, 184, 135],\n    cadetblue: [95, 158, 160],\n    chartreuse: [127, 255, 0],\n    chocolate: [210, 105, 30],\n    coral: [255, 127, 80],\n    cornflowerblue: [100, 149, 237],\n    cornsilk: [255, 248, 220],\n    crimson: [220, 20, 60],\n    cyan: [0, 255, 255],\n    darkblue: [0, 0, 139],\n    darkcyan: [0, 139, 139],\n    darkgoldenrod: [184, 134, 11],\n    darkgray: [169, 169, 169],\n    darkgreen: [0, 100, 0],\n    darkgrey: [169, 169, 169],\n    darkkhaki: [189, 183, 107],\n    darkmagenta: [139, 0, 139],\n    darkolivegreen: [85, 107, 47],\n    darkorange: [255, 140, 0],\n    darkorchid: [153, 50, 204],\n    darkred: [139, 0, 0],\n    darksalmon: [233, 150, 122],\n    darkseagreen: [143, 188, 143],\n    darkslateblue: [72, 61, 139],\n    darkslategray: [47, 79, 79],\n    darkslategrey: [47, 79, 79],\n    darkturquoise: [0, 206, 209],\n    darkviolet: [148, 0, 211],\n    deeppink: [255, 20, 147],\n    deepskyblue: [0, 191, 255],\n    dimgray: [105, 105, 105],\n    dimgrey: [105, 105, 105],\n    dodgerblue: [30, 144, 255],\n    firebrick: [178, 34, 34],\n    floralwhite: [255, 250, 240],\n    forestgreen: [34, 139, 34],\n    fuchsia: [255, 0, 255],\n    gainsboro: [220, 220, 220],\n    ghostwhite: [248, 248, 255],\n    gold: [255, 215, 0],\n    goldenrod: [218, 165, 32],\n    gray: [128, 128, 128],\n    green: [0, 128, 0],\n    greenyellow: [173, 255, 47],\n    grey: [128, 128, 128],\n    honeydew: [240, 255, 240],\n    hotpink: [255, 105, 180],\n    indianred: [205, 92, 92],\n    indigo: [75, 0, 130],\n    ivory: [255, 255, 240],\n    khaki: [240, 230, 140],\n    lavender: [230, 230, 250],\n    lavenderblush: [255, 240, 245],\n    lawngreen: [124, 252, 0],\n    lemonchiffon: [255, 250, 205],\n    lightblue: [173, 216, 230],\n    lightcoral: [240, 128, 128],\n    lightcyan: [224, 255, 255],\n    lightgoldenrodyellow: [250, 250, 210],\n    lightgray: [211, 211, 211],\n    lightgreen: [144, 238, 144],\n    lightgrey: [211, 211, 211],\n    lightpink: [255, 182, 193],\n    lightsalmon: [255, 160, 122],\n    lightseagreen: [32, 178, 170],\n    lightskyblue: [135, 206, 250],\n    lightslategray: [119, 136, 153],\n    lightslategrey: [119, 136, 153],\n    lightsteelblue: [176, 196, 222],\n    lightyellow: [255, 255, 224],\n    lime: [0, 255, 0],\n    limegreen: [50, 205, 50],\n    linen: [250, 240, 230],\n    magenta: [255, 0, 255],\n    maroon: [128, 0, 0],\n    mediumaquamarine: [102, 205, 170],\n    mediumblue: [0, 0, 205],\n    mediumorchid: [186, 85, 211],\n    mediumpurple: [147, 112, 219],\n    mediumseagreen: [60, 179, 113],\n    mediumslateblue: [123, 104, 238],\n    mediumspringgreen: [0, 250, 154],\n    mediumturquoise: [72, 209, 204],\n    mediumvioletred: [199, 21, 133],\n    midnightblue: [25, 25, 112],\n    mintcream: [245, 255, 250],\n    mistyrose: [255, 228, 225],\n    moccasin: [255, 228, 181],\n    navajowhite: [255, 222, 173],\n    navy: [0, 0, 128],\n    oldlace: [253, 245, 230],\n    olive: [128, 128, 0],\n    olivedrab: [107, 142, 35],\n    orange: [255, 165, 0],\n    orangered: [255, 69, 0],\n    orchid: [218, 112, 214],\n    palegoldenrod: [238, 232, 170],\n    palegreen: [152, 251, 152],\n    paleturquoise: [175, 238, 238],\n    palevioletred: [219, 112, 147],\n    papayawhip: [255, 239, 213],\n    peachpuff: [255, 218, 185],\n    peru: [205, 133, 63],\n    pink: [255, 192, 203],\n    plum: [221, 160, 221],\n    powderblue: [176, 224, 230],\n    purple: [128, 0, 128],\n    rebeccapurple: [102, 51, 153],\n    red: [255, 0, 0],\n    rosybrown: [188, 143, 143],\n    royalblue: [65, 105, 225],\n    saddlebrown: [139, 69, 19],\n    salmon: [250, 128, 114],\n    sandybrown: [244, 164, 96],\n    seagreen: [46, 139, 87],\n    seashell: [255, 245, 238],\n    sienna: [160, 82, 45],\n    silver: [192, 192, 192],\n    skyblue: [135, 206, 235],\n    slateblue: [106, 90, 205],\n    slategray: [112, 128, 144],\n    slategrey: [112, 128, 144],\n    snow: [255, 250, 250],\n    springgreen: [0, 255, 127],\n    steelblue: [70, 130, 180],\n    tan: [210, 180, 140],\n    teal: [0, 128, 128],\n    thistle: [216, 191, 216],\n    tomato: [255, 99, 71],\n    turquoise: [64, 224, 208],\n    violet: [238, 130, 238],\n    wheat: [245, 222, 179],\n    white: [255, 255, 255],\n    whitesmoke: [245, 245, 245],\n    yellow: [255, 255, 0],\n    yellowgreen: [154, 205, 50],\n};\n\nfunction interpolateNumber(from, to, t) {\n    return from + t * (to - from);\n}\nfunction interpolateArray(from, to, t) {\n    return from.map((d, i) => {\n        return interpolateNumber(d, to[i], t);\n    });\n}\n\n/**\n * Checks whether the specified color space is one of the supported interpolation color spaces.\n *\n * @param colorSpace Color space key to verify.\n * @returns `true` if the specified color space is one of the supported\n * interpolation color spaces, `false` otherwise\n */\nfunction isSupportedInterpolationColorSpace(colorSpace) {\n    return colorSpace === 'rgb' || colorSpace === 'hcl' || colorSpace === 'lab';\n}\n/**\n * Color representation used by WebGL.\n * Defined in sRGB color space and pre-blended with alpha.\n * @private\n */\nclass Color {\n    /**\n     * @param r Red component premultiplied by `alpha` 0..1\n     * @param g Green component premultiplied by `alpha` 0..1\n     * @param b Blue component premultiplied by `alpha` 0..1\n     * @param [alpha=1] Alpha component 0..1\n     * @param [premultiplied=true] Whether the `r`, `g` and `b` values have already\n     * been multiplied by alpha. If `true` nothing happens if `false` then they will\n     * be multiplied automatically.\n     */\n    constructor(r, g, b, alpha = 1, premultiplied = true) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n        this.a = alpha;\n        if (!premultiplied) {\n            this.r *= alpha;\n            this.g *= alpha;\n            this.b *= alpha;\n            if (!alpha) {\n                // alpha = 0 erases completely rgb channels. This behavior is not desirable\n                // if this particular color is later used in color interpolation.\n                // Because of that, a reference to original color is saved.\n                this.overwriteGetter('rgb', [r, g, b, alpha]);\n            }\n        }\n    }\n    /**\n     * Parses CSS color strings and converts colors to sRGB color space if needed.\n     * Officially supported color formats:\n     * - keyword, e.g. 'aquamarine' or 'steelblue'\n     * - hex (with 3, 4, 6 or 8 digits), e.g. '#f0f' or '#e9bebea9'\n     * - rgb and rgba, e.g. 'rgb(0,240,120)' or 'rgba(0%,94%,47%,0.1)' or 'rgb(0 240 120 / .3)'\n     * - hsl and hsla, e.g. 'hsl(0,0%,83%)' or 'hsla(0,0%,83%,.5)' or 'hsl(0 0% 83% / 20%)'\n     *\n     * @param input CSS color string to parse.\n     * @returns A `Color` instance, or `undefined` if the input is not a valid color string.\n     */\n    static parse(input) {\n        // in zoom-and-property function input could be an instance of Color class\n        if (input instanceof Color) {\n            return input;\n        }\n        if (typeof input !== 'string') {\n            return;\n        }\n        const rgba = parseCssColor(input);\n        if (rgba) {\n            return new Color(...rgba, false);\n        }\n    }\n    /**\n     * Used in color interpolation and by 'to-rgba' expression.\n     *\n     * @returns Gien color, with reversed alpha blending, in sRGB color space.\n     */\n    get rgb() {\n        const { r, g, b, a } = this;\n        const f = a || Infinity; // reverse alpha blending factor\n        return this.overwriteGetter('rgb', [r / f, g / f, b / f, a]);\n    }\n    /**\n     * Used in color interpolation.\n     *\n     * @returns Gien color, with reversed alpha blending, in HCL color space.\n     */\n    get hcl() {\n        return this.overwriteGetter('hcl', rgbToHcl(this.rgb));\n    }\n    /**\n     * Used in color interpolation.\n     *\n     * @returns Gien color, with reversed alpha blending, in LAB color space.\n     */\n    get lab() {\n        return this.overwriteGetter('lab', rgbToLab(this.rgb));\n    }\n    /**\n     * Lazy getter pattern. When getter is called for the first time lazy value\n     * is calculated and then overwrites getter function in given object instance.\n     *\n     * @example:\n     * const redColor = Color.parse('red');\n     * let x = redColor.hcl; // this will invoke `get hcl()`, which will calculate\n     * // the value of red in HCL space and invoke this `overwriteGetter` function\n     * // which in turn will set a field with a key 'hcl' in the `redColor` object.\n     * // In other words it will override `get hcl()` from its `Color` prototype\n     * // with its own property: hcl = [calculated red value in hcl].\n     * let y = redColor.hcl; // next call will no longer invoke getter but simply\n     * // return the previously calculated value\n     * x === y; // true - `x` is exactly the same object as `y`\n     *\n     * @param getterKey Getter key\n     * @param lazyValue Lazily calculated value to be memoized by current instance\n     * @private\n     */\n    overwriteGetter(getterKey, lazyValue) {\n        Object.defineProperty(this, getterKey, { value: lazyValue });\n        return lazyValue;\n    }\n    /**\n     * Used by 'to-string' expression.\n     *\n     * @returns Serialized color in format `rgba(r,g,b,a)`\n     * where r,g,b are numbers within 0..255 and alpha is number within 1..0\n     *\n     * @example\n     * var purple = new Color.parse('purple');\n     * purple.toString; // = \"rgba(128,0,128,1)\"\n     * var translucentGreen = new Color.parse('rgba(26, 207, 26, .73)');\n     * translucentGreen.toString(); // = \"rgba(26,207,26,0.73)\"\n     */\n    toString() {\n        const [r, g, b, a] = this.rgb;\n        return `rgba(${[r, g, b].map(n => Math.round(n * 255)).join(',')},${a})`;\n    }\n    static interpolate(from, to, t, spaceKey = 'rgb') {\n        switch (spaceKey) {\n            case 'rgb': {\n                const [r, g, b, alpha] = interpolateArray(from.rgb, to.rgb, t);\n                return new Color(r, g, b, alpha, false);\n            }\n            case 'hcl': {\n                const [hue0, chroma0, light0, alphaF] = from.hcl;\n                const [hue1, chroma1, light1, alphaT] = to.hcl;\n                // https://github.com/gka/chroma.js/blob/cd1b3c0926c7a85cbdc3b1453b3a94006de91a92/src/interpolator/_hsx.js\n                let hue, chroma;\n                if (!isNaN(hue0) && !isNaN(hue1)) {\n                    let dh = hue1 - hue0;\n                    if (hue1 > hue0 && dh > 180) {\n                        dh -= 360;\n                    }\n                    else if (hue1 < hue0 && hue0 - hue1 > 180) {\n                        dh += 360;\n                    }\n                    hue = hue0 + t * dh;\n                }\n                else if (!isNaN(hue0)) {\n                    hue = hue0;\n                    if (light1 === 1 || light1 === 0)\n                        chroma = chroma0;\n                }\n                else if (!isNaN(hue1)) {\n                    hue = hue1;\n                    if (light0 === 1 || light0 === 0)\n                        chroma = chroma1;\n                }\n                else {\n                    hue = NaN;\n                }\n                const [r, g, b, alpha] = hclToRgb([\n                    hue,\n                    chroma !== null && chroma !== undefined ? chroma : interpolateNumber(chroma0, chroma1, t),\n                    interpolateNumber(light0, light1, t),\n                    interpolateNumber(alphaF, alphaT, t),\n                ]);\n                return new Color(r, g, b, alpha, false);\n            }\n            case 'lab': {\n                const [r, g, b, alpha] = labToRgb(interpolateArray(from.lab, to.lab, t));\n                return new Color(r, g, b, alpha, false);\n            }\n        }\n    }\n}\nColor.black = new Color(0, 0, 0, 1);\nColor.white = new Color(1, 1, 1, 1);\nColor.transparent = new Color(0, 0, 0, 0);\nColor.red = new Color(1, 0, 0, 1);\n\n// Flow type declarations for Intl cribbed from\n// https://github.com/facebook/flow/issues/1270\nclass Collator {\n    constructor(caseSensitive, diacriticSensitive, locale) {\n        if (caseSensitive)\n            this.sensitivity = diacriticSensitive ? 'variant' : 'case';\n        else\n            this.sensitivity = diacriticSensitive ? 'accent' : 'base';\n        this.locale = locale;\n        this.collator = new Intl.Collator(this.locale ? this.locale : [], { sensitivity: this.sensitivity, usage: 'search' });\n    }\n    compare(lhs, rhs) {\n        return this.collator.compare(lhs, rhs);\n    }\n    resolvedLocale() {\n        // We create a Collator without \"usage: search\" because we don't want\n        // the search options encoded in our result (e.g. \"en-u-co-search\")\n        return new Intl.Collator(this.locale ? this.locale : [])\n            .resolvedOptions().locale;\n    }\n}\n\nconst VERTICAL_ALIGN_OPTIONS = ['bottom', 'center', 'top'];\nclass FormattedSection {\n    constructor(text, image, scale, fontStack, textColor, verticalAlign) {\n        this.text = text;\n        this.image = image;\n        this.scale = scale;\n        this.fontStack = fontStack;\n        this.textColor = textColor;\n        this.verticalAlign = verticalAlign;\n    }\n}\nclass Formatted {\n    constructor(sections) {\n        this.sections = sections;\n    }\n    static fromString(unformatted) {\n        return new Formatted([new FormattedSection(unformatted, null, null, null, null, null)]);\n    }\n    isEmpty() {\n        if (this.sections.length === 0)\n            return true;\n        return !this.sections.some(section => section.text.length !== 0 ||\n            (section.image && section.image.name.length !== 0));\n    }\n    static factory(text) {\n        if (text instanceof Formatted) {\n            return text;\n        }\n        else {\n            return Formatted.fromString(text);\n        }\n    }\n    toString() {\n        if (this.sections.length === 0)\n            return '';\n        return this.sections.map(section => section.text).join('');\n    }\n}\n\n/**\n * A set of four numbers representing padding around a box. Create instances from\n * bare arrays or numeric values using the static method `Padding.parse`.\n * @private\n */\nclass Padding {\n    constructor(values) {\n        this.values = values.slice();\n    }\n    /**\n     * Numeric padding values\n     * @param input A padding value\n     * @returns A `Padding` instance, or `undefined` if the input is not a valid padding value.\n     */\n    static parse(input) {\n        if (input instanceof Padding) {\n            return input;\n        }\n        // Backwards compatibility: bare number is treated the same as array with single value.\n        // Padding applies to all four sides.\n        if (typeof input === 'number') {\n            return new Padding([input, input, input, input]);\n        }\n        if (!Array.isArray(input)) {\n            return undefined;\n        }\n        if (input.length < 1 || input.length > 4) {\n            return undefined;\n        }\n        for (const val of input) {\n            if (typeof val !== 'number') {\n                return undefined;\n            }\n        }\n        // Expand shortcut properties into explicit 4-sided values\n        switch (input.length) {\n            case 1:\n                input = [input[0], input[0], input[0], input[0]];\n                break;\n            case 2:\n                input = [input[0], input[1], input[0], input[1]];\n                break;\n            case 3:\n                input = [input[0], input[1], input[2], input[1]];\n                break;\n        }\n        return new Padding(input);\n    }\n    toString() {\n        return JSON.stringify(this.values);\n    }\n    static interpolate(from, to, t) {\n        return new Padding(interpolateArray(from.values, to.values, t));\n    }\n}\n\nclass RuntimeError {\n    constructor(message) {\n        this.name = 'ExpressionEvaluationError';\n        this.message = message;\n    }\n    toJSON() {\n        return this.message;\n    }\n}\n\n/** Set of valid anchor positions, as a set for validation */\nconst anchors = new Set(['center', 'left', 'right', 'top', 'bottom', 'top-left', 'top-right', 'bottom-left', 'bottom-right']);\n/**\n * Utility class to assist managing values for text-variable-anchor-offset property. Create instances from\n * bare arrays using the static method `VariableAnchorOffsetCollection.parse`.\n * @private\n */\nclass VariableAnchorOffsetCollection {\n    constructor(values) {\n        this.values = values.slice();\n    }\n    static parse(input) {\n        if (input instanceof VariableAnchorOffsetCollection) {\n            return input;\n        }\n        if (!Array.isArray(input) ||\n            input.length < 1 ||\n            input.length % 2 !== 0) {\n            return undefined;\n        }\n        for (let i = 0; i < input.length; i += 2) {\n            // Elements in even positions should be anchor positions; Elements in odd positions should be offset values\n            const anchorValue = input[i];\n            const offsetValue = input[i + 1];\n            if (typeof anchorValue !== 'string' || !anchors.has(anchorValue)) {\n                return undefined;\n            }\n            if (!Array.isArray(offsetValue) || offsetValue.length !== 2 || typeof offsetValue[0] !== 'number' || typeof offsetValue[1] !== 'number') {\n                return undefined;\n            }\n        }\n        return new VariableAnchorOffsetCollection(input);\n    }\n    toString() {\n        return JSON.stringify(this.values);\n    }\n    static interpolate(from, to, t) {\n        const fromValues = from.values;\n        const toValues = to.values;\n        if (fromValues.length !== toValues.length) {\n            throw new RuntimeError(`Cannot interpolate values of different length. from: ${from.toString()}, to: ${to.toString()}`);\n        }\n        const output = [];\n        for (let i = 0; i < fromValues.length; i += 2) {\n            // Anchor entries must match\n            if (fromValues[i] !== toValues[i]) {\n                throw new RuntimeError(`Cannot interpolate values containing mismatched anchors. from[${i}]: ${fromValues[i]}, to[${i}]: ${toValues[i]}`);\n            }\n            output.push(fromValues[i]);\n            // Interpolate the offset values for each anchor\n            const [fx, fy] = fromValues[i + 1];\n            const [tx, ty] = toValues[i + 1];\n            output.push([interpolateNumber(fx, tx, t), interpolateNumber(fy, ty, t)]);\n        }\n        return new VariableAnchorOffsetCollection(output);\n    }\n}\n\nclass ResolvedImage {\n    constructor(options) {\n        this.name = options.name;\n        this.available = options.available;\n    }\n    toString() {\n        return this.name;\n    }\n    static fromString(name) {\n        if (!name)\n            return null; // treat empty values as no image\n        return new ResolvedImage({ name, available: false });\n    }\n}\n\nclass ProjectionDefinition {\n    constructor(from, to, transition) {\n        this.from = from;\n        this.to = to;\n        this.transition = transition;\n    }\n    static interpolate(from, to, t) {\n        return new ProjectionDefinition(from, to, t);\n    }\n    static parse(input) {\n        if (input instanceof ProjectionDefinition) {\n            return input;\n        }\n        if (Array.isArray(input) && input.length === 3 && typeof input[0] === 'string' && typeof input[1] === 'string' && typeof input[2] === 'number') {\n            return new ProjectionDefinition(input[0], input[1], input[2]);\n        }\n        if (typeof input === 'object' && typeof input.from === 'string' && typeof input.to === 'string' && typeof input.transition === 'number') {\n            return new ProjectionDefinition(input.from, input.to, input.transition);\n        }\n        if (typeof input === 'string') {\n            return new ProjectionDefinition(input, input, 1);\n        }\n        return undefined;\n    }\n}\n\nfunction validateRGBA(r, g, b, a) {\n    if (!(typeof r === 'number' && r >= 0 && r <= 255 &&\n        typeof g === 'number' && g >= 0 && g <= 255 &&\n        typeof b === 'number' && b >= 0 && b <= 255)) {\n        const value = typeof a === 'number' ? [r, g, b, a] : [r, g, b];\n        return `Invalid rgba value [${value.join(', ')}]: 'r', 'g', and 'b' must be between 0 and 255.`;\n    }\n    if (!(typeof a === 'undefined' || (typeof a === 'number' && a >= 0 && a <= 1))) {\n        return `Invalid rgba value [${[r, g, b, a].join(', ')}]: 'a' must be between 0 and 1.`;\n    }\n    return null;\n}\nfunction isValue(mixed) {\n    if (mixed === null ||\n        typeof mixed === 'string' ||\n        typeof mixed === 'boolean' ||\n        typeof mixed === 'number' ||\n        mixed instanceof ProjectionDefinition ||\n        mixed instanceof Color ||\n        mixed instanceof Collator ||\n        mixed instanceof Formatted ||\n        mixed instanceof Padding ||\n        mixed instanceof VariableAnchorOffsetCollection ||\n        mixed instanceof ResolvedImage) {\n        return true;\n    }\n    else if (Array.isArray(mixed)) {\n        for (const item of mixed) {\n            if (!isValue(item)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    else if (typeof mixed === 'object') {\n        for (const key in mixed) {\n            if (!isValue(mixed[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nfunction typeOf(value) {\n    if (value === null) {\n        return NullType;\n    }\n    else if (typeof value === 'string') {\n        return StringType;\n    }\n    else if (typeof value === 'boolean') {\n        return BooleanType;\n    }\n    else if (typeof value === 'number') {\n        return NumberType;\n    }\n    else if (value instanceof Color) {\n        return ColorType;\n    }\n    else if (value instanceof ProjectionDefinition) {\n        return ProjectionDefinitionType;\n    }\n    else if (value instanceof Collator) {\n        return CollatorType;\n    }\n    else if (value instanceof Formatted) {\n        return FormattedType;\n    }\n    else if (value instanceof Padding) {\n        return PaddingType;\n    }\n    else if (value instanceof VariableAnchorOffsetCollection) {\n        return VariableAnchorOffsetCollectionType;\n    }\n    else if (value instanceof ResolvedImage) {\n        return ResolvedImageType;\n    }\n    else if (Array.isArray(value)) {\n        const length = value.length;\n        let itemType;\n        for (const item of value) {\n            const t = typeOf(item);\n            if (!itemType) {\n                itemType = t;\n            }\n            else if (itemType === t) {\n                continue;\n            }\n            else {\n                itemType = ValueType;\n                break;\n            }\n        }\n        return array(itemType || ValueType, length);\n    }\n    else {\n        return ObjectType;\n    }\n}\nfunction valueToString(value) {\n    const type = typeof value;\n    if (value === null) {\n        return '';\n    }\n    else if (type === 'string' || type === 'number' || type === 'boolean') {\n        return String(value);\n    }\n    else if (value instanceof Color || value instanceof ProjectionDefinition || value instanceof Formatted || value instanceof Padding || value instanceof VariableAnchorOffsetCollection || value instanceof ResolvedImage) {\n        return value.toString();\n    }\n    else {\n        return JSON.stringify(value);\n    }\n}\n\nclass Literal {\n    constructor(type, value) {\n        this.type = type;\n        this.value = value;\n    }\n    static parse(args, context) {\n        if (args.length !== 2)\n            return context.error(`'literal' expression requires exactly one argument, but found ${args.length - 1} instead.`);\n        if (!isValue(args[1]))\n            return context.error('invalid value');\n        const value = args[1];\n        let type = typeOf(value);\n        // special case: infer the item type if possible for zero-length arrays\n        const expected = context.expectedType;\n        if (type.kind === 'array' &&\n            type.N === 0 &&\n            expected &&\n            expected.kind === 'array' &&\n            (typeof expected.N !== 'number' || expected.N === 0)) {\n            type = expected;\n        }\n        return new Literal(type, value);\n    }\n    evaluate() {\n        return this.value;\n    }\n    eachChild() { }\n    outputDefined() {\n        return true;\n    }\n}\n\nconst types$1 = {\n    string: StringType,\n    number: NumberType,\n    boolean: BooleanType,\n    object: ObjectType\n};\nclass Assertion {\n    constructor(type, args) {\n        this.type = type;\n        this.args = args;\n    }\n    static parse(args, context) {\n        if (args.length < 2)\n            return context.error('Expected at least one argument.');\n        let i = 1;\n        let type;\n        const name = args[0];\n        if (name === 'array') {\n            let itemType;\n            if (args.length > 2) {\n                const type = args[1];\n                if (typeof type !== 'string' || !(type in types$1) || type === 'object')\n                    return context.error('The item type argument of \"array\" must be one of string, number, boolean', 1);\n                itemType = types$1[type];\n                i++;\n            }\n            else {\n                itemType = ValueType;\n            }\n            let N;\n            if (args.length > 3) {\n                if (args[2] !== null &&\n                    (typeof args[2] !== 'number' ||\n                        args[2] < 0 ||\n                        args[2] !== Math.floor(args[2]))) {\n                    return context.error('The length argument to \"array\" must be a positive integer literal', 2);\n                }\n                N = args[2];\n                i++;\n            }\n            type = array(itemType, N);\n        }\n        else {\n            if (!types$1[name])\n                throw new Error(`Types doesn't contain name = ${name}`);\n            type = types$1[name];\n        }\n        const parsed = [];\n        for (; i < args.length; i++) {\n            const input = context.parse(args[i], i, ValueType);\n            if (!input)\n                return null;\n            parsed.push(input);\n        }\n        return new Assertion(type, parsed);\n    }\n    evaluate(ctx) {\n        for (let i = 0; i < this.args.length; i++) {\n            const value = this.args[i].evaluate(ctx);\n            const error = checkSubtype(this.type, typeOf(value));\n            if (!error) {\n                return value;\n            }\n            else if (i === this.args.length - 1) {\n                throw new RuntimeError(`Expected value to be of type ${typeToString(this.type)}, but found ${typeToString(typeOf(value))} instead.`);\n            }\n        }\n        throw new Error();\n    }\n    eachChild(fn) {\n        this.args.forEach(fn);\n    }\n    outputDefined() {\n        return this.args.every(arg => arg.outputDefined());\n    }\n}\n\nconst types = {\n    'to-boolean': BooleanType,\n    'to-color': ColorType,\n    'to-number': NumberType,\n    'to-string': StringType\n};\n/**\n * Special form for error-coalescing coercion expressions \"to-number\",\n * \"to-color\".  Since these coercions can fail at runtime, they accept multiple\n * arguments, only evaluating one at a time until one succeeds.\n *\n * @private\n */\nclass Coercion {\n    constructor(type, args) {\n        this.type = type;\n        this.args = args;\n    }\n    static parse(args, context) {\n        if (args.length < 2)\n            return context.error('Expected at least one argument.');\n        const name = args[0];\n        if (!types[name])\n            throw new Error(`Can't parse ${name} as it is not part of the known types`);\n        if ((name === 'to-boolean' || name === 'to-string') && args.length !== 2)\n            return context.error('Expected one argument.');\n        const type = types[name];\n        const parsed = [];\n        for (let i = 1; i < args.length; i++) {\n            const input = context.parse(args[i], i, ValueType);\n            if (!input)\n                return null;\n            parsed.push(input);\n        }\n        return new Coercion(type, parsed);\n    }\n    evaluate(ctx) {\n        switch (this.type.kind) {\n            case 'boolean':\n                return Boolean(this.args[0].evaluate(ctx));\n            case 'color': {\n                let input;\n                let error;\n                for (const arg of this.args) {\n                    input = arg.evaluate(ctx);\n                    error = null;\n                    if (input instanceof Color) {\n                        return input;\n                    }\n                    else if (typeof input === 'string') {\n                        const c = ctx.parseColor(input);\n                        if (c)\n                            return c;\n                    }\n                    else if (Array.isArray(input)) {\n                        if (input.length < 3 || input.length > 4) {\n                            error = `Invalid rgba value ${JSON.stringify(input)}: expected an array containing either three or four numeric values.`;\n                        }\n                        else {\n                            error = validateRGBA(input[0], input[1], input[2], input[3]);\n                        }\n                        if (!error) {\n                            return new Color(input[0] / 255, input[1] / 255, input[2] / 255, input[3]);\n                        }\n                    }\n                }\n                throw new RuntimeError(error || `Could not parse color from value '${typeof input === 'string' ? input : JSON.stringify(input)}'`);\n            }\n            case 'padding': {\n                let input;\n                for (const arg of this.args) {\n                    input = arg.evaluate(ctx);\n                    const pad = Padding.parse(input);\n                    if (pad) {\n                        return pad;\n                    }\n                }\n                throw new RuntimeError(`Could not parse padding from value '${typeof input === 'string' ? input : JSON.stringify(input)}'`);\n            }\n            case 'variableAnchorOffsetCollection': {\n                let input;\n                for (const arg of this.args) {\n                    input = arg.evaluate(ctx);\n                    const coll = VariableAnchorOffsetCollection.parse(input);\n                    if (coll) {\n                        return coll;\n                    }\n                }\n                throw new RuntimeError(`Could not parse variableAnchorOffsetCollection from value '${typeof input === 'string' ? input : JSON.stringify(input)}'`);\n            }\n            case 'number': {\n                let value = null;\n                for (const arg of this.args) {\n                    value = arg.evaluate(ctx);\n                    if (value === null)\n                        return 0;\n                    const num = Number(value);\n                    if (isNaN(num))\n                        continue;\n                    return num;\n                }\n                throw new RuntimeError(`Could not convert ${JSON.stringify(value)} to number.`);\n            }\n            case 'formatted':\n                // There is no explicit 'to-formatted' but this coercion can be implicitly\n                // created by properties that expect the 'formatted' type.\n                return Formatted.fromString(valueToString(this.args[0].evaluate(ctx)));\n            case 'resolvedImage':\n                return ResolvedImage.fromString(valueToString(this.args[0].evaluate(ctx)));\n            case 'projectionDefinition':\n                return this.args[0].evaluate(ctx);\n            default:\n                return valueToString(this.args[0].evaluate(ctx));\n        }\n    }\n    eachChild(fn) {\n        this.args.forEach(fn);\n    }\n    outputDefined() {\n        return this.args.every(arg => arg.outputDefined());\n    }\n}\n\nconst geometryTypes = ['Unknown', 'Point', 'LineString', 'Polygon'];\nclass EvaluationContext {\n    constructor() {\n        this.globals = null;\n        this.feature = null;\n        this.featureState = null;\n        this.formattedSection = null;\n        this._parseColorCache = {};\n        this.availableImages = null;\n        this.canonical = null;\n    }\n    id() {\n        return this.feature && 'id' in this.feature ? this.feature.id : null;\n    }\n    geometryType() {\n        return this.feature ? typeof this.feature.type === 'number' ? geometryTypes[this.feature.type] : this.feature.type : null;\n    }\n    geometry() {\n        return this.feature && 'geometry' in this.feature ? this.feature.geometry : null;\n    }\n    canonicalID() {\n        return this.canonical;\n    }\n    properties() {\n        return this.feature && this.feature.properties || {};\n    }\n    parseColor(input) {\n        let cached = this._parseColorCache[input];\n        if (!cached) {\n            cached = this._parseColorCache[input] = Color.parse(input);\n        }\n        return cached;\n    }\n}\n\n/**\n * State associated parsing at a given point in an expression tree.\n * @private\n */\nclass ParsingContext {\n    constructor(registry, isConstantFunc, path = [], expectedType, scope = new Scope(), errors = []) {\n        this.registry = registry;\n        this.path = path;\n        this.key = path.map(part => `[${part}]`).join('');\n        this.scope = scope;\n        this.errors = errors;\n        this.expectedType = expectedType;\n        this._isConstant = isConstantFunc;\n    }\n    /**\n     * @param expr the JSON expression to parse\n     * @param index the optional argument index if this expression is an argument of a parent expression that's being parsed\n     * @param options\n     * @param options.omitTypeAnnotations set true to omit inferred type annotations.  Caller beware: with this option set, the parsed expression's type will NOT satisfy `expectedType` if it would normally be wrapped in an inferred annotation.\n     * @private\n     */\n    parse(expr, index, expectedType, bindings, options = {}) {\n        if (index) {\n            return this.concat(index, expectedType, bindings)._parse(expr, options);\n        }\n        return this._parse(expr, options);\n    }\n    _parse(expr, options) {\n        if (expr === null || typeof expr === 'string' || typeof expr === 'boolean' || typeof expr === 'number') {\n            expr = ['literal', expr];\n        }\n        function annotate(parsed, type, typeAnnotation) {\n            if (typeAnnotation === 'assert') {\n                return new Assertion(type, [parsed]);\n            }\n            else if (typeAnnotation === 'coerce') {\n                return new Coercion(type, [parsed]);\n            }\n            else {\n                return parsed;\n            }\n        }\n        if (Array.isArray(expr)) {\n            if (expr.length === 0) {\n                return this.error('Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].');\n            }\n            const op = expr[0];\n            if (typeof op !== 'string') {\n                this.error(`Expression name must be a string, but found ${typeof op} instead. If you wanted a literal array, use [\"literal\", [...]].`, 0);\n                return null;\n            }\n            const Expr = this.registry[op];\n            if (Expr) {\n                let parsed = Expr.parse(expr, this);\n                if (!parsed)\n                    return null;\n                if (this.expectedType) {\n                    const expected = this.expectedType;\n                    const actual = parsed.type;\n                    // When we expect a number, string, boolean, or array but have a value, wrap it in an assertion.\n                    // When we expect a color or formatted string, but have a string or value, wrap it in a coercion.\n                    // Otherwise, we do static type-checking.\n                    //\n                    // These behaviors are overridable for:\n                    //   * The \"coalesce\" operator, which needs to omit type annotations.\n                    //   * String-valued properties (e.g. `text-field`), where coercion is more convenient than assertion.\n                    //\n                    if ((expected.kind === 'string' || expected.kind === 'number' || expected.kind === 'boolean' || expected.kind === 'object' || expected.kind === 'array') && actual.kind === 'value') {\n                        parsed = annotate(parsed, expected, options.typeAnnotation || 'assert');\n                    }\n                    else if ((expected.kind === 'projectionDefinition') && (actual.kind === 'string' || actual.kind === 'array')) {\n                        parsed = annotate(parsed, expected, options.typeAnnotation || 'coerce');\n                    }\n                    else if ((expected.kind === 'color' || expected.kind === 'formatted' || expected.kind === 'resolvedImage') && (actual.kind === 'value' || actual.kind === 'string')) {\n                        parsed = annotate(parsed, expected, options.typeAnnotation || 'coerce');\n                    }\n                    else if (expected.kind === 'padding' && (actual.kind === 'value' || actual.kind === 'number' || actual.kind === 'array')) {\n                        parsed = annotate(parsed, expected, options.typeAnnotation || 'coerce');\n                    }\n                    else if (expected.kind === 'variableAnchorOffsetCollection' && (actual.kind === 'value' || actual.kind === 'array')) {\n                        parsed = annotate(parsed, expected, options.typeAnnotation || 'coerce');\n                    }\n                    else if (this.checkSubtype(expected, actual)) {\n                        return null;\n                    }\n                }\n                // If an expression's arguments are all literals, we can evaluate\n                // it immediately and replace it with a literal value in the\n                // parsed/compiled result. Expressions that expect an image should\n                // not be resolved here so we can later get the available images.\n                if (!(parsed instanceof Literal) && (parsed.type.kind !== 'resolvedImage') && this._isConstant(parsed)) {\n                    const ec = new EvaluationContext();\n                    try {\n                        parsed = new Literal(parsed.type, parsed.evaluate(ec));\n                    }\n                    catch (e) {\n                        this.error(e.message);\n                        return null;\n                    }\n                }\n                return parsed;\n            }\n            return this.error(`Unknown expression \"${op}\". If you wanted a literal array, use [\"literal\", [...]].`, 0);\n        }\n        else if (typeof expr === 'undefined') {\n            return this.error('\\'undefined\\' value invalid. Use null instead.');\n        }\n        else if (typeof expr === 'object') {\n            return this.error('Bare objects invalid. Use [\"literal\", {...}] instead.');\n        }\n        else {\n            return this.error(`Expected an array, but found ${typeof expr} instead.`);\n        }\n    }\n    /**\n     * Returns a copy of this context suitable for parsing the subexpression at\n     * index `index`, optionally appending to 'let' binding map.\n     *\n     * Note that `errors` property, intended for collecting errors while\n     * parsing, is copied by reference rather than cloned.\n     * @private\n     */\n    concat(index, expectedType, bindings) {\n        const path = typeof index === 'number' ? this.path.concat(index) : this.path;\n        const scope = bindings ? this.scope.concat(bindings) : this.scope;\n        return new ParsingContext(this.registry, this._isConstant, path, expectedType || null, scope, this.errors);\n    }\n    /**\n     * Push a parsing (or type checking) error into the `this.errors`\n     * @param error The message\n     * @param keys Optionally specify the source of the error at a child\n     * of the current expression at `this.key`.\n     * @private\n     */\n    error(error, ...keys) {\n        const key = `${this.key}${keys.map(k => `[${k}]`).join('')}`;\n        this.errors.push(new ExpressionParsingError(key, error));\n    }\n    /**\n     * Returns null if `t` is a subtype of `expected`; otherwise returns an\n     * error message and also pushes it to `this.errors`.\n     * @param expected The expected type\n     * @param t The actual type\n     * @returns null if `t` is a subtype of `expected`; otherwise returns an error message\n     */\n    checkSubtype(expected, t) {\n        const error = checkSubtype(expected, t);\n        if (error)\n            this.error(error);\n        return error;\n    }\n}\n\nclass Let {\n    constructor(bindings, result) {\n        this.type = result.type;\n        this.bindings = [].concat(bindings);\n        this.result = result;\n    }\n    evaluate(ctx) {\n        return this.result.evaluate(ctx);\n    }\n    eachChild(fn) {\n        for (const binding of this.bindings) {\n            fn(binding[1]);\n        }\n        fn(this.result);\n    }\n    static parse(args, context) {\n        if (args.length < 4)\n            return context.error(`Expected at least 3 arguments, but found ${args.length - 1} instead.`);\n        const bindings = [];\n        for (let i = 1; i < args.length - 1; i += 2) {\n            const name = args[i];\n            if (typeof name !== 'string') {\n                return context.error(`Expected string, but found ${typeof name} instead.`, i);\n            }\n            if (/[^a-zA-Z0-9_]/.test(name)) {\n                return context.error('Variable names must contain only alphanumeric characters or \\'_\\'.', i);\n            }\n            const value = context.parse(args[i + 1], i + 1);\n            if (!value)\n                return null;\n            bindings.push([name, value]);\n        }\n        const result = context.parse(args[args.length - 1], args.length - 1, context.expectedType, bindings);\n        if (!result)\n            return null;\n        return new Let(bindings, result);\n    }\n    outputDefined() {\n        return this.result.outputDefined();\n    }\n}\n\nclass Var {\n    constructor(name, boundExpression) {\n        this.type = boundExpression.type;\n        this.name = name;\n        this.boundExpression = boundExpression;\n    }\n    static parse(args, context) {\n        if (args.length !== 2 || typeof args[1] !== 'string')\n            return context.error('\\'var\\' expression requires exactly one string literal argument.');\n        const name = args[1];\n        if (!context.scope.has(name)) {\n            return context.error(`Unknown variable \"${name}\". Make sure \"${name}\" has been bound in an enclosing \"let\" expression before using it.`, 1);\n        }\n        return new Var(name, context.scope.get(name));\n    }\n    evaluate(ctx) {\n        return this.boundExpression.evaluate(ctx);\n    }\n    eachChild() { }\n    outputDefined() {\n        return false;\n    }\n}\n\nclass At {\n    constructor(type, index, input) {\n        this.type = type;\n        this.index = index;\n        this.input = input;\n    }\n    static parse(args, context) {\n        if (args.length !== 3)\n            return context.error(`Expected 2 arguments, but found ${args.length - 1} instead.`);\n        const index = context.parse(args[1], 1, NumberType);\n        const input = context.parse(args[2], 2, array(context.expectedType || ValueType));\n        if (!index || !input)\n            return null;\n        const t = input.type;\n        return new At(t.itemType, index, input);\n    }\n    evaluate(ctx) {\n        const index = this.index.evaluate(ctx);\n        const array = this.input.evaluate(ctx);\n        if (index < 0) {\n            throw new RuntimeError(`Array index out of bounds: ${index} < 0.`);\n        }\n        if (index >= array.length) {\n            throw new RuntimeError(`Array index out of bounds: ${index} > ${array.length - 1}.`);\n        }\n        if (index !== Math.floor(index)) {\n            throw new RuntimeError(`Array index must be an integer, but found ${index} instead.`);\n        }\n        return array[index];\n    }\n    eachChild(fn) {\n        fn(this.index);\n        fn(this.input);\n    }\n    outputDefined() {\n        return false;\n    }\n}\n\nclass In {\n    constructor(needle, haystack) {\n        this.type = BooleanType;\n        this.needle = needle;\n        this.haystack = haystack;\n    }\n    static parse(args, context) {\n        if (args.length !== 3) {\n            return context.error(`Expected 2 arguments, but found ${args.length - 1} instead.`);\n        }\n        const needle = context.parse(args[1], 1, ValueType);\n        const haystack = context.parse(args[2], 2, ValueType);\n        if (!needle || !haystack)\n            return null;\n        if (!isValidType(needle.type, [BooleanType, StringType, NumberType, NullType, ValueType])) {\n            return context.error(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(needle.type)} instead`);\n        }\n        return new In(needle, haystack);\n    }\n    evaluate(ctx) {\n        const needle = this.needle.evaluate(ctx);\n        const haystack = this.haystack.evaluate(ctx);\n        if (!haystack)\n            return false;\n        if (!isValidNativeType(needle, ['boolean', 'string', 'number', 'null'])) {\n            throw new RuntimeError(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(typeOf(needle))} instead.`);\n        }\n        if (!isValidNativeType(haystack, ['string', 'array'])) {\n            throw new RuntimeError(`Expected second argument to be of type array or string, but found ${typeToString(typeOf(haystack))} instead.`);\n        }\n        return haystack.indexOf(needle) >= 0;\n    }\n    eachChild(fn) {\n        fn(this.needle);\n        fn(this.haystack);\n    }\n    outputDefined() {\n        return true;\n    }\n}\n\nclass IndexOf {\n    constructor(needle, haystack, fromIndex) {\n        this.type = NumberType;\n        this.needle = needle;\n        this.haystack = haystack;\n        this.fromIndex = fromIndex;\n    }\n    static parse(args, context) {\n        if (args.length <= 2 || args.length >= 5) {\n            return context.error(`Expected 3 or 4 arguments, but found ${args.length - 1} instead.`);\n        }\n        const needle = context.parse(args[1], 1, ValueType);\n        const haystack = context.parse(args[2], 2, ValueType);\n        if (!needle || !haystack)\n            return null;\n        if (!isValidType(needle.type, [BooleanType, StringType, NumberType, NullType, ValueType])) {\n            return context.error(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(needle.type)} instead`);\n        }\n        if (args.length === 4) {\n            const fromIndex = context.parse(args[3], 3, NumberType);\n            if (!fromIndex)\n                return null;\n            return new IndexOf(needle, haystack, fromIndex);\n        }\n        else {\n            return new IndexOf(needle, haystack);\n        }\n    }\n    evaluate(ctx) {\n        const needle = this.needle.evaluate(ctx);\n        const haystack = this.haystack.evaluate(ctx);\n        if (!isValidNativeType(needle, ['boolean', 'string', 'number', 'null'])) {\n            throw new RuntimeError(`Expected first argument to be of type boolean, string, number or null, but found ${typeToString(typeOf(needle))} instead.`);\n        }\n        let fromIndex;\n        if (this.fromIndex) {\n            fromIndex = this.fromIndex.evaluate(ctx);\n        }\n        if (isValidNativeType(haystack, ['string'])) {\n            const rawIndex = haystack.indexOf(needle, fromIndex);\n            if (rawIndex === -1) {\n                return -1;\n            }\n            else {\n                // The index may be affected by surrogate pairs, so get the length of the preceding substring.\n                return [...haystack.slice(0, rawIndex)].length;\n            }\n        }\n        else if (isValidNativeType(haystack, ['array'])) {\n            return haystack.indexOf(needle, fromIndex);\n        }\n        else {\n            throw new RuntimeError(`Expected second argument to be of type array or string, but found ${typeToString(typeOf(haystack))} instead.`);\n        }\n    }\n    eachChild(fn) {\n        fn(this.needle);\n        fn(this.haystack);\n        if (this.fromIndex) {\n            fn(this.fromIndex);\n        }\n    }\n    outputDefined() {\n        return false;\n    }\n}\n\nclass Match {\n    constructor(inputType, outputType, input, cases, outputs, otherwise) {\n        this.inputType = inputType;\n        this.type = outputType;\n        this.input = input;\n        this.cases = cases;\n        this.outputs = outputs;\n        this.otherwise = otherwise;\n    }\n    static parse(args, context) {\n        if (args.length < 5)\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        if (args.length % 2 !== 1)\n            return context.error('Expected an even number of arguments.');\n        let inputType;\n        let outputType;\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n        const cases = {};\n        const outputs = [];\n        for (let i = 2; i < args.length - 1; i += 2) {\n            let labels = args[i];\n            const value = args[i + 1];\n            if (!Array.isArray(labels)) {\n                labels = [labels];\n            }\n            const labelContext = context.concat(i);\n            if (labels.length === 0) {\n                return labelContext.error('Expected at least one branch label.');\n            }\n            for (const label of labels) {\n                if (typeof label !== 'number' && typeof label !== 'string') {\n                    return labelContext.error('Branch labels must be numbers or strings.');\n                }\n                else if (typeof label === 'number' && Math.abs(label) > Number.MAX_SAFE_INTEGER) {\n                    return labelContext.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);\n                }\n                else if (typeof label === 'number' && Math.floor(label) !== label) {\n                    return labelContext.error('Numeric branch labels must be integer values.');\n                }\n                else if (!inputType) {\n                    inputType = typeOf(label);\n                }\n                else if (labelContext.checkSubtype(inputType, typeOf(label))) {\n                    return null;\n                }\n                if (typeof cases[String(label)] !== 'undefined') {\n                    return labelContext.error('Branch labels must be unique.');\n                }\n                cases[String(label)] = outputs.length;\n            }\n            const result = context.parse(value, i, outputType);\n            if (!result)\n                return null;\n            outputType = outputType || result.type;\n            outputs.push(result);\n        }\n        const input = context.parse(args[1], 1, ValueType);\n        if (!input)\n            return null;\n        const otherwise = context.parse(args[args.length - 1], args.length - 1, outputType);\n        if (!otherwise)\n            return null;\n        if (input.type.kind !== 'value' && context.concat(1).checkSubtype(inputType, input.type)) {\n            return null;\n        }\n        return new Match(inputType, outputType, input, cases, outputs, otherwise);\n    }\n    evaluate(ctx) {\n        const input = this.input.evaluate(ctx);\n        const output = (typeOf(input) === this.inputType && this.outputs[this.cases[input]]) || this.otherwise;\n        return output.evaluate(ctx);\n    }\n    eachChild(fn) {\n        fn(this.input);\n        this.outputs.forEach(fn);\n        fn(this.otherwise);\n    }\n    outputDefined() {\n        return this.outputs.every(out => out.outputDefined()) && this.otherwise.outputDefined();\n    }\n}\n\nclass Case {\n    constructor(type, branches, otherwise) {\n        this.type = type;\n        this.branches = branches;\n        this.otherwise = otherwise;\n    }\n    static parse(args, context) {\n        if (args.length < 4)\n            return context.error(`Expected at least 3 arguments, but found only ${args.length - 1}.`);\n        if (args.length % 2 !== 0)\n            return context.error('Expected an odd number of arguments.');\n        let outputType;\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n        const branches = [];\n        for (let i = 1; i < args.length - 1; i += 2) {\n            const test = context.parse(args[i], i, BooleanType);\n            if (!test)\n                return null;\n            const result = context.parse(args[i + 1], i + 1, outputType);\n            if (!result)\n                return null;\n            branches.push([test, result]);\n            outputType = outputType || result.type;\n        }\n        const otherwise = context.parse(args[args.length - 1], args.length - 1, outputType);\n        if (!otherwise)\n            return null;\n        if (!outputType)\n            throw new Error('Can\\'t infer output type');\n        return new Case(outputType, branches, otherwise);\n    }\n    evaluate(ctx) {\n        for (const [test, expression] of this.branches) {\n            if (test.evaluate(ctx)) {\n                return expression.evaluate(ctx);\n            }\n        }\n        return this.otherwise.evaluate(ctx);\n    }\n    eachChild(fn) {\n        for (const [test, expression] of this.branches) {\n            fn(test);\n            fn(expression);\n        }\n        fn(this.otherwise);\n    }\n    outputDefined() {\n        return this.branches.every(([_, out]) => out.outputDefined()) && this.otherwise.outputDefined();\n    }\n}\n\nclass Slice {\n    constructor(type, input, beginIndex, endIndex) {\n        this.type = type;\n        this.input = input;\n        this.beginIndex = beginIndex;\n        this.endIndex = endIndex;\n    }\n    static parse(args, context) {\n        if (args.length <= 2 || args.length >= 5) {\n            return context.error(`Expected 3 or 4 arguments, but found ${args.length - 1} instead.`);\n        }\n        const input = context.parse(args[1], 1, ValueType);\n        const beginIndex = context.parse(args[2], 2, NumberType);\n        if (!input || !beginIndex)\n            return null;\n        if (!isValidType(input.type, [array(ValueType), StringType, ValueType])) {\n            return context.error(`Expected first argument to be of type array or string, but found ${typeToString(input.type)} instead`);\n        }\n        if (args.length === 4) {\n            const endIndex = context.parse(args[3], 3, NumberType);\n            if (!endIndex)\n                return null;\n            return new Slice(input.type, input, beginIndex, endIndex);\n        }\n        else {\n            return new Slice(input.type, input, beginIndex);\n        }\n    }\n    evaluate(ctx) {\n        const input = this.input.evaluate(ctx);\n        const beginIndex = this.beginIndex.evaluate(ctx);\n        let endIndex;\n        if (this.endIndex) {\n            endIndex = this.endIndex.evaluate(ctx);\n        }\n        if (isValidNativeType(input, ['string'])) {\n            // Indices may be affected by surrogate pairs.\n            return [...input].slice(beginIndex, endIndex).join('');\n        }\n        else if (isValidNativeType(input, ['array'])) {\n            return input.slice(beginIndex, endIndex);\n        }\n        else {\n            throw new RuntimeError(`Expected first argument to be of type array or string, but found ${typeToString(typeOf(input))} instead.`);\n        }\n    }\n    eachChild(fn) {\n        fn(this.input);\n        fn(this.beginIndex);\n        if (this.endIndex) {\n            fn(this.endIndex);\n        }\n    }\n    outputDefined() {\n        return false;\n    }\n}\n\n/**\n * Returns the index of the last stop <= input, or 0 if it doesn't exist.\n * @private\n */\nfunction findStopLessThanOrEqualTo(stops, input) {\n    const lastIndex = stops.length - 1;\n    let lowerIndex = 0;\n    let upperIndex = lastIndex;\n    let currentIndex = 0;\n    let currentValue, nextValue;\n    while (lowerIndex <= upperIndex) {\n        currentIndex = Math.floor((lowerIndex + upperIndex) / 2);\n        currentValue = stops[currentIndex];\n        nextValue = stops[currentIndex + 1];\n        if (currentValue <= input) {\n            if (currentIndex === lastIndex || input < nextValue) { // Search complete\n                return currentIndex;\n            }\n            lowerIndex = currentIndex + 1;\n        }\n        else if (currentValue > input) {\n            upperIndex = currentIndex - 1;\n        }\n        else {\n            throw new RuntimeError('Input is not a number.');\n        }\n    }\n    return 0;\n}\n\nclass Step {\n    constructor(type, input, stops) {\n        this.type = type;\n        this.input = input;\n        this.labels = [];\n        this.outputs = [];\n        for (const [label, expression] of stops) {\n            this.labels.push(label);\n            this.outputs.push(expression);\n        }\n    }\n    static parse(args, context) {\n        if (args.length - 1 < 4) {\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        }\n        if ((args.length - 1) % 2 !== 0) {\n            return context.error('Expected an even number of arguments.');\n        }\n        const input = context.parse(args[1], 1, NumberType);\n        if (!input)\n            return null;\n        const stops = [];\n        let outputType = null;\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n        for (let i = 1; i < args.length; i += 2) {\n            const label = i === 1 ? -Infinity : args[i];\n            const value = args[i + 1];\n            const labelKey = i;\n            const valueKey = i + 1;\n            if (typeof label !== 'number') {\n                return context.error('Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', labelKey);\n            }\n            if (stops.length && stops[stops.length - 1][0] >= label) {\n                return context.error('Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.', labelKey);\n            }\n            const parsed = context.parse(value, valueKey, outputType);\n            if (!parsed)\n                return null;\n            outputType = outputType || parsed.type;\n            stops.push([label, parsed]);\n        }\n        return new Step(outputType, input, stops);\n    }\n    evaluate(ctx) {\n        const labels = this.labels;\n        const outputs = this.outputs;\n        if (labels.length === 1) {\n            return outputs[0].evaluate(ctx);\n        }\n        const value = this.input.evaluate(ctx);\n        if (value <= labels[0]) {\n            return outputs[0].evaluate(ctx);\n        }\n        const stopCount = labels.length;\n        if (value >= labels[stopCount - 1]) {\n            return outputs[stopCount - 1].evaluate(ctx);\n        }\n        const index = findStopLessThanOrEqualTo(labels, value);\n        return outputs[index].evaluate(ctx);\n    }\n    eachChild(fn) {\n        fn(this.input);\n        for (const expression of this.outputs) {\n            fn(expression);\n        }\n    }\n    outputDefined() {\n        return this.outputs.every(out => out.outputDefined());\n    }\n}\n\nfunction getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nvar unitbezier;\nvar hasRequiredUnitbezier;\n\nfunction requireUnitbezier () {\n\tif (hasRequiredUnitbezier) return unitbezier;\n\thasRequiredUnitbezier = 1;\n\n\tunitbezier = UnitBezier;\n\n\tfunction UnitBezier(p1x, p1y, p2x, p2y) {\n\t    // Calculate the polynomial coefficients, implicit first and last control points are (0,0) and (1,1).\n\t    this.cx = 3.0 * p1x;\n\t    this.bx = 3.0 * (p2x - p1x) - this.cx;\n\t    this.ax = 1.0 - this.cx - this.bx;\n\n\t    this.cy = 3.0 * p1y;\n\t    this.by = 3.0 * (p2y - p1y) - this.cy;\n\t    this.ay = 1.0 - this.cy - this.by;\n\n\t    this.p1x = p1x;\n\t    this.p1y = p1y;\n\t    this.p2x = p2x;\n\t    this.p2y = p2y;\n\t}\n\n\tUnitBezier.prototype = {\n\t    sampleCurveX: function (t) {\n\t        // `ax t^3 + bx t^2 + cx t' expanded using Horner's rule.\n\t        return ((this.ax * t + this.bx) * t + this.cx) * t;\n\t    },\n\n\t    sampleCurveY: function (t) {\n\t        return ((this.ay * t + this.by) * t + this.cy) * t;\n\t    },\n\n\t    sampleCurveDerivativeX: function (t) {\n\t        return (3.0 * this.ax * t + 2.0 * this.bx) * t + this.cx;\n\t    },\n\n\t    solveCurveX: function (x, epsilon) {\n\t        if (epsilon === undefined) epsilon = 1e-6;\n\n\t        if (x < 0.0) return 0.0;\n\t        if (x > 1.0) return 1.0;\n\n\t        var t = x;\n\n\t        // First try a few iterations of Newton's method - normally very fast.\n\t        for (var i = 0; i < 8; i++) {\n\t            var x2 = this.sampleCurveX(t) - x;\n\t            if (Math.abs(x2) < epsilon) return t;\n\n\t            var d2 = this.sampleCurveDerivativeX(t);\n\t            if (Math.abs(d2) < 1e-6) break;\n\n\t            t = t - x2 / d2;\n\t        }\n\n\t        // Fall back to the bisection method for reliability.\n\t        var t0 = 0.0;\n\t        var t1 = 1.0;\n\t        t = x;\n\n\t        for (i = 0; i < 20; i++) {\n\t            x2 = this.sampleCurveX(t);\n\t            if (Math.abs(x2 - x) < epsilon) break;\n\n\t            if (x > x2) {\n\t                t0 = t;\n\t            } else {\n\t                t1 = t;\n\t            }\n\n\t            t = (t1 - t0) * 0.5 + t0;\n\t        }\n\n\t        return t;\n\t    },\n\n\t    solve: function (x, epsilon) {\n\t        return this.sampleCurveY(this.solveCurveX(x, epsilon));\n\t    }\n\t};\n\treturn unitbezier;\n}\n\nvar unitbezierExports = requireUnitbezier();\nvar UnitBezier = /*@__PURE__*/getDefaultExportFromCjs(unitbezierExports);\n\nclass Interpolate {\n    constructor(type, operator, interpolation, input, stops) {\n        this.type = type;\n        this.operator = operator;\n        this.interpolation = interpolation;\n        this.input = input;\n        this.labels = [];\n        this.outputs = [];\n        for (const [label, expression] of stops) {\n            this.labels.push(label);\n            this.outputs.push(expression);\n        }\n    }\n    static interpolationFactor(interpolation, input, lower, upper) {\n        let t = 0;\n        if (interpolation.name === 'exponential') {\n            t = exponentialInterpolation(input, interpolation.base, lower, upper);\n        }\n        else if (interpolation.name === 'linear') {\n            t = exponentialInterpolation(input, 1, lower, upper);\n        }\n        else if (interpolation.name === 'cubic-bezier') {\n            const c = interpolation.controlPoints;\n            const ub = new UnitBezier(c[0], c[1], c[2], c[3]);\n            t = ub.solve(exponentialInterpolation(input, 1, lower, upper));\n        }\n        return t;\n    }\n    static parse(args, context) {\n        let [operator, interpolation, input, ...rest] = args;\n        if (!Array.isArray(interpolation) || interpolation.length === 0) {\n            return context.error('Expected an interpolation type expression.', 1);\n        }\n        if (interpolation[0] === 'linear') {\n            interpolation = { name: 'linear' };\n        }\n        else if (interpolation[0] === 'exponential') {\n            const base = interpolation[1];\n            if (typeof base !== 'number')\n                return context.error('Exponential interpolation requires a numeric base.', 1, 1);\n            interpolation = {\n                name: 'exponential',\n                base\n            };\n        }\n        else if (interpolation[0] === 'cubic-bezier') {\n            const controlPoints = interpolation.slice(1);\n            if (controlPoints.length !== 4 ||\n                controlPoints.some(t => typeof t !== 'number' || t < 0 || t > 1)) {\n                return context.error('Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.', 1);\n            }\n            interpolation = {\n                name: 'cubic-bezier',\n                controlPoints: controlPoints\n            };\n        }\n        else {\n            return context.error(`Unknown interpolation type ${String(interpolation[0])}`, 1, 0);\n        }\n        if (args.length - 1 < 4) {\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        }\n        if ((args.length - 1) % 2 !== 0) {\n            return context.error('Expected an even number of arguments.');\n        }\n        input = context.parse(input, 2, NumberType);\n        if (!input)\n            return null;\n        const stops = [];\n        let outputType = null;\n        if (operator === 'interpolate-hcl' || operator === 'interpolate-lab') {\n            outputType = ColorType;\n        }\n        else if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n        for (let i = 0; i < rest.length; i += 2) {\n            const label = rest[i];\n            const value = rest[i + 1];\n            const labelKey = i + 3;\n            const valueKey = i + 4;\n            if (typeof label !== 'number') {\n                return context.error('Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', labelKey);\n            }\n            if (stops.length && stops[stops.length - 1][0] >= label) {\n                return context.error('Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.', labelKey);\n            }\n            const parsed = context.parse(value, valueKey, outputType);\n            if (!parsed)\n                return null;\n            outputType = outputType || parsed.type;\n            stops.push([label, parsed]);\n        }\n        if (!verifyType(outputType, NumberType) &&\n            !verifyType(outputType, ProjectionDefinitionType) &&\n            !verifyType(outputType, ColorType) &&\n            !verifyType(outputType, PaddingType) &&\n            !verifyType(outputType, VariableAnchorOffsetCollectionType) &&\n            !verifyType(outputType, array(NumberType))) {\n            return context.error(`Type ${typeToString(outputType)} is not interpolatable.`);\n        }\n        return new Interpolate(outputType, operator, interpolation, input, stops);\n    }\n    evaluate(ctx) {\n        const labels = this.labels;\n        const outputs = this.outputs;\n        if (labels.length === 1) {\n            return outputs[0].evaluate(ctx);\n        }\n        const value = this.input.evaluate(ctx);\n        if (value <= labels[0]) {\n            return outputs[0].evaluate(ctx);\n        }\n        const stopCount = labels.length;\n        if (value >= labels[stopCount - 1]) {\n            return outputs[stopCount - 1].evaluate(ctx);\n        }\n        const index = findStopLessThanOrEqualTo(labels, value);\n        const lower = labels[index];\n        const upper = labels[index + 1];\n        const t = Interpolate.interpolationFactor(this.interpolation, value, lower, upper);\n        const outputLower = outputs[index].evaluate(ctx);\n        const outputUpper = outputs[index + 1].evaluate(ctx);\n        switch (this.operator) {\n            case 'interpolate':\n                switch (this.type.kind) {\n                    case 'number':\n                        return interpolateNumber(outputLower, outputUpper, t);\n                    case 'color':\n                        return Color.interpolate(outputLower, outputUpper, t);\n                    case 'padding':\n                        return Padding.interpolate(outputLower, outputUpper, t);\n                    case 'variableAnchorOffsetCollection':\n                        return VariableAnchorOffsetCollection.interpolate(outputLower, outputUpper, t);\n                    case 'array':\n                        return interpolateArray(outputLower, outputUpper, t);\n                    case 'projectionDefinition':\n                        return ProjectionDefinition.interpolate(outputLower, outputUpper, t);\n                }\n            case 'interpolate-hcl':\n                return Color.interpolate(outputLower, outputUpper, t, 'hcl');\n            case 'interpolate-lab':\n                return Color.interpolate(outputLower, outputUpper, t, 'lab');\n        }\n    }\n    eachChild(fn) {\n        fn(this.input);\n        for (const expression of this.outputs) {\n            fn(expression);\n        }\n    }\n    outputDefined() {\n        return this.outputs.every(out => out.outputDefined());\n    }\n}\n/**\n * Returns a ratio that can be used to interpolate between exponential function\n * stops.\n * How it works: Two consecutive stop values define a (scaled and shifted) exponential function `f(x) = a * base^x + b`, where `base` is the user-specified base,\n * and `a` and `b` are constants affording sufficient degrees of freedom to fit\n * the function to the given stops.\n *\n * Here's a bit of algebra that lets us compute `f(x)` directly from the stop\n * values without explicitly solving for `a` and `b`:\n *\n * First stop value: `f(x0) = y0 = a * base^x0 + b`\n * Second stop value: `f(x1) = y1 = a * base^x1 + b`\n * => `y1 - y0 = a(base^x1 - base^x0)`\n * => `a = (y1 - y0)/(base^x1 - base^x0)`\n *\n * Desired value: `f(x) = y = a * base^x + b`\n * => `f(x) = y0 + a * (base^x - base^x0)`\n *\n * From the above, we can replace the `a` in `a * (base^x - base^x0)` and do a\n * little algebra:\n * ```\n * a * (base^x - base^x0) = (y1 - y0)/(base^x1 - base^x0) * (base^x - base^x0)\n *                     = (y1 - y0) * (base^x - base^x0) / (base^x1 - base^x0)\n * ```\n *\n * If we let `(base^x - base^x0) / (base^x1 base^x0)`, then we have\n * `f(x) = y0 + (y1 - y0) * ratio`.  In other words, `ratio` may be treated as\n * an interpolation factor between the two stops' output values.\n *\n * (Note: a slightly different form for `ratio`,\n * `(base^(x-x0) - 1) / (base^(x1-x0) - 1) `, is equivalent, but requires fewer\n * expensive `Math.pow()` operations.)\n *\n * @private\n*/\nfunction exponentialInterpolation(input, base, lowerValue, upperValue) {\n    const difference = upperValue - lowerValue;\n    const progress = input - lowerValue;\n    if (difference === 0) {\n        return 0;\n    }\n    else if (base === 1) {\n        return progress / difference;\n    }\n    else {\n        return (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n    }\n}\nconst interpolateFactory = {\n    color: Color.interpolate,\n    number: interpolateNumber,\n    padding: Padding.interpolate,\n    variableAnchorOffsetCollection: VariableAnchorOffsetCollection.interpolate,\n    array: interpolateArray\n};\n\nclass Coalesce {\n    constructor(type, args) {\n        this.type = type;\n        this.args = args;\n    }\n    static parse(args, context) {\n        if (args.length < 2) {\n            return context.error('Expected at least one argument.');\n        }\n        let outputType = null;\n        const expectedType = context.expectedType;\n        if (expectedType && expectedType.kind !== 'value') {\n            outputType = expectedType;\n        }\n        const parsedArgs = [];\n        for (const arg of args.slice(1)) {\n            const parsed = context.parse(arg, 1 + parsedArgs.length, outputType, undefined, { typeAnnotation: 'omit' });\n            if (!parsed)\n                return null;\n            outputType = outputType || parsed.type;\n            parsedArgs.push(parsed);\n        }\n        if (!outputType)\n            throw new Error('No output type');\n        // Above, we parse arguments without inferred type annotation so that\n        // they don't produce a runtime error for `null` input, which would\n        // preempt the desired null-coalescing behavior.\n        // Thus, if any of our arguments would have needed an annotation, we\n        // need to wrap the enclosing coalesce expression with it instead.\n        const needsAnnotation = expectedType &&\n            parsedArgs.some(arg => checkSubtype(expectedType, arg.type));\n        return needsAnnotation ?\n            new Coalesce(ValueType, parsedArgs) :\n            new Coalesce(outputType, parsedArgs);\n    }\n    evaluate(ctx) {\n        let result = null;\n        let argCount = 0;\n        let requestedImageName;\n        for (const arg of this.args) {\n            argCount++;\n            result = arg.evaluate(ctx);\n            // we need to keep track of the first requested image in a coalesce statement\n            // if coalesce can't find a valid image, we return the first image name so styleimagemissing can fire\n            if (result && result instanceof ResolvedImage && !result.available) {\n                if (!requestedImageName) {\n                    requestedImageName = result.name;\n                }\n                result = null;\n                if (argCount === this.args.length) {\n                    result = requestedImageName;\n                }\n            }\n            if (result !== null)\n                break;\n        }\n        return result;\n    }\n    eachChild(fn) {\n        this.args.forEach(fn);\n    }\n    outputDefined() {\n        return this.args.every(arg => arg.outputDefined());\n    }\n}\n\nfunction isComparableType(op, type) {\n    if (op === '==' || op === '!=') {\n        // equality operator\n        return type.kind === 'boolean' ||\n            type.kind === 'string' ||\n            type.kind === 'number' ||\n            type.kind === 'null' ||\n            type.kind === 'value';\n    }\n    else {\n        // ordering operator\n        return type.kind === 'string' ||\n            type.kind === 'number' ||\n            type.kind === 'value';\n    }\n}\nfunction eq(ctx, a, b) { return a === b; }\nfunction neq(ctx, a, b) { return a !== b; }\nfunction lt(ctx, a, b) { return a < b; }\nfunction gt(ctx, a, b) { return a > b; }\nfunction lteq(ctx, a, b) { return a <= b; }\nfunction gteq(ctx, a, b) { return a >= b; }\nfunction eqCollate(ctx, a, b, c) { return c.compare(a, b) === 0; }\nfunction neqCollate(ctx, a, b, c) { return !eqCollate(ctx, a, b, c); }\nfunction ltCollate(ctx, a, b, c) { return c.compare(a, b) < 0; }\nfunction gtCollate(ctx, a, b, c) { return c.compare(a, b) > 0; }\nfunction lteqCollate(ctx, a, b, c) { return c.compare(a, b) <= 0; }\nfunction gteqCollate(ctx, a, b, c) { return c.compare(a, b) >= 0; }\n/**\n * Special form for comparison operators, implementing the signatures:\n * - (T, T, ?Collator) => boolean\n * - (T, value, ?Collator) => boolean\n * - (value, T, ?Collator) => boolean\n *\n * For inequalities, T must be either value, string, or number. For ==/!=, it\n * can also be boolean or null.\n *\n * Equality semantics are equivalent to Javascript's strict equality (===/!==)\n * -- i.e., when the arguments' types don't match, == evaluates to false, != to\n * true.\n *\n * When types don't match in an ordering comparison, a runtime error is thrown.\n *\n * @private\n */\nfunction makeComparison(op, compareBasic, compareWithCollator) {\n    const isOrderComparison = op !== '==' && op !== '!=';\n    return class Comparison {\n        constructor(lhs, rhs, collator) {\n            this.type = BooleanType;\n            this.lhs = lhs;\n            this.rhs = rhs;\n            this.collator = collator;\n            this.hasUntypedArgument = lhs.type.kind === 'value' || rhs.type.kind === 'value';\n        }\n        static parse(args, context) {\n            if (args.length !== 3 && args.length !== 4)\n                return context.error('Expected two or three arguments.');\n            const op = args[0];\n            let lhs = context.parse(args[1], 1, ValueType);\n            if (!lhs)\n                return null;\n            if (!isComparableType(op, lhs.type)) {\n                return context.concat(1).error(`\"${op}\" comparisons are not supported for type '${typeToString(lhs.type)}'.`);\n            }\n            let rhs = context.parse(args[2], 2, ValueType);\n            if (!rhs)\n                return null;\n            if (!isComparableType(op, rhs.type)) {\n                return context.concat(2).error(`\"${op}\" comparisons are not supported for type '${typeToString(rhs.type)}'.`);\n            }\n            if (lhs.type.kind !== rhs.type.kind &&\n                lhs.type.kind !== 'value' &&\n                rhs.type.kind !== 'value') {\n                return context.error(`Cannot compare types '${typeToString(lhs.type)}' and '${typeToString(rhs.type)}'.`);\n            }\n            if (isOrderComparison) {\n                // typing rules specific to less/greater than operators\n                if (lhs.type.kind === 'value' && rhs.type.kind !== 'value') {\n                    // (value, T)\n                    lhs = new Assertion(rhs.type, [lhs]);\n                }\n                else if (lhs.type.kind !== 'value' && rhs.type.kind === 'value') {\n                    // (T, value)\n                    rhs = new Assertion(lhs.type, [rhs]);\n                }\n            }\n            let collator = null;\n            if (args.length === 4) {\n                if (lhs.type.kind !== 'string' &&\n                    rhs.type.kind !== 'string' &&\n                    lhs.type.kind !== 'value' &&\n                    rhs.type.kind !== 'value') {\n                    return context.error('Cannot use collator to compare non-string types.');\n                }\n                collator = context.parse(args[3], 3, CollatorType);\n                if (!collator)\n                    return null;\n            }\n            return new Comparison(lhs, rhs, collator);\n        }\n        evaluate(ctx) {\n            const lhs = this.lhs.evaluate(ctx);\n            const rhs = this.rhs.evaluate(ctx);\n            if (isOrderComparison && this.hasUntypedArgument) {\n                const lt = typeOf(lhs);\n                const rt = typeOf(rhs);\n                // check that type is string or number, and equal\n                if (lt.kind !== rt.kind || !(lt.kind === 'string' || lt.kind === 'number')) {\n                    throw new RuntimeError(`Expected arguments for \"${op}\" to be (string, string) or (number, number), but found (${lt.kind}, ${rt.kind}) instead.`);\n                }\n            }\n            if (this.collator && !isOrderComparison && this.hasUntypedArgument) {\n                const lt = typeOf(lhs);\n                const rt = typeOf(rhs);\n                if (lt.kind !== 'string' || rt.kind !== 'string') {\n                    return compareBasic(ctx, lhs, rhs);\n                }\n            }\n            return this.collator ?\n                compareWithCollator(ctx, lhs, rhs, this.collator.evaluate(ctx)) :\n                compareBasic(ctx, lhs, rhs);\n        }\n        eachChild(fn) {\n            fn(this.lhs);\n            fn(this.rhs);\n            if (this.collator) {\n                fn(this.collator);\n            }\n        }\n        outputDefined() {\n            return true;\n        }\n    };\n}\nconst Equals = makeComparison('==', eq, eqCollate);\nconst NotEquals = makeComparison('!=', neq, neqCollate);\nconst LessThan = makeComparison('<', lt, ltCollate);\nconst GreaterThan = makeComparison('>', gt, gtCollate);\nconst LessThanOrEqual = makeComparison('<=', lteq, lteqCollate);\nconst GreaterThanOrEqual = makeComparison('>=', gteq, gteqCollate);\n\nclass CollatorExpression {\n    constructor(caseSensitive, diacriticSensitive, locale) {\n        this.type = CollatorType;\n        this.locale = locale;\n        this.caseSensitive = caseSensitive;\n        this.diacriticSensitive = diacriticSensitive;\n    }\n    static parse(args, context) {\n        if (args.length !== 2)\n            return context.error('Expected one argument.');\n        const options = args[1];\n        if (typeof options !== 'object' || Array.isArray(options))\n            return context.error('Collator options argument must be an object.');\n        const caseSensitive = context.parse(options['case-sensitive'] === undefined ? false : options['case-sensitive'], 1, BooleanType);\n        if (!caseSensitive)\n            return null;\n        const diacriticSensitive = context.parse(options['diacritic-sensitive'] === undefined ? false : options['diacritic-sensitive'], 1, BooleanType);\n        if (!diacriticSensitive)\n            return null;\n        let locale = null;\n        if (options['locale']) {\n            locale = context.parse(options['locale'], 1, StringType);\n            if (!locale)\n                return null;\n        }\n        return new CollatorExpression(caseSensitive, diacriticSensitive, locale);\n    }\n    evaluate(ctx) {\n        return new Collator(this.caseSensitive.evaluate(ctx), this.diacriticSensitive.evaluate(ctx), this.locale ? this.locale.evaluate(ctx) : null);\n    }\n    eachChild(fn) {\n        fn(this.caseSensitive);\n        fn(this.diacriticSensitive);\n        if (this.locale) {\n            fn(this.locale);\n        }\n    }\n    outputDefined() {\n        // Technically the set of possible outputs is the combinatoric set of Collators produced\n        // by all possible outputs of locale/caseSensitive/diacriticSensitive\n        // But for the primary use of Collators in comparison operators, we ignore the Collator's\n        // possible outputs anyway, so we can get away with leaving this false for now.\n        return false;\n    }\n}\n\nclass NumberFormat {\n    constructor(number, locale, currency, minFractionDigits, maxFractionDigits) {\n        this.type = StringType;\n        this.number = number;\n        this.locale = locale;\n        this.currency = currency;\n        this.minFractionDigits = minFractionDigits;\n        this.maxFractionDigits = maxFractionDigits;\n    }\n    static parse(args, context) {\n        if (args.length !== 3)\n            return context.error('Expected two arguments.');\n        const number = context.parse(args[1], 1, NumberType);\n        if (!number)\n            return null;\n        const options = args[2];\n        if (typeof options !== 'object' || Array.isArray(options))\n            return context.error('NumberFormat options argument must be an object.');\n        let locale = null;\n        if (options['locale']) {\n            locale = context.parse(options['locale'], 1, StringType);\n            if (!locale)\n                return null;\n        }\n        let currency = null;\n        if (options['currency']) {\n            currency = context.parse(options['currency'], 1, StringType);\n            if (!currency)\n                return null;\n        }\n        let minFractionDigits = null;\n        if (options['min-fraction-digits']) {\n            minFractionDigits = context.parse(options['min-fraction-digits'], 1, NumberType);\n            if (!minFractionDigits)\n                return null;\n        }\n        let maxFractionDigits = null;\n        if (options['max-fraction-digits']) {\n            maxFractionDigits = context.parse(options['max-fraction-digits'], 1, NumberType);\n            if (!maxFractionDigits)\n                return null;\n        }\n        return new NumberFormat(number, locale, currency, minFractionDigits, maxFractionDigits);\n    }\n    evaluate(ctx) {\n        return new Intl.NumberFormat(this.locale ? this.locale.evaluate(ctx) : [], {\n            style: this.currency ? 'currency' : 'decimal',\n            currency: this.currency ? this.currency.evaluate(ctx) : undefined,\n            minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(ctx) : undefined,\n            maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(ctx) : undefined,\n        }).format(this.number.evaluate(ctx));\n    }\n    eachChild(fn) {\n        fn(this.number);\n        if (this.locale) {\n            fn(this.locale);\n        }\n        if (this.currency) {\n            fn(this.currency);\n        }\n        if (this.minFractionDigits) {\n            fn(this.minFractionDigits);\n        }\n        if (this.maxFractionDigits) {\n            fn(this.maxFractionDigits);\n        }\n    }\n    outputDefined() {\n        return false;\n    }\n}\n\nclass FormatExpression {\n    constructor(sections) {\n        this.type = FormattedType;\n        this.sections = sections;\n    }\n    static parse(args, context) {\n        if (args.length < 2) {\n            return context.error('Expected at least one argument.');\n        }\n        const firstArg = args[1];\n        if (!Array.isArray(firstArg) && typeof firstArg === 'object') {\n            return context.error('First argument must be an image or text section.');\n        }\n        const sections = [];\n        let nextTokenMayBeObject = false;\n        for (let i = 1; i <= args.length - 1; ++i) {\n            const arg = args[i];\n            if (nextTokenMayBeObject && typeof arg === 'object' && !Array.isArray(arg)) {\n                nextTokenMayBeObject = false;\n                let scale = null;\n                if (arg['font-scale']) {\n                    scale = context.parse(arg['font-scale'], 1, NumberType);\n                    if (!scale)\n                        return null;\n                }\n                let font = null;\n                if (arg['text-font']) {\n                    font = context.parse(arg['text-font'], 1, array(StringType));\n                    if (!font)\n                        return null;\n                }\n                let textColor = null;\n                if (arg['text-color']) {\n                    textColor = context.parse(arg['text-color'], 1, ColorType);\n                    if (!textColor)\n                        return null;\n                }\n                let verticalAlign = null;\n                if (arg['vertical-align']) {\n                    if (typeof arg['vertical-align'] === 'string' && !VERTICAL_ALIGN_OPTIONS.includes(arg['vertical-align'])) {\n                        return context.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${arg['vertical-align']}' instead.`);\n                    }\n                    verticalAlign = context.parse(arg['vertical-align'], 1, StringType);\n                    if (!verticalAlign)\n                        return null;\n                }\n                const lastExpression = sections[sections.length - 1];\n                lastExpression.scale = scale;\n                lastExpression.font = font;\n                lastExpression.textColor = textColor;\n                lastExpression.verticalAlign = verticalAlign;\n            }\n            else {\n                const content = context.parse(args[i], 1, ValueType);\n                if (!content)\n                    return null;\n                const kind = content.type.kind;\n                if (kind !== 'string' && kind !== 'value' && kind !== 'null' && kind !== 'resolvedImage')\n                    return context.error('Formatted text type must be \\'string\\', \\'value\\', \\'image\\' or \\'null\\'.');\n                nextTokenMayBeObject = true;\n                sections.push({ content, scale: null, font: null, textColor: null, verticalAlign: null });\n            }\n        }\n        return new FormatExpression(sections);\n    }\n    evaluate(ctx) {\n        const evaluateSection = section => {\n            const evaluatedContent = section.content.evaluate(ctx);\n            if (typeOf(evaluatedContent) === ResolvedImageType) {\n                return new FormattedSection('', evaluatedContent, null, null, null, section.verticalAlign ? section.verticalAlign.evaluate(ctx) : null);\n            }\n            return new FormattedSection(valueToString(evaluatedContent), null, section.scale ? section.scale.evaluate(ctx) : null, section.font ? section.font.evaluate(ctx).join(',') : null, section.textColor ? section.textColor.evaluate(ctx) : null, section.verticalAlign ? section.verticalAlign.evaluate(ctx) : null);\n        };\n        return new Formatted(this.sections.map(evaluateSection));\n    }\n    eachChild(fn) {\n        for (const section of this.sections) {\n            fn(section.content);\n            if (section.scale) {\n                fn(section.scale);\n            }\n            if (section.font) {\n                fn(section.font);\n            }\n            if (section.textColor) {\n                fn(section.textColor);\n            }\n            if (section.verticalAlign) {\n                fn(section.verticalAlign);\n            }\n        }\n    }\n    outputDefined() {\n        // Technically the combinatoric set of all children\n        // Usually, this.text will be undefined anyway\n        return false;\n    }\n}\n\nclass ImageExpression {\n    constructor(input) {\n        this.type = ResolvedImageType;\n        this.input = input;\n    }\n    static parse(args, context) {\n        if (args.length !== 2) {\n            return context.error('Expected two arguments.');\n        }\n        const name = context.parse(args[1], 1, StringType);\n        if (!name)\n            return context.error('No image name provided.');\n        return new ImageExpression(name);\n    }\n    evaluate(ctx) {\n        const evaluatedImageName = this.input.evaluate(ctx);\n        const value = ResolvedImage.fromString(evaluatedImageName);\n        if (value && ctx.availableImages)\n            value.available = ctx.availableImages.indexOf(evaluatedImageName) > -1;\n        return value;\n    }\n    eachChild(fn) {\n        fn(this.input);\n    }\n    outputDefined() {\n        // The output of image is determined by the list of available images in the evaluation context\n        return false;\n    }\n}\n\nclass Length {\n    constructor(input) {\n        this.type = NumberType;\n        this.input = input;\n    }\n    static parse(args, context) {\n        if (args.length !== 2)\n            return context.error(`Expected 1 argument, but found ${args.length - 1} instead.`);\n        const input = context.parse(args[1], 1);\n        if (!input)\n            return null;\n        if (input.type.kind !== 'array' && input.type.kind !== 'string' && input.type.kind !== 'value')\n            return context.error(`Expected argument of type string or array, but found ${typeToString(input.type)} instead.`);\n        return new Length(input);\n    }\n    evaluate(ctx) {\n        const input = this.input.evaluate(ctx);\n        if (typeof input === 'string') {\n            // The length may be affected by surrogate pairs.\n            return [...input].length;\n        }\n        else if (Array.isArray(input)) {\n            return input.length;\n        }\n        else {\n            throw new RuntimeError(`Expected value to be of type string or array, but found ${typeToString(typeOf(input))} instead.`);\n        }\n    }\n    eachChild(fn) {\n        fn(this.input);\n    }\n    outputDefined() {\n        return false;\n    }\n}\n\nconst EXTENT = 8192;\nfunction getTileCoordinates(p, canonical) {\n    const x = mercatorXfromLng(p[0]);\n    const y = mercatorYfromLat(p[1]);\n    const tilesAtZoom = Math.pow(2, canonical.z);\n    return [Math.round(x * tilesAtZoom * EXTENT), Math.round(y * tilesAtZoom * EXTENT)];\n}\nfunction getLngLatFromTileCoord(coord, canonical) {\n    const tilesAtZoom = Math.pow(2, canonical.z);\n    const x = (coord[0] / EXTENT + canonical.x) / tilesAtZoom;\n    const y = (coord[1] / EXTENT + canonical.y) / tilesAtZoom;\n    return [lngFromMercatorXfromLng(x), latFromMercatorY(y)];\n}\nfunction mercatorXfromLng(lng) {\n    return (180 + lng) / 360;\n}\nfunction lngFromMercatorXfromLng(mercatorX) {\n    return mercatorX * 360 - 180;\n}\nfunction mercatorYfromLat(lat) {\n    return (180 - (180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + lat * Math.PI / 360)))) / 360;\n}\nfunction latFromMercatorY(mercatorY) {\n    return 360 / Math.PI * Math.atan(Math.exp((180 - mercatorY * 360) * Math.PI / 180)) - 90;\n}\nfunction updateBBox(bbox, coord) {\n    bbox[0] = Math.min(bbox[0], coord[0]);\n    bbox[1] = Math.min(bbox[1], coord[1]);\n    bbox[2] = Math.max(bbox[2], coord[0]);\n    bbox[3] = Math.max(bbox[3], coord[1]);\n}\nfunction boxWithinBox(bbox1, bbox2) {\n    if (bbox1[0] <= bbox2[0])\n        return false;\n    if (bbox1[2] >= bbox2[2])\n        return false;\n    if (bbox1[1] <= bbox2[1])\n        return false;\n    if (bbox1[3] >= bbox2[3])\n        return false;\n    return true;\n}\nfunction rayIntersect(p, p1, p2) {\n    return ((p1[1] > p[1]) !== (p2[1] > p[1])) && (p[0] < (p2[0] - p1[0]) * (p[1] - p1[1]) / (p2[1] - p1[1]) + p1[0]);\n}\nfunction pointOnBoundary(p, p1, p2) {\n    const x1 = p[0] - p1[0];\n    const y1 = p[1] - p1[1];\n    const x2 = p[0] - p2[0];\n    const y2 = p[1] - p2[1];\n    return (x1 * y2 - x2 * y1 === 0) && (x1 * x2 <= 0) && (y1 * y2 <= 0);\n}\n// a, b are end points for line segment1, c and d are end points for line segment2\nfunction segmentIntersectSegment(a, b, c, d) {\n    // check if two segments are parallel or not\n    // precondition is end point a, b is inside polygon, if line a->b is\n    // parallel to polygon edge c->d, then a->b won't intersect with c->d\n    const vectorP = [b[0] - a[0], b[1] - a[1]];\n    const vectorQ = [d[0] - c[0], d[1] - c[1]];\n    if (perp(vectorQ, vectorP) === 0)\n        return false;\n    // If lines are intersecting with each other, the relative location should be:\n    // a and b lie in different sides of segment c->d\n    // c and d lie in different sides of segment a->b\n    if (twoSided(a, b, c, d) && twoSided(c, d, a, b))\n        return true;\n    return false;\n}\nfunction lineIntersectPolygon(p1, p2, polygon) {\n    for (const ring of polygon) {\n        // loop through every edge of the ring\n        for (let j = 0; j < ring.length - 1; ++j) {\n            if (segmentIntersectSegment(p1, p2, ring[j], ring[j + 1])) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n// ray casting algorithm for detecting if point is in polygon\nfunction pointWithinPolygon(point, rings, trueIfOnBoundary = false) {\n    let inside = false;\n    for (const ring of rings) {\n        for (let j = 0; j < ring.length - 1; j++) {\n            if (pointOnBoundary(point, ring[j], ring[j + 1]))\n                return trueIfOnBoundary;\n            if (rayIntersect(point, ring[j], ring[j + 1]))\n                inside = !inside;\n        }\n    }\n    return inside;\n}\nfunction pointWithinPolygons(point, polygons) {\n    for (const polygon of polygons) {\n        if (pointWithinPolygon(point, polygon))\n            return true;\n    }\n    return false;\n}\nfunction lineStringWithinPolygon(line, polygon) {\n    // First, check if geometry points of line segments are all inside polygon\n    for (const point of line) {\n        if (!pointWithinPolygon(point, polygon)) {\n            return false;\n        }\n    }\n    // Second, check if there is line segment intersecting polygon edge\n    for (let i = 0; i < line.length - 1; ++i) {\n        if (lineIntersectPolygon(line[i], line[i + 1], polygon)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction lineStringWithinPolygons(line, polygons) {\n    for (const polygon of polygons) {\n        if (lineStringWithinPolygon(line, polygon))\n            return true;\n    }\n    return false;\n}\nfunction perp(v1, v2) {\n    return (v1[0] * v2[1] - v1[1] * v2[0]);\n}\n// check if p1 and p2 are in different sides of line segment q1->q2\nfunction twoSided(p1, p2, q1, q2) {\n    // q1->p1 (x1, y1), q1->p2 (x2, y2), q1->q2 (x3, y3)\n    const x1 = p1[0] - q1[0];\n    const y1 = p1[1] - q1[1];\n    const x2 = p2[0] - q1[0];\n    const y2 = p2[1] - q1[1];\n    const x3 = q2[0] - q1[0];\n    const y3 = q2[1] - q1[1];\n    const det1 = (x1 * y3 - x3 * y1);\n    const det2 = (x2 * y3 - x3 * y2);\n    if ((det1 > 0 && det2 < 0) || (det1 < 0 && det2 > 0))\n        return true;\n    return false;\n}\n\nfunction getTilePolygon(coordinates, bbox, canonical) {\n    const polygon = [];\n    for (let i = 0; i < coordinates.length; i++) {\n        const ring = [];\n        for (let j = 0; j < coordinates[i].length; j++) {\n            const coord = getTileCoordinates(coordinates[i][j], canonical);\n            updateBBox(bbox, coord);\n            ring.push(coord);\n        }\n        polygon.push(ring);\n    }\n    return polygon;\n}\nfunction getTilePolygons(coordinates, bbox, canonical) {\n    const polygons = [];\n    for (let i = 0; i < coordinates.length; i++) {\n        const polygon = getTilePolygon(coordinates[i], bbox, canonical);\n        polygons.push(polygon);\n    }\n    return polygons;\n}\nfunction updatePoint(p, bbox, polyBBox, worldSize) {\n    if (p[0] < polyBBox[0] || p[0] > polyBBox[2]) {\n        const halfWorldSize = worldSize * 0.5;\n        let shift = (p[0] - polyBBox[0] > halfWorldSize) ? -worldSize : (polyBBox[0] - p[0] > halfWorldSize) ? worldSize : 0;\n        if (shift === 0) {\n            shift = (p[0] - polyBBox[2] > halfWorldSize) ? -worldSize : (polyBBox[2] - p[0] > halfWorldSize) ? worldSize : 0;\n        }\n        p[0] += shift;\n    }\n    updateBBox(bbox, p);\n}\nfunction resetBBox(bbox) {\n    bbox[0] = bbox[1] = Infinity;\n    bbox[2] = bbox[3] = -Infinity;\n}\nfunction getTilePoints(geometry, pointBBox, polyBBox, canonical) {\n    const worldSize = Math.pow(2, canonical.z) * EXTENT;\n    const shifts = [canonical.x * EXTENT, canonical.y * EXTENT];\n    const tilePoints = [];\n    for (const points of geometry) {\n        for (const point of points) {\n            const p = [point.x + shifts[0], point.y + shifts[1]];\n            updatePoint(p, pointBBox, polyBBox, worldSize);\n            tilePoints.push(p);\n        }\n    }\n    return tilePoints;\n}\nfunction getTileLines(geometry, lineBBox, polyBBox, canonical) {\n    const worldSize = Math.pow(2, canonical.z) * EXTENT;\n    const shifts = [canonical.x * EXTENT, canonical.y * EXTENT];\n    const tileLines = [];\n    for (const line of geometry) {\n        const tileLine = [];\n        for (const point of line) {\n            const p = [point.x + shifts[0], point.y + shifts[1]];\n            updateBBox(lineBBox, p);\n            tileLine.push(p);\n        }\n        tileLines.push(tileLine);\n    }\n    if (lineBBox[2] - lineBBox[0] <= worldSize / 2) {\n        resetBBox(lineBBox);\n        for (const line of tileLines) {\n            for (const p of line) {\n                updatePoint(p, lineBBox, polyBBox, worldSize);\n            }\n        }\n    }\n    return tileLines;\n}\nfunction pointsWithinPolygons(ctx, polygonGeometry) {\n    const pointBBox = [Infinity, Infinity, -Infinity, -Infinity];\n    const polyBBox = [Infinity, Infinity, -Infinity, -Infinity];\n    const canonical = ctx.canonicalID();\n    if (polygonGeometry.type === 'Polygon') {\n        const tilePolygon = getTilePolygon(polygonGeometry.coordinates, polyBBox, canonical);\n        const tilePoints = getTilePoints(ctx.geometry(), pointBBox, polyBBox, canonical);\n        if (!boxWithinBox(pointBBox, polyBBox))\n            return false;\n        for (const point of tilePoints) {\n            if (!pointWithinPolygon(point, tilePolygon))\n                return false;\n        }\n    }\n    if (polygonGeometry.type === 'MultiPolygon') {\n        const tilePolygons = getTilePolygons(polygonGeometry.coordinates, polyBBox, canonical);\n        const tilePoints = getTilePoints(ctx.geometry(), pointBBox, polyBBox, canonical);\n        if (!boxWithinBox(pointBBox, polyBBox))\n            return false;\n        for (const point of tilePoints) {\n            if (!pointWithinPolygons(point, tilePolygons))\n                return false;\n        }\n    }\n    return true;\n}\nfunction linesWithinPolygons(ctx, polygonGeometry) {\n    const lineBBox = [Infinity, Infinity, -Infinity, -Infinity];\n    const polyBBox = [Infinity, Infinity, -Infinity, -Infinity];\n    const canonical = ctx.canonicalID();\n    if (polygonGeometry.type === 'Polygon') {\n        const tilePolygon = getTilePolygon(polygonGeometry.coordinates, polyBBox, canonical);\n        const tileLines = getTileLines(ctx.geometry(), lineBBox, polyBBox, canonical);\n        if (!boxWithinBox(lineBBox, polyBBox))\n            return false;\n        for (const line of tileLines) {\n            if (!lineStringWithinPolygon(line, tilePolygon))\n                return false;\n        }\n    }\n    if (polygonGeometry.type === 'MultiPolygon') {\n        const tilePolygons = getTilePolygons(polygonGeometry.coordinates, polyBBox, canonical);\n        const tileLines = getTileLines(ctx.geometry(), lineBBox, polyBBox, canonical);\n        if (!boxWithinBox(lineBBox, polyBBox))\n            return false;\n        for (const line of tileLines) {\n            if (!lineStringWithinPolygons(line, tilePolygons))\n                return false;\n        }\n    }\n    return true;\n}\nclass Within {\n    constructor(geojson, geometries) {\n        this.type = BooleanType;\n        this.geojson = geojson;\n        this.geometries = geometries;\n    }\n    static parse(args, context) {\n        if (args.length !== 2)\n            return context.error(`'within' expression requires exactly one argument, but found ${args.length - 1} instead.`);\n        if (isValue(args[1])) {\n            const geojson = args[1];\n            if (geojson.type === 'FeatureCollection') {\n                const polygonsCoords = [];\n                for (const polygon of geojson.features) {\n                    const { type, coordinates } = polygon.geometry;\n                    if (type === 'Polygon') {\n                        polygonsCoords.push(coordinates);\n                    }\n                    if (type === 'MultiPolygon') {\n                        polygonsCoords.push(...coordinates);\n                    }\n                }\n                if (polygonsCoords.length) {\n                    const multipolygonWrapper = {\n                        type: 'MultiPolygon',\n                        coordinates: polygonsCoords\n                    };\n                    return new Within(geojson, multipolygonWrapper);\n                }\n            }\n            else if (geojson.type === 'Feature') {\n                const type = geojson.geometry.type;\n                if (type === 'Polygon' || type === 'MultiPolygon') {\n                    return new Within(geojson, geojson.geometry);\n                }\n            }\n            else if (geojson.type === 'Polygon' || geojson.type === 'MultiPolygon') {\n                return new Within(geojson, geojson);\n            }\n        }\n        return context.error('\\'within\\' expression requires valid geojson object that contains polygon geometry type.');\n    }\n    evaluate(ctx) {\n        if (ctx.geometry() != null && ctx.canonicalID() != null) {\n            if (ctx.geometryType() === 'Point') {\n                return pointsWithinPolygons(ctx, this.geometries);\n            }\n            else if (ctx.geometryType() === 'LineString') {\n                return linesWithinPolygons(ctx, this.geometries);\n            }\n        }\n        return false;\n    }\n    eachChild() { }\n    outputDefined() {\n        return true;\n    }\n}\n\nclass TinyQueue {\n    constructor(data = [], compare = (a, b) => (a < b ? -1 : a > b ? 1 : 0)) {\n        this.data = data;\n        this.length = this.data.length;\n        this.compare = compare;\n\n        if (this.length > 0) {\n            for (let i = (this.length >> 1) - 1; i >= 0; i--) this._down(i);\n        }\n    }\n\n    push(item) {\n        this.data.push(item);\n        this._up(this.length++);\n    }\n\n    pop() {\n        if (this.length === 0) return undefined;\n\n        const top = this.data[0];\n        const bottom = this.data.pop();\n\n        if (--this.length > 0) {\n            this.data[0] = bottom;\n            this._down(0);\n        }\n\n        return top;\n    }\n\n    peek() {\n        return this.data[0];\n    }\n\n    _up(pos) {\n        const {data, compare} = this;\n        const item = data[pos];\n\n        while (pos > 0) {\n            const parent = (pos - 1) >> 1;\n            const current = data[parent];\n            if (compare(item, current) >= 0) break;\n            data[pos] = current;\n            pos = parent;\n        }\n\n        data[pos] = item;\n    }\n\n    _down(pos) {\n        const {data, compare} = this;\n        const halfLength = this.length >> 1;\n        const item = data[pos];\n\n        while (pos < halfLength) {\n            let bestChild = (pos << 1) + 1; // initially it is the left child\n            const right = bestChild + 1;\n\n            if (right < this.length && compare(data[right], data[bestChild]) < 0) {\n                bestChild = right;\n            }\n            if (compare(data[bestChild], item) >= 0) break;\n\n            data[pos] = data[bestChild];\n            pos = bestChild;\n        }\n\n        data[pos] = item;\n    }\n}\n\n/**\n * Rearranges items so that all items in the [left, k] are the smallest.\n * The k-th element will have the (k - left + 1)-th smallest value in [left, right].\n *\n * @template T\n * @param {T[]} arr the array to partially sort (in place)\n * @param {number} k middle index for partial sorting (as defined above)\n * @param {number} [left=0] left index of the range to sort\n * @param {number} [right=arr.length-1] right index\n * @param {(a: T, b: T) => number} [compare = (a, b) => a - b] compare function\n */\nfunction quickselect(arr, k, left = 0, right = arr.length - 1, compare = defaultCompare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            const n = right - left + 1;\n            const m = k - left + 1;\n            const z = Math.log(n);\n            const s = 0.5 * Math.exp(2 * z / 3);\n            const sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            const newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            const newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselect(arr, k, newLeft, newRight, compare);\n        }\n\n        const t = arr[k];\n        let i = left;\n        /** @type {number} */\n        let j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {number} i\n * @param {number} j\n */\nfunction swap(arr, i, j) {\n    const tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\n/**\n * @template T\n * @param {T} a\n * @param {T} b\n * @returns {number}\n */\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\n/**\n * Classifies an array of rings into polygons with outer rings and holes\n * @param rings - the rings to classify\n * @param maxRings - the maximum number of rings to include in a polygon, use 0 to include all rings\n * @returns an array of polygons with internal rings as holes\n */\nfunction classifyRings(rings, maxRings) {\n    const len = rings.length;\n    if (len <= 1)\n        return [rings];\n    const polygons = [];\n    let polygon;\n    let ccw;\n    for (const ring of rings) {\n        const area = calculateSignedArea(ring);\n        if (area === 0)\n            continue;\n        ring.area = Math.abs(area);\n        if (ccw === undefined)\n            ccw = area < 0;\n        if (ccw === area < 0) {\n            if (polygon)\n                polygons.push(polygon);\n            polygon = [ring];\n        }\n        else {\n            polygon.push(ring);\n        }\n    }\n    if (polygon)\n        polygons.push(polygon);\n    // Earcut performance degrades with the # of rings in a polygon. For this\n    // reason, we limit strip out all but the `maxRings` largest rings.\n    if (maxRings > 1) {\n        for (let j = 0; j < polygons.length; j++) {\n            if (polygons[j].length <= maxRings)\n                continue;\n            quickselect(polygons[j], maxRings, 1, polygons[j].length - 1, compareAreas);\n            polygons[j] = polygons[j].slice(0, maxRings);\n        }\n    }\n    return polygons;\n}\nfunction compareAreas(a, b) {\n    return b.area - a.area;\n}\n/**\n * Returns the signed area for the polygon ring.  Positive areas are exterior rings and\n * have a clockwise winding.  Negative areas are interior rings and have a counter clockwise\n * ordering.\n *\n * @param ring - Exterior or interior ring\n * @returns Signed area\n */\nfunction calculateSignedArea(ring) {\n    let sum = 0;\n    for (let i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n}\n\n// This is taken from https://github.com/mapbox/cheap-ruler/ in order to take only the relevant parts\n// Values that define WGS84 ellipsoid model of the Earth\nconst RE = 6378.137; // equatorial radius\nconst FE = 1 / 298.257223563; // flattening\nconst E2 = FE * (2 - FE);\nconst RAD = Math.PI / 180;\nclass CheapRuler {\n    constructor(lat) {\n        // Curvature formulas from https://en.wikipedia.org/wiki/Earth_radius#Meridional\n        const m = RAD * RE * 1000;\n        const coslat = Math.cos(lat * RAD);\n        const w2 = 1 / (1 - E2 * (1 - coslat * coslat));\n        const w = Math.sqrt(w2);\n        // multipliers for converting longitude and latitude degrees into distance\n        this.kx = m * w * coslat; // based on normal radius of curvature\n        this.ky = m * w * w2 * (1 - E2); // based on meridional radius of curvature\n    }\n    /**\n     * Given two points of the form [longitude, latitude], returns the distance.\n     *\n     * @param a - point [longitude, latitude]\n     * @param b - point [longitude, latitude]\n     * @returns distance\n     * @example\n     * const distance = ruler.distance([30.5, 50.5], [30.51, 50.49]);\n     * //=distance\n     */\n    distance(a, b) {\n        const dx = this.wrap(a[0] - b[0]) * this.kx;\n        const dy = (a[1] - b[1]) * this.ky;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n    /**\n     * Returns an object of the form {point, index, t}, where point is closest point on the line\n     * from the given point, index is the start index of the segment with the closest point,\n     * and t is a parameter from 0 to 1 that indicates where the closest point is on that segment.\n     *\n     * @param line - an array of points that form the line\n     * @param p - point [longitude, latitude]\n     * @returns the nearest point, its index in the array and the proportion along the line\n     * @example\n     * const point = ruler.pointOnLine(line, [-67.04, 50.5]).point;\n     * //=point\n     */\n    pointOnLine(line, p) {\n        let minDist = Infinity;\n        let minX, minY, minI, minT;\n        for (let i = 0; i < line.length - 1; i++) {\n            let x = line[i][0];\n            let y = line[i][1];\n            let dx = this.wrap(line[i + 1][0] - x) * this.kx;\n            let dy = (line[i + 1][1] - y) * this.ky;\n            let t = 0;\n            if (dx !== 0 || dy !== 0) {\n                t = (this.wrap(p[0] - x) * this.kx * dx + (p[1] - y) * this.ky * dy) / (dx * dx + dy * dy);\n                if (t > 1) {\n                    x = line[i + 1][0];\n                    y = line[i + 1][1];\n                }\n                else if (t > 0) {\n                    x += (dx / this.kx) * t;\n                    y += (dy / this.ky) * t;\n                }\n            }\n            dx = this.wrap(p[0] - x) * this.kx;\n            dy = (p[1] - y) * this.ky;\n            const sqDist = dx * dx + dy * dy;\n            if (sqDist < minDist) {\n                minDist = sqDist;\n                minX = x;\n                minY = y;\n                minI = i;\n                minT = t;\n            }\n        }\n        return {\n            point: [minX, minY],\n            index: minI,\n            t: Math.max(0, Math.min(1, minT))\n        };\n    }\n    wrap(deg) {\n        while (deg < -180)\n            deg += 360;\n        while (deg > 180)\n            deg -= 360;\n        return deg;\n    }\n}\n\nconst MinPointsSize = 100;\nconst MinLinePointsSize = 50;\nfunction compareDistPair(a, b) {\n    return b[0] - a[0];\n}\nfunction getRangeSize(range) {\n    return range[1] - range[0] + 1;\n}\nfunction isRangeSafe(range, threshold) {\n    return range[1] >= range[0] && range[1] < threshold;\n}\nfunction splitRange(range, isLine) {\n    if (range[0] > range[1]) {\n        return [null, null];\n    }\n    const size = getRangeSize(range);\n    if (isLine) {\n        if (size === 2) {\n            return [range, null];\n        }\n        const size1 = Math.floor(size / 2);\n        return [[range[0], range[0] + size1],\n            [range[0] + size1, range[1]]];\n    }\n    if (size === 1) {\n        return [range, null];\n    }\n    const size1 = Math.floor(size / 2) - 1;\n    return [[range[0], range[0] + size1],\n        [range[0] + size1 + 1, range[1]]];\n}\nfunction getBBox(coords, range) {\n    if (!isRangeSafe(range, coords.length)) {\n        return [Infinity, Infinity, -Infinity, -Infinity];\n    }\n    const bbox = [Infinity, Infinity, -Infinity, -Infinity];\n    for (let i = range[0]; i <= range[1]; ++i) {\n        updateBBox(bbox, coords[i]);\n    }\n    return bbox;\n}\nfunction getPolygonBBox(polygon) {\n    const bbox = [Infinity, Infinity, -Infinity, -Infinity];\n    for (const ring of polygon) {\n        for (const coord of ring) {\n            updateBBox(bbox, coord);\n        }\n    }\n    return bbox;\n}\nfunction isValidBBox(bbox) {\n    return bbox[0] !== -Infinity && bbox[1] !== -Infinity && bbox[2] !== Infinity && bbox[3] !== Infinity;\n}\n// Calculate the distance between two bounding boxes.\n// Calculate the delta in x and y direction, and use two fake points {0.0, 0.0}\n// and {dx, dy} to calculate the distance. Distance will be 0.0 if bounding box are overlapping.\nfunction bboxToBBoxDistance(bbox1, bbox2, ruler) {\n    if (!isValidBBox(bbox1) || !isValidBBox(bbox2)) {\n        return NaN;\n    }\n    let dx = 0.0;\n    let dy = 0.0;\n    // bbox1 in left side\n    if (bbox1[2] < bbox2[0]) {\n        dx = bbox2[0] - bbox1[2];\n    }\n    // bbox1 in right side\n    if (bbox1[0] > bbox2[2]) {\n        dx = bbox1[0] - bbox2[2];\n    }\n    // bbox1 in above side\n    if (bbox1[1] > bbox2[3]) {\n        dy = bbox1[1] - bbox2[3];\n    }\n    // bbox1 in down side\n    if (bbox1[3] < bbox2[1]) {\n        dy = bbox2[1] - bbox1[3];\n    }\n    return ruler.distance([0.0, 0.0], [dx, dy]);\n}\nfunction pointToLineDistance(point, line, ruler) {\n    const nearestPoint = ruler.pointOnLine(line, point);\n    return ruler.distance(point, nearestPoint.point);\n}\nfunction segmentToSegmentDistance(p1, p2, q1, q2, ruler) {\n    const dist1 = Math.min(pointToLineDistance(p1, [q1, q2], ruler), pointToLineDistance(p2, [q1, q2], ruler));\n    const dist2 = Math.min(pointToLineDistance(q1, [p1, p2], ruler), pointToLineDistance(q2, [p1, p2], ruler));\n    return Math.min(dist1, dist2);\n}\nfunction lineToLineDistance(line1, range1, line2, range2, ruler) {\n    const rangeSafe = isRangeSafe(range1, line1.length) && isRangeSafe(range2, line2.length);\n    if (!rangeSafe) {\n        return Infinity;\n    }\n    let dist = Infinity;\n    for (let i = range1[0]; i < range1[1]; ++i) {\n        const p1 = line1[i];\n        const p2 = line1[i + 1];\n        for (let j = range2[0]; j < range2[1]; ++j) {\n            const q1 = line2[j];\n            const q2 = line2[j + 1];\n            if (segmentIntersectSegment(p1, p2, q1, q2)) {\n                return 0.0;\n            }\n            dist = Math.min(dist, segmentToSegmentDistance(p1, p2, q1, q2, ruler));\n        }\n    }\n    return dist;\n}\nfunction pointsToPointsDistance(points1, range1, points2, range2, ruler) {\n    const rangeSafe = isRangeSafe(range1, points1.length) && isRangeSafe(range2, points2.length);\n    if (!rangeSafe) {\n        return NaN;\n    }\n    let dist = Infinity;\n    for (let i = range1[0]; i <= range1[1]; ++i) {\n        for (let j = range2[0]; j <= range2[1]; ++j) {\n            dist = Math.min(dist, ruler.distance(points1[i], points2[j]));\n            if (dist === 0.0) {\n                return dist;\n            }\n        }\n    }\n    return dist;\n}\nfunction pointToPolygonDistance(point, polygon, ruler) {\n    if (pointWithinPolygon(point, polygon, true)) {\n        return 0.0;\n    }\n    let dist = Infinity;\n    for (const ring of polygon) {\n        const front = ring[0];\n        const back = ring[ring.length - 1];\n        if (front !== back) {\n            dist = Math.min(dist, pointToLineDistance(point, [back, front], ruler));\n            if (dist === 0.0) {\n                return dist;\n            }\n        }\n        const nearestPoint = ruler.pointOnLine(ring, point);\n        dist = Math.min(dist, ruler.distance(point, nearestPoint.point));\n        if (dist === 0.0) {\n            return dist;\n        }\n    }\n    return dist;\n}\nfunction lineToPolygonDistance(line, range, polygon, ruler) {\n    if (!isRangeSafe(range, line.length)) {\n        return NaN;\n    }\n    for (let i = range[0]; i <= range[1]; ++i) {\n        if (pointWithinPolygon(line[i], polygon, true)) {\n            return 0.0;\n        }\n    }\n    let dist = Infinity;\n    for (let i = range[0]; i < range[1]; ++i) {\n        const p1 = line[i];\n        const p2 = line[i + 1];\n        for (const ring of polygon) {\n            for (let j = 0, len = ring.length, k = len - 1; j < len; k = j++) {\n                const q1 = ring[k];\n                const q2 = ring[j];\n                if (segmentIntersectSegment(p1, p2, q1, q2)) {\n                    return 0.0;\n                }\n                dist = Math.min(dist, segmentToSegmentDistance(p1, p2, q1, q2, ruler));\n            }\n        }\n    }\n    return dist;\n}\nfunction polygonIntersect(poly1, poly2) {\n    for (const ring of poly1) {\n        for (const point of ring) {\n            if (pointWithinPolygon(point, poly2, true)) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction polygonToPolygonDistance(polygon1, polygon2, ruler, currentMiniDist = Infinity) {\n    const bbox1 = getPolygonBBox(polygon1);\n    const bbox2 = getPolygonBBox(polygon2);\n    if (currentMiniDist !== Infinity && bboxToBBoxDistance(bbox1, bbox2, ruler) >= currentMiniDist) {\n        return currentMiniDist;\n    }\n    if (boxWithinBox(bbox1, bbox2)) {\n        if (polygonIntersect(polygon1, polygon2)) {\n            return 0.0;\n        }\n    }\n    else if (polygonIntersect(polygon2, polygon1)) {\n        return 0.0;\n    }\n    let dist = Infinity;\n    for (const ring1 of polygon1) {\n        for (let i = 0, len1 = ring1.length, l = len1 - 1; i < len1; l = i++) {\n            const p1 = ring1[l];\n            const p2 = ring1[i];\n            for (const ring2 of polygon2) {\n                for (let j = 0, len2 = ring2.length, k = len2 - 1; j < len2; k = j++) {\n                    const q1 = ring2[k];\n                    const q2 = ring2[j];\n                    if (segmentIntersectSegment(p1, p2, q1, q2)) {\n                        return 0.0;\n                    }\n                    dist = Math.min(dist, segmentToSegmentDistance(p1, p2, q1, q2, ruler));\n                }\n            }\n        }\n    }\n    return dist;\n}\nfunction updateQueue(distQueue, miniDist, ruler, points, polyBBox, rangeA) {\n    if (!rangeA) {\n        return;\n    }\n    const tempDist = bboxToBBoxDistance(getBBox(points, rangeA), polyBBox, ruler);\n    // Insert new pair to the queue if the bbox distance is less than\n    // miniDist, The pair with biggest distance will be at the top\n    if (tempDist < miniDist) {\n        distQueue.push([tempDist, rangeA, [0, 0]]);\n    }\n}\nfunction updateQueueTwoSets(distQueue, miniDist, ruler, pointSet1, pointSet2, range1, range2) {\n    if (!range1 || !range2) {\n        return;\n    }\n    const tempDist = bboxToBBoxDistance(getBBox(pointSet1, range1), getBBox(pointSet2, range2), ruler);\n    // Insert new pair to the queue if the bbox distance is less than\n    // miniDist, The pair with biggest distance will be at the top\n    if (tempDist < miniDist) {\n        distQueue.push([tempDist, range1, range2]);\n    }\n}\n// Divide and conquer, the time complexity is O(n*lgn), faster than Brute force\n// O(n*n) Most of the time, use index for in-place processing.\nfunction pointsToPolygonDistance(points, isLine, polygon, ruler, currentMiniDist = Infinity) {\n    let miniDist = Math.min(ruler.distance(points[0], polygon[0][0]), currentMiniDist);\n    if (miniDist === 0.0) {\n        return miniDist;\n    }\n    const distQueue = new TinyQueue([[0, [0, points.length - 1], [0, 0]]], compareDistPair);\n    const polyBBox = getPolygonBBox(polygon);\n    while (distQueue.length > 0) {\n        const distPair = distQueue.pop();\n        if (distPair[0] >= miniDist) {\n            continue;\n        }\n        const range = distPair[1];\n        // In case the set size are relatively small, we could use brute-force directly\n        const threshold = isLine ? MinLinePointsSize : MinPointsSize;\n        if (getRangeSize(range) <= threshold) {\n            if (!isRangeSafe(range, points.length)) {\n                return NaN;\n            }\n            if (isLine) {\n                const tempDist = lineToPolygonDistance(points, range, polygon, ruler);\n                if (isNaN(tempDist) || tempDist === 0.0) {\n                    return tempDist;\n                }\n                miniDist = Math.min(miniDist, tempDist);\n            }\n            else {\n                for (let i = range[0]; i <= range[1]; ++i) {\n                    const tempDist = pointToPolygonDistance(points[i], polygon, ruler);\n                    miniDist = Math.min(miniDist, tempDist);\n                    if (miniDist === 0.0) {\n                        return 0.0;\n                    }\n                }\n            }\n        }\n        else {\n            const newRangesA = splitRange(range, isLine);\n            updateQueue(distQueue, miniDist, ruler, points, polyBBox, newRangesA[0]);\n            updateQueue(distQueue, miniDist, ruler, points, polyBBox, newRangesA[1]);\n        }\n    }\n    return miniDist;\n}\nfunction pointSetToPointSetDistance(pointSet1, isLine1, pointSet2, isLine2, ruler, currentMiniDist = Infinity) {\n    let miniDist = Math.min(currentMiniDist, ruler.distance(pointSet1[0], pointSet2[0]));\n    if (miniDist === 0.0) {\n        return miniDist;\n    }\n    const distQueue = new TinyQueue([[0, [0, pointSet1.length - 1], [0, pointSet2.length - 1]]], compareDistPair);\n    while (distQueue.length > 0) {\n        const distPair = distQueue.pop();\n        if (distPair[0] >= miniDist) {\n            continue;\n        }\n        const rangeA = distPair[1];\n        const rangeB = distPair[2];\n        const threshold1 = isLine1 ? MinLinePointsSize : MinPointsSize;\n        const threshold2 = isLine2 ? MinLinePointsSize : MinPointsSize;\n        // In case the set size are relatively small, we could use brute-force directly\n        if (getRangeSize(rangeA) <= threshold1 && getRangeSize(rangeB) <= threshold2) {\n            if (!isRangeSafe(rangeA, pointSet1.length) && isRangeSafe(rangeB, pointSet2.length)) {\n                return NaN;\n            }\n            let tempDist;\n            if (isLine1 && isLine2) {\n                tempDist = lineToLineDistance(pointSet1, rangeA, pointSet2, rangeB, ruler);\n                miniDist = Math.min(miniDist, tempDist);\n            }\n            else if (isLine1 && !isLine2) {\n                const sublibe = pointSet1.slice(rangeA[0], rangeA[1] + 1);\n                for (let i = rangeB[0]; i <= rangeB[1]; ++i) {\n                    tempDist = pointToLineDistance(pointSet2[i], sublibe, ruler);\n                    miniDist = Math.min(miniDist, tempDist);\n                    if (miniDist === 0.0) {\n                        return miniDist;\n                    }\n                }\n            }\n            else if (!isLine1 && isLine2) {\n                const sublibe = pointSet2.slice(rangeB[0], rangeB[1] + 1);\n                for (let i = rangeA[0]; i <= rangeA[1]; ++i) {\n                    tempDist = pointToLineDistance(pointSet1[i], sublibe, ruler);\n                    miniDist = Math.min(miniDist, tempDist);\n                    if (miniDist === 0.0) {\n                        return miniDist;\n                    }\n                }\n            }\n            else {\n                tempDist = pointsToPointsDistance(pointSet1, rangeA, pointSet2, rangeB, ruler);\n                miniDist = Math.min(miniDist, tempDist);\n            }\n        }\n        else {\n            const newRangesA = splitRange(rangeA, isLine1);\n            const newRangesB = splitRange(rangeB, isLine2);\n            updateQueueTwoSets(distQueue, miniDist, ruler, pointSet1, pointSet2, newRangesA[0], newRangesB[0]);\n            updateQueueTwoSets(distQueue, miniDist, ruler, pointSet1, pointSet2, newRangesA[0], newRangesB[1]);\n            updateQueueTwoSets(distQueue, miniDist, ruler, pointSet1, pointSet2, newRangesA[1], newRangesB[0]);\n            updateQueueTwoSets(distQueue, miniDist, ruler, pointSet1, pointSet2, newRangesA[1], newRangesB[1]);\n        }\n    }\n    return miniDist;\n}\nfunction pointToGeometryDistance(ctx, geometries) {\n    const tilePoints = ctx.geometry();\n    const pointPosition = tilePoints.flat().map(p => getLngLatFromTileCoord([p.x, p.y], ctx.canonical));\n    if (tilePoints.length === 0) {\n        return NaN;\n    }\n    const ruler = new CheapRuler(pointPosition[0][1]);\n    let dist = Infinity;\n    for (const geometry of geometries) {\n        switch (geometry.type) {\n            case 'Point':\n                dist = Math.min(dist, pointSetToPointSetDistance(pointPosition, false, [geometry.coordinates], false, ruler, dist));\n                break;\n            case 'LineString':\n                dist = Math.min(dist, pointSetToPointSetDistance(pointPosition, false, geometry.coordinates, true, ruler, dist));\n                break;\n            case 'Polygon':\n                dist = Math.min(dist, pointsToPolygonDistance(pointPosition, false, geometry.coordinates, ruler, dist));\n                break;\n        }\n        if (dist === 0.0) {\n            return dist;\n        }\n    }\n    return dist;\n}\nfunction lineStringToGeometryDistance(ctx, geometries) {\n    const tileLine = ctx.geometry();\n    const linePositions = tileLine.flat().map(p => getLngLatFromTileCoord([p.x, p.y], ctx.canonical));\n    if (tileLine.length === 0) {\n        return NaN;\n    }\n    const ruler = new CheapRuler(linePositions[0][1]);\n    let dist = Infinity;\n    for (const geometry of geometries) {\n        switch (geometry.type) {\n            case 'Point':\n                dist = Math.min(dist, pointSetToPointSetDistance(linePositions, true, [geometry.coordinates], false, ruler, dist));\n                break;\n            case 'LineString':\n                dist = Math.min(dist, pointSetToPointSetDistance(linePositions, true, geometry.coordinates, true, ruler, dist));\n                break;\n            case 'Polygon':\n                dist = Math.min(dist, pointsToPolygonDistance(linePositions, true, geometry.coordinates, ruler, dist));\n                break;\n        }\n        if (dist === 0.0) {\n            return dist;\n        }\n    }\n    return dist;\n}\nfunction polygonToGeometryDistance(ctx, geometries) {\n    const tilePolygon = ctx.geometry();\n    if (tilePolygon.length === 0 || tilePolygon[0].length === 0) {\n        return NaN;\n    }\n    const polygons = classifyRings(tilePolygon, 0).map(polygon => {\n        return polygon.map(ring => {\n            return ring.map(p => getLngLatFromTileCoord([p.x, p.y], ctx.canonical));\n        });\n    });\n    const ruler = new CheapRuler(polygons[0][0][0][1]);\n    let dist = Infinity;\n    for (const geometry of geometries) {\n        for (const polygon of polygons) {\n            switch (geometry.type) {\n                case 'Point':\n                    dist = Math.min(dist, pointsToPolygonDistance([geometry.coordinates], false, polygon, ruler, dist));\n                    break;\n                case 'LineString':\n                    dist = Math.min(dist, pointsToPolygonDistance(geometry.coordinates, true, polygon, ruler, dist));\n                    break;\n                case 'Polygon':\n                    dist = Math.min(dist, polygonToPolygonDistance(polygon, geometry.coordinates, ruler, dist));\n                    break;\n            }\n            if (dist === 0.0) {\n                return dist;\n            }\n        }\n    }\n    return dist;\n}\nfunction toSimpleGeometry(geometry) {\n    if (geometry.type === 'MultiPolygon') {\n        return geometry.coordinates.map(polygon => {\n            return {\n                type: 'Polygon',\n                coordinates: polygon\n            };\n        });\n    }\n    if (geometry.type === 'MultiLineString') {\n        return geometry.coordinates.map(lineString => {\n            return {\n                type: 'LineString',\n                coordinates: lineString\n            };\n        });\n    }\n    if (geometry.type === 'MultiPoint') {\n        return geometry.coordinates.map(point => {\n            return {\n                type: 'Point',\n                coordinates: point\n            };\n        });\n    }\n    return [geometry];\n}\nclass Distance {\n    constructor(geojson, geometries) {\n        this.type = NumberType;\n        this.geojson = geojson;\n        this.geometries = geometries;\n    }\n    static parse(args, context) {\n        if (args.length !== 2)\n            return context.error(`'distance' expression requires exactly one argument, but found ${args.length - 1} instead.`);\n        if (isValue(args[1])) {\n            const geojson = args[1];\n            if (geojson.type === 'FeatureCollection') {\n                return new Distance(geojson, geojson.features.map(feature => toSimpleGeometry(feature.geometry)).flat());\n            }\n            else if (geojson.type === 'Feature') {\n                return new Distance(geojson, toSimpleGeometry(geojson.geometry));\n            }\n            else if ('type' in geojson && 'coordinates' in geojson) {\n                return new Distance(geojson, toSimpleGeometry(geojson));\n            }\n        }\n        return context.error('\\'distance\\' expression requires valid geojson object that contains polygon geometry type.');\n    }\n    evaluate(ctx) {\n        if (ctx.geometry() != null && ctx.canonicalID() != null) {\n            if (ctx.geometryType() === 'Point') {\n                return pointToGeometryDistance(ctx, this.geometries);\n            }\n            else if (ctx.geometryType() === 'LineString') {\n                return lineStringToGeometryDistance(ctx, this.geometries);\n            }\n            else if (ctx.geometryType() === 'Polygon') {\n                return polygonToGeometryDistance(ctx, this.geometries);\n            }\n        }\n        return NaN;\n    }\n    eachChild() { }\n    outputDefined() {\n        return true;\n    }\n}\n\nconst expressions$1 = {\n    // special forms\n    '==': Equals,\n    '!=': NotEquals,\n    '>': GreaterThan,\n    '<': LessThan,\n    '>=': GreaterThanOrEqual,\n    '<=': LessThanOrEqual,\n    'array': Assertion,\n    'at': At,\n    'boolean': Assertion,\n    'case': Case,\n    'coalesce': Coalesce,\n    'collator': CollatorExpression,\n    'format': FormatExpression,\n    'image': ImageExpression,\n    'in': In,\n    'index-of': IndexOf,\n    'interpolate': Interpolate,\n    'interpolate-hcl': Interpolate,\n    'interpolate-lab': Interpolate,\n    'length': Length,\n    'let': Let,\n    'literal': Literal,\n    'match': Match,\n    'number': Assertion,\n    'number-format': NumberFormat,\n    'object': Assertion,\n    'slice': Slice,\n    'step': Step,\n    'string': Assertion,\n    'to-boolean': Coercion,\n    'to-color': Coercion,\n    'to-number': Coercion,\n    'to-string': Coercion,\n    'var': Var,\n    'within': Within,\n    'distance': Distance\n};\n\nclass CompoundExpression {\n    constructor(name, type, evaluate, args) {\n        this.name = name;\n        this.type = type;\n        this._evaluate = evaluate;\n        this.args = args;\n    }\n    evaluate(ctx) {\n        return this._evaluate(ctx, this.args);\n    }\n    eachChild(fn) {\n        this.args.forEach(fn);\n    }\n    outputDefined() {\n        return false;\n    }\n    static parse(args, context) {\n        const op = args[0];\n        const definition = CompoundExpression.definitions[op];\n        if (!definition) {\n            return context.error(`Unknown expression \"${op}\". If you wanted a literal array, use [\"literal\", [...]].`, 0);\n        }\n        // Now check argument types against each signature\n        const type = Array.isArray(definition) ?\n            definition[0] : definition.type;\n        const availableOverloads = Array.isArray(definition) ?\n            [[definition[1], definition[2]]] :\n            definition.overloads;\n        const overloads = availableOverloads.filter(([signature]) => (!Array.isArray(signature) || // varags\n            signature.length === args.length - 1 // correct param count\n        ));\n        let signatureContext = null;\n        for (const [params, evaluate] of overloads) {\n            // Use a fresh context for each attempted signature so that, if\n            // we eventually succeed, we haven't polluted `context.errors`.\n            signatureContext = new ParsingContext(context.registry, isExpressionConstant, context.path, null, context.scope);\n            // First parse all the args, potentially coercing to the\n            // types expected by this overload.\n            const parsedArgs = [];\n            let argParseFailed = false;\n            for (let i = 1; i < args.length; i++) {\n                const arg = args[i];\n                const expectedType = Array.isArray(params) ?\n                    params[i - 1] :\n                    params.type;\n                const parsed = signatureContext.parse(arg, 1 + parsedArgs.length, expectedType);\n                if (!parsed) {\n                    argParseFailed = true;\n                    break;\n                }\n                parsedArgs.push(parsed);\n            }\n            if (argParseFailed) {\n                // Couldn't coerce args of this overload to expected type, move\n                // on to next one.\n                continue;\n            }\n            if (Array.isArray(params)) {\n                if (params.length !== parsedArgs.length) {\n                    signatureContext.error(`Expected ${params.length} arguments, but found ${parsedArgs.length} instead.`);\n                    continue;\n                }\n            }\n            for (let i = 0; i < parsedArgs.length; i++) {\n                const expected = Array.isArray(params) ? params[i] : params.type;\n                const arg = parsedArgs[i];\n                signatureContext.concat(i + 1).checkSubtype(expected, arg.type);\n            }\n            if (signatureContext.errors.length === 0) {\n                return new CompoundExpression(op, type, evaluate, parsedArgs);\n            }\n        }\n        if (overloads.length === 1) {\n            context.errors.push(...signatureContext.errors);\n        }\n        else {\n            const expected = overloads.length ? overloads : availableOverloads;\n            const signatures = expected\n                .map(([params]) => stringifySignature(params))\n                .join(' | ');\n            const actualTypes = [];\n            // For error message, re-parse arguments without trying to\n            // apply any coercions\n            for (let i = 1; i < args.length; i++) {\n                const parsed = context.parse(args[i], 1 + actualTypes.length);\n                if (!parsed)\n                    return null;\n                actualTypes.push(typeToString(parsed.type));\n            }\n            context.error(`Expected arguments of type ${signatures}, but found (${actualTypes.join(', ')}) instead.`);\n        }\n        return null;\n    }\n    static register(registry, definitions) {\n        CompoundExpression.definitions = definitions;\n        for (const name in definitions) {\n            registry[name] = CompoundExpression;\n        }\n    }\n}\nfunction rgba(ctx, [r, g, b, a]) {\n    r = r.evaluate(ctx);\n    g = g.evaluate(ctx);\n    b = b.evaluate(ctx);\n    const alpha = a ? a.evaluate(ctx) : 1;\n    const error = validateRGBA(r, g, b, alpha);\n    if (error)\n        throw new RuntimeError(error);\n    return new Color(r / 255, g / 255, b / 255, alpha, false);\n}\nfunction has(key, obj) {\n    return key in obj;\n}\nfunction get(key, obj) {\n    const v = obj[key];\n    return typeof v === 'undefined' ? null : v;\n}\nfunction binarySearch(v, a, i, j) {\n    while (i <= j) {\n        const m = (i + j) >> 1;\n        if (a[m] === v)\n            return true;\n        if (a[m] > v)\n            j = m - 1;\n        else\n            i = m + 1;\n    }\n    return false;\n}\nfunction varargs(type) {\n    return { type };\n}\nCompoundExpression.register(expressions$1, {\n    'error': [\n        ErrorType,\n        [StringType],\n        (ctx, [v]) => { throw new RuntimeError(v.evaluate(ctx)); }\n    ],\n    'typeof': [\n        StringType,\n        [ValueType],\n        (ctx, [v]) => typeToString(typeOf(v.evaluate(ctx)))\n    ],\n    'to-rgba': [\n        array(NumberType, 4),\n        [ColorType],\n        (ctx, [v]) => {\n            const [r, g, b, a] = v.evaluate(ctx).rgb;\n            return [r * 255, g * 255, b * 255, a];\n        },\n    ],\n    'rgb': [\n        ColorType,\n        [NumberType, NumberType, NumberType],\n        rgba\n    ],\n    'rgba': [\n        ColorType,\n        [NumberType, NumberType, NumberType, NumberType],\n        rgba\n    ],\n    'has': {\n        type: BooleanType,\n        overloads: [\n            [\n                [StringType],\n                (ctx, [key]) => has(key.evaluate(ctx), ctx.properties())\n            ], [\n                [StringType, ObjectType],\n                (ctx, [key, obj]) => has(key.evaluate(ctx), obj.evaluate(ctx))\n            ]\n        ]\n    },\n    'get': {\n        type: ValueType,\n        overloads: [\n            [\n                [StringType],\n                (ctx, [key]) => get(key.evaluate(ctx), ctx.properties())\n            ], [\n                [StringType, ObjectType],\n                (ctx, [key, obj]) => get(key.evaluate(ctx), obj.evaluate(ctx))\n            ]\n        ]\n    },\n    'feature-state': [\n        ValueType,\n        [StringType],\n        (ctx, [key]) => get(key.evaluate(ctx), ctx.featureState || {})\n    ],\n    'properties': [\n        ObjectType,\n        [],\n        (ctx) => ctx.properties()\n    ],\n    'geometry-type': [\n        StringType,\n        [],\n        (ctx) => ctx.geometryType()\n    ],\n    'id': [\n        ValueType,\n        [],\n        (ctx) => ctx.id()\n    ],\n    'zoom': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.zoom\n    ],\n    'heatmap-density': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.heatmapDensity || 0\n    ],\n    'line-progress': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.lineProgress || 0\n    ],\n    'accumulated': [\n        ValueType,\n        [],\n        (ctx) => ctx.globals.accumulated === undefined ? null : ctx.globals.accumulated\n    ],\n    '+': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => {\n            let result = 0;\n            for (const arg of args) {\n                result += arg.evaluate(ctx);\n            }\n            return result;\n        }\n    ],\n    '*': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => {\n            let result = 1;\n            for (const arg of args) {\n                result *= arg.evaluate(ctx);\n            }\n            return result;\n        }\n    ],\n    '-': {\n        type: NumberType,\n        overloads: [\n            [\n                [NumberType, NumberType],\n                (ctx, [a, b]) => a.evaluate(ctx) - b.evaluate(ctx)\n            ], [\n                [NumberType],\n                (ctx, [a]) => -a.evaluate(ctx)\n            ]\n        ]\n    },\n    '/': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [a, b]) => a.evaluate(ctx) / b.evaluate(ctx)\n    ],\n    '%': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [a, b]) => a.evaluate(ctx) % b.evaluate(ctx)\n    ],\n    'ln2': [\n        NumberType,\n        [],\n        () => Math.LN2\n    ],\n    'pi': [\n        NumberType,\n        [],\n        () => Math.PI\n    ],\n    'e': [\n        NumberType,\n        [],\n        () => Math.E\n    ],\n    '^': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [b, e]) => Math.pow(b.evaluate(ctx), e.evaluate(ctx))\n    ],\n    'sqrt': [\n        NumberType,\n        [NumberType],\n        (ctx, [x]) => Math.sqrt(x.evaluate(ctx))\n    ],\n    'log10': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log(n.evaluate(ctx)) / Math.LN10\n    ],\n    'ln': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log(n.evaluate(ctx))\n    ],\n    'log2': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log(n.evaluate(ctx)) / Math.LN2\n    ],\n    'sin': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.sin(n.evaluate(ctx))\n    ],\n    'cos': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.cos(n.evaluate(ctx))\n    ],\n    'tan': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.tan(n.evaluate(ctx))\n    ],\n    'asin': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.asin(n.evaluate(ctx))\n    ],\n    'acos': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.acos(n.evaluate(ctx))\n    ],\n    'atan': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.atan(n.evaluate(ctx))\n    ],\n    'min': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => Math.min(...args.map(arg => arg.evaluate(ctx)))\n    ],\n    'max': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => Math.max(...args.map(arg => arg.evaluate(ctx)))\n    ],\n    'abs': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.abs(n.evaluate(ctx))\n    ],\n    'round': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => {\n            const v = n.evaluate(ctx);\n            // Javascript's Math.round() rounds towards +Infinity for halfway\n            // values, even when they're negative. It's more common to round\n            // away from 0 (e.g., this is what python and C++ do)\n            return v < 0 ? -Math.round(-v) : Math.round(v);\n        }\n    ],\n    'floor': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.floor(n.evaluate(ctx))\n    ],\n    'ceil': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.ceil(n.evaluate(ctx))\n    ],\n    'filter-==': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => ctx.properties()[k.value] === v.value\n    ],\n    'filter-id-==': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => ctx.id() === v.value\n    ],\n    'filter-type-==': [\n        BooleanType,\n        [StringType],\n        (ctx, [v]) => ctx.geometryType() === v.value\n    ],\n    'filter-<': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[k.value];\n            const b = v.value;\n            return typeof a === typeof b && a < b;\n        }\n    ],\n    'filter-id-<': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = v.value;\n            return typeof a === typeof b && a < b;\n        }\n    ],\n    'filter->': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[k.value];\n            const b = v.value;\n            return typeof a === typeof b && a > b;\n        }\n    ],\n    'filter-id->': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = v.value;\n            return typeof a === typeof b && a > b;\n        }\n    ],\n    'filter-<=': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[k.value];\n            const b = v.value;\n            return typeof a === typeof b && a <= b;\n        }\n    ],\n    'filter-id-<=': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = v.value;\n            return typeof a === typeof b && a <= b;\n        }\n    ],\n    'filter->=': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[k.value];\n            const b = v.value;\n            return typeof a === typeof b && a >= b;\n        }\n    ],\n    'filter-id->=': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = v.value;\n            return typeof a === typeof b && a >= b;\n        }\n    ],\n    'filter-has': [\n        BooleanType,\n        [ValueType],\n        (ctx, [k]) => k.value in ctx.properties()\n    ],\n    'filter-has-id': [\n        BooleanType,\n        [],\n        (ctx) => (ctx.id() !== null && ctx.id() !== undefined)\n    ],\n    'filter-type-in': [\n        BooleanType,\n        [array(StringType)],\n        (ctx, [v]) => v.value.indexOf(ctx.geometryType()) >= 0\n    ],\n    'filter-id-in': [\n        BooleanType,\n        [array(ValueType)],\n        (ctx, [v]) => v.value.indexOf(ctx.id()) >= 0\n    ],\n    'filter-in-small': [\n        BooleanType,\n        [StringType, array(ValueType)],\n        // assumes v is an array literal\n        (ctx, [k, v]) => v.value.indexOf(ctx.properties()[k.value]) >= 0\n    ],\n    'filter-in-large': [\n        BooleanType,\n        [StringType, array(ValueType)],\n        // assumes v is a array literal with values sorted in ascending order and of a single type\n        (ctx, [k, v]) => binarySearch(ctx.properties()[k.value], v.value, 0, v.value.length - 1)\n    ],\n    'all': {\n        type: BooleanType,\n        overloads: [\n            [\n                [BooleanType, BooleanType],\n                (ctx, [a, b]) => a.evaluate(ctx) && b.evaluate(ctx)\n            ],\n            [\n                varargs(BooleanType),\n                (ctx, args) => {\n                    for (const arg of args) {\n                        if (!arg.evaluate(ctx))\n                            return false;\n                    }\n                    return true;\n                }\n            ]\n        ]\n    },\n    'any': {\n        type: BooleanType,\n        overloads: [\n            [\n                [BooleanType, BooleanType],\n                (ctx, [a, b]) => a.evaluate(ctx) || b.evaluate(ctx)\n            ],\n            [\n                varargs(BooleanType),\n                (ctx, args) => {\n                    for (const arg of args) {\n                        if (arg.evaluate(ctx))\n                            return true;\n                    }\n                    return false;\n                }\n            ]\n        ]\n    },\n    '!': [\n        BooleanType,\n        [BooleanType],\n        (ctx, [b]) => !b.evaluate(ctx)\n    ],\n    'is-supported-script': [\n        BooleanType,\n        [StringType],\n        // At parse time this will always return true, so we need to exclude this expression with isGlobalPropertyConstant\n        (ctx, [s]) => {\n            const isSupportedScript = ctx.globals && ctx.globals.isSupportedScript;\n            if (isSupportedScript) {\n                return isSupportedScript(s.evaluate(ctx));\n            }\n            return true;\n        }\n    ],\n    'upcase': [\n        StringType,\n        [StringType],\n        (ctx, [s]) => s.evaluate(ctx).toUpperCase()\n    ],\n    'downcase': [\n        StringType,\n        [StringType],\n        (ctx, [s]) => s.evaluate(ctx).toLowerCase()\n    ],\n    'concat': [\n        StringType,\n        varargs(ValueType),\n        (ctx, args) => args.map(arg => valueToString(arg.evaluate(ctx))).join('')\n    ],\n    'resolved-locale': [\n        StringType,\n        [CollatorType],\n        (ctx, [collator]) => collator.evaluate(ctx).resolvedLocale()\n    ]\n});\nfunction stringifySignature(signature) {\n    if (Array.isArray(signature)) {\n        return `(${signature.map(typeToString).join(', ')})`;\n    }\n    else {\n        return `(${typeToString(signature.type)}...)`;\n    }\n}\nfunction isExpressionConstant(expression) {\n    if (expression instanceof Var) {\n        return isExpressionConstant(expression.boundExpression);\n    }\n    else if (expression instanceof CompoundExpression && expression.name === 'error') {\n        return false;\n    }\n    else if (expression instanceof CollatorExpression) {\n        // Although the results of a Collator expression with fixed arguments\n        // generally shouldn't change between executions, we can't serialize them\n        // as constant expressions because results change based on environment.\n        return false;\n    }\n    else if (expression instanceof Within) {\n        return false;\n    }\n    else if (expression instanceof Distance) {\n        return false;\n    }\n    const isTypeAnnotation = expression instanceof Coercion ||\n        expression instanceof Assertion;\n    let childrenConstant = true;\n    expression.eachChild(child => {\n        // We can _almost_ assume that if `expressions` children are constant,\n        // they would already have been evaluated to Literal values when they\n        // were parsed.  Type annotations are the exception, because they might\n        // have been inferred and added after a child was parsed.\n        // So we recurse into isConstant() for the children of type annotations,\n        // but otherwise simply check whether they are Literals.\n        if (isTypeAnnotation) {\n            childrenConstant = childrenConstant && isExpressionConstant(child);\n        }\n        else {\n            childrenConstant = childrenConstant && child instanceof Literal;\n        }\n    });\n    if (!childrenConstant) {\n        return false;\n    }\n    return isFeatureConstant(expression) &&\n        isGlobalPropertyConstant(expression, ['zoom', 'heatmap-density', 'line-progress', 'accumulated', 'is-supported-script']);\n}\nfunction isFeatureConstant(e) {\n    if (e instanceof CompoundExpression) {\n        if (e.name === 'get' && e.args.length === 1) {\n            return false;\n        }\n        else if (e.name === 'feature-state') {\n            return false;\n        }\n        else if (e.name === 'has' && e.args.length === 1) {\n            return false;\n        }\n        else if (e.name === 'properties' ||\n            e.name === 'geometry-type' ||\n            e.name === 'id') {\n            return false;\n        }\n        else if (/^filter-/.test(e.name)) {\n            return false;\n        }\n    }\n    if (e instanceof Within) {\n        return false;\n    }\n    if (e instanceof Distance) {\n        return false;\n    }\n    let result = true;\n    e.eachChild(arg => {\n        if (result && !isFeatureConstant(arg)) {\n            result = false;\n        }\n    });\n    return result;\n}\nfunction isStateConstant(e) {\n    if (e instanceof CompoundExpression) {\n        if (e.name === 'feature-state') {\n            return false;\n        }\n    }\n    let result = true;\n    e.eachChild(arg => {\n        if (result && !isStateConstant(arg)) {\n            result = false;\n        }\n    });\n    return result;\n}\nfunction isGlobalPropertyConstant(e, properties) {\n    if (e instanceof CompoundExpression && properties.indexOf(e.name) >= 0) {\n        return false;\n    }\n    let result = true;\n    e.eachChild((arg) => {\n        if (result && !isGlobalPropertyConstant(arg, properties)) {\n            result = false;\n        }\n    });\n    return result;\n}\n\nfunction success(value) {\n    return { result: 'success', value };\n}\nfunction error(value) {\n    return { result: 'error', value };\n}\n\nfunction supportsPropertyExpression(spec) {\n    return spec['property-type'] === 'data-driven' || spec['property-type'] === 'cross-faded-data-driven';\n}\nfunction supportsZoomExpression(spec) {\n    return !!spec.expression && spec.expression.parameters.indexOf('zoom') > -1;\n}\nfunction supportsInterpolation(spec) {\n    return !!spec.expression && spec.expression.interpolated;\n}\n\nfunction getType(val) {\n    if (val instanceof Number) {\n        return 'number';\n    }\n    else if (val instanceof String) {\n        return 'string';\n    }\n    else if (val instanceof Boolean) {\n        return 'boolean';\n    }\n    else if (Array.isArray(val)) {\n        return 'array';\n    }\n    else if (val === null) {\n        return 'null';\n    }\n    else {\n        return typeof val;\n    }\n}\n\nfunction isFunction$1(value) {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\nfunction identityFunction(x) {\n    return x;\n}\nfunction createFunction(parameters, propertySpec) {\n    const isColor = propertySpec.type === 'color';\n    const zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    const featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    const zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    const type = parameters.type || (supportsInterpolation(propertySpec) ? 'exponential' : 'interval');\n    if (isColor || propertySpec.type === 'padding') {\n        const parseFn = isColor ? Color.parse : Padding.parse;\n        parameters = extendBy({}, parameters);\n        if (parameters.stops) {\n            parameters.stops = parameters.stops.map((stop) => {\n                return [stop[0], parseFn(stop[1])];\n            });\n        }\n        if (parameters.default) {\n            parameters.default = parseFn(parameters.default);\n        }\n        else {\n            parameters.default = parseFn(propertySpec.default);\n        }\n    }\n    if (parameters.colorSpace && !isSupportedInterpolationColorSpace(parameters.colorSpace)) {\n        throw new Error(`Unknown color space: \"${parameters.colorSpace}\"`);\n    }\n    let innerFun;\n    let hashedStops;\n    let categoricalKeyType;\n    if (type === 'exponential') {\n        innerFun = evaluateExponentialFunction;\n    }\n    else if (type === 'interval') {\n        innerFun = evaluateIntervalFunction;\n    }\n    else if (type === 'categorical') {\n        innerFun = evaluateCategoricalFunction;\n        // For categorical functions, generate an Object as a hashmap of the stops for fast searching\n        hashedStops = Object.create(null);\n        for (const stop of parameters.stops) {\n            hashedStops[stop[0]] = stop[1];\n        }\n        // Infer key type based on first stop key-- used to encforce strict type checking later\n        categoricalKeyType = typeof parameters.stops[0][0];\n    }\n    else if (type === 'identity') {\n        innerFun = evaluateIdentityFunction;\n    }\n    else {\n        throw new Error(`Unknown function type \"${type}\"`);\n    }\n    if (zoomAndFeatureDependent) {\n        const featureFunctions = {};\n        const zoomStops = [];\n        for (let s = 0; s < parameters.stops.length; s++) {\n            const stop = parameters.stops[s];\n            const zoom = stop[0].zoom;\n            if (featureFunctions[zoom] === undefined) {\n                featureFunctions[zoom] = {\n                    zoom,\n                    type: parameters.type,\n                    property: parameters.property,\n                    default: parameters.default,\n                    stops: []\n                };\n                zoomStops.push(zoom);\n            }\n            featureFunctions[zoom].stops.push([stop[0].value, stop[1]]);\n        }\n        const featureFunctionStops = [];\n        for (const z of zoomStops) {\n            featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z], propertySpec)]);\n        }\n        const interpolationType = { name: 'linear' };\n        return {\n            kind: 'composite',\n            interpolationType,\n            interpolationFactor: Interpolate.interpolationFactor.bind(undefined, interpolationType),\n            zoomStops: featureFunctionStops.map(s => s[0]),\n            evaluate({ zoom }, properties) {\n                return evaluateExponentialFunction({\n                    stops: featureFunctionStops,\n                    base: parameters.base\n                }, propertySpec, zoom).evaluate(zoom, properties);\n            }\n        };\n    }\n    else if (zoomDependent) {\n        const interpolationType = type === 'exponential' ?\n            { name: 'exponential', base: parameters.base !== undefined ? parameters.base : 1 } : null;\n        return {\n            kind: 'camera',\n            interpolationType,\n            interpolationFactor: Interpolate.interpolationFactor.bind(undefined, interpolationType),\n            zoomStops: parameters.stops.map(s => s[0]),\n            evaluate: ({ zoom }) => innerFun(parameters, propertySpec, zoom, hashedStops, categoricalKeyType)\n        };\n    }\n    else {\n        return {\n            kind: 'source',\n            evaluate(_, feature) {\n                const value = feature && feature.properties ? feature.properties[parameters.property] : undefined;\n                if (value === undefined) {\n                    return coalesce$1(parameters.default, propertySpec.default);\n                }\n                return innerFun(parameters, propertySpec, value, hashedStops, categoricalKeyType);\n            }\n        };\n    }\n}\nfunction coalesce$1(a, b, c) {\n    if (a !== undefined)\n        return a;\n    if (b !== undefined)\n        return b;\n    if (c !== undefined)\n        return c;\n}\nfunction evaluateCategoricalFunction(parameters, propertySpec, input, hashedStops, keyType) {\n    const evaluated = typeof input === keyType ? hashedStops[input] : undefined; // Enforce strict typing on input\n    return coalesce$1(evaluated, parameters.default, propertySpec.default);\n}\nfunction evaluateIntervalFunction(parameters, propertySpec, input) {\n    // Edge cases\n    if (getType(input) !== 'number')\n        return coalesce$1(parameters.default, propertySpec.default);\n    const n = parameters.stops.length;\n    if (n === 1)\n        return parameters.stops[0][1];\n    if (input <= parameters.stops[0][0])\n        return parameters.stops[0][1];\n    if (input >= parameters.stops[n - 1][0])\n        return parameters.stops[n - 1][1];\n    const index = findStopLessThanOrEqualTo(parameters.stops.map((stop) => stop[0]), input);\n    return parameters.stops[index][1];\n}\nfunction evaluateExponentialFunction(parameters, propertySpec, input) {\n    const base = parameters.base !== undefined ? parameters.base : 1;\n    // Edge cases\n    if (getType(input) !== 'number')\n        return coalesce$1(parameters.default, propertySpec.default);\n    const n = parameters.stops.length;\n    if (n === 1)\n        return parameters.stops[0][1];\n    if (input <= parameters.stops[0][0])\n        return parameters.stops[0][1];\n    if (input >= parameters.stops[n - 1][0])\n        return parameters.stops[n - 1][1];\n    const index = findStopLessThanOrEqualTo(parameters.stops.map((stop) => stop[0]), input);\n    const t = interpolationFactor(input, base, parameters.stops[index][0], parameters.stops[index + 1][0]);\n    const outputLower = parameters.stops[index][1];\n    const outputUpper = parameters.stops[index + 1][1];\n    const interp = interpolateFactory[propertySpec.type] || identityFunction;\n    if (typeof outputLower.evaluate === 'function') {\n        return {\n            evaluate(...args) {\n                const evaluatedLower = outputLower.evaluate.apply(undefined, args);\n                const evaluatedUpper = outputUpper.evaluate.apply(undefined, args);\n                // Special case for fill-outline-color, which has no spec default.\n                if (evaluatedLower === undefined || evaluatedUpper === undefined) {\n                    return undefined;\n                }\n                return interp(evaluatedLower, evaluatedUpper, t, parameters.colorSpace);\n            }\n        };\n    }\n    return interp(outputLower, outputUpper, t, parameters.colorSpace);\n}\nfunction evaluateIdentityFunction(parameters, propertySpec, input) {\n    switch (propertySpec.type) {\n        case 'color':\n            input = Color.parse(input);\n            break;\n        case 'formatted':\n            input = Formatted.fromString(input.toString());\n            break;\n        case 'resolvedImage':\n            input = ResolvedImage.fromString(input.toString());\n            break;\n        case 'padding':\n            input = Padding.parse(input);\n            break;\n        default:\n            if (getType(input) !== propertySpec.type && (propertySpec.type !== 'enum' || !propertySpec.values[input])) {\n                input = undefined;\n            }\n    }\n    return coalesce$1(input, parameters.default, propertySpec.default);\n}\n/**\n * Returns a ratio that can be used to interpolate between exponential function\n * stops.\n *\n * How it works:\n * Two consecutive stop values define a (scaled and shifted) exponential\n * function `f(x) = a * base^x + b`, where `base` is the user-specified base,\n * and `a` and `b` are constants affording sufficient degrees of freedom to fit\n * the function to the given stops.\n *\n * Here's a bit of algebra that lets us compute `f(x)` directly from the stop\n * values without explicitly solving for `a` and `b`:\n *\n * First stop value: `f(x0) = y0 = a * base^x0 + b`\n * Second stop value: `f(x1) = y1 = a * base^x1 + b`\n * => `y1 - y0 = a(base^x1 - base^x0)`\n * => `a = (y1 - y0)/(base^x1 - base^x0)`\n *\n * Desired value: `f(x) = y = a * base^x + b`\n * => `f(x) = y0 + a * (base^x - base^x0)`\n *\n * From the above, we can replace the `a` in `a * (base^x - base^x0)` and do a\n * little algebra:\n * ```\n * a * (base^x - base^x0) = (y1 - y0)/(base^x1 - base^x0) * (base^x - base^x0)\n *                     = (y1 - y0) * (base^x - base^x0) / (base^x1 - base^x0)\n * ```\n *\n * If we let `(base^x - base^x0) / (base^x1 base^x0)`, then we have\n * `f(x) = y0 + (y1 - y0) * ratio`.  In other words, `ratio` may be treated as\n * an interpolation factor between the two stops' output values.\n *\n * (Note: a slightly different form for `ratio`,\n * `(base^(x-x0) - 1) / (base^(x1-x0) - 1) `, is equivalent, but requires fewer\n * expensive `Math.pow()` operations.)\n *\n * @private\n */\nfunction interpolationFactor(input, base, lowerValue, upperValue) {\n    const difference = upperValue - lowerValue;\n    const progress = input - lowerValue;\n    if (difference === 0) {\n        return 0;\n    }\n    else if (base === 1) {\n        return progress / difference;\n    }\n    else {\n        return (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n    }\n}\n\nclass StyleExpression {\n    constructor(expression, propertySpec) {\n        this.expression = expression;\n        this._warningHistory = {};\n        this._evaluator = new EvaluationContext();\n        this._defaultValue = propertySpec ? getDefaultValue(propertySpec) : null;\n        this._enumValues = propertySpec && propertySpec.type === 'enum' ? propertySpec.values : null;\n    }\n    evaluateWithoutErrorHandling(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        this._evaluator.globals = globals;\n        this._evaluator.feature = feature;\n        this._evaluator.featureState = featureState;\n        this._evaluator.canonical = canonical;\n        this._evaluator.availableImages = availableImages || null;\n        this._evaluator.formattedSection = formattedSection;\n        return this.expression.evaluate(this._evaluator);\n    }\n    evaluate(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        this._evaluator.globals = globals;\n        this._evaluator.feature = feature || null;\n        this._evaluator.featureState = featureState || null;\n        this._evaluator.canonical = canonical;\n        this._evaluator.availableImages = availableImages || null;\n        this._evaluator.formattedSection = formattedSection || null;\n        try {\n            const val = this.expression.evaluate(this._evaluator);\n            if (val === null || val === undefined || (typeof val === 'number' && val !== val)) {\n                return this._defaultValue;\n            }\n            if (this._enumValues && !(val in this._enumValues)) {\n                throw new RuntimeError(`Expected value to be one of ${Object.keys(this._enumValues).map(v => JSON.stringify(v)).join(', ')}, but found ${JSON.stringify(val)} instead.`);\n            }\n            return val;\n        }\n        catch (e) {\n            if (!this._warningHistory[e.message]) {\n                this._warningHistory[e.message] = true;\n                if (typeof console !== 'undefined') {\n                    console.warn(e.message);\n                }\n            }\n            return this._defaultValue;\n        }\n    }\n}\nfunction isExpression(expression) {\n    return Array.isArray(expression) && expression.length > 0 &&\n        typeof expression[0] === 'string' && expression[0] in expressions$1;\n}\n/**\n * Parse and typecheck the given style spec JSON expression.  If\n * options.defaultValue is provided, then the resulting StyleExpression's\n * `evaluate()` method will handle errors by logging a warning (once per\n * message) and returning the default value.  Otherwise, it will throw\n * evaluation errors.\n *\n * @private\n */\nfunction createExpression(expression, propertySpec) {\n    const parser = new ParsingContext(expressions$1, isExpressionConstant, [], propertySpec ? getExpectedType(propertySpec) : undefined);\n    // For string-valued properties, coerce to string at the top level rather than asserting.\n    const parsed = parser.parse(expression, undefined, undefined, undefined, propertySpec && propertySpec.type === 'string' ? { typeAnnotation: 'coerce' } : undefined);\n    if (!parsed) {\n        return error(parser.errors);\n    }\n    return success(new StyleExpression(parsed, propertySpec));\n}\nclass ZoomConstantExpression {\n    constructor(kind, expression) {\n        this.kind = kind;\n        this._styleExpression = expression;\n        this.isStateDependent = kind !== 'constant' && !isStateConstant(expression.expression);\n    }\n    evaluateWithoutErrorHandling(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        return this._styleExpression.evaluateWithoutErrorHandling(globals, feature, featureState, canonical, availableImages, formattedSection);\n    }\n    evaluate(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        return this._styleExpression.evaluate(globals, feature, featureState, canonical, availableImages, formattedSection);\n    }\n}\nclass ZoomDependentExpression {\n    constructor(kind, expression, zoomStops, interpolationType) {\n        this.kind = kind;\n        this.zoomStops = zoomStops;\n        this._styleExpression = expression;\n        this.isStateDependent = kind !== 'camera' && !isStateConstant(expression.expression);\n        this.interpolationType = interpolationType;\n    }\n    evaluateWithoutErrorHandling(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        return this._styleExpression.evaluateWithoutErrorHandling(globals, feature, featureState, canonical, availableImages, formattedSection);\n    }\n    evaluate(globals, feature, featureState, canonical, availableImages, formattedSection) {\n        return this._styleExpression.evaluate(globals, feature, featureState, canonical, availableImages, formattedSection);\n    }\n    interpolationFactor(input, lower, upper) {\n        if (this.interpolationType) {\n            return Interpolate.interpolationFactor(this.interpolationType, input, lower, upper);\n        }\n        else {\n            return 0;\n        }\n    }\n}\nfunction isZoomExpression(expression) {\n    return expression._styleExpression !== undefined;\n}\nfunction createPropertyExpression(expressionInput, propertySpec) {\n    const expression = createExpression(expressionInput, propertySpec);\n    if (expression.result === 'error') {\n        return expression;\n    }\n    const parsed = expression.value.expression;\n    const isFeatureConstantResult = isFeatureConstant(parsed);\n    if (!isFeatureConstantResult && !supportsPropertyExpression(propertySpec)) {\n        return error([new ExpressionParsingError('', 'data expressions not supported')]);\n    }\n    const isZoomConstant = isGlobalPropertyConstant(parsed, ['zoom']);\n    if (!isZoomConstant && !supportsZoomExpression(propertySpec)) {\n        return error([new ExpressionParsingError('', 'zoom expressions not supported')]);\n    }\n    const zoomCurve = findZoomCurve(parsed);\n    if (!zoomCurve && !isZoomConstant) {\n        return error([new ExpressionParsingError('', '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.')]);\n    }\n    else if (zoomCurve instanceof ExpressionParsingError) {\n        return error([zoomCurve]);\n    }\n    else if (zoomCurve instanceof Interpolate && !supportsInterpolation(propertySpec)) {\n        return error([new ExpressionParsingError('', '\"interpolate\" expressions cannot be used with this property')]);\n    }\n    if (!zoomCurve) {\n        return success(isFeatureConstantResult ?\n            new ZoomConstantExpression('constant', expression.value) :\n            new ZoomConstantExpression('source', expression.value));\n    }\n    const interpolationType = zoomCurve instanceof Interpolate ? zoomCurve.interpolation : undefined;\n    return success(isFeatureConstantResult ?\n        new ZoomDependentExpression('camera', expression.value, zoomCurve.labels, interpolationType) :\n        new ZoomDependentExpression('composite', expression.value, zoomCurve.labels, interpolationType));\n}\n// serialization wrapper for old-style stop functions normalized to the\n// expression interface\nclass StylePropertyFunction {\n    constructor(parameters, specification) {\n        this._parameters = parameters;\n        this._specification = specification;\n        extendBy(this, createFunction(this._parameters, this._specification));\n    }\n    static deserialize(serialized) {\n        return new StylePropertyFunction(serialized._parameters, serialized._specification);\n    }\n    static serialize(input) {\n        return {\n            _parameters: input._parameters,\n            _specification: input._specification\n        };\n    }\n}\nfunction normalizePropertyExpression(value, specification) {\n    if (isFunction$1(value)) {\n        return new StylePropertyFunction(value, specification);\n    }\n    else if (isExpression(value)) {\n        const expression = createPropertyExpression(value, specification);\n        if (expression.result === 'error') {\n            // this should have been caught in validation\n            throw new Error(expression.value.map(err => `${err.key}: ${err.message}`).join(', '));\n        }\n        return expression.value;\n    }\n    else {\n        let constant = value;\n        if (specification.type === 'color' && typeof value === 'string') {\n            constant = Color.parse(value);\n        }\n        else if (specification.type === 'padding' && (typeof value === 'number' || Array.isArray(value))) {\n            constant = Padding.parse(value);\n        }\n        else if (specification.type === 'variableAnchorOffsetCollection' && Array.isArray(value)) {\n            constant = VariableAnchorOffsetCollection.parse(value);\n        }\n        else if (specification.type === 'projectionDefinition' && typeof value === 'string') {\n            constant = ProjectionDefinition.parse(value);\n        }\n        return {\n            kind: 'constant',\n            evaluate: () => constant\n        };\n    }\n}\n// Zoom-dependent expressions may only use [\"zoom\"] as the input to a top-level \"step\" or \"interpolate\"\n// expression (collectively referred to as a \"curve\"). The curve may be wrapped in one or more \"let\" or\n// \"coalesce\" expressions.\nfunction findZoomCurve(expression) {\n    let result = null;\n    if (expression instanceof Let) {\n        result = findZoomCurve(expression.result);\n    }\n    else if (expression instanceof Coalesce) {\n        for (const arg of expression.args) {\n            result = findZoomCurve(arg);\n            if (result) {\n                break;\n            }\n        }\n    }\n    else if ((expression instanceof Step || expression instanceof Interpolate) &&\n        expression.input instanceof CompoundExpression &&\n        expression.input.name === 'zoom') {\n        result = expression;\n    }\n    if (result instanceof ExpressionParsingError) {\n        return result;\n    }\n    expression.eachChild((child) => {\n        const childResult = findZoomCurve(child);\n        if (childResult instanceof ExpressionParsingError) {\n            result = childResult;\n        }\n        else if (!result && childResult) {\n            result = new ExpressionParsingError('', '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.');\n        }\n        else if (result && childResult && result !== childResult) {\n            result = new ExpressionParsingError('', 'Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression.');\n        }\n    });\n    return result;\n}\nfunction getExpectedType(spec) {\n    const types = {\n        color: ColorType,\n        string: StringType,\n        number: NumberType,\n        enum: StringType,\n        boolean: BooleanType,\n        formatted: FormattedType,\n        padding: PaddingType,\n        projectionDefinition: ProjectionDefinitionType,\n        resolvedImage: ResolvedImageType,\n        variableAnchorOffsetCollection: VariableAnchorOffsetCollectionType\n    };\n    if (spec.type === 'array') {\n        return array(types[spec.value] || ValueType, spec.length);\n    }\n    return types[spec.type];\n}\nfunction getDefaultValue(spec) {\n    if (spec.type === 'color' && isFunction$1(spec.default)) {\n        // Special case for heatmap-color: it uses the 'default:' to define a\n        // default color ramp, but createExpression expects a simple value to fall\n        // back to in case of runtime errors\n        return new Color(0, 0, 0, 0);\n    }\n    else if (spec.type === 'color') {\n        return Color.parse(spec.default) || null;\n    }\n    else if (spec.type === 'padding') {\n        return Padding.parse(spec.default) || null;\n    }\n    else if (spec.type === 'variableAnchorOffsetCollection') {\n        return VariableAnchorOffsetCollection.parse(spec.default) || null;\n    }\n    else if (spec.type === 'projectionDefinition') {\n        return ProjectionDefinition.parse(spec.default) || null;\n    }\n    else if (spec.default === undefined) {\n        return null;\n    }\n    else {\n        return spec.default;\n    }\n}\n\nfunction isExpressionFilter(filter) {\n    if (filter === true || filter === false) {\n        return true;\n    }\n    if (!Array.isArray(filter) || filter.length === 0) {\n        return false;\n    }\n    switch (filter[0]) {\n        case 'has':\n            return filter.length >= 2 && filter[1] !== '$id' && filter[1] !== '$type';\n        case 'in':\n            return filter.length >= 3 && (typeof filter[1] !== 'string' || Array.isArray(filter[2]));\n        case '!in':\n        case '!has':\n        case 'none':\n            return false;\n        case '==':\n        case '!=':\n        case '>':\n        case '>=':\n        case '<':\n        case '<=':\n            return filter.length !== 3 || (Array.isArray(filter[1]) || Array.isArray(filter[2]));\n        case 'any':\n        case 'all':\n            for (const f of filter.slice(1)) {\n                if (!isExpressionFilter(f) && typeof f !== 'boolean') {\n                    return false;\n                }\n            }\n            return true;\n        default:\n            return true;\n    }\n}\nconst filterSpec = {\n    'type': 'boolean',\n    'default': false,\n    'transition': false,\n    'property-type': 'data-driven',\n    'expression': {\n        'interpolated': false,\n        'parameters': ['zoom', 'feature']\n    }\n};\n/**\n * Given a filter expressed as nested arrays, return a new function\n * that evaluates whether a given feature (with a .properties or .tags property)\n * passes its test.\n *\n * @private\n * @param {Array} filter MapLibre filter\n * @returns {Function} filter-evaluating function\n */\nfunction featureFilter(filter) {\n    if (filter === null || filter === undefined) {\n        return { filter: () => true, needGeometry: false };\n    }\n    if (!isExpressionFilter(filter)) {\n        filter = convertFilter$1(filter);\n    }\n    const compiled = createExpression(filter, filterSpec);\n    if (compiled.result === 'error') {\n        throw new Error(compiled.value.map(err => `${err.key}: ${err.message}`).join(', '));\n    }\n    else {\n        const needGeometry = geometryNeeded(filter);\n        return { filter: (globalProperties, feature, canonical) => compiled.value.evaluate(globalProperties, feature, {}, canonical),\n            needGeometry };\n    }\n}\n// Comparison function to sort numbers and strings\nfunction compare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\nfunction geometryNeeded(filter) {\n    if (!Array.isArray(filter))\n        return false;\n    if (filter[0] === 'within' || filter[0] === 'distance')\n        return true;\n    for (let index = 1; index < filter.length; index++) {\n        if (geometryNeeded(filter[index]))\n            return true;\n    }\n    return false;\n}\nfunction convertFilter$1(filter) {\n    if (!filter)\n        return true;\n    const op = filter[0];\n    if (filter.length <= 1)\n        return (op !== 'any');\n    const converted = op === '==' ? convertComparisonOp$1(filter[1], filter[2], '==') :\n        op === '!=' ? convertNegation(convertComparisonOp$1(filter[1], filter[2], '==')) :\n            op === '<' ||\n                op === '>' ||\n                op === '<=' ||\n                op === '>=' ? convertComparisonOp$1(filter[1], filter[2], op) :\n                op === 'any' ? convertDisjunctionOp(filter.slice(1)) :\n                    op === 'all' ? ['all'].concat(filter.slice(1).map(convertFilter$1)) :\n                        op === 'none' ? ['all'].concat(filter.slice(1).map(convertFilter$1).map(convertNegation)) :\n                            op === 'in' ? convertInOp$1(filter[1], filter.slice(2)) :\n                                op === '!in' ? convertNegation(convertInOp$1(filter[1], filter.slice(2))) :\n                                    op === 'has' ? convertHasOp$1(filter[1]) :\n                                        op === '!has' ? convertNegation(convertHasOp$1(filter[1])) :\n                                            true;\n    return converted;\n}\nfunction convertComparisonOp$1(property, value, op) {\n    switch (property) {\n        case '$type':\n            return [`filter-type-${op}`, value];\n        case '$id':\n            return [`filter-id-${op}`, value];\n        default:\n            return [`filter-${op}`, property, value];\n    }\n}\nfunction convertDisjunctionOp(filters) {\n    return ['any'].concat(filters.map(convertFilter$1));\n}\nfunction convertInOp$1(property, values) {\n    if (values.length === 0) {\n        return false;\n    }\n    switch (property) {\n        case '$type':\n            return ['filter-type-in', ['literal', values]];\n        case '$id':\n            return ['filter-id-in', ['literal', values]];\n        default:\n            if (values.length > 200 && !values.some(v => typeof v !== typeof values[0])) {\n                return ['filter-in-large', property, ['literal', values.sort(compare)]];\n            }\n            else {\n                return ['filter-in-small', property, ['literal', values]];\n            }\n    }\n}\nfunction convertHasOp$1(property) {\n    switch (property) {\n        case '$type':\n            return true;\n        case '$id':\n            return ['filter-has-id'];\n        default:\n            return ['filter-has', property];\n    }\n}\nfunction convertNegation(filter) {\n    return ['!', filter];\n}\n\n/*\n * Convert the given filter to an expression, storing the expected types for\n * any feature properties referenced in expectedTypes.\n *\n * These expected types are needed in order to construct preflight type checks\n * needed for handling 'any' filters. A preflight type check is necessary in\n * order to mimic legacy filters' semantics around expected type mismatches.\n * For example, consider the legacy filter:\n *\n *     [\"any\", [\"all\", [\">\", \"y\", 0], [\">\", \"y\", 0]], [\">\", \"x\", 0]]\n *\n * Naively, we might convert this to the expression:\n *\n *     [\"any\", [\"all\", [\">\", [\"get\", \"y\"], 0], [\">\", [\"get\", \"z\"], 0]], [\">\", [\"get\", \"x\"], 0]]\n *\n * But if we tried to evaluate this against, say `{x: 1, y: null, z: 0}`, the\n * [\">\", [\"get\", \"y\"], 0] would cause an evaluation error, leading to the\n * entire filter returning false. Legacy filter semantics, though, ask for\n * [\">\", \"y\", 0] to simply return `false` when `y` is of the wrong type,\n * allowing the subsequent terms of the outer \"any\" expression to be evaluated\n * (resulting, in this case, in a `true` value, because x > 0).\n *\n * We account for this by inserting a preflight type-checking expression before\n * each \"any\" term, allowing us to avoid evaluating the actual converted filter\n * if any type mismatches would cause it to produce an evaluation error:\n *\n *     [\"any\",\n *       [\"case\",\n *         [\"all\", [\"==\", [\"typeof\", [\"get\", \"y\"]], \"number\"], [\"==\", [\"typeof\", [\"get\", \"z\"], \"number]],\n *         [\"all\", [\">\", [\"get\", \"y\"], 0], [\">\", [\"get\", \"z\"], 0]],\n *         false\n *       ],\n *       [\"case\",\n *         [\"==\", [\"typeof\", [\"get\", \"x\"], \"number\"]],\n *         [\">\", [\"get\", \"x\"], 0],\n *         false\n *       ]\n *     ]\n *\n * An alternative, possibly more direct approach would be to use type checks\n * in the conversion of each comparison operator, so that the converted version\n * of each individual ==, >=, etc. would mimic the legacy filter semantics. The\n * downside of this approach is that it can lead to many more type checks than\n * would otherwise be necessary: outside the context of an \"any\" expression,\n * bailing out due to a runtime type error (expression semantics) and returning\n * false (legacy filter semantics) are equivalent: they cause the filter to\n * produce a `false` result.\n */\nfunction convertFilter(filter, expectedTypes = {}) {\n    if (isExpressionFilter(filter))\n        return filter;\n    if (!filter)\n        return true;\n    const legacyFilter = filter;\n    const legacyOp = legacyFilter[0];\n    if (filter.length <= 1)\n        return (legacyOp !== 'any');\n    switch (legacyOp) {\n        case '==':\n        case '!=':\n        case '<':\n        case '>':\n        case '<=':\n        case '>=': {\n            const [, property, value] = filter;\n            return convertComparisonOp(property, value, legacyOp, expectedTypes);\n        }\n        case 'any': {\n            const [, ...conditions] = legacyFilter;\n            const children = conditions.map((f) => {\n                const types = {};\n                const child = convertFilter(f, types);\n                const typechecks = runtimeTypeChecks(types);\n                return typechecks === true ? child : ['case', typechecks, child, false];\n            });\n            return ['any', ...children];\n        }\n        case 'all': {\n            const [, ...conditions] = legacyFilter;\n            const children = conditions.map(f => convertFilter(f, expectedTypes));\n            return children.length > 1 ? ['all', ...children] : children[0];\n        }\n        case 'none': {\n            const [, ...conditions] = legacyFilter;\n            return ['!', convertFilter(['any', ...conditions], {})];\n        }\n        case 'in': {\n            const [, property, ...values] = legacyFilter;\n            return convertInOp(property, values);\n        }\n        case '!in': {\n            const [, property, ...values] = legacyFilter;\n            return convertInOp(property, values, true);\n        }\n        case 'has':\n            return convertHasOp(legacyFilter[1]);\n        case '!has':\n            return ['!', convertHasOp(legacyFilter[1])];\n        default:\n            return true;\n    }\n}\n// Given a set of feature properties and an expected type for each one,\n// construct an boolean expression that tests whether each property has the\n// right type.\n// E.g.: for {name: 'string', population: 'number'}, return\n// [ 'all',\n//   ['==', ['typeof', ['get', 'name'], 'string']],\n//   ['==', ['typeof', ['get', 'population'], 'number]]\n// ]\nfunction runtimeTypeChecks(expectedTypes) {\n    const conditions = [];\n    for (const property in expectedTypes) {\n        const get = property === '$id' ? ['id'] : ['get', property];\n        conditions.push(['==', ['typeof', get], expectedTypes[property]]);\n    }\n    if (conditions.length === 0)\n        return true;\n    if (conditions.length === 1)\n        return conditions[0];\n    return ['all', ...conditions];\n}\nfunction convertComparisonOp(property, value, op, expectedTypes) {\n    let get;\n    if (property === '$type') {\n        return [op, ['geometry-type'], value];\n    }\n    else if (property === '$id') {\n        get = ['id'];\n    }\n    else {\n        get = ['get', property];\n    }\n    if (expectedTypes && value !== null) {\n        const type = typeof value;\n        expectedTypes[property] = type;\n    }\n    if (op === '==' && property !== '$id' && value === null) {\n        return [\n            'all',\n            ['has', property], // missing property != null for legacy filters\n            ['==', get, null]\n        ];\n    }\n    else if (op === '!=' && property !== '$id' && value === null) {\n        return [\n            'any',\n            ['!', ['has', property]], // missing property != null for legacy filters\n            ['!=', get, null]\n        ];\n    }\n    return [op, get, value];\n}\nfunction convertInOp(property, values, negate = false) {\n    if (values.length === 0)\n        return negate;\n    let get;\n    if (property === '$type') {\n        get = ['geometry-type'];\n    }\n    else if (property === '$id') {\n        get = ['id'];\n    }\n    else {\n        get = ['get', property];\n    }\n    // Determine if the list of values to be searched is homogenously typed.\n    // If so (and if the type is string or number), then we can use a\n    // [match, input, [...values], true, false] construction rather than a\n    // bunch of `==` tests.\n    let uniformTypes = true;\n    const type = typeof values[0];\n    for (const value of values) {\n        if (typeof value !== type) {\n            uniformTypes = false;\n            break;\n        }\n    }\n    if (uniformTypes && (type === 'string' || type === 'number')) {\n        // Match expressions must have unique values.\n        const uniqueValues = values.sort().filter((v, i) => i === 0 || values[i - 1] !== v);\n        return ['match', get, uniqueValues, !negate, negate];\n    }\n    if (negate) {\n        return ['all', ...values.map(v => ['!=', get, v])];\n    }\n    else {\n        return ['any', ...values.map(v => ['==', get, v])];\n    }\n}\nfunction convertHasOp(property) {\n    if (property === '$type') {\n        return true;\n    }\n    else if (property === '$id') {\n        return ['!=', ['id'], null];\n    }\n    else {\n        return ['has', property];\n    }\n}\n\nfunction convertLiteral(value) {\n    return typeof value === 'object' ? ['literal', value] : value;\n}\nfunction convertFunction(parameters, propertySpec) {\n    let stops = parameters.stops;\n    if (!stops) {\n        // identity function\n        return convertIdentityFunction(parameters, propertySpec);\n    }\n    const zoomAndFeatureDependent = stops && typeof stops[0][0] === 'object';\n    const featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    const zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    stops = stops.map((stop) => {\n        if (!featureDependent && propertySpec.tokens && typeof stop[1] === 'string') {\n            return [stop[0], convertTokenString(stop[1])];\n        }\n        return [stop[0], convertLiteral(stop[1])];\n    });\n    if (zoomAndFeatureDependent) {\n        return convertZoomAndPropertyFunction(parameters, propertySpec, stops);\n    }\n    else if (zoomDependent) {\n        return convertZoomFunction(parameters, propertySpec, stops);\n    }\n    else {\n        return convertPropertyFunction(parameters, propertySpec, stops);\n    }\n}\nfunction convertIdentityFunction(parameters, propertySpec) {\n    const get = ['get', parameters.property];\n    if (parameters.default === undefined) {\n        // By default, expressions for string-valued properties get coerced. To preserve\n        // legacy function semantics, insert an explicit assertion instead.\n        return propertySpec.type === 'string' ? ['string', get] : get;\n    }\n    else if (propertySpec.type === 'enum') {\n        return [\n            'match',\n            get,\n            Object.keys(propertySpec.values),\n            get,\n            parameters.default\n        ];\n    }\n    else {\n        const expression = [propertySpec.type === 'color' ? 'to-color' : propertySpec.type, get, convertLiteral(parameters.default)];\n        if (propertySpec.type === 'array') {\n            expression.splice(1, 0, propertySpec.value, propertySpec.length || null);\n        }\n        return expression;\n    }\n}\nfunction getInterpolateOperator(parameters) {\n    switch (parameters.colorSpace) {\n        case 'hcl': return 'interpolate-hcl';\n        case 'lab': return 'interpolate-lab';\n        default: return 'interpolate';\n    }\n}\nfunction convertZoomAndPropertyFunction(parameters, propertySpec, stops) {\n    const featureFunctionParameters = {};\n    const featureFunctionStops = {};\n    const zoomStops = [];\n    for (let s = 0; s < stops.length; s++) {\n        const stop = stops[s];\n        const zoom = stop[0].zoom;\n        if (featureFunctionParameters[zoom] === undefined) {\n            featureFunctionParameters[zoom] = {\n                zoom,\n                type: parameters.type,\n                property: parameters.property,\n                default: parameters.default,\n            };\n            featureFunctionStops[zoom] = [];\n            zoomStops.push(zoom);\n        }\n        featureFunctionStops[zoom].push([stop[0].value, stop[1]]);\n    }\n    // the interpolation type for the zoom dimension of a zoom-and-property\n    // function is determined directly from the style property specification\n    // for which it's being used: linear for interpolatable properties, step\n    // otherwise.\n    const functionType = getFunctionType({}, propertySpec);\n    if (functionType === 'exponential') {\n        const expression = [getInterpolateOperator(parameters), ['linear'], ['zoom']];\n        for (const z of zoomStops) {\n            const output = convertPropertyFunction(featureFunctionParameters[z], propertySpec, featureFunctionStops[z]);\n            appendStopPair(expression, z, output, false);\n        }\n        return expression;\n    }\n    else {\n        const expression = ['step', ['zoom']];\n        for (const z of zoomStops) {\n            const output = convertPropertyFunction(featureFunctionParameters[z], propertySpec, featureFunctionStops[z]);\n            appendStopPair(expression, z, output, true);\n        }\n        fixupDegenerateStepCurve(expression);\n        return expression;\n    }\n}\nfunction coalesce(a, b) {\n    if (a !== undefined)\n        return a;\n    if (b !== undefined)\n        return b;\n}\nfunction getFallback(parameters, propertySpec) {\n    const defaultValue = convertLiteral(coalesce(parameters.default, propertySpec.default));\n    /*\n     * Some fields with type: resolvedImage have an undefined default.\n     * Because undefined is an invalid value for resolvedImage, set fallback to\n     * an empty string instead of undefined to ensure output\n     * passes validation.\n     */\n    if (defaultValue === undefined && propertySpec.type === 'resolvedImage') {\n        return '';\n    }\n    return defaultValue;\n}\nfunction convertPropertyFunction(parameters, propertySpec, stops) {\n    const type = getFunctionType(parameters, propertySpec);\n    const get = ['get', parameters.property];\n    if (type === 'categorical' && typeof stops[0][0] === 'boolean') {\n        const expression = ['case'];\n        for (const stop of stops) {\n            expression.push(['==', get, stop[0]], stop[1]);\n        }\n        expression.push(getFallback(parameters, propertySpec));\n        return expression;\n    }\n    else if (type === 'categorical') {\n        const expression = ['match', get];\n        for (const stop of stops) {\n            appendStopPair(expression, stop[0], stop[1], false);\n        }\n        expression.push(getFallback(parameters, propertySpec));\n        return expression;\n    }\n    else if (type === 'interval') {\n        const expression = ['step', ['number', get]];\n        for (const stop of stops) {\n            appendStopPair(expression, stop[0], stop[1], true);\n        }\n        fixupDegenerateStepCurve(expression);\n        return parameters.default === undefined ? expression : [\n            'case',\n            ['==', ['typeof', get], 'number'],\n            expression,\n            convertLiteral(parameters.default)\n        ];\n    }\n    else if (type === 'exponential') {\n        const base = parameters.base !== undefined ? parameters.base : 1;\n        const expression = [\n            getInterpolateOperator(parameters),\n            base === 1 ? ['linear'] : ['exponential', base],\n            ['number', get]\n        ];\n        for (const stop of stops) {\n            appendStopPair(expression, stop[0], stop[1], false);\n        }\n        return parameters.default === undefined ? expression : [\n            'case',\n            ['==', ['typeof', get], 'number'],\n            expression,\n            convertLiteral(parameters.default)\n        ];\n    }\n    else {\n        throw new Error(`Unknown property function type ${type}`);\n    }\n}\nfunction convertZoomFunction(parameters, propertySpec, stops, input = ['zoom']) {\n    const type = getFunctionType(parameters, propertySpec);\n    let expression;\n    let isStep = false;\n    if (type === 'interval') {\n        expression = ['step', input];\n        isStep = true;\n    }\n    else if (type === 'exponential') {\n        const base = parameters.base !== undefined ? parameters.base : 1;\n        expression = [getInterpolateOperator(parameters), base === 1 ? ['linear'] : ['exponential', base], input];\n    }\n    else {\n        throw new Error(`Unknown zoom function type \"${type}\"`);\n    }\n    for (const stop of stops) {\n        appendStopPair(expression, stop[0], stop[1], isStep);\n    }\n    fixupDegenerateStepCurve(expression);\n    return expression;\n}\nfunction fixupDegenerateStepCurve(expression) {\n    // degenerate step curve (i.e. a constant function): add a noop stop\n    if (expression[0] === 'step' && expression.length === 3) {\n        expression.push(0);\n        expression.push(expression[3]);\n    }\n}\nfunction appendStopPair(curve, input, output, isStep) {\n    // Skip duplicate stop values. They were not validated for functions, but they are for expressions.\n    // https://github.com/mapbox/mapbox-gl-js/issues/4107\n    if (curve.length > 3 && input === curve[curve.length - 2]) {\n        return;\n    }\n    // step curves don't get the first input value, as it is redundant.\n    if (!(isStep && curve.length === 2)) {\n        curve.push(input);\n    }\n    curve.push(output);\n}\nfunction getFunctionType(parameters, propertySpec) {\n    if (parameters.type) {\n        return parameters.type;\n    }\n    else {\n        return propertySpec.expression.interpolated ? 'exponential' : 'interval';\n    }\n}\n// \"String with {name} token\" => [\"concat\", \"String with \", [\"get\", \"name\"], \" token\"]\nfunction convertTokenString(s) {\n    const result = ['concat'];\n    const re = /{([^{}]+)}/g;\n    let pos = 0;\n    for (let match = re.exec(s); match !== null; match = re.exec(s)) {\n        const literal = s.slice(pos, re.lastIndex - match[0].length);\n        pos = re.lastIndex;\n        if (literal.length > 0)\n            result.push(literal);\n        result.push(['get', match[1]]);\n    }\n    if (result.length === 1) {\n        return s;\n    }\n    if (pos < s.length) {\n        result.push(s.slice(pos));\n    }\n    else if (result.length === 2) {\n        return ['to-string', result[1]];\n    }\n    return result;\n}\n\nfunction getPropertyReference(propertyName) {\n    for (let i = 0; i < v8Spec.layout.length; i++) {\n        for (const key in v8Spec[v8Spec.layout[i]]) {\n            if (key === propertyName)\n                return v8Spec[v8Spec.layout[i]][key];\n        }\n    }\n    for (let i = 0; i < v8Spec.paint.length; i++) {\n        for (const key in v8Spec[v8Spec.paint[i]]) {\n            if (key === propertyName)\n                return v8Spec[v8Spec.paint[i]][key];\n        }\n    }\n    return null;\n}\nfunction eachSource(style, callback) {\n    for (const k in style.sources) {\n        callback(style.sources[k]);\n    }\n}\nfunction eachLayer(style, callback) {\n    for (const layer of style.layers) {\n        callback(layer);\n    }\n}\nfunction eachProperty(style, options, callback) {\n    function inner(layer, propertyType) {\n        const properties = layer[propertyType];\n        if (!properties)\n            return;\n        Object.keys(properties).forEach((key) => {\n            callback({\n                path: [layer.id, propertyType, key],\n                key,\n                value: properties[key],\n                reference: getPropertyReference(key),\n                set(x) {\n                    properties[key] = x;\n                }\n            });\n        });\n    }\n    eachLayer(style, (layer) => {\n        if (options.paint) {\n            inner(layer, 'paint');\n        }\n        if (options.layout) {\n            inner(layer, 'layout');\n        }\n    });\n}\n\nfunction stringify$1(obj) {\n    const type = typeof obj;\n    if (type === 'number' || type === 'boolean' || type === 'string' || obj === undefined || obj === null)\n        return JSON.stringify(obj);\n    if (Array.isArray(obj)) {\n        let str = '[';\n        for (const val of obj) {\n            str += `${stringify$1(val)},`;\n        }\n        return `${str}]`;\n    }\n    const keys = Object.keys(obj).sort();\n    let str = '{';\n    for (let i = 0; i < keys.length; i++) {\n        str += `${JSON.stringify(keys[i])}:${stringify$1(obj[keys[i]])},`;\n    }\n    return `${str}}`;\n}\nfunction getKey(layer) {\n    let key = '';\n    for (const k of refProperties) {\n        key += `/${stringify$1(layer[k])}`;\n    }\n    return key;\n}\n/**\n * Given an array of layers, return an array of arrays of layers where all\n * layers in each group have identical layout-affecting properties. These\n * are the properties that were formerly used by explicit `ref` mechanism\n * for layers: 'type', 'source', 'source-layer', 'minzoom', 'maxzoom',\n * 'filter', and 'layout'.\n *\n * The input is not modified. The output layers are references to the\n * input layers.\n *\n * @private\n * @param {Array<Layer>} layers\n * @param {Object} [cachedKeys] - an object to keep already calculated keys.\n * @returns {Array<Array<Layer>>}\n */\nfunction groupByLayout(layers, cachedKeys) {\n    const groups = {};\n    for (let i = 0; i < layers.length; i++) {\n        const k = (cachedKeys && cachedKeys[layers[i].id]) || getKey(layers[i]);\n        // update the cache if there is one\n        if (cachedKeys)\n            cachedKeys[layers[i].id] = k;\n        let group = groups[k];\n        if (!group) {\n            group = groups[k] = [];\n        }\n        group.push(layers[i]);\n    }\n    const result = [];\n    for (const k in groups) {\n        result.push(groups[k]);\n    }\n    return result;\n}\n\nfunction emptyStyle() {\n    const style = {};\n    const version = v8Spec['$version'];\n    for (const styleKey in v8Spec['$root']) {\n        const specification = v8Spec['$root'][styleKey];\n        if (specification.required) {\n            let value = null;\n            if (styleKey === 'version') {\n                value = version;\n            }\n            else {\n                if (specification.type === 'array') {\n                    value = [];\n                }\n                else {\n                    value = {};\n                }\n            }\n            if (value != null) {\n                style[styleKey] = value;\n            }\n        }\n    }\n    return style;\n}\n\nfunction validateConstants(options) {\n    const key = options.key;\n    const constants = options.value;\n    if (constants) {\n        return [new ValidationError(key, constants, 'constants have been deprecated as of v8')];\n    }\n    else {\n        return [];\n    }\n}\n\n// Turn jsonlint-lines-primitives objects into primitive objects\nfunction unbundle(value) {\n    if (value instanceof Number || value instanceof String || value instanceof Boolean) {\n        return value.valueOf();\n    }\n    else {\n        return value;\n    }\n}\nfunction deepUnbundle(value) {\n    if (Array.isArray(value)) {\n        return value.map(deepUnbundle);\n    }\n    else if (value instanceof Object && !(value instanceof Number || value instanceof String || value instanceof Boolean)) {\n        const unbundledValue = {};\n        for (const key in value) {\n            unbundledValue[key] = deepUnbundle(value[key]);\n        }\n        return unbundledValue;\n    }\n    return unbundle(value);\n}\n\nfunction validateObject(options) {\n    const key = options.key;\n    const object = options.value;\n    const elementSpecs = options.valueSpec || {};\n    const elementValidators = options.objectElementValidators || {};\n    const style = options.style;\n    const styleSpec = options.styleSpec;\n    const validateSpec = options.validateSpec;\n    let errors = [];\n    const type = getType(object);\n    if (type !== 'object') {\n        return [new ValidationError(key, object, `object expected, ${type} found`)];\n    }\n    for (const objectKey in object) {\n        const elementSpecKey = objectKey.split('.')[0]; // treat 'paint.*' as 'paint'\n        const elementSpec = elementSpecs[elementSpecKey] || elementSpecs['*'];\n        let validateElement;\n        if (elementValidators[elementSpecKey]) {\n            validateElement = elementValidators[elementSpecKey];\n        }\n        else if (elementSpecs[elementSpecKey]) {\n            validateElement = validateSpec;\n        }\n        else if (elementValidators['*']) {\n            validateElement = elementValidators['*'];\n        }\n        else if (elementSpecs['*']) {\n            validateElement = validateSpec;\n        }\n        else {\n            errors.push(new ValidationError(key, object[objectKey], `unknown property \"${objectKey}\"`));\n            continue;\n        }\n        errors = errors.concat(validateElement({\n            key: (key ? `${key}.` : key) + objectKey,\n            value: object[objectKey],\n            valueSpec: elementSpec,\n            style,\n            styleSpec,\n            object,\n            objectKey,\n            validateSpec,\n        }, object));\n    }\n    for (const elementSpecKey in elementSpecs) {\n        // Don't check `required` when there's a custom validator for that property.\n        if (elementValidators[elementSpecKey]) {\n            continue;\n        }\n        if (elementSpecs[elementSpecKey].required && elementSpecs[elementSpecKey]['default'] === undefined && object[elementSpecKey] === undefined) {\n            errors.push(new ValidationError(key, object, `missing required property \"${elementSpecKey}\"`));\n        }\n    }\n    return errors;\n}\n\nfunction validateArray(options) {\n    const array = options.value;\n    const arraySpec = options.valueSpec;\n    const validateSpec = options.validateSpec;\n    const style = options.style;\n    const styleSpec = options.styleSpec;\n    const key = options.key;\n    const validateArrayElement = options.arrayElementValidator || validateSpec;\n    if (getType(array) !== 'array') {\n        return [new ValidationError(key, array, `array expected, ${getType(array)} found`)];\n    }\n    if (arraySpec.length && array.length !== arraySpec.length) {\n        return [new ValidationError(key, array, `array length ${arraySpec.length} expected, length ${array.length} found`)];\n    }\n    if (arraySpec['min-length'] && array.length < arraySpec['min-length']) {\n        return [new ValidationError(key, array, `array length at least ${arraySpec['min-length']} expected, length ${array.length} found`)];\n    }\n    let arrayElementSpec = {\n        'type': arraySpec.value,\n        'values': arraySpec.values\n    };\n    if (styleSpec.$version < 7) {\n        arrayElementSpec['function'] = arraySpec.function;\n    }\n    if (getType(arraySpec.value) === 'object') {\n        arrayElementSpec = arraySpec.value;\n    }\n    let errors = [];\n    for (let i = 0; i < array.length; i++) {\n        errors = errors.concat(validateArrayElement({\n            array,\n            arrayIndex: i,\n            value: array[i],\n            valueSpec: arrayElementSpec,\n            validateSpec: options.validateSpec,\n            style,\n            styleSpec,\n            key: `${key}[${i}]`\n        }));\n    }\n    return errors;\n}\n\nfunction validateNumber(options) {\n    const key = options.key;\n    const value = options.value;\n    const valueSpec = options.valueSpec;\n    let type = getType(value);\n    if (type === 'number' && value !== value) {\n        type = 'NaN';\n    }\n    if (type !== 'number') {\n        return [new ValidationError(key, value, `number expected, ${type} found`)];\n    }\n    if ('minimum' in valueSpec && value < valueSpec.minimum) {\n        return [new ValidationError(key, value, `${value} is less than the minimum value ${valueSpec.minimum}`)];\n    }\n    if ('maximum' in valueSpec && value > valueSpec.maximum) {\n        return [new ValidationError(key, value, `${value} is greater than the maximum value ${valueSpec.maximum}`)];\n    }\n    return [];\n}\n\nfunction validateFunction(options) {\n    const functionValueSpec = options.valueSpec;\n    const functionType = unbundle(options.value.type);\n    let stopKeyType;\n    let stopDomainValues = {};\n    let previousStopDomainValue;\n    let previousStopDomainZoom;\n    const isZoomFunction = functionType !== 'categorical' && options.value.property === undefined;\n    const isPropertyFunction = !isZoomFunction;\n    const isZoomAndPropertyFunction = getType(options.value.stops) === 'array' &&\n        getType(options.value.stops[0]) === 'array' &&\n        getType(options.value.stops[0][0]) === 'object';\n    const errors = validateObject({\n        key: options.key,\n        value: options.value,\n        valueSpec: options.styleSpec.function,\n        validateSpec: options.validateSpec,\n        style: options.style,\n        styleSpec: options.styleSpec,\n        objectElementValidators: {\n            stops: validateFunctionStops,\n            default: validateFunctionDefault\n        }\n    });\n    if (functionType === 'identity' && isZoomFunction) {\n        errors.push(new ValidationError(options.key, options.value, 'missing required property \"property\"'));\n    }\n    if (functionType !== 'identity' && !options.value.stops) {\n        errors.push(new ValidationError(options.key, options.value, 'missing required property \"stops\"'));\n    }\n    if (functionType === 'exponential' && options.valueSpec.expression && !supportsInterpolation(options.valueSpec)) {\n        errors.push(new ValidationError(options.key, options.value, 'exponential functions not supported'));\n    }\n    if (options.styleSpec.$version >= 8) {\n        if (isPropertyFunction && !supportsPropertyExpression(options.valueSpec)) {\n            errors.push(new ValidationError(options.key, options.value, 'property functions not supported'));\n        }\n        else if (isZoomFunction && !supportsZoomExpression(options.valueSpec)) {\n            errors.push(new ValidationError(options.key, options.value, 'zoom functions not supported'));\n        }\n    }\n    if ((functionType === 'categorical' || isZoomAndPropertyFunction) && options.value.property === undefined) {\n        errors.push(new ValidationError(options.key, options.value, '\"property\" property is required'));\n    }\n    return errors;\n    function validateFunctionStops(options) {\n        if (functionType === 'identity') {\n            return [new ValidationError(options.key, options.value, 'identity function may not have a \"stops\" property')];\n        }\n        let errors = [];\n        const value = options.value;\n        errors = errors.concat(validateArray({\n            key: options.key,\n            value,\n            valueSpec: options.valueSpec,\n            validateSpec: options.validateSpec,\n            style: options.style,\n            styleSpec: options.styleSpec,\n            arrayElementValidator: validateFunctionStop\n        }));\n        if (getType(value) === 'array' && value.length === 0) {\n            errors.push(new ValidationError(options.key, value, 'array must have at least one stop'));\n        }\n        return errors;\n    }\n    function validateFunctionStop(options) {\n        let errors = [];\n        const value = options.value;\n        const key = options.key;\n        if (getType(value) !== 'array') {\n            return [new ValidationError(key, value, `array expected, ${getType(value)} found`)];\n        }\n        if (value.length !== 2) {\n            return [new ValidationError(key, value, `array length 2 expected, length ${value.length} found`)];\n        }\n        if (isZoomAndPropertyFunction) {\n            if (getType(value[0]) !== 'object') {\n                return [new ValidationError(key, value, `object expected, ${getType(value[0])} found`)];\n            }\n            if (value[0].zoom === undefined) {\n                return [new ValidationError(key, value, 'object stop key must have zoom')];\n            }\n            if (value[0].value === undefined) {\n                return [new ValidationError(key, value, 'object stop key must have value')];\n            }\n            if (previousStopDomainZoom && previousStopDomainZoom > unbundle(value[0].zoom)) {\n                return [new ValidationError(key, value[0].zoom, 'stop zoom values must appear in ascending order')];\n            }\n            if (unbundle(value[0].zoom) !== previousStopDomainZoom) {\n                previousStopDomainZoom = unbundle(value[0].zoom);\n                previousStopDomainValue = undefined;\n                stopDomainValues = {};\n            }\n            errors = errors.concat(validateObject({\n                key: `${key}[0]`,\n                value: value[0],\n                valueSpec: { zoom: {} },\n                validateSpec: options.validateSpec,\n                style: options.style,\n                styleSpec: options.styleSpec,\n                objectElementValidators: { zoom: validateNumber, value: validateStopDomainValue }\n            }));\n        }\n        else {\n            errors = errors.concat(validateStopDomainValue({\n                key: `${key}[0]`,\n                value: value[0],\n                valueSpec: {},\n                validateSpec: options.validateSpec,\n                style: options.style,\n                styleSpec: options.styleSpec\n            }, value));\n        }\n        if (isExpression(deepUnbundle(value[1]))) {\n            return errors.concat([new ValidationError(`${key}[1]`, value[1], 'expressions are not allowed in function stops.')]);\n        }\n        return errors.concat(options.validateSpec({\n            key: `${key}[1]`,\n            value: value[1],\n            valueSpec: functionValueSpec,\n            validateSpec: options.validateSpec,\n            style: options.style,\n            styleSpec: options.styleSpec\n        }));\n    }\n    function validateStopDomainValue(options, stop) {\n        const type = getType(options.value);\n        const value = unbundle(options.value);\n        const reportValue = options.value !== null ? options.value : stop;\n        if (!stopKeyType) {\n            stopKeyType = type;\n        }\n        else if (type !== stopKeyType) {\n            return [new ValidationError(options.key, reportValue, `${type} stop domain type must match previous stop domain type ${stopKeyType}`)];\n        }\n        if (type !== 'number' && type !== 'string' && type !== 'boolean') {\n            return [new ValidationError(options.key, reportValue, 'stop domain value must be a number, string, or boolean')];\n        }\n        if (type !== 'number' && functionType !== 'categorical') {\n            let message = `number expected, ${type} found`;\n            if (supportsPropertyExpression(functionValueSpec) && functionType === undefined) {\n                message += '\\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`.';\n            }\n            return [new ValidationError(options.key, reportValue, message)];\n        }\n        if (functionType === 'categorical' && type === 'number' && (!isFinite(value) || Math.floor(value) !== value)) {\n            return [new ValidationError(options.key, reportValue, `integer expected, found ${value}`)];\n        }\n        if (functionType !== 'categorical' && type === 'number' && previousStopDomainValue !== undefined && value < previousStopDomainValue) {\n            return [new ValidationError(options.key, reportValue, 'stop domain values must appear in ascending order')];\n        }\n        else {\n            previousStopDomainValue = value;\n        }\n        if (functionType === 'categorical' && value in stopDomainValues) {\n            return [new ValidationError(options.key, reportValue, 'stop domain values must be unique')];\n        }\n        else {\n            stopDomainValues[value] = true;\n        }\n        return [];\n    }\n    function validateFunctionDefault(options) {\n        return options.validateSpec({\n            key: options.key,\n            value: options.value,\n            valueSpec: functionValueSpec,\n            validateSpec: options.validateSpec,\n            style: options.style,\n            styleSpec: options.styleSpec\n        });\n    }\n}\n\nfunction validateExpression(options) {\n    const expression = (options.expressionContext === 'property' ? createPropertyExpression : createExpression)(deepUnbundle(options.value), options.valueSpec);\n    if (expression.result === 'error') {\n        return expression.value.map((error) => {\n            return new ValidationError(`${options.key}${error.key}`, options.value, error.message);\n        });\n    }\n    const expressionObj = expression.value.expression || expression.value._styleExpression.expression;\n    if (options.expressionContext === 'property' && (options.propertyKey === 'text-font') &&\n        !expressionObj.outputDefined()) {\n        return [new ValidationError(options.key, options.value, `Invalid data expression for \"${options.propertyKey}\". Output values must be contained as literals within the expression.`)];\n    }\n    if (options.expressionContext === 'property' && options.propertyType === 'layout' &&\n        (!isStateConstant(expressionObj))) {\n        return [new ValidationError(options.key, options.value, '\"feature-state\" data expressions are not supported with layout properties.')];\n    }\n    if (options.expressionContext === 'filter' && !isStateConstant(expressionObj)) {\n        return [new ValidationError(options.key, options.value, '\"feature-state\" data expressions are not supported with filters.')];\n    }\n    if (options.expressionContext && options.expressionContext.indexOf('cluster') === 0) {\n        if (!isGlobalPropertyConstant(expressionObj, ['zoom', 'feature-state'])) {\n            return [new ValidationError(options.key, options.value, '\"zoom\" and \"feature-state\" expressions are not supported with cluster properties.')];\n        }\n        if (options.expressionContext === 'cluster-initial' && !isFeatureConstant(expressionObj)) {\n            return [new ValidationError(options.key, options.value, 'Feature data expressions are not supported with initial expression part of cluster properties.')];\n        }\n    }\n    return [];\n}\n\nfunction validateBoolean(options) {\n    const value = options.value;\n    const key = options.key;\n    const type = getType(value);\n    if (type !== 'boolean') {\n        return [new ValidationError(key, value, `boolean expected, ${type} found`)];\n    }\n    return [];\n}\n\nfunction validateColor(options) {\n    const key = options.key;\n    const value = options.value;\n    const type = getType(value);\n    if (type !== 'string') {\n        return [new ValidationError(key, value, `color expected, ${type} found`)];\n    }\n    if (!Color.parse(String(value))) { // cast String object to string primitive\n        return [new ValidationError(key, value, `color expected, \"${value}\" found`)];\n    }\n    return [];\n}\n\nfunction validateEnum(options) {\n    const key = options.key;\n    const value = options.value;\n    const valueSpec = options.valueSpec;\n    const errors = [];\n    if (Array.isArray(valueSpec.values)) { // <=v7\n        if (valueSpec.values.indexOf(unbundle(value)) === -1) {\n            errors.push(new ValidationError(key, value, `expected one of [${valueSpec.values.join(', ')}], ${JSON.stringify(value)} found`));\n        }\n    }\n    else { // >=v8\n        if (Object.keys(valueSpec.values).indexOf(unbundle(value)) === -1) {\n            errors.push(new ValidationError(key, value, `expected one of [${Object.keys(valueSpec.values).join(', ')}], ${JSON.stringify(value)} found`));\n        }\n    }\n    return errors;\n}\n\nfunction validateFilter(options) {\n    if (isExpressionFilter(deepUnbundle(options.value))) {\n        return validateExpression(extendBy({}, options, {\n            expressionContext: 'filter',\n            valueSpec: { value: 'boolean' }\n        }));\n    }\n    else {\n        return validateNonExpressionFilter(options);\n    }\n}\nfunction validateNonExpressionFilter(options) {\n    const value = options.value;\n    const key = options.key;\n    if (getType(value) !== 'array') {\n        return [new ValidationError(key, value, `array expected, ${getType(value)} found`)];\n    }\n    const styleSpec = options.styleSpec;\n    let type;\n    let errors = [];\n    if (value.length < 1) {\n        return [new ValidationError(key, value, 'filter array must have at least 1 element')];\n    }\n    errors = errors.concat(validateEnum({\n        key: `${key}[0]`,\n        value: value[0],\n        valueSpec: styleSpec.filter_operator,\n        style: options.style,\n        styleSpec: options.styleSpec\n    }));\n    switch (unbundle(value[0])) {\n        case '<':\n        case '<=':\n        case '>':\n        case '>=':\n            if (value.length >= 2 && unbundle(value[1]) === '$type') {\n                errors.push(new ValidationError(key, value, `\"$type\" cannot be use with operator \"${value[0]}\"`));\n            }\n        /* falls through */\n        case '==':\n        case '!=':\n            if (value.length !== 3) {\n                errors.push(new ValidationError(key, value, `filter array for operator \"${value[0]}\" must have 3 elements`));\n            }\n        /* falls through */\n        case 'in':\n        case '!in':\n            if (value.length >= 2) {\n                type = getType(value[1]);\n                if (type !== 'string') {\n                    errors.push(new ValidationError(`${key}[1]`, value[1], `string expected, ${type} found`));\n                }\n            }\n            for (let i = 2; i < value.length; i++) {\n                type = getType(value[i]);\n                if (unbundle(value[1]) === '$type') {\n                    errors = errors.concat(validateEnum({\n                        key: `${key}[${i}]`,\n                        value: value[i],\n                        valueSpec: styleSpec.geometry_type,\n                        style: options.style,\n                        styleSpec: options.styleSpec\n                    }));\n                }\n                else if (type !== 'string' && type !== 'number' && type !== 'boolean') {\n                    errors.push(new ValidationError(`${key}[${i}]`, value[i], `string, number, or boolean expected, ${type} found`));\n                }\n            }\n            break;\n        case 'any':\n        case 'all':\n        case 'none':\n            for (let i = 1; i < value.length; i++) {\n                errors = errors.concat(validateNonExpressionFilter({\n                    key: `${key}[${i}]`,\n                    value: value[i],\n                    style: options.style,\n                    styleSpec: options.styleSpec\n                }));\n            }\n            break;\n        case 'has':\n        case '!has':\n            type = getType(value[1]);\n            if (value.length !== 2) {\n                errors.push(new ValidationError(key, value, `filter array for \"${value[0]}\" operator must have 2 elements`));\n            }\n            else if (type !== 'string') {\n                errors.push(new ValidationError(`${key}[1]`, value[1], `string expected, ${type} found`));\n            }\n            break;\n    }\n    return errors;\n}\n\nfunction validateProperty(options, propertyType) {\n    const key = options.key;\n    const validateSpec = options.validateSpec;\n    const style = options.style;\n    const styleSpec = options.styleSpec;\n    const value = options.value;\n    const propertyKey = options.objectKey;\n    const layerSpec = styleSpec[`${propertyType}_${options.layerType}`];\n    if (!layerSpec)\n        return [];\n    const transitionMatch = propertyKey.match(/^(.*)-transition$/);\n    if (propertyType === 'paint' && transitionMatch && layerSpec[transitionMatch[1]] && layerSpec[transitionMatch[1]].transition) {\n        return validateSpec({\n            key,\n            value,\n            valueSpec: styleSpec.transition,\n            style,\n            styleSpec\n        });\n    }\n    const valueSpec = options.valueSpec || layerSpec[propertyKey];\n    if (!valueSpec) {\n        return [new ValidationError(key, value, `unknown property \"${propertyKey}\"`)];\n    }\n    let tokenMatch;\n    if (getType(value) === 'string' && supportsPropertyExpression(valueSpec) && !valueSpec.tokens && (tokenMatch = /^{([^}]+)}$/.exec(value))) {\n        return [new ValidationError(key, value, `\"${propertyKey}\" does not support interpolation syntax\\n` +\n                `Use an identity property function instead: \\`{ \"type\": \"identity\", \"property\": ${JSON.stringify(tokenMatch[1])} }\\`.`)];\n    }\n    const errors = [];\n    if (options.layerType === 'symbol') {\n        if (propertyKey === 'text-field' && style && !style.glyphs) {\n            errors.push(new ValidationError(key, value, 'use of \"text-field\" requires a style \"glyphs\" property'));\n        }\n        if (propertyKey === 'text-font' && isFunction$1(deepUnbundle(value)) && unbundle(value.type) === 'identity') {\n            errors.push(new ValidationError(key, value, '\"text-font\" does not support identity functions'));\n        }\n    }\n    return errors.concat(validateSpec({\n        key: options.key,\n        value,\n        valueSpec,\n        style,\n        styleSpec,\n        expressionContext: 'property',\n        propertyType,\n        propertyKey\n    }));\n}\n\nfunction validatePaintProperty(options) {\n    return validateProperty(options, 'paint');\n}\n\nfunction validateLayoutProperty(options) {\n    return validateProperty(options, 'layout');\n}\n\nfunction validateLayer(options) {\n    let errors = [];\n    const layer = options.value;\n    const key = options.key;\n    const style = options.style;\n    const styleSpec = options.styleSpec;\n    if (!layer.type && !layer.ref) {\n        errors.push(new ValidationError(key, layer, 'either \"type\" or \"ref\" is required'));\n    }\n    let type = unbundle(layer.type);\n    const ref = unbundle(layer.ref);\n    if (layer.id) {\n        const layerId = unbundle(layer.id);\n        for (let i = 0; i < options.arrayIndex; i++) {\n            const otherLayer = style.layers[i];\n            if (unbundle(otherLayer.id) === layerId) {\n                errors.push(new ValidationError(key, layer.id, `duplicate layer id \"${layer.id}\", previously used at line ${otherLayer.id.__line__}`));\n            }\n        }\n    }\n    if ('ref' in layer) {\n        ['type', 'source', 'source-layer', 'filter', 'layout'].forEach((p) => {\n            if (p in layer) {\n                errors.push(new ValidationError(key, layer[p], `\"${p}\" is prohibited for ref layers`));\n            }\n        });\n        let parent;\n        style.layers.forEach((layer) => {\n            if (unbundle(layer.id) === ref)\n                parent = layer;\n        });\n        if (!parent) {\n            errors.push(new ValidationError(key, layer.ref, `ref layer \"${ref}\" not found`));\n        }\n        else if (parent.ref) {\n            errors.push(new ValidationError(key, layer.ref, 'ref cannot reference another ref layer'));\n        }\n        else {\n            type = unbundle(parent.type);\n        }\n    }\n    else if (type !== 'background') {\n        if (!layer.source) {\n            errors.push(new ValidationError(key, layer, 'missing required property \"source\"'));\n        }\n        else {\n            const source = style.sources && style.sources[layer.source];\n            const sourceType = source && unbundle(source.type);\n            if (!source) {\n                errors.push(new ValidationError(key, layer.source, `source \"${layer.source}\" not found`));\n            }\n            else if (sourceType === 'vector' && type === 'raster') {\n                errors.push(new ValidationError(key, layer.source, `layer \"${layer.id}\" requires a raster source`));\n            }\n            else if (sourceType !== 'raster-dem' && type === 'hillshade') {\n                errors.push(new ValidationError(key, layer.source, `layer \"${layer.id}\" requires a raster-dem source`));\n            }\n            else if (sourceType === 'raster' && type !== 'raster') {\n                errors.push(new ValidationError(key, layer.source, `layer \"${layer.id}\" requires a vector source`));\n            }\n            else if (sourceType === 'vector' && !layer['source-layer']) {\n                errors.push(new ValidationError(key, layer, `layer \"${layer.id}\" must specify a \"source-layer\"`));\n            }\n            else if (sourceType === 'raster-dem' && type !== 'hillshade') {\n                errors.push(new ValidationError(key, layer.source, 'raster-dem source can only be used with layer type \\'hillshade\\'.'));\n            }\n            else if (type === 'line' && layer.paint && layer.paint['line-gradient'] &&\n                (sourceType !== 'geojson' || !source.lineMetrics)) {\n                errors.push(new ValidationError(key, layer, `layer \"${layer.id}\" specifies a line-gradient, which requires a GeoJSON source with \\`lineMetrics\\` enabled.`));\n            }\n        }\n    }\n    errors = errors.concat(validateObject({\n        key,\n        value: layer,\n        valueSpec: styleSpec.layer,\n        style: options.style,\n        styleSpec: options.styleSpec,\n        validateSpec: options.validateSpec,\n        objectElementValidators: {\n            '*'() {\n                return [];\n            },\n            // We don't want to enforce the spec's `\"requires\": true` for backward compatibility with refs;\n            // the actual requirement is validated above. See https://github.com/mapbox/mapbox-gl-js/issues/5772.\n            type() {\n                return options.validateSpec({\n                    key: `${key}.type`,\n                    value: layer.type,\n                    valueSpec: styleSpec.layer.type,\n                    style: options.style,\n                    styleSpec: options.styleSpec,\n                    validateSpec: options.validateSpec,\n                    object: layer,\n                    objectKey: 'type'\n                });\n            },\n            filter: validateFilter,\n            layout(options) {\n                return validateObject({\n                    layer,\n                    key: options.key,\n                    value: options.value,\n                    style: options.style,\n                    styleSpec: options.styleSpec,\n                    validateSpec: options.validateSpec,\n                    objectElementValidators: {\n                        '*'(options) {\n                            return validateLayoutProperty(extendBy({ layerType: type }, options));\n                        }\n                    }\n                });\n            },\n            paint(options) {\n                return validateObject({\n                    layer,\n                    key: options.key,\n                    value: options.value,\n                    style: options.style,\n                    styleSpec: options.styleSpec,\n                    validateSpec: options.validateSpec,\n                    objectElementValidators: {\n                        '*'(options) {\n                            return validatePaintProperty(extendBy({ layerType: type }, options));\n                        }\n                    }\n                });\n            }\n        }\n    }));\n    return errors;\n}\n\nfunction validateString(options) {\n    const value = options.value;\n    const key = options.key;\n    const type = getType(value);\n    if (type !== 'string') {\n        return [new ValidationError(key, value, `string expected, ${type} found`)];\n    }\n    return [];\n}\n\nfunction validateRasterDEMSource(options) {\n    var _a;\n    const sourceName = (_a = options.sourceName) !== null && _a !== undefined ? _a : '';\n    const rasterDEM = options.value;\n    const styleSpec = options.styleSpec;\n    const rasterDEMSpec = styleSpec.source_raster_dem;\n    const style = options.style;\n    let errors = [];\n    const rootType = getType(rasterDEM);\n    if (rasterDEM === undefined) {\n        return errors;\n    }\n    else if (rootType !== 'object') {\n        errors.push(new ValidationError('source_raster_dem', rasterDEM, `object expected, ${rootType} found`));\n        return errors;\n    }\n    const encoding = unbundle(rasterDEM.encoding);\n    const isCustomEncoding = encoding === 'custom';\n    const customEncodingKeys = ['redFactor', 'greenFactor', 'blueFactor', 'baseShift'];\n    const encodingName = options.value.encoding ? `\"${options.value.encoding}\"` : 'Default';\n    for (const key in rasterDEM) {\n        if (!isCustomEncoding && customEncodingKeys.includes(key)) {\n            errors.push(new ValidationError(key, rasterDEM[key], `In \"${sourceName}\": \"${key}\" is only valid when \"encoding\" is set to \"custom\". ${encodingName} encoding found`));\n        }\n        else if (rasterDEMSpec[key]) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: rasterDEM[key],\n                valueSpec: rasterDEMSpec[key],\n                validateSpec: options.validateSpec,\n                style,\n                styleSpec\n            }));\n        }\n        else {\n            errors.push(new ValidationError(key, rasterDEM[key], `unknown property \"${key}\"`));\n        }\n    }\n    return errors;\n}\n\nconst objectElementValidators = {\n    promoteId: validatePromoteId\n};\nfunction validateSource(options) {\n    const value = options.value;\n    const key = options.key;\n    const styleSpec = options.styleSpec;\n    const style = options.style;\n    const validateSpec = options.validateSpec;\n    if (!value.type) {\n        return [new ValidationError(key, value, '\"type\" is required')];\n    }\n    const type = unbundle(value.type);\n    let errors;\n    switch (type) {\n        case 'vector':\n        case 'raster':\n            errors = validateObject({\n                key,\n                value,\n                valueSpec: styleSpec[`source_${type.replace('-', '_')}`],\n                style: options.style,\n                styleSpec,\n                objectElementValidators,\n                validateSpec,\n            });\n            return errors;\n        case 'raster-dem':\n            errors = validateRasterDEMSource({\n                sourceName: key,\n                value,\n                style: options.style,\n                styleSpec,\n                validateSpec,\n            });\n            return errors;\n        case 'geojson':\n            errors = validateObject({\n                key,\n                value,\n                valueSpec: styleSpec.source_geojson,\n                style,\n                styleSpec,\n                validateSpec,\n                objectElementValidators\n            });\n            if (value.cluster) {\n                for (const prop in value.clusterProperties) {\n                    const [operator, mapExpr] = value.clusterProperties[prop];\n                    const reduceExpr = typeof operator === 'string' ? [operator, ['accumulated'], ['get', prop]] : operator;\n                    errors.push(...validateExpression({\n                        key: `${key}.${prop}.map`,\n                        value: mapExpr,\n                        validateSpec,\n                        expressionContext: 'cluster-map'\n                    }));\n                    errors.push(...validateExpression({\n                        key: `${key}.${prop}.reduce`,\n                        value: reduceExpr,\n                        validateSpec,\n                        expressionContext: 'cluster-reduce'\n                    }));\n                }\n            }\n            return errors;\n        case 'video':\n            return validateObject({\n                key,\n                value,\n                valueSpec: styleSpec.source_video,\n                style,\n                validateSpec,\n                styleSpec\n            });\n        case 'image':\n            return validateObject({\n                key,\n                value,\n                valueSpec: styleSpec.source_image,\n                style,\n                validateSpec,\n                styleSpec\n            });\n        case 'canvas':\n            return [new ValidationError(key, null, 'Please use runtime APIs to add canvas sources, rather than including them in stylesheets.', 'source.canvas')];\n        default:\n            return validateEnum({\n                key: `${key}.type`,\n                value: value.type,\n                valueSpec: { values: ['vector', 'raster', 'raster-dem', 'geojson', 'video', 'image'] },\n                style,\n                validateSpec,\n                styleSpec\n            });\n    }\n}\nfunction validatePromoteId({ key, value }) {\n    if (getType(value) === 'string') {\n        return validateString({ key, value });\n    }\n    else {\n        const errors = [];\n        for (const prop in value) {\n            errors.push(...validateString({ key: `${key}.${prop}`, value: value[prop] }));\n        }\n        return errors;\n    }\n}\n\nfunction validateLight(options) {\n    const light = options.value;\n    const styleSpec = options.styleSpec;\n    const lightSpec = styleSpec.light;\n    const style = options.style;\n    let errors = [];\n    const rootType = getType(light);\n    if (light === undefined) {\n        return errors;\n    }\n    else if (rootType !== 'object') {\n        errors = errors.concat([new ValidationError('light', light, `object expected, ${rootType} found`)]);\n        return errors;\n    }\n    for (const key in light) {\n        const transitionMatch = key.match(/^(.*)-transition$/);\n        if (transitionMatch && lightSpec[transitionMatch[1]] && lightSpec[transitionMatch[1]].transition) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: light[key],\n                valueSpec: styleSpec.transition,\n                validateSpec: options.validateSpec,\n                style,\n                styleSpec\n            }));\n        }\n        else if (lightSpec[key]) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: light[key],\n                valueSpec: lightSpec[key],\n                validateSpec: options.validateSpec,\n                style,\n                styleSpec\n            }));\n        }\n        else {\n            errors = errors.concat([new ValidationError(key, light[key], `unknown property \"${key}\"`)]);\n        }\n    }\n    return errors;\n}\n\nfunction validateSky(options) {\n    const sky = options.value;\n    const styleSpec = options.styleSpec;\n    const skySpec = styleSpec.sky;\n    const style = options.style;\n    const rootType = getType(sky);\n    if (sky === undefined) {\n        return [];\n    }\n    else if (rootType !== 'object') {\n        return [new ValidationError('sky', sky, `object expected, ${rootType} found`)];\n    }\n    let errors = [];\n    for (const key in sky) {\n        if (skySpec[key]) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: sky[key],\n                valueSpec: skySpec[key],\n                style,\n                styleSpec\n            }));\n        }\n        else {\n            errors = errors.concat([new ValidationError(key, sky[key], `unknown property \"${key}\"`)]);\n        }\n    }\n    return errors;\n}\n\nfunction validateTerrain(options) {\n    const terrain = options.value;\n    const styleSpec = options.styleSpec;\n    const terrainSpec = styleSpec.terrain;\n    const style = options.style;\n    let errors = [];\n    const rootType = getType(terrain);\n    if (terrain === undefined) {\n        return errors;\n    }\n    else if (rootType !== 'object') {\n        errors = errors.concat([new ValidationError('terrain', terrain, `object expected, ${rootType} found`)]);\n        return errors;\n    }\n    for (const key in terrain) {\n        if (terrainSpec[key]) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: terrain[key],\n                valueSpec: terrainSpec[key],\n                validateSpec: options.validateSpec,\n                style,\n                styleSpec\n            }));\n        }\n        else {\n            errors = errors.concat([new ValidationError(key, terrain[key], `unknown property \"${key}\"`)]);\n        }\n    }\n    return errors;\n}\n\nfunction validateFormatted(options) {\n    if (validateString(options).length === 0) {\n        return [];\n    }\n    return validateExpression(options);\n}\n\nfunction validateImage(options) {\n    if (validateString(options).length === 0) {\n        return [];\n    }\n    return validateExpression(options);\n}\n\nfunction validatePadding(options) {\n    const key = options.key;\n    const value = options.value;\n    const type = getType(value);\n    if (type === 'array') {\n        if (value.length < 1 || value.length > 4) {\n            return [new ValidationError(key, value, `padding requires 1 to 4 values; ${value.length} values found`)];\n        }\n        const arrayElementSpec = {\n            type: 'number'\n        };\n        let errors = [];\n        for (let i = 0; i < value.length; i++) {\n            errors = errors.concat(options.validateSpec({\n                key: `${key}[${i}]`,\n                value: value[i],\n                validateSpec: options.validateSpec,\n                valueSpec: arrayElementSpec\n            }));\n        }\n        return errors;\n    }\n    else {\n        return validateNumber({\n            key,\n            value,\n            valueSpec: {}\n        });\n    }\n}\n\nfunction validateVariableAnchorOffsetCollection(options) {\n    const key = options.key;\n    const value = options.value;\n    const type = getType(value);\n    const styleSpec = options.styleSpec;\n    if (type !== 'array' || value.length < 1 || value.length % 2 !== 0) {\n        return [new ValidationError(key, value, 'variableAnchorOffsetCollection requires a non-empty array of even length')];\n    }\n    let errors = [];\n    for (let i = 0; i < value.length; i += 2) {\n        // Elements in even positions should be values from text-anchor enum\n        errors = errors.concat(validateEnum({\n            key: `${key}[${i}]`,\n            value: value[i],\n            valueSpec: styleSpec['layout_symbol']['text-anchor']\n        }));\n        // Elements in odd positions should be points (2-element numeric arrays)\n        errors = errors.concat(validateArray({\n            key: `${key}[${i + 1}]`,\n            value: value[i + 1],\n            valueSpec: {\n                length: 2,\n                value: 'number'\n            },\n            validateSpec: options.validateSpec,\n            style: options.style,\n            styleSpec\n        }));\n    }\n    return errors;\n}\n\nfunction validateSprite(options) {\n    let errors = [];\n    const sprite = options.value;\n    const key = options.key;\n    if (!Array.isArray(sprite)) {\n        return validateString({\n            key,\n            value: sprite\n        });\n    }\n    else {\n        const allSpriteIds = [];\n        const allSpriteURLs = [];\n        for (const i in sprite) {\n            if (sprite[i].id && allSpriteIds.includes(sprite[i].id))\n                errors.push(new ValidationError(key, sprite, `all the sprites' ids must be unique, but ${sprite[i].id} is duplicated`));\n            allSpriteIds.push(sprite[i].id);\n            if (sprite[i].url && allSpriteURLs.includes(sprite[i].url))\n                errors.push(new ValidationError(key, sprite, `all the sprites' URLs must be unique, but ${sprite[i].url} is duplicated`));\n            allSpriteURLs.push(sprite[i].url);\n            const pairSpec = {\n                id: {\n                    type: 'string',\n                    required: true,\n                },\n                url: {\n                    type: 'string',\n                    required: true,\n                }\n            };\n            errors = errors.concat(validateObject({\n                key: `${key}[${i}]`,\n                value: sprite[i],\n                valueSpec: pairSpec,\n                validateSpec: options.validateSpec,\n            }));\n        }\n        return errors;\n    }\n}\n\nfunction validateProjection(options) {\n    const projection = options.value;\n    const styleSpec = options.styleSpec;\n    const projectionSpec = styleSpec.projection;\n    const style = options.style;\n    const rootType = getType(projection);\n    if (projection === undefined) {\n        return [];\n    }\n    else if (rootType !== 'object') {\n        return [new ValidationError('projection', projection, `object expected, ${rootType} found`)];\n    }\n    let errors = [];\n    for (const key in projection) {\n        if (projectionSpec[key]) {\n            errors = errors.concat(options.validateSpec({\n                key,\n                value: projection[key],\n                valueSpec: projectionSpec[key],\n                style,\n                styleSpec\n            }));\n        }\n        else {\n            errors = errors.concat([new ValidationError(key, projection[key], `unknown property \"${key}\"`)]);\n        }\n    }\n    return errors;\n}\n\nfunction validateProjectionDefinition(options) {\n    const key = options.key;\n    let value = options.value;\n    value = value instanceof String ? value.valueOf() : value;\n    const type = getType(value);\n    if (type === 'array' && !isProjectionDefinitionValue(value) && !isPropertyValueSpecification(value)) {\n        return [new ValidationError(key, value, `projection expected, invalid array ${JSON.stringify(value)} found`)];\n    }\n    else if (!['array', 'string'].includes(type)) {\n        return [new ValidationError(key, value, `projection expected, invalid type \"${type}\" found`)];\n    }\n    return [];\n}\nfunction isPropertyValueSpecification(value) {\n    if (['interpolate', 'step', 'literal'].includes(value[0])) {\n        return true;\n    }\n    return false;\n}\nfunction isProjectionDefinitionValue(value) {\n    return Array.isArray(value) &&\n        value.length === 3 &&\n        typeof value[0] === 'string' &&\n        typeof value[1] === 'string' &&\n        typeof value[2] === 'number';\n}\n\nconst VALIDATORS = {\n    '*'() {\n        return [];\n    },\n    'array': validateArray,\n    'boolean': validateBoolean,\n    'number': validateNumber,\n    'color': validateColor,\n    'constants': validateConstants,\n    'enum': validateEnum,\n    'filter': validateFilter,\n    'function': validateFunction,\n    'layer': validateLayer,\n    'object': validateObject,\n    'source': validateSource,\n    'light': validateLight,\n    'sky': validateSky,\n    'terrain': validateTerrain,\n    'projection': validateProjection,\n    'projectionDefinition': validateProjectionDefinition,\n    'string': validateString,\n    'formatted': validateFormatted,\n    'resolvedImage': validateImage,\n    'padding': validatePadding,\n    'variableAnchorOffsetCollection': validateVariableAnchorOffsetCollection,\n    'sprite': validateSprite,\n};\n/**\n * Main recursive validation function used internally.\n * You should use `validateStyleMin` in the browser or `validateStyle` in node env.\n * @param options - the options object\n * @param options.key - string representing location of validation in style tree. Used only\n * for more informative error reporting.\n * @param options.value - current value from style being evaluated. May be anything from a\n * high level object that needs to be descended into deeper or a simple\n * scalar value.\n * @param options.valueSpec - current spec being evaluated. Tracks value.\n * @param options.styleSpec - current full spec being evaluated.\n * @param options.validateSpec - the validate function itself\n * @param options.style - the style object\n * @param options.objectElementValidators - optional object of functions that will be called\n * @returns an array of errors, or an empty array if no errors are found.\n */\nfunction validate(options) {\n    const value = options.value;\n    const valueSpec = options.valueSpec;\n    const styleSpec = options.styleSpec;\n    options.validateSpec = validate;\n    if (valueSpec.expression && isFunction$1(unbundle(value))) {\n        return validateFunction(options);\n    }\n    else if (valueSpec.expression && isExpression(deepUnbundle(value))) {\n        return validateExpression(options);\n    }\n    else if (valueSpec.type && VALIDATORS[valueSpec.type]) {\n        return VALIDATORS[valueSpec.type](options);\n    }\n    else {\n        const valid = validateObject(extendBy({}, options, {\n            valueSpec: valueSpec.type ? styleSpec[valueSpec.type] : valueSpec\n        }));\n        return valid;\n    }\n}\n\nfunction validateGlyphsUrl(options) {\n    const value = options.value;\n    const key = options.key;\n    const errors = validateString(options);\n    if (errors.length)\n        return errors;\n    if (value.indexOf('{fontstack}') === -1) {\n        errors.push(new ValidationError(key, value, '\"glyphs\" url must include a \"{fontstack}\" token'));\n    }\n    if (value.indexOf('{range}') === -1) {\n        errors.push(new ValidationError(key, value, '\"glyphs\" url must include a \"{range}\" token'));\n    }\n    return errors;\n}\n\n/**\n * Validate a MapLibre style against the style specification.\n * Use this when running in the browser.\n *\n * @param style - The style to be validated.\n * @param styleSpec - The style specification to validate against.\n * If omitted, the latest style spec is used.\n * @returns an array of errors, or an empty array if no errors are found.\n * @example\n *   const validate = require('@maplibre/maplibre-gl-style-spec/').validateStyleMin;\n *   const errors = validate(style);\n */\nfunction validateStyleMin(style, styleSpec = v8Spec) {\n    let errors = [];\n    errors = errors.concat(validate({\n        key: '',\n        value: style,\n        valueSpec: styleSpec.$root,\n        styleSpec,\n        style,\n        validateSpec: validate,\n        objectElementValidators: {\n            glyphs: validateGlyphsUrl,\n            '*'() {\n                return [];\n            }\n        }\n    }));\n    if (style['constants']) {\n        errors = errors.concat(validateConstants({\n            key: 'constants',\n            value: style['constants'],\n            style,\n            styleSpec,\n            validateSpec: validate,\n        }));\n    }\n    return sortErrors(errors);\n}\nvalidateStyleMin.source = wrapCleanErrors(injectValidateSpec(validateSource));\nvalidateStyleMin.sprite = wrapCleanErrors(injectValidateSpec(validateSprite));\nvalidateStyleMin.glyphs = wrapCleanErrors(injectValidateSpec(validateGlyphsUrl));\nvalidateStyleMin.light = wrapCleanErrors(injectValidateSpec(validateLight));\nvalidateStyleMin.sky = wrapCleanErrors(injectValidateSpec(validateSky));\nvalidateStyleMin.terrain = wrapCleanErrors(injectValidateSpec(validateTerrain));\nvalidateStyleMin.layer = wrapCleanErrors(injectValidateSpec(validateLayer));\nvalidateStyleMin.filter = wrapCleanErrors(injectValidateSpec(validateFilter));\nvalidateStyleMin.paintProperty = wrapCleanErrors(injectValidateSpec(validatePaintProperty));\nvalidateStyleMin.layoutProperty = wrapCleanErrors(injectValidateSpec(validateLayoutProperty));\nfunction injectValidateSpec(validator) {\n    return function (options) {\n        return validator({\n            ...options,\n            validateSpec: validate,\n        });\n    };\n}\nfunction sortErrors(errors) {\n    return [].concat(errors).sort((a, b) => {\n        return a.line - b.line;\n    });\n}\nfunction wrapCleanErrors(inner) {\n    return function (...args) {\n        return sortErrors(inner.apply(this, args));\n    };\n}\n\n// Note: This regex matches even invalid JSON strings, but since we’re\n// working on the output of `JSON.stringify` we know that only valid strings\n// are present (unless the user supplied a weird `options.indent` but in\n// that case we don’t care since the output would be invalid anyway).\nconst stringOrChar = /(\"(?:[^\\\\\"]|\\\\.)*\")|[:,]/g;\n\nfunction stringify(passedObj, options = {}) {\n  const indent = JSON.stringify(\n    [1],\n    undefined,\n    options.indent === undefined ? 2 : options.indent\n  ).slice(2, -3);\n\n  const maxLength =\n    indent === \"\"\n      ? Infinity\n      : options.maxLength === undefined\n      ? 80\n      : options.maxLength;\n\n  let { replacer } = options;\n\n  return (function _stringify(obj, currentIndent, reserved) {\n    if (obj && typeof obj.toJSON === \"function\") {\n      obj = obj.toJSON();\n    }\n\n    const string = JSON.stringify(obj, replacer);\n\n    if (string === undefined) {\n      return string;\n    }\n\n    const length = maxLength - currentIndent.length - reserved;\n\n    if (string.length <= length) {\n      const prettified = string.replace(\n        stringOrChar,\n        (match, stringLiteral) => {\n          return stringLiteral || `${match} `;\n        }\n      );\n      if (prettified.length <= length) {\n        return prettified;\n      }\n    }\n\n    if (replacer != null) {\n      obj = JSON.parse(string);\n      replacer = undefined;\n    }\n\n    if (typeof obj === \"object\" && obj !== null) {\n      const nextIndent = currentIndent + indent;\n      const items = [];\n      let index = 0;\n      let start;\n      let end;\n\n      if (Array.isArray(obj)) {\n        start = \"[\";\n        end = \"]\";\n        const { length } = obj;\n        for (; index < length; index++) {\n          items.push(\n            _stringify(obj[index], nextIndent, index === length - 1 ? 0 : 1) ||\n              \"null\"\n          );\n        }\n      } else {\n        start = \"{\";\n        end = \"}\";\n        const keys = Object.keys(obj);\n        const { length } = keys;\n        for (; index < length; index++) {\n          const key = keys[index];\n          const keyPart = `${JSON.stringify(key)}: `;\n          const value = _stringify(\n            obj[key],\n            nextIndent,\n            keyPart.length + (index === length - 1 ? 0 : 1)\n          );\n          if (value !== undefined) {\n            items.push(keyPart + value);\n          }\n        }\n      }\n\n      if (items.length > 0) {\n        return [start, indent + items.join(`,\\n${nextIndent}`), end].join(\n          `\\n${currentIndent}`\n        );\n      }\n    }\n\n    return string;\n  })(passedObj, \"\", 0);\n}\n\nfunction sortKeysBy(obj, reference) {\n    const result = {};\n    for (const key in reference) {\n        if (obj[key] !== undefined) {\n            result[key] = obj[key];\n        }\n    }\n    for (const key in obj) {\n        if (result[key] === undefined) {\n            result[key] = obj[key];\n        }\n    }\n    return result;\n}\n/**\n * Format a MapLibre Style.  Returns a stringified style with its keys\n * sorted in the same order as the reference style.\n *\n * The optional `space` argument is passed to\n * [`JSON.stringify`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)\n * to generate formatted output.\n *\n * If `space` is unspecified, a default of `2` spaces will be used.\n *\n * @private\n * @param {Object} style a MapLibre Style\n * @param {number} [space] space argument to pass to `JSON.stringify`\n * @returns {string} stringified formatted JSON\n * @example\n * var fs = require('fs');\n * var format = require('maplibre-gl-style-spec').format;\n * var style = fs.readFileSync('./source.json', 'utf8');\n * fs.writeFileSync('./dest.json', format(style));\n * fs.writeFileSync('./dest.min.json', format(style, 0));\n */\nfunction format(style, space = 2) {\n    style = sortKeysBy(style, v8Spec.$root);\n    if (style.layers) {\n        style.layers = style.layers.map((layer) => sortKeysBy(layer, v8Spec.layer));\n    }\n    return stringify(style, { indent: space });\n}\n\nfunction eachLayout(layer, callback) {\n    for (const k in layer) {\n        if (k.indexOf('layout') === 0) {\n            callback(layer[k], k);\n        }\n    }\n}\nfunction eachPaint(layer, callback) {\n    for (const k in layer) {\n        if (k.indexOf('paint') === 0) {\n            callback(layer[k], k);\n        }\n    }\n}\nfunction resolveConstant(style, value) {\n    if (typeof value === 'string' && value[0] === '@') {\n        return resolveConstant(style, style.constants[value]);\n    }\n    else {\n        return value;\n    }\n}\nfunction isFunction(value) {\n    return Array.isArray(value.stops);\n}\nfunction renameProperty(obj, from, to) {\n    obj[to] = obj[from];\n    delete obj[from];\n}\nfunction migrateV8(style) {\n    style.version = 8;\n    // Rename properties, reverse coordinates in source and layers\n    eachSource(style, (source) => {\n        if (source.type === 'video' && source['url'] !== undefined) {\n            renameProperty(source, 'url', 'urls');\n        }\n        if (source.type === 'video') {\n            source.coordinates.forEach((coord) => {\n                return coord.reverse();\n            });\n        }\n    });\n    eachLayer(style, (layer) => {\n        eachLayout(layer, (layout) => {\n            if (layout['symbol-min-distance'] !== undefined) {\n                renameProperty(layout, 'symbol-min-distance', 'symbol-spacing');\n            }\n        });\n        eachPaint(layer, (paint) => {\n            if (paint['background-image'] !== undefined) {\n                renameProperty(paint, 'background-image', 'background-pattern');\n            }\n            if (paint['line-image'] !== undefined) {\n                renameProperty(paint, 'line-image', 'line-pattern');\n            }\n            if (paint['fill-image'] !== undefined) {\n                renameProperty(paint, 'fill-image', 'fill-pattern');\n            }\n        });\n    });\n    // Inline Constants\n    eachProperty(style, { paint: true, layout: true }, (property) => {\n        const value = resolveConstant(style, property.value);\n        if (isFunction(value)) {\n            value.stops.forEach((stop) => {\n                stop[1] = resolveConstant(style, stop[1]);\n            });\n        }\n        property.set(value);\n    });\n    delete style['constants'];\n    eachLayer(style, (layer) => {\n        // get rid of text-max-size, icon-max-size\n        // turn text-size, icon-size into layout properties\n        // https://github.com/mapbox/mapbox-gl-style-spec/issues/255\n        eachLayout(layer, (layout) => {\n            delete layout['text-max-size'];\n            delete layout['icon-max-size'];\n        });\n        eachPaint(layer, (paint) => {\n            if (paint['text-size']) {\n                if (!layer.layout)\n                    layer.layout = {};\n                layer.layout['text-size'] = paint['text-size'];\n                delete paint['text-size'];\n            }\n            if (paint['icon-size']) {\n                if (!layer.layout)\n                    layer.layout = {};\n                layer.layout['icon-size'] = paint['icon-size'];\n                delete paint['icon-size'];\n            }\n        });\n    });\n    function migrateFontStack(font) {\n        function splitAndTrim(string) {\n            return string.split(',').map((s) => {\n                return s.trim();\n            });\n        }\n        if (Array.isArray(font)) {\n            // Assume it's a previously migrated font-array.\n            return font;\n        }\n        else if (typeof font === 'string') {\n            return splitAndTrim(font);\n        }\n        else if (typeof font === 'object') {\n            font.stops.forEach((stop) => {\n                stop[1] = splitAndTrim(stop[1]);\n            });\n            return font;\n        }\n        else {\n            throw new Error('unexpected font value');\n        }\n    }\n    eachLayer(style, (layer) => {\n        eachLayout(layer, (layout) => {\n            if (layout['text-font']) {\n                layout['text-font'] = migrateFontStack(layout['text-font']);\n            }\n        });\n    });\n    // Reverse order of symbol layers. This is an imperfect migration.\n    //\n    // The order of a symbol layer in the layers list affects two things:\n    // - how it is drawn relative to other layers (like oneway arrows below bridges)\n    // - the placement priority compared to other layers\n    //\n    // It's impossible to reverse the placement priority without breaking the draw order\n    // in some cases. This migration only reverses the order of symbol layers that\n    // are above all other types of layers.\n    //\n    // Symbol layers that are at the top of the map preserve their priority.\n    // Symbol layers that are below another type (line, fill) of layer preserve their draw order.\n    let firstSymbolLayer = 0;\n    for (let i = style.layers.length - 1; i >= 0; i--) {\n        const layer = style.layers[i];\n        if (layer.type !== 'symbol') {\n            firstSymbolLayer = i + 1;\n            break;\n        }\n    }\n    const symbolLayers = style.layers.splice(firstSymbolLayer);\n    symbolLayers.reverse();\n    style.layers = style.layers.concat(symbolLayers);\n    return style;\n}\n\n/**\n * Migrate the given style object in place to use expressions. Specifically,\n * this will convert (a) \"stop\" functions, and (b) legacy filters to their\n * expression equivalents.\n * @param style The style object to migrate.\n * @returns The migrated style object.\n */\nfunction expressions(style) {\n    const converted = [];\n    eachLayer(style, (layer) => {\n        if (layer.filter) {\n            layer.filter = convertFilter(layer.filter);\n        }\n    });\n    eachProperty(style, { paint: true, layout: true }, ({ path, value, reference, set }) => {\n        if (isExpression(value))\n            return;\n        if (typeof value === 'object' && !Array.isArray(value)) {\n            set(convertFunction(value, reference));\n            converted.push(path.join('.'));\n        }\n        else if (reference.tokens && typeof value === 'string') {\n            set(convertTokenString(value));\n        }\n    });\n    return style;\n}\n\n/**\n * Migrate color style values to supported format.\n *\n * @param colorToMigrate Color value to migrate, could be a string or an expression.\n * @returns Color style value in supported format.\n */\nfunction migrateColors(colorToMigrate) {\n    return JSON.parse(migrateHslColors(JSON.stringify(colorToMigrate)));\n}\n/**\n * Created to migrate from colors supported by the former CSS color parsing\n * library `csscolorparser` but not compliant with the CSS Color specification,\n * like `hsl(900, 0.15, 90%)`.\n *\n * @param colorToMigrate Serialized color style value.\n * @returns A serialized color style value in which all non-standard hsl color values\n * have been converted to a format that complies with the CSS Color specification.\n *\n * @example\n * migrateHslColors('\"hsl(900, 0.15, 90%)\"'); // returns '\"hsl(900, 15%, 90%)\"'\n * migrateHslColors('\"hsla(900, .15, .9)\"'); // returns '\"hsl(900, 15%, 90%)\"'\n * migrateHslColors('\"hsl(900, 15%, 90%)\"'); // returns '\"hsl(900, 15%, 90%)\"' - no changes\n */\nfunction migrateHslColors(colorToMigrate) {\n    return colorToMigrate.replace(/\"hsla?\\((.+?)\\)\"/gi, (match, hslArgs) => {\n        const argsMatch = hslArgs.match(/^(.+?)\\s*,\\s*(.+?)\\s*,\\s*(.+?)(?:\\s*,\\s*(.+))?$/i);\n        if (argsMatch) {\n            let [h, s, l, a] = argsMatch.slice(1);\n            [s, l] = [s, l].map(v => v.endsWith('%') ? v : `${parseFloat(v) * 100}%`);\n            return `\"hsl${typeof a === 'string' ? 'a' : ''}(${[h, s, l, a].filter(Boolean).join(',')})\"`;\n        }\n        return match;\n    });\n}\n\n/**\n * Migrate a Mapbox/MapLibre GL Style to the latest version.\n *\n * @param style - a MapLibre Style\n * @returns a migrated style\n * @example\n * const fs = require('fs');\n * const migrate = require('@maplibre/maplibre-gl-style-spec').migrate;\n * const style = fs.readFileSync('./style.json', 'utf8');\n * fs.writeFileSync('./style.json', JSON.stringify(migrate(style)));\n */\nfunction migrate(style) {\n    let migrated = false;\n    if (style.version === 7) {\n        style = migrateV8(style);\n        migrated = true;\n    }\n    if (style.version === 8) {\n        migrated = !!expressions(style);\n        migrated = true;\n    }\n    eachProperty(style, { paint: true, layout: true }, ({ value, reference, set }) => {\n        if (reference.type === 'color') {\n            set(migrateColors(value));\n        }\n    });\n    if (!migrated) {\n        throw new Error(`Cannot migrate from ${style.version}`);\n    }\n    return style;\n}\n\nconst v8 = v8Spec;\nconst expression = {\n    StyleExpression,\n    StylePropertyFunction,\n    ZoomConstantExpression,\n    ZoomDependentExpression,\n    createExpression,\n    createPropertyExpression,\n    isExpression,\n    isExpressionFilter,\n    isZoomExpression,\n    normalizePropertyExpression,\n};\nconst styleFunction = {\n    convertFunction,\n    createFunction,\n    isFunction: isFunction$1\n};\nconst visit = { eachLayer, eachProperty, eachSource };\n\nexport { Color, ColorType, CompoundExpression, EvaluationContext, FormatExpression, Formatted, FormattedSection, FormattedType, Interpolate, Literal, NullType, Padding, ParsingError, ProjectionDefinition, ProjectionDefinitionType, ResolvedImage, Step, StyleExpression, StylePropertyFunction, ValidationError, VariableAnchorOffsetCollection, ZoomConstantExpression, ZoomDependentExpression, classifyRings, convertFilter, convertFunction, createExpression, createFunction, createPropertyExpression, derefLayers, diff, emptyStyle, expression, expressions$1 as expressions, featureFilter, format, styleFunction as function, groupByLayout, interpolateFactory as interpolates, isExpression, isFunction$1 as isFunction, isZoomExpression, v8Spec as latest, migrate, normalizePropertyExpression, supportsPropertyExpression, typeToString as toString, typeOf, v8, validate, validateStyleMin, visit };\n//# sourceMappingURL=index.mjs.map\n","var fontWeights = {\n  thin: 100,\n  hairline: 100,\n  'ultra-light': 200,\n  'extra-light': 200,\n  light: 300,\n  book: 300,\n  regular: 400,\n  normal: 400,\n  plain: 400,\n  roman: 400,\n  standard: 400,\n  medium: 500,\n  'semi-bold': 600,\n  'demi-bold': 600,\n  bold: 700,\n  'extra-bold': 800,\n  'ultra-bold': 800,\n  heavy: 900,\n  black: 900,\n  'heavy-black': 900,\n  fat: 900,\n  poster: 900,\n  'ultra-black': 950,\n  'extra-black': 950\n};\nvar sp = ' ';\nvar italicRE = /(italic|oblique)$/i;\n\nvar fontCache = {};\n\n/**\n * @param {string|Array<string>} fonts Mapbox GL Style fontstack or single font, e.g. `['Open Sans Regular', 'Arial Unicode MS Regular']` or `'Open Sans Regular'`.\n * @param {number} size Font size in pixels.\n * @param {string|number} [lineHeight] Line height as css line-height.\n * @returns {string} CSS font definition, e.g. `'normal 400 16px/1.2 \"Open Sans\"'`.\n */\nexport default function(fonts, size, lineHeight) {\n  var cssData = fontCache[fonts];\n  if (!cssData) {\n    if (!Array.isArray(fonts)) {\n      fonts = [fonts];\n    }\n    var weight = 400;\n    var style = 'normal';\n    var fontFamilies = [];\n    var haveWeight, haveStyle;\n    for (var i = 0, ii = fonts.length; i < ii; ++i) {\n      var font = fonts[i];\n      var parts = font.split(' ');\n      var maybeWeight = parts[parts.length - 1].toLowerCase();\n      if (maybeWeight == 'normal' || maybeWeight == 'italic' || maybeWeight == 'oblique') {\n        style = haveStyle ? style : maybeWeight;\n        haveStyle = true;\n        parts.pop();\n        maybeWeight = parts[parts.length - 1].toLowerCase();\n      } else if (italicRE.test(maybeWeight)) {\n        maybeWeight = maybeWeight.replace(italicRE, '');\n        style = haveStyle ? style : parts[parts.length - 1].replace(maybeWeight, '');\n        haveStyle = true;\n      }\n      for (var w in fontWeights) {\n        var previousPart = parts.length > 1 ? parts[parts.length - 2].toLowerCase() : '';\n        if (maybeWeight == w || maybeWeight == w.replace('-', '') || previousPart + '-' + maybeWeight == w) {\n          weight = haveWeight ? weight : fontWeights[w];\n          parts.pop();\n          if (previousPart && w.startsWith(previousPart)) {\n            parts.pop();\n          }\n          break;\n        }\n      }\n      if (!haveWeight && typeof maybeWeight == 'number') {\n        weight = maybeWeight;\n        haveWeight = true;\n      }\n      var fontFamily = parts.join(sp)\n        .replace('Klokantech Noto Sans', 'Noto Sans');\n      if (fontFamily.indexOf(sp) !== -1) {\n        fontFamily = '\"' + fontFamily + '\"';\n      }\n      fontFamilies.push(fontFamily);\n    }\n    // CSS font property: font-style font-weight font-size/line-height font-family\n    cssData = fontCache[fonts] = [style, weight, fontFamilies];\n  }\n  return cssData[0] + sp + cssData[1] + sp + size + 'px' + (lineHeight ? '/' + lineHeight : '') + sp + cssData[2];\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.functions;","/**\n * @module ol/array\n */\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function} [comparator] Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, comparator) {\n  let mid, cmp;\n  comparator = comparator || ascending;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + ((high - low) >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) {\n      /* Too low. */\n      low = mid + 1;\n    } else {\n      /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n/**\n * Compare function sorting arrays in ascending order.  Safe to use for numeric values.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function ascending(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n/**\n * Compare function sorting arrays in descending order.  Safe to use for numeric values.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is greater than, equal to, or less than the second.\n */\nexport function descending(a, b) {\n  return a < b ? 1 : a > b ? -1 : 0;\n}\n\n/**\n * {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution} can use a function\n * of this type to determine which nearest resolution to use.\n *\n * This function takes a `{number}` representing a value between two array entries,\n * a `{number}` representing the value of the nearest higher entry and\n * a `{number}` representing the value of the nearest lower entry\n * as arguments and returns a `{number}`. If a negative number or zero is returned\n * the lower value will be used, if a positive number is returned the higher value\n * will be used.\n * @typedef {function(number, number, number): number} NearestDirectionFunction\n * @api\n */\n\n/**\n * @param {Array<number>} arr Array in descending order.\n * @param {number} target Target.\n * @param {number|NearestDirectionFunction} direction\n *    0 means return the nearest,\n *    > 0 means return the largest nearest,\n *    < 0 means return the smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  if (arr[0] <= target) {\n    return 0;\n  }\n\n  const n = arr.length;\n  if (target <= arr[n - 1]) {\n    return n - 1;\n  }\n\n  if (typeof direction === 'function') {\n    for (let i = 1; i < n; ++i) {\n      const candidate = arr[i];\n      if (candidate === target) {\n        return i;\n      }\n      if (candidate < target) {\n        if (direction(target, arr[i - 1], candidate) > 0) {\n          return i - 1;\n        }\n        return i;\n      }\n    }\n    return n - 1;\n  }\n\n  if (direction > 0) {\n    for (let i = 1; i < n; ++i) {\n      if (arr[i] < target) {\n        return i - 1;\n      }\n    }\n    return n - 1;\n  }\n\n  if (direction < 0) {\n    for (let i = 1; i < n; ++i) {\n      if (arr[i] <= target) {\n        return i;\n      }\n    }\n    return n - 1;\n  }\n\n  for (let i = 1; i < n; ++i) {\n    if (arr[i] == target) {\n      return i;\n    }\n    if (arr[i] < target) {\n      if (arr[i - 1] - target < target - arr[i]) {\n        return i - 1;\n      }\n      return i;\n    }\n  }\n  return n - 1;\n}\n\n/**\n * @param {Array<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {!Array<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n/**\n * @param {Array<any>|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array<any>|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Sort the passed array such that the relative order of equal elements is preserved.\n * See https://en.wikipedia.org/wiki/Sorting_algorithm#Stability for details.\n * @param {Array<*>} arr The array to sort (modifies original).\n * @param {!function(*, *): number} compareFnc Comparison function.\n * @api\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function (a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n/**\n * @param {Array<*>} arr The array to test.\n * @param {Function} [func] Comparison function.\n * @param {boolean} [strict] Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, func, strict) {\n  const compare = func || ascending;\n  return arr.every(function (currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || (strict && res === 0));\n  });\n}\n","/**\n * @module ol/extent\n */\nimport Relationship from './extent/Relationship.js';\n\n/**\n * An array of numbers representing an extent: `[minx, miny, maxx, maxy]`.\n * @typedef {Array<number>} Extent\n * @api\n */\n\n/**\n * Extent corner.\n * @typedef {'bottom-left' | 'bottom-right' | 'top-left' | 'top-right'} Corner\n */\n\n/**\n * Build an extent that includes all given coordinates.\n *\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @return {Extent} Bounding extent.\n * @api\n */\nexport function boundingExtent(coordinates) {\n  const extent = createEmpty();\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n/**\n * @param {Array<number>} xs Xs.\n * @param {Array<number>} ys Ys.\n * @param {Extent} [dest] Destination extent.\n * @private\n * @return {Extent} Extent.\n */\nfunction _boundingExtentXYs(xs, ys, dest) {\n  const minX = Math.min.apply(null, xs);\n  const minY = Math.min.apply(null, ys);\n  const maxX = Math.max.apply(null, xs);\n  const maxY = Math.max.apply(null, ys);\n  return createOrUpdate(minX, minY, maxX, maxY, dest);\n}\n\n/**\n * Return extent increased by the provided value.\n * @param {Extent} extent Extent.\n * @param {number} value The amount by which the extent should be buffered.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n * @api\n */\nexport function buffer(extent, value, dest) {\n  if (dest) {\n    dest[0] = extent[0] - value;\n    dest[1] = extent[1] - value;\n    dest[2] = extent[2] + value;\n    dest[3] = extent[3] + value;\n    return dest;\n  }\n  return [\n    extent[0] - value,\n    extent[1] - value,\n    extent[2] + value,\n    extent[3] + value,\n  ];\n}\n\n/**\n * Creates a clone of an extent.\n *\n * @param {Extent} extent Extent to clone.\n * @param {Extent} [dest] Extent.\n * @return {Extent} The clone.\n */\nexport function clone(extent, dest) {\n  if (dest) {\n    dest[0] = extent[0];\n    dest[1] = extent[1];\n    dest[2] = extent[2];\n    dest[3] = extent[3];\n    return dest;\n  }\n  return extent.slice();\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {number} Closest squared distance.\n */\nexport function closestSquaredDistanceXY(extent, x, y) {\n  let dx, dy;\n  if (x < extent[0]) {\n    dx = extent[0] - x;\n  } else if (extent[2] < x) {\n    dx = x - extent[2];\n  } else {\n    dx = 0;\n  }\n  if (y < extent[1]) {\n    dy = extent[1] - y;\n  } else if (extent[3] < y) {\n    dy = y - extent[3];\n  } else {\n    dy = 0;\n  }\n  return dx * dx + dy * dy;\n}\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {Extent} extent Extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @return {boolean} The coordinate is contained in the extent.\n * @api\n */\nexport function containsCoordinate(extent, coordinate) {\n  return containsXY(extent, coordinate[0], coordinate[1]);\n}\n\n/**\n * Check if one extent contains another.\n *\n * An extent is deemed contained if it lies completely within the other extent,\n * including if they share one or more edges.\n *\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {boolean} The second extent is contained by or on the edge of the\n *     first.\n * @api\n */\nexport function containsExtent(extent1, extent2) {\n  return (\n    extent1[0] <= extent2[0] &&\n    extent2[2] <= extent1[2] &&\n    extent1[1] <= extent2[1] &&\n    extent2[3] <= extent1[3]\n  );\n}\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {Extent} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\n/**\n * Get the relationship between a coordinate and extent.\n * @param {Extent} extent The extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate The coordinate.\n * @return {import(\"./extent/Relationship.js\").default} The relationship (bitwise compare with\n *     import(\"./extent/Relationship.js\").Relationship).\n */\nexport function coordinateRelationship(extent, coordinate) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let relationship = Relationship.UNKNOWN;\n  if (x < minX) {\n    relationship = relationship | Relationship.LEFT;\n  } else if (x > maxX) {\n    relationship = relationship | Relationship.RIGHT;\n  }\n  if (y < minY) {\n    relationship = relationship | Relationship.BELOW;\n  } else if (y > maxY) {\n    relationship = relationship | Relationship.ABOVE;\n  }\n  if (relationship === Relationship.UNKNOWN) {\n    relationship = Relationship.INTERSECTING;\n  }\n  return relationship;\n}\n\n/**\n * Create an empty extent.\n * @return {Extent} Empty extent.\n * @api\n */\nexport function createEmpty() {\n  return [Infinity, Infinity, -Infinity, -Infinity];\n}\n\n/**\n * Create a new extent or update the provided extent.\n * @param {number} minX Minimum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxX Maximum X.\n * @param {number} maxY Maximum Y.\n * @param {Extent} [dest] Destination extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdate(minX, minY, maxX, maxY, dest) {\n  if (dest) {\n    dest[0] = minX;\n    dest[1] = minY;\n    dest[2] = maxX;\n    dest[3] = maxY;\n    return dest;\n  }\n  return [minX, minY, maxX, maxY];\n}\n\n/**\n * Create a new empty extent or make the provided one empty.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateEmpty(dest) {\n  return createOrUpdate(Infinity, Infinity, -Infinity, -Infinity, dest);\n}\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromCoordinate(coordinate, dest) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  return createOrUpdate(x, y, x, y, dest);\n}\n\n/**\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromCoordinates(coordinates, dest) {\n  const extent = createOrUpdateEmpty(dest);\n  return extendCoordinates(extent, coordinates);\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromFlatCoordinates(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  dest,\n) {\n  const extent = createOrUpdateEmpty(dest);\n  return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);\n}\n\n/**\n * @param {Array<Array<import(\"./coordinate.js\").Coordinate>>} rings Rings.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromRings(rings, dest) {\n  const extent = createOrUpdateEmpty(dest);\n  return extendRings(extent, rings);\n}\n\n/**\n * Determine if two extents are equivalent.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {boolean} The two extents are equivalent.\n * @api\n */\nexport function equals(extent1, extent2) {\n  return (\n    extent1[0] == extent2[0] &&\n    extent1[2] == extent2[2] &&\n    extent1[1] == extent2[1] &&\n    extent1[3] == extent2[3]\n  );\n}\n\n/**\n * Determine if two extents are approximately equivalent.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @param {number} tolerance Tolerance in extent coordinate units.\n * @return {boolean} The two extents differ by less than the tolerance.\n */\nexport function approximatelyEquals(extent1, extent2, tolerance) {\n  return (\n    Math.abs(extent1[0] - extent2[0]) < tolerance &&\n    Math.abs(extent1[2] - extent2[2]) < tolerance &&\n    Math.abs(extent1[1] - extent2[1]) < tolerance &&\n    Math.abs(extent1[3] - extent2[3]) < tolerance\n  );\n}\n\n/**\n * Modify an extent to include another extent.\n * @param {Extent} extent1 The extent to be modified.\n * @param {Extent} extent2 The extent that will be included in the first.\n * @return {Extent} A reference to the first (extended) extent.\n * @api\n */\nexport function extend(extent1, extent2) {\n  if (extent2[0] < extent1[0]) {\n    extent1[0] = extent2[0];\n  }\n  if (extent2[2] > extent1[2]) {\n    extent1[2] = extent2[2];\n  }\n  if (extent2[1] < extent1[1]) {\n    extent1[1] = extent2[1];\n  }\n  if (extent2[3] > extent1[3]) {\n    extent1[3] = extent2[3];\n  }\n  return extent1;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n */\nexport function extendCoordinate(extent, coordinate) {\n  if (coordinate[0] < extent[0]) {\n    extent[0] = coordinate[0];\n  }\n  if (coordinate[0] > extent[2]) {\n    extent[2] = coordinate[0];\n  }\n  if (coordinate[1] < extent[1]) {\n    extent[1] = coordinate[1];\n  }\n  if (coordinate[1] > extent[3]) {\n    extent[3] = coordinate[1];\n  }\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @return {Extent} Extent.\n */\nexport function extendCoordinates(extent, coordinates) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Extent} Extent.\n */\nexport function extendFlatCoordinates(\n  extent,\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n) {\n  for (; offset < end; offset += stride) {\n    extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);\n  }\n  return extent;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<Array<import(\"./coordinate.js\").Coordinate>>} rings Rings.\n * @return {Extent} Extent.\n */\nexport function extendRings(extent, rings) {\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    extendCoordinates(extent, rings[i]);\n  }\n  return extent;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n */\nexport function extendXY(extent, x, y) {\n  extent[0] = Math.min(extent[0], x);\n  extent[1] = Math.min(extent[1], y);\n  extent[2] = Math.max(extent[2], x);\n  extent[3] = Math.max(extent[3], y);\n}\n\n/**\n * This function calls `callback` for each corner of the extent. If the\n * callback returns a truthy value the function returns that value\n * immediately. Otherwise the function returns `false`.\n * @param {Extent} extent Extent.\n * @param {function(import(\"./coordinate.js\").Coordinate): S} callback Callback.\n * @return {S|boolean} Value.\n * @template S\n */\nexport function forEachCorner(extent, callback) {\n  let val;\n  val = callback(getBottomLeft(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getBottomRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getTopRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getTopLeft(extent));\n  if (val) {\n    return val;\n  }\n  return false;\n}\n\n/**\n * Get the size of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Area.\n * @api\n */\nexport function getArea(extent) {\n  let area = 0;\n  if (!isEmpty(extent)) {\n    area = getWidth(extent) * getHeight(extent);\n  }\n  return area;\n}\n\n/**\n * Get the bottom left coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Bottom left coordinate.\n * @api\n */\nexport function getBottomLeft(extent) {\n  return [extent[0], extent[1]];\n}\n\n/**\n * Get the bottom right coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Bottom right coordinate.\n * @api\n */\nexport function getBottomRight(extent) {\n  return [extent[2], extent[1]];\n}\n\n/**\n * Get the center coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Center.\n * @api\n */\nexport function getCenter(extent) {\n  return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n}\n\n/**\n * Get a corner coordinate of an extent.\n * @param {Extent} extent Extent.\n * @param {Corner} corner Corner.\n * @return {import(\"./coordinate.js\").Coordinate} Corner coordinate.\n */\nexport function getCorner(extent, corner) {\n  let coordinate;\n  if (corner === 'bottom-left') {\n    coordinate = getBottomLeft(extent);\n  } else if (corner === 'bottom-right') {\n    coordinate = getBottomRight(extent);\n  } else if (corner === 'top-left') {\n    coordinate = getTopLeft(extent);\n  } else if (corner === 'top-right') {\n    coordinate = getTopRight(extent);\n  } else {\n    throw new Error('Invalid corner');\n  }\n  return coordinate;\n}\n\n/**\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {number} Enlarged area.\n */\nexport function getEnlargedArea(extent1, extent2) {\n  const minX = Math.min(extent1[0], extent2[0]);\n  const minY = Math.min(extent1[1], extent2[1]);\n  const maxX = Math.max(extent1[2], extent2[2]);\n  const maxY = Math.max(extent1[3], extent2[3]);\n  return (maxX - minX) * (maxY - minY);\n}\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {import(\"./size.js\").Size} size Size.\n * @param {Extent} [dest] Destination extent.\n * @return {Extent} Extent.\n */\nexport function getForViewAndSize(center, resolution, rotation, size, dest) {\n  const [x0, y0, x1, y1, x2, y2, x3, y3] = getRotatedViewport(\n    center,\n    resolution,\n    rotation,\n    size,\n  );\n  return createOrUpdate(\n    Math.min(x0, x1, x2, x3),\n    Math.min(y0, y1, y2, y3),\n    Math.max(x0, x1, x2, x3),\n    Math.max(y0, y1, y2, y3),\n    dest,\n  );\n}\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {import(\"./size.js\").Size} size Size.\n * @return {Array<number>} Linear ring representing the viewport.\n */\nexport function getRotatedViewport(center, resolution, rotation, size) {\n  const dx = (resolution * size[0]) / 2;\n  const dy = (resolution * size[1]) / 2;\n  const cosRotation = Math.cos(rotation);\n  const sinRotation = Math.sin(rotation);\n  const xCos = dx * cosRotation;\n  const xSin = dx * sinRotation;\n  const yCos = dy * cosRotation;\n  const ySin = dy * sinRotation;\n  const x = center[0];\n  const y = center[1];\n  return [\n    x - xCos + ySin,\n    y - xSin - yCos,\n    x - xCos - ySin,\n    y - xSin + yCos,\n    x + xCos - ySin,\n    y + xSin + yCos,\n    x + xCos + ySin,\n    y + xSin - yCos,\n    x - xCos + ySin,\n    y - xSin - yCos,\n  ];\n}\n\n/**\n * Get the height of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Height.\n * @api\n */\nexport function getHeight(extent) {\n  return extent[3] - extent[1];\n}\n\n/**\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {number} Intersection area.\n */\nexport function getIntersectionArea(extent1, extent2) {\n  const intersection = getIntersection(extent1, extent2);\n  return getArea(intersection);\n}\n\n/**\n * Get the intersection of two extents.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @param {Extent} [dest] Optional extent to populate with intersection.\n * @return {Extent} Intersecting extent.\n * @api\n */\nexport function getIntersection(extent1, extent2, dest) {\n  const intersection = dest ? dest : createEmpty();\n  if (intersects(extent1, extent2)) {\n    if (extent1[0] > extent2[0]) {\n      intersection[0] = extent1[0];\n    } else {\n      intersection[0] = extent2[0];\n    }\n    if (extent1[1] > extent2[1]) {\n      intersection[1] = extent1[1];\n    } else {\n      intersection[1] = extent2[1];\n    }\n    if (extent1[2] < extent2[2]) {\n      intersection[2] = extent1[2];\n    } else {\n      intersection[2] = extent2[2];\n    }\n    if (extent1[3] < extent2[3]) {\n      intersection[3] = extent1[3];\n    } else {\n      intersection[3] = extent2[3];\n    }\n  } else {\n    createOrUpdateEmpty(intersection);\n  }\n  return intersection;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @return {number} Margin.\n */\nexport function getMargin(extent) {\n  return getWidth(extent) + getHeight(extent);\n}\n\n/**\n * Get the size (width, height) of an extent.\n * @param {Extent} extent The extent.\n * @return {import(\"./size.js\").Size} The extent size.\n * @api\n */\nexport function getSize(extent) {\n  return [extent[2] - extent[0], extent[3] - extent[1]];\n}\n\n/**\n * Get the top left coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Top left coordinate.\n * @api\n */\nexport function getTopLeft(extent) {\n  return [extent[0], extent[3]];\n}\n\n/**\n * Get the top right coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Top right coordinate.\n * @api\n */\nexport function getTopRight(extent) {\n  return [extent[2], extent[3]];\n}\n\n/**\n * Get the width of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Width.\n * @api\n */\nexport function getWidth(extent) {\n  return extent[2] - extent[0];\n}\n\n/**\n * Determine if one extent intersects another.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent.\n * @return {boolean} The two extents intersect.\n * @api\n */\nexport function intersects(extent1, extent2) {\n  return (\n    extent1[0] <= extent2[2] &&\n    extent1[2] >= extent2[0] &&\n    extent1[1] <= extent2[3] &&\n    extent1[3] >= extent2[1]\n  );\n}\n\n/**\n * Determine if an extent is empty.\n * @param {Extent} extent Extent.\n * @return {boolean} Is empty.\n * @api\n */\nexport function isEmpty(extent) {\n  return extent[2] < extent[0] || extent[3] < extent[1];\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {Extent} [dest] Extent.\n * @return {Extent} Extent.\n */\nexport function returnOrUpdate(extent, dest) {\n  if (dest) {\n    dest[0] = extent[0];\n    dest[1] = extent[1];\n    dest[2] = extent[2];\n    dest[3] = extent[3];\n    return dest;\n  }\n  return extent;\n}\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} value Value.\n */\nexport function scaleFromCenter(extent, value) {\n  const deltaX = ((extent[2] - extent[0]) / 2) * (value - 1);\n  const deltaY = ((extent[3] - extent[1]) / 2) * (value - 1);\n  extent[0] -= deltaX;\n  extent[2] += deltaX;\n  extent[1] -= deltaY;\n  extent[3] += deltaY;\n}\n\n/**\n * Determine if the segment between two coordinates intersects (crosses,\n * touches, or is contained by) the provided extent.\n * @param {Extent} extent The extent.\n * @param {import(\"./coordinate.js\").Coordinate} start Segment start coordinate.\n * @param {import(\"./coordinate.js\").Coordinate} end Segment end coordinate.\n * @return {boolean} The segment intersects the extent.\n */\nexport function intersectsSegment(extent, start, end) {\n  let intersects = false;\n  const startRel = coordinateRelationship(extent, start);\n  const endRel = coordinateRelationship(extent, end);\n  if (\n    startRel === Relationship.INTERSECTING ||\n    endRel === Relationship.INTERSECTING\n  ) {\n    intersects = true;\n  } else {\n    const minX = extent[0];\n    const minY = extent[1];\n    const maxX = extent[2];\n    const maxY = extent[3];\n    const startX = start[0];\n    const startY = start[1];\n    const endX = end[0];\n    const endY = end[1];\n    const slope = (endY - startY) / (endX - startX);\n    let x, y;\n    if (!!(endRel & Relationship.ABOVE) && !(startRel & Relationship.ABOVE)) {\n      // potentially intersects top\n      x = endX - (endY - maxY) / slope;\n      intersects = x >= minX && x <= maxX;\n    }\n    if (\n      !intersects &&\n      !!(endRel & Relationship.RIGHT) &&\n      !(startRel & Relationship.RIGHT)\n    ) {\n      // potentially intersects right\n      y = endY - (endX - maxX) * slope;\n      intersects = y >= minY && y <= maxY;\n    }\n    if (\n      !intersects &&\n      !!(endRel & Relationship.BELOW) &&\n      !(startRel & Relationship.BELOW)\n    ) {\n      // potentially intersects bottom\n      x = endX - (endY - minY) / slope;\n      intersects = x >= minX && x <= maxX;\n    }\n    if (\n      !intersects &&\n      !!(endRel & Relationship.LEFT) &&\n      !(startRel & Relationship.LEFT)\n    ) {\n      // potentially intersects left\n      y = endY - (endX - minX) * slope;\n      intersects = y >= minY && y <= maxY;\n    }\n  }\n  return intersects;\n}\n\n/**\n * Apply a transform function to the extent.\n * @param {Extent} extent Extent.\n * @param {import(\"./proj.js\").TransformFunction} transformFn Transform function.\n * Called with `[minX, minY, maxX, maxY]` extent coordinates.\n * @param {Extent} [dest] Destination extent.\n * @param {number} [stops] Number of stops per side used for the transform.\n * By default only the corners are used.\n * @return {Extent} Extent.\n * @api\n */\nexport function applyTransform(extent, transformFn, dest, stops) {\n  if (isEmpty(extent)) {\n    return createOrUpdateEmpty(dest);\n  }\n  let coordinates = [];\n  if (stops > 1) {\n    const width = extent[2] - extent[0];\n    const height = extent[3] - extent[1];\n    for (let i = 0; i < stops; ++i) {\n      coordinates.push(\n        extent[0] + (width * i) / stops,\n        extent[1],\n        extent[2],\n        extent[1] + (height * i) / stops,\n        extent[2] - (width * i) / stops,\n        extent[3],\n        extent[0],\n        extent[3] - (height * i) / stops,\n      );\n    }\n  } else {\n    coordinates = [\n      extent[0],\n      extent[1],\n      extent[2],\n      extent[1],\n      extent[2],\n      extent[3],\n      extent[0],\n      extent[3],\n    ];\n  }\n  transformFn(coordinates, coordinates, 2);\n  const xs = [];\n  const ys = [];\n  for (let i = 0, l = coordinates.length; i < l; i += 2) {\n    xs.push(coordinates[i]);\n    ys.push(coordinates[i + 1]);\n  }\n  return _boundingExtentXYs(xs, ys, dest);\n}\n\n/**\n * Modifies the provided extent in-place to be within the real world\n * extent.\n *\n * @param {Extent} extent Extent.\n * @param {import(\"./proj/Projection.js\").default} projection Projection\n * @return {Extent} The extent within the real world extent.\n */\nexport function wrapX(extent, projection) {\n  const projectionExtent = projection.getExtent();\n  const center = getCenter(extent);\n  if (\n    projection.canWrapX() &&\n    (center[0] < projectionExtent[0] || center[0] >= projectionExtent[2])\n  ) {\n    const worldWidth = getWidth(projectionExtent);\n    const worldsAway = Math.floor(\n      (center[0] - projectionExtent[0]) / worldWidth,\n    );\n    const offset = worldsAway * worldWidth;\n    extent[0] -= offset;\n    extent[2] -= offset;\n  }\n  return extent;\n}\n\n/**\n * Fits the extent to the real world\n *\n * If the extent does not cross the anti meridian, this will return the extent in an array\n * If the extent crosses the anti meridian, the extent will be sliced, so each part fits within the\n * real world\n *\n *\n * @param {Extent} extent Extent.\n * @param {import(\"./proj/Projection.js\").default} projection Projection\n * @param {boolean} [multiWorld] Return all worlds\n * @return {Array<Extent>} The extent within the real world extent.\n */\nexport function wrapAndSliceX(extent, projection, multiWorld) {\n  if (projection.canWrapX()) {\n    const projectionExtent = projection.getExtent();\n\n    if (!isFinite(extent[0]) || !isFinite(extent[2])) {\n      return [[projectionExtent[0], extent[1], projectionExtent[2], extent[3]]];\n    }\n\n    wrapX(extent, projection);\n    const worldWidth = getWidth(projectionExtent);\n\n    if (getWidth(extent) > worldWidth && !multiWorld) {\n      // the extent wraps around on itself\n      return [[projectionExtent[0], extent[1], projectionExtent[2], extent[3]]];\n    }\n    if (extent[0] < projectionExtent[0]) {\n      // the extent crosses the anti meridian, so it needs to be sliced\n      return [\n        [extent[0] + worldWidth, extent[1], projectionExtent[2], extent[3]],\n        [projectionExtent[0], extent[1], extent[2], extent[3]],\n      ];\n    }\n    if (extent[2] > projectionExtent[2]) {\n      // the extent crosses the anti meridian, so it needs to be sliced\n      return [\n        [extent[0], extent[1], projectionExtent[2], extent[3]],\n        [projectionExtent[0], extent[1], extent[2] - worldWidth, extent[3]],\n      ];\n    }\n  }\n\n  return [extent];\n}\n","/**\n * @module ol/geom/flat/contains\n */\nimport {forEachCorner} from '../../extent.js';\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} Contains extent.\n */\nexport function linearRingContainsExtent(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  extent,\n) {\n  const outside = forEachCorner(\n    extent,\n    /**\n     * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n     * @return {boolean} Contains (x, y).\n     */\n    function (coordinate) {\n      return !linearRingContainsXY(\n        flatCoordinates,\n        offset,\n        end,\n        stride,\n        coordinate[0],\n        coordinate[1],\n      );\n    },\n  );\n  return !outside;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingContainsXY(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  x,\n  y,\n) {\n  // https://geomalgorithms.com/a03-_inclusion.html\n  // Copyright 2000 softSurfer, 2012 Dan Sunday\n  // This code may be freely used and modified for any purpose\n  // providing that this copyright notice is included with it.\n  // SoftSurfer makes no warranty for this code, and cannot be held\n  // liable for any real or imagined damage resulting from its use.\n  // Users of this code must verify correctness for their application.\n  let wn = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    if (y1 <= y) {\n      if (y2 > y && (x2 - x1) * (y - y1) - (x - x1) * (y2 - y1) > 0) {\n        wn++;\n      }\n    } else if (y2 <= y && (x2 - x1) * (y - y1) - (x - x1) * (y2 - y1) < 0) {\n      wn--;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return wn !== 0;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingsContainsXY(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  x,\n  y,\n) {\n  if (ends.length === 0) {\n    return false;\n  }\n  if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y)) {\n    return false;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (\n      linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y)\n    ) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingssContainsXY(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  x,\n  y,\n) {\n  if (endss.length === 0) {\n    return false;\n  }\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/interiorpoint\n */\nimport {ascending} from '../../array.js';\nimport {linearRingsContainsXY} from './contains.js';\n\n/**\n * Calculates a point that is likely to lie in the interior of the linear rings.\n * Inspired by JTS's com.vividsolutions.jts.geom.Geometry#getInteriorPoint.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array<number>} flatCenters Flat centers.\n * @param {number} flatCentersOffset Flat center offset.\n * @param {Array<number>} [dest] Destination.\n * @return {Array<number>} Destination point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointOfArray(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  flatCenters,\n  flatCentersOffset,\n  dest,\n) {\n  let i, ii, x, x1, x2, y1, y2;\n  const y = flatCenters[flatCentersOffset + 1];\n  /** @type {Array<number>} */\n  const intersections = [];\n  // Calculate intersections with the horizontal line\n  for (let r = 0, rr = ends.length; r < rr; ++r) {\n    const end = ends[r];\n    x1 = flatCoordinates[end - stride];\n    y1 = flatCoordinates[end - stride + 1];\n    for (i = offset; i < end; i += stride) {\n      x2 = flatCoordinates[i];\n      y2 = flatCoordinates[i + 1];\n      if ((y <= y1 && y2 <= y) || (y1 <= y && y <= y2)) {\n        x = ((y - y1) / (y2 - y1)) * (x2 - x1) + x1;\n        intersections.push(x);\n      }\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  // Find the longest segment of the horizontal line that has its center point\n  // inside the linear ring.\n  let pointX = NaN;\n  let maxSegmentLength = -Infinity;\n  intersections.sort(ascending);\n  x1 = intersections[0];\n  for (i = 1, ii = intersections.length; i < ii; ++i) {\n    x2 = intersections[i];\n    const segmentLength = Math.abs(x2 - x1);\n    if (segmentLength > maxSegmentLength) {\n      x = (x1 + x2) / 2;\n      if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n        pointX = x;\n        maxSegmentLength = segmentLength;\n      }\n    }\n    x1 = x2;\n  }\n  if (isNaN(pointX)) {\n    // There is no horizontal line that has its center point inside the linear\n    // ring.  Use the center of the the linear ring's extent.\n    pointX = flatCenters[flatCentersOffset];\n  }\n  if (dest) {\n    dest.push(pointX, y, maxSegmentLength);\n    return dest;\n  }\n  return [pointX, y, maxSegmentLength];\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array<number>} flatCenters Flat centers.\n * @return {Array<number>} Interior points as XYM coordinates, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointsOfMultiArray(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  flatCenters,\n) {\n  /** @type {Array<number>} */\n  let interiorPoints = [];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    interiorPoints = getInteriorPointOfArray(\n      flatCoordinates,\n      offset,\n      ends,\n      stride,\n      flatCenters,\n      2 * i,\n      interiorPoints,\n    );\n    offset = ends[ends.length - 1];\n  }\n  return interiorPoints;\n}\n","/**\n * @module ol/math\n */\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\nexport function clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n/**\n * Returns the square of the closest distance between the point (x, y) and the\n * line segment (x1, y1) to (x2, y2).\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredSegmentDistance(x, y, x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  if (dx !== 0 || dy !== 0) {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x1 = x2;\n      y1 = y2;\n    } else if (t > 0) {\n      x1 += dx * t;\n      y1 += dy * t;\n    }\n  }\n  return squaredDistance(x, y, x1, y1);\n}\n\n/**\n * Returns the square of the distance between the points (x1, y1) and (x2, y2).\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredDistance(x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  return dx * dx + dy * dy;\n}\n\n/**\n * Solves system of linear equations using Gaussian elimination method.\n *\n * @param {Array<Array<number>>} mat Augmented matrix (n x n + 1 column)\n *                                     in row-major order.\n * @return {Array<number>|null} The resulting vector.\n */\nexport function solveLinearSystem(mat) {\n  const n = mat.length;\n\n  for (let i = 0; i < n; i++) {\n    // Find max in the i-th column (ignoring i - 1 first rows)\n    let maxRow = i;\n    let maxEl = Math.abs(mat[i][i]);\n    for (let r = i + 1; r < n; r++) {\n      const absValue = Math.abs(mat[r][i]);\n      if (absValue > maxEl) {\n        maxEl = absValue;\n        maxRow = r;\n      }\n    }\n\n    if (maxEl === 0) {\n      return null; // matrix is singular\n    }\n\n    // Swap max row with i-th (current) row\n    const tmp = mat[maxRow];\n    mat[maxRow] = mat[i];\n    mat[i] = tmp;\n\n    // Subtract the i-th row to make all the remaining rows 0 in the i-th column\n    for (let j = i + 1; j < n; j++) {\n      const coef = -mat[j][i] / mat[i][i];\n      for (let k = i; k < n + 1; k++) {\n        if (i == k) {\n          mat[j][k] = 0;\n        } else {\n          mat[j][k] += coef * mat[i][k];\n        }\n      }\n    }\n  }\n\n  // Solve Ax=b for upper triangular matrix A (mat)\n  const x = new Array(n);\n  for (let l = n - 1; l >= 0; l--) {\n    x[l] = mat[l][n] / mat[l][l];\n    for (let m = l - 1; m >= 0; m--) {\n      mat[m][n] -= mat[m][l] * x[l];\n    }\n  }\n  return x;\n}\n\n/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return (angleInRadians * 180) / Math.PI;\n}\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return (angleInDegrees * Math.PI) / 180;\n}\n\n/**\n * Returns the modulo of a / b, depending on the sign of b.\n *\n * @param {number} a Dividend.\n * @param {number} b Divisor.\n * @return {number} Modulo.\n */\nexport function modulo(a, b) {\n  const r = a % b;\n  return r * b < 0 ? r + b : r;\n}\n\n/**\n * Calculates the linearly interpolated value of x between a and b.\n *\n * @param {number} a Number\n * @param {number} b Number\n * @param {number} x Value to be interpolated.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, x) {\n  return a + x * (b - a);\n}\n\n/**\n * Returns a number with a limited number of decimal digits.\n * @param {number} n The input number.\n * @param {number} decimals The maximum number of decimal digits.\n * @return {number} The input number with a limited number of decimal digits.\n */\nexport function toFixed(n, decimals) {\n  const factor = Math.pow(10, decimals);\n  return Math.round(n * factor) / factor;\n}\n\n/**\n * Rounds a number to the nearest integer value considering only the given number\n * of decimal digits (with rounding on the final digit).\n * @param {number} n The input number.\n * @param {number} decimals The maximum number of decimal digits.\n * @return {number} The nearest integer.\n */\nexport function round(n, decimals) {\n  return Math.round(toFixed(n, decimals));\n}\n\n/**\n * Rounds a number to the next smaller integer considering only the given number\n * of decimal digits (with rounding on the final digit).\n * @param {number} n The input number.\n * @param {number} decimals The maximum number of decimal digits.\n * @return {number} The next smaller integer.\n */\nexport function floor(n, decimals) {\n  return Math.floor(toFixed(n, decimals));\n}\n\n/**\n * Rounds a number to the next bigger integer considering only the given number\n * of decimal digits (with rounding on the final digit).\n * @param {number} n The input number.\n * @param {number} decimals The maximum number of decimal digits.\n * @return {number} The next bigger integer.\n */\nexport function ceil(n, decimals) {\n  return Math.ceil(toFixed(n, decimals));\n}\n\n/**\n * Wraps a number between some minimum and maximum values.\n * @param {number} n The number to wrap.\n * @param {number} min The minimum of the range (inclusive).\n * @param {number} max The maximum of the range (exclusive).\n * @return {number} The wrapped number.\n */\nexport function wrap(n, min, max) {\n  if (n >= min && n < max) {\n    return n;\n  }\n  const range = max - min;\n  return ((((n - min) % range) + range) % range) + min;\n}\n","/**\n * @module ol/geom/flat/interpolate\n */\nimport {binarySearch} from '../../array.js';\nimport {lerp} from '../../math.js';\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} fraction Fraction.\n * @param {Array<number>} [dest] Destination.\n * @param {number} [dimension] Destination dimension (default is `2`)\n * @return {Array<number>} Destination.\n */\nexport function interpolatePoint(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  fraction,\n  dest,\n  dimension,\n) {\n  let o, t;\n  const n = (end - offset) / stride;\n  if (n === 1) {\n    o = offset;\n  } else if (n === 2) {\n    o = offset;\n    t = fraction;\n  } else if (n !== 0) {\n    let x1 = flatCoordinates[offset];\n    let y1 = flatCoordinates[offset + 1];\n    let length = 0;\n    const cumulativeLengths = [0];\n    for (let i = offset + stride; i < end; i += stride) {\n      const x2 = flatCoordinates[i];\n      const y2 = flatCoordinates[i + 1];\n      length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      cumulativeLengths.push(length);\n      x1 = x2;\n      y1 = y2;\n    }\n    const target = fraction * length;\n    const index = binarySearch(cumulativeLengths, target);\n    if (index < 0) {\n      t =\n        (target - cumulativeLengths[-index - 2]) /\n        (cumulativeLengths[-index - 1] - cumulativeLengths[-index - 2]);\n      o = offset + (-index - 2) * stride;\n    } else {\n      o = offset + index * stride;\n    }\n  }\n  dimension = dimension > 1 ? dimension : 2;\n  dest = dest ? dest : new Array(dimension);\n  for (let i = 0; i < dimension; ++i) {\n    dest[i] =\n      o === undefined\n        ? NaN\n        : t === undefined\n          ? flatCoordinates[o + i]\n          : lerp(flatCoordinates[o + i], flatCoordinates[o + stride + i], t);\n  }\n  return dest;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @return {import(\"../../coordinate.js\").Coordinate|null} Coordinate.\n */\nexport function lineStringCoordinateAtM(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  m,\n  extrapolate,\n) {\n  if (end == offset) {\n    return null;\n  }\n  let coordinate;\n  if (m < flatCoordinates[offset + stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(offset, offset + stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    }\n    return null;\n  }\n  if (flatCoordinates[end - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(end - stride, end);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    }\n    return null;\n  }\n  // FIXME use O(1) search\n  if (m == flatCoordinates[offset + stride - 1]) {\n    return flatCoordinates.slice(offset, offset + stride);\n  }\n  let lo = offset / stride;\n  let hi = end / stride;\n  while (lo < hi) {\n    const mid = (lo + hi) >> 1;\n    if (m < flatCoordinates[(mid + 1) * stride - 1]) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n  const m0 = flatCoordinates[lo * stride - 1];\n  if (m == m0) {\n    return flatCoordinates.slice((lo - 1) * stride, (lo - 1) * stride + stride);\n  }\n  const m1 = flatCoordinates[(lo + 1) * stride - 1];\n  const t = (m - m0) / (m1 - m0);\n  coordinate = [];\n  for (let i = 0; i < stride - 1; ++i) {\n    coordinate.push(\n      lerp(\n        flatCoordinates[(lo - 1) * stride + i],\n        flatCoordinates[lo * stride + i],\n        t,\n      ),\n    );\n  }\n  coordinate.push(m);\n  return coordinate;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @param {boolean} interpolate Interpolate.\n * @return {import(\"../../coordinate.js\").Coordinate|null} Coordinate.\n */\nexport function lineStringsCoordinateAtM(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  m,\n  extrapolate,\n  interpolate,\n) {\n  if (interpolate) {\n    return lineStringCoordinateAtM(\n      flatCoordinates,\n      offset,\n      ends[ends.length - 1],\n      stride,\n      m,\n      extrapolate,\n    );\n  }\n  let coordinate;\n  if (m < flatCoordinates[stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(0, stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    }\n    return null;\n  }\n  if (flatCoordinates[flatCoordinates.length - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(flatCoordinates.length - stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    }\n    return null;\n  }\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    if (offset == end) {\n      continue;\n    }\n    if (m < flatCoordinates[offset + stride - 1]) {\n      return null;\n    }\n    if (m <= flatCoordinates[end - 1]) {\n      return lineStringCoordinateAtM(\n        flatCoordinates,\n        offset,\n        end,\n        stride,\n        m,\n        false,\n      );\n    }\n    offset = end;\n  }\n  return null;\n}\n","/**\n * @module ol/geom/flat/orient\n */\nimport {coordinates as reverseCoordinates} from './reverse.js';\n\n/**\n * Is the linear ring oriented clockwise in a coordinate system with a bottom-left\n * coordinate origin? For a coordinate system with a top-left coordinate origin,\n * the ring's orientation is clockwise when this function returns false.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean|undefined} Is clockwise.\n */\nexport function linearRingIsClockwise(flatCoordinates, offset, end, stride) {\n  // https://stackoverflow.com/q/1165647/clockwise-method#1165943\n  // https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrlinearring.cpp\n  let edge = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    edge += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  return edge === 0 ? undefined : edge > 0;\n}\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean} [right] Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingsAreOriented(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  right,\n) {\n  right = right !== undefined ? right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n    );\n    if (i === 0) {\n      if ((right && isClockwise) || (!right && !isClockwise)) {\n        return false;\n      }\n    } else {\n      if ((right && !isClockwise) || (!right && isClockwise)) {\n        return false;\n      }\n    }\n    offset = end;\n  }\n  return true;\n}\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean} [right] Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingssAreOriented(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  right,\n) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (!linearRingsAreOriented(flatCoordinates, offset, ends, stride, right)) {\n      return false;\n    }\n    if (ends.length) {\n      offset = ends[ends.length - 1];\n    }\n  }\n  return true;\n}\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {boolean} [right] Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRings(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  right,\n) {\n  right = right !== undefined ? right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n    );\n    const reverse =\n      i === 0\n        ? (right && isClockwise) || (!right && !isClockwise)\n        : (right && !isClockwise) || (!right && isClockwise);\n    if (reverse) {\n      reverseCoordinates(flatCoordinates, offset, end, stride);\n    }\n    offset = end;\n  }\n  return offset;\n}\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean} [right] Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRingsArray(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  right,\n) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = orientLinearRings(\n      flatCoordinates,\n      offset,\n      endss[i],\n      stride,\n      right,\n    );\n  }\n  return offset;\n}\n\n/**\n * Return a two-dimensional endss\n * @param {Array<number>} flatCoordinates Flat coordinates\n * @param {Array<number>} ends Linear ring end indexes\n * @return {Array<Array<number>>} Two dimensional endss array that can\n * be used to construct a MultiPolygon\n */\nexport function inflateEnds(flatCoordinates, ends) {\n  const endss = [];\n  let offset = 0;\n  let prevEndIndex = 0;\n  let startOrientation;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    // classifies an array of rings into polygons with outer rings and holes\n    const orientation = linearRingIsClockwise(flatCoordinates, offset, end, 2);\n    if (startOrientation === undefined) {\n      startOrientation = orientation;\n    }\n    if (orientation === startOrientation) {\n      endss.push(ends.slice(prevEndIndex, i + 1));\n    } else {\n      if (endss.length === 0) {\n        continue;\n      }\n      endss[endss.length - 1].push(ends[prevEndIndex]);\n    }\n    prevEndIndex = i + 1;\n    offset = end;\n  }\n  return endss;\n}\n","/**\n * @module ol/geom/flat/simplify\n */\n// Based on simplify-js https://github.com/mourner/simplify-js\n// Copyright (c) 2012, Vladimir Agafonkin\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n//    1. Redistributions of source code must retain the above copyright notice,\n//       this list of conditions and the following disclaimer.\n//\n//    2. Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n// POSSIBILITY OF SUCH DAMAGE.\n\nimport {squaredDistance, squaredSegmentDistance} from '../../math.js';\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {boolean} highQuality Highest quality.\n * @param {Array<number>} [simplifiedFlatCoordinates] Simplified flat\n *     coordinates.\n * @return {Array<number>} Simplified line string.\n */\nexport function simplifyLineString(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  squaredTolerance,\n  highQuality,\n  simplifiedFlatCoordinates,\n) {\n  simplifiedFlatCoordinates =\n    simplifiedFlatCoordinates !== undefined ? simplifiedFlatCoordinates : [];\n  if (!highQuality) {\n    end = radialDistance(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      squaredTolerance,\n      simplifiedFlatCoordinates,\n      0,\n    );\n    flatCoordinates = simplifiedFlatCoordinates;\n    offset = 0;\n    stride = 2;\n  }\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    flatCoordinates,\n    offset,\n    end,\n    stride,\n    squaredTolerance,\n    simplifiedFlatCoordinates,\n    0,\n  );\n  return simplifiedFlatCoordinates;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function douglasPeucker(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  squaredTolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n) {\n  const n = (end - offset) / stride;\n  if (n < 3) {\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n        flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  /** @type {Array<number>} */\n  const markers = new Array(n);\n  markers[0] = 1;\n  markers[n - 1] = 1;\n  /** @type {Array<number>} */\n  const stack = [offset, end - stride];\n  let index = 0;\n  while (stack.length > 0) {\n    const last = stack.pop();\n    const first = stack.pop();\n    let maxSquaredDistance = 0;\n    const x1 = flatCoordinates[first];\n    const y1 = flatCoordinates[first + 1];\n    const x2 = flatCoordinates[last];\n    const y2 = flatCoordinates[last + 1];\n    for (let i = first + stride; i < last; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      const squaredDistance = squaredSegmentDistance(x, y, x1, y1, x2, y2);\n      if (squaredDistance > maxSquaredDistance) {\n        index = i;\n        maxSquaredDistance = squaredDistance;\n      }\n    }\n    if (maxSquaredDistance > squaredTolerance) {\n      markers[(index - offset) / stride] = 1;\n      if (first + stride < index) {\n        stack.push(first, index);\n      }\n      if (index + stride < last) {\n        stack.push(index, last);\n      }\n    }\n  }\n  for (let i = 0; i < n; ++i) {\n    if (markers[i]) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n        flatCoordinates[offset + i * stride];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n        flatCoordinates[offset + i * stride + 1];\n    }\n  }\n  return simplifiedOffset;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerArray(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  squaredTolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n  simplifiedEnds,\n) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = douglasPeucker(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      squaredTolerance,\n      simplifiedFlatCoordinates,\n      simplifiedOffset,\n    );\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<Array<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerMultiArray(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  squaredTolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n  simplifiedEndss,\n) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    /** @type {Array<number>} */\n    const simplifiedEnds = [];\n    simplifiedOffset = douglasPeuckerArray(\n      flatCoordinates,\n      offset,\n      ends,\n      stride,\n      squaredTolerance,\n      simplifiedFlatCoordinates,\n      simplifiedOffset,\n      simplifiedEnds,\n    );\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function radialDistance(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  squaredTolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n) {\n  if (end <= offset + stride) {\n    // zero or one point, no simplification possible, so copy and return\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n        flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  // copy first point\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  let x2 = x1;\n  let y2 = y1;\n  for (offset += stride; offset < end; offset += stride) {\n    x2 = flatCoordinates[offset];\n    y2 = flatCoordinates[offset + 1];\n    if (squaredDistance(x1, y1, x2, y2) > squaredTolerance) {\n      // copy point at offset\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  if (x2 != x1 || y2 != y1) {\n    // copy last point\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  }\n  return simplifiedOffset;\n}\n\n/**\n * @param {number} value Value.\n * @param {number} tolerance Tolerance.\n * @return {number} Rounded value.\n */\nexport function snap(value, tolerance) {\n  return tolerance * Math.round(value / tolerance);\n}\n\n/**\n * Simplifies a line string using an algorithm designed by Tim Schaub.\n * Coordinates are snapped to the nearest value in a virtual grid and\n * consecutive duplicate coordinates are discarded.  This effectively preserves\n * topology as the simplification of any subsection of a line string is\n * independent of the rest of the line string.  This means that, for examples,\n * the common edge between two polygons will be simplified to the same line\n * string independently in both polygons.  This implementation uses a single\n * pass over the coordinates and eliminates intermediate collinear points.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function quantize(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  tolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n) {\n  // do nothing if the line is empty\n  if (offset == end) {\n    return simplifiedOffset;\n  }\n  // snap the first coordinate (P1)\n  let x1 = snap(flatCoordinates[offset], tolerance);\n  let y1 = snap(flatCoordinates[offset + 1], tolerance);\n  offset += stride;\n  // add the first coordinate to the output\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  // find the next coordinate that does not snap to the same value as the first\n  // coordinate (P2)\n  let x2, y2;\n  do {\n    x2 = snap(flatCoordinates[offset], tolerance);\n    y2 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    if (offset == end) {\n      // all coordinates snap to the same value, the line collapses to a point\n      // push the last snapped value anyway to ensure that the output contains\n      // at least two points\n      // FIXME should we really return at least two points anyway?\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      return simplifiedOffset;\n    }\n  } while (x2 == x1 && y2 == y1);\n  while (offset < end) {\n    // snap the next coordinate (P3)\n    const x3 = snap(flatCoordinates[offset], tolerance);\n    const y3 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    // skip P3 if it is equal to P2\n    if (x3 == x2 && y3 == y2) {\n      continue;\n    }\n    // calculate the delta between P1 and P2\n    const dx1 = x2 - x1;\n    const dy1 = y2 - y1;\n    // calculate the delta between P3 and P1\n    const dx2 = x3 - x1;\n    const dy2 = y3 - y1;\n    // if P1, P2, and P3 are colinear and P3 is further from P1 than P2 is from\n    // P1 in the same direction then P2 is on the straight line between P1 and\n    // P3\n    if (\n      dx1 * dy2 == dy1 * dx2 &&\n      ((dx1 < 0 && dx2 < dx1) || dx1 == dx2 || (dx1 > 0 && dx2 > dx1)) &&\n      ((dy1 < 0 && dy2 < dy1) || dy1 == dy2 || (dy1 > 0 && dy2 > dy1))\n    ) {\n      // discard P2 and set P2 = P3\n      x2 = x3;\n      y2 = y3;\n      continue;\n    }\n    // either P1, P2, and P3 are not colinear, or they are colinear but P3 is\n    // between P3 and P1 or on the opposite half of the line to P2.  add P2,\n    // and continue with P1 = P2 and P2 = P3\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n    x1 = x2;\n    y1 = y2;\n    x2 = x3;\n    y2 = y3;\n  }\n  // add the last point (P2)\n  simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  return simplifiedOffset;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function quantizeArray(\n  flatCoordinates,\n  offset,\n  ends,\n  stride,\n  tolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n  simplifiedEnds,\n) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = quantize(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      tolerance,\n      simplifiedFlatCoordinates,\n      simplifiedOffset,\n    );\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<Array<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function quantizeMultiArray(\n  flatCoordinates,\n  offset,\n  endss,\n  stride,\n  tolerance,\n  simplifiedFlatCoordinates,\n  simplifiedOffset,\n  simplifiedEndss,\n) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    /** @type {Array<number>} */\n    const simplifiedEnds = [];\n    simplifiedOffset = quantizeArray(\n      flatCoordinates,\n      offset,\n      ends,\n      stride,\n      tolerance,\n      simplifiedFlatCoordinates,\n      simplifiedOffset,\n      simplifiedEnds,\n    );\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n","/**\n * @module ol/proj/Units\n */\n\n/**\n * @typedef {'radians' | 'degrees' | 'ft' | 'm' | 'pixels' | 'tile-pixels' | 'us-ft'} Units\n * Projection units.\n */\n\n/**\n * See http://duff.ess.washington.edu/data/raster/drg/docs/geotiff.txt\n * @type {Object<number, Units>}\n */\nconst unitByCode = {\n  '9001': 'm',\n  '9002': 'ft',\n  '9003': 'us-ft',\n  '9101': 'radians',\n  '9102': 'degrees',\n};\n\n/**\n * @param {number} code Unit code.\n * @return {Units} Units.\n */\nexport function fromCode(code) {\n  return unitByCode[code];\n}\n\n/**\n * @typedef {Object} MetersPerUnitLookup\n * @property {number} radians Radians\n * @property {number} degrees Degrees\n * @property {number} ft  Feet\n * @property {number} m Meters\n * @property {number} us-ft US feet\n */\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {MetersPerUnitLookup}\n * @api\n */\nexport const METERS_PER_UNIT = {\n  // use the radius of the Normal sphere\n  'radians': 6370997 / (2 * Math.PI),\n  'degrees': (2 * Math.PI * 6370997) / 360,\n  'ft': 0.3048,\n  'm': 1,\n  'us-ft': 1200 / 3937,\n};\n","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from './Units.js';\n\n/**\n * The function is called with a `number` view resolution and a\n * {@link module:ol/coordinate~Coordinate} as arguments, and returns the `number` resolution\n * in projection units at the passed coordinate.\n * @typedef {function(number, import(\"../coordinate.js\").Coordinate):number} GetPointResolution\n * @api\n */\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {import(\"./Units.js\").Units} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {import(\"../extent.js\").Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link METERS_PER_UNIT}\n * lookup table.\n * @property {import(\"../extent.js\").Extent} [worldExtent] The world extent for the SRS.\n * @property {GetPointResolution} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `number` view resolution and a {@link module:ol/coordinate~Coordinate} as arguments, and returns\n * the `number` resolution in projection units at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj.getPointResolution} function will be used.\n */\n\n/**\n * @classdesc\n * In most cases, you should not need to create instances of this class.\n * Instead, where projection information is required, you can use a string\n * projection code or identifier (e.g. `EPSG:4326`) instead of a projection\n * instance.\n *\n * The library includes support for transforming coordinates between the following\n * projections:\n *\n *  WGS 84 / Geographic - Using codes `EPSG:4326`, `CRS:84`, `urn:ogc:def:crs:EPSG:6.6:4326`,\n *    `urn:ogc:def:crs:OGC:1.3:CRS84`, `urn:ogc:def:crs:OGC:2:84`, `http://www.opengis.net/gml/srs/epsg.xml#4326`,\n *    or `urn:x-ogc:def:crs:EPSG:4326`\n *  WGS 84 / Spherical Mercator - Using codes `EPSG:3857`, `EPSG:102100`, `EPSG:102113`, `EPSG:900913`,\n *    `urn:ogc:def:crs:EPSG:6.18:3:3857`, or `http://www.opengis.net/gml/srs/epsg.xml#3857`\n *  WGS 84 / UTM zones - Using codes `EPSG:32601` through `EPSG:32660` for northern zones\n *    and `EPSG:32701` through `EPSG:32760` for southern zones. Note that the built-in UTM transforms\n *    are lower accuracy (with errors on the order of 0.1 m) than those that you might get in a\n *    library like [proj4js](https://github.com/proj4js/proj4js).\n *\n * For additional projection support, or to use higher accuracy transforms than the built-in ones, you can use\n * the [proj4js](https://github.com/proj4js/proj4js) library. With `proj4js`, after adding any new projection\n * definitions, call the {@link module:ol/proj/proj4.register} function.\n *\n * You can use the {@link module:ol/proj.get} function to retrieve a projection instance\n * for one of the registered projections.\n *\n * @api\n */\nclass Projection {\n  /**\n   * @param {Options} options Projection options.\n   */\n  constructor(options) {\n    /**\n     * @private\n     * @type {string}\n     */\n    this.code_ = options.code;\n\n    /**\n     * Units of projected coordinates. When set to `TILE_PIXELS`, a\n     * `this.extent_` and `this.worldExtent_` must be configured properly for each\n     * tile.\n     * @private\n     * @type {import(\"./Units.js\").Units}\n     */\n    this.units_ = /** @type {import(\"./Units.js\").Units} */ (options.units);\n\n    /**\n     * Validity extent of the projection in projected coordinates. For projections\n     * with `TILE_PIXELS` units, this is the extent of the tile in\n     * tile pixel space.\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.extent_ = options.extent !== undefined ? options.extent : null;\n\n    /**\n     * Extent of the world in EPSG:4326. For projections with\n     * `TILE_PIXELS` units, this is the extent of the tile in\n     * projected coordinate space.\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.worldExtent_ =\n      options.worldExtent !== undefined ? options.worldExtent : null;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.axisOrientation_ =\n      options.axisOrientation !== undefined ? options.axisOrientation : 'enu';\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.global_ = options.global !== undefined ? options.global : false;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.canWrapX_ = !!(this.global_ && this.extent_);\n\n    /**\n     * @private\n     * @type {GetPointResolution|undefined}\n     */\n    this.getPointResolutionFunc_ = options.getPointResolution;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.defaultTileGrid_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.metersPerUnit_ = options.metersPerUnit;\n  }\n\n  /**\n   * @return {boolean} The projection is suitable for wrapping the x-axis\n   */\n  canWrapX() {\n    return this.canWrapX_;\n  }\n\n  /**\n   * Get the code for this projection, e.g. 'EPSG:4326'.\n   * @return {string} Code.\n   * @api\n   */\n  getCode() {\n    return this.code_;\n  }\n\n  /**\n   * Get the validity extent for this projection.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent() {\n    return this.extent_;\n  }\n\n  /**\n   * Get the units of this projection.\n   * @return {import(\"./Units.js\").Units} Units.\n   * @api\n   */\n  getUnits() {\n    return this.units_;\n  }\n\n  /**\n   * Get the amount of meters per unit of this projection.  If the projection is\n   * not configured with `metersPerUnit` or a units identifier, the return is\n   * `undefined`.\n   * @return {number|undefined} Meters.\n   * @api\n   */\n  getMetersPerUnit() {\n    return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n  }\n\n  /**\n   * Get the world extent for this projection.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getWorldExtent() {\n    return this.worldExtent_;\n  }\n\n  /**\n   * Get the axis orientation of this projection.\n   * Example values are:\n   * enu - the default easting, northing, elevation.\n   * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n   *     or south orientated transverse mercator.\n   * wnu - westing, northing, up - some planetary coordinate systems have\n   *     \"west positive\" coordinate systems\n   * @return {string} Axis orientation.\n   * @api\n   */\n  getAxisOrientation() {\n    return this.axisOrientation_;\n  }\n\n  /**\n   * Is this projection a global projection which spans the whole world?\n   * @return {boolean} Whether the projection is global.\n   * @api\n   */\n  isGlobal() {\n    return this.global_;\n  }\n\n  /**\n   * Set if the projection is a global projection which spans the whole world\n   * @param {boolean} global Whether the projection is global.\n   * @api\n   */\n  setGlobal(global) {\n    this.global_ = global;\n    this.canWrapX_ = !!(global && this.extent_);\n  }\n\n  /**\n   * @return {import(\"../tilegrid/TileGrid.js\").default} The default tile grid.\n   */\n  getDefaultTileGrid() {\n    return this.defaultTileGrid_;\n  }\n\n  /**\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tileGrid The default tile grid.\n   */\n  setDefaultTileGrid(tileGrid) {\n    this.defaultTileGrid_ = tileGrid;\n  }\n\n  /**\n   * Set the validity extent for this projection.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @api\n   */\n  setExtent(extent) {\n    this.extent_ = extent;\n    this.canWrapX_ = !!(this.global_ && extent);\n  }\n\n  /**\n   * Set the world extent for this projection.\n   * @param {import(\"../extent.js\").Extent} worldExtent World extent\n   *     [minlon, minlat, maxlon, maxlat].\n   * @api\n   */\n  setWorldExtent(worldExtent) {\n    this.worldExtent_ = worldExtent;\n  }\n\n  /**\n   * Set the getPointResolution function (see {@link module:ol/proj.getPointResolution}\n   * for this projection.\n   * @param {function(number, import(\"../coordinate.js\").Coordinate):number} func Function\n   * @api\n   */\n  setGetPointResolution(func) {\n    this.getPointResolutionFunc_ = func;\n  }\n\n  /**\n   * Get the custom point resolution function for this projection (if set).\n   * @return {GetPointResolution|undefined} The custom point\n   * resolution function (if set).\n   */\n  getPointResolutionFunc() {\n    return this.getPointResolutionFunc_;\n  }\n}\n\nexport default Projection;\n","/**\n * @module ol/proj/epsg3857\n */\nimport Projection from './Projection.js';\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n/**\n * @const\n * @type {number}\n */\nexport const HALF_SIZE = Math.PI * RADIUS;\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const EXTENT = [-HALF_SIZE, -HALF_SIZE, HALF_SIZE, HALF_SIZE];\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const WORLD_EXTENT = [-180, -85, 180, 85];\n\n/**\n * Maximum safe value in y direction\n * @const\n * @type {number}\n */\nexport const MAX_SAFE_Y = RADIUS * Math.log(Math.tan(Math.PI / 2));\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n */\nclass EPSG3857Projection extends Projection {\n  /**\n   * @param {string} code Code.\n   */\n  constructor(code) {\n    super({\n      code: code,\n      units: 'm',\n      extent: EXTENT,\n      global: true,\n      worldExtent: WORLD_EXTENT,\n      getPointResolution: function (resolution, point) {\n        return resolution / Math.cosh(point[1] / RADIUS);\n      },\n    });\n  }\n}\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport const PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('http://www.opengis.net/def/crs/EPSG/0/3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857'),\n];\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>} [output] Output array of coordinate values.\n * @param {number} [dimension] Dimension (default is `2`).\n * @param {number} [stride] Stride (default is `dimension`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, output, dimension, stride) {\n  const length = input.length;\n  dimension = dimension > 1 ? dimension : 2;\n  stride = stride ?? dimension;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += stride) {\n    output[i] = (HALF_SIZE * input[i]) / 180;\n    let y = RADIUS * Math.log(Math.tan((Math.PI * (+input[i + 1] + 90)) / 360));\n    if (y > MAX_SAFE_Y) {\n      y = MAX_SAFE_Y;\n    } else if (y < -MAX_SAFE_Y) {\n      y = -MAX_SAFE_Y;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>} [output] Output array of coordinate values.\n * @param {number} [dimension] Dimension (default is `2`).\n * @param {number} [stride] Stride (default is `dimension`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, output, dimension, stride) {\n  const length = input.length;\n  dimension = dimension > 1 ? dimension : 2;\n  stride = stride ?? dimension;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += stride) {\n    output[i] = (180 * input[i]) / HALF_SIZE;\n    output[i + 1] =\n      (360 * Math.atan(Math.exp(input[i + 1] / RADIUS))) / Math.PI - 90;\n  }\n  return output;\n}\n","/**\n * @module ol/proj/epsg4326\n */\nimport Projection from './Projection.js';\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const EXTENT = [-180, -90, 180, 90];\n\n/**\n * @const\n * @type {number}\n */\nexport const METERS_PER_UNIT = (Math.PI * RADIUS) / 180;\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n */\nclass EPSG4326Projection extends Projection {\n  /**\n   * @param {string} code Code.\n   * @param {string} [axisOrientation] Axis orientation.\n   */\n  constructor(code, axisOrientation) {\n    super({\n      code: code,\n      units: 'degrees',\n      extent: EXTENT,\n      axisOrientation: axisOrientation,\n      global: true,\n      metersPerUnit: METERS_PER_UNIT,\n      worldExtent: EXTENT,\n    });\n  }\n}\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport const PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/def/crs/OGC/1.3/CRS84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('http://www.opengis.net/def/crs/EPSG/0/4326', 'neu'),\n];\n","/**\n * @module ol/proj/projections\n */\n\n/**\n * @type {Object<string, import(\"./Projection.js\").default>}\n */\nlet cache = {};\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {import(\"./Projection.js\").default|null} The projection (if cached).\n */\nexport function get(code) {\n  return (\n    cache[code] ||\n    cache[code.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\\w+)$/, 'EPSG:$3')] ||\n    null\n  );\n}\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {import(\"./Projection.js\").default} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n/**\n * @private\n * @type {!Object<string, Object<string, import(\"../proj.js\").TransformFunction>>}\n */\nlet transforms = {};\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {import(\"./Projection.js\").default} source Source.\n * @param {import(\"./Projection.js\").default} destination Destination.\n * @param {import(\"../proj.js\").TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {import(\"./Projection.js\").default} source Source projection.\n * @param {import(\"./Projection.js\").default} destination Destination projection.\n * @return {import(\"../proj.js\").TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  const transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {import(\"../proj.js\").TransformFunction|null} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    return transforms[sourceCode][destinationCode];\n  }\n  return null;\n}\n","/**\n * @module ol/proj/utm\n */\n\n/**\n * Adapted from https://github.com/Turbo87/utm\n * Copyright (c) 2012-2017 Tobias Bieniek\n *\n * The functions here provide approximate transforms to and from UTM.\n * They are not appropriate for use beyond the validity extend of a UTM\n * zone, and the accuracy of the transform decreases toward the zone\n * edges.\n */\n\nimport {toDegrees, toRadians, wrap} from '../math.js';\nimport Projection from './Projection.js';\n\n/**\n * @typedef {Object} UTMZone\n * @property {number} number The zone number (1 - 60).\n * @property {boolean} north The northern hemisphere.\n */\n\nconst K0 = 0.9996;\n\nconst E = 0.00669438;\nconst E2 = E * E;\nconst E3 = E2 * E;\nconst E_P2 = E / (1 - E);\n\nconst SQRT_E = Math.sqrt(1 - E);\nconst _E = (1 - SQRT_E) / (1 + SQRT_E);\nconst _E2 = _E * _E;\nconst _E3 = _E2 * _E;\nconst _E4 = _E3 * _E;\nconst _E5 = _E4 * _E;\n\nconst M1 = 1 - E / 4 - (3 * E2) / 64 - (5 * E3) / 256;\nconst M2 = (3 * E) / 8 + (3 * E2) / 32 + (45 * E3) / 1024;\nconst M3 = (15 * E2) / 256 + (45 * E3) / 1024;\nconst M4 = (35 * E3) / 3072;\n\nconst P2 = (3 / 2) * _E - (27 / 32) * _E3 + (269 / 512) * _E5;\nconst P3 = (21 / 16) * _E2 - (55 / 32) * _E4;\nconst P4 = (151 / 96) * _E3 - (417 / 128) * _E5;\nconst P5 = (1097 / 512) * _E4;\n\nconst R = 6378137;\n\n/**\n * @param {number} easting Easting value of coordinate.\n * @param {number} northing Northing value of coordinate.\n * @param {UTMZone} zone The UTM zone.\n * @return {import(\"../coordinate.js\").Coordinate} The transformed coordinate.\n */\nfunction toLonLat(easting, northing, zone) {\n  const x = easting - 500000;\n  const y = zone.north ? northing : northing - 10000000;\n\n  const m = y / K0;\n  const mu = m / (R * M1);\n\n  const pRad =\n    mu +\n    P2 * Math.sin(2 * mu) +\n    P3 * Math.sin(4 * mu) +\n    P4 * Math.sin(6 * mu) +\n    P5 * Math.sin(8 * mu);\n\n  const pSin = Math.sin(pRad);\n  const pSin2 = pSin * pSin;\n\n  const pCos = Math.cos(pRad);\n\n  const pTan = pSin / pCos;\n  const pTan2 = pTan * pTan;\n  const pTan4 = pTan2 * pTan2;\n\n  const epSin = 1 - E * pSin2;\n  const epSinSqrt = Math.sqrt(1 - E * pSin2);\n\n  const n = R / epSinSqrt;\n  const r = (1 - E) / epSin;\n\n  const c = E_P2 * pCos ** 2;\n  const c2 = c * c;\n\n  const d = x / (n * K0);\n  const d2 = d * d;\n  const d3 = d2 * d;\n  const d4 = d3 * d;\n  const d5 = d4 * d;\n  const d6 = d5 * d;\n\n  const latitude =\n    pRad -\n    (pTan / r) *\n      (d2 / 2 - (d4 / 24) * (5 + 3 * pTan2 + 10 * c - 4 * c2 - 9 * E_P2)) +\n    (d6 / 720) * (61 + 90 * pTan2 + 298 * c + 45 * pTan4 - 252 * E_P2 - 3 * c2);\n\n  let longitude =\n    (d -\n      (d3 / 6) * (1 + 2 * pTan2 + c) +\n      (d5 / 120) * (5 - 2 * c + 28 * pTan2 - 3 * c2 + 8 * E_P2 + 24 * pTan4)) /\n    pCos;\n\n  longitude = wrap(\n    longitude + toRadians(zoneToCentralLongitude(zone.number)),\n    -Math.PI,\n    Math.PI,\n  );\n\n  return [toDegrees(longitude), toDegrees(latitude)];\n}\n\nconst MIN_LATITUDE = -80;\nconst MAX_LATITUDE = 84;\nconst MIN_LONGITUDE = -180;\nconst MAX_LONGITUDE = 180;\n\n/**\n * @param {number} longitude The longitude.\n * @param {number} latitude The latitude.\n * @param {UTMZone} zone The UTM zone.\n * @return {import('../coordinate.js').Coordinate} The UTM coordinate.\n */\nfunction fromLonLat(longitude, latitude, zone) {\n  longitude = wrap(longitude, MIN_LONGITUDE, MAX_LONGITUDE);\n\n  if (latitude < MIN_LATITUDE) {\n    latitude = MIN_LATITUDE;\n  } else if (latitude > MAX_LATITUDE) {\n    latitude = MAX_LATITUDE;\n  }\n\n  const latRad = toRadians(latitude);\n  const latSin = Math.sin(latRad);\n  const latCos = Math.cos(latRad);\n\n  const latTan = latSin / latCos;\n  const latTan2 = latTan * latTan;\n  const latTan4 = latTan2 * latTan2;\n\n  const lonRad = toRadians(longitude);\n  const centralLon = zoneToCentralLongitude(zone.number);\n  const centralLonRad = toRadians(centralLon);\n\n  const n = R / Math.sqrt(1 - E * latSin ** 2);\n  const c = E_P2 * latCos ** 2;\n\n  const a = latCos * wrap(lonRad - centralLonRad, -Math.PI, Math.PI);\n  const a2 = a * a;\n  const a3 = a2 * a;\n  const a4 = a3 * a;\n  const a5 = a4 * a;\n  const a6 = a5 * a;\n\n  const m =\n    R *\n    (M1 * latRad -\n      M2 * Math.sin(2 * latRad) +\n      M3 * Math.sin(4 * latRad) -\n      M4 * Math.sin(6 * latRad));\n\n  const easting =\n    K0 *\n      n *\n      (a +\n        (a3 / 6) * (1 - latTan2 + c) +\n        (a5 / 120) * (5 - 18 * latTan2 + latTan4 + 72 * c - 58 * E_P2)) +\n    500000;\n\n  let northing =\n    K0 *\n    (m +\n      n *\n        latTan *\n        (a2 / 2 +\n          (a4 / 24) * (5 - latTan2 + 9 * c + 4 * c ** 2) +\n          (a6 / 720) * (61 - 58 * latTan2 + latTan4 + 600 * c - 330 * E_P2)));\n\n  if (!zone.north) {\n    northing += 10000000;\n  }\n\n  return [easting, northing];\n}\n\n/**\n * @param {number} zone The zone number.\n * @return {number} The central longitude in degrees.\n */\nfunction zoneToCentralLongitude(zone) {\n  return (zone - 1) * 6 - 180 + 3;\n}\n\n/**\n * @type {Array<RegExp>}\n */\nconst epsgRegExes = [\n  /^EPSG:(\\d+)$/,\n  /^urn:ogc:def:crs:EPSG::(\\d+)$/,\n  /^http:\\/\\/www\\.opengis\\.net\\/def\\/crs\\/EPSG\\/0\\/(\\d+)$/,\n];\n\n/**\n * @param {string} code The projection code.\n * @return {UTMZone|null} The UTM zone info (or null if not UTM).\n */\nexport function zoneFromCode(code) {\n  let epsgId = 0;\n  for (const re of epsgRegExes) {\n    const match = code.match(re);\n    if (match) {\n      epsgId = parseInt(match[1]);\n      break;\n    }\n  }\n  if (!epsgId) {\n    return null;\n  }\n\n  let number = 0;\n  let north = false;\n  if (epsgId > 32700 && epsgId < 32761) {\n    number = epsgId - 32700;\n  } else if (epsgId > 32600 && epsgId < 32661) {\n    north = true;\n    number = epsgId - 32600;\n  }\n  if (!number) {\n    return null;\n  }\n\n  return {number, north};\n}\n\n/**\n * @param {function(number, number, UTMZone): import('../coordinate.js').Coordinate} transformer The transformer.\n * @param {UTMZone} zone The UTM zone.\n * @return {import('../proj.js').TransformFunction} The transform function.\n */\nfunction makeTransformFunction(transformer, zone) {\n  return function (input, output, dimension, stride) {\n    const length = input.length;\n    dimension = dimension > 1 ? dimension : 2;\n    stride = stride ?? dimension;\n    if (!output) {\n      if (dimension > 2) {\n        output = input.slice();\n      } else {\n        output = new Array(length);\n      }\n    }\n    for (let i = 0; i < length; i += stride) {\n      const x = input[i];\n      const y = input[i + 1];\n      const coord = transformer(x, y, zone);\n      output[i] = coord[0];\n      output[i + 1] = coord[1];\n    }\n    return output;\n  };\n}\n\n/**\n * @param {string} code The projection code.\n * @return {import('./Projection.js').default|null} A projection or null if unable to create one.\n */\nexport function makeProjection(code) {\n  const zone = zoneFromCode(code);\n  if (!zone) {\n    return null;\n  }\n  return new Projection({code, units: 'm'});\n}\n\n/**\n * @param {import('./Projection.js').default} projection The projection.\n * @return {import('../proj.js').Transforms|null} The transforms lookup or null if unable to handle projection.\n */\nexport function makeTransforms(projection) {\n  const zone = zoneFromCode(projection.getCode());\n  if (!zone) {\n    return null;\n  }\n\n  return {\n    forward: makeTransformFunction(fromLonLat, zone),\n    inverse: makeTransformFunction(toLonLat, zone),\n  };\n}\n","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * a list of {@link module:ol/proj/Projection~Projection}\n * objects, one for each projection supported by the application\n * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the http://proj4js.org/\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * https://epsg.io/, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj.addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection~Projection} object for the new projection and add it with\n * {@link module:ol/proj.addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj.addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection~Projection} with\n * {@link module:ol/proj.addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {warn} from './console.js';\nimport {equals, getWorldsAway} from './coordinate.js';\nimport {applyTransform, getWidth} from './extent.js';\nimport {clamp, modulo} from './math.js';\nimport Projection from './proj/Projection.js';\nimport {METERS_PER_UNIT} from './proj/Units.js';\nimport {\n  PROJECTIONS as EPSG3857_PROJECTIONS,\n  fromEPSG4326,\n  toEPSG4326,\n} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport {\n  add as addProj,\n  clear as clearProj,\n  get as getProj,\n} from './proj/projections.js';\nimport {\n  add as addTransformFunc,\n  clear as clearTransformFuncs,\n  get as getTransformFunc,\n} from './proj/transforms.js';\nimport {\n  makeProjection as makeUTMProjection,\n  makeTransforms as makeUTMTransforms,\n} from './proj/utm.js';\nimport {getDistance} from './sphere.js';\n\n/**\n * A projection as {@link module:ol/proj/Projection~Projection}, SRS identifier\n * string or undefined.\n * @typedef {Projection|string|undefined} ProjectionLike\n * @api\n */\n\n/**\n * @typedef {Object} Transforms\n * @property {TransformFunction} forward The forward transform (from geographic).\n * @property {TransformFunction} inverse The inverse transform (to geographic).\n */\n\n/**\n * @type {Array<function(Projection): Transforms|null>}\n */\nconst transformFactories = [makeUTMTransforms];\n\n/**\n * @type {Array<function(string): Projection|null>}\n */\nconst projectionFactories = [makeUTMProjection];\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @callback TransformFunction\n * @param {Array<number>} input\n * @param {Array<number>} [output]\n * @param {number} [dimension]\n * @param {number} [stride]\n * @return {Array<number>}\n *\n * @api\n */\n\nexport {METERS_PER_UNIT};\n\nexport {Projection};\n\nlet showCoordinateWarning = true;\n\n/**\n * @param {boolean} [disable] Disable console info about `useGeographic()`\n */\nexport function disableCoordinateWarning(disable) {\n  const hide = disable === undefined ? true : disable;\n  showCoordinateWarning = !hide;\n}\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>} [output] Output array of coordinate values.\n * @return {Array<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, output) {\n  if (output !== undefined) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      output[i] = input[i];\n    }\n    output = output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>} [output] Output array of coordinate values.\n * @return {Array<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, output) {\n  if (output !== undefined && input !== output) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      output[i] = input[i];\n    }\n    input = output;\n  }\n  return input;\n}\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  addProj(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n/**\n * @param {Array<Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {Projection|null} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  if (!(typeof projectionLike === 'string')) {\n    return projectionLike;\n  }\n  const projection = getProj(projectionLike);\n  if (projection) {\n    return projection;\n  }\n  for (const makeProjection of projectionFactories) {\n    const projection = makeProjection(projectionLike);\n    if (projection) {\n      return projection;\n    }\n  }\n  return null;\n}\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the `point` pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {import(\"./coordinate.js\").Coordinate} point Point to find adjusted resolution at.\n * @param {import(\"./proj/Units.js\").Units} [units] Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, units) {\n  projection = get(projection);\n  let pointResolution;\n  const getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n    if (units && units !== projection.getUnits()) {\n      const metersPerUnit = projection.getMetersPerUnit();\n      if (metersPerUnit) {\n        pointResolution =\n          (pointResolution * metersPerUnit) / METERS_PER_UNIT[units];\n      }\n    }\n  } else {\n    const projUnits = projection.getUnits();\n    if ((projUnits == 'degrees' && !units) || units == 'degrees') {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      const toEPSG4326 = getTransformFromProjections(\n        projection,\n        get('EPSG:4326'),\n      );\n      if (!toEPSG4326 && projUnits !== 'degrees') {\n        // no transform is available\n        pointResolution = resolution * projection.getMetersPerUnit();\n      } else {\n        let vertices = [\n          point[0] - resolution / 2,\n          point[1],\n          point[0] + resolution / 2,\n          point[1],\n          point[0],\n          point[1] - resolution / 2,\n          point[0],\n          point[1] + resolution / 2,\n        ];\n        vertices = toEPSG4326(vertices, vertices, 2);\n        const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n        const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n        pointResolution = (width + height) / 2;\n      }\n      const metersPerUnit = units\n        ? METERS_PER_UNIT[units]\n        : projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array<Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function (source) {\n    projections.forEach(function (destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array<Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array<Projection>} projections2 Projections with equal\n *     meaning.\n * @param {TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(\n  projections1,\n  projections2,\n  forwardTransform,\n  inverseTransform,\n) {\n  projections1.forEach(function (projection1) {\n    projections2.forEach(function (projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  clearProj();\n  clearTransformFuncs();\n}\n\n/**\n * @param {Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  }\n  if (typeof projection === 'string') {\n    return get(projection);\n  }\n  return /** @type {Projection} */ (projection);\n}\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} coordTransform Coordinate\n *     transform.\n * @return {TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array<number>} input Input.\n     * @param {Array<number>} [output] Output.\n     * @param {number} [dimension] Dimensions that should be transformed.\n     * @param {number} [stride] Stride.\n     * @return {Array<number>} Output.\n     */\n    function (input, output, dimension, stride) {\n      const length = input.length;\n      dimension = dimension !== undefined ? dimension : 2;\n      stride = stride ?? dimension;\n      output = output !== undefined ? output : new Array(length);\n      for (let i = 0; i < length; i += stride) {\n        const point = coordTransform(input.slice(i, i + dimension));\n        const pointLength = point.length;\n        for (let j = 0, jj = stride; j < jj; ++j) {\n          output[i + j] = j >= pointLength ? input[i + j] : point[j];\n        }\n      }\n      return output;\n    }\n  );\n}\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {ProjectionLike} source Source projection.\n * @param {ProjectionLike} destination Destination projection.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}. If the transform function can only\n *     transform less dimensions than the input coordinate, it is supposeed to return a coordinate\n *     with only the length it can transform. The other dimensions will be taken unchanged from the\n *     source.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  const sourceProj = get(source);\n  const destProj = get(destination);\n  addTransformFunc(\n    sourceProj,\n    destProj,\n    createTransformFromCoordinateTransform(forward),\n  );\n  addTransformFunc(\n    destProj,\n    sourceProj,\n    createTransformFromCoordinateTransform(inverse),\n  );\n}\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {ProjectionLike} [projection] Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, projection) {\n  disableCoordinateWarning();\n  return transform(\n    coordinate,\n    'EPSG:4326',\n    projection !== undefined ? projection : 'EPSG:3857',\n  );\n}\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Projected coordinate.\n * @param {ProjectionLike} [projection] Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, projection) {\n  const lonLat = transform(\n    coordinate,\n    projection !== undefined ? projection : 'EPSG:3857',\n    'EPSG:4326',\n  );\n  const lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {Projection} projection1 Projection 1.\n * @param {Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  const equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  }\n  const transformFunc = getTransformFromProjections(projection1, projection2);\n  return transformFunc === cloneTransform && equalUnits;\n}\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {Projection} source Source Projection object.\n * @param {Projection} destination Destination Projection\n *     object.\n * @return {TransformFunction|null} Transform function.\n */\nexport function getTransformFromProjections(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  let transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (transformFunc) {\n    return transformFunc;\n  }\n\n  /**\n   * @type {Transforms|null}\n   */\n  let sourceTransforms = null;\n\n  /**\n   * @type {Transforms|null}\n   */\n  let destinationTransforms = null;\n\n  // lazily add projections if we have supported transforms\n  for (const makeTransforms of transformFactories) {\n    if (!sourceTransforms) {\n      sourceTransforms = makeTransforms(source);\n    }\n    if (!destinationTransforms) {\n      destinationTransforms = makeTransforms(destination);\n    }\n  }\n\n  if (!sourceTransforms && !destinationTransforms) {\n    return null;\n  }\n\n  const intermediateCode = 'EPSG:4326';\n  if (!destinationTransforms) {\n    const toDestination = getTransformFunc(intermediateCode, destinationCode);\n    if (toDestination) {\n      transformFunc = composeTransformFuncs(\n        sourceTransforms.inverse,\n        toDestination,\n      );\n    }\n  } else if (!sourceTransforms) {\n    const fromSource = getTransformFunc(sourceCode, intermediateCode);\n    if (fromSource) {\n      transformFunc = composeTransformFuncs(\n        fromSource,\n        destinationTransforms.forward,\n      );\n    }\n  } else {\n    transformFunc = composeTransformFuncs(\n      sourceTransforms.inverse,\n      destinationTransforms.forward,\n    );\n  }\n\n  if (transformFunc) {\n    addProjection(source);\n    addProjection(destination);\n    addTransformFunc(source, destination, transformFunc);\n  }\n\n  return transformFunc;\n}\n\n/**\n * @param {TransformFunction} t1 The first transform function.\n * @param {TransformFunction} t2 The second transform function.\n * @return {TransformFunction} The composed transform function.\n */\nfunction composeTransformFuncs(t1, t2) {\n  return function (input, output, dimensions, stride) {\n    output = t1(input, output, dimensions, stride);\n    return t2(output, output, dimensions, stride);\n  };\n}\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {ProjectionLike} source Source.\n * @param {ProjectionLike} destination Destination.\n * @return {TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  const sourceProjection = get(source);\n  const destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original). If there\n * is no available transform between the two projection, the function will throw\n * an error.\n *\n * See {@link module:ol/proj.transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  if (!transformFunc) {\n    const sourceCode = get(source).getCode();\n    const destinationCode = get(destination).getCode();\n    throw new Error(\n      `No transform available between ${sourceCode} and ${destinationCode}`,\n    );\n  }\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {import(\"./extent.js\").Extent} extent The extent to transform.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @param {number} [stops] Number of stops per side used for the transform.\n * By default only the corners are used.\n * @return {import(\"./extent.js\").Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination, stops) {\n  const transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc, undefined, stops);\n}\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {import(\"./coordinate.js\").Coordinate} point Point.\n * @param {Projection} sourceProjection Source projection.\n * @param {Projection} destinationProjection Destination projection.\n * @return {import(\"./coordinate.js\").Coordinate} Point.\n */\nexport function transformWithProjections(\n  point,\n  sourceProjection,\n  destinationProjection,\n) {\n  const transformFunc = getTransformFromProjections(\n    sourceProjection,\n    destinationProjection,\n  );\n  return transformFunc(point);\n}\n\n/**\n * @type {Projection|null}\n */\nlet userProjection = null;\n\n/**\n * Set the projection for coordinates supplied from and returned by API methods.\n * This includes all API methods except for those interacting with tile grids,\n * plus {@link import(\"./Map.js\").FrameState} and {@link import(\"./View.js\").State}.\n * @param {ProjectionLike} projection The user projection.\n * @api\n */\nexport function setUserProjection(projection) {\n  userProjection = get(projection);\n}\n\n/**\n * Clear the user projection if set.\n * @api\n */\nexport function clearUserProjection() {\n  userProjection = null;\n}\n\n/**\n * Get the projection for coordinates supplied from and returned by API methods.\n * @return {Projection|null} The user projection (or null if not set).\n * @api\n */\nexport function getUserProjection() {\n  return userProjection;\n}\n\n/**\n * Use geographic coordinates (WGS-84 datum) in API methods.\n * This includes all API methods except for those interacting with tile grids,\n * plus {@link import(\"./Map.js\").FrameState} and {@link import(\"./View.js\").State}.\n * @api\n */\nexport function useGeographic() {\n  setUserProjection('EPSG:4326');\n}\n\n/**\n * Return a coordinate transformed into the user projection.  If no user projection\n * is set, the original coordinate is returned.\n * @param {Array<number>} coordinate Input coordinate.\n * @param {ProjectionLike} sourceProjection The input coordinate projection.\n * @return {Array<number>} The input coordinate in the user projection.\n */\nexport function toUserCoordinate(coordinate, sourceProjection) {\n  if (!userProjection) {\n    return coordinate;\n  }\n  return transform(coordinate, sourceProjection, userProjection);\n}\n\n/**\n * Return a coordinate transformed from the user projection.  If no user projection\n * is set, the original coordinate is returned.\n * @param {Array<number>} coordinate Input coordinate.\n * @param {ProjectionLike} destProjection The destination projection.\n * @return {Array<number>} The input coordinate transformed.\n */\nexport function fromUserCoordinate(coordinate, destProjection) {\n  if (!userProjection) {\n    if (\n      showCoordinateWarning &&\n      !equals(coordinate, [0, 0]) &&\n      coordinate[0] >= -180 &&\n      coordinate[0] <= 180 &&\n      coordinate[1] >= -90 &&\n      coordinate[1] <= 90\n    ) {\n      showCoordinateWarning = false;\n      warn(\n        'Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.',\n      );\n    }\n    return coordinate;\n  }\n  return transform(coordinate, userProjection, destProjection);\n}\n\n/**\n * Return an extent transformed into the user projection.  If no user projection\n * is set, the original extent is returned.\n * @param {import(\"./extent.js\").Extent} extent Input extent.\n * @param {ProjectionLike} sourceProjection The input extent projection.\n * @return {import(\"./extent.js\").Extent} The input extent in the user projection.\n */\nexport function toUserExtent(extent, sourceProjection) {\n  if (!userProjection) {\n    return extent;\n  }\n  return transformExtent(extent, sourceProjection, userProjection);\n}\n\n/**\n * Return an extent transformed from the user projection.  If no user projection\n * is set, the original extent is returned.\n * @param {import(\"./extent.js\").Extent} extent Input extent.\n * @param {ProjectionLike} destProjection The destination projection.\n * @return {import(\"./extent.js\").Extent} The input extent transformed.\n */\nexport function fromUserExtent(extent, destProjection) {\n  if (!userProjection) {\n    return extent;\n  }\n  return transformExtent(extent, userProjection, destProjection);\n}\n\n/**\n * Return the resolution in user projection units per pixel. If no user projection\n * is set, or source or user projection are missing units, the original resolution\n * is returned.\n * @param {number} resolution Resolution in input projection units per pixel.\n * @param {ProjectionLike} sourceProjection The input projection.\n * @return {number} Resolution in user projection units per pixel.\n */\nexport function toUserResolution(resolution, sourceProjection) {\n  if (!userProjection) {\n    return resolution;\n  }\n  const sourceMetersPerUnit = get(sourceProjection).getMetersPerUnit();\n  const userMetersPerUnit = userProjection.getMetersPerUnit();\n  return sourceMetersPerUnit && userMetersPerUnit\n    ? (resolution * sourceMetersPerUnit) / userMetersPerUnit\n    : resolution;\n}\n\n/**\n * Return the resolution in user projection units per pixel. If no user projection\n * is set, or source or user projection are missing units, the original resolution\n * is returned.\n * @param {number} resolution Resolution in user projection units per pixel.\n * @param {ProjectionLike} destProjection The destination projection.\n * @return {number} Resolution in destination projection units per pixel.\n */\nexport function fromUserResolution(resolution, destProjection) {\n  if (!userProjection) {\n    return resolution;\n  }\n  const destMetersPerUnit = get(destProjection).getMetersPerUnit();\n  const userMetersPerUnit = userProjection.getMetersPerUnit();\n  return destMetersPerUnit && userMetersPerUnit\n    ? (resolution * userMetersPerUnit) / destMetersPerUnit\n    : resolution;\n}\n\n/**\n * Creates a safe coordinate transform function from a coordinate transform function.\n * \"Safe\" means that it can handle wrapping of x-coordinates for global projections,\n * and that coordinates exceeding the source projection validity extent's range will be\n * clamped to the validity range.\n * @param {Projection} sourceProj Source projection.\n * @param {Projection} destProj Destination projection.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} transform Transform function (source to destination).\n * @return {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} Safe transform function (source to destination).\n */\nexport function createSafeCoordinateTransform(sourceProj, destProj, transform) {\n  return function (coord) {\n    let transformed, worldsAway;\n    if (sourceProj.canWrapX()) {\n      const sourceExtent = sourceProj.getExtent();\n      const sourceExtentWidth = getWidth(sourceExtent);\n      coord = coord.slice(0);\n      worldsAway = getWorldsAway(coord, sourceProj, sourceExtentWidth);\n      if (worldsAway) {\n        // Move x to the real world\n        coord[0] = coord[0] - worldsAway * sourceExtentWidth;\n      }\n      coord[0] = clamp(coord[0], sourceExtent[0], sourceExtent[2]);\n      coord[1] = clamp(coord[1], sourceExtent[1], sourceExtent[3]);\n      transformed = transform(coord);\n    } else {\n      transformed = transform(coord);\n    }\n    if (worldsAway && destProj.canWrapX()) {\n      // Move transformed coordinate back to the offset world\n      transformed[0] += worldsAway * getWidth(destProj.getExtent());\n    }\n    return transformed;\n  };\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(\n    EPSG4326_PROJECTIONS,\n    EPSG3857_PROJECTIONS,\n    fromEPSG4326,\n    toEPSG4326,\n  );\n}\n\naddCommon();\n","/**\n * @module ol/transform\n */\nimport {assert} from './asserts.js';\n\n/**\n * An array representing an affine 2d transformation for use with\n * {@link module:ol/transform} functions. The array has 6 elements.\n * @typedef {!Array<number>} Transform\n * @api\n */\n\n/**\n * Collection of affine 2d transformation functions. The functions work on an\n * array of 6 elements. The element order is compatible with the [SVGMatrix\n * interface](https://developer.mozilla.org/en-US/docs/Web/API/SVGMatrix) and is\n * a subset (elements a to f) of a 3×3 matrix:\n * ```\n * [ a c e ]\n * [ b d f ]\n * [ 0 0 1 ]\n * ```\n */\n\n/**\n * @private\n * @type {Transform}\n */\nconst tmp_ = new Array(6);\n\n/**\n * Create an identity transform.\n * @return {!Transform} Identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 1, 0, 0];\n}\n\n/**\n * Resets the given transform to an identity transform.\n * @param {!Transform} transform Transform.\n * @return {!Transform} Transform.\n */\nexport function reset(transform) {\n  return set(transform, 1, 0, 0, 1, 0, 0);\n}\n\n/**\n * Multiply the underlying matrices of two transforms and return the result in\n * the first transform.\n * @param {!Transform} transform1 Transform parameters of matrix 1.\n * @param {!Transform} transform2 Transform parameters of matrix 2.\n * @return {!Transform} transform1 multiplied with transform2.\n */\nexport function multiply(transform1, transform2) {\n  const a1 = transform1[0];\n  const b1 = transform1[1];\n  const c1 = transform1[2];\n  const d1 = transform1[3];\n  const e1 = transform1[4];\n  const f1 = transform1[5];\n  const a2 = transform2[0];\n  const b2 = transform2[1];\n  const c2 = transform2[2];\n  const d2 = transform2[3];\n  const e2 = transform2[4];\n  const f2 = transform2[5];\n\n  transform1[0] = a1 * a2 + c1 * b2;\n  transform1[1] = b1 * a2 + d1 * b2;\n  transform1[2] = a1 * c2 + c1 * d2;\n  transform1[3] = b1 * c2 + d1 * d2;\n  transform1[4] = a1 * e2 + c1 * f2 + e1;\n  transform1[5] = b1 * e2 + d1 * f2 + f1;\n\n  return transform1;\n}\n\n/**\n * Set the transform components a-f on a given transform.\n * @param {!Transform} transform Transform.\n * @param {number} a The a component of the transform.\n * @param {number} b The b component of the transform.\n * @param {number} c The c component of the transform.\n * @param {number} d The d component of the transform.\n * @param {number} e The e component of the transform.\n * @param {number} f The f component of the transform.\n * @return {!Transform} Matrix with transform applied.\n */\nexport function set(transform, a, b, c, d, e, f) {\n  transform[0] = a;\n  transform[1] = b;\n  transform[2] = c;\n  transform[3] = d;\n  transform[4] = e;\n  transform[5] = f;\n  return transform;\n}\n\n/**\n * Set transform on one matrix from another matrix.\n * @param {!Transform} transform1 Matrix to set transform to.\n * @param {!Transform} transform2 Matrix to set transform from.\n * @return {!Transform} transform1 with transform from transform2 applied.\n */\nexport function setFromArray(transform1, transform2) {\n  transform1[0] = transform2[0];\n  transform1[1] = transform2[1];\n  transform1[2] = transform2[2];\n  transform1[3] = transform2[3];\n  transform1[4] = transform2[4];\n  transform1[5] = transform2[5];\n  return transform1;\n}\n\n/**\n * Transforms the given coordinate with the given transform returning the\n * resulting, transformed coordinate. The coordinate will be modified in-place.\n *\n * @param {Transform} transform The transformation.\n * @param {import(\"./coordinate.js\").Coordinate|import(\"./pixel.js\").Pixel} coordinate The coordinate to transform.\n * @return {import(\"./coordinate.js\").Coordinate|import(\"./pixel.js\").Pixel} return coordinate so that operations can be\n *     chained together.\n */\nexport function apply(transform, coordinate) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  coordinate[0] = transform[0] * x + transform[2] * y + transform[4];\n  coordinate[1] = transform[1] * x + transform[3] * y + transform[5];\n  return coordinate;\n}\n\n/**\n * Applies rotation to the given transform.\n * @param {!Transform} transform Transform.\n * @param {number} angle Angle in radians.\n * @return {!Transform} The rotated transform.\n */\nexport function rotate(transform, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  return multiply(transform, set(tmp_, cos, sin, -sin, cos, 0, 0));\n}\n\n/**\n * Applies scale to a given transform.\n * @param {!Transform} transform Transform.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!Transform} The scaled transform.\n */\nexport function scale(transform, x, y) {\n  return multiply(transform, set(tmp_, x, 0, 0, y, 0, 0));\n}\n\n/**\n * Creates a scale transform.\n * @param {!Transform} target Transform to overwrite.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!Transform} The scale transform.\n */\nexport function makeScale(target, x, y) {\n  return set(target, x, 0, 0, y, 0, 0);\n}\n\n/**\n * Applies translation to the given transform.\n * @param {!Transform} transform Transform.\n * @param {number} dx Translation x.\n * @param {number} dy Translation y.\n * @return {!Transform} The translated transform.\n */\nexport function translate(transform, dx, dy) {\n  return multiply(transform, set(tmp_, 1, 0, 0, 1, dx, dy));\n}\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative).\n * @param {!Transform} transform The transform (will be modified in place).\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {!Transform} The composite transform.\n */\nexport function compose(transform, dx1, dy1, sx, sy, angle, dx2, dy2) {\n  const sin = Math.sin(angle);\n  const cos = Math.cos(angle);\n  transform[0] = sx * cos;\n  transform[1] = sy * sin;\n  transform[2] = -sx * sin;\n  transform[3] = sy * cos;\n  transform[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;\n  transform[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;\n  return transform;\n}\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative). The resulting transform\n * string can be applied as `transform` property of an HTMLElement's style.\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {string} The composite css transform.\n * @api\n */\nexport function composeCssTransform(dx1, dy1, sx, sy, angle, dx2, dy2) {\n  return toString(compose(create(), dx1, dy1, sx, sy, angle, dx2, dy2));\n}\n\n/**\n * Invert the given transform.\n * @param {!Transform} source The source transform to invert.\n * @return {!Transform} The inverted (source) transform.\n */\nexport function invert(source) {\n  return makeInverse(source, source);\n}\n\n/**\n * Invert the given transform.\n * @param {!Transform} target Transform to be set as the inverse of\n *     the source transform.\n * @param {!Transform} source The source transform to invert.\n * @return {!Transform} The inverted (target) transform.\n */\nexport function makeInverse(target, source) {\n  const det = determinant(source);\n  assert(det !== 0, 'Transformation matrix cannot be inverted');\n\n  const a = source[0];\n  const b = source[1];\n  const c = source[2];\n  const d = source[3];\n  const e = source[4];\n  const f = source[5];\n\n  target[0] = d / det;\n  target[1] = -b / det;\n  target[2] = -c / det;\n  target[3] = a / det;\n  target[4] = (c * f - d * e) / det;\n  target[5] = -(a * f - b * e) / det;\n\n  return target;\n}\n\n/**\n * Returns the determinant of the given matrix.\n * @param {!Transform} mat Matrix.\n * @return {number} Determinant.\n */\nexport function determinant(mat) {\n  return mat[0] * mat[3] - mat[1] * mat[2];\n}\n\n/**\n * @type {Array}\n */\nconst matrixPrecision = [1e6, 1e6, 1e6, 1e6, 2, 2];\n\n/**\n * A rounded string version of the transform.  This can be used\n * for CSS transforms.\n * @param {!Transform} mat Matrix.\n * @return {string} The transform as a string.\n */\nexport function toString(mat) {\n  const transformString =\n    'matrix(' +\n    mat\n      .map(\n        (value, i) =>\n          Math.round(value * matrixPrecision[i]) / matrixPrecision[i],\n      )\n      .join(', ') +\n    ')';\n  return transformString;\n}\n","/**\n * @module ol/render/Feature\n */\nimport Feature from '../Feature.js';\nimport {extend} from '../array.js';\nimport {\n  createOrUpdateFromCoordinate,\n  createOrUpdateFromFlatCoordinates,\n  getCenter,\n  getHeight,\n} from '../extent.js';\nimport {memoizeOne} from '../functions.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {\n  getInteriorPointOfArray,\n  getInteriorPointsOfMultiArray,\n} from '../geom/flat/interiorpoint.js';\nimport {interpolatePoint} from '../geom/flat/interpolate.js';\nimport {inflateEnds} from '../geom/flat/orient.js';\nimport {\n  douglasPeucker,\n  douglasPeuckerArray,\n  quantizeArray,\n} from '../geom/flat/simplify.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {\n  LineString,\n  MultiLineString,\n  MultiPoint,\n  MultiPolygon,\n  Point,\n  Polygon,\n} from '../geom.js';\nimport {get as getProjection} from '../proj.js';\nimport {\n  compose as composeTransform,\n  create as createTransform,\n} from '../transform.js';\n\n/**\n * @typedef {'Point' | 'LineString' | 'LinearRing' | 'Polygon' | 'MultiPoint' | 'MultiLineString'} Type\n * The geometry type.  One of `'Point'`, `'LineString'`, `'LinearRing'`,\n * `'Polygon'`, `'MultiPoint'` or 'MultiLineString'`.\n */\n\n/**\n * @type {import(\"../transform.js\").Transform}\n */\nconst tmpTransform = createTransform();\n\n/**\n * Lightweight, read-only, {@link module:ol/Feature~Feature} and {@link module:ol/geom/Geometry~Geometry} like\n * structure, optimized for vector tile rendering and styling. Geometry access\n * through the API is limited to getting the type and extent of the geometry.\n */\nclass RenderFeature {\n  /**\n   * @param {Type} type Geometry type.\n   * @param {Array<number>} flatCoordinates Flat coordinates. These always need\n   *     to be right-handed for polygons.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @param {Object<string, *>} properties Properties.\n   * @param {number|string|undefined} id Feature id.\n   */\n  constructor(type, flatCoordinates, ends, stride, properties, id) {\n    /**\n     * @type {import(\"../style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent|undefined}\n     */\n    this.extent_;\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = id;\n\n    /**\n     * @private\n     * @type {Type}\n     */\n    this.type_ = type;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatCoordinates_ = flatCoordinates;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatInteriorPoints_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatMidpoints_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>|null}\n     */\n    this.ends_ = ends || null;\n\n    /**\n     * @private\n     * @type {Object<string, *>}\n     */\n    this.properties_ = properties;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.squaredTolerance_;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.stride_ = stride;\n\n    /**\n     * @private\n     * @type {RenderFeature}\n     */\n    this.simplifiedGeometry_;\n  }\n\n  /**\n   * Get a feature property by its key.\n   * @param {string} key Key\n   * @return {*} Value for the requested key.\n   * @api\n   */\n  get(key) {\n    return this.properties_[key];\n  }\n\n  /**\n   * Get the extent of this feature's geometry.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent() {\n    if (!this.extent_) {\n      this.extent_ =\n        this.type_ === 'Point'\n          ? createOrUpdateFromCoordinate(this.flatCoordinates_)\n          : createOrUpdateFromFlatCoordinates(\n              this.flatCoordinates_,\n              0,\n              this.flatCoordinates_.length,\n              2,\n            );\n    }\n    return this.extent_;\n  }\n\n  /**\n   * @return {Array<number>} Flat interior points.\n   */\n  getFlatInteriorPoint() {\n    if (!this.flatInteriorPoints_) {\n      const flatCenter = getCenter(this.getExtent());\n      this.flatInteriorPoints_ = getInteriorPointOfArray(\n        this.flatCoordinates_,\n        0,\n        this.ends_,\n        2,\n        flatCenter,\n        0,\n      );\n    }\n    return this.flatInteriorPoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat interior points.\n   */\n  getFlatInteriorPoints() {\n    if (!this.flatInteriorPoints_) {\n      const ends = inflateEnds(this.flatCoordinates_, this.ends_);\n      const flatCenters = linearRingssCenter(this.flatCoordinates_, 0, ends, 2);\n      this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n        this.flatCoordinates_,\n        0,\n        ends,\n        2,\n        flatCenters,\n      );\n    }\n    return this.flatInteriorPoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoint.\n   */\n  getFlatMidpoint() {\n    if (!this.flatMidpoints_) {\n      this.flatMidpoints_ = interpolatePoint(\n        this.flatCoordinates_,\n        0,\n        this.flatCoordinates_.length,\n        2,\n        0.5,\n      );\n    }\n    return this.flatMidpoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoints.\n   */\n  getFlatMidpoints() {\n    if (!this.flatMidpoints_) {\n      this.flatMidpoints_ = [];\n      const flatCoordinates = this.flatCoordinates_;\n      let offset = 0;\n      const ends = /** @type {Array<number>} */ (this.ends_);\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        const end = ends[i];\n        const midpoint = interpolatePoint(flatCoordinates, offset, end, 2, 0.5);\n        extend(this.flatMidpoints_, midpoint);\n        offset = end;\n      }\n    }\n    return this.flatMidpoints_;\n  }\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is set when reading data from a remote source.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id_;\n  }\n\n  /**\n   * @return {Array<number>} Flat coordinates.\n   */\n  getOrientedFlatCoordinates() {\n    return this.flatCoordinates_;\n  }\n\n  /**\n   * For API compatibility with {@link module:ol/Feature~Feature}, this method is useful when\n   * determining the geometry type in style function (see {@link #getType}).\n   * @return {RenderFeature} Feature.\n   * @api\n   */\n  getGeometry() {\n    return this;\n  }\n\n  /**\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {RenderFeature} Simplified geometry.\n   */\n  getSimplifiedGeometry(squaredTolerance) {\n    return this;\n  }\n\n  /**\n   * Get a transformed and simplified version of the geometry.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../proj.js\").TransformFunction} [transform] Optional transform function.\n   * @return {RenderFeature} Simplified geometry.\n   */\n  simplifyTransformed(squaredTolerance, transform) {\n    return this;\n  }\n\n  /**\n   * Get the feature properties.\n   * @return {Object<string, *>} Feature properties.\n   * @api\n   */\n  getProperties() {\n    return this.properties_;\n  }\n\n  /**\n   * Get an object of all property names and values.  This has the same behavior as getProperties,\n   * but is here to conform with the {@link module:ol/Feature~Feature} interface.\n   * @return {Object<string, *>?} Object.\n   */\n  getPropertiesInternal() {\n    return this.properties_;\n  }\n\n  /**\n   * @return {number} Stride.\n   */\n  getStride() {\n    return this.stride_;\n  }\n\n  /**\n   * @return {import('../style/Style.js').StyleFunction|undefined} Style\n   */\n  getStyleFunction() {\n    return this.styleFunction;\n  }\n\n  /**\n   * Get the type of this feature's geometry.\n   * @return {Type} Geometry type.\n   * @api\n   */\n  getType() {\n    return this.type_;\n  }\n\n  /**\n   * Transform geometry coordinates from tile pixel space to projected.\n   *\n   * @param {import(\"../proj.js\").ProjectionLike} projection The data projection\n   */\n  transform(projection) {\n    projection = getProjection(projection);\n    const pixelExtent = projection.getExtent();\n    const projectedExtent = projection.getWorldExtent();\n    if (pixelExtent && projectedExtent) {\n      const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n      composeTransform(\n        tmpTransform,\n        projectedExtent[0],\n        projectedExtent[3],\n        scale,\n        -scale,\n        0,\n        0,\n        0,\n      );\n      transform2D(\n        this.flatCoordinates_,\n        0,\n        this.flatCoordinates_.length,\n        2,\n        tmpTransform,\n        this.flatCoordinates_,\n      );\n    }\n  }\n\n  /**\n   * Apply a transform function to the coordinates of the geometry.\n   * The geometry is modified in place.\n   * If you do not want the geometry modified in place, first `clone()` it and\n   * then use this function on the clone.\n   * @param {import(\"../proj.js\").TransformFunction} transformFn Transform function.\n   */\n  applyTransform(transformFn) {\n    transformFn(this.flatCoordinates_, this.flatCoordinates_, this.stride_);\n  }\n\n  /**\n   * @return {RenderFeature} A cloned render feature.\n   */\n  clone() {\n    return new RenderFeature(\n      this.type_,\n      this.flatCoordinates_.slice(),\n      this.ends_?.slice(),\n      this.stride_,\n      Object.assign({}, this.properties_),\n      this.id_,\n    );\n  }\n\n  /**\n   * @return {Array<number>|null} Ends.\n   */\n  getEnds() {\n    return this.ends_;\n  }\n\n  /**\n   * Add transform and resolution based geometry simplification to this instance.\n   * @return {RenderFeature} This render feature.\n   */\n  enableSimplifyTransformed() {\n    this.simplifyTransformed = memoizeOne((squaredTolerance, transform) => {\n      if (squaredTolerance === this.squaredTolerance_) {\n        return this.simplifiedGeometry_;\n      }\n      this.simplifiedGeometry_ = this.clone();\n      if (transform) {\n        this.simplifiedGeometry_.applyTransform(transform);\n      }\n      const simplifiedFlatCoordinates =\n        this.simplifiedGeometry_.getFlatCoordinates();\n      let simplifiedEnds;\n      switch (this.type_) {\n        case 'LineString':\n          simplifiedFlatCoordinates.length = douglasPeucker(\n            simplifiedFlatCoordinates,\n            0,\n            this.simplifiedGeometry_.flatCoordinates_.length,\n            this.simplifiedGeometry_.stride_,\n            squaredTolerance,\n            simplifiedFlatCoordinates,\n            0,\n          );\n          simplifiedEnds = [simplifiedFlatCoordinates.length];\n          break;\n        case 'MultiLineString':\n          simplifiedEnds = [];\n          simplifiedFlatCoordinates.length = douglasPeuckerArray(\n            simplifiedFlatCoordinates,\n            0,\n            this.simplifiedGeometry_.ends_,\n            this.simplifiedGeometry_.stride_,\n            squaredTolerance,\n            simplifiedFlatCoordinates,\n            0,\n            simplifiedEnds,\n          );\n          break;\n        case 'Polygon':\n          simplifiedEnds = [];\n          simplifiedFlatCoordinates.length = quantizeArray(\n            simplifiedFlatCoordinates,\n            0,\n            this.simplifiedGeometry_.ends_,\n            this.simplifiedGeometry_.stride_,\n            Math.sqrt(squaredTolerance),\n            simplifiedFlatCoordinates,\n            0,\n            simplifiedEnds,\n          );\n          break;\n        default:\n      }\n      if (simplifiedEnds) {\n        this.simplifiedGeometry_ = new RenderFeature(\n          this.type_,\n          simplifiedFlatCoordinates,\n          simplifiedEnds,\n          2,\n          this.properties_,\n          this.id_,\n        );\n      }\n      this.squaredTolerance_ = squaredTolerance;\n      return this.simplifiedGeometry_;\n    });\n    return this;\n  }\n}\n\n/**\n * @return {Array<number>} Flat coordinates.\n */\nRenderFeature.prototype.getFlatCoordinates =\n  RenderFeature.prototype.getOrientedFlatCoordinates;\n\n/**\n * Create a geometry from an `ol/render/Feature`\n * @param {RenderFeature} renderFeature\n * Render Feature\n * @return {Point|MultiPoint|LineString|MultiLineString|Polygon|MultiPolygon}\n * New geometry instance.\n * @api\n */\nexport function toGeometry(renderFeature) {\n  const geometryType = renderFeature.getType();\n  switch (geometryType) {\n    case 'Point':\n      return new Point(renderFeature.getFlatCoordinates());\n    case 'MultiPoint':\n      return new MultiPoint(renderFeature.getFlatCoordinates(), 'XY');\n    case 'LineString':\n      return new LineString(renderFeature.getFlatCoordinates(), 'XY');\n    case 'MultiLineString':\n      return new MultiLineString(\n        renderFeature.getFlatCoordinates(),\n        'XY',\n        /** @type {Array<number>} */ (renderFeature.getEnds()),\n      );\n    case 'Polygon':\n      const flatCoordinates = renderFeature.getFlatCoordinates();\n      const ends = renderFeature.getEnds();\n      const endss = inflateEnds(flatCoordinates, ends);\n      return endss.length > 1\n        ? new MultiPolygon(flatCoordinates, 'XY', endss)\n        : new Polygon(flatCoordinates, 'XY', ends);\n    default:\n      throw new Error('Invalid geometry type:' + geometryType);\n  }\n}\n\n/**\n * Create an `ol/Feature` from an `ol/render/Feature`\n * @param {RenderFeature} renderFeature RenderFeature\n * @param {string} [geometryName] Geometry name to use\n * when creating the Feature.\n * @return {Feature} Newly constructed `ol/Feature` with properties,\n * geometry, and id copied over.\n * @api\n */\nexport function toFeature(renderFeature, geometryName) {\n  const id = renderFeature.getId();\n  const geometry = toGeometry(renderFeature);\n  const properties = renderFeature.getProperties();\n  const feature = new Feature();\n  if (geometryName !== undefined) {\n    feature.setGeometryName(geometryName);\n  }\n  feature.setGeometry(geometry);\n  if (id !== undefined) {\n    feature.setId(id);\n  }\n  feature.setProperties(properties, true);\n  return feature;\n}\n\nexport default RenderFeature;\n","/**\n * @module ol/geom/flat/center\n */\nimport {createEmpty, createOrUpdateFromFlatCoordinates} from '../../extent.js';\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {Array<number>} Flat centers.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  const flatCenters = [];\n  let extent = createEmpty();\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    extent = createOrUpdateFromFlatCoordinates(\n      flatCoordinates,\n      offset,\n      ends[0],\n      stride,\n    );\n    flatCenters.push((extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2);\n    offset = ends[ends.length - 1];\n  }\n  return flatCenters;\n}\n","/**\n * @module ol/geom/flat/transform\n */\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../transform.js\").Transform} transform Transform.\n * @param {Array<number>} [dest] Destination.\n * @param {number} [destinationStride] Stride of destination coordinates; if unspecified, assumed to be 2.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function transform2D(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  transform,\n  dest,\n  destinationStride,\n) {\n  dest = dest ? dest : [];\n  destinationStride = destinationStride ? destinationStride : 2;\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const x = flatCoordinates[j];\n    const y = flatCoordinates[j + 1];\n    dest[i++] = transform[0] * x + transform[2] * y + transform[4];\n    dest[i++] = transform[1] * x + transform[3] * y + transform[5];\n\n    for (let k = 2; k < destinationStride; k++) {\n      dest[i++] = flatCoordinates[j + k];\n    }\n  }\n\n  if (dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} angle Angle.\n * @param {Array<number>} anchor Rotation anchor point.\n * @param {Array<number>} [dest] Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function rotate(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  angle,\n  anchor,\n  dest,\n) {\n  dest = dest ? dest : [];\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + deltaX * cos - deltaY * sin;\n    dest[i++] = anchorY + deltaX * sin + deltaY * cos;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n/**\n * Scale the coordinates.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} sx Scale factor in the x-direction.\n * @param {number} sy Scale factor in the y-direction.\n * @param {Array<number>} anchor Scale anchor point.\n * @param {Array<number>} [dest] Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function scale(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  sx,\n  sy,\n  anchor,\n  dest,\n) {\n  dest = dest ? dest : [];\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + sx * deltaX;\n    dest[i++] = anchorY + sy * deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @param {Array<number>} [dest] Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function translate(\n  flatCoordinates,\n  offset,\n  end,\n  stride,\n  deltaX,\n  deltaY,\n  dest,\n) {\n  dest = dest ? dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    dest[i++] = flatCoordinates[j] + deltaX;\n    dest[i++] = flatCoordinates[j + 1] + deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n","/**\n * @module ol/functions\n */\n\nimport {equals as arrayEquals} from './array.js';\n\n/**\n * Always returns true.\n * @return {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @return {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {void} Nothing.\n */\nexport function VOID() {}\n\n/**\n * Wrap a function in another function that remembers the last return.  If the\n * returned function is called twice in a row with the same arguments and the same\n * this object, it will return the value from the first call in the second call.\n *\n * @param {function(...any): ReturnType} fn The function to memoize.\n * @return {function(...any): ReturnType} The memoized function.\n * @template ReturnType\n */\nexport function memoizeOne(fn) {\n  /** @type {ReturnType} */\n  let lastResult;\n\n  /** @type {Array<any>|undefined} */\n  let lastArgs;\n\n  let lastThis;\n\n  /**\n   * @this {*} Only need to know if `this` changed, don't care what type\n   * @return {ReturnType} Memoized value\n   */\n  return function () {\n    const nextArgs = Array.prototype.slice.call(arguments);\n    if (!lastArgs || this !== lastThis || !arrayEquals(nextArgs, lastArgs)) {\n      lastThis = this;\n      lastArgs = nextArgs;\n      lastResult = fn.apply(this, arguments);\n    }\n    return lastResult;\n  };\n}\n\n/**\n * @template T\n * @param {function(): (T | Promise<T>)} getter A function that returns a value or a promise for a value.\n * @return {Promise<T>} A promise for the value.\n */\nexport function toPromise(getter) {\n  function promiseGetter() {\n    let value;\n    try {\n      value = getter();\n    } catch (err) {\n      return Promise.reject(err);\n    }\n    if (value instanceof Promise) {\n      return value;\n    }\n    return Promise.resolve(value);\n  }\n  return promiseGetter();\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.render.canvas;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.TileState;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.util;","const mapboxBaseUrl = 'https://api.mapbox.com';\n\n/**\n * Gets the path from a mapbox:// URL.\n * @param {string} url The Mapbox URL.\n * @return {string} The path.\n * @private\n */\nexport function getMapboxPath(url) {\n  const startsWith = 'mapbox://';\n  if (url.indexOf(startsWith) !== 0) {\n    return '';\n  }\n  return url.slice(startsWith.length);\n}\n\n/**\n * Turns mapbox:// sprite URLs into resolvable URLs.\n * @param {string} url The sprite URL.\n * @param {string} token The access token.\n * @param {string} styleUrl The style URL.\n * @return {string} A resolvable URL.\n * @private\n */\nexport function normalizeSpriteUrl(url, token, styleUrl) {\n  const mapboxPath = getMapboxPath(url);\n  if (!mapboxPath) {\n    return decodeURI(new URL(url, styleUrl).href);\n  }\n  const startsWith = 'sprites/';\n  if (mapboxPath.indexOf(startsWith) !== 0) {\n    throw new Error(`unexpected sprites url: ${url}`);\n  }\n  const sprite = mapboxPath.slice(startsWith.length);\n\n  return `${mapboxBaseUrl}/styles/v1/${sprite}/sprite?access_token=${token}`;\n}\n\n/**\n * Turns mapbox:// style URLs into resolvable URLs.\n * @param {string} url The style URL.\n * @param {string} token The access token.\n * @return {string} A resolvable URL.\n * @private\n */\nexport function normalizeStyleUrl(url, token) {\n  const mapboxPath = getMapboxPath(url);\n  if (!mapboxPath) {\n    return decodeURI(new URL(url, location.href).href);\n  }\n  const startsWith = 'styles/';\n  if (mapboxPath.indexOf(startsWith) !== 0) {\n    throw new Error(`unexpected style url: ${url}`);\n  }\n  const style = mapboxPath.slice(startsWith.length);\n\n  return `${mapboxBaseUrl}/styles/v1/${style}?&access_token=${token}`;\n}\n\nconst mapboxSubdomains = ['a', 'b', 'c', 'd'];\n\n/**\n * Turns mapbox:// source URLs into vector tile URL templates.\n * @param {string} url The source URL.\n * @param {string} token The access token.\n * @param {string} tokenParam The access token key.\n * @param {string} styleUrl The style URL.\n * @return {Array<string>} A vector tile template.\n * @private\n */\nexport function normalizeSourceUrl(url, token, tokenParam, styleUrl) {\n  const urlObject = new URL(url, styleUrl || location.href);\n  const mapboxPath = getMapboxPath(url);\n  if (!mapboxPath) {\n    if (!token) {\n      return [decodeURI(urlObject.href)];\n    }\n    if (!urlObject.searchParams.has(tokenParam)) {\n      urlObject.searchParams.set(tokenParam, token);\n    }\n    return [decodeURI(urlObject.href)];\n  }\n\n  if (mapboxPath === 'mapbox.satellite') {\n    const sizeFactor = window.devicePixelRatio >= 1.5 ? '@2x' : '';\n    return [\n      `https://api.mapbox.com/v4/${mapboxPath}/{z}/{x}/{y}${sizeFactor}.webp?access_token=${token}`,\n    ];\n  }\n  return mapboxSubdomains.map(\n    (sub) =>\n      `https://${sub}.tiles.mapbox.com/v4/${mapboxPath}/{z}/{x}/{y}.vector.pbf?access_token=${token}`,\n  );\n}\n","import {VectorTile} from 'ol';\nimport TileState from 'ol/TileState.js';\nimport {toPromise} from 'ol/functions.js';\nimport {getUid} from 'ol/util.js';\nimport {normalizeSourceUrl, normalizeStyleUrl} from './mapbox.js';\n\n/** @typedef {'Style'|'Source'|'Sprite'|'SpriteImage'|'Tiles'|'GeoJSON'} ResourceType */\n\n/** @typedef {import(\"ol\").Map} Map */\n/** @typedef {import(\"ol/layer\").Layer} Layer */\n/** @typedef {import(\"ol/layer\").Group} LayerGroup */\n/** @typedef {import(\"ol/layer\").Vector} VectorLayer */\n/** @typedef {import(\"ol/layer\").VectorTile} VectorTileLayer */\n/** @typedef {import(\"ol/source\").Source} Source */\n\nconst functionCacheByStyleId = {};\nconst filterCacheByStyleId = {};\n\nlet styleId = 0;\nexport function getStyleId(glStyle) {\n  if (!glStyle.id) {\n    glStyle.id = styleId++;\n  }\n  return glStyle.id;\n}\n\nexport function getStyleFunctionKey(glStyle, olLayer) {\n  return getStyleId(glStyle) + '.' + getUid(olLayer);\n}\n\n/**\n * @param {Object} glStyle Mapboox style object.\n * @return {Object} Function cache.\n */\nexport function getFunctionCache(glStyle) {\n  let functionCache = functionCacheByStyleId[glStyle.id];\n  if (!functionCache) {\n    functionCache = {};\n    functionCacheByStyleId[getStyleId(glStyle)] = functionCache;\n  }\n  return functionCache;\n}\n\nexport function clearFunctionCache() {\n  for (const key in functionCacheByStyleId) {\n    delete functionCacheByStyleId[key];\n  }\n}\n\n/**\n * @param {Object} glStyle Mapboox style object.\n * @return {Object} Filter cache.\n */\nexport function getFilterCache(glStyle) {\n  let filterCache = filterCacheByStyleId[glStyle.id];\n  if (!filterCache) {\n    filterCache = {};\n    filterCacheByStyleId[getStyleId(glStyle)] = filterCache;\n  }\n  return filterCache;\n}\n\nexport function deg2rad(degrees) {\n  return (degrees * Math.PI) / 180;\n}\n\nexport const defaultResolutions = (function () {\n  const resolutions = [];\n  for (let res = 78271.51696402048; resolutions.length <= 24; res /= 2) {\n    resolutions.push(res);\n  }\n  return resolutions;\n})();\n\n/**\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @return {HTMLCanvasElement} Canvas.\n */\nexport function createCanvas(width, height) {\n  if (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope && typeof OffscreenCanvas !== 'undefined') { // eslint-disable-line\n    return /** @type {?} */ (new OffscreenCanvas(width, height));\n  }\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nexport function getZoomForResolution(resolution, resolutions) {\n  let i = 0;\n  const ii = resolutions.length;\n  for (; i < ii; ++i) {\n    const candidate = resolutions[i];\n    if (candidate < resolution && i + 1 < ii) {\n      const zoomFactor = resolutions[i] / resolutions[i + 1];\n      return i + Math.log(resolutions[i] / resolution) / Math.log(zoomFactor);\n    }\n  }\n  return ii - 1;\n}\n\nexport function getResolutionForZoom(zoom, resolutions) {\n  const base = Math.floor(zoom);\n  const factor = Math.pow(2, zoom - base);\n  return resolutions[base] / factor;\n}\n\nconst pendingRequests = {};\n/**\n * @param {ResourceType} resourceType Type of resource to load.\n * @param {string} url Url of the resource.\n * @param {Options} [options] Options.\n * @param {{url?: string}} [metadata] Object to be filled with the request.\n * @return {Promise<Object|Response>} Promise that resolves with the loaded resource\n * or rejects with the Response object.\n * @private\n */\nexport function fetchResource(resourceType, url, options = {}, metadata) {\n  if (url in pendingRequests) {\n    if (metadata) {\n      metadata.url = pendingRequests[url][0].url;\n    }\n    return pendingRequests[url][1];\n  }\n  const transformedRequest = options.transformRequest\n    ? options.transformRequest(url, resourceType) || url\n    : url;\n  const handleError = function (error) {\n    delete pendingRequests[url];\n    return Promise.reject(new Error('Error fetching source ' + url));\n  };\n  const handleResponse = function (response) {\n    delete pendingRequests[url];\n    return response.ok\n      ? response.json()\n      : Promise.reject(new Error('Error fetching source ' + url));\n  };\n  const pendingRequest = toPromise(() => transformedRequest)\n    .then((transformedRequest) => {\n      if (transformedRequest instanceof Response) {\n        if (metadata) {\n          metadata.url = transformedRequest.url;\n        }\n        return handleResponse(transformedRequest);\n      }\n      if (!(transformedRequest instanceof Request)) {\n        transformedRequest = new Request(transformedRequest);\n      }\n      if (!transformedRequest.headers.get('Accept')) {\n        transformedRequest.headers.set('Accept', 'application/json');\n      }\n      if (metadata) {\n        metadata.url = transformedRequest.url;\n      }\n      return fetch(transformedRequest).then(handleResponse).catch(handleError);\n    })\n    .catch(handleError);\n  pendingRequests[url] = [transformedRequest, pendingRequest];\n  return pendingRequest;\n}\n\nexport function getGlStyle(glStyleOrUrl, options) {\n  if (typeof glStyleOrUrl === 'string') {\n    if (glStyleOrUrl.trim().startsWith('{')) {\n      try {\n        const glStyle = JSON.parse(glStyleOrUrl);\n        return Promise.resolve(glStyle);\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    } else {\n      glStyleOrUrl = normalizeStyleUrl(glStyleOrUrl, options.accessToken);\n      return fetchResource('Style', glStyleOrUrl, options);\n    }\n  } else {\n    return Promise.resolve(glStyleOrUrl);\n  }\n}\n\nconst tilejsonCache = {};\n/**\n * @param {Object} glSource glStyle source object.\n * @param {string} styleUrl Style URL.\n * @param {Options} options Options.\n * @return {Promise<{tileJson: Object, tileLoadFunction: import('ol/Tile.js').LoadFunction}?>} TileJson and load function\n */\nexport function getTileJson(glSource, styleUrl, options = {}) {\n  const cacheKey = [styleUrl, JSON.stringify(glSource)].toString();\n  let promise = tilejsonCache[cacheKey];\n  if (!promise || options.transformRequest) {\n    let tileLoadFunction;\n    if (options.transformRequest) {\n      tileLoadFunction = (tile, src) => {\n        const transformedRequest = options.transformRequest\n          ? options.transformRequest(src, 'Tiles') || src\n          : src;\n        if (tile instanceof VectorTile) {\n          tile.setLoader((extent, resolution, projection) => {\n            const handleResponse = function (response) {\n              response.arrayBuffer().then((data) => {\n                const format = tile.getFormat();\n                const features = format.readFeatures(data, {\n                  extent: extent,\n                  featureProjection: projection,\n                });\n                // @ts-ignore\n                tile.setFeatures(features);\n              });\n            };\n            toPromise(() => transformedRequest)\n              .then((transformedRequest) => {\n                if (transformedRequest instanceof Response) {\n                  return handleResponse(transformedRequest);\n                }\n                fetch(transformedRequest)\n                  .then(handleResponse)\n                  .catch((e) => tile.setState(TileState.ERROR));\n              })\n              .catch((e) => tile.setState(TileState.ERROR));\n          });\n        } else {\n          const img = tile.getImage();\n          toPromise(() => transformedRequest)\n            .then((transformedRequest) => {\n              if (typeof transformedRequest === 'string') {\n                img.src = transformedRequest;\n                return;\n              }\n              const handleResponse = (response) =>\n                response.blob().then((blob) => {\n                  const url = URL.createObjectURL(blob);\n                  img.addEventListener('load', () => URL.revokeObjectURL(url));\n                  img.addEventListener('error', () => URL.revokeObjectURL(url));\n                  img.src = url;\n                });\n              if (transformedRequest instanceof Response) {\n                return handleResponse(transformedRequest);\n              }\n              fetch(transformedRequest)\n                .then(handleResponse)\n                .catch((e) => tile.setState(TileState.ERROR));\n            })\n            .catch((e) => tile.setState(TileState.ERROR));\n        }\n      };\n    }\n    const url = glSource.url;\n    if (url && !glSource.tiles) {\n      const normalizedSourceUrl = normalizeSourceUrl(\n        url,\n        options.accessToken,\n        options.accessTokenParam || 'access_token',\n        styleUrl || location.href,\n      );\n      if (url.startsWith('mapbox://')) {\n        promise = Promise.resolve({\n          tileJson: Object.assign({}, glSource, {\n            url: undefined,\n            tiles: normalizedSourceUrl,\n          }),\n          tileLoadFunction,\n        });\n      } else {\n        const metadata = {};\n        promise = fetchResource(\n          'Source',\n          normalizedSourceUrl[0],\n          options,\n          metadata,\n        ).then(function (tileJson) {\n          tileJson.tiles = tileJson.tiles.map(function (tileUrl) {\n            if (tileJson.scheme === 'tms') {\n              tileUrl = tileUrl.replace('{y}', '{-y}');\n            }\n            return normalizeSourceUrl(\n              tileUrl,\n              options.accessToken,\n              options.accessTokenParam || 'access_token',\n              metadata.url,\n            )[0];\n          });\n          return Promise.resolve({tileJson, tileLoadFunction});\n        });\n      }\n    } else {\n      glSource = Object.assign({}, glSource, {\n        tiles: glSource.tiles.map(function (tileUrl) {\n          if (glSource.scheme === 'tms') {\n            tileUrl = tileUrl.replace('{y}', '{-y}');\n          }\n          return normalizeSourceUrl(\n            tileUrl,\n            options.accessToken,\n            options.accessTokenParam || 'access_token',\n            styleUrl || location.href,\n          )[0];\n        }),\n      });\n      promise = Promise.resolve({\n        tileJson: Object.assign({}, glSource),\n        tileLoadFunction,\n      });\n    }\n    tilejsonCache[cacheKey] = promise;\n  }\n  return promise;\n}\n\n/**\n * @param {HTMLImageElement|HTMLCanvasElement} spriteImage Sprite image id.\n * @param {{x: number, y: number, width: number, height: number, pixelRatio: number}} spriteImageData Sprite image data.\n * @param {number} haloWidth Halo width.\n * @param {{r: number, g: number, b: number, a: number}} haloColor Halo color.\n * @return {HTMLCanvasElement} Canvas element with the halo.\n */\nexport function drawIconHalo(\n  spriteImage,\n  spriteImageData,\n  haloWidth,\n  haloColor,\n) {\n  const imgSize = [\n    2 * haloWidth * spriteImageData.pixelRatio + spriteImageData.width,\n    2 * haloWidth * spriteImageData.pixelRatio + spriteImageData.height,\n  ];\n  const imageCanvas = createCanvas(imgSize[0], imgSize[1]);\n  const imageContext = imageCanvas.getContext('2d');\n  imageContext.drawImage(\n    spriteImage,\n    spriteImageData.x,\n    spriteImageData.y,\n    spriteImageData.width,\n    spriteImageData.height,\n    haloWidth * spriteImageData.pixelRatio,\n    haloWidth * spriteImageData.pixelRatio,\n    spriteImageData.width,\n    spriteImageData.height,\n  );\n  const imageData = imageContext.getImageData(0, 0, imgSize[0], imgSize[1]);\n  imageContext.globalCompositeOperation = 'destination-over';\n  imageContext.fillStyle = `rgba(${haloColor.r * 255},${haloColor.g * 255},${\n    haloColor.b * 255\n  },${haloColor.a})`;\n  const data = imageData.data;\n  for (let i = 0, ii = imageData.width; i < ii; ++i) {\n    for (let j = 0, jj = imageData.height; j < jj; ++j) {\n      const index = (j * ii + i) * 4;\n      const alpha = data[index + 3];\n      if (alpha > 0) {\n        imageContext.arc(\n          i,\n          j,\n          haloWidth * spriteImageData.pixelRatio,\n          0,\n          2 * Math.PI,\n        );\n      }\n    }\n  }\n  imageContext.fill();\n  return imageCanvas;\n}\n\nfunction smoothstep(min, max, value) {\n  const x = Math.max(0, Math.min(1, (value - min) / (max - min)));\n  return x * x * (3 - 2 * x);\n}\n\n/**\n * @param {HTMLImageElement} image SDF image\n * @param {{x: number, y: number, width: number, height: number}} area Area to unSDF\n * @param {{r: number, g: number, b: number, a: number}} color Color to use\n * @return {HTMLCanvasElement} Regular image\n */\nexport function drawSDF(image, area, color) {\n  const imageCanvas = createCanvas(area.width, area.height);\n  const imageContext = imageCanvas.getContext('2d');\n  imageContext.drawImage(\n    image,\n    area.x,\n    area.y,\n    area.width,\n    area.height,\n    0,\n    0,\n    area.width,\n    area.height,\n  );\n  const imageData = imageContext.getImageData(0, 0, area.width, area.height);\n  const data = imageData.data;\n  for (let i = 0, ii = imageData.width; i < ii; ++i) {\n    for (let j = 0, jj = imageData.height; j < jj; ++j) {\n      const index = (j * ii + i) * 4;\n      const dist = data[index + 3] / 255;\n\n      const buffer = 0.75;\n      const gamma = 0.1;\n\n      const alpha = smoothstep(buffer - gamma, buffer + gamma, dist);\n      if (alpha > 0) {\n        data[index + 0] = Math.round(255 * color.r * alpha);\n        data[index + 1] = Math.round(255 * color.g * alpha);\n        data[index + 2] = Math.round(255 * color.b * alpha);\n        data[index + 3] = Math.round(255 * alpha);\n      } else {\n        data[index + 3] = 0;\n      }\n    }\n  }\n  imageContext.putImageData(imageData, 0, 0);\n  return imageCanvas;\n}\n\n/**\n * @typedef {import(\"./apply.js\").Options} Options\n * @private\n */\n","import mb2css from 'mapbox-to-css-font';\nimport {checkedFonts, registerFont} from 'ol/render/canvas.js';\nimport {createCanvas} from './util.js';\n\nconst hairSpacePool = Array(256).join('\\u200A');\nexport function applyLetterSpacing(text, letterSpacing) {\n  if (letterSpacing >= 0.05) {\n    let textWithLetterSpacing = '';\n    const lines = text.split('\\n');\n    const joinSpaceString = hairSpacePool.slice(\n      0,\n      Math.round(letterSpacing / 0.1),\n    );\n    for (let l = 0, ll = lines.length; l < ll; ++l) {\n      if (l > 0) {\n        textWithLetterSpacing += '\\n';\n      }\n      textWithLetterSpacing += lines[l].split('').join(joinSpaceString);\n    }\n    return textWithLetterSpacing;\n  }\n  return text;\n}\n\nlet measureContext;\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvas(1, 1).getContext('2d');\n  }\n  return measureContext;\n}\n\nfunction measureText(text, letterSpacing) {\n  return (\n    getMeasureContext().measureText(text).width +\n    (text.length - 1) * letterSpacing\n  );\n}\n\nconst measureCache = {};\nexport function wrapText(text, font, em, letterSpacing) {\n  if (text.indexOf('\\n') !== -1) {\n    const hardLines = text.split('\\n');\n    const lines = [];\n    for (let i = 0, ii = hardLines.length; i < ii; ++i) {\n      lines.push(wrapText(hardLines[i], font, em, letterSpacing));\n    }\n    return lines.join('\\n');\n  }\n  const key = em + ',' + font + ',' + text + ',' + letterSpacing;\n  let wrappedText = measureCache[key];\n  if (!wrappedText) {\n    const words = text.split(' ');\n    if (words.length > 1) {\n      const ctx = getMeasureContext();\n      ctx.font = font;\n      const oneEm = ctx.measureText('M').width;\n      const maxWidth = oneEm * em;\n      let line = '';\n      const lines = [];\n      // Pass 1 - wrap lines to not exceed maxWidth\n      for (let i = 0, ii = words.length; i < ii; ++i) {\n        const word = words[i];\n        const testLine = line + (line ? ' ' : '') + word;\n        if (measureText(testLine, letterSpacing) <= maxWidth) {\n          line = testLine;\n        } else {\n          if (line) {\n            lines.push(line);\n          }\n          line = word;\n        }\n      }\n      if (line) {\n        lines.push(line);\n      }\n      // Pass 2 - add lines with a width of less than 30% of maxWidth to the previous or next line\n      for (let i = 0, ii = lines.length; i < ii && ii > 1; ++i) {\n        const line = lines[i];\n        if (measureText(line, letterSpacing) < maxWidth * 0.35) {\n          const prevWidth =\n            i > 0 ? measureText(lines[i - 1], letterSpacing) : Infinity;\n          const nextWidth =\n            i < ii - 1 ? measureText(lines[i + 1], letterSpacing) : Infinity;\n          lines.splice(i, 1);\n          ii -= 1;\n          if (prevWidth < nextWidth) {\n            lines[i - 1] += ' ' + line;\n            i -= 1;\n          } else {\n            lines[i] = line + ' ' + lines[i];\n          }\n        }\n      }\n      // Pass 3 - try to fill 80% of maxWidth for each line\n      for (let i = 0, ii = lines.length - 1; i < ii; ++i) {\n        const line = lines[i];\n        const next = lines[i + 1];\n        if (\n          measureText(line, letterSpacing) > maxWidth * 0.7 &&\n          measureText(next, letterSpacing) < maxWidth * 0.6\n        ) {\n          const lineWords = line.split(' ');\n          const lastWord = lineWords.pop();\n          if (measureText(lastWord, letterSpacing) < maxWidth * 0.2) {\n            lines[i] = lineWords.join(' ');\n            lines[i + 1] = lastWord + ' ' + next;\n          }\n          ii -= 1;\n        }\n      }\n      wrappedText = lines.join('\\n');\n    } else {\n      wrappedText = text;\n    }\n    wrappedText = applyLetterSpacing(wrappedText, letterSpacing);\n    measureCache[key] = wrappedText;\n  }\n  return wrappedText;\n}\n\nconst fontFamilyRegEx = /font-family: ?([^;]*);/;\nconst stripQuotesRegEx = /(\"|')/g;\nlet loadedFontFamilies;\nfunction hasFontFamily(family) {\n  if (!loadedFontFamilies) {\n    loadedFontFamilies = {};\n    const styleSheets = document.styleSheets;\n    for (let i = 0, ii = styleSheets.length; i < ii; ++i) {\n      const styleSheet = /** @type {CSSStyleSheet} */ (styleSheets[i]);\n      try {\n        const cssRules = styleSheet.rules || styleSheet.cssRules;\n        if (cssRules) {\n          for (let j = 0, jj = cssRules.length; j < jj; ++j) {\n            const cssRule = cssRules[j];\n            if (cssRule.type == 5) {\n              const match = cssRule.cssText.match(fontFamilyRegEx);\n              loadedFontFamilies[match[1].replace(stripQuotesRegEx, '')] = true;\n            }\n          }\n        }\n      } catch {\n        // empty catch block\n      }\n    }\n  }\n  return family in loadedFontFamilies;\n}\n\nconst processedFontFamilies = {};\n\n/**\n * @param {Array} fonts Fonts.\n * @param {string} [templateUrl] Template URL.\n * @return {Array} Processed fonts.\n * @private\n */\nexport function getFonts(\n  fonts,\n  templateUrl = 'https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css',\n) {\n  const fontsKey = fonts.toString();\n  if (fontsKey in processedFontFamilies) {\n    return processedFontFamilies[fontsKey];\n  }\n  const fontDescriptions = [];\n  for (let i = 0, ii = fonts.length; i < ii; ++i) {\n    fonts[i] = fonts[i].replace('Arial Unicode MS', 'Arial');\n    const font = fonts[i];\n    const cssFont = mb2css(font, 1);\n    registerFont(cssFont);\n    const parts = cssFont.split(' ');\n    fontDescriptions.push([\n      parts.slice(3).join(' ').replace(/\"/g, ''),\n      parts[1],\n      parts[0],\n    ]);\n  }\n  for (let i = 0, ii = fontDescriptions.length; i < ii; ++i) {\n    const fontDescription = fontDescriptions[i];\n    const family = fontDescription[0];\n    if (!hasFontFamily(family)) {\n      if (\n        checkedFonts.get(\n          `${fontDescription[2]}\\n${fontDescription[1]} \\n${family}`,\n        ) !== 100\n      ) {\n        const fontUrl = templateUrl\n          .replace('{font-family}', family.replace(/ /g, '-').toLowerCase())\n          .replace('{Font+Family}', family.replace(/ /g, '+'))\n          .replace('{fontweight}', fontDescription[1])\n          .replace(\n            '{-fontstyle}',\n            fontDescription[2].replace('normal', '').replace(/(.+)/, '-$1'),\n          )\n          .replace('{fontstyle}', fontDescription[2]);\n        if (!document.querySelector('link[href=\"' + fontUrl + '\"]')) {\n          const markup = document.createElement('link');\n          markup.href = fontUrl;\n          markup.rel = 'stylesheet';\n          document.head.appendChild(markup);\n        }\n      }\n    }\n  }\n  processedFontFamilies[fontsKey] = fonts;\n  return fonts;\n}\n","/*\nol-mapbox-style - Use Mapbox/MapLibre Style objects with OpenLayers\nCopyright 2016-present ol-mapbox-style contributors\nLicense: https://raw.githubusercontent.com/openlayers/ol-mapbox-style/master/LICENSE\n*/\n\nimport {\n  Color,\n  convertFunction,\n  createPropertyExpression,\n  derefLayers,\n  featureFilter as createFilter,\n  isExpression,\n  isFunction,\n  v8 as spec,\n} from '@maplibre/maplibre-gl-style-spec';\nimport mb2css from 'mapbox-to-css-font';\nimport {toPromise} from 'ol/functions.js';\nimport RenderFeature from 'ol/render/Feature.js';\nimport Circle from 'ol/style/Circle.js';\nimport Fill from 'ol/style/Fill.js';\nimport Icon from 'ol/style/Icon.js';\nimport Stroke from 'ol/style/Stroke.js';\nimport Style from 'ol/style/Style.js';\nimport Text from 'ol/style/Text.js';\n\nimport {applyLetterSpacing, wrapText} from './text.js';\nimport {\n  clearFunctionCache,\n  createCanvas,\n  defaultResolutions,\n  deg2rad,\n  drawIconHalo,\n  drawSDF,\n  getFilterCache,\n  getFunctionCache,\n  getStyleFunctionKey,\n  getZoomForResolution,\n} from './util.js';\n\n/**\n * @typedef {import(\"ol/layer/Vector\").default} VectorLayer\n * @typedef {import(\"ol/layer/VectorTile\").default} VectorTileLayer\n * @typedef {import(\"ol/style/Style\").StyleFunction} StyleFunction\n * @typedef {import('./util.js').ResourceType} ResourceType\n */\n\nconst types = {\n  'Point': 1,\n  'MultiPoint': 1,\n  'LineString': 2,\n  'MultiLineString': 2,\n  'Polygon': 3,\n  'MultiPolygon': 3,\n};\nconst anchor = {\n  'center': [0.5, 0.5],\n  'left': [0, 0.5],\n  'right': [1, 0.5],\n  'top': [0.5, 0],\n  'bottom': [0.5, 1],\n  'top-left': [0, 0],\n  'top-right': [1, 0],\n  'bottom-left': [0, 1],\n  'bottom-right': [1, 1],\n};\n\nconst expressionData = function (rawExpression, propertySpec) {\n  const compiledExpression = createPropertyExpression(\n    rawExpression,\n    propertySpec,\n  );\n  if (compiledExpression.result === 'error') {\n    throw new Error(\n      compiledExpression.value\n        .map((err) => `${err.key}: ${err.message}`)\n        .join(', '),\n    );\n  }\n  return compiledExpression.value;\n};\n\nconst emptyObj = {};\nconst zoomObj = {zoom: 0};\nlet renderFeatureCoordinates, renderFeature;\n\n/**\n * @private\n * @param {Object} layer Gl object layer.\n * @param {string} layoutOrPaint 'layout' or 'paint'.\n * @param {string} property Feature property.\n * @param {number} zoom Zoom.\n * @param {Object} feature Gl feature.\n * @param {Object} [functionCache] Function cache.\n * @param {Object} [featureState] Feature state.\n * @return {?} Value.\n */\nexport function getValue(\n  layer,\n  layoutOrPaint,\n  property,\n  zoom,\n  feature,\n  functionCache,\n  featureState,\n) {\n  const layerId = layer.id;\n  if (!functionCache) {\n    functionCache = {};\n    console.warn('No functionCache provided to getValue()'); //eslint-disable-line no-console\n  }\n  if (!functionCache[layerId]) {\n    functionCache[layerId] = {};\n  }\n  const functions = functionCache[layerId];\n  if (!functions[property]) {\n    let value = (layer[layoutOrPaint] || emptyObj)[property];\n    const propertySpec = spec[`${layoutOrPaint}_${layer.type}`][property];\n    if (value === undefined) {\n      value = propertySpec.default;\n    }\n    let isExpr = isExpression(value);\n    if (!isExpr && isFunction(value)) {\n      value = convertFunction(value, propertySpec);\n      isExpr = true;\n    }\n    if (isExpr) {\n      const compiledExpression = expressionData(value, propertySpec);\n      functions[property] =\n        compiledExpression.evaluate.bind(compiledExpression);\n    } else {\n      if (propertySpec.type == 'color') {\n        value = Color.parse(value);\n      }\n      functions[property] = function () {\n        return value;\n      };\n    }\n  }\n  zoomObj.zoom = zoom;\n  return functions[property](zoomObj, feature, featureState);\n}\n\n/**\n * @private\n * @param {Object} layer Gl object layer.\n * @param {number} zoom Zoom.\n * @param {Object} feature Gl feature.\n * @param {\"icon\"|\"text\"} prefix Style property prefix.\n * @param {Object} [functionCache] Function cache.\n * @return {\"declutter\"|\"obstacle\"|\"none\"} Value.\n */\nfunction getDeclutterMode(layer, zoom, feature, prefix, functionCache) {\n  const allowOverlap = getValue(\n    layer,\n    'layout',\n    `${prefix}-allow-overlap`,\n    zoom,\n    feature,\n    functionCache,\n  );\n  if (!allowOverlap) {\n    return 'declutter';\n  }\n  const ignorePlacement = getValue(\n    layer,\n    'layout',\n    `${prefix}-ignore-placement`,\n    zoom,\n    feature,\n    functionCache,\n  );\n  if (!ignorePlacement) {\n    return 'obstacle';\n  }\n  return 'none';\n}\n\n/**\n * @private\n * @param {string} layerId Layer id.\n * @param {?} filter Filter.\n * @param {Object} feature Feature.\n * @param {number} zoom Zoom.\n * @param {Object} [filterCache] Filter cache.\n * @return {boolean} Filter result.\n */\nfunction evaluateFilter(layerId, filter, feature, zoom, filterCache) {\n  if (!filterCache) {\n    console.warn('No filterCache provided to evaluateFilter()'); //eslint-disable-line no-console\n  }\n  if (!(layerId in filterCache)) {\n    filterCache[layerId] = createFilter(filter).filter;\n  }\n  zoomObj.zoom = zoom;\n  return filterCache[layerId](zoomObj, feature);\n}\n\nlet renderTransparentEnabled = false;\n\n/**\n * Configure whether features with a transparent style should be rendered. When\n * set to `true`, it will be possible to hit detect content that is not visible,\n * like transparent fills of polygons, using `ol/layer/Layer#getFeatures()` or\n * `ol/Map#getFeaturesAtPixel()`\n * @param {boolean} enabled Rendering of transparent elements is enabled.\n * Default is `false`.\n */\nexport function renderTransparent(enabled) {\n  if (enabled !== renderTransparentEnabled) {\n    clearFunctionCache();\n    renderTransparentEnabled = enabled;\n  }\n}\n\n/**\n * @private\n * @param {?} color Color.\n * @param {number} [opacity] Opacity.\n * @return {string} Color.\n */\nfunction colorWithOpacity(color, opacity) {\n  if (color) {\n    if (!renderTransparentEnabled && (color.a === 0 || opacity === 0)) {\n      return undefined;\n    }\n    const a = color.a;\n    opacity = opacity === undefined ? 1 : opacity;\n    return a === 0\n      ? 'transparent'\n      : 'rgba(' +\n          Math.round((color.r * 255) / a) +\n          ',' +\n          Math.round((color.g * 255) / a) +\n          ',' +\n          Math.round((color.b * 255) / a) +\n          ',' +\n          a * opacity +\n          ')';\n  }\n  return color;\n}\n\nconst templateRegEx = /\\{[^{}}]*\\}/g;\n\n/**\n * @private\n * @param {string} text Text.\n * @param {Object} properties Properties.\n * @return {string} Text.\n */\nfunction fromTemplate(text, properties) {\n  return text.replace(templateRegEx, function (match) {\n    return properties[match.slice(1, -1)] || '';\n  });\n}\n\nlet recordLayer = false;\n\n/**\n * Turns recording of the Mapbox/MapLibre Style's `layer` on and off. When turned on,\n * the layer that a rendered feature belongs to will be set as the feature's\n * `mapbox-layer` property.\n * @param {boolean} record Recording of the style layer is on.\n */\nexport function recordStyleLayer(record = false) {\n  recordLayer = record;\n}\n\nexport const styleFunctionArgs = {};\n\n/**\n * Creates a style function from the `glStyle` object for all layers that use\n * the specified `source`, which needs to be a `\"type\": \"vector\"` or\n * `\"type\": \"geojson\"` source and applies it to the specified OpenLayers layer.\n *\n * Two additional properties will be set on the provided layer:\n *\n *  * `mapbox-source`: The `id` of the Mapbox/MapLibre Style document's source that the\n *    OpenLayers layer was created from. Usually `apply()` creates one\n *    OpenLayers layer per Mapbox/MapLibre Style source, unless the layer stack has\n *    layers from different sources in between.\n *  * `mapbox-layers`: The `id`s of the Mapbox/MapLibre Style document's layers that are\n *    included in the OpenLayers layer.\n *\n * This function also works in a web worker. In worker mode, the main thread needs\n * to listen to messages from the worker and respond with another message to make\n * sure that sprite image loading works:\n *\n * ```js\n *  worker.addEventListener('message', event => {\n *   if (event.data.action === 'loadImage') {\n *     const image = new Image();\n *     image.crossOrigin = 'anonymous';\n *     image.addEventListener('load', function() {\n *       createImageBitmap(image, 0, 0, image.width, image.height).then(imageBitmap => {\n *         worker.postMessage({\n *           action: 'imageLoaded',\n *           image: imageBitmap,\n *           src: event.data.src\n *         }, [imageBitmap]);\n *       });\n *     });\n *     image.src = event.data.src;\n *   }\n * });\n * ```\n *\n * @param {VectorLayer|VectorTileLayer} olLayer OpenLayers layer to\n * apply the style to. In addition to the style, the layer will get two\n * properties: `mapbox-source` will be the `id` of the `glStyle`'s source used\n * for the layer, and `mapbox-layers` will be an array of the `id`s of the\n * `glStyle`'s layers.\n * @param {string|Object} glStyle Mapbox/MapLibre Style object.\n * @param {string|Array<string>} sourceOrLayers `source` key or an array of layer `id`s\n * from the Mapbox/MapLibre Style object. When a `source` key is provided, all layers for\n * the specified source will be included in the style function. When layer `id`s\n * are provided, they must be from layers that use the same source.\n * @param {Array<number>} resolutions\n * Resolutions for mapping resolution to zoom level.\n * @param {Object} spriteData Sprite data from the url specified in\n * the Mapbox/MapLibre Style object's `sprite` property. Only required if a `sprite`\n * property is specified in the Mapbox/MapLibre Style object.\n * @param {string|Request|Response|Promise<string|Request|Response>} spriteImageUrl Sprite image url for the sprite\n * specified in the Mapbox/MapLibre Style object's `sprite` property. Only required if a\n * `sprite` property is specified in the Mapbox/MapLibre Style object.\n * @param {function(Array<string>, string=):Array<string>} getFonts Function that\n * receives a font stack and the url template from the GL style's `metadata['ol:webfonts']`\n * property (if set) as arguments, and returns a (modified) font stack that\n * is available. Font names are the names used in the Mapbox/MapLibre Style object. If\n * not provided, the font stack will be used as-is. This function can also be\n * used for loading web fonts.\n * @param {function(VectorLayer|VectorTileLayer, string):HTMLImageElement|HTMLCanvasElement|string|undefined} [getImage]\n * Function that returns an image or a URL for an image name. If the result is an HTMLImageElement, it must already be\n * loaded. The layer can be used to call layer.changed() when the loading and processing of the image has finished.\n * This function can be used for icons not in the sprite or to override sprite icons.\n * @return {StyleFunction} Style function for use in\n * `ol.layer.Vector` or `ol.layer.VectorTile`.\n */\nexport function stylefunction(\n  olLayer,\n  glStyle,\n  sourceOrLayers,\n  resolutions = defaultResolutions,\n  spriteData = undefined,\n  spriteImageUrl = undefined,\n  getFonts = undefined,\n  getImage = undefined,\n) {\n  if (typeof glStyle == 'string') {\n    glStyle = JSON.parse(glStyle);\n  }\n  if (glStyle.version != 8) {\n    throw new Error('glStyle version 8 required.');\n  }\n  styleFunctionArgs[getStyleFunctionKey(glStyle, olLayer)] =\n    Array.from(arguments);\n\n  let spriteImage, spriteImageSize;\n  let spriteImageUnSDFed;\n\n  if (spriteImageUrl) {\n    toPromise(() => spriteImageUrl).then(async (spriteImageUrl) => {\n      let blobUrl;\n      if (typeof Image !== 'undefined') {\n        const img = new Image();\n        if (typeof spriteImageUrl === 'string') {\n          img.crossOrigin = 'anonymous';\n          img.src = spriteImageUrl;\n        } else {\n          let response;\n          if (spriteImageUrl instanceof Request) {\n            response = await fetch(spriteImageUrl);\n          } else if (spriteImageUrl instanceof Response) {\n            response = spriteImageUrl;\n          }\n          const blob = await response.blob();\n          blobUrl = URL.createObjectURL(blob);\n          img.src = blobUrl;\n        }\n        img.addEventListener('load', function load() {\n          img.removeEventListener('load', load);\n          spriteImage = img;\n          spriteImageSize = [img.width, img.height];\n          olLayer.changed();\n          if (blobUrl) {\n            URL.revokeObjectURL(blobUrl);\n          }\n        });\n        img.addEventListener('error', function error() {\n          URL.revokeObjectURL(blobUrl);\n          img.removeEventListener('error', error);\n        });\n      } else if (\n        typeof WorkerGlobalScope !== 'undefined' &&\n        self instanceof WorkerGlobalScope // eslint-disable-line\n      ) {\n        const worker = /** @type {*} */ (self);\n        // Main thread needs to handle 'loadImage' and dispatch 'imageLoaded'\n        worker.postMessage({\n          action: 'loadImage',\n          src: spriteImageUrl,\n        });\n        worker.addEventListener('message', function handler(event) {\n          if (\n            event.data.action === 'imageLoaded' &&\n            event.data.src === spriteImageUrl\n          ) {\n            spriteImage = event.data.image;\n            spriteImageSize = [spriteImage.width, spriteImage.height];\n          }\n        });\n      }\n    });\n  }\n\n  const allLayers = derefLayers(glStyle.layers);\n\n  const layersBySourceLayer = {};\n  const mapboxLayers = [];\n\n  const iconImageCache = {};\n  const patternCache = {};\n  const functionCache = getFunctionCache(glStyle);\n  const filterCache = getFilterCache(glStyle);\n\n  let mapboxSource;\n  for (let i = 0, ii = allLayers.length; i < ii; ++i) {\n    const layer = allLayers[i];\n    const layerId = layer.id;\n    if (\n      (typeof sourceOrLayers == 'string' && layer.source == sourceOrLayers) ||\n      (Array.isArray(sourceOrLayers) && sourceOrLayers.indexOf(layerId) !== -1)\n    ) {\n      const sourceLayer = layer['source-layer'];\n      if (!mapboxSource) {\n        mapboxSource = layer.source;\n        const source = glStyle.sources[mapboxSource];\n        if (!source) {\n          throw new Error(`Source \"${mapboxSource}\" is not defined`);\n        }\n        const type = source.type;\n        if (type !== 'vector' && type !== 'geojson') {\n          throw new Error(\n            `Source \"${mapboxSource}\" is not of type \"vector\" or \"geojson\", but \"${type}\"`,\n          );\n        }\n      } else if (layer.source !== mapboxSource) {\n        throw new Error(\n          `Layer \"${layerId}\" does not use source \"${mapboxSource}`,\n        );\n      }\n      let layers = layersBySourceLayer[sourceLayer];\n      if (!layers) {\n        layers = [];\n        layersBySourceLayer[sourceLayer] = layers;\n      }\n      layers.push({\n        layer: layer,\n        index: i,\n      });\n      mapboxLayers.push(layerId);\n    }\n  }\n\n  const textHalo = new Stroke();\n  const textColor = new Fill();\n\n  const styles = [];\n\n  /**\n   * @param {import(\"ol/Feature\").default|import(\"ol/render/Feature\").default} feature Feature.\n   * @param {number} resolution Resolution.\n   * @param {string} [onlyLayer] Calculate style for this layer only.\n   * @return {Array<import(\"ol/style/Style\").default>} Style.\n   */\n  const styleFunction = function (feature, resolution, onlyLayer) {\n    const properties = feature.getProperties();\n    const layers = layersBySourceLayer[properties.layer];\n    if (!layers) {\n      return undefined;\n    }\n    let zoom = resolutions.indexOf(resolution);\n    if (zoom == -1) {\n      zoom = getZoomForResolution(resolution, resolutions);\n    }\n    const type = types[feature.getGeometry().getType()];\n    const f = {\n      id: feature.getId(),\n      properties: properties,\n      type: type,\n    };\n    const featureState = olLayer.get('mapbox-featurestate')[feature.getId()];\n    let stylesLength = -1;\n    let featureBelongsToLayer;\n    for (let i = 0, ii = layers.length; i < ii; ++i) {\n      const layerData = layers[i];\n      const layer = layerData.layer;\n      const layerId = layer.id;\n      if (onlyLayer !== undefined && onlyLayer !== layerId) {\n        continue;\n      }\n\n      const layout = layer.layout || emptyObj;\n      const paint = layer.paint || emptyObj;\n      if (\n        layout.visibility === 'none' ||\n        ('minzoom' in layer && zoom < layer.minzoom) ||\n        ('maxzoom' in layer && zoom >= layer.maxzoom)\n      ) {\n        continue;\n      }\n      const filter = layer.filter;\n      if (!filter || evaluateFilter(layerId, filter, f, zoom, filterCache)) {\n        featureBelongsToLayer = layer;\n        let color, opacity, fill, stroke, strokeColor, style;\n        const index = layerData.index;\n        if (\n          type == 3 &&\n          (layer.type == 'fill' || layer.type == 'fill-extrusion')\n        ) {\n          opacity = getValue(\n            layer,\n            'paint',\n            layer.type + '-opacity',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          if (layer.type + '-pattern' in paint) {\n            const fillIcon = getValue(\n              layer,\n              'paint',\n              layer.type + '-pattern',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            );\n            if (fillIcon) {\n              const icon =\n                typeof fillIcon === 'string'\n                  ? fromTemplate(fillIcon, properties)\n                  : fillIcon.toString();\n              if (spriteImage && spriteData && spriteData[icon]) {\n                ++stylesLength;\n                style = styles[stylesLength];\n                if (\n                  !style ||\n                  !style.getFill() ||\n                  style.getStroke() ||\n                  style.getText()\n                ) {\n                  style = new Style({\n                    fill: new Fill(),\n                  });\n                  styles[stylesLength] = style;\n                }\n                fill = style.getFill();\n                style.setZIndex(index);\n                const icon_cache_key = icon + '.' + opacity;\n                let pattern = patternCache[icon_cache_key];\n                if (!pattern) {\n                  const spriteImageData = spriteData[icon];\n                  const canvas = createCanvas(\n                    spriteImageData.width,\n                    spriteImageData.height,\n                  );\n                  const ctx = /** @type {CanvasRenderingContext2D} */ (\n                    canvas.getContext('2d')\n                  );\n                  ctx.globalAlpha = opacity;\n                  ctx.drawImage(\n                    spriteImage,\n                    spriteImageData.x,\n                    spriteImageData.y,\n                    spriteImageData.width,\n                    spriteImageData.height,\n                    0,\n                    0,\n                    spriteImageData.width,\n                    spriteImageData.height,\n                  );\n                  pattern = ctx.createPattern(canvas, 'repeat');\n                  patternCache[icon_cache_key] = pattern;\n                }\n                fill.setColor(pattern);\n              }\n            }\n          } else {\n            color = colorWithOpacity(\n              getValue(\n                layer,\n                'paint',\n                layer.type + '-color',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n              opacity,\n            );\n            if (layer.type + '-outline-color' in paint) {\n              strokeColor = colorWithOpacity(\n                getValue(\n                  layer,\n                  'paint',\n                  layer.type + '-outline-color',\n                  zoom,\n                  f,\n                  functionCache,\n                  featureState,\n                ),\n                opacity,\n              );\n            }\n            if (!strokeColor) {\n              strokeColor = color;\n            }\n            if (color || strokeColor) {\n              ++stylesLength;\n              style = styles[stylesLength];\n              if (\n                !style ||\n                (color && !style.getFill()) ||\n                (!color && style.getFill()) ||\n                (strokeColor && !style.getStroke()) ||\n                (!strokeColor && style.getStroke()) ||\n                style.getText()\n              ) {\n                style = new Style({\n                  fill: color ? new Fill() : undefined,\n                  stroke: strokeColor ? new Stroke() : undefined,\n                });\n                styles[stylesLength] = style;\n              }\n              if (color) {\n                fill = style.getFill();\n                fill.setColor(color);\n              }\n              if (strokeColor) {\n                stroke = style.getStroke();\n                stroke.setColor(strokeColor);\n                stroke.setWidth(0.5);\n              }\n              style.setZIndex(index);\n            }\n          }\n        }\n        if (type != 1 && layer.type == 'line') {\n          if (!('line-pattern' in paint)) {\n            color = colorWithOpacity(\n              getValue(\n                layer,\n                'paint',\n                'line-color',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n              getValue(\n                layer,\n                'paint',\n                'line-opacity',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n            );\n          } else {\n            color = undefined;\n          }\n          const width = getValue(\n            layer,\n            'paint',\n            'line-width',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          if (color && width > 0) {\n            ++stylesLength;\n            style = styles[stylesLength];\n            if (\n              !style ||\n              !style.getStroke() ||\n              style.getFill() ||\n              style.getText()\n            ) {\n              style = new Style({\n                stroke: new Stroke(),\n              });\n              styles[stylesLength] = style;\n            }\n            stroke = style.getStroke();\n            stroke.setLineCap(\n              getValue(\n                layer,\n                'layout',\n                'line-cap',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n            );\n            stroke.setLineJoin(\n              getValue(\n                layer,\n                'layout',\n                'line-join',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n            );\n            stroke.setMiterLimit(\n              getValue(\n                layer,\n                'layout',\n                'line-miter-limit',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n            );\n            stroke.setColor(color);\n            stroke.setWidth(width);\n            stroke.setLineDash(\n              paint['line-dasharray']\n                ? getValue(\n                    layer,\n                    'paint',\n                    'line-dasharray',\n                    zoom,\n                    f,\n                    functionCache,\n                    featureState,\n                  ).map(function (x) {\n                    return x * width;\n                  })\n                : null,\n            );\n            style.setZIndex(index);\n          }\n        }\n\n        let hasImage = false;\n        let text = null;\n        let placementAngle = 0;\n        let icon, iconImg, skipLabel;\n        if ((type == 1 || type == 2) && 'icon-image' in layout) {\n          const iconImage = getValue(\n            layer,\n            'layout',\n            'icon-image',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          if (iconImage) {\n            icon =\n              typeof iconImage === 'string'\n                ? fromTemplate(iconImage, properties)\n                : iconImage.toString();\n            let styleGeom = undefined;\n            const imageElement = getImage ? getImage(olLayer, icon) : undefined;\n            if (\n              (spriteImage && spriteData && spriteData[icon]) ||\n              imageElement\n            ) {\n              const iconRotationAlignment = getValue(\n                layer,\n                'layout',\n                'icon-rotation-alignment',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              );\n              if (type == 2) {\n                const geom = /** @type {*} */ (feature.getGeometry());\n                // ol package and ol-debug.js only\n                if (geom.getFlatMidpoint || geom.getFlatMidpoints) {\n                  const extent = geom.getExtent();\n                  const size = Math.sqrt(\n                    Math.max(\n                      Math.pow((extent[2] - extent[0]) / resolution, 2),\n                      Math.pow((extent[3] - extent[1]) / resolution, 2),\n                    ),\n                  );\n                  if (size > 150) {\n                    //FIXME Do not hard-code a size of 150\n                    const midpoint =\n                      geom.getType() === 'MultiLineString'\n                        ? geom.getFlatMidpoints()\n                        : geom.getFlatMidpoint();\n                    if (!renderFeature) {\n                      renderFeatureCoordinates = [NaN, NaN];\n                      renderFeature = new RenderFeature(\n                        'Point',\n                        renderFeatureCoordinates,\n                        [],\n                        2,\n                        {},\n                        undefined,\n                      );\n                    }\n                    styleGeom = renderFeature;\n                    renderFeatureCoordinates[0] = midpoint[0];\n                    renderFeatureCoordinates[1] = midpoint[1];\n                    const placement = getValue(\n                      layer,\n                      'layout',\n                      'symbol-placement',\n                      zoom,\n                      f,\n                      functionCache,\n                      featureState,\n                    );\n                    if (\n                      placement === 'line' &&\n                      iconRotationAlignment === 'map'\n                    ) {\n                      const stride = geom.getStride();\n                      const coordinates = geom.getFlatCoordinates();\n                      for (\n                        let i = 0, ii = coordinates.length - stride;\n                        i < ii;\n                        i += stride\n                      ) {\n                        const x1 = coordinates[i];\n                        const y1 = coordinates[i + 1];\n                        const x2 = coordinates[i + stride];\n                        const y2 = coordinates[i + stride + 1];\n                        const minX = Math.min(x1, x2);\n                        const maxX = Math.max(x1, x2);\n                        const xM = midpoint[0];\n                        const yM = midpoint[1];\n                        const dotProduct =\n                          (y2 - y1) * (xM - x1) - (x2 - x1) * (yM - y1);\n                        if (\n                          Math.abs(dotProduct) < 0.001 && //midpoint is aligned with the segment\n                          xM <= maxX &&\n                          xM >= minX //midpoint is on the segment and not outside it\n                        ) {\n                          placementAngle = Math.atan2(y1 - y2, x2 - x1);\n                          break;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n              if (type !== 2 || styleGeom) {\n                const iconSize = getValue(\n                  layer,\n                  'layout',\n                  'icon-size',\n                  zoom,\n                  f,\n                  functionCache,\n                  featureState,\n                );\n                const iconColor =\n                  paint['icon-color'] !== undefined\n                    ? getValue(\n                        layer,\n                        'paint',\n                        'icon-color',\n                        zoom,\n                        f,\n                        functionCache,\n                        featureState,\n                      )\n                    : null;\n                if (!iconColor || iconColor.a !== 0) {\n                  const haloColor = getValue(\n                    layer,\n                    'paint',\n                    'icon-halo-color',\n                    zoom,\n                    f,\n                    functionCache,\n                    featureState,\n                  );\n                  const haloWidth = getValue(\n                    layer,\n                    'paint',\n                    'icon-halo-width',\n                    zoom,\n                    f,\n                    functionCache,\n                    featureState,\n                  );\n                  let iconCacheKey = `${icon}.${iconSize}.${haloWidth}.${haloColor}`;\n                  if (iconColor !== null) {\n                    iconCacheKey += `.${iconColor}`;\n                  }\n                  iconImg = iconImageCache[iconCacheKey];\n                  if (!iconImg) {\n                    const declutterMode = getDeclutterMode(\n                      layer,\n                      zoom,\n                      f,\n                      'icon',\n                      functionCache,\n                    );\n                    let displacement;\n                    if ('icon-offset' in layout) {\n                      displacement = getValue(\n                        layer,\n                        'layout',\n                        'icon-offset',\n                        zoom,\n                        f,\n                        functionCache,\n                        featureState,\n                      ).slice(0);\n                      displacement[0] *= iconSize;\n                      displacement[1] *= -iconSize;\n                    }\n                    let color = iconColor\n                      ? [\n                          iconColor.r * 255,\n                          iconColor.g * 255,\n                          iconColor.b * 255,\n                          iconColor.a,\n                        ]\n                      : undefined;\n                    if (imageElement) {\n                      const iconOptions = {\n                        color: color,\n                        rotateWithView: iconRotationAlignment === 'map',\n                        displacement: displacement,\n                        declutterMode: declutterMode,\n                        scale: iconSize,\n                      };\n                      if (typeof imageElement === 'string') {\n                        // it is a src URL\n                        iconOptions.src = imageElement;\n                      } else {\n                        iconOptions.img = imageElement;\n                        iconOptions.imgSize = [\n                          imageElement.width,\n                          imageElement.height,\n                        ];\n                      }\n                      iconImg = new Icon(iconOptions);\n                    } else {\n                      const spriteImageData = spriteData[icon];\n                      let img, size, offset;\n                      if (haloWidth) {\n                        if (spriteImageData.sdf) {\n                          img = drawIconHalo(\n                            drawSDF(\n                              spriteImage,\n                              spriteImageData,\n                              iconColor || [0, 0, 0, 1],\n                            ),\n                            {\n                              x: 0,\n                              y: 0,\n                              width: spriteImageData.width,\n                              height: spriteImageData.height,\n                              pixelRatio: spriteImageData.pixelRatio,\n                            },\n                            haloWidth,\n                            haloColor,\n                          );\n                          color = undefined; // do not tint haloed icons\n                        } else {\n                          img = drawIconHalo(\n                            spriteImage,\n                            spriteImageData,\n                            haloWidth,\n                            haloColor,\n                          );\n                        }\n                      } else {\n                        if (spriteImageData.sdf) {\n                          if (!spriteImageUnSDFed) {\n                            spriteImageUnSDFed = drawSDF(\n                              spriteImage,\n                              {\n                                x: 0,\n                                y: 0,\n                                width: spriteImageSize[0],\n                                height: spriteImageSize[1],\n                              },\n                              {r: 1, g: 1, b: 1, a: 1},\n                            );\n                          }\n                          img = spriteImageUnSDFed;\n                        } else {\n                          img = spriteImage;\n                        }\n                        size = [spriteImageData.width, spriteImageData.height];\n                        offset = [spriteImageData.x, spriteImageData.y];\n                      }\n                      iconImg = new Icon({\n                        color: color,\n                        img: img,\n                        // @ts-ignore\n                        imgSize: spriteImageSize,\n                        size: size,\n                        offset: offset,\n                        rotateWithView: iconRotationAlignment === 'map',\n                        scale: iconSize / spriteImageData.pixelRatio,\n                        displacement: displacement,\n                        declutterMode: declutterMode,\n                      });\n                    }\n                    iconImageCache[iconCacheKey] = iconImg;\n                  }\n                }\n                if (iconImg) {\n                  ++stylesLength;\n                  style = styles[stylesLength];\n                  if (\n                    !style ||\n                    !style.getImage() ||\n                    style.getFill() ||\n                    style.getStroke()\n                  ) {\n                    style = new Style();\n                    styles[stylesLength] = style;\n                  }\n                  style.setGeometry(styleGeom);\n                  iconImg.setRotation(\n                    placementAngle +\n                      deg2rad(\n                        getValue(\n                          layer,\n                          'layout',\n                          'icon-rotate',\n                          zoom,\n                          f,\n                          functionCache,\n                          featureState,\n                        ),\n                      ),\n                  );\n                  iconImg.setOpacity(\n                    getValue(\n                      layer,\n                      'paint',\n                      'icon-opacity',\n                      zoom,\n                      f,\n                      functionCache,\n                      featureState,\n                    ),\n                  );\n                  iconImg.setAnchor(\n                    anchor[\n                      getValue(\n                        layer,\n                        'layout',\n                        'icon-anchor',\n                        zoom,\n                        f,\n                        functionCache,\n                        featureState,\n                      )\n                    ],\n                  );\n                  style.setImage(iconImg);\n                  text = style.getText();\n                  style.setText(undefined);\n                  style.setZIndex(index);\n                  hasImage = true;\n                  skipLabel = false;\n                }\n              } else {\n                skipLabel = true;\n              }\n            }\n          }\n        }\n\n        if (type == 1 && layer.type === 'circle') {\n          ++stylesLength;\n          style = styles[stylesLength];\n          if (\n            !style ||\n            !style.getImage() ||\n            style.getFill() ||\n            style.getStroke()\n          ) {\n            style = new Style();\n            styles[stylesLength] = style;\n          }\n          const circleRadius =\n            'circle-radius' in paint\n              ? getValue(\n                  layer,\n                  'paint',\n                  'circle-radius',\n                  zoom,\n                  f,\n                  functionCache,\n                  featureState,\n                )\n              : 5;\n          const circleStrokeColor = colorWithOpacity(\n            getValue(\n              layer,\n              'paint',\n              'circle-stroke-color',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n            getValue(\n              layer,\n              'paint',\n              'circle-stroke-opacity',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n          );\n\n          const circleTranslate = getValue(\n            layer,\n            'paint',\n            'circle-translate',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const circleColor = colorWithOpacity(\n            getValue(\n              layer,\n              'paint',\n              'circle-color',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n            getValue(\n              layer,\n              'paint',\n              'circle-opacity',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n          );\n          const circleStrokeWidth = getValue(\n            layer,\n            'paint',\n            'circle-stroke-width',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const cache_key =\n            circleRadius +\n            '.' +\n            circleStrokeColor +\n            '.' +\n            circleColor +\n            '.' +\n            circleStrokeWidth +\n            '.' +\n            circleTranslate[0] +\n            '.' +\n            circleTranslate[1];\n\n          iconImg = iconImageCache[cache_key];\n          if (!iconImg) {\n            iconImg = new Circle({\n              radius: circleRadius,\n              displacement: [circleTranslate[0], -circleTranslate[1]],\n              stroke:\n                circleStrokeColor && circleStrokeWidth > 0\n                  ? new Stroke({\n                      width: circleStrokeWidth,\n                      color: circleStrokeColor,\n                    })\n                  : undefined,\n              fill: circleColor\n                ? new Fill({\n                    color: circleColor,\n                  })\n                : undefined,\n              declutterMode: 'none',\n            });\n            iconImageCache[cache_key] = iconImg;\n          }\n          style.setImage(iconImg);\n          text = style.getText();\n          style.setText(undefined);\n          style.setGeometry(undefined);\n          style.setZIndex(index);\n          hasImage = true;\n        }\n\n        let label, font, textLineHeight, textSize, letterSpacing, maxTextWidth;\n        if ('text-field' in layout) {\n          textSize = Math.round(\n            getValue(\n              layer,\n              'layout',\n              'text-size',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n          );\n          const fontArray = getValue(\n            layer,\n            'layout',\n            'text-font',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          textLineHeight = getValue(\n            layer,\n            'layout',\n            'text-line-height',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          font = mb2css(\n            getFonts\n              ? getFonts(\n                  fontArray,\n                  glStyle.metadata\n                    ? glStyle.metadata['ol:webfonts']\n                    : undefined,\n                )\n              : fontArray,\n            textSize,\n            textLineHeight,\n          );\n          if (!font.includes('sans-serif')) {\n            font += ',sans-serif';\n          }\n          letterSpacing = getValue(\n            layer,\n            'layout',\n            'text-letter-spacing',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          maxTextWidth = getValue(\n            layer,\n            'layout',\n            'text-max-width',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const textField = getValue(\n            layer,\n            'layout',\n            'text-field',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          if (typeof textField === 'object' && textField.sections) {\n            if (textField.sections.length === 1) {\n              label = textField.toString();\n            } else {\n              label = textField.sections.reduce((acc, chunk, i) => {\n                const fonts = chunk.fontStack\n                  ? chunk.fontStack.split(',')\n                  : fontArray;\n                const chunkFont = mb2css(\n                  getFonts ? getFonts(fonts) : fonts,\n                  textSize * (chunk.scale || 1),\n                  textLineHeight,\n                );\n                let text = chunk.text;\n                if (text === '\\n') {\n                  acc.push('\\n', '');\n                  return acc;\n                }\n                if (type == 2) {\n                  acc.push(applyLetterSpacing(text, letterSpacing), chunkFont);\n                  return acc;\n                }\n                text = wrapText(\n                  text,\n                  chunkFont,\n                  maxTextWidth,\n                  letterSpacing,\n                ).split('\\n');\n                for (let i = 0, ii = text.length; i < ii; ++i) {\n                  if (i > 0) {\n                    acc.push('\\n', '');\n                  }\n                  acc.push(text[i], chunkFont);\n                }\n                return acc;\n              }, []);\n            }\n          } else {\n            label = fromTemplate(textField, properties).trim();\n          }\n          opacity = getValue(\n            layer,\n            'paint',\n            'text-opacity',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n        }\n        if (label && opacity && !skipLabel) {\n          if (!hasImage) {\n            ++stylesLength;\n            style = styles[stylesLength];\n            if (\n              !style ||\n              !style.getText() ||\n              style.getFill() ||\n              style.getStroke()\n            ) {\n              style = new Style();\n              styles[stylesLength] = style;\n            }\n            style.setImage(undefined);\n            style.setGeometry(undefined);\n          }\n          const declutterMode = getDeclutterMode(\n            layer,\n            zoom,\n            f,\n            'text',\n            functionCache,\n          );\n          if (!style.getText()) {\n            style.setText(text);\n          }\n          text = style.getText();\n          if (\n            !text ||\n            ('getDeclutterMode' in text &&\n              text.getDeclutterMode() !== declutterMode)\n          ) {\n            text = new Text({\n              padding: [2, 2, 2, 2],\n              // @ts-ignore\n              declutterMode: declutterMode,\n            });\n            style.setText(text);\n          }\n          const textTransform = getValue(\n            layer,\n            'layout',\n            'text-transform',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          if (textTransform == 'uppercase') {\n            label = Array.isArray(label)\n              ? label.map((t, i) => (i % 2 ? t : t.toUpperCase()))\n              : label.toUpperCase();\n          } else if (textTransform == 'lowercase') {\n            label = Array.isArray(label)\n              ? label.map((t, i) => (i % 2 ? t : t.toLowerCase()))\n              : label.toLowerCase();\n          }\n          const wrappedLabel = Array.isArray(label)\n            ? label\n            : type == 2\n              ? applyLetterSpacing(label, letterSpacing)\n              : wrapText(label, font, maxTextWidth, letterSpacing);\n          text.setText(wrappedLabel);\n          text.setFont(font);\n          text.setRotation(\n            deg2rad(\n              getValue(\n                layer,\n                'layout',\n                'text-rotate',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n            ),\n          );\n          if (typeof text.setKeepUpright === 'function') {\n            const keepUpright = getValue(\n              layer,\n              'layout',\n              'text-keep-upright',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            );\n            text.setKeepUpright(keepUpright);\n          }\n          const textAnchor = getValue(\n            layer,\n            'layout',\n            'text-anchor',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const placement =\n            hasImage || type == 1\n              ? 'point'\n              : getValue(\n                  layer,\n                  'layout',\n                  'symbol-placement',\n                  zoom,\n                  f,\n                  functionCache,\n                  featureState,\n                );\n          let textAlign;\n          if (placement === 'line-center') {\n            text.setPlacement('line');\n            textAlign = 'center';\n          } else {\n            text.setPlacement(placement);\n          }\n          if (placement === 'line' && typeof text.setRepeat === 'function') {\n            const symbolSpacing = getValue(\n              layer,\n              'layout',\n              'symbol-spacing',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            );\n            text.setRepeat(symbolSpacing * 2);\n          }\n          text.setOverflow(placement === 'point');\n          let textHaloWidth = getValue(\n            layer,\n            'paint',\n            'text-halo-width',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const textOffset = getValue(\n            layer,\n            'layout',\n            'text-offset',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const textTranslate = getValue(\n            layer,\n            'paint',\n            'text-translate',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          // Text offset has to take halo width and line height into account\n          let vOffset = 0;\n          let hOffset = 0;\n          if (placement == 'point') {\n            textAlign = 'center';\n            if (textAnchor.indexOf('left') !== -1) {\n              textAlign = 'left';\n              hOffset = textHaloWidth;\n            } else if (textAnchor.indexOf('right') !== -1) {\n              textAlign = 'right';\n              hOffset = -textHaloWidth;\n            }\n            const textRotationAlignment = getValue(\n              layer,\n              'layout',\n              'text-rotation-alignment',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            );\n            text.setRotateWithView(textRotationAlignment == 'map');\n          } else {\n            text.setMaxAngle(\n              (deg2rad(\n                getValue(\n                  layer,\n                  'layout',\n                  'text-max-angle',\n                  zoom,\n                  f,\n                  functionCache,\n                  featureState,\n                ),\n              ) *\n                label.length) /\n                wrappedLabel.length,\n            );\n            text.setRotateWithView(false);\n          }\n          text.setTextAlign(textAlign);\n          let textBaseline = 'middle';\n          if (textAnchor.indexOf('bottom') == 0) {\n            textBaseline = 'bottom';\n            vOffset = -textHaloWidth - 0.5 * (textLineHeight - 1) * textSize;\n          } else if (textAnchor.indexOf('top') == 0) {\n            textBaseline = 'top';\n            vOffset = textHaloWidth + 0.5 * (textLineHeight - 1) * textSize;\n          }\n          text.setTextBaseline(textBaseline);\n          const textJustify = getValue(\n            layer,\n            'layout',\n            'text-justify',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          text.setJustify(textJustify === 'auto' ? undefined : textJustify);\n          text.setOffsetX(\n            textOffset[0] * textSize + hOffset + textTranslate[0],\n          );\n          text.setOffsetY(\n            textOffset[1] * textSize + vOffset + textTranslate[1],\n          );\n          textColor.setColor(\n            colorWithOpacity(\n              getValue(\n                layer,\n                'paint',\n                'text-color',\n                zoom,\n                f,\n                functionCache,\n                featureState,\n              ),\n              opacity,\n            ),\n          );\n          text.setFill(textColor);\n          const haloColor = colorWithOpacity(\n            getValue(\n              layer,\n              'paint',\n              'text-halo-color',\n              zoom,\n              f,\n              functionCache,\n              featureState,\n            ),\n            opacity,\n          );\n          if (haloColor && textHaloWidth > 0) {\n            textHalo.setColor(haloColor);\n            // spec here : https://docs.mapbox.com/mapbox-gl-js/style-spec/#paint-symbol-text-halo-width\n            // Halo width must be doubled because it is applied around the center of the text outline\n            textHaloWidth *= 2;\n            // 1/4 of text size (spec) x 2\n            const halfTextSize = 0.5 * textSize;\n            textHalo.setWidth(\n              textHaloWidth <= halfTextSize ? textHaloWidth : halfTextSize,\n            );\n            text.setStroke(textHalo);\n          } else {\n            text.setStroke(undefined);\n          }\n          const textPadding = getValue(\n            layer,\n            'layout',\n            'text-padding',\n            zoom,\n            f,\n            functionCache,\n            featureState,\n          );\n          const padding = text.getPadding();\n          if (textPadding !== padding[0]) {\n            padding[0] = textPadding;\n            padding[1] = textPadding;\n            padding[2] = textPadding;\n            padding[3] = textPadding;\n          }\n          style.setZIndex(index);\n        }\n      }\n    }\n\n    if (stylesLength > -1) {\n      styles.length = stylesLength + 1;\n      if (recordLayer) {\n        if ('set' in feature) {\n          // ol/Feature\n          feature.set('mapbox-layer', featureBelongsToLayer);\n        } else {\n          // ol/render/Feature\n          feature.getProperties()['mapbox-layer'] = featureBelongsToLayer;\n        }\n      }\n      return styles;\n    }\n    return undefined;\n  };\n\n  olLayer.setStyle(styleFunction);\n  olLayer.set('mapbox-source', mapboxSource);\n  olLayer.set('mapbox-layers', mapboxLayers);\n  olLayer.set('mapbox-featurestate', olLayer.get('mapbox-featurestate') || {});\n  return styleFunction;\n}\n\n/**\n * Get the the style for a specific Mapbox layer only. This can be useful for creating a legend.\n * @param {import(\"ol/Feature\").default|import(\"ol/render/Feature\").default} feature OpenLayers feature.\n * @param {number} resolution View resolution.\n * @param {import(\"ol/layer\").Vector|import(\"ol/layer\").VectorTile} olLayer OpenLayers layer.\n * @param {string} layerId Id of the Mapbox layer to get the style for\n * @return {Array<import(\"ol/style\").Style>} Styles for the provided Mapbox layer.\n */\nexport function getStyleForLayer(feature, resolution, olLayer, layerId) {\n  const evaluateStyle = olLayer.getStyleFunction();\n  if (evaluateStyle.length === 3) {\n    // @ts-ignore\n    return evaluateStyle(feature, resolution, layerId);\n  }\n  return undefined;\n}\n\nexport {\n  colorWithOpacity as _colorWithOpacity,\n  evaluateFilter as _evaluateFilter,\n  fromTemplate as _fromTemplate,\n  getValue as _getValue,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = ol.Map;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.View;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.layer.Group;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.layer.Image;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.layer.Layer;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.loadingstrategy;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.proj.Units;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.tilegrid.TileGrid;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.source.Raster;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.source.Source;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.tilegrid;","/*\nol-mapbox-style - Use Mapbox/MapLibre Style objects with OpenLayers\nCopyright 2016-present ol-mapbox-style contributors\nLicense: https://raw.githubusercontent.com/openlayers/ol-mapbox-style/master/LICENSE\n*/\n\nimport {derefLayers} from '@maplibre/maplibre-gl-style-spec';\nimport Map from 'ol/Map.js';\nimport View from 'ol/View.js';\nimport {getCenter, getTopLeft} from 'ol/extent.js';\nimport GeoJSON from 'ol/format/GeoJSON.js';\nimport MVT from 'ol/format/MVT.js';\nimport LayerGroup from 'ol/layer/Group.js';\nimport ImageLayer from 'ol/layer/Image.js';\nimport Layer from 'ol/layer/Layer.js';\nimport TileLayer from 'ol/layer/Tile.js';\nimport VectorLayer from 'ol/layer/Vector.js';\nimport VectorTileLayer from 'ol/layer/VectorTile.js';\nimport {bbox as bboxStrategy} from 'ol/loadingstrategy.js';\nimport {METERS_PER_UNIT} from 'ol/proj/Units.js';\nimport {\n  equivalent,\n  fromLonLat,\n  get as getProjection,\n  getPointResolution,\n  getUserProjection,\n} from 'ol/proj.js';\nimport Raster from 'ol/source/Raster.js';\nimport Source from 'ol/source/Source.js';\nimport TileJSON from 'ol/source/TileJSON.js';\nimport VectorSource from 'ol/source/Vector.js';\nimport VectorTileSource, {defaultLoadFunction} from 'ol/source/VectorTile.js';\nimport TileGrid from 'ol/tilegrid/TileGrid.js';\nimport {createXYZ} from 'ol/tilegrid.js';\nimport {\n  normalizeSourceUrl,\n  normalizeSpriteUrl,\n  normalizeStyleUrl,\n} from './mapbox.js';\nimport {hillshade} from './shaders.js';\nimport {\n  _colorWithOpacity,\n  getValue,\n  styleFunctionArgs,\n  stylefunction as applyStylefunction,\n} from './stylefunction.js';\nimport {getFonts} from './text.js';\nimport {\n  defaultResolutions,\n  fetchResource,\n  getFilterCache,\n  getFunctionCache,\n  getGlStyle,\n  getResolutionForZoom,\n  getStyleFunctionKey,\n  getTileJson,\n  getZoomForResolution,\n} from './util.js';\n\n/**\n * @typedef {Object} FeatureIdentifier\n * @property {string|number} id The feature id.\n * @property {string} source The source id.\n */\n\n/**\n * @typedef {Object} Options\n * @property {string} [accessToken] Access token for 'mapbox://' urls.\n * @property {function(string, import(\"./util.js\").ResourceType): (Request|string|Response|Promise<Request|string|Response>|void)} [transformRequest]\n * Function for controlling how `ol-mapbox-style` fetches resources. Can be used for modifying\n * the url, adding headers or setting credentials options. Called with the url and the resource\n * type as arguments, this function is supposed to return a `Request`, a url `string` or a `Response`, or a promise tehereof.\n * Without a return value the original request will not be modified.\n * @property {string} [projection='EPSG:3857'] Only useful when working with non-standard projections.\n * Code of a projection registered with OpenLayers. All sources of the style must be provided in this\n * projection. The projection must also have a valid extent defined, which will be used to determine the\n * origin and resolutions of the tile grid for all tiled sources of the style. When provided, the bbox\n * placeholder in tile and geojson urls changes: the default is `{bbox-epsg-3857}`, when projection is e.g.\n * set to `EPSG:4326`, the bbox placeholder will be `{bbox-epsg-4326}`.\n * @property {Array<number>} [resolutions] Only useful when working with non-standard projections.\n * Resolutions for mapping resolution to the `zoom` used in the Mapbox/MapLibre style.\n * @property {string} [styleUrl] URL of the Mapbox GL style. Required for styles that were provided\n * as object, when they contain a relative sprite url, or sources referencing data by relative url.\n * @property {string} [webfonts] Template for resolving webfonts. Can be used to specify where to fetch\n * web fonts when no `ol:webfonts` metadata is set in the style object. See `getFonts()` and the\n * \"Font handling\" section in `README.md` for details.\n * @property {function(VectorLayer|VectorTileLayer, string):HTMLImageElement|HTMLCanvasElement|string|undefined} [getImage=undefined]\n * Function that returns an image for an icon name. If the result is an HTMLImageElement, it must already be\n * loaded. The layer can be used to call layer.changed() when the loading and processing of the image has finished.\n * This function be used for icons not in the sprite or to override sprite icons.\n * @property {string} [accessTokenParam='access_token'] Access token param. For internal use.\n */\n\n/**\n * @typedef {Object} ApplyStyleOptions\n * @property {string} [source=''] Source. Default is `''`, which causes the first source in the\n * style to be used.\n * @property {Array<string>} [layers] Layers. If no source is provided, the layers with the\n * provided ids will be used from the style's `layers` array. All layers need to use the same source.\n * @property {boolean} [updateSource=true] Update or create vector (tile) layer source with parameters\n * specified for the source in the mapbox style definition.\n */\n\n/**\n * @param {import(\"ol/proj/Projection.js\").default} projection Projection.\n * @param {number} [tileSize] Tile size.\n * @return {Array<number>} Resolutions.\n */\nfunction getTileResolutions(projection, tileSize = 512) {\n  return projection.getExtent()\n    ? createXYZ({\n        extent: projection.getExtent(),\n        tileSize: tileSize,\n        maxZoom: 22,\n      }).getResolutions()\n    : defaultResolutions;\n}\n\n/**\n * @param {string} styleUrl Style URL.\n * @param {Options} options Options.\n * @return {Options} Completed options with accessToken and accessTokenParam.\n */\nfunction completeOptions(styleUrl, options) {\n  if (!options.accessToken) {\n    options = Object.assign({}, options);\n    const searchParams = new URL(styleUrl).searchParams;\n    // The last search parameter is the access token\n    searchParams.forEach((value, key) => {\n      options.accessToken = value;\n      options.accessTokenParam = key;\n    });\n  }\n  return options;\n}\n\n/**\n * Applies a style function to an `ol/layer/VectorTile` or `ol/layer/Vector`\n * with an `ol/source/VectorTile` or an `ol/source/Vector`. If the layer does not have a source\n * yet, it will be created and populated from the information in the `glStyle` (unless `updateSource` is\n * set to `false`).\n *\n * **Example:**\n * ```js\n * import {applyStyle} from 'ol-mapbox-style';\n * import {VectorTile} from 'ol/layer.js';\n *\n * const layer = new VectorTile({declutter: true});\n * applyStyle(layer, 'https://api.maptiler.com/maps/basic/style.json?key=YOUR_OPENMAPTILES_TOKEN');\n * ```\n *\n * The style function will render all layers from the `glStyle` object that use the source\n * of the first layer, the specified `source`, or a subset of layers from the same source. The\n * source needs to be a `\"type\": \"vector\"` or `\"type\": \"geojson\"` source.\n *\n * Two additional properties will be set on the provided layer:\n *\n *  * `mapbox-source`: The `id` of the Mapbox/MapLibre Style document's source that the\n *    OpenLayers layer was created from. Usually `apply()` creates one\n *    OpenLayers layer per Mapbox/MapLibre Style source, unless the layer stack has\n *    layers from different sources in between.\n *  * `mapbox-layers`: The `id`s of the Mapbox/MapLibre Style document's layers that are\n *    included in the OpenLayers layer.\n *\n * @param {VectorTileLayer|VectorLayer} layer OpenLayers layer. When the layer has a source configured,\n * it will be modified to use the configuration from the glStyle's `source`. Options specified on the\n * layer's source will override those from the glStyle's `source`, except for `url` and\n * `tileUrlFunction`. When the source projection is the default (`EPSG:3857`), the `tileGrid` will\n * also be overridden. If you'd rather not have ol-mapbox-style modify the source, configure `applyStyle()`\n * with the `updateSource: false` option.\n * @param {string|Object} glStyle Mapbox/MapLibre Style object.\n * @param {string|Array<string>|Options&ApplyStyleOptions} [sourceOrLayersOrOptions] Options or\n * `source` key or an array of layer `id`s from the Mapbox/MapLibre Style object. When a `source` key is\n * provided, all layers for the specified source will be included in the style function. When layer\n * `id`s are provided, they must be from layers that use the same source. When not provided or a falsey\n * value, all layers using the first source specified in the glStyle will be rendered.\n * @param {Options&ApplyStyleOptions|string} [optionsOrPath] **Deprecated**. Options. Alternatively the path of the style file\n * (only required when a relative path is used for the `\"sprite\"` property of the style).\n * @param {Array<number>} [resolutions] **Deprecated**. Resolutions for mapping resolution to zoom level.\n * Only needed when working with non-standard tile grids or projections, can also be supplied with\n * options.\n * @return {Promise} Promise which will be resolved when the style can be used\n * for rendering.\n */\nexport function applyStyle(\n  layer,\n  glStyle,\n  sourceOrLayersOrOptions = '',\n  optionsOrPath = {},\n  resolutions = undefined,\n) {\n  let styleUrl, sourceId;\n  /** @type {Options&ApplyStyleOptions} */\n  let options;\n  let sourceOrLayers;\n  let updateSource = true;\n  if (\n    typeof sourceOrLayersOrOptions !== 'string' &&\n    !Array.isArray(sourceOrLayersOrOptions)\n  ) {\n    options = sourceOrLayersOrOptions;\n    sourceOrLayers = options.source || options.layers;\n    optionsOrPath = options;\n  } else {\n    sourceOrLayers = sourceOrLayersOrOptions;\n  }\n  if (typeof optionsOrPath === 'string') {\n    styleUrl = optionsOrPath;\n    options = {};\n  } else {\n    styleUrl = optionsOrPath.styleUrl;\n    options = optionsOrPath;\n  }\n  if (options.updateSource === false) {\n    updateSource = false;\n  }\n  if (!resolutions) {\n    resolutions = options.resolutions;\n  }\n  if (\n    !styleUrl &&\n    typeof glStyle === 'string' &&\n    !glStyle.trim().startsWith('{')\n  ) {\n    styleUrl = glStyle;\n  }\n  if (styleUrl) {\n    styleUrl = styleUrl.startsWith('data:')\n      ? location.href\n      : normalizeStyleUrl(styleUrl, options.accessToken);\n    options = completeOptions(styleUrl, options);\n  }\n\n  return new Promise(function (resolve, reject) {\n    // TODO: figure out where best place to check source type is\n    // Note that the source arg is an array of gl layer ids and each must be\n    // dereferenced to get source type to validate\n    getGlStyle(glStyle, options)\n      .then(function (glStyle) {\n        if (glStyle.version != 8) {\n          return reject(new Error('glStyle version 8 required.'));\n        }\n        if (\n          !(layer instanceof VectorLayer || layer instanceof VectorTileLayer)\n        ) {\n          return reject(\n            new Error('Can only apply to VectorLayer or VectorTileLayer'),\n          );\n        }\n\n        const type = layer instanceof VectorTileLayer ? 'vector' : 'geojson';\n        if (!sourceOrLayers) {\n          sourceId = Object.keys(glStyle.sources).find(function (key) {\n            return glStyle.sources[key].type === type;\n          });\n          sourceOrLayers = sourceId;\n        } else if (Array.isArray(sourceOrLayers)) {\n          sourceId = glStyle.layers.find(function (layer) {\n            return layer.id === sourceOrLayers[0];\n          }).source;\n        } else {\n          sourceId = sourceOrLayers;\n        }\n        if (!sourceId) {\n          return reject(new Error(`No ${type} source found in the glStyle.`));\n        }\n\n        function assignSource() {\n          if (!updateSource) {\n            return Promise.resolve();\n          }\n          if (layer instanceof VectorTileLayer) {\n            return setupVectorSource(\n              glStyle.sources[sourceId],\n              styleUrl,\n              options,\n            ).then(function (source) {\n              const targetSource = layer.getSource();\n              if (!targetSource) {\n                layer.setSource(source);\n              } else if (source !== targetSource) {\n                targetSource.setTileUrlFunction(source.getTileUrlFunction());\n                if (\n                  typeof targetSource.setUrls === 'function' &&\n                  typeof source.getUrls === 'function'\n                ) {\n                  // to get correct keys for tile cache and queue\n                  targetSource.setUrls(source.getUrls());\n                }\n                //@ts-ignore\n                if (!targetSource.format_) {\n                  //@ts-ignore\n                  targetSource.format_ = source.format_;\n                }\n                if (!targetSource.getAttributions()) {\n                  targetSource.setAttributions(source.getAttributions());\n                }\n                if (\n                  targetSource.getTileLoadFunction() === defaultLoadFunction\n                ) {\n                  targetSource.setTileLoadFunction(\n                    source.getTileLoadFunction(),\n                  );\n                }\n                if (\n                  equivalent(\n                    targetSource.getProjection(),\n                    source.getProjection(),\n                  )\n                ) {\n                  //@ts-ignore\n                  targetSource.tileGrid = source.getTileGrid();\n                }\n              }\n              const tileGrid = layer.getSource().getTileGrid();\n              if (\n                !isFinite(layer.getMaxResolution()) &&\n                !isFinite(layer.getMinZoom()) &&\n                tileGrid.getMinZoom() > 0\n              ) {\n                layer.setMaxResolution(\n                  getResolutionForZoom(\n                    Math.max(0, tileGrid.getMinZoom() - 1e-12),\n                    tileGrid.getResolutions(),\n                  ),\n                );\n              }\n            });\n          }\n          const glSource = glStyle.sources[sourceId];\n          let source = layer.getSource();\n          if (!source || source.get('mapbox-source') !== glSource) {\n            source = setupGeoJSONSource(glSource, styleUrl, options);\n          }\n          const targetSource = /** @type {VectorSource} */ (layer.getSource());\n          if (!targetSource) {\n            layer.setSource(source);\n          } else if (source !== targetSource) {\n            if (!targetSource.getAttributions()) {\n              targetSource.setAttributions(source.getAttributions());\n            }\n            //@ts-ignore\n            if (!targetSource.format_) {\n              //@ts-ignore\n              targetSource.format_ = source.getFormat();\n            }\n            //@ts-ignore\n            targetSource.url_ = source.getUrl();\n          }\n          return Promise.resolve();\n        }\n\n        let spriteScale, spriteData, spriteImageUrl, style;\n        function onChange() {\n          if (!style && (!glStyle.sprite || spriteData)) {\n            if (options.projection && !resolutions) {\n              const projection = getProjection(options.projection);\n              const units = projection.getUnits();\n              if (units !== 'm') {\n                resolutions = defaultResolutions.map(\n                  (resolution) => resolution / METERS_PER_UNIT[units],\n                );\n              }\n            }\n            style = applyStylefunction(\n              layer,\n              glStyle,\n              sourceOrLayers,\n              resolutions,\n              spriteData,\n              spriteImageUrl,\n              (fonts, templateUrl = options.webfonts) =>\n                getFonts(fonts, templateUrl),\n              options.getImage,\n            );\n            if (!layer.getStyle()) {\n              reject(new Error(`Nothing to show for source [${sourceId}]`));\n            } else {\n              assignSource().then(resolve).catch(reject);\n            }\n          } else if (style) {\n            layer.setStyle(style);\n            assignSource().then(resolve).catch(reject);\n          } else {\n            reject(new Error('Something went wrong trying to apply style.'));\n          }\n        }\n\n        if (glStyle.sprite) {\n          const sprite = new URL(\n            normalizeSpriteUrl(\n              glStyle.sprite,\n              options.accessToken,\n              styleUrl || location.href,\n            ),\n          );\n          spriteScale = window.devicePixelRatio >= 1.5 ? 0.5 : 1;\n          const sizeFactor = spriteScale == 0.5 ? '@2x' : '';\n          let spriteUrl =\n            sprite.origin +\n            sprite.pathname +\n            sizeFactor +\n            '.json' +\n            sprite.search;\n\n          new Promise(function (resolve, reject) {\n            fetchResource('Sprite', spriteUrl, options)\n              .then(resolve)\n              .catch(function (error) {\n                spriteUrl =\n                  sprite.origin + sprite.pathname + '.json' + sprite.search;\n                fetchResource('Sprite', spriteUrl, options)\n                  .then(resolve)\n                  .catch(reject);\n              });\n          })\n            .then(function (spritesJson) {\n              if (spritesJson === undefined) {\n                reject(new Error('No sprites found.'));\n              }\n              spriteData = spritesJson;\n              spriteImageUrl =\n                sprite.origin +\n                sprite.pathname +\n                sizeFactor +\n                '.png' +\n                sprite.search;\n              if (options.transformRequest) {\n                const transformed =\n                  options.transformRequest(spriteImageUrl, 'SpriteImage') ||\n                  spriteImageUrl;\n                if (\n                  transformed instanceof Request ||\n                  transformed instanceof Promise\n                ) {\n                  spriteImageUrl = transformed;\n                }\n              }\n              onChange();\n            })\n            .catch(function (err) {\n              reject(\n                new Error(\n                  `Sprites cannot be loaded: ${spriteUrl}: ${err.message}`,\n                ),\n              );\n            });\n        } else {\n          onChange();\n        }\n      })\n      .catch(reject);\n  });\n}\n\nconst emptyObj = {};\n\nfunction setFirstBackground(mapOrLayer, glStyle, options) {\n  glStyle.layers.some(function (layer) {\n    if (layer.type === 'background') {\n      if (mapOrLayer instanceof Layer) {\n        mapOrLayer.setBackground(function (resolution) {\n          return getBackgroundColor(layer, resolution, options, {});\n        });\n        return true;\n      }\n      if (mapOrLayer instanceof Map || mapOrLayer instanceof LayerGroup) {\n        mapOrLayer\n          .getLayers()\n          .insertAt(0, setupBackgroundLayer(layer, options, {}));\n        return true;\n      }\n    }\n  });\n}\n\n/**\n * Applies properties of the Mapbox/MapLibre Style's first `background` layer to the\n * provided map or layer (group).\n *\n * **Example:**\n * ```js\n * import {applyBackground} from 'ol-mapbox-style';\n * import {Map} from 'ol';\n *\n * const map = new Map({target: 'map'});\n * applyBackground(map, 'https://api.maptiler.com/maps/basic/style.json?key=YOUR_OPENMAPTILES_TOKEN');\n * ```\n * @param {Map|import(\"ol/layer/Base.js\").default} mapOrLayer OpenLayers Map or layer (group).\n * @param {Object|string} glStyle Mapbox/MapLibre Style object or url.\n * @param {Options} options Options.\n * @return {Promise} Promise that resolves when the background is applied.\n */\nexport function applyBackground(mapOrLayer, glStyle, options = {}) {\n  return getGlStyle(glStyle, options).then(function (glStyle) {\n    setFirstBackground(mapOrLayer, glStyle, options);\n  });\n}\n\nfunction getSourceIdByRef(layers, ref) {\n  let sourceId;\n  layers.some(function (layer) {\n    if (layer.id == ref) {\n      sourceId = layer.source;\n      return true;\n    }\n  });\n  return sourceId;\n}\n\nfunction extentFromTileJSON(tileJSON, projection) {\n  const bounds = tileJSON.bounds;\n  if (bounds) {\n    const ll = fromLonLat([bounds[0], bounds[1]], projection);\n    const tr = fromLonLat([bounds[2], bounds[3]], projection);\n    return [ll[0], ll[1], tr[0], tr[1]];\n  }\n  return getProjection(projection).getExtent();\n}\n\nfunction sourceOptionsFromTileJSON(glSource, tileJSON, options) {\n  const tileJSONSource = new TileJSON({\n    tileJSON: tileJSON,\n    tileSize: glSource.tileSize || tileJSON.tileSize || 512,\n  });\n  const tileJSONDoc = tileJSONSource.getTileJSON();\n  const tileGrid = tileJSONSource.getTileGrid();\n  const projection = getProjection(options.projection || 'EPSG:3857');\n  const extent = extentFromTileJSON(tileJSONDoc, projection);\n  const projectionExtent = projection.getExtent();\n  const minZoom = tileJSONDoc.minzoom || 0;\n  const maxZoom = tileJSONDoc.maxzoom || 22;\n  /** @type {import(\"ol/source/VectorTile.js\").Options<import(\"ol/render/Feature.js\").default>} */\n  const sourceOptions = {\n    attributions: tileJSONSource.getAttributions(),\n    projection: projection,\n    tileGrid: new TileGrid({\n      origin: projectionExtent\n        ? getTopLeft(projectionExtent)\n        : tileGrid.getOrigin(0),\n      extent: extent || tileGrid.getExtent(),\n      minZoom: minZoom,\n      resolutions: getTileResolutions(projection, tileJSON.tileSize).slice(\n        0,\n        maxZoom + 1,\n      ),\n      tileSize: tileGrid.getTileSize(0),\n    }),\n  };\n  if (Array.isArray(tileJSONDoc.tiles)) {\n    sourceOptions.urls = tileJSONDoc.tiles;\n  } else {\n    sourceOptions.url = tileJSONDoc.tiles;\n  }\n  return sourceOptions;\n}\n\nfunction getBackgroundColor(glLayer, resolution, options, functionCache) {\n  const background = {\n    id: glLayer.id,\n    type: glLayer.type,\n  };\n  const layout = glLayer.layout || {};\n  const paint = glLayer.paint || {};\n  background['paint'] = paint;\n  const zoom = getZoomForResolution(\n    resolution,\n    options.resolutions || defaultResolutions,\n  );\n  let opacity;\n  const bg = getValue(\n    background,\n    'paint',\n    'background-color',\n    zoom,\n    emptyObj,\n    functionCache,\n  );\n  if (paint['background-opacity'] !== undefined) {\n    opacity = getValue(\n      background,\n      'paint',\n      'background-opacity',\n      zoom,\n      emptyObj,\n      functionCache,\n    );\n  }\n  return layout.visibility == 'none'\n    ? undefined\n    : _colorWithOpacity(bg, opacity);\n}\n\n/**\n * @param {Object} glLayer Mapbox/MapLibre Style layer object.\n * @param {Options} options Options.\n * @param {Object} functionCache Cache for functions.\n * @return {Layer} OpenLayers layer.\n */\nfunction setupBackgroundLayer(glLayer, options, functionCache) {\n  const div = document.createElement('div');\n  div.className = 'ol-mapbox-style-background';\n  div.style.position = 'absolute';\n  div.style.width = '100%';\n  div.style.height = '100%';\n  return new Layer({\n    source: new Source({}),\n    render(frameState) {\n      const color = getBackgroundColor(\n        glLayer,\n        frameState.viewState.resolution,\n        options,\n        functionCache,\n      );\n      div.style.backgroundColor = color;\n      return div;\n    },\n  });\n}\n\n/**\n * Creates an OpenLayers VectorTile source for a gl source entry.\n * @param {Object} glSource \"source\" entry from a Mapbox/MapLibre Style object.\n * @param {string|undefined} styleUrl URL to use for the source. This is expected to be the complete http(s) url,\n * with access key applied.\n * @param {Options} options Options.\n * @return {Promise<import(\"ol/source/VectorTile\").default>} Promise resolving to a VectorTile source.\n * @private\n */\nexport function setupVectorSource(glSource, styleUrl, options) {\n  return new Promise(function (resolve, reject) {\n    getTileJson(glSource, styleUrl, options)\n      .then(function ({tileJson, tileLoadFunction}) {\n        const sourceOptions = sourceOptionsFromTileJSON(\n          glSource,\n          tileJson,\n          options,\n        );\n        sourceOptions.tileLoadFunction = tileLoadFunction;\n        sourceOptions.format = new MVT();\n        resolve(new VectorTileSource(sourceOptions));\n      })\n      .catch(reject);\n  });\n}\n\nfunction setupVectorLayer(glSource, styleUrl, options) {\n  const layer = new VectorTileLayer({\n    declutter: true,\n    visible: false,\n  });\n  setupVectorSource(glSource, styleUrl, options)\n    .then(function (source) {\n      source.set('mapbox-source', glSource);\n      layer.setSource(source);\n    })\n    .catch(function (error) {\n      layer.setSource(undefined);\n    });\n  return layer;\n}\n\nfunction getBboxTemplate(projection) {\n  const projCode = projection ? projection.getCode() : 'EPSG:3857';\n  return `{bbox-${projCode.toLowerCase().replace(/[^a-z0-9]/g, '-')}}`;\n}\n\nfunction setupRasterSource(glSource, styleUrl, options) {\n  return new Promise(function (resolve, reject) {\n    getTileJson(glSource, styleUrl, options)\n      .then(function ({tileJson, tileLoadFunction}) {\n        const source = new TileJSON({\n          interpolate:\n            options.interpolate === undefined ? true : options.interpolate,\n          transition: 0,\n          crossOrigin: 'anonymous',\n          tileJSON: tileJson,\n        });\n        //@ts-ignore\n        source.tileGrid = sourceOptionsFromTileJSON(\n          glSource,\n          tileJson,\n          options,\n        ).tileGrid;\n        if (options.projection) {\n          //@ts-ignore\n          source.projection = getProjection(options.projection);\n        }\n        const getTileUrl = source.getTileUrlFunction();\n        if (tileLoadFunction) {\n          source.setTileLoadFunction(tileLoadFunction);\n        }\n        source.setTileUrlFunction(function (tileCoord, pixelRatio, projection) {\n          const bboxTemplate = getBboxTemplate(projection);\n          let src = getTileUrl(tileCoord, pixelRatio, projection);\n          if (src.indexOf(bboxTemplate) != -1) {\n            const bbox = source.getTileGrid().getTileCoordExtent(tileCoord);\n            src = src.replace(bboxTemplate, bbox.toString());\n          }\n          return src;\n        });\n        source.set('mapbox-source', glSource);\n        resolve(source);\n      })\n      .catch(function (error) {\n        reject(error);\n      });\n  });\n}\n\nfunction setupRasterLayer(glSource, styleUrl, options) {\n  const layer = new TileLayer();\n  setupRasterSource(glSource, styleUrl, options)\n    .then(function (source) {\n      layer.setSource(source);\n    })\n    .catch(function () {\n      layer.setSource(undefined);\n    });\n  return layer;\n}\n\n/**\n *\n * @param {Object} glSource \"source\" entry from a Mapbox/MapLibre Style object.\n * @param {string} styleUrl Style url\n * @param {Options} options ol-mapbox-style options.\n * @return {ImageLayer<Raster>} The raster layer\n */\nfunction setupHillshadeLayer(glSource, styleUrl, options) {\n  const tileLayer = setupRasterLayer(glSource, styleUrl, options);\n  /** @type {ImageLayer<Raster>} */\n  const layer = new ImageLayer({\n    source: new Raster({\n      operationType: 'image',\n      operation: hillshade,\n      sources: [tileLayer],\n    }),\n  });\n  return layer;\n}\n\n/**\n * @param {Object} glSource glStyle source.\n * @param {string} styleUrl Style URL.\n * @param {Options} options Options.\n * @return {VectorSource} Configured vector source.\n */\nfunction setupGeoJSONSource(glSource, styleUrl, options) {\n  const geoJsonFormat = options.projection\n    ? new GeoJSON({dataProjection: options.projection})\n    : new GeoJSON();\n  const data = glSource.data;\n  const sourceOptions = {};\n  if (typeof data == 'string') {\n    const [geoJsonUrl] = normalizeSourceUrl(\n      data,\n      options.accessToken,\n      options.accessTokenParam || 'access_token',\n      styleUrl || location.href,\n    );\n    if (/\\{bbox-[0-9a-z-]+\\}/.test(geoJsonUrl)) {\n      const extentUrl = (extent, resolution, projection) => {\n        const bboxTemplate = getBboxTemplate(projection);\n        return geoJsonUrl.replace(bboxTemplate, `${extent.join(',')}`);\n      };\n      const source = new VectorSource({\n        attributions: glSource.attribution,\n        format: geoJsonFormat,\n        loader: (extent, resolution, projection, success, failure) => {\n          const url =\n            typeof extentUrl === 'function'\n              ? extentUrl(extent, resolution, projection)\n              : extentUrl;\n          fetchResource('GeoJSON', url, options)\n            .then((json) => {\n              const features = /** @type {*} */ (\n                source\n                  .getFormat()\n                  .readFeatures(json, {featureProjection: projection})\n              );\n              source.addFeatures(features);\n              success(features);\n            })\n            .catch((response) => {\n              source.removeLoadedExtent(extent);\n              failure();\n            });\n        },\n        strategy: bboxStrategy,\n      });\n      source.set('mapbox-source', glSource);\n      return source;\n    }\n    const source = new VectorSource({\n      attributions: glSource.attribution,\n      format: geoJsonFormat,\n      url: geoJsonUrl,\n      loader: (extent, resolution, projection, success, failure) => {\n        fetchResource('GeoJSON', geoJsonUrl, options)\n          .then((json) => {\n            const features = /** @type {*} */ (\n              source\n                .getFormat()\n                .readFeatures(json, {featureProjection: projection})\n            );\n            source.addFeatures(features);\n            success(features);\n          })\n          .catch((response) => {\n            source.removeLoadedExtent(extent);\n            failure();\n          });\n      },\n    });\n    return source;\n  }\n  sourceOptions.features = geoJsonFormat.readFeatures(data, {\n    featureProjection: getUserProjection() || 'EPSG:3857',\n  });\n\n  const source = new VectorSource(\n    Object.assign(\n      {\n        attributions: glSource.attribution,\n        format: geoJsonFormat,\n      },\n      sourceOptions,\n    ),\n  );\n  source.set('mapbox-source', glSource);\n  return /** @type {VectorSource} */ (source);\n}\n\nfunction setupGeoJSONLayer(glSource, styleUrl, options) {\n  return new VectorLayer({\n    declutter: true,\n    source: setupGeoJSONSource(glSource, styleUrl, options),\n    visible: false,\n  });\n}\n\nfunction prerenderRasterLayer(glLayer, layer, functionCache) {\n  let zoom = null;\n  return function (event) {\n    if (\n      glLayer.paint &&\n      'raster-opacity' in glLayer.paint &&\n      event.frameState.viewState.zoom !== zoom\n    ) {\n      zoom = event.frameState.viewState.zoom;\n      delete functionCache[glLayer.id];\n      updateRasterLayerProperties(glLayer, layer, zoom, functionCache);\n    }\n  };\n}\n\nfunction updateRasterLayerProperties(glLayer, layer, zoom, functionCache) {\n  const opacity = getValue(\n    glLayer,\n    'paint',\n    'raster-opacity',\n    zoom,\n    emptyObj,\n    functionCache,\n  );\n  layer.setOpacity(opacity);\n}\n\nfunction manageVisibility(layer, mapOrGroup) {\n  function onChange() {\n    const glStyle = mapOrGroup.get('mapbox-style');\n    if (!glStyle) {\n      return;\n    }\n    const mapboxLayers = derefLayers(glStyle.layers);\n    const layerMapboxLayerids = layer.get('mapbox-layers');\n    const visible = mapboxLayers\n      .filter(function (mapboxLayer) {\n        return layerMapboxLayerids.includes(mapboxLayer.id);\n      })\n      .some(function (mapboxLayer) {\n        return (\n          !mapboxLayer.layout ||\n          !mapboxLayer.layout.visibility ||\n          mapboxLayer.layout.visibility === 'visible'\n        );\n      });\n    if (layer.get('visible') !== visible) {\n      layer.setVisible(visible);\n    }\n  }\n  layer.on('change', onChange);\n  onChange();\n}\n\nexport function setupLayer(glStyle, styleUrl, glLayer, options) {\n  const functionCache = getFunctionCache(glStyle);\n  const glLayers = glStyle.layers;\n  const type = glLayer.type;\n\n  const id = glLayer.source || getSourceIdByRef(glLayers, glLayer.ref);\n  const glSource = glStyle.sources[id];\n  let layer;\n  if (type == 'background') {\n    layer = setupBackgroundLayer(glLayer, options, functionCache);\n  } else if (glSource.type == 'vector') {\n    layer = setupVectorLayer(glSource, styleUrl, options);\n  } else if (glSource.type == 'raster') {\n    layer = setupRasterLayer(glSource, styleUrl, options);\n    layer.setVisible(\n      glLayer.layout ? glLayer.layout.visibility !== 'none' : true,\n    );\n    layer.on('prerender', prerenderRasterLayer(glLayer, layer, functionCache));\n  } else if (glSource.type == 'geojson') {\n    layer = setupGeoJSONLayer(glSource, styleUrl, options);\n  } else if (glSource.type == 'raster-dem' && glLayer.type == 'hillshade') {\n    const hillshadeLayer = setupHillshadeLayer(glSource, styleUrl, options);\n    layer = hillshadeLayer;\n    hillshadeLayer.getSource().on('beforeoperations', function (event) {\n      const data = event.data;\n      data.resolution = getPointResolution(\n        options.projection || 'EPSG:3857',\n        event.resolution,\n        getCenter(event.extent),\n        'm',\n      );\n      const zoom = getZoomForResolution(\n        event.resolution,\n        options.resolutions || defaultResolutions,\n      );\n      data.encoding = glSource.encoding;\n      data.vert =\n        5 *\n        getValue(\n          glLayer,\n          'paint',\n          'hillshade-exaggeration',\n          zoom,\n          emptyObj,\n          functionCache,\n        );\n      data.sunAz = getValue(\n        glLayer,\n        'paint',\n        'hillshade-illumination-direction',\n        zoom,\n        emptyObj,\n        functionCache,\n      );\n      data.sunEl = 35;\n      data.opacity = 0.3;\n      data.highlightColor = getValue(\n        glLayer,\n        'paint',\n        'hillshade-highlight-color',\n        zoom,\n        emptyObj,\n        functionCache,\n      );\n      data.shadowColor = getValue(\n        glLayer,\n        'paint',\n        'hillshade-shadow-color',\n        zoom,\n        emptyObj,\n        functionCache,\n      );\n      data.accentColor = getValue(\n        glLayer,\n        'paint',\n        'hillshade-accent-color',\n        zoom,\n        emptyObj,\n        functionCache,\n      );\n    });\n    layer.setVisible(\n      glLayer.layout ? glLayer.layout.visibility !== 'none' : true,\n    );\n  }\n  const glSourceId = id;\n  if (layer) {\n    layer.set('mapbox-source', glSourceId);\n  }\n  return layer;\n}\n\n/**\n * @param {*} glStyle Mapbox/MapLibre Style.\n * @param {Map|LayerGroup} mapOrGroup Map or layer group.\n * @param {string} styleUrl Style URL.\n * @param {Options} options Options.\n * @return {Promise} Promise that resolves when the style is loaded.\n */\nfunction processStyle(glStyle, mapOrGroup, styleUrl, options) {\n  const promises = [];\n\n  let view = null;\n  if (mapOrGroup instanceof Map) {\n    view = mapOrGroup.getView();\n    if (!view.isDef() && !view.getRotation() && !view.getResolutions()) {\n      const projection = options.projection\n        ? getProjection(options.projection)\n        : view.getProjection();\n      view = new View(\n        Object.assign(view.getProperties(), {\n          maxResolution:\n            defaultResolutions[0] / METERS_PER_UNIT[projection.getUnits()],\n          projection: options.projection || view.getProjection(),\n        }),\n      );\n      mapOrGroup.setView(view);\n    }\n\n    if ('center' in glStyle && !view.getCenter()) {\n      view.setCenter(fromLonLat(glStyle.center, view.getProjection()));\n    }\n    if ('zoom' in glStyle && view.getZoom() === undefined) {\n      view.setResolution(\n        defaultResolutions[0] /\n          METERS_PER_UNIT[view.getProjection().getUnits()] /\n          Math.pow(2, glStyle.zoom),\n      );\n    }\n    if (!view.getCenter() || view.getZoom() === undefined) {\n      view.fit(view.getProjection().getExtent(), {\n        nearest: true,\n        size: mapOrGroup.getSize(),\n      });\n    }\n  }\n  mapOrGroup.set('mapbox-style', glStyle);\n  mapOrGroup.set('mapbox-metadata', {styleUrl, options});\n\n  const glLayers = glStyle.layers;\n  let layerIds = [];\n\n  let layer, glSourceId, id;\n  for (let i = 0, ii = glLayers.length; i < ii; ++i) {\n    const glLayer = glLayers[i];\n    const type = glLayer.type;\n    if (type == 'heatmap') {\n      //FIXME Unsupported layer type\n      // eslint-disable-next-line no-console\n      console.debug(`layers[${i}].type \"${type}\" not supported`);\n      continue;\n    } else {\n      id = glLayer.source || getSourceIdByRef(glLayers, glLayer.ref);\n      // this technique assumes gl layers will be in a particular order\n      if (!id || id != glSourceId) {\n        if (layerIds.length) {\n          promises.push(\n            finalizeLayer(\n              layer,\n              layerIds,\n              glStyle,\n              styleUrl,\n              mapOrGroup,\n              options,\n            ),\n          );\n          layerIds = [];\n        }\n\n        layer = setupLayer(glStyle, styleUrl, glLayer, options);\n        if (\n          !(layer instanceof VectorLayer || layer instanceof VectorTileLayer)\n        ) {\n          layerIds = [];\n        }\n        glSourceId = layer.get('mapbox-source');\n      }\n      layerIds.push(glLayer.id);\n    }\n  }\n  promises.push(\n    finalizeLayer(layer, layerIds, glStyle, styleUrl, mapOrGroup, options),\n  );\n  return Promise.all(promises);\n}\n\n/**\n * Loads and applies a Mapbox/MapLibre Style object into an OpenLayers Map or LayerGroup.\n * This includes the map background, the layers, and for Map instances that did not\n * have a View defined yet also the center and the zoom.\n *\n * **Example:**\n * ```js\n * import apply from 'ol-mapbox-style';\n *\n * apply('map', 'mapbox://styles/mapbox/bright-v9', {accessToken: 'YOUR_MAPBOX_TOKEN'});\n * ```\n *\n * The center and zoom will only be set if present in the Mapbox/MapLibre Style document,\n * and if not already set on the OpenLayers map.\n *\n * Layers will be added to the OpenLayers map, without affecting any layers that\n * might already be set on the map.\n *\n * Layers added by `apply()` will have two additional properties:\n *\n *  * `mapbox-source`: The `id` of the Mapbox/MapLibre Style document's source that the\n *    OpenLayers layer was created from. Usually `apply()` creates one\n *    OpenLayers layer per Mapbox/MapLibre Style source, unless the layer stack has\n *    layers from different sources in between.\n *  * `mapbox-layers`: The `id`s of the Mapbox/MapLibre Style document's layers that are\n *    included in the OpenLayers layer.\n *\n * This function sets an additional `mapbox-style` property on the OpenLayers\n * Map or LayerGroup instance, which holds the Mapbox/MapLibre Style object.\n *\n * @param {Map|HTMLElement|string|LayerGroup} mapOrGroupOrElement Either an existing\n * OpenLayers Map instance, or a HTML element, or the id of a HTML element that will be\n * the target of a new OpenLayers Map, or a layer group. If layer group, styles\n * releated to the map and view will be ignored.\n * @param {string|Object} style JSON style object or style url pointing to a\n * Mapbox/MapLibre Style object. When using Mapbox APIs, the url is the `styleUrl`\n * shown in Mapbox Studio's \"share\" panel. In addition, the `accessToken` option\n * (see below) must be set.\n * When passed as JSON style object, all OpenLayers layers created by `apply()`\n * will be immediately available, but they may not have a source yet (i.e. when\n * they are defined by a TileJSON url in the Mapbox/MapLibre Style document). When passed\n * as style url, layers will be added to the map when the Mapbox/MapLibre Style document\n * is loaded and parsed.\n * @param {Options} options Options.\n * @return {Promise<Map|LayerGroup>} A promise that resolves after all layers have been added to\n * the OpenLayers Map instance or LayerGroup, their sources set, and their styles applied. The\n * `resolve` callback will be called with the OpenLayers Map instance or LayerGroup as\n * argument.\n */\nexport function apply(mapOrGroupOrElement, style, options = {}) {\n  let promise;\n  /** @type {Map|LayerGroup} */\n  let mapOrGroup;\n  if (\n    typeof mapOrGroupOrElement === 'string' ||\n    mapOrGroupOrElement instanceof HTMLElement\n  ) {\n    mapOrGroup = new Map({\n      target: mapOrGroupOrElement,\n    });\n  } else {\n    mapOrGroup = mapOrGroupOrElement;\n  }\n\n  if (typeof style === 'string') {\n    const styleUrl = style.startsWith('data:')\n      ? location.href\n      : normalizeStyleUrl(style, options.accessToken);\n    options = completeOptions(styleUrl, options);\n\n    promise = new Promise(function (resolve, reject) {\n      getGlStyle(style, options)\n        .then(function (glStyle) {\n          processStyle(glStyle, mapOrGroup, styleUrl, options)\n            .then(function () {\n              resolve(mapOrGroup);\n            })\n            .catch(reject);\n        })\n        .catch(function (err) {\n          reject(new Error(`Could not load ${style}: ${err.message}`));\n        });\n    });\n  } else {\n    promise = new Promise(function (resolve, reject) {\n      processStyle(\n        style,\n        mapOrGroup,\n        !options.styleUrl || options.styleUrl.startsWith('data:')\n          ? location.href\n          : normalizeStyleUrl(options.styleUrl, options.accessToken),\n        options,\n      )\n        .then(function () {\n          resolve(mapOrGroup);\n        })\n        .catch(reject);\n    });\n  }\n\n  return promise;\n}\n\n/**\n * If layerIds is not empty, applies the style specified in glStyle to the layer,\n * and adds the layer to the map.\n *\n * The layer may not yet have a source when the function is called.  If so, the style\n * is applied to the layer via a once listener on the 'change:source' event.\n *\n * @param {Layer} layer An OpenLayers layer instance.\n * @param {Array<string>} layerIds Array containing layer ids of already-processed layers.\n * @param {Object} glStyle Style as a JSON object.\n * @param {string|undefined} styleUrl The original style URL. Only required\n * when a relative path is used with the `\"sprite\"` property of the style.\n * @param {Map|LayerGroup} mapOrGroup OpenLayers Map.\n * @param {Options} options Options.\n * @return {Promise} Returns a promise that resolves after the source has\n * been set on the specified layer, and the style has been applied.\n */\nexport function finalizeLayer(\n  layer,\n  layerIds,\n  glStyle,\n  styleUrl,\n  mapOrGroup,\n  options = {},\n) {\n  let minZoom = 24;\n  let maxZoom = 0;\n  const glLayers = glStyle.layers;\n  for (let i = 0, ii = glLayers.length; i < ii; ++i) {\n    const glLayer = glLayers[i];\n    if (layerIds.indexOf(glLayer.id) !== -1) {\n      minZoom = Math.min('minzoom' in glLayer ? glLayer.minzoom : 0, minZoom);\n      maxZoom = Math.max('maxzoom' in glLayer ? glLayer.maxzoom : 24, maxZoom);\n    }\n  }\n  return new Promise(function (resolve, reject) {\n    const setStyle = function () {\n      const source = layer.getSource();\n      if (!source || source.getState() === 'error') {\n        reject(\n          new Error(\n            'Error accessing data for source ' + layer.get('mapbox-source'),\n          ),\n        );\n        return;\n      }\n      if ('getTileGrid' in source) {\n        const tileGrid =\n          /** @type {import(\"ol/source/Tile.js\").default|import(\"ol/source/VectorTile.js\").default} */ (\n            source\n          ).getTileGrid();\n        if (tileGrid) {\n          const sourceMinZoom = tileGrid.getMinZoom();\n          if (minZoom > 0 || sourceMinZoom > 0) {\n            layer.setMaxResolution(\n              Math.min(\n                getResolutionForZoom(\n                  Math.max(0, minZoom - 1e-12),\n                  defaultResolutions,\n                ),\n                getResolutionForZoom(\n                  Math.max(0, sourceMinZoom - 1e-12),\n                  tileGrid.getResolutions(),\n                ),\n              ),\n            );\n          }\n          if (maxZoom < 24) {\n            layer.setMinResolution(\n              getResolutionForZoom(maxZoom, defaultResolutions),\n            );\n          }\n        }\n      } else {\n        if (minZoom > 0) {\n          layer.setMaxResolution(\n            getResolutionForZoom(\n              Math.max(0, minZoom - 1e-12),\n              defaultResolutions,\n            ),\n          );\n        }\n      }\n      if (\n        source instanceof VectorSource ||\n        source instanceof VectorTileSource\n      ) {\n        applyStyle(\n          /** @type {import(\"ol/layer/Vector\").default|import(\"ol/layer/VectorTile\").default} */ (\n            layer\n          ),\n          glStyle,\n          layerIds,\n          Object.assign({styleUrl: styleUrl}, options),\n        )\n          .then(function () {\n            manageVisibility(layer, mapOrGroup);\n            resolve();\n          })\n          .catch(reject);\n      } else {\n        resolve();\n      }\n    };\n\n    layer.set('mapbox-layers', layerIds);\n    const layers = mapOrGroup.getLayers();\n    if (layers.getArray().indexOf(layer) === -1) {\n      layers.push(layer);\n    }\n\n    if (layer.getSource()) {\n      setStyle();\n    } else {\n      layer.once('change:source', setStyle);\n    }\n  });\n}\n\n/**\n * Get the Mapbox Layer object for the provided `layerId`.\n * @param {Map|LayerGroup} mapOrGroup Map or LayerGroup.\n * @param {string} layerId Mapbox Layer id.\n * @return {Object} Mapbox Layer object.\n */\nexport function getMapboxLayer(mapOrGroup, layerId) {\n  const style = mapOrGroup.get('mapbox-style');\n  const layerStyle = style.layers.find(function (layer) {\n    return layer.id === layerId;\n  });\n  return layerStyle;\n}\n\n/**\n * Add a new Mapbox Layer object to the style. The map will be re-rendered.\n * @param {Map|LayerGroup} mapOrGroup The Map or LayerGroup `apply` was called on.\n * @param {Object} mapboxLayer Mapbox Layer object.\n * @param {string} [beforeLayerId] Optional id of the Mapbox Layer before the new layer that will be added.\n * @return {Promise<void>} Resolves when the added layer is available.\n */\nexport function addMapboxLayer(mapOrGroup, mapboxLayer, beforeLayerId) {\n  const glStyle = mapOrGroup.get('mapbox-style');\n  const mapboxLayers = glStyle.layers;\n  let spliceIndex;\n  let sourceIndex = -1;\n  if (beforeLayerId !== undefined) {\n    const beforeMapboxLayer = getMapboxLayer(mapOrGroup, beforeLayerId);\n    if (beforeMapboxLayer === undefined) {\n      throw new Error(`Layer with id \"${beforeLayerId}\" not found.`);\n    }\n    spliceIndex = mapboxLayers.indexOf(beforeMapboxLayer);\n  } else {\n    spliceIndex = mapboxLayers.length;\n  }\n  let sourceOffset;\n  if (\n    spliceIndex > 0 &&\n    mapboxLayers[spliceIndex - 1].source === mapboxLayer.source\n  ) {\n    sourceIndex = spliceIndex - 1;\n    sourceOffset = -1;\n  } else if (\n    spliceIndex < mapboxLayers.length &&\n    mapboxLayers[spliceIndex].source === mapboxLayer.source\n  ) {\n    sourceIndex = spliceIndex;\n    sourceOffset = 0;\n  }\n  if (sourceIndex === -1) {\n    const {options, styleUrl} = mapOrGroup.get('mapbox-metadata');\n    const layer = setupLayer(glStyle, styleUrl, mapboxLayer, options);\n    if (beforeLayerId) {\n      const beforeLayer = getLayer(mapOrGroup, beforeLayerId);\n      const beforeLayerIndex = mapOrGroup\n        .getLayers()\n        .getArray()\n        .indexOf(beforeLayer);\n      mapOrGroup.getLayers().insertAt(beforeLayerIndex, layer);\n    }\n    mapboxLayers.splice(spliceIndex, 0, mapboxLayer);\n    return finalizeLayer(\n      layer,\n      [mapboxLayer.id],\n      glStyle,\n      styleUrl,\n      mapOrGroup,\n      options,\n    );\n  }\n\n  if (mapboxLayers.some((layer) => layer.id === mapboxLayer.id)) {\n    throw new Error(`Layer with id \"${mapboxLayer.id}\" already exists.`);\n  }\n  const sourceLayerId = mapboxLayers[sourceIndex].id;\n  const args =\n    styleFunctionArgs[\n      getStyleFunctionKey(\n        mapOrGroup.get('mapbox-style'),\n        getLayer(mapOrGroup, sourceLayerId),\n      )\n    ];\n  mapboxLayers.splice(spliceIndex, 0, mapboxLayer);\n  if (args) {\n    const [\n      olLayer,\n      glStyle,\n      sourceOrLayers,\n      resolutions,\n      spriteData,\n      spriteImageUrl,\n      getFonts,\n      getImage,\n    ] = args;\n    if (Array.isArray(sourceOrLayers)) {\n      const layerIndex = sourceOrLayers.indexOf(sourceLayerId) + sourceOffset;\n      sourceOrLayers.splice(layerIndex, 0, mapboxLayer.id);\n    }\n    applyStylefunction(\n      olLayer,\n      glStyle,\n      sourceOrLayers,\n      resolutions,\n      spriteData,\n      spriteImageUrl,\n      getFonts,\n      getImage,\n    );\n  } else {\n    getLayer(mapOrGroup, mapboxLayers[sourceIndex].id).changed();\n  }\n  return Promise.resolve();\n}\n\n/**\n * Update a Mapbox Layer object in the style. The map will be re-rendered with the new style.\n * @param {Map|LayerGroup} mapOrGroup The Map or LayerGroup `apply` was called on.\n * @param {Object} mapboxLayer Updated Mapbox Layer object.\n */\nexport function updateMapboxLayer(mapOrGroup, mapboxLayer) {\n  const glStyle = mapOrGroup.get('mapbox-style');\n  const mapboxLayers = glStyle.layers;\n  const index = mapboxLayers.findIndex(function (layer) {\n    return layer.id === mapboxLayer.id;\n  });\n  if (index === -1) {\n    throw new Error(`Layer with id \"${mapboxLayer.id}\" not found.`);\n  }\n  const oldLayer = mapboxLayers[index];\n  if (oldLayer.source !== mapboxLayer.source) {\n    throw new Error(\n      'Updated layer and previous version must use the same source.',\n    );\n  }\n  delete getFunctionCache(glStyle)[mapboxLayer.id];\n  delete getFilterCache(glStyle)[mapboxLayer.id];\n  mapboxLayers[index] = mapboxLayer;\n  const args =\n    styleFunctionArgs[\n      getStyleFunctionKey(\n        mapOrGroup.get('mapbox-style'),\n        getLayer(mapOrGroup, mapboxLayer.id),\n      )\n    ];\n  if (args) {\n    applyStylefunction.apply(undefined, args);\n  } else {\n    getLayer(mapOrGroup, mapboxLayer.id).changed();\n  }\n}\n\n/**\n * Updates a Mapbox source object in the style. The according OpenLayers source will be replaced\n * and the map will be re-rendered.\n * @param {Map|LayerGroup} mapOrGroup The Map or LayerGroup `apply` was called on.\n * @param {string} id Key of the source in the `sources` object literal.\n * @param {Object} mapboxSource Mapbox source object.\n * @return {Promise<Source>} Promise that resolves when the source has been updated.\n */\nexport function updateMapboxSource(mapOrGroup, id, mapboxSource) {\n  const currentSource = getSource(mapOrGroup, id);\n  const layers = /** @type {Array<VectorLayer|TileLayer|VectorTileLayer>} */ (\n    mapOrGroup\n      .getLayers()\n      .getArray()\n      .filter(function (layer) {\n        return (\n          (layer instanceof VectorLayer ||\n            layer instanceof TileLayer ||\n            layer instanceof VectorTileLayer) &&\n          layer.getSource() === currentSource\n        );\n      })\n  );\n  const metadata = mapOrGroup.get('mapbox-metadata');\n  let newSourcePromise;\n  switch (mapboxSource.type) {\n    case 'vector':\n      newSourcePromise = setupVectorSource(\n        mapboxSource,\n        metadata.styleUrl,\n        metadata.options,\n      );\n      break;\n    case 'geojson':\n      newSourcePromise = Promise.resolve(\n        setupGeoJSONSource(mapboxSource, metadata.styleUrl, metadata.options),\n      );\n      break;\n    case 'raster':\n    case 'raster-dem':\n      newSourcePromise = setupRasterSource(\n        mapboxSource,\n        metadata.styleUrl,\n        metadata.options,\n      );\n      break;\n    default:\n      return Promise.reject(\n        new Error('Unsupported source type ' + mapboxSource.type),\n      );\n  }\n  newSourcePromise.then(function (newSource) {\n    layers.forEach(function (layer) {\n      layer.setSource(newSource);\n    });\n  });\n  return newSourcePromise;\n}\n\n/**\n * Remove a Mapbox Layer object from the style. The map will be re-rendered.\n * @param {Map|LayerGroup} mapOrGroup The Map or LayerGroup `apply` was called on.\n * @param {string|Object} mapboxLayerIdOrLayer Mapbox Layer id or Mapbox Layer object.\n */\nexport function removeMapboxLayer(mapOrGroup, mapboxLayerIdOrLayer) {\n  const mapboxLayerId =\n    typeof mapboxLayerIdOrLayer === 'string'\n      ? mapboxLayerIdOrLayer\n      : mapboxLayerIdOrLayer.id;\n  const layer = getLayer(mapOrGroup, mapboxLayerId);\n  /** @type {Array<Object>} */\n  const layerMapboxLayers = layer.get('mapbox-layers');\n  if (layerMapboxLayers.length === 1) {\n    throw new Error(\n      'Cannot remove last Mapbox layer from an OpenLayers layer.',\n    );\n  }\n  layerMapboxLayers.splice(layerMapboxLayers.indexOf(mapboxLayerId), 1);\n  const glStyle = mapOrGroup.get('mapbox-style');\n  const layers = glStyle.layers;\n  layers.splice(\n    layers.findIndex((layer) => layer.id === mapboxLayerId),\n    1,\n  );\n  const args = styleFunctionArgs[getStyleFunctionKey(glStyle, layer)];\n  if (args) {\n    const [\n      olLayer,\n      glStyle,\n      sourceOrLayers,\n      resolutions,\n      spriteData,\n      spriteImageUrl,\n      getFonts,\n      getImage,\n    ] = args;\n    if (Array.isArray(sourceOrLayers)) {\n      sourceOrLayers.splice(\n        sourceOrLayers.findIndex((layer) => layer === mapboxLayerId),\n        1,\n      );\n    }\n    applyStylefunction(\n      olLayer,\n      glStyle,\n      sourceOrLayers,\n      resolutions,\n      spriteData,\n      spriteImageUrl,\n      getFonts,\n      getImage,\n    );\n  } else {\n    getLayer(mapOrGroup, mapboxLayerId).changed();\n  }\n}\n\n/**\n * Get the OpenLayers layer instance that contains the provided Mapbox/MapLibre Style\n * `layer`. Note that multiple Mapbox/MapLibre Style layers are combined in a single\n * OpenLayers layer instance when they use the same Mapbox/MapLibre Style `source`.\n * @param {Map|LayerGroup} map OpenLayers Map or LayerGroup.\n * @param {string} layerId Mapbox/MapLibre Style layer id.\n * @return {Layer} OpenLayers layer instance.\n */\nexport function getLayer(map, layerId) {\n  const layers = map.getLayers().getArray();\n  for (let i = 0, ii = layers.length; i < ii; ++i) {\n    const mapboxLayers = layers[i].get('mapbox-layers');\n    if (mapboxLayers && mapboxLayers.indexOf(layerId) !== -1) {\n      return /** @type {Layer} */ (layers[i]);\n    }\n  }\n  return undefined;\n}\n\n/**\n * Get the OpenLayers layer instances for the provided Mapbox/MapLibre Style `source`.\n * @param {Map|LayerGroup} map OpenLayers Map or LayerGroup.\n * @param {string} sourceId Mapbox/MapLibre Style source id.\n * @return {Array<Layer>} OpenLayers layer instances.\n */\nexport function getLayers(map, sourceId) {\n  const result = [];\n  const layers = map.getLayers().getArray();\n  for (let i = 0, ii = layers.length; i < ii; ++i) {\n    if (layers[i].get('mapbox-source') === sourceId) {\n      result.push(/** @type {Layer} */ (layers[i]));\n    }\n  }\n  return result;\n}\n\n/**\n * Get the OpenLayers source instance for the provided Mapbox/MapLibre Style `source`.\n * @param {Map|LayerGroup} map OpenLayers Map or LayerGroup.\n * @param {string} sourceId Mapbox/MapLibre Style source id.\n * @return {Source} OpenLayers source instance.\n */\nexport function getSource(map, sourceId) {\n  const layers = map.getLayers().getArray();\n  for (let i = 0, ii = layers.length; i < ii; ++i) {\n    const source = /** @type {Layer} */ (layers[i]).getSource();\n    if (layers[i].get('mapbox-source') === sourceId) {\n      return source;\n    }\n  }\n  return undefined;\n}\n\n/**\n * Sets or removes a feature state. The feature state is taken into account for styling,\n * just like the feature's properties, and can be used e.g. to conditionally render selected\n * features differently.\n *\n * The feature state will be stored on the OpenLayers layer matching the feature identifier, in the\n * `mapbox-featurestate` property.\n * @param {Map|VectorLayer|VectorTileLayer} mapOrLayer OpenLayers Map or layer to set the feature\n * state on.\n * @param {FeatureIdentifier} feature Feature identifier.\n * @param {Object|null} state Feature state. Set to `null` to remove the feature state.\n */\nexport function setFeatureState(mapOrLayer, feature, state) {\n  const layers =\n    'getLayers' in mapOrLayer\n      ? getLayers(mapOrLayer, feature.source)\n      : [mapOrLayer];\n  for (let i = 0, ii = layers.length; i < ii; ++i) {\n    const featureState = layers[i].get('mapbox-featurestate');\n    if (featureState) {\n      if (state) {\n        featureState[feature.id] = state;\n      } else {\n        delete featureState[feature.id];\n      }\n      layers[i].changed();\n    } else {\n      throw new Error(`Map or layer for source \"${feature.source}\" not found.`);\n    }\n  }\n}\n\n/**\n * Sets or removes a feature state. The feature state is taken into account for styling,\n * just like the feature's properties, and can be used e.g. to conditionally render selected\n * features differently.\n * @param {Map|VectorLayer|VectorTileLayer} mapOrLayer Map or layer to set the feature state on.\n * @param {FeatureIdentifier} feature Feature identifier.\n * @return {Object|null} Feature state or `null` when no feature state is set for the given\n * feature identifier.\n */\nexport function getFeatureState(mapOrLayer, feature) {\n  const layers =\n    'getLayers' in mapOrLayer\n      ? getLayers(mapOrLayer, feature.source)\n      : [mapOrLayer];\n  for (let i = 0, ii = layers.length; i < ii; ++i) {\n    const featureState = layers[i].get('mapbox-featurestate');\n    if (featureState && featureState[feature.id]) {\n      return featureState[feature.id];\n    }\n  }\n  return undefined;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = undefined;","const __WEBPACK_NAMESPACE_OBJECT__ = ol.events.Event;","import Logger from \"./LoggerByDefault\";\n\n/**\n* @module ProxyUtils\n* @alias module:~utils/ProxyUtils\n* @description\n* ...\n*\n* @example\n* proxifyUrl();\n*/\nvar ProxyUtils = {\n    /**\n     * Ajoute un proxy aux url des couches vecteurs si besoin.\n     *\n     * @function proxifyUrl\n     * @param {String} url - Url to proxify.\n     * @param {Object} [proxyOptions] - Object defining proxy options.\n     * @param {String} proxyOptions.proxyUrl - Proxy URL.\n     * @param {Array.<String>} [proxyOptions.noProxyDomains] - Proxy will not be used for this list of domain names.\n     *\n     * @returns {String} proxy url\n     */\n    proxifyUrl : function (url, proxyOptions) {\n        // logger\n\n        var logger = Logger.getLogger(\"proxifyUrl\");\n\n        if (!proxyOptions ||\n            !proxyOptions.hasOwnProperty(\"proxyUrl\") ||\n            proxyOptions.proxyUrl === null ||\n            proxyOptions.proxyUrl.trim().length === 0) {\n            return url;\n        }\n        // on regarde si l'url nest pas dans les domaines sans proxy\n        if (proxyOptions.noProxyDomains &&\n            Array.isArray(proxyOptions.noProxyDomains) &&\n            proxyOptions.noProxyDomains.length > 0) {\n            for (var i in proxyOptions.noProxyDomains) {\n                logger.trace(\"[ProxyUtils] proxifyUrl : analyzing \" + proxyOptions.noProxyDomains[i]);\n                if (url.indexOf(proxyOptions.noProxyDomains[i]) !== -1) {\n                    logger.info(\"[ProxyUtils] proxifyUrl : \" + url + \" found in noProxyDomains list (\" + proxyOptions.noProxyDomains[i] + \").\");\n                    return url;\n                }\n            }\n        }\n        return proxyOptions.proxyUrl + encodeURIComponent(url);\n    }\n};\n\nexport default ProxyUtils;\n","import SelectorID from \"../../Utils/SelectorID\";\nimport checkDsfr from \"../Utils/CheckDsfr\";\n\nvar LayerImportDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Map loading\n     *\n     * @returns {DOMElement} container\n     */\n    _createLoadingElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = \"GPmapLoading\";\n        div.className = \"\";\n        return div;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement : function () {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPimport\");\n        container.className = \"GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ######################### show widget ############################# //\n    // ################################################################### //\n\n\n    /**\n     * Show Import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowImportPictoElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var button = document.createElement(\"button\");\n        // INFO: Ajout d'une SPAN pour enlever des marges de 6px dans CHROMIUM (?!)\n        var span = document.createElement(\"span\");\n        button.appendChild(span);\n        button.id = this._addUID(\"GPshowImportPicto\");\n        button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowImportPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-import fr-btn fr-btn--tertiary\";\n        button.setAttribute(\"aria-label\", \"Ouvrir l'import de couches\");\n        button.setAttribute(\"tabindex\", \"0\");\n        button.setAttribute(\"aria-pressed\", false);\n        button.setAttribute(\"type\", \"button\");\n\n        // Close all results and panels when minimizing the widget\n        if (button.addEventListener) {\n            button.addEventListener(\"click\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                self._onShowImportClick(e);\n            });\n        } else if (button.attachEvent) {\n            button.attachEvent(\"onclick\", function (e) {\n                var status = (e.target.ariaPressed === \"true\");\n                e.target.setAttribute(\"aria-pressed\", !status);\n                self._onShowImportClick(e);\n            });\n        }\n\n        return button;\n    },\n\n    // ################################################################### //\n    // ################################ Panel ############################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelElement : function () {\n        var dialog = document.createElement(\"dialog\");\n        dialog.id = this._addUID(\"GPimportPanel\");\n        dialog.className = \"GPpanel gpf-panel fr-modal\";\n\n        return dialog;\n    },\n\n    _createImportPanelDivElement : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"gpf-panel__body fr-modal__body\";\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelHeaderElement : function () {\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader GPelementVisible gpf-visible gpf-panel__header fr-modal__header\";\n        return container;\n    },\n\n    /**\n     * Create Return PIcto into Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelReturnPictoElement : function () {\n        var self = this;\n        // return picto\n        var returnDiv = document.createElement(\"button\");\n        returnDiv.id = this._addUID(\"GPimportPanelReturnPicto\");\n        returnDiv.title = \"Masquer le panneau\";\n        returnDiv.className = \"GPreturnPicto GPimportPanelReturnPicto GPelementHidden gpf-hidden gpf-btn gpf-btn-icon-return fr-btn fr-btn--close fr-btn--tertiary-no-outline\";\n        \n        if (checkDsfr()) {\n            var returnSpan = document.createElement(\"span\");\n            returnSpan.className = \"GPelementHidden\";\n            returnSpan.innerHTML = \"Retour\";\n            returnDiv.appendChild(returnSpan);\n        }\n        if (returnDiv.addEventListener) {\n            returnDiv.addEventListener(\"click\", function (e) {\n                // on ferme le panneau\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n                // on nettoie la fenêtre de résultats\n                self._onReturnPictoClick(e);\n                // on rouvre le panneau vierge\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            });\n        } else if (returnDiv.attachEvent) {\n            returnDiv.attachEvent(\"onclick\", function (e) {\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n                self._onReturnPictoClick(e);\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            });\n        }\n        return returnDiv;\n    },\n\n    /**\n     * Create Header Title Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelTitleElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportHeaderTitle\");\n        div.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        div.innerHTML = \"Import de données\";\n        return div;\n    },\n\n    /**\n     * Create Header close div\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelCloseElement : function () {\n        // contexte\n        var self = this;\n\n        var divClose = document.createElement(\"button\");\n        divClose.id = this._addUID(\"GPimportPanelClose\");\n        divClose.className = \"GPpanelClose GPimportPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function () {\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function () {\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        divClose.appendChild(span);\n\n        return divClose;\n    },\n\n    // ################################################################### //\n    // ########################### Form panel ############################ //\n    // ################################################################### //\n\n    /**\n     * Create Form\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelFormElement : function () {\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPimportForm\");\n        form.className = \"GPform GPelementVisible gpf-visible gpf-mobile-form gpf-panel__content fr-modal__content\";\n\n        // TODO ?\n        if (form.addEventListener) {\n            form.addEventListener(\"submit\", function (e) {\n                e.preventDefault();\n                self._onImportSubmit();\n            });\n        } else if (form.attachEvent) {\n            form.attachEvent(\"onsubmit\", function (e) {\n                e.preventDefault();\n                self._onImportSubmit();\n            });\n        }\n\n        return form;\n    },\n\n    /**\n     * Create Container for import type choice\n     *\n     * @param {Array} importTypes - import types to be displayed (and used)\n     * @returns {DOMElement} DOM element\n     */\n    _createImportTypeLineElement : function (importTypes) {\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportTypeLine\");\n        div.className = \"GPimportInputLine\";\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPimportTypeLabel\");\n        label.className = \"GPlabel gpf-label fr-label\";\n        label.innerHTML = \"Type de donnée\";\n        label.title = \"Type de donnée\";\n        div.appendChild(label);\n\n        var select = document.createElement(\"select\");\n        select.setAttribute(\"aria-labelledby\", this._addUID(\"GPimportTypeLabel\"));\n        select.className = \"GPselect gpf-select fr-select\";\n        // gestionnaire d'evenement : on stocke la valeur du type d'import\n        if (select.addEventListener) {\n            select.addEventListener(\"change\", function (e) {\n                if (this.value === \"KML\" || this.value === \"GPX\" || this.value === \"GeoJSON\" || this.value === \"MAPBOX\") {\n                    // static import\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPelementVisible gpf-visible fr-my-4w\";\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPelementHidden gpf-hidden\";\n                } else if (this.value === \"WMS\" || this.value === \"WMTS\" || this.value === \"WFS\") {\n                    // service import\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPelementVisible gpf-visible fr-my-4w\";\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPelementHidden gpf-hidden\";\n                }\n                context._onImportTypeChange(e);\n            });\n        } else if (select.attachEvent) {\n            select.attachEvent(\"onchange\", function () {\n                if (this.value === \"KML\" || this.value === \"GPX\" || this.value === \"GeoJSON\" || this.value === \"MAPBOX\") {\n                    // static import\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPelementVisible gpf-visible fr-my-4w\";\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPelementHidden gpf-hidden\";\n                } else if (this.value === \"WMS\" || this.value === \"WMTS\" || this.value === \"WFS\") {\n                    // service import\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPelementVisible gpf-visible fr-my-4w\";\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPelementHidden gpf-hidden\";\n                }\n                context._onImportTypeChange();\n            });\n        }\n        select.id = this._addUID(\"GPimportTypeSelect\");\n\n        // on prend soit les valeurs passées par l'utilisateur, soit des valeurs par défaut\n        if (!importTypes || !Array.isArray(importTypes)) {\n            importTypes = [\n                \"KML\",\n                \"GPX\",\n                \"GeoJSON\",\n                \"MAPBOX\",\n                \"WMS\",\n                \"WMTS\",\n                \"WFS\"\n            ];\n        }\n        var option;\n        for (var i = 0; i < importTypes.length; i++) {\n            option = document.createElement(\"option\");\n            option.value = importTypes[i];\n            option.text = (importTypes[i] === \"MAPBOX\") ? \"Tuiles vectorielles\" : importTypes[i];\n            select.appendChild(option);\n        }\n\n        div.appendChild(select);\n\n        return div;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportWaitingElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportWaitingContainer\");\n        div.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPwaitingContainerInfo gpf-waiting_info\";\n        p.innerHTML = \"Recherche en cours...\";\n        div.appendChild(p);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ##### Params for static import (KML / GPX / GeoJSON) ############## //\n    // ################################################################### //\n\n    /**\n     * Create container for KML/GPX/GeoJSON parameters\n     * @param {String} currentType - GeoJSON, GPX or KML value\n     * @returns {DOMElement} DOM element\n     */\n    _createImportStaticParamsContainer : function (currentType) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportStaticParams\");\n        if (currentType === \"KML\" || currentType === \"GPX\" || currentType === \"GeoJSON\" || currentType === \"MAPBOX\") {\n            div.className = \"GPelementVisible gpf-visible fr-my-4w\";\n        } else {\n            div.className = \"GPelementHidden gpf-hidden\";\n        }\n\n        return div;\n    },\n\n    /**\n     * Create name label for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticNameLabel : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportInputLine fr-mb-1w\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPlabel gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPimportName\");\n        label.innerHTML = \"Nom\";\n        label.title = \"Nom\";\n        div.appendChild(label);\n\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportName\");\n        input.className = \"GPinput gpf-input fr-input\";\n        div.appendChild(input);\n\n        return div;\n    },\n\n    /**\n     * Create import choice for KML/GPX/GeoJSON parameters (local or url)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticModeChoiceDiv : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportChoice\");\n        div.className = \"fr-my-1w\";\n        return div;\n    },\n\n    /**\n     * Create local import choice for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalChoiceDiv : function () {\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportChoiceAlt gpf-radio-group fr-radio-group\";\n\n        var input = document.createElement(\"input\");\n        input.type = \"radio\";\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function (e) {\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportInputLine fr-mb-1w\";\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPelementHidden gpf-hidden\";\n                context._onStaticImportTypeChange(e);\n            });\n        } else if (input.appendChild) {\n            input.appendChild(\"onchange\", function () {\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportInputLine fr-mb-1w\";\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPelementHidden gpf-hidden\";\n                context._onStaticImportTypeChange();\n            });\n        }\n        input.name = \"GPimportChoiceMode\";\n        input.value = \"local\";\n        input.checked = true;\n        input.id = this._addUID(\"GPimportChoiceAltLocal\");\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportChoiceAltTxt gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPimportChoiceAltLocal\");\n        label.innerHTML = \"par fichier local\";\n        label.title = \"par fichier local\";\n        div.appendChild(label);\n\n        return div;\n    },\n\n    /**\n     * Create url import choice for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlChoiceDiv : function () {\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportChoiceAlt gpf-radio-group fr-radio-group\";\n\n        var input = document.createElement(\"input\");\n        input.type = \"radio\";\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function (e) {\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPelementHidden gpf-hidden\";\n                context._onStaticImportTypeChange(e);\n            });\n        } else if (input.appendChild) {\n            input.appendChild(\"onchange\", function () {\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPelementHidden gpf-hidden\";\n                context._onStaticImportTypeChange();\n            });\n        }\n        input.id = this._addUID(\"GPimportChoiceAltUrl\");\n        input.name = \"GPimportChoiceMode\";\n        input.value = \"url\";\n        input.checked = false;\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportChoiceAltTxt gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPimportChoiceAltUrl\");\n        label.innerHTML = \"par URL\";\n        label.title = \"par URL\";\n        div.appendChild(label);\n\n        return div;\n    },\n\n    /**\n     * Create input div for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInputDiv : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportValueLocal\");\n        div.className = \"GPimportInputLine\";\n        return div;\n    },\n\n    /**\n     * Create input label for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInputLabel : function () {\n        var label = document.createElement(\"label\");\n        label.className = \"GPlabel gpf-label fr-label fr-mb-1w\";\n        label.htmlFor = this._addUID(\"GPimportFile\");\n        label.innerHTML = \"Fichier local\";\n        label.title = \"Fichier local\";\n        return label;\n    },\n\n    /**\n     * Create file input for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInput : function () {\n        var input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.id = this._addUID(\"GPimportFile\");\n        input.className = \"GPimportInputFile gpf-upload fr-upload\";\n        return input;\n    },\n\n    /**\n     * Create input div for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInputDiv : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportValueUrl\");\n        div.className = \"GPelementHidden gpf-hidden\";\n        return div;\n    },\n\n    /**\n     * Create input label for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInputLabel : function () {\n        var label = document.createElement(\"label\");\n        label.className = \"GPlabel gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPimportUrl\");\n        label.innerHTML = \"URL\";\n        label.title = \"URL\";\n        return label;\n    },\n\n    /**\n     * Create url input for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInput : function () {\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportUrl\");\n        input.className = \"GPinput gpf-input fr-input\";\n        return input;\n    },\n\n    // ################################################################### //\n    // ######## Params for service params import (WMS//WMTS/WFS) ######### //\n    // ################################################################### //\n\n    /**\n     * Create container for WMS/WMTS/WFS parameters\n     * @param {String} currentType - WMS, WMTS or WFS value\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceParamsContainer : function (currentType) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportServiceParams\");\n        if (currentType === \"WMS\" || currentType === \"WMTS\" || currentType === \"WFS\") {\n            div.className = \"GPelementVisible gpf-visible\";\n        } else {\n            div.className = \"GPelementHidden gpf-hidden\";\n        }\n\n        return div;\n    },\n\n    /**\n     * Create div for WMS/WMTS/WFS url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlDiv : function () {\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportInputLine\";\n        return div;\n    },\n\n    /**\n     * Create input label for WMS/WMTS/WFS url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlInputLabel : function () {\n        var label = document.createElement(\"label\");\n        label.className = \"GPlabel gpf-label fr-label\";\n        label.htmlFor = this._addUID(\"GPimportServiceUrl\");\n        label.innerHTML = \"URL du service\";\n        label.title = \"URL du service\";\n        return label;\n    },\n\n    /**\n     * Create input for WMS/WMTS/WFS parameters url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlInput : function () {\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportServiceUrl\");\n        input.className = \"GPinput gpf-input fr-input\";\n        return input;\n    },\n\n    // ################################################################### //\n    // ########################### Submit Form ########################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportSubmitFormElement : function () {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPimportSubmit\");\n        input.className = \"GPsubmit gpf-btn fr-btn\";\n        input.type = \"submit\";\n        input.value = \"Importer\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ########################### GetCap Panel ########################## //\n    // ################################################################### //\n\n    /**\n     * Create GetCap Panel Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapPanelElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportGetCapPanel\");\n        div.className = \"GPpanel GPelementHidden gpf-panel fr-modal gpf-hidden\";\n        return div;\n    },\n\n    /**\n     * Create GetCap Panel Header Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapPanelHeaderElement : function () {\n        // contexte\n        var context = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n\n        // panel title\n        var panelTitle = document.createElement(\"div\");\n        panelTitle.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        panelTitle.innerHTML = \"Couches accessibles\";\n        panelTitle.title = \"Couches accessibles\";\n        container.appendChild(panelTitle);\n\n        // close picto\n        var closeDiv = document.createElement(\"button\");\n        closeDiv.className = \"GPpanelClose GPimportGetCapPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        closeDiv.title = \"Fermer le panneau\";\n        closeDiv.id = this._addUID(\"GPimportGetCapPanelClose\");\n        if (closeDiv.addEventListener) {\n            closeDiv.addEventListener(\"click\", function () {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).classList.replace(\"gpf-visible\", \"gpf-hidden\");\n                context._onGetCapPanelClose();\n            });\n        } else if (closeDiv.attachEvent) {\n            closeDiv.attachEvent(\"click\", function () {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).classList.replace(\"gpf-visible\", \"gpf-hidden\");\n                context._onGetCapPanelClose();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        closeDiv.appendChild(span);\n\n        container.appendChild(closeDiv);\n\n        return container;\n    },\n\n    /**\n     * Create GetCap Results List Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapResultsContainer : function () {\n        var container = document.createElement(\"div\");\n        container.className = \"GPimportGetCapRoot gpf-panel__list\";\n        container.id = this._addUID(\"GPimportGetCapResults\");\n\n        return container;\n    },\n\n    _addImportGetCapResultListRubrique : function (title, container) {\n        var ul = document.createElement(\"ul\");\n        ul.className = \"GPimportGetCapListRubrique\";\n        ul.title = title;\n\n        container.appendChild(ul);\n        return container;\n    },\n\n    _addImportGetCapResultRubrique : function (title, container) {\n        var li = document.createElement(\"li\");\n        li.className = \"GPimportGetCapRubrique gpf-panel__items_layerimport\"; /* gpf-panel__items */\n\n        // input\n        var input = document.createElement(\"input\");\n        input.id = \"GPimportGetCapRubrique-\" + SelectorID.generate();\n        input.className = \"GPimportGetCapRubrique\";\n        input.type = \"checkbox\";\n        li.appendChild(input);\n\n        // label for\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportGetCapRubriqueTitle gpf-label fr-btn fr-btn--secondary\";\n        label.htmlFor = input.id;\n        label.innerHTML = title;\n        label.title = title;\n        li.appendChild(label);\n\n        container.appendChild(li);\n        return container;\n    },\n\n    _addImportGetCapResultListLayer : function (container) {\n        var ul = document.createElement(\"ul\");\n        ul.className = \"GPimportGetCapListLayer\";\n\n        container.appendChild(ul);\n        return container;\n    },\n\n    _addImportGetCapResultLayer : function (description, id, container) {\n        var li = document.createElement(\"li\");\n        li.className = \"GPimportGetCapProposal gpf-panel__items_layerimport gpf-panel__items\";\n        li.innerHTML = description.content;\n        li.title = description.title;\n        li.id = \"GPimportGetCapProposal_\" + id;\n\n        var context = this;\n        if (li.addEventListener) {\n            li.addEventListener(\"click\", function (e) {\n                context._onGetCapResponseLayerClick(e);\n            });\n        } else if (li.attachEvent) {\n            li.attachEvent(\"onclick\", function () {\n                context._onGetCapResponseLayerClick();\n            });\n        }\n\n        container.appendChild(li);\n        return container;\n    },\n\n    // ################################################################### //\n    // ########################### MapBox Panel ########################## //\n    // ################################################################### //\n\n    /**\n     * Create MapBox Panel Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportMapBoxPanelElement : function () {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportMapBoxPanel\");\n        div.className = \"GPpanel GPelementHidden gpf-panel fr-modal gpf-hidden\";\n        return div;\n    },\n\n    /**\n     * Create MapBox Panel Header Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportMapBoxPanelHeaderElement : function () {\n        // contexte\n        var context = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader gpf-panel__header fr-modal__header\";\n\n        // return picto\n        var returnDiv = document.createElement(\"button\");\n        returnDiv.id = this._addUID(\"GPimportMapBoxPanelReturnPicto\");\n        returnDiv.title = \"Nouvel import\";\n        returnDiv.className = \"GPreturnPicto GPimportMapBoxPanelReturnPicto gpf-btn gpf-btn-icon-return fr-btn fr-btn--secondary gpf-btn--secondary\";\n        if (returnDiv.addEventListener) {\n            returnDiv.addEventListener(\"click\", function (e) {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                context._onMapBoxReturnPictoClick(e);\n            });\n        } else if (returnDiv.attachEvent) {\n            returnDiv.attachEvent(\"onclick\", function (e) {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                context._onMapBoxReturnPictoClick(e);\n            });\n        }\n        container.appendChild(returnDiv);\n\n        // panel title\n        var panelTitle = document.createElement(\"div\");\n        panelTitle.className = \"GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w\";\n        panelTitle.innerHTML = \"Edition des styles\";\n        panelTitle.title = \"Edition des styles\";\n        container.appendChild(panelTitle);\n\n        // close picto\n        var closeDiv = document.createElement(\"button\");\n        closeDiv.className = \"GPpanelClose GPimportMapBoxPanelClose gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w\";\n        closeDiv.title = \"Fermer le panneau\";\n        closeDiv.id = this._addUID(\"GPimportMapBoxPanelClose\");\n        if (closeDiv.addEventListener) {\n            closeDiv.addEventListener(\"click\", function () {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                document.getElementById(context._addUID(\"GPimportMapBoxPanel\")).style.display = \"none\";\n                context._onMapBoxPanelClose();\n            });\n        } else if (closeDiv.attachEvent) {\n            closeDiv.attachEvent(\"click\", function () {\n                document.getElementById(context._addUID(\"GPshowImportPicto\")).click();\n                document.getElementById(context._addUID(\"GPimportMapBoxPanel\")).style.display = \"none\";\n                context._onMapBoxPanelClose();\n            });\n        }\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPelementHidden gpf-visible\"; // afficher en dsfr\n        span.innerText = \"Fermer\";\n\n        closeDiv.appendChild(span);\n\n        container.appendChild(closeDiv);\n\n        return container;\n    },\n\n    /**\n     * Create MapBox Results List Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportMapBoxResultsContainer : function () {\n        var container = document.createElement(\"div\");\n        container.className = \"GPimportMapBoxpRoot\";\n        container.id = this._addUID(\"GPimportMapBoxResults\");\n        return container;\n    }\n\n    // _addImportMapBoxResultListSource : function (id, source, container) {\n    //     var ul = document.createElement(\"ul\");\n    //     ul.className = \"GPimportMapBoxListSource\";\n    //     ul.title = id;\n    //\n    //     var label = document.createElement(\"label\");\n    //     label.className = \"GPimportMapBoxListSourceTitle\";\n    //     label.innerHTML = \"Listes des couches pour la source '\" + id + \"' :\";\n    //     label.title = source.attribution || id;\n    //     ul.appendChild(label);\n    //\n    //     container.appendChild(ul);\n    //     return container;\n    // },\n    //\n    // _addImportMapBoxResultSource : function (layer, container) {\n    //     var li = document.createElement(\"li\");\n    //     li.className = \"GPimportMapBoxSource\";\n    //\n    //     // input\n    //     var input = document.createElement(\"input\");\n    //     input.id = \"GPimportMapBoxSource-\" + SelectorID.generate();\n    //     input.className = \"GPimportMapBoxSource\";\n    //     input.type = \"checkbox\";\n    //     li.appendChild(input);\n    //\n    //     // label for\n    //     var name = layer[\"source-layer\"] || layer.id || layer.source;\n    //     var label = document.createElement(\"label\");\n    //     label.className = \"GPimportMapBoxSourceTitle\";\n    //     label.htmlFor = input.id;\n    //     label.innerHTML = name;\n    //     label.title = JSON.stringify(layer.metadata) || name;\n    //     li.appendChild(label);\n    //\n    //     container.appendChild(li);\n    //     return container;\n    // },\n    //\n    // _addImportMapBoxStyleSource : function (layer, container) {\n    //     // contexte\n    //     var self = this;\n    //\n    //     var _style = false;\n    //     var _obj = {};\n    //     var _layer = JSON.parse(JSON.stringify(layer)); // on utilise une copie  !\n    //     if (_layer.paint && Object.keys(_layer.paint).length) {\n    //         _style = true;\n    //         _obj.paint = _layer.paint;\n    //     }\n    //\n    //     // pas de style dans paint, on teste dans layout !\n    //     if (_layer.layout && Object.keys(_layer.layout).length) {\n    //         _style = true;\n    //         _obj.layout = _layer.layout;\n    //         // on supprime visibility à l'affichage uniquement\n    //         // cf. _addImportMapBoxVisibilitySource !\n    //         if (_layer.layout.visibility) {\n    //             delete _obj.visibility;\n    //         }\n    //     }\n    //\n    //     function syntaxHighlight (json) {\n    //         json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n    //         return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function (match) {\n    //             var cls = \"gp-json-number\";\n    //             if (/^\"/.test(match)) {\n    //                 if (/:$/.test(match)) {\n    //                     cls = \"gp-json-key\";\n    //                 } else {\n    //                     cls = \"gp-json-string\";\n    //                 }\n    //             } else if (/true|false/.test(match)) {\n    //                 cls = \"gp-json-boolean\";\n    //             } else if (/null/.test(match)) {\n    //                 cls = \"gp-json-null\";\n    //             }\n    //             return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n    //         });\n    //     }\n    //\n    //     var div = document.createElement(\"div\");\n    //     div.className = \"GPimportMapBoxSourceStyle\";\n    //\n    //     if (_style) {\n    //         var strJson = JSON.stringify(_obj, null, 4);\n    //\n    //         var label = document.createElement(\"label\");\n    //         label.innerHTML = \"JSON Styles :\";\n    //         div.appendChild(label);\n    //         var pre = document.createElement(\"pre\");\n    //         pre.className = \"GPimportMapBoxJsonEdit\";\n    //         pre.innerHTML = syntaxHighlight(strJson);\n    //         if (pre.addEventListener) {\n    //             pre.addEventListener(\"click\", function (e) {\n    //                 self._onSwitchStyleEditSourceMapBox(e);\n    //             });\n    //         } else if (pre.appendChild) {\n    //             pre.appendChild(\"onclick\", function (e) {\n    //                 self._onSwitchStyleEditSourceMapBox(e);\n    //             });\n    //         }\n    //         div.appendChild(pre);\n    //     }\n    //\n    //     container.appendChild(div);\n    //     return container;\n    // },\n    //\n    // _addImportMapBoxFilterSource : function (layer, container) {\n    //     // contexte\n    //     var self = this;\n    //\n    //     var _filter = false;\n    //     // FIXME tag filter est obselete !\n    //     // on doit utiliser les expressions dans \"paint\" ou \"layout\" !\n    //     if (layer.filter && layer.filter.length) {\n    //         _filter = true;\n    //     }\n    //\n    //     var div = document.createElement(\"div\");\n    //     div.className = \"GPimportMapBoxSourceFilter\";\n    //\n    //     if (_filter) {\n    //         var label = document.createElement(\"label\");\n    //         label.innerHTML = \"JSON Filtres :\";\n    //         div.appendChild(label);\n    //         var pre = document.createElement(\"pre\");\n    //         pre.className = \"GPimportMapBoxJsonEdit\";\n    //         pre.innerHTML = JSON.stringify(layer.filter, null, 4);\n    //         if (pre.addEventListener) {\n    //             pre.addEventListener(\"click\", function (e) {\n    //                 self._onSwitchFilterEditSourceMapBox(e);\n    //             });\n    //         } else if (pre.appendChild) {\n    //             pre.appendChild(\"onclick\", function (e) {\n    //                 self._onSwitchFilterEditSourceMapBox(e);\n    //             });\n    //         }\n    //         div.appendChild(pre);\n    //     }\n    //\n    //     container.appendChild(div);\n    //     return container;\n    // },\n    //\n    // _addImportMapBoxScaleSource : function (layer, container) {\n    //     // contexte\n    //     var self = this;\n    //\n    //     var _scaleMin = layer.minzoom || 0;\n    //     var _scaleMax = layer.maxzoom || 21;\n    //\n    //     var div = document.createElement(\"div\");\n    //     div.className = \"GPimportMapBoxSourceScale\";\n    //\n    //     var labelMin = document.createElement(\"label\");\n    //     labelMin.className = \"GPimportMapBoxSourceScaleLabel\";\n    //     labelMin.innerHTML = \"minZoom :\";\n    //     div.appendChild(labelMin);\n    //\n    //     var inputMin = document.createElement(\"input\");\n    //     inputMin.className = \"GPimportMapBoxSourceScaleInput\";\n    //     inputMin.type = \"range\";\n    //     inputMin.value = _scaleMin;\n    //     inputMin.title = _scaleMin;\n    //     inputMin.disabled = false;\n    //     inputMin.min = 0;\n    //     inputMin.max = 21;\n    //     if (inputMin.addEventListener) {\n    //         inputMin.addEventListener(\"change\", function (e) {\n    //             self._onChangeScaleMinSourceMapBox(e, layer);\n    //         });\n    //     } else if (inputMin.appendChild) {\n    //         inputMin.appendChild(\"onchange\", function (e) {\n    //             self._onChangeScaleMinSourceMapBox(e, layer);\n    //         });\n    //     }\n    //     div.appendChild(inputMin);\n    //\n    //     div.appendChild(document.createElement(\"br\"));\n    //\n    //     var labelMax = document.createElement(\"label\");\n    //     labelMax.className = \"GPimportMapBoxSourceScaleLabel\";\n    //     labelMax.innerHTML = \"maxZoom :\";\n    //     div.appendChild(labelMax);\n    //\n    //     var inputMax = document.createElement(\"input\");\n    //     inputMax.className = \"GPimportMapBoxSourceScaleInput\";\n    //     inputMax.type = \"range\";\n    //     inputMax.value = _scaleMax;\n    //     inputMax.title = _scaleMax;\n    //     inputMax.disabled = false;\n    //     inputMax.min = 0;\n    //     inputMax.max = 21;\n    //     if (inputMax.addEventListener) {\n    //         inputMax.addEventListener(\"change\", function (e) {\n    //             self._onChangeScaleMaxSourceMapBox(e, layer);\n    //         });\n    //     } else if (inputMax.appendChild) {\n    //         inputMax.appendChild(\"onchange\", function (e) {\n    //             self._onChangeScaleMaxSourceMapBox(e, layer);\n    //         });\n    //     }\n    //     div.appendChild(inputMax);\n    //\n    //     container.appendChild(div);\n    //     return container;\n    // },\n    //\n    // _addImportMapBoxVisibilitySource : function (layer, container) {\n    //     // contexte\n    //     var self = this;\n    //\n    //     var _visibility = true;\n    //     if (layer.layout && layer.layout.visibility && layer.layout.visibility === \"none\") {\n    //         _visibility = false;\n    //     }\n    //\n    //     var div = document.createElement(\"div\");\n    //     div.className = \"GPimportMapBoxSourceVisibility\";\n    //\n    //     var label = document.createElement(\"label\");\n    //     label.className = \"GPimportMapBoxSourceVisibilityLabel\";\n    //     label.innerHTML = \"Visibilité :\";\n    //     div.appendChild(label);\n    //\n    //     var input = document.createElement(\"input\");\n    //     input.className = \"GPimportMapBoxSourceVisibilityInput\";\n    //     input.type = \"checkbox\";\n    //     input.checked = _visibility;\n    //     input.disabled = false;\n    //     if (input.addEventListener) {\n    //         input.addEventListener(\"change\", function (e) {\n    //             self._onChangeVisibilitySourceMapBox(e, layer);\n    //         });\n    //     } else if (input.appendChild) {\n    //         input.appendChild(\"onchange\", function (e) {\n    //             self._onChangeVisibilitySourceMapBox(e, layer);\n    //         });\n    //     }\n    //     div.appendChild(input);\n    //\n    //     container.appendChild(div);\n    //     return container;\n    // }\n};\n\nexport default LayerImportDOM;\n","// import CSS\nimport \"../../CSS/Controls/LayerImport/GPFlayerImport.css\";\n// import \"../../CSS/Controls/LayerImport/GPFlayerImportStyle.css\";\n// import OpenLayers\n// import Control from \"ol/control/Control\";\nimport Widget from \"../Widget\";\nimport Control from \"../Control\";\nimport { unByKey as olObservableUnByKey } from \"ol/Observable\";\nimport Collection from \"ol/Collection\";\nimport Feature from \"ol/Feature\";\nimport WMTSTileGrid from \"ol/tilegrid/WMTS\";\n// import { createXYZ as olCreateXYZTileGrid } from \"ol/tilegrid\"; // FIXME olCreateXYZTileGrid !?\nimport {\n    transform as olTransformProj,\n    get as olGetProj,\n    transformExtent as olTransformExtentProj\n} from \"ol/proj\";\nimport MVT from \"ol/format/MVT\";\nimport WMSCapabilities from \"ol/format/WMSCapabilities\";\nimport WMTSCapabilities from \"ol/format/WMTSCapabilities\";\nimport VectorTileLayer from \"ol/layer/VectorTile\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport TileLayer from \"ol/layer/Tile\";\nimport VectorTileSource from \"ol/source/VectorTile\";\nimport VectorSource from \"ol/source/Vector\";\nimport TileWMSSource from \"ol/source/TileWMS\";\nimport WMTSSource from \"ol/source/WMTS\";\nimport TileJSONSource from \"ol/source/TileJSON\";\nimport {\n    Fill,\n    Icon,\n    Stroke,\n    Style,\n    Text\n} from \"ol/style\";\n// import olms : module ES6\nimport { applyStyle as applyStyleOlms } from \"ol-mapbox-style\";\n// import olms : bundle\n// import olms from \"ol-mapbox-style\";\n// import geoportal library access\nimport Gp from \"geoportal-access-lib\";\n// import local\nimport Editor from \"../Editor/Editor\";\nimport Markers from \"../Utils/Markers\";\nimport Draggable from \"../../Utils/Draggable\";\nimport Interactions from \"../Utils/Interactions\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport SelectorID from \"../../Utils/SelectorID\";\nimport ProxyUtils from \"../../Utils/ProxyUtils\";\n// DOM\nimport LayerImportDOM from \"./LayerImportDOM\";\n// import local with ol dependencies\nimport KMLExtended from \"../../Formats/KML\";\nimport GeoJSONExtended from \"../../Formats/GeoJSON\";\nimport GPXExtended from \"../../Formats/GPX\";\nimport LayerSwitcher from \"../LayerSwitcher/LayerSwitcher\";\nimport Route from \"../Route/Route\";\nimport Isocurve from \"../Isocurve/Isocurve\";\nimport ElevationPath from \"../ElevationPath/ElevationPath\";\n\nvar logger = Logger.getLogger(\"layerimport\");\n\n/**\n * @classdesc\n *\n * LayerImport Control. Allows users to add geographical data in standards formats from their own sources to the map.\n *\n * @constructor\n * @alias ol.control.LayerImport\n * @extends {ol.control.Control}\n * @type {ol.control.LayerImport}\n * @fires layerimport:mapbox:added\n * @fires layerimport:vector:added\n * @fires layerimport:service:added\n * @fires editor:loaded\n * @fires render:success\n * @fires render:failure\n * @param {Object} options - options for function call.\n * @param {Number} [options.id] - Ability to add an identifier on the widget (advanced option)\n * @param {Boolean} [options.collapsed = true] - Specify if LayerImport control should be collapsed at startup. Default is true.\n * @param {Boolean} [options.draggable = false] - Specify if widget is draggable\n * @param {Array} [options.layerTypes = [\"KML\", \"GPX\", \"GeoJSON\", \"WMS\", \"WMTS\", \"MAPBOX\"]] - data types that could be imported : \"KML\", \"GPX\", \"GeoJSON\", \"WMS\", \"WMTS\" and \"MAPBOX\". Values will be displayed in the same order in widget list.\n * @param {Object} [options.webServicesOptions = {}] - Options to import WMS or WMTS layers\n * @param {String} [options.webServicesOptions.proxyUrl] - Proxy URL to avoid cross-domain problems. Mandatory to import WMS and WMTS layer.\n * @param {Array.<String>} [options.webServicesOptions.noProxyDomains] - Proxy will not be used for this list of domain names. Only use if you know what you're doing.\n * @param {Object} [options.vectorStyleOptions] - Options for imported vector layer styling (KML, GPX, GeoJSON)\n * @param {Object} [options.vectorStyleOptions.KML] - Options for KML layer styling\n * @param {Boolean} [options.vectorStyleOptions.KML.extractStyles = true] - Extract styles from the KML. Default is true.\n * @param {Boolean} [options.vectorStyleOptions.KML.showPointNames = true] - Show names as labels for KML placemarks which contain points. Default is true.\n * @param {Object} [options.vectorStyleOptions.KML.defaultStyle] - default style to be applied to KML imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.GPX] - Options for GPX layer styling\n * @param {Object} [options.vectorStyleOptions.GPX.defaultStyle] - default style to be applied to GPX imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.GeoJSON] - Options for GeoJSON layer styling\n * @param {Object} [options.vectorStyleOptions.GeoJSON.defaultStyle] - default style to be applied to GeoJSON imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.MapBox] - Options for MapBox layer styling\n * @param {Object} [options.vectorStyleOptions.MapBox.defaultStyle] - default style to be applied to MapBox imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.MapBox.editor] - options for tools editor\n * @param {Boolean} [options.vectorStyleOptions.MapBox.display = true] - display tools editor\n * @example\n *  var LayerImport = new ol.control.LayerImport({\n *      \"collapsed\" : false,\n *      \"draggable\" : true,\n *      \"layerTypes\" : [\"KML\", \"GPX\"],\n *      \"webServicesOptions\" : {\n *          \"proxyUrl\" : \"http://localhost/proxy/php/proxy.php?url=\",\n *          \"noProxyDomains\" : []\n *      },\n *      \"vectorStyleOptions\" : {\n *          \"KML\" : {\n *              extractStyles : true,\n *              defaultStyle : new ol.style.Style({\n *                  image : new ol.style.Icon({\n *                       src : \"data:image/png;base64....\",\n *                       size : [51, 38],\n *                  }),\n *                  stroke : new ol.style.Stroke({\n *                       color : \"#ffffff\",\n *                       width : 7\n *                  }),\n *                  fill : new ol.style.Fill({\n *                       color : \"rgba(255, 183, 152, 0.2)\"\n *                  }),\n *                  text : new ol.style.Text({\n *                      font : \"16px Sans\",\n *                      textAlign : \"left\",\n *                      fill : new ol.style.Fill({\n *                          color : \"rgba(255, 255, 255, 1)\"\n *                      }),\n *                      stroke : new ol.style.Stroke({\n *                          color : \"rgba(0, 0, 0, 1)\",\n *                          width : 2\n *                      })\n *                  })\n *              })\n *          },\n *          \"GPX\" : {\n *              defaultStyle : new ol.style.Style({\n *                  image : new ol.style.Icon({\n *                       src : \"path/to/my/icon.png\",\n *                       size : [51, 38],\n *                  }),\n *                  stroke : new ol.style.Stroke({\n *                       color : \"#ffffff\",\n *                       width : 7\n *                  })\n *              })\n *          }\n *      }\n *  });\n */\nvar LayerImport = class LayerImport extends Control {\n\n    /**\n     * See {@link ol.control.LayerImport}\n     * @module LayerImport\n     * @alias module:~controls/LayerImport\n     * @param {*} options - options\n     * @example\n     * import LayerImport from \"gpf-ext-ol/controls/LayerImport\"\n     * ou\n     * import { LayerImport } from \"gpf-ext-ol\"\n     */\n    constructor (options) {\n        options = options || {};\n\n        // call ol.control.Control constructor\n        super(options);\n\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"LayerImport\";\n\n        if (!(this instanceof LayerImport)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize(options);\n\n        // init control DOM container\n        this._container = this._initContainer(options);\n\n        // ajout du container\n        (this.element) ? this.element.appendChild(this._container) : this.element = this._container;\n\n        return this;\n    };\n\n    /**\n    * Default styles applyied to KML, GPX and GeoJSON features.\n    *\n    * @private\n    */\n    static DefaultStyles = {\n        image : new Icon({\n            src : Markers[\"lightOrange\"],\n            anchor : [25.5, 38],\n            anchorOrigin : \"top-left\",\n            anchorXUnits : \"pixels\",\n            anchorYUnits : \"pixels\"\n        }),\n        stroke : new Stroke({\n            color : \"rgba(0,42,80,0.8)\",\n            width : 4\n        }),\n        fill : new Fill({\n            color : \"rgba(0, 183, 152, 0.5)\"\n        }),\n        text : new Text({\n            font : \"16px Sans\",\n            textAlign : \"left\",\n            fill : new Fill({\n                color : \"rgba(255, 255, 255, 1)\"\n            }),\n            stroke : new Stroke({\n                color : \"rgba(0, 0, 0, 1)\",\n                width : 2\n            })\n        })\n    };\n\n    // ################################################################### //\n    // ############## public methods (getters, setters) ################## //\n    // ################################################################### //\n\n    /**\n     * Overwrite OpenLayers setMap method\n     *\n     * @param {ol.Map} map - Map.\n     */\n    setMap (map) {\n        // ajout de la patience pour le chargement des tuiles\n        if (map) {\n            // Animation au centre de la carte ?\n            // var center = this._loadingContainer = this._createLoadingElement();\n            // map.getViewport().appendChild(center);\n\n            var self = this;\n            map.getLayers().on(\n                \"remove\",\n                function (e) {\n                    // import de type layerimport:MapBox ?\n                    if (e.element.gpResultLayerId === \"layerimport:MAPBOX\") {\n                        // layer ayant un editor ID associé ?\n                        if (e.element.gpEditorId) {\n                            // le panneau des résultats existe t il ?\n                            if (self._mapBoxPanel && self._importPanel) {\n                                self.cleanMapBoxResults(e.element.gpEditorId);\n                                self._mapBoxPanel.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                                self._mapBoxPanel.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n                            }\n                        }\n                    }\n                },\n                self\n            );\n\n            // mode \"draggable\"\n            if (this.draggable) {\n                Draggable.dragElement(\n                    this._importPanel,\n                    this._importPanelHeader,\n                    map.getTargetElement()\n                );\n\n                // panneau draggable pour les resultats ?\n                // Draggable.dragElement(\n                //     this._getCapPanel,\n                //     this._getCapPanelHeader,\n                //     map.getTargetElement()\n\n                // );\n                // Draggable.dragElement(\n                //     this._mapBoxPanel,\n                //     this._mapBoxPanelHeader,\n                //     map.getTargetElement()\n                // );\n            }\n            // mode \"collapsed\"\n            if (!this.collapsed) {\n                this._showImportButton.setAttribute(\"aria-pressed\", true);\n            }\n        }\n\n        // on appelle la méthode setMap originale d'OpenLayers\n        super.setMap(map);\n\n        // position\n        if (this.options.position) {\n            this.setPosition(this.options.position);\n        }\n\n        // reunion du bouton avec le précédent\n        if (this.options.gutter === false) {\n            this.getContainer().classList.add(\"gpf-button-no-gutter\");\n        }\n    }\n\n    /**\n     * Returns true if widget is collapsed (minimized), false otherwise\n     *\n     * @returns {Boolean} collapsed - true if widget is collapsed\n     */\n    getCollapsed () {\n        return this.collapsed;\n    }\n\n    /**\n     * Collapse or display widget main container\n     *\n     * @param {Boolean} collapsed - True to collapse widget, False to display it\n     */\n    setCollapsed (collapsed) {\n        if (collapsed === undefined) {\n            logger.error(\"[ERROR] LayerImport:setCollapsed - missing collapsed parameter\");\n            return;\n        }\n        if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n            return;\n        }\n        if (collapsed) {\n            this._panelCloseButton.click();\n        } else {\n            this._showImportButton.click();\n        }\n        this.collapsed = collapsed;\n    }\n\n    /**\n     * Returns content of a static import (KML, GPX or GeoJSON)\n     *\n     * @returns {String} contentStatic  - content static\n     */\n    getStaticImportContent () {\n        return this.contentStatic;\n    }\n\n    /**\n     * Returns content of a service import (GetCapabilities)\n     *\n     * @returns {String} contentService  - content service\n     */\n    getServiceImportContent () {\n        return this.contentService;\n    }\n\n    /**\n     * Returns layer name\n     *\n     * @returns {String} name - layer name\n     */\n    getName () {\n        return this._name;\n    }\n\n    /**\n     * Get container\n     *\n     * @returns {DOMElement} container\n     */\n    getContainer () {\n        return this._container;\n    }\n    // ################################################################### //\n    // ##################### init component ############################## //\n    // ################################################################### //\n\n    /**\n     * Initialize LayerImport control (called by LayerImport constructor)\n     *\n     * @param {Object} options - constructor options\n     * @private\n     */\n    _initialize (options) {\n        // ############################################################ //\n        // ################### Options du composant ################### //\n\n        // check input options format\n        this._checkInputOptions(options);\n\n        // set default options\n        this.options = {\n            collapsed : true,\n            draggable : false,\n            layerTypes : [\"KML\", \"GPX\", \"GeoJSON\", \"WMS\", \"WMTS\", \"MAPBOX\"],\n            webServicesOptions : {},\n            vectorStyleOptions : {\n                KML : {\n                    extractStyles : true,\n                    showPointNames : true,\n                    defaultStyle : {}\n                },\n                GPX : {\n                    defaultStyle : {}\n                },\n                GeoJSON : {\n                    defaultStyle : {}\n                },\n                MapBox : {\n                    defaultStyle : {},\n                    editor : {}\n                }\n            }\n        };\n\n        // TODO gestion du proxy\n\n        // set extractStyles parameter\n        if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.extractStyles) {\n            this.options.vectorStyleOptions.KML.extractStyles = options.vectorStyleOptions.KML.extractStyles;\n        } // TODO\n        // set showPointNames parameter\n        if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.showPointNames) {\n            this.options.vectorStyleOptions.KML.showPointNames = options.vectorStyleOptions.KML.showPointNames;\n        }\n\n        // set vector layers default styles (KML, GPX, GeoJSON, MapBox)\n        if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.defaultStyle) {\n            // get from options if specified\n            this.options.vectorStyleOptions.KML.defaultStyle = options.vectorStyleOptions.KML.defaultStyle;\n        } else {\n            // get from control default options otherwise\n            this.options.vectorStyleOptions.KML.defaultStyle = new Style({\n                image : LayerImport.DefaultStyles.image,\n                stroke : LayerImport.DefaultStyles.stroke,\n                fill : LayerImport.DefaultStyles.fill,\n                text : LayerImport.DefaultStyles.text\n            });\n        }\n        if (options.vectorStyleOptions && options.vectorStyleOptions.GPX && options.vectorStyleOptions.GPX.defaultStyle) {\n            // get from options if specified\n            this.options.vectorStyleOptions.GPX.defaultStyle = options.vectorStyleOptions.GPX.defaultStyle;\n        } else {\n            // get from control default options otherwise\n            this.options.vectorStyleOptions.GPX.defaultStyle = new Style({\n                image : LayerImport.DefaultStyles.image,\n                stroke : LayerImport.DefaultStyles.stroke,\n                fill : LayerImport.DefaultStyles.fill,\n                text : LayerImport.DefaultStyles.text\n            });\n        }\n        if (options.vectorStyleOptions && options.vectorStyleOptions.GeoJSON && options.vectorStyleOptions.GeoJSON.defaultStyle) {\n            // get from options if specified\n            this.options.vectorStyleOptions.GeoJSON.defaultStyle = options.vectorStyleOptions.GeoJSON.defaultStyle;\n        } else {\n            // get from control default options otherwise\n            this.options.vectorStyleOptions.GeoJSON.defaultStyle = new Style({\n                image : LayerImport.DefaultStyles.image,\n                stroke : LayerImport.DefaultStyles.stroke,\n                fill : LayerImport.DefaultStyles.fill,\n                text : LayerImport.DefaultStyles.text\n            });\n        }\n        // FIXME tester les styles par defaut sur une couche vecteur tuilé sans style !\n        if (options.vectorStyleOptions && options.vectorStyleOptions.MapBox && options.vectorStyleOptions.MapBox.defaultStyle) {\n            // get from options if specified\n            this.options.vectorStyleOptions.MapBox.defaultStyle = options.vectorStyleOptions.MapBox.defaultStyle;\n        } else {\n            // get from control default options otherwise\n            this.options.vectorStyleOptions.MapBox.defaultStyle = new Style({\n                image : LayerImport.DefaultStyles.image,\n                stroke : LayerImport.DefaultStyles.stroke,\n                fill : LayerImport.DefaultStyles.fill,\n                text : LayerImport.DefaultStyles.text\n            });\n        }\n\n        if (options.vectorStyleOptions && options.vectorStyleOptions.MapBox && options.vectorStyleOptions.MapBox.editor) {\n            // get from options if specified\n            this.options.vectorStyleOptions.MapBox.editor = options.vectorStyleOptions.MapBox.editor;\n        } else {\n            this.options.vectorStyleOptions.MapBox.editor = {\n                title : true,\n                collapse : false,\n                themes : false,\n                layers : true,\n                style : true,\n                filter : false,\n                legend : true,\n                group : false\n            };\n        }\n\n        if (options.vectorStyleOptions && options.vectorStyleOptions.MapBox && options.vectorStyleOptions.MapBox.hasOwnProperty(\"display\")) {\n            this.options.vectorStyleOptions.MapBox.display = options.vectorStyleOptions.MapBox.display;\n        } else {\n            this.options.vectorStyleOptions.MapBox.display = true;\n        }\n\n        // merge layer types\n        if (Array.isArray(options.layerTypes)) {\n            var layerTypes = [];\n            for (var i = 0; i < options.layerTypes.length; i++) {\n                layerTypes.push(options.layerTypes[i]);\n            }\n            this.options.layerTypes = layerTypes;\n        }\n\n        // merge with user options\n        Utils.mergeParams(this.options, options);\n\n        /** {Boolean} specify if LayerImport control is collapsed (true) or not (false) */\n        this.collapsed = this.options.collapsed;\n\n        /** {Boolean} specify if LayerImport control is draggable (true) or not (false) */\n        this.draggable = this.options.draggable;\n\n        // identifiant du contrôle : utile pour suffixer les identifiants CSS (pour gérer le cas où il y en a plusieurs dans la même page)\n        this._uid = this.options.id || SelectorID.generate();\n\n        // si une requête est en cours ou non\n        this._waiting = false;\n        // timer pour cacher la patience après un certain temps\n        this._timer = null;\n\n        // initialisation des types d'import\n        this._initImportTypes();\n        // initialisation des styles par défaut\n        this._initDefaultStyles();\n\n        // ################################################################## //\n        // ################### Elements principaux du DOM ################### //\n\n        // containers principaux (FIXME : tous utiles ?)\n        this._showImportButton = null;\n        this._importPanel = null;\n        this._panelCloseButton = null;\n        this._importPanelHeader = null;\n        this._importPanelTitle = null;\n        this._importPanelReturnPicto = null;\n        this._formContainer = null;\n        this._staticLocalImportInput = null;\n        this._staticUrlImportInput = null;\n        this._serviceUrlImportInput = null;\n        this._getCapPanel = null;\n        this._getCapPanelHeader = null;\n        this._getCapResultsListContainer = null;\n        this._mapBoxPanel = null;\n        this._mapBoxPanelHeader = null;\n        this._mapBoxResultsListContainer = null;\n\n        this._waitingContainer = null;\n        this._loadingContainer = null;\n\n        // ################################################################## //\n        // ################ Interrogation du GetCapabilities ################ //\n        this._hasGetCapResults = false;\n        this._getCapRequestUrl = null;\n        this._getCapResponseWMS = null;\n        this._getCapResponseWMSLayers = [];\n        this._getCapResponseWMTS = null;\n        this._getCapResponseWMTSLayers = [];\n\n        // ################################################################## //\n        // ########################### MapBox ############################### //\n        this._hasMapBoxResults = false;\n\n        // ################################################################## //\n        // ########################### file or url ########################## //\n        this.contentStatic = null;\n        this._url = null;\n        this._file = null;\n        this._name = null;\n    }\n\n    /**\n     * this method is called by this.initialize()\n     * and makes sure input options are correctly formated\n     *\n     * @param {Object} options - control input options\n     * @private\n     */\n    _checkInputOptions (options) {\n        // on vérifie le tableau des types\n        if (options.layerTypes) {\n            var layerTypes = options.layerTypes;\n            // on vérifie que la liste des types est bien un tableau\n            if (!Array.isArray(layerTypes)) {\n                logger.warn(\"[ol.control.LayerImport] 'options.layerTypes' parameter should be an array. Set default values [\\\"KML\\\", \\\"GPX\\\", \\\"GeoJSON\\\", \\\"WMS\\\", \\\"WMTS\\\"]\");\n                options.layerTypes = [\n                    \"KML\",\n                    \"GPX\",\n                    \"GeoJSON\",\n                    \"WMS\",\n                    \"WMTS\",\n                    \"MAPBOX\"\n                ];\n            } else {\n                var typesList = [\n                    \"KML\",\n                    \"GPX\",\n                    \"GEOJSON\",\n                    \"WMS\",\n                    \"WMTS\",\n                    \"WFS\",\n                    \"MAPBOX\"\n                ];\n                var wrongTypesIndexes = [];\n                for (var i = 0; i < layerTypes.length; i++) {\n                    if (typeof layerTypes[i] !== \"string\") {\n                        // si l'élément du tableau n'est pas une chaine de caractères, on stocke l'index pour le retirer du tableau\n                        wrongTypesIndexes.push(i);\n                        logger.warn(\"[ol.control.LayerImport] 'options.layerTypes' elements should be of type string (\" + layerTypes[i] + \")\");\n                    } else {\n                        // on passe en majuscules pour comparer\n                        layerTypes[i] = layerTypes[i].toUpperCase();\n                        if (typesList.indexOf(layerTypes[i]) === -1) {\n                            // si le type n'est pas référencé, on stocke son index pour le retirer du tableau (après avoir terminé de parcourir le tableau)\n                            wrongTypesIndexes.push(i);\n                            logger.log(\"[ol.control.LayerImport] options.layerTypes : \" + layerTypes[i] + \" is not a supported type\");\n                        }\n                        // cas spécial du GeoJSON qu'on ne laisse pas en majuscules\n                        if (layerTypes[i] === \"GEOJSON\") {\n                            layerTypes[i] = \"GeoJSON\";\n                        }\n                        if (layerTypes[i] === \"MAPBOX\") {\n                            layerTypes[i] = \"MAPBOX\";\n                        }\n                    }\n                }\n                // on retire les types non référencés qu'on a pu rencontrer\n                if (wrongTypesIndexes.length !== 0) {\n                    for (var j = wrongTypesIndexes.length - 1; j >= 0; j--) {\n                        layerTypes.splice(wrongTypesIndexes[j], 1);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * this method is called by this.initialize()\n     * and initializes default styles for vector layers (KML/GPX/GeoJSON)\n     *\n     * @private\n     */\n    _initDefaultStyles () {\n        var kmlDefaultStyles = this.options.vectorStyleOptions.KML.defaultStyle;\n        this._defaultKMLStyle = new Style({\n            image : kmlDefaultStyles.image,\n            stroke : kmlDefaultStyles.stroke,\n            fill : kmlDefaultStyles.fill,\n            text : kmlDefaultStyles.text\n        });\n        var gpxDefaultStyles = this.options.vectorStyleOptions.GPX.defaultStyle;\n        this._defaultGPXStyle = new Style({\n            image : gpxDefaultStyles.image,\n            stroke : gpxDefaultStyles.stroke,\n            fill : gpxDefaultStyles.fill,\n            text : gpxDefaultStyles.text\n        });\n        var geoJSONDefaultStyles = this.options.vectorStyleOptions.GeoJSON.defaultStyle;\n        this._defaultGeoJSONStyle = new Style({\n            image : geoJSONDefaultStyles.image,\n            stroke : geoJSONDefaultStyles.stroke,\n            fill : geoJSONDefaultStyles.fill,\n            text : geoJSONDefaultStyles.text\n        });\n        var MapBoxDefaultStyles = this.options.vectorStyleOptions.MapBox.defaultStyle;\n        this._defaultMapBoxStyle = new Style({\n            image : MapBoxDefaultStyles.image,\n            stroke : MapBoxDefaultStyles.stroke,\n            fill : MapBoxDefaultStyles.fill,\n            text : MapBoxDefaultStyles.text\n        });\n    }\n\n    /**\n     * this method is called by this.initialize()\n     * and initializes import types parameter\n     *\n     * @private\n     */\n    _initImportTypes () {\n        this._currentImportType = this.options.layerTypes[0] || \"KML\";\n        if (this._currentImportType === \"KML\" || this._currentImportType === \"GPX\" || this._currentImportType === \"GeoJSON\" || this._currentImportType === \"MAPBOX\") {\n            this._isCurrentImportTypeStatic = true;\n        } else if (this._currentImportType === \"WMS\" || this._currentImportType === \"WMTS\" || this._currentImportType === \"WFS\") {\n            this._isCurrentImportTypeStatic = false;\n        }\n        this._currentStaticImportType = \"local\";\n    }\n\n    /**\n     * Create control main container (DOM initialize)\n     *\n     * @private\n     * @returns {DOMElement} container - control main container\n     */\n    _initContainer () {\n        // create main container\n        var container = this._createMainContainerElement();\n\n        // create Import picto\n        var picto = this._showImportButton = this._createShowImportPictoElement();\n        container.appendChild(picto);\n\n        // panel\n        var importPanel = this._importPanel = this._createImportPanelElement();\n        var importPanelPanelDiv = this._createImportPanelDivElement();\n        importPanel.appendChild(importPanelPanelDiv);\n\n        // header\n        var panelHeader = this._importPanelHeader = this._createImportPanelHeaderElement();\n        // return\n        var panelReturn = this._importPanelReturnPicto = this._createImportPanelReturnPictoElement();\n        panelHeader.appendChild(panelReturn);\n\n        // panel title\n        var panelTitle = this._importPanelTitle = this._createImportPanelTitleElement();\n        panelHeader.appendChild(panelTitle);\n        // close picto\n        var panelClose = this._panelCloseButton = this._createImportPanelCloseElement();\n        panelHeader.appendChild(panelClose);\n        importPanelPanelDiv.appendChild(panelHeader);\n\n        // form : initialisation du formulaire d'import des couches (types d'import et saisie de l'url / du fichier)\n        var importForm = this._formContainer = this._initInputFormElement();\n        importPanelPanelDiv.appendChild(importForm);\n\n        // results (dans le panel)\n        var getCapPanel = this._getCapPanel = this._createImportGetCapPanelElement();\n        // var getCapPanelHeader = this._getCapPanelHeader = this._createImportGetCapPanelHeaderElement();\n        // getCapPanel.appendChild(getCapPanelHeader);\n        var importGetCapResultsList = this._getCapResultsListContainer = this._createImportGetCapResultsContainer();\n        getCapPanel.appendChild(importGetCapResultsList);\n        importPanelPanelDiv.appendChild(getCapPanel);\n\n        // mapbox panel results\n        var mapBoxPanel = this._mapBoxPanel = this._createImportMapBoxPanelElement();\n        // var mapBoxPanelHeader = this._mapBoxPanelHeader = this._createImportMapBoxPanelHeaderElement();\n        // mapBoxPanel.appendChild(mapBoxPanelHeader);\n        var importMapBoxResultsList = this._mapBoxResultsListContainer = this._createImportMapBoxResultsContainer();\n        mapBoxPanel.appendChild(importMapBoxResultsList);\n\n        // loading element mapbox\n        var loading = this._loadingContainer = this._createLoadingElement();\n        mapBoxPanel.appendChild(loading);\n\n        importPanelPanelDiv.appendChild(mapBoxPanel);\n\n        // waiting\n        var waiting = this._waitingContainer = this._createImportWaitingElement();\n        importPanelPanelDiv.appendChild(waiting);\n\n        container.appendChild(importPanel);\n\n        return container;\n    }\n\n    /**\n     * Create control main container (DOM initialize)\n     *\n     * @private\n     * @returns {DOMElement} importForm - form main container\n     */\n    _initInputFormElement () {\n        // form main container\n        var importForm = this._createImportPanelFormElement();\n\n        // Format choice\n        var importTypeChoiceDiv = this._createImportTypeLineElement(this.options.layerTypes);\n        importForm.appendChild(importTypeChoiceDiv);\n\n        // params for KML/GPX/GeoJSON\n\n        var importStaticParamsContainer = this._createImportStaticParamsContainer(this.options.layerTypes[0]);\n        // static file name\n        var staticNameLabel = this._createStaticNameLabel();\n        importStaticParamsContainer.appendChild(staticNameLabel);\n        // static import choice (local / url)\n        var staticImportChoice = this._createStaticModeChoiceDiv();\n        // TODO : passer un paramètre \"checked\" ??\n        var staticLocalImportChoice = this._createStaticLocalChoiceDiv();\n        staticImportChoice.appendChild(staticLocalImportChoice);\n        var staticUrlImportChoice = this._createStaticUrlChoiceDiv();\n        staticImportChoice.appendChild(staticUrlImportChoice);\n        importStaticParamsContainer.appendChild(staticImportChoice);\n\n        // div for local file import\n        var staticLocalInputDiv = this._createStaticLocalInputDiv();\n        // label\n        staticLocalInputDiv.appendChild(this._createStaticLocalInputLabel());\n        // file input\n        this._staticLocalImportInput = this._createStaticLocalInput();\n        staticLocalInputDiv.appendChild(this._staticLocalImportInput);\n        // append div to params container\n        importStaticParamsContainer.appendChild(staticLocalInputDiv);\n\n        // div for url input (info: séparation pour récupérer l'élément input)\n        var staticUrlInputDiv = this._createStaticUrlInputDiv();\n        // label\n        staticUrlInputDiv.appendChild(this._createStaticUrlInputLabel());\n        // url input\n        this._staticUrlImportInput = this._createStaticUrlInput();\n        staticUrlInputDiv.appendChild(this._staticUrlImportInput);\n        // append div to params container\n        importStaticParamsContainer.appendChild(staticUrlInputDiv);\n\n        // append static params container to form container\n        importForm.appendChild(importStaticParamsContainer);\n\n        // params for WMS/WMTS/WFS\n\n        var importServiceParamsContainer = this._createServiceParamsContainer(this.options.layerTypes[0]);\n        // div for service url\n        var importServiceUrlDiv = this._createServiceUrlDiv();\n        // label\n        importServiceUrlDiv.appendChild(this._createServiceUrlInputLabel());\n        // input\n        this._serviceUrlImportInput = this._createServiceUrlInput();\n        importServiceUrlDiv.appendChild(this._serviceUrlImportInput);\n        // append div to params container\n        importServiceParamsContainer.appendChild(importServiceUrlDiv);\n        // append service params container to form container\n        importForm.appendChild(importServiceParamsContainer);\n\n        // submit (bouton \"Importer\")\n        var submit = this._createImportSubmitFormElement();\n        importForm.appendChild(submit);\n\n        return importForm;\n    }\n\n    // ################################################################### //\n    // ######################### DOM events ############################## //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'click' on 'GPshowImportPicto' picto\n     * (cf. LayerImportDOM._createShowImportPictoElement),\n     * and dispatch event change:collapsed (for tools listening this property)\n     *\n     * @param { event } e évènement associé au clic\n     * @private\n     */\n    _onShowImportClick (e) {\n        var opened = this._showImportButton.ariaPressed;\n        if (opened === \"true\") {\n            this.onPanelOpen();\n        }\n        var map = this.getMap();\n        // on supprime toutes les interactions\n        Interactions.unset(map);\n        // info : on génère nous même l'evenement OpenLayers de changement de propriété\n        // (utiliser ol.control.LayerImport.on(\"change:collapsed\", function ) pour s'abonner à cet évènement)\n        this.collapsed = !(opened === \"true\");\n        this.dispatchEvent(\"change:collapsed\");\n        // on recalcule la position\n        if (this.options.position && !this.collapsed) {\n            this.updatePosition(this.options.position);\n        }\n        // on affiche les resultats d'une couche MapBox\n        // car on garde la possibilité de modifier la configuration des layers\n        if (this._hasMapBoxResults) {\n            this._mapBoxPanel.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n            this._mapBoxPanel.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n            this._hideFormContainer();\n        } else if (this._hasGetCapResults) {\n            this._getCapPanel.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n            this._getCapPanel.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n            this._hideFormContainer();\n        } else {\n            this._getCapPanel.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n            this._getCapPanel.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n            this._mapBoxPanel.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n            this._mapBoxPanel.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n            this._displayFormContainer();\n        }\n    }\n\n    /**\n     * this method is called by event 'change' on 'GPimportType' tag form\n     * (cf. LayerImportDOM._createImportTypeLineElement),\n     * and change current import type\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onImportTypeChange (e) {\n        this._currentImportType = e.target.value;\n        if (this._currentImportType === \"KML\" || this._currentImportType === \"GPX\" || this._currentImportType === \"GeoJSON\" || this._currentImportType === \"MAPBOX\") {\n            this._isCurrentImportTypeStatic = true;\n        } else if (this._currentImportType === \"WMS\" || this._currentImportType === \"WMTS\" || this._currentImportType === \"WFS\") {\n            this._isCurrentImportTypeStatic = false;\n        }\n    }\n\n    /**\n     * this method is called by event 'change' on 'GPimportType' tag form\n     * (cf. LayerImportDOM._createImportTypeLineElement),\n     * and change current import type\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onStaticImportTypeChange (e) {\n        this._currentStaticImportType = e.target.value;\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPimportGetCapPanelClose' tag form\n     * (cf. LayerImportDOM._createImportGetCapPanelHeaderElement),\n     * and reset getCapabilities information\n     *\n     * @private\n     */\n    _onGetCapPanelClose () {\n        // this._clearGetCapParams();\n        if (this._currentImportType === \"WMS\" ||\n        this._currentImportType === \"WMTS\" ||\n        this._currentImportType === \"WFS\") {\n            this.cleanGetCapResultsList();\n        }\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPimportMapBoxPanelClose' tag form\n     * (cf. LayerImportDOM._createImportMapBoxPanelHeaderElement),\n     * and reset mapbox information\n     *\n     * @private\n     */\n    _onMapBoxPanelClose () {\n        this.cleanMapBoxResultsList();\n        this._loadingContainer.className = \"\";\n        this._importPanelReturnPicto.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n        this._importPanelReturnPicto.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n        this._mapBoxPanel.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n        this._mapBoxPanel.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n    }\n\n    /**\n     * this method is called by event 'click' on 'GPimportPanelReturnPicto' tag form\n     * (cf. LayerImportDOM._createImportMapBoxPanelHeaderElement),\n     * and return to information\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onReturnPictoClick (e) {\n        // on bascule sur l'icone d'ouverture du composant\n        this._onGetCapPanelClose();\n        this._onMapBoxPanelClose();\n        this._loadingContainer.className = \"\";\n    }\n\n    // ################################################################### //\n    // ######################## Submit form ############################## //\n    // ################################################################### //\n\n    /**\n     * this method is called by event 'submit' on 'GPimportForm' tag form\n     * (cf. LayerImportDOM._createImportPanelFormElement),\n     * and import static layer or call getCap service (according to import type)\n     *\n     * @private\n     */\n    _onImportSubmit () {\n        logger.log(\"import d'une couche de type : \" + this._currentImportType);\n\n        // reinitialisation du contenu d'un import de type\n        // - static (KML ou GPX ou GeoJSON)\n        this.contentStatic = null;\n        // - service (WMS, ...)\n        this.contentService = null;\n\n        if (this._isCurrentImportTypeStatic) {\n            // on ferme le widget à l'import d'une couche statique\n            this.setCollapsed(true);\n            this._importStaticLayer();\n        } else {\n            this._importServiceLayers();\n        }\n    }\n\n    // ################################################################### //\n    // ############## Import KML/GPX/GeoJSON/MapBox layers ############### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this_onImportSubmit method\n     * and import static layer (KML/GPX/GeoJSON) from url or file\n     *\n     * @private\n     */\n    _importStaticLayer () {\n        var layerName;\n        var staticImportNameInput = document.getElementById(this._addUID(\"GPimportName\"));\n        if (staticImportNameInput) {\n            layerName = staticImportNameInput.value || \"\";\n            logger.log(\"import layer name : \" + layerName);\n        }\n\n        if (this._currentStaticImportType === \"local\") {\n            logger.log(\"import static layer from local file\");\n            this._importStaticLayerFromLocalFile(layerName);\n        } else if (this._currentStaticImportType === \"url\") {\n            logger.log(\"import static layer from url\");\n            this._importStaticLayerFromUrl(layerName);\n        }\n    }\n\n    /**\n     * this method is called by _importStaticLayer method\n     * and import static layer (KML/GPX/GeoJSON) from url\n     *\n     * @param {String} layerName - imported layer name\n     * @private\n     */\n    _importStaticLayerFromUrl (layerName) {\n        // 1. Récupération de l'url\n        var url = this._staticUrlImportInput.value;\n        logger.log(\"url : \", url);\n        if (url.length === 0) {\n            logger.error(\"[ol.control.LayerImport] url parameter is mandatory\");\n            return;\n        }\n        // on supprime les éventuels espaces avant ou après\n        if (url.trim) {\n            url = url.trim();\n        }\n\n        // sauvegarde\n        this._url = url;\n\n        // si le nom n'est pas renseigné, on extrait le nom du fichier\n        if (!layerName) {\n            layerName = this._url.substring(this._url.lastIndexOf(\"/\") + 1, this._url.lastIndexOf(\".\"));\n        }\n\n        // sauvegarde\n        this._name = layerName;\n\n        // 2. récupération proxy\n        if (this.options.webServicesOptions && this.options.webServicesOptions.proxyUrl) {\n            url = ProxyUtils.proxifyUrl(url, this.options.webServicesOptions);\n        }\n\n        // FIXME pb de surcharge en mode UMD !? ça ne marche pas...\n        // this._hideWaitingContainer();\n        // this._addFeaturesFromImportStaticLayerUrl(url, layerName);\n\n        var context = this;\n        Gp.Protocols.XHR.call({\n            url : url,\n            method : \"GET\",\n            timeOut : 15000,\n            // on success callback : display results in container\n            onResponse : function (response) {\n                context._hideWaitingContainer();\n                context._addFeaturesFromImportStaticLayer(response, layerName);\n            },\n            // on error callback : log error\n            onFailure : function (error) {\n                // en cas d'erreur, on revient au panel initial et on cache la patience\n                context._hideWaitingContainer();\n                logger.error(\"[ol.control.LayerImport] KML/GPX/GeoJSON/MapBox request failed : \", error);\n            }\n        });\n    }\n\n    /**\n     * this method is called by _importStaticLayer method\n     * and import static layer (KML/GPX/GeoJSON) from local file\n     *\n     * @param {String} layerName - imported layer name\n     * @private\n     */\n    _importStaticLayerFromLocalFile (layerName) {\n        var file = this._staticLocalImportInput.files[0];\n        if (!file) {\n            logger.warn(\"[ol.control.LayerImport] missing file\");\n            return;\n        }\n\n        // sauvegarde\n        this._file = file;\n\n        // si le nom n'est pas renseigné, on extrait le nom du fichier\n        if (!layerName) {\n            layerName = this._file.name.substring(this._file.name.lastIndexOf(\"/\") + 1, this._file.name.lastIndexOf(\".\"));\n        }\n\n        // sauvegarde\n        this._name = layerName;\n\n        // Création d'un objet FileReader qui permet de lire le contenu du fichier chargé\n        var fReader = new FileReader();\n\n        // Définition des fonctions de callbacks associées au reader,\n        // notamment la fonction onload qui affichera les entités chargées à la carte\n        var context = this;\n        // on readAsText error\n        fReader.onerror = (e) => {\n            // en cas d'erreur, on revient au panel initial et on cache la patience\n            context._hideWaitingContainer();\n            logger.error(\"error fileReader : \", e);\n        };\n        /** on readAsText progress */\n        fReader.onprogress = () => {\n            logger.log(\"onprogress\");\n        };\n        /** on load start */\n        fReader.onloadstart = () => {\n            // affichage d'une patience le temps du chargement\n            context._displayWaitingContainer();\n            logger.log(\"onloadstart\");\n        };\n        /** on readAsText abort */\n        fReader.onabort = () => {\n            // en cas d'erreur, on revient au panel initial et on cache la patience\n            context._hideWaitingContainer();\n            logger.log(\"onabort\");\n        };\n        // on readAsText loadend\n        fReader.onloadend = (e) => {\n            // fReader = null ?\n            // en cas d'erreur, on revient au panel initial et on cache la patience\n            // context._hideWaitingContainer();\n            // TODO : replier le formulaire ?\n            logger.log(\"onloadend : \", e);\n        };\n        // on readAsText load\n        fReader.onload = (e) => {\n            logger.log(\"fileReader onload - file content : \", e.target.result);\n\n            // on cache la patience\n            context._hideWaitingContainer();\n            context._addFeaturesFromImportStaticLayer(e.target.result, layerName);\n        };\n\n        // Lecture du fichier chargé à l'aide de fileReader\n        fReader.readAsText(file);\n    }\n\n    /**\n     * this method is called by _importStaticLayerFom* method\n     * and add features to the map\n     *\n     * @param {String} fileContent - content file\n     * @param {String} layerName - imported layer name\n     * @private\n     */\n    _addFeaturesFromImportStaticLayer (fileContent, layerName) {\n        // récupération du contenu du fichier\n        var map = this.getMap();\n        if (!map || !fileContent) {\n            return;\n        }\n\n        var vectorLayer = null;\n        var vectorSource = null;\n        var vectorFormat = null;\n        var vectorStyle = null;\n\n        // sauvegarde du content KML/GPX/GeoJSON/MapBox\n        this.contentStatic = fileContent;\n\n        if (this._currentImportType === \"MAPBOX\") {\n            // INFO\n            // on ne nettoie pas délibérément la liste de résultats de type MapBox\n            // car on souhaite pouvoir interagir sur les couches (editeur).\n            // du coup, à chaque import, on empile les éditeurs.\n            this._hasMapBoxResults = true;\n\n            // contexte\n            var self = this;\n\n            // style mapbox\n            var _glStyles = JSON.parse(fileContent);\n\n            // liste des sources\n            var _glSources = _glStyles.sources;\n\n            // FIXME a t on du multi-sources ?\n            // mais comment doit on les traiter ?\n            // EXPERIMENTAL !\n            var _multiSources = (Object.keys(_glSources).length > 1) ? 1 : 0;\n\n            for (var _glSourceId in _glSources) {\n                if (_glSources.hasOwnProperty(_glSourceId)) {\n                    var _title = \"\";\n                    var _description = \"\";\n                    var _quicklookUrl = null;\n                    var _legends = null;\n                    var _metadata = null;\n                    var _originators = null;\n\n                    // lecture des informations dans le style\n                    // ex. metadata : {\n                    //    geoportail:[title | description | quicklookUrl | legends | originators | metadata]\n                    // }\n                    if (_glStyles.metadata) {\n                        for (var ns in _glStyles.metadata) {\n                            if (_glStyles.metadata.hasOwnProperty(ns)) {\n                                var _keys = ns.split(\":\");\n                                if (_keys[0] === \"geoportail\") {\n                                    var key = _keys[1];\n                                    if (key === \"title\") {\n                                        _title = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                    if (key === \"description\") {\n                                        _description = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                    if (key === \"quicklookUrl\") {\n                                        _quicklookUrl = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                    if (key === \"legends\") {\n                                        _legends = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                    if (key === \"metadata\") {\n                                        _metadata = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                    if (key === \"originators\") {\n                                        _originators = _glStyles.metadata[ns];\n                                        continue;\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    // titre par defaut\n                    if (!_title) {\n                        _title = \"Couche MapBox\";\n                    }\n                    // description par defaut\n                    if (!_description) {\n                        _description = \"Couche MapBox\";\n                    }\n                    // cas des multisources\n                    _title = (_multiSources) ? _title + \"(\" + _glSourceId + \")\" : _title;\n\n                    // source mapbox\n                    var _glSource = _glSources[_glSourceId];\n\n                    // construction de la couche en fonction du type\n                    var _glType = _glSource.type;\n\n                    if (_glType === \"vector\") {\n                        // url du tilejson ou flux mapbox\n                        var _glUrl = _glSource.url;\n                        // url du service tuilé\n                        var _glTiles = _glSource.tiles;\n                        // sprites\n                        var _glSprite = _glStyles.sprite;\n\n                        // FIXME si on a un import par fichier local (this._file),\n                        // - comment passe t on la clef / le token ?\n                        // - comment remplacer un flux mapbox sur une url de service tuilé avec un import local ?\n                        if (_glUrl && _glUrl.indexOf(\"mapbox://\") === 0) {\n                            var _urlService = this._url; // FIXME si fichier local !?\n                            if (_urlService) {\n                                _glTiles = [\"a\", \"b\", \"c\", \"d\"].map(function (host) {\n                                    var path = _glUrl.replace(\"mapbox://\", \"\");\n                                    var accessToken = _urlService.split(\"?\")[1];\n                                    return \"https://\" +\n                                    host + \".tiles.mapbox.com/v4/\" +\n                                    path + \"/{z}/{x}/{y}.vector.pbf?\" +\n                                    accessToken;\n                                });\n                                // conversion des sprites sur un autre scheme que \"mapbox://\"\n                                if (_glSprite.indexOf(\"mapbox://\") === 0) {\n                                    var s = _urlService.split(\"?\"); // FIXME si fichier local !?\n                                    _glStyles.sprite = s[0] + \"/sprite\" + \"?\" + s[1];\n                                }\n                            } else {\n                                logger.warn(\"Not yet implemented, can't use the local import scheme with a 'mapbox://' in the file.!\");\n                            }\n                        }\n\n                        if (_glTiles) {\n                            // service tuilé et/ou mapbox\n                            vectorFormat = new MVT({\n                                featureClass : Feature\n                            });\n                            vectorSource = new VectorTileSource({\n                                attributions : _glSource.attribution,\n                                format : vectorFormat,\n                                // INFO\n                                // on supprime la grille pour forcer l'utilisation par defaut des tuiles en 512\n                                // sur du vecteur tuilé\n                                // tileGrid : olCreateXYZTileGrid({ // TODO scheme tms ?\n                                //     extent : _glSource.bounds, // [minx, miny, maxx, maxy]\n                                //     maxZoom : _glSource.maxzoom || 22,\n                                //     minZoom : _glSource.minzoom || 1,\n                                //     tileSize : _glSource.tileSize || 256\n                                // }),\n                                urls : _glTiles\n                            });\n                            vectorSource._title = _title;\n                            vectorSource._description = _description;\n                            vectorSource._quicklookUrl = _quicklookUrl;\n                            vectorSource._metadata = _metadata;\n                            vectorSource._legends = _legends;\n                            vectorSource._originators = _originators;\n                            // waiting\n                            vectorSource.on(\"tileloadstart\", function (e) {\n                                self._loadingContainer.className = \"GPmapLoadingVisible\";\n                            });\n                            vectorSource.on(\"tileloadend\", function (e) {\n                                self._loadingContainer.className = \"\";\n                            });\n                            vectorSource.on(\"tileloaderror\", function (e) {\n                                self._loadingContainer.className = \"\";\n                            });\n                            vectorLayer = new VectorTileLayer({\n                                source : vectorSource,\n                                visible : false,\n                                // zIndex: 0, // FIXME gerer l'ordre sur des multisources ?\n                                declutter : true // TODO utile ?\n                            });\n                            vectorLayer.id = _glSourceId;\n                            vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n                        } else if (_glUrl) {\n                            // service avec un tilejson\n                            vectorFormat = new MVT({\n                                featureClass : Feature\n                            });\n                            vectorLayer = new VectorTileLayer({\n                                visible : false,\n                                // zIndex : 0\n                                declutter : true\n                            });\n                            vectorLayer.id = _glSourceId;\n                            vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n                            var vectorTileJson = new TileJSONSource({\n                                url : _glUrl\n                            });\n                            // lecture du tilejson avec extension IGN\n                            // les extensions sont enregistrées\n                            // dans les propriétés de la couche : layer.set(mapbox-extension)\n                            // pour une utilisation ulterieur (ex. editeur)\n                            var _key = vectorTileJson.on(\"change\", function () {\n                                if (vectorTileJson.getState() === \"ready\") {\n                                    var _tileJSONDoc = vectorTileJson.getTileJSON();\n\n                                    var tiles = Array.isArray(_tileJSONDoc.tiles) ? _tileJSONDoc.tiles : [_tileJSONDoc.tiles];\n                                    for (var i = 0; i < tiles.length; i++) {\n                                        var tile = tiles[i];\n                                        if (tile.indexOf(\"http\") !== 0) {\n                                            tiles[i] = _glUrl + tile;\n                                        }\n                                    }\n                                    vectorSource = new VectorTileSource({\n                                        attributions : vectorTileJson.getAttributions() || _tileJSONDoc.attribution,\n                                        format : vectorFormat,\n                                        // tileGrid : olCreateXYZTileGrid({\n                                        //     extent : _glSource.bounds, // [minx, miny, maxx, maxy]\n                                        //     maxZoom : _glSource.maxzoom || 22,\n                                        //     minZoom : _glSource.minzoom || 1,\n                                        //     tileSize : _glSource.tileSize || 256\n                                        // }),\n                                        urls : tiles\n                                    });\n                                    vectorSource._title = _title;\n                                    vectorSource._description = _description;\n                                    vectorSource._quicklookUrl = _quicklookUrl;\n                                    vectorSource._metadata = _metadata;\n                                    vectorSource._legends = _legends;\n                                    vectorSource._originators = _originators;\n                                    // waiting\n                                    vectorSource.on(\"tileloadstart\", function (e) {\n                                        self._loadingContainer.className = \"GPmapLoadingVisible\";\n                                    });\n                                    vectorSource.on(\"tileloadend\", function (e) {\n                                        self._loadingContainer.className = \"\";\n                                    });\n                                    vectorLayer.setSource(vectorSource);\n                                    vectorLayer.set(\"mapbox-extension\", _tileJSONDoc[\"vector_layers\"]);\n                                    olObservableUnByKey(_key);\n                                }\n                            });\n                        }\n                    } else if (_glType === \"geojson\") {\n                        // FIXME\n                        // - cas avec un objet de type features ?\n                        // - cas avec une url relative ?\n                        var _glData = _glSource.data;\n\n                        vectorFormat = new GeoJSONExtended();\n                        vectorSource = new VectorTileSource({\n                            attributions : _glSource.attribution,\n                            format : vectorFormat,\n                            url : _glData\n                        });\n                        vectorSource._title = _title;\n                        vectorSource._description = _description;\n                        vectorSource._quicklookUrl = _quicklookUrl;\n                        vectorSource._metadata = _metadata;\n                        vectorSource._legends = _legends;\n                        vectorSource._originators = _originators;\n                        vectorLayer = new VectorTileLayer({\n                            source : vectorSource,\n                            visible : false,\n                            // zIndex: 0, // FIXME gerer l'ordre sur des multisources ?\n                            declutter : true // TODO utile ?\n                        });\n                        vectorLayer.id = _glSourceId;\n                        vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n                    } else {\n                        logger.warn(\"Type MapBox format unknown !\");\n                        return;\n                    }\n\n                    // clone\n                    var _glStyle = JSON.parse(JSON.stringify(_glStyles));\n                    // cas du multi source\n                    if (_multiSources) {\n                        // on supprime les layers inutiles\n                        var _glLayers = _glStyle.layers;\n                        for (var ii = 0; ii < _glLayers.length; ii++) {\n                            var _glLayer = _glLayers[ii];\n                            if (_glLayer.source !== _glSourceId) {\n                                _glLayers.splice(ii, 1);\n                                continue;\n                            }\n                        }\n                        // on supprime les sources inutiles\n                        for (var keySource in _glStyle.sources) {\n                            if (_glStyle.sources.hasOwnProperty(keySource)) {\n                                if (keySource !== _glSourceId) {\n                                    delete _glStyle.sources[keySource];\n                                }\n                            }\n                        }\n                    }\n\n                    // parametre à transmettre à la fonction auto-invoquée\n                    var params = {\n                        id : _glSourceId,\n                        styles : _glStyle,\n                        layer : vectorLayer,\n                        options : {\n                            title : layerName || _title,\n                            description : _description,\n                            quicklookUrl : _quicklookUrl,\n                            metadata : _metadata,\n                            legends : _legends,\n                            originators : _originators\n                        }\n                    };\n                    // fonction auto-invoquée\n                    (function (p) {\n                        // TODO ajouter le style de type background !\n                        // fonction de style de la couche\n                        var setStyle = () => {\n                            applyStyleOlms(p.layer, p.styles, { source : p.id })\n                                .then(function () {\n                                    var visibility = true;\n                                    p.layer.setVisible(visibility);\n                                    var opacity = 1;\n                                    p.layer.setOpacity(opacity);\n                                })\n                                .then(function () {\n                                    // gestion du centre sur la carte si center renseigné !\n                                    var projCode = map.getView().getProjection().getCode();\n                                    if (map.getView() && p.styles.center && p.styles.center.length) {\n                                        map.getView().setCenter(olTransformProj(p.styles.center, \"EPSG:4326\", projCode));\n                                    }\n\n                                    // gestion du zoom sur la carte si zoom renseigné !\n                                    if (map.getView() && (p.styles.zoom || p.styles.zoom === 0)) {\n                                        map.getView().setZoom(p.styles.zoom);\n                                    }\n\n                                    // TODO : appeler fonction commune\n                                    // zoom sur l'étendue des entités récupérées (si possible)\n                                    var source = p.layer.getSource();\n                                    if (map.getView() && map.getSize()) {\n                                        var sourceExtent = null;\n                                        if (source && source.getExtent) {\n                                            sourceExtent = source.getExtent();\n                                        } else {\n                                            sourceExtent = source.getTileGrid().getExtent();\n                                        }\n                                        \n                                        if (sourceExtent && sourceExtent[0] !== Infinity) {\n                                            map.getView().fit(sourceExtent, map.getSize());\n                                        }\n                                    }\n                                })\n                                .then(function () {\n                                    // on cache le panneau principal des imports\n                                    self._hideFormContainer();\n                                    self._importPanelHeader.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n                                    self._importPanelHeader.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n                                    self._importPanelTitle.innerHTML = \"Edition des styles\";\n\n                                    // editeur de styles\n                                    var editor = new Editor({\n                                        target : self._mapBoxResultsListContainer,\n                                        style : JSON.parse(JSON.stringify(p.styles)), // clone\n                                        scope : this,\n                                        events : {\n                                            \"editor:onloaded\" : self._onLoadedMapBox, // utile ?\n                                            \"editor:layer:onclickvisibility\" : self._onChangeVisibilitySourceMapBox,\n                                            \"editor:style:scale:onchangemin\" : self._onChangeScaleMinSourceMapBox,\n                                            \"editor:style:scale:onchangemax\" : self._onChangeScaleMaxSourceMapBox,\n                                            \"editor:legend:onchangevalue\" : self._onChangeLegendValueSourceMapBox,\n                                            \"editor:legend:onclickedition\" : self._onDisplayLayerSourceMapBox\n                                        },\n                                        tools : self.options.vectorStyleOptions.MapBox.editor\n                                    });\n                                    editor.setContext(\"map\", map);\n                                    editor.setContext(\"layer\", p.layer);\n                                    // creation de l'editeur\n                                    return editor.createElement()\n                                        .then(function () {\n                                            // exception...\n                                            if (editor.getLayers().length === 0) {\n                                                throw new Error(\"Il n'existe pas de styles pour la source demandée !?\");\n                                            }\n                                        })\n                                        .then(function () {\n                                            // affichage du panneau des couches accessibles à l'edition\n                                            if (self.options.vectorStyleOptions.MapBox.display) {\n                                                self._importPanelHeader.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                                                self._importPanelHeader.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n                                                self._mapBoxPanel.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                                                self._mapBoxPanel.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n                                                self._importPanelReturnPicto.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n                                                self._importPanelReturnPicto.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n                                            }\n                                        })\n                                        .then(function () {\n                                            // hack pour modifier le titre de la couche de fond\n                                            var elements = self._mapBoxResultsListContainer.getElementsByClassName(\"GPEditorMapBoxLayerTitleLabel\");\n                                            for (let index = 0; index < elements.length; index++) {\n                                                const element = elements[index];\n                                                if (element.textContent === \"bckgrd\") {\n                                                    element.textContent = \"Couleur de remplissage\";\n                                                }\n                                            }\n                                        })\n                                        .then(function () {\n                                            // association entre le layer et l'editeur via l'id\n                                            p.layer.set(\"mapbox-editor\", editor.getID());\n                                            // envoi d'un evenement\n                                            // un peu en décalé pour laisser le temps au DOM de faire le job...\n                                            setTimeout(function () {\n                                                map.dispatchEvent({\n                                                    id : editor.getID(),\n                                                    type : \"editor:loaded\",\n                                                    style : p.styles,\n                                                    layer : p.layer\n                                                });\n                                            }, 100);\n                                        })\n                                        .catch(function (e) {\n                                            // on propage l'exception\n                                            throw e;\n                                        });\n                                })\n                                .then(function () {\n                                    // envoi d'un evenement !\n                                    map.dispatchEvent({\n                                        id : p.id,\n                                        type : \"render:success\",\n                                        style : p.styles\n                                    });\n                                })\n                                .catch(function (e) {\n                                    logger.error(e);\n                                    // envoi d'un evenement !\n                                    map.dispatchEvent({\n                                        id : p.id,\n                                        type : \"render:failure\",\n                                        error : e\n                                    });\n                                });\n                        };\n\n                        // etat des layers en cours\n                        logger.warn(p.layer);\n\n                        // ajout des styles dans la carte pour une utilisation\n                        // eventuelle (ex. editeur)\n                        // > map.set(\"mapbox-styles\")\n                        var styles = map.get(\"mapbox-styles\") || {};\n                        var id = p.id; // FIXME : construction d'un id unique\n                        styles[id] = p.styles;\n                        map.set(\"mapbox-styles\", styles);\n\n                        // ajout des differents styles de la couche\n                        // pour une utilisation eventuelle (ex. editeur)\n                        // > layer.set(\"mapbox-styles\")\n                        p.layer.set(\"mapbox-styles\", p.styles);\n\n                        // ajout du layer sur la carte\n                        map.addLayer(p.layer);\n\n                        /**\n                         * event triggered when a layer is added\n                         *\n                         * @event layerimport:mapbox:added\n                         * @property {Object} type - event\n                         * @property {String} name - layerName\n                         * @property {String} data - data\n                         * @property {Object} layer - layer\n                         * @property {String} format - format\n                         * @property {Object} target - instance LayerImport\n                         * @example\n                         * LayerImport.on(\"layerimport:mapbox:added\", function (e) {\n                         *   console.log(e.layer);\n                         * })\n                         */\n                        self.dispatchEvent({\n                            type : \"layerimport:mapbox:added\",\n                            name : layerName,\n                            data : fileContent,\n                            layer : p.layer,\n                            format : self._currentImportType.toLowerCase() || \"mapbox\"\n                        });\n\n                        // application du style\n                        if (p.layer.getSource()) {\n                            setStyle();\n                        } else {\n                            p.layer.once(\"change:source\", setStyle);\n                        }\n\n                        // maj du gestionnaire de couche\n                        map.getControls().forEach(\n                            (control) => {\n                                if (control instanceof LayerSwitcher) {\n                                    control.addLayer(\n                                        p.layer,\n                                        p.options\n                                    );\n                                }\n                            }\n                        );\n                    })(params);\n                }\n            }\n\n            // TODO style par defaut au cas où l'application du style échoue !\n            // TODO au niveau de la couche : minResolution et maxResolution\n            // FIXME bug avec le geojson, très bizarre !?\n            //      Si on desactive l'editeur, OK\n            //      Sinon NOK !?\n        } else {\n            if (this._currentImportType === \"KML\") {\n                // lecture du fichier KML : création d'un format ol.format.KML, qui possède une méthode readFeatures (et readProjection)\n                vectorStyle = this.options.vectorStyleOptions.KML.defaultStyle;\n                vectorFormat = new KMLExtended({\n                    showPointNames : this.options.vectorStyleOptions.KML.showPointNames,\n                    extractStyles : this.options.vectorStyleOptions.KML.extractStyles,\n                    defaultStyle : [\n                        vectorStyle\n                    ]\n                });\n            } else if (this._currentImportType === \"GPX\") {\n                // lecture du fichier GPX : création d'un format ol.format.GPX, qui possède une méthode readFeatures (et readProjection)\n                vectorStyle = this.options.vectorStyleOptions.GPX.defaultStyle;\n                vectorFormat = new GPXExtended({\n                    defaultStyle : vectorStyle\n                });\n            } else if (this._currentImportType === \"GeoJSON\") {\n                // lecture du fichier GeoJSON : création d'un format ol.format.GeoJSON, qui possède une méthode readFeatures (et readProjection)\n                vectorStyle = this.options.vectorStyleOptions.GeoJSON.defaultStyle;\n                vectorFormat = new GeoJSONExtended({\n                    defaultStyle : vectorStyle\n                });\n            }\n\n            // lecture de la géométrie des entités à partir du fichier, pour éventuelle reprojection.\n            var fileProj = vectorFormat.readProjection(fileContent);\n            // récupération de la projection de la carte pour reprojection des géométries\n            var mapProj = this._getMapProjectionCode();\n\n            // récupération des entités avec reprojection éventuelle des géométries\n            var features = null;\n            features = vectorFormat.readFeatures(\n                fileContent, {\n                    dataProjection : fileProj,\n                    featureProjection : mapProj\n                }\n            );\n\n            logger.log(\"loaded features : \", features);\n\n            // création d'une couche vectorielle à partir de ces features\n            vectorSource = new VectorSource({\n                features : new Collection()\n            });\n            vectorSource.addFeatures(features);\n\n            logger.trace(vectorSource);\n\n            // ajout des informations pour le layerSwitcher (titre, description)\n            vectorSource._title = vectorSource._description = layerName;\n\n            vectorLayer = new VectorLayer({\n                source : vectorSource,\n                style : vectorStyle\n            });\n\n            // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant.\n            vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n\n            // cette couche est elle une couche de calcul ?\n            var configControl = vectorFormat.readRootExtensions(\"geoportail:compute\");\n            if (configControl && Object.keys(configControl).length !== 0) {\n                // identifier le type de calcul authorisé :\n                // * route\n                // * isocurve\n                // * elevationpath\n                var authorizedControls = {\n                    route : { class : Route, name : \"itineraire\" },\n                    isocurve : { class : Isocurve, name : \"isocurve\" },\n                    elevationpath : { class : ElevationPath, name : \"profil altimetrique\" }\n                };\n                // information à transmettre à la couche\n                var typeControl = configControl.type;\n                var graphControl = configControl.transport;\n                if (typeControl) {\n                    // la classe du controle\n                    var nameControl = authorizedControls[typeControl].name;\n                    var titleControl = (graphControl) ? nameControl + \" (\" + graphControl + \")\" : nameControl;\n                    var classControl = authorizedControls[typeControl].class;\n                    if (classControl) {\n                        // on est bien sur une couche de calcul authorisé !\n                        vectorLayer.gpResultLayerId = \"layerimport:COMPUTE\";\n                        // on transmet les infomations utiles\n                        vectorLayer.set(\"control\", typeControl);\n                        vectorLayer.set(\"name\", nameControl);\n                        vectorLayer.set(\"graph\", graphControl);\n                        vectorLayer.set(\"data\", configControl);\n                        vectorLayer.set(\"title\", titleControl);\n                        var formatGeoJSON = new GeoJSONExtended({\n                            defaultStyle : vectorStyle\n                        });\n                        var geojson = formatGeoJSON.writeFeatures(features, {\n                            dataProjection : \"EPSG:4326\",\n                            featureProjection : \"EPSG:3857\"\n                        });\n                        vectorLayer.set(\"geojson\", geojson);\n                        // recherche et initialiser le controle\n                        this.getMap().getControls().forEach((control) => {\n                            if (control instanceof classControl) {\n                                control.setData(configControl);\n                                control.setLayer(vectorLayer);\n                                control.init();\n                            }\n                        });\n                    }\n                }\n            }\n\n            map.addLayer(vectorLayer);\n\n            // TODO : appeler fonction commune\n            // zoom sur l'étendue des entités récupérées (si possible)\n            if (map.getView() && map.getSize() && vectorSource.getExtent) {\n                var sourceExtent = vectorSource.getExtent();\n                if (sourceExtent && sourceExtent[0] !== Infinity) {\n                    map.getView().fit(sourceExtent, map.getSize());\n                }\n            }\n\n            /**\n             * event triggered when a layer is added\n             *\n             * @event layerimport:vector:added\n             * @property {Object} type - event\n             * @property {String} name - layerName\n             * @property {String} data - data\n             * @property {Object} layer - layer\n             * @property {String} format - format\n             * @property {Object} target - instance LayerImport\n             * @example\n             * LayerImport.on(\"layerimport:vector:added\", function (e) {\n             *   console.log(e.layer);\n             * })\n             */\n            this.dispatchEvent({\n                type : \"layerimport:vector:added\",\n                name : layerName,\n                data : fileContent,\n                layer : vectorLayer,\n                format : this._currentImportType.toLowerCase()\n            });\n        }\n    }\n\n    /**\n     * NOT USE : this method is called by _importStaticLayerFom* method\n     * and add features to the map\n     *\n     * @param {String} url - url\n     * @param {String} layerName - imported layer name\n     * @private\n     */\n    _addFeaturesFromImportStaticLayerUrl (url, layerName) {\n        // récupération du contenu du fichier\n        var map = this.getMap();\n        if (!map || !url) {\n            return;\n        }\n\n        var vectorSource;\n        var vectorLayer;\n        var vectorFormat;\n        if (this._currentImportType === \"MAPBOX\") {\n            // TODO\n            logger.trace(\"Not yet implemented !\");\n        } else {\n            if (this._currentImportType === \"KML\") {\n                // lecture du fichier KML : création d'un format ol.format.KML, qui possède une méthode readFeatures (et readProjection)\n                vectorFormat = new KMLExtended({\n                    showPointNames : true, // FIXME option !\n                    extractStyles : this.options.vectorStyleOptions.KML.extractStyles,\n                    defaultStyle : [\n                        this.options.vectorStyleOptions.KML.defaultStyle\n                    ]\n                });\n            } else if (this._currentImportType === \"GPX\") {\n                // lecture du fichier GPX : création d'un format ol.format.GPX, qui possède une méthode readFeatures (et readProjection)\n                vectorFormat = new GPXExtended({\n                    defaultStyle : this.options.vectorStyleOptions.GPX.defaultStyle\n                });\n            } else if (this._currentImportType === \"GeoJSON\") {\n                // lecture du fichier GeoJSON : création d'un format ol.format.GeoJSON, qui possède une méthode readFeatures (et readProjection)\n                vectorFormat = new GeoJSONExtended({\n                    defaultStyle : this.options.vectorStyleOptions.GeoJSON.defaultStyle\n                });\n            }\n\n            // création d'une couche vectorielle à partir de ces features\n            vectorSource = new VectorSource({\n                url : url,\n                format : vectorFormat\n            });\n\n            if (this._currentImportType === \"GPX\") {\n                vectorSource.forEachFeature(\n                    function (feature) {\n                        // si aucun style n'est associé au feature\n                        if (feature.getStyle() == null) {\n                            logger.log(\"[ol.control.LayerImport] set default style for GPX feature\");\n                            feature.setStyle(\n                                this.options.vectorStyleOptions.GPX.defaultStyle\n                            );\n                        }\n                    }\n                );\n            }\n            if (this._currentImportType === \"GeoJSON\") {\n                vectorSource.forEachFeature(\n                    function (feature) {\n                        // si aucun style n'est associé au feature\n                        if (feature.getStyle() == null) {\n                            logger.log(\"[ol.control.LayerImport] set default style for GeoJSON feature\");\n                            feature.setStyle(\n                                this.options.vectorStyleOptions.GeoJSON.defaultStyle\n                            );\n                        }\n                    }\n                );\n            }\n\n            // ajout des informations pour le layerSwitcher (titre, description)\n            vectorSource._title = vectorSource._description = layerName;\n\n            vectorLayer = new VectorLayer({\n                source : vectorSource\n            });\n        }\n\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant. (pour layerSwitcher par ex)\n        vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n        map.addLayer(vectorLayer);\n\n        // TODO : appeler fonction commune\n        // zoom sur l'étendue des entités récupérées (si possible)\n        if (map.getView() && map.getSize() && vectorSource.getExtent) {\n            var sourceExtent = vectorSource.getExtent();\n            if (sourceExtent && sourceExtent[0] !== Infinity) {\n                map.getView().fit(sourceExtent, map.getSize());\n            }\n        }\n\n        /**\n         * event triggered when a layer is added\n         *\n         * @event layerimport:vector:added\n         * @property {Object} type - event\n         * @property {String} name - layerName\n         * @property {String} url - url\n         * @property {Object} layer - layer\n         * @property {String} format - format\n         * @property {Object} target - instance LayerImport\n         * @example\n         * LayerImport.on(\"layerimport:vector:added\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerimport:vector:added\",\n            name : layerName,\n            url : url,\n            layer : vectorLayer,\n            format : this._currentImportType.toLowerCase()\n        });\n    }\n\n    // Events MapBox DOM\n\n    /**\n     * this method is called when the editor is loaded\n     *\n     * @param {Object} e - editor\n     */\n    _onLoadedMapBox (e) {\n        var data = e.target.data.obj;\n        var layer = this.getContext(\"layer\");\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            // some stuff..\n        }\n    }\n\n    /**\n     * this method is called on '_addImportMapBoxVisibilitySource' input click\n     * and change visibility source to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onChangeVisibilitySourceMapBox (e) {\n        var data = e.target.data.obj;\n        var target = e.target.srcElement;\n        var layer = this.getContext(\"layer\");\n\n        // logger.trace(layer);\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            // reload style with new param : layout.visibility : \"visible\" or \"none\"...\n            var styles = layer.get(\"mapbox-styles\");\n            var layers = styles.layers;\n            for (var i = 0; i < layers.length; i++) {\n                if (layers[i].id === data.id) {\n                    var layout = layers[i].layout;\n                    if (layout) {\n                        layout.visibility = (target.checked) ? \"visible\" : \"none\";\n                    } else {\n                        layers[i].layout = {\n                            visibility : (target.checked) ? \"visible\" : \"none\"\n                        };\n                    }\n                    break;\n                }\n            }\n            applyStyleOlms(layer, styles, { source : data.source })\n                .then(function () {})\n                .catch(function (error) {\n                    logger.error(error);\n                });\n        }\n    }\n\n    /**\n     * this method is called on '_addImportMapBoxScaleSource' input slide\n     * and change zoom source to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onChangeScaleMinSourceMapBox (e) {\n        var data = e.target.data.obj;\n        var target = e.target.srcElement;\n        var layer = this.getContext(\"layer\");\n\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            // reload style with new param : minZoom = ...\n            var styles = layer.get(\"mapbox-styles\");\n            var layers = styles.layers;\n            for (var i = 0; i < layers.length; i++) {\n                if (layers[i].id === data.id) {\n                    layers[i].minzoom = target.value;\n                    target.title = target.value;\n                    break;\n                }\n            }\n            applyStyleOlms(layer, styles,  { source : data.source })\n                .then(function () {})\n                .catch(function (error) {\n                    logger.error(error);\n                });\n        }\n    }\n\n    /**\n     * this method is called on '_addImportMapBoxScaleSource' input slide\n     * and change zoom source to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onChangeScaleMaxSourceMapBox (e) {\n        var data = e.target.data.obj;\n        var target = e.target.srcElement;\n        var layer = this.getContext(\"layer\");\n\n        // logger.trace(layer);\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            // reload style with new param : minZoom = ...\n            var styles = layer.get(\"mapbox-styles\");\n            var layers = styles.layers;\n            for (var i = 0; i < layers.length; i++) {\n                if (layers[i].id === data.id) {\n                    layers[i].maxzoom = target.value;\n                    target.title = target.value;\n                    break;\n                }\n            }\n            applyStyleOlms(layer, styles,  { source : data.source })\n                .then(function () {})\n                .catch(function (error) {\n                    logger.error(error);\n                });\n        }\n    }\n\n    /**\n     * this method is called on ''\n     * and change zoom source to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onChangeLegendValueSourceMapBox (e) {\n        var data = e.target.data.obj;\n        var target = e.target.srcElement;\n        var layer = this.getContext(\"layer\");\n\n        // logger.trace(layer);\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            // reload style with new param :\n            var styles = layer.get(\"mapbox-styles\");\n            var layers = styles.layers;\n            for (var i = 0; i < layers.length; i++) {\n                if (layers[i].id === data.id) {\n                    var paint = layers[i].paint;\n                    if (paint) {\n                        paint[target.dataset.id] = target.value;\n                    }\n                    break;\n                }\n            }\n            applyStyleOlms(layer, styles,  { source : data.source, updateSource : true })\n                .then(function () {})\n                .catch(function (error) {\n                    logger.error(error);\n                });\n        }\n    }\n\n    /**\n     * this method is called on ''\n     * and change zoom source to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onDisplayLayerSourceMapBox (e) {\n        var data = e.target.data.obj;\n        var layer = this.getContext(\"layer\");\n\n        if (layer.get(\"mapbox-source\") === data.source && layer.get(\"mapbox-editor\") === e.target.editorID) {\n            var idDOM = e.target.currentTarget.parentNode.id;\n            var id = idDOM.substring(idDOM.indexOf(\"-\") + 1, idDOM.indexOf(\"_\"));\n            var l = this.getLayer(id);\n            l.collapse();\n        }\n    }\n\n    // ################################################################### //\n    // #################### Import WMS/WMTS layers ####################### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this_onImportSubmit method\n     * and call getCap service from specified url, then display layers list in new panel\n     *\n     * @private\n     */\n    _importServiceLayers () {\n        if (this._currentImportType === \"WFS\") {\n            logger.warn(\"[ol.control.LayerImport] WFS layer import is not implemented yet\");\n            return;\n        }\n\n        // 0. on vide d'éventuels résultats précédents dans le panel GetCapResults\n        this.cleanGetCapResultsList();\n\n        // 1. récupération de l'url renseignée\n        var url = this._getCapRequestUrl = this._serviceUrlImportInput.value;\n        if (!url) {\n            logger.error(\"[ol.control.LayerImport] url parameter is mandatory\");\n            return;\n        }\n        logger.log(\"url : \", url);\n\n        // on supprime les éventuels espaces avant ou après\n        if (url.trim) {\n            url = url.trim();\n        }\n        // Info : on ajoute des paramètres uniquement si l'utilisateur n'en a pas déjà saisi (on vérifie la position du caractère \"?\")\n        var questionMarkIndex = url.indexOf(\"?\");\n        if (questionMarkIndex < 0) {\n            // dans le cas d'une url du type https://data.geopf.fr/wmts\n            url += \"?SERVICE=\" + this._currentImportType + \"&REQUEST=GetCapabilities\";\n        } else if (questionMarkIndex === (url.length - 1)) {\n            // dans le cas où l'url se termine par \"?\"\n            url += \"SERVICE=\" + this._currentImportType + \"&REQUEST=GetCapabilities\";\n        }\n        // si on n'est pas dans ces deux cas : l'utilisateur a déjà saisit des paramètres après \"?\" => on ne fait rien.\n\n        // 2. récupération proxy\n        if (this.options.webServicesOptions && this.options.webServicesOptions.proxyUrl) {\n            url = ProxyUtils.proxifyUrl(url, this.options.webServicesOptions);\n        }\n\n        // 3. affichage d'une patience le temps de la requête\n        this._displayWaitingContainer();\n\n        // 4. send getcapabilities request (XHR protocol => proxy Url is needed)\n        var context = this;\n        Gp.Protocols.XHR.call({\n            url : url,\n            method : \"GET\",\n            timeOut : 15000,\n            // on success callback : display results in container\n            onResponse : function (response) {\n                context._hideWaitingContainer();\n                context._displayGetCapResponseLayers(response);\n            },\n            // on error callback : log error\n            onFailure : function (error) {\n                // en cas d'erreur, on revient au panel initial et on cache la patience\n                context._hideWaitingContainer();\n                logger.error(\"[ol.control.LayerImport] getCapabilities request failed : \", error);\n            }\n        });\n    }\n\n    /**\n     * this method is called by this._importServiceLayers method\n     * and display layers list from getcapabilities response\n     *\n     * @param {Object} xmlResponse - getCapabilities response (xml format)\n     * @private\n     */\n    _displayGetCapResponseLayers (xmlResponse) {\n        var parser;\n        var layers;\n        var layerDescription = {\n            content : null,\n            title : null\n        };\n        var projection;\n        this._getCapResponseWMSLayers = [];\n\n        // sauvegarde du content d'un GetCapabilities\n        this.contentService = xmlResponse;\n\n        // Affichage du panel des couches accessibles\n        this._hideFormContainer();\n        this._getCapPanel.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n        this._getCapPanel.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n        this._importPanelTitle.innerHTML = \"Couches accessibles\";\n        this._importPanelReturnPicto.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n        this._importPanelReturnPicto.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n        this._hasGetCapResults = true;\n        // Parse GetCapabilities Response\n        if (this._currentImportType === \"WMS\") {\n            parser = new WMSCapabilities();\n            var getCapResponseWMS = this._getCapResponseWMS = parser.read(xmlResponse);\n            logger.log(\"getCapabilities response : \", getCapResponseWMS);\n\n            if (getCapResponseWMS && getCapResponseWMS.Capability && getCapResponseWMS.Capability.Layer) {\n                // info: le parser Openlayers récupère la première layer de <Capability> comme un unique objet (il écrase les précédents s'il y a pls <Layer> à la racine de <Capability>)\n                // /!\\ être vigilant si le parser est modifié (notamment pour récupérer les différentes layers à la racine. ex  http://geoservices.brgm.fr/geologie?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetCapabilities)\n\n                var getCapLayer = getCapResponseWMS.Capability.Layer;\n                // on va lire le contenu de la (ou les) <Layer> pour l'afficher ou en afficher les couches disponibles\n                if (Array.isArray(getCapLayer)) {\n                    // cas où on a plusieurs <Layer> à la racine, mais non géré encore par ol.format.WMSCapabilities jusqu'à la v3.18.2.\n                    for (var i = 0; i < getCapLayer.length; i++) {\n                        this._displayGetCapResponseWMSLayer(getCapLayer[i]);\n                    }\n                } else {\n                    // cas du parser ol.format.WMSCapabilities jusqu'à la v3.18.2.\n                    this._displayGetCapResponseWMSLayer(getCapLayer);\n                }\n            }\n        } else if (this._currentImportType === \"WMTS\") {\n            parser = new WMTSCapabilities();\n            var getCapResponseWMTS = this._getCapResponseWMTS = parser.read(xmlResponse);\n            logger.log(\"getCapabilities response : \", getCapResponseWMTS);\n\n            if (getCapResponseWMTS && getCapResponseWMTS.Contents && getCapResponseWMTS.Contents.Layer) {\n                layers = getCapResponseWMTS.Contents.Layer;\n\n                if (Array.isArray(layers)) {\n                    // on stocke la liste des couches pour faire le lien avec le DOM\n                    this._getCapResponseWMTSLayers = layers;\n\n                    for (var j = 0; j < layers.length; j++) {\n                        // on vérifie que la projection de la couche WMTS est compatible avec celle de la carte\n                        // (ie elle doit être connue par ol.proj)\n                        projection = this._getWMTSLayerProjection(layers[j], getCapResponseWMTS);\n                        if (projection && typeof projection === \"string\") {\n                            if (olGetProj(projection) || olGetProj(projection.toUpperCase())) {\n                                // si la projection de la couche est connue par ol.proj,\n                                // on ajoute chaque couche de la réponse dans la liste des couches accessibles\n                                layerDescription = {\n                                    content : layers[j].Title,\n                                    title : layers[j].Abstract || layers[j].Title\n                                };\n                                if (this._getCapResultsListContainer) {\n                                    this._addImportGetCapResultLayer(layerDescription, j, this._getCapResultsListContainer);\n                                }\n                            } else {\n                                // si la projection de la couche n'est pas connue par ol.proj,\n                                // on n'affiche pas la couche dans le panel des résultats\n                                logger.warn(\"[ol.control.LayerImport] wmts layer cannot be added to map : unknown projection\", layers[j]);\n                                continue;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * this method is called by this._displayGetCapResponseLayers method\n     * and display WMS layer in list from getcapabilities response\n     *\n     * @param {Object} layerObj - object corresponding to <Layer> content in WMS GetCapabilities response\n     * @param {Object} [parentLayersInfos] - object corresponding to parents <Layer> content in WMS GetCapabilities response (without children <Layer> infos)\n     * @private\n     */\n    _displayGetCapResponseWMSLayer (layerObj, parentLayersInfos) {\n        if (!layerObj) {\n            logger.warn(\"[ol.control.LayerImport] _displayGetCapResponseWMSLayer : getCapabilities layer object not found\");\n            return;\n        }\n\n        logger.log(\"[ol.control.LayerImport] _displayGetCapResponseWMSLayer - layerObj : \", layerObj);\n\n        // récupération de la projection de la map (pour vérifier que l'on peut reprojeter les couches disponibles)\n        var mapProjCode = this._getMapProjectionCode();\n        var projection;\n        var layerDescription = {\n            content : null,\n            title : null\n        };\n\n        // 1. héritage éventuels des informations de la couche parent\n        if (parentLayersInfos) {\n            var key;\n            var i;\n\n            // propriétés héritées à ajouter aux propriétés parent\n            var addKeys = [\n                \"CRS\",\n                \"Style\"\n                // \"AuthorityURL\" // TODO\n            ];\n            for (i = 0; i < addKeys.length; i++) {\n                key = addKeys[i];\n                if (Array.isArray(parentLayersInfos[key]) && parentLayersInfos[key].length !== 0) {\n                    if (Array.isArray(layerObj[key]) && layerObj[key].length !== 0) {\n                        // on ajoute celles de la couche parent\n                        for (var n = 0; n < parentLayersInfos[key].length; n++) {\n                            if (layerObj[key].indexOf(parentLayersInfos[key][n]) === -1) {\n                                // si le CRS/Style parent n'est pas dans les CRS/Style de la couche, on l'ajoute\n                                layerObj[key].push(parentLayersInfos[key][n]);\n                            }\n                        }\n                    } else {\n                        // si la couche n'a pas de CRS ou Style, on récupère ceux de la couche parent\n                        layerObj[key] = parentLayersInfos[key];\n                    }\n                }\n            }\n\n            // propriétés qui remplacent les valeurs des propriétés héritées,\n            // càd on récupère la propriété parent seulement si elle n'est pas définie pour l'élément enfant\n            var replaceKeys = [\n                \"BoundingBox\",\n                \"EX_GeographicBoundingBox\",\n                \"MaxScaleDenominator\",\n                \"MinScaleDenominator\",\n                \"Attribution\",\n                \"Dimension\",\n                \"queryable\",\n                \"cascaded\",\n                \"opaque\",\n                \"noSubsets\",\n                \"fixedWidth\",\n                \"fixedHeight\"\n            ];\n            for (i = 0; i < replaceKeys.length; i++) {\n                key = replaceKeys[i];\n                if (parentLayersInfos[key] && !layerObj[key]) {\n                    layerObj[key] = parentLayersInfos[key];\n                }\n            }\n        } else {\n            // si on n'a pas d'infos de couche parent, on est à la racine du Capability, on le note\n            layerObj._isRootLayer = true;\n            layerObj._container = this._getCapResultsListContainer;\n            if (!layerObj.Title) {\n                layerObj.Title = \"Liste des couches\";\n            }\n        }\n\n        // 2. si on a d'autres couches <Layer> imbriquées, on descend d'un niveau, sinon on affiche la couche dans la liste des résultats\n        if (layerObj.Layer) {\n            if (Array.isArray(layerObj.Layer)) {\n                var _container = (layerObj) ? layerObj._container : parentLayersInfos._container;\n                var _title = (layerObj) ? layerObj.Title : parentLayersInfos.Title;\n                layerObj._container = this._addImportGetCapResultListRubrique(_title, _container).lastChild;\n                for (var j = 0; j < layerObj.Layer.length; j++) {\n                    // on recommence pour chaque sous couche, avec les infos éventuellement héritées\n                    var bRubriqueExist = false;\n                    var lstRubrique = layerObj._container.getElementsByClassName(\"GPimportGetCapRubriqueTitle\");\n                    for (var ii = 0; ii < lstRubrique.length; ii++) {\n                        if (lstRubrique[ii].title === layerObj.Title) {\n                            bRubriqueExist = true;\n                            layerObj.Layer[j]._container = lstRubrique[ii].parentElement;\n                        }\n                    }\n                    if (!bRubriqueExist) {\n                        layerObj.Layer[j]._container = this._addImportGetCapResultRubrique(layerObj.Title, layerObj._container).lastChild;\n                    }\n                    this._displayGetCapResponseWMSLayer(layerObj.Layer[j], layerObj);\n                }\n            }\n        } else {\n            // on récupère la longueur de la liste des couches déjà récupérées, pour avoir ce qui sera l'index de la couche à ajouter.\n            var lastIndex = this._getCapResponseWMSLayers.length;\n\n            // on vérifie que la couche ait une projection compatible avec celle de la carte\n            // ou soit connue par proj4js, et on stocke cette projection dans les infos de la couche.\n            projection = this._getWMSLayerProjection(layerObj, mapProjCode);\n\n            if (!projection) {\n                // si aucune projection n'est compatible avec celle de la carte ou connue par ol.proj,\n                // on n'affiche pas la couche dans le panel des résultats\n                logger.warn(\"[ol.control.LayerImport] wms layer cannot be added to map : unknown projection\", layerObj);\n            } else {\n                // si on a une projection compatible : on la stocke et la couche sera éventuellement reprojetée à l'ajout\n                layerObj._projection = projection;\n                // on ajoute chaque couche de la réponse dans la liste des couches accessibles\n                layerDescription = {\n                    content : layerObj.Title,\n                    title : layerObj.Abstract || layerObj.Title\n                };\n                // FIXME beurk !?\n                var _isGoodContainer = layerObj._container;\n                if (_isGoodContainer.localName === \"ul\") {\n                    _isGoodContainer = _isGoodContainer.lastChild;\n                }\n                this._addImportGetCapResultLayer(layerDescription, lastIndex, _isGoodContainer);\n\n                // puis on stoke la couche dans la liste pour faire le lien avec le DOM\n                this._getCapResponseWMSLayers[lastIndex] = layerObj;\n            }\n        }\n    }\n\n    /**\n     * this method is called on 'GPimportGetCapProposal' div click\n     * and add corresponding layer to map\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    _onGetCapResponseLayerClick (e) {\n        if (e.target && e.target.id) {\n            var proposalId = parseInt(e.target.id.substr(23), 10);\n\n            if (isNaN(proposalId)) {\n                return;\n            }\n\n            var layerInfo;\n\n            if (this._currentImportType === \"WMS\") {\n                // récupération des informations liées à la couche\n                layerInfo = this._getCapResponseWMSLayers[proposalId];\n                // ajout de la couche à la carte\n                this._addGetCapWMSLayer(layerInfo);\n            } else if (this._currentImportType === \"WMTS\") {\n                // récupération des informations liées à la couche\n                layerInfo = this._getCapResponseWMTSLayers[proposalId];\n                // ajout de la couche à la carte\n                this._addGetCapWMTSLayer(layerInfo);\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ######### create WMS layer from getCapabilities response ######### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this._onGetCapResponseLayerClick\n     * and add WMS layer to map using parameters from getCapabilities response\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @private\n     */\n    _addGetCapWMSLayer (layerInfo) {\n        var map = this.getMap();\n        if (!map) {\n            logger.warn(\"[ol.control.LayerImport] _addGetCapWMSLayer error : map is not defined\");\n            return;\n        }\n        if (!layerInfo) {\n            logger.warn(\"[ol.control.LayerImport] _addGetCapWMSLayer error : layerInfo is not defined\");\n            return;\n        }\n\n        // récupération de la projection de la carte\n        var mapProjCode = this._getMapProjectionCode();\n\n        var wmsSourceOptions = {};\n\n        // Récupération de l'url\n        var getMapUrl = this._getWMSLayerGetMapUrl();\n        // on essaie de récupérer l'url du service dans le getCapbilities\n        if (getMapUrl) {\n            wmsSourceOptions.url = getMapUrl;\n        } else {\n            // sinon, on récupère l'url du getCapabilities, à laquelle on enlève éventuellement les paramètres\n            var questionMarkIndex = this._getCapRequestUrl.indexOf(\"?\");\n            if (questionMarkIndex !== -1) {\n                wmsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);\n            } else {\n                wmsSourceOptions.url = this._getCapRequestUrl;\n            }\n        }\n\n        wmsSourceOptions.params = {};\n        if (layerInfo.Name) {\n            wmsSourceOptions.params[\"LAYERS\"] = layerInfo.Name;\n        } else {\n            logger.warn(\"[ol.control.LayerImport] unable to add wms layer : mandatory layer 'name' parameter cannot be found\", layerInfo);\n            return;\n        }\n        wmsSourceOptions.params[\"SERVICE\"] = \"WMS\";\n        if (this._getCapResponseWMS.version) {\n            wmsSourceOptions.params[\"VERSION\"] = this._getCapResponseWMS.version;\n        }\n\n        // on a déjà vérifié que la couche peut être reprojetée,\n        // on vérifie que la couche ait une projection compatible avec celle de la carte\n        // ou soit connue par proj4js\n        var projection = layerInfo._projection;\n        if (!projection) {\n            logger.warn(\"[ol.control.LayerImport] wms layer cannot be added to map : unknown projection\");\n            return;\n        } else if (projection !== mapProjCode) {\n            // si la projection de la carte n'est pas disponible pour cette couche,\n            // on spécifie une projection (qui doit avoir été définie dans proj4js) pour reprojection par Openlayers\n            wmsSourceOptions.projection = projection;\n        }\n\n        // récupération du premier style disponible (pas d'info default?)\n        var legend;\n        if (layerInfo.Style && Array.isArray(layerInfo.Style)) {\n            var style = layerInfo.Style[0];\n            wmsSourceOptions.params[\"STYLES\"] = style.Name;\n            if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {\n                legend = style.LegendURL[0].OnlineResource;\n            }\n        }\n\n        // Création de la source (tester un try catch ?)\n        var wmsSource = new TileWMSSource(wmsSourceOptions);\n        // ajout des informations pour le layerSwitcher (titre, description, legendes, metadata) ou originators\n        this._getWMSLayerInfoForLayerSwitcher(layerInfo, legend, wmsSource);\n\n        var layerTileOptions = {};\n        layerTileOptions[\"source\"] = wmsSource;\n        // récupération des résolutions min et max de la layer à partir des dénominateurs d'échelle\n        this._getWMSLayerMinMaxResolution(layerInfo, mapProjCode, layerTileOptions);\n        // récupération de l'étendue (bbox)\n        this._getWMSLayerExtent(layerInfo, mapProjCode, layerTileOptions);\n\n        // création de la couche à partir de la source\n        var wmsLayer = new TileLayer(layerTileOptions);\n        wmsLayer.setExtent(layerTileOptions.extent);\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant. (pour layerSwitcher par ex)\n        wmsLayer.gpResultLayerId = \"layerimport:WMS\";\n        // on rajoute le champ gpGFIparams permettant d'identifier si la couche est queryable, et de transmettre les formats reconnus par GetFeatureInfo\n        if (layerInfo.queryable) {\n            wmsLayer.gpGFIparams = {\n                queryable : true\n            };\n            // récupération des différents formats reconnus par le GetFeatureInfo\n            if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetFeatureInfo && this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format && Array.isArray(this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format)) {\n                wmsLayer.gpGFIparams.formats = this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format;\n            }\n        }\n\n        map.addLayer(wmsLayer);\n\n        // zoom sur l'étendue des entités récupérées (si possible)\n        if (map.getView() && map.getSize() && wmsLayer.getExtent) {\n            var sourceExtent = wmsLayer.getExtent();\n            if (sourceExtent && sourceExtent[0] !== Infinity) {\n                map.getView().fit(sourceExtent, map.getSize());\n            }\n        }\n\n        /**\n         * event triggered when a layer is added\n         *\n         * @event layerimport:service:added\n         * @property {Object} type - event\n         * @property {String} name - layerName\n         * @property {String} data - data\n         * @property {Object} layer - layer\n         * @property {String} format - format\n         * @property {Object} target - instance LayerImport\n         * @example\n         * LayerImport.on(\"layerimport:service:added\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerimport:service:added\",\n            name : layerInfo.Name,\n            data : layerInfo,\n            layer : wmsLayer,\n            format : \"wms\"\n        });\n    }\n\n    /**\n     * this method is called by this._addGetCapWMSLayer\n     * and gets service getMap request url\n     *\n     * @return {String} getmapurl - service getMap request url\n     * @private\n     */\n    _getWMSLayerGetMapUrl () {\n        var getmapurl;\n        if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetMap) {\n            var getmap = this._getCapResponseWMS.Capability.Request.GetMap;\n            if (getmap.DCPType && Array.isArray(getmap.DCPType) && getmap.DCPType.length !== 0) {\n                var url = getmap.DCPType[0];\n                if (url && url.HTTP && url.HTTP.Get) {\n                    getmapurl = url.HTTP.Get.OnlineResource;\n                }\n            }\n        }\n        return getmapurl;\n    }\n\n    /**\n     * this method is called by this._addGetCapWMSLayer\n     * and gets a projection both available for a given layer and already defined in proj4js (ol.proj)\n     * (openlayers raster reprojection will be then able to reproject layer in map projection)\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n     * @return {String} projection - ol.proj projection alias (e.g. \"EPSG:4326\")\n     * @private\n     */\n    _getWMSLayerProjection (layerInfo, mapProjCode) {\n        var projection;\n\n        if (!layerInfo || typeof layerInfo !== \"object\") {\n            logger.warn(\"missing layer information (from getCapabilities)\");\n            return;\n        }\n\n        // on va parcourir la liste des CRS disponibles pour la couche\n        // si on trouve la projection de la carte : c'est parfait\n        // si on trouve une projection qui est connue par ol.proj : Openlayers gère la reprojection\n        var CRSList = layerInfo.CRS;\n        if (Array.isArray(CRSList)) {\n            // on check si la projection de la carte est dans le tableau de projections issues du getCap,\n            // si oui, on la prend\n            if (CRSList.includes(mapProjCode)) {\n                projection = mapProjCode;\n                return projection;\n            }\n            var layerCRS, i;\n            // si aucune projection du getCap pour la couche n'est égale à celle de la carte\n            // on retourne la première projection listée dans le getCap qui est gérée par openLayers\n            for (i = 0; i < CRSList.length; i++) {\n                layerCRS = CRSList[i];\n                if (layerCRS && typeof layerCRS === \"string\") {\n                    if (olGetProj(layerCRS) || olGetProj(layerCRS.toUpperCase())) {\n                        projection = layerCRS;\n                        // on renvoie la première projection gérée par openLayers\n                        return projection;\n                    }\n                }\n            }\n        }\n        // si la liste des projections n'est pas un tableau ou si aucune projection n'est égale à celle de la carte ou si aucune n'est gérée par openLayers\n        // on return undefined (comportement d'origine de la fonction)\n        return projection;\n    }\n\n    /**\n     * this method is called by this._addGetCapWMSLayer\n     * and sets minResolution and maxResolution parameters for WMS layer (if available in getCapabilities response)\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n     * @param {Object} layerTileOptions - options for ol.layer.Tile (to be filled)\n     * @private\n     */\n    _getWMSLayerMinMaxResolution (layerInfo, mapProjCode, layerTileOptions) {\n        // récupération des résolutions min et max à partir des dénominateurs d'échelle\n        var mapUnits = olGetProj(mapProjCode).getUnits();\n        if (mapUnits === \"m\") {\n            // info : 1 pixel = 0.00028 m\n            if (layerInfo.MinScaleDenominator) {\n                layerTileOptions.minResolution = layerInfo.MinScaleDenominator * 0.00028;\n            }\n            if (layerInfo.MaxScaleDenominator) {\n                layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * 0.00028;\n            }\n        } else if (mapUnits === \"degrees\") {\n            // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n            var cste = 0.00028 * 180 / (Math.PI * 6378137);\n            if (layerInfo.MinScaleDenominator) {\n                layerTileOptions.minResolution = layerInfo.MinScaleDenominator * cste;\n            }\n            if (layerInfo.MaxScaleDenominator) {\n                layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * cste;\n            }\n        }\n    }\n\n    /**\n     * this method is called by this._addGetCapWMSLayer\n     * and sets extent for WMS layer in map projection (if available in getCapabilities response)\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n     * @param {Object} layerTileOptions - options for ol.layer.Tile (to be filled)\n     * @private\n     */\n    _getWMSLayerExtent (layerInfo, mapProjCode, layerTileOptions) {\n        if (!layerInfo) {\n            logger.warn(\"[ol.control.LayerImport] _getWMSLayerExtent error : layerInfo is not defined\");\n            return;\n        }\n\n        // récupération des 2 propriétés qui peuvent spécifier l'étendue (bbox) selon les specs OGC WMS 1.3.0 :\n        // 1. layerInfo.EX_GeographicBoundingBox est un tableau de type [westBoundLongitude, southBoundLatitude, eastBoundLongitude, northBoundLatitude] en WGS84\n        var exGeographicBoundingBox = layerInfo[\"EX_GeographicBoundingBox\"];\n        // 2. layerInfo.BoundingBox est un tableau dont chaque élément est un objet (balise bbox) avec les propriétés suivantes :\n        // crs (String) et extent (tableau de type [minx, miny, maxx, maxy])\n        var boundingBox = layerInfo.BoundingBox;\n\n        if (exGeographicBoundingBox && Array.isArray(exGeographicBoundingBox)) {\n            if (mapProjCode === \"EPSG:4326\") {\n                // si la projection de la carte est la même que celle de l'extent (EPSG:4326), on la passe telle quelle\n                layerTileOptions.extent = exGeographicBoundingBox;\n            } else {\n                layerTileOptions.extent = olTransformExtentProj(exGeographicBoundingBox, \"EPSG:4326\", mapProjCode);\n            }\n\n            // si jamais EX_GeographicBoundingBox n'est pas ou est mal renseigné, on essaie de récupérer via le paramètre BoundingBox\n        } else if (boundingBox && Array.isArray(boundingBox)) {\n            var crs;\n            var extent;\n            for (var i = 0; i < boundingBox.length; i++) { // on peut avoir plusieurs BoundingBox\n                crs = boundingBox[i].crs;\n                extent = boundingBox[i].extent;\n                if (crs) {\n                    if (crs === mapProjCode) {\n                        // si la bbox est dans la projection de la carte, on la passe telle quelle\n                        layerTileOptions.extent = extent;\n                        break;\n                    } else {\n                        if (typeof crs === \"string\") {\n                            var olProj = olGetProj(crs) ? olGetProj(crs) : olGetProj(crs.toUpperCase());\n                            // if ( olGetProj(crs) || olGetProj(crs.toUpperCase()) ) {\n                            if (olProj) {\n                                // si la bbox est dans une projection connue, on va la reprojeter\n                                // tout d'abord, on gère le cas des systèmes EPSG géographiques : inversion des axes x et y\n                                if (olProj.getUnits() === \"degrees\" && crs.toUpperCase().indexOf(\"EPSG\") === 0) {\n                                    // le tableau extent est inversé, on a besoin de : [miny, minx, maxx, maxy]\n                                    var reversedExtent = [extent[1], extent[0], extent[3], extent[2]];\n                                    layerTileOptions.extent = olTransformExtentProj(reversedExtent, olProj, mapProjCode);\n                                } else {\n                                    // reprojection dans la projection de la carte\n                                    layerTileOptions.extent = olTransformExtentProj(extent, olProj, mapProjCode);\n                                }\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * this method is called by this._addGetCapWMSLayer\n     * and sets more information about layer (legends, title, description, metadata, originators) for layerSwitcher or attributions controls\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @param {String} legend - legend url\n     * @param {Object} wmsSource - options for ol.source.TileWMS (to be filled)\n     * @private\n     */\n    _getWMSLayerInfoForLayerSwitcher (layerInfo, legend, wmsSource) {\n        // ajout des informations pour le layerSwitcher (titre, description)\n        if (layerInfo.Title) {\n            wmsSource._title = layerInfo.Title;\n            wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;\n        } else {\n            wmsSource._title = layerInfo.Name;\n            wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Name;\n        }\n        // ajout de légende si on en a trouvé\n        if (legend) {\n            wmsSource._legends = [{\n                url : legend\n            }];\n        }\n        // ajout d'éventuelles métadonnées\n        if (layerInfo.MetadataURL && Array.isArray(layerInfo.MetadataURL)) {\n            wmsSource._metadata = [];\n            for (var i = 0; i < layerInfo.MetadataURL.length; i++) {\n                var metadata = layerInfo.MetadataURL[i].OnlineResource;\n                if (metadata) {\n                    wmsSource._metadata.push({\n                        url : metadata\n                    });\n                }\n            }\n        }\n        // ajout d'éventuelles attributions / originators\n        if (layerInfo.Attribution) {\n            var attribution = layerInfo.Attribution;\n            wmsSource._originators = {};\n            if (attribution.OnlineResource) {\n                wmsSource._originators.url = attribution.OnlineResource;\n            }\n            if (attribution.Title) {\n                wmsSource._originators.name = wmsSource._originators.attribution = attribution.Title;\n            }\n            if (attribution.LogoURL && attribution.LogoURL.OnlineResource) {\n                wmsSource._originators.logo = attribution.LogoURL.OnlineResource;\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ######### create WMTS layer from getCapabilities response ######### //\n    // ################################################################### //\n\n    /**\n     * this method is called by this._onGetCapResponseLayerClick\n     * and add WMTS layer to map using parameters from getCapabilities response\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @private\n     */\n    _addGetCapWMTSLayer (layerInfo) {\n        if (!layerInfo || !layerInfo.Identifier) {\n            logger.warn(\"[ol.control.LayerImport] layer information not found in getCapabilities response for layer \");\n            return;\n        }\n\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        var wmtsSourceOptions = {};\n        wmtsSourceOptions.layer = layerInfo.Identifier;\n        // service version\n        if (this._getCapResponseWMTS.version) {\n            wmtsSourceOptions.version = this._getCapResponseWMTS.version;\n        }\n        // Récupération de l'url\n        var getMapUrl = this._getWMTSLayerGetTileUrl();\n        // on essaie de récupérer l'url du service dans le getCapbilities\n        if (getMapUrl) {\n            wmtsSourceOptions.url = getMapUrl;\n        } else {\n            // sinon, on récupère l'url du getCapabilities, à laquelle on enlève éventuellement les paramètres\n            var questionMarkIndex = this._getCapRequestUrl.indexOf(\"?\");\n            if (questionMarkIndex !== -1) {\n                wmtsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);\n            } else {\n                wmtsSourceOptions.url = this._getCapRequestUrl;\n            }\n        }\n\n        // Récupération des informations de la pyramide (tileGrid information) : matrixIds, resolutions, origin et projection\n        var tmsOptions = this._getTMSParams(layerInfo);\n        wmtsSourceOptions.matrixSet = tmsOptions.tms;\n        wmtsSourceOptions.projection = tmsOptions.projCode;\n        wmtsSourceOptions.tileGrid = new WMTSTileGrid({\n            resolutions : tmsOptions.resolutions,\n            matrixIds : tmsOptions.matrixIds,\n            origin : tmsOptions.origin\n        });\n\n        // Récupération du style par défaut\n        var defaultStyle;\n        var legend;\n        if (layerInfo.Style && Array.isArray(layerInfo.Style)) {\n            var style;\n            for (var s = 0; s < layerInfo.Style.length; s++) {\n                style = layerInfo.Style[s];\n                // on récupère le style\n                defaultStyle = style.Identifier;\n                if (style.isDefault) {\n                    // si c'est celui par défaut, on le garde (on ne boucle plus sur les autres styles)\n                    break;\n                }\n                // et une éventuelle légende\n                if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {\n                    legend = style.LegendURL[0].href;\n                }\n            }\n        }\n        if (defaultStyle == null) {\n            logger.warn(\"[ol.control.LayerImport] style information not found in getCapabilities response for layer \" + layerInfo.Identifier);\n        }\n        wmtsSourceOptions.style = defaultStyle;\n\n        // Récupération du format (le premier trouvé)\n        var format;\n        if (layerInfo.Format && Array.isArray(layerInfo.Format)) {\n            format = layerInfo.Format[0];\n        }\n        if (format == null) {\n            logger.warn(\"[ol.control.LayerImport] format information not found in getCapabilities response for layer \" + layerInfo.Identifier);\n        }\n        wmtsSourceOptions.format = format;\n\n        // Création de la source (tester un try catch ?)\n        var wmtsSource = new WMTSSource(wmtsSourceOptions);\n\n        // ajout des informations pour le layerSwitcher (titre, description)\n        if (layerInfo.Title) {\n            wmtsSource._title = layerInfo.Title;\n            wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;\n        } else {\n            wmtsSource._title = layerInfo.Identifier;\n            wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Identifier;\n        }\n        // ajout d'une éventuelle légende\n        if (legend) {\n            wmtsSource._legends = [{\n                url : legend\n            }];\n        }\n\n        var layerTileOptions = {};\n        layerTileOptions.source = wmtsSource;\n        // récupération de l'étendue (bbox)\n        layerTileOptions.extent = this._getWMTSLayerExtent(layerInfo);\n        var wmtsLayer;\n        try {\n            wmtsLayer = new TileLayer(layerTileOptions);\n            wmtsLayer.setExtent(layerTileOptions.extent);\n        } catch (e) {\n            logger.warn(\"[ol.control.LayerImport] an error occured while trying to create ol.layer.Tile from getCapabilities information. error : \", e);\n            return;\n        }\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche crée par le composant. (pour layerSwitcher par ex)\n        wmtsLayer.gpResultLayerId = \"layerimport:WMTS\";\n\n        map.addLayer(wmtsLayer);\n\n        // zoom sur l'étendue des entités récupérées (si possible)\n        if (map.getView() && map.getSize() && wmtsLayer.getExtent) {\n            var sourceExtent = wmtsLayer.getExtent();\n            if (sourceExtent && sourceExtent[0] !== Infinity) {\n                map.getView().fit(sourceExtent, map.getSize());\n            }\n        }\n\n        /**\n         * event triggered when a layer is added\n         *\n         * @event layerimport:service:added\n         * @property {Object} type - event\n         * @property {String} name - layerName\n         * @property {String} data - data\n         * @property {Object} layer - layer\n         * @property {String} format - format\n         * @property {Object} target - instance LayerImport\n         * @example\n         * LayerImport.on(\"layerimport:service:added\", function (e) {\n         *   console.log(e.layer);\n         * })\n         */\n        this.dispatchEvent({\n            type : \"layerimport:service:added\",\n            name : layerInfo.Identifier,\n            data : layerInfo,\n            layer : wmtsLayer,\n            format : \"wmts\"\n        });\n    }\n\n    /**\n     * this method is called by this._addGetCapWMTSLayer\n     * and gets service getTile request url\n     *\n     * @return {String} gettileurl - service getTile request url\n     * @private\n     */\n    _getWMTSLayerGetTileUrl () {\n        var gettileurl;\n        if (this._getCapResponseWMTS && this._getCapResponseWMTS.OperationsMetadata && this._getCapResponseWMTS.OperationsMetadata.GetTile) {\n            var gettile = this._getCapResponseWMTS.OperationsMetadata.GetTile;\n            if (gettile.DCP && gettile.DCP.HTTP && gettile.DCP.HTTP.Get && Array.isArray(gettile.DCP.HTTP.Get) && gettile.DCP.HTTP.Get.length !== 0) {\n                gettileurl = gettile.DCP.HTTP.Get[0].href;\n            }\n        }\n        return gettileurl;\n    }\n\n    /**\n     * this method is called by this._displayGetCapResponseLayers\n     * and gets layer TileMatrixSet projection if defined in proj4js\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @param {Object} getCapResponseWMTS - whole getCapabilities response\n     * @return {String} projection - ol.proj projection alias (e.g. \"EPSG:4326\")\n     * @private\n     */\n    _getWMTSLayerProjection (layerInfo, getCapResponseWMTS) {\n        var projection;\n\n        if (!layerInfo || typeof layerInfo !== \"object\") {\n            logger.warn(\"missing layer information (from getCapabilities)\");\n            return;\n        }\n\n        if (!getCapResponseWMTS || typeof getCapResponseWMTS !== \"object\") {\n            logger.warn(\"missing getCapabilities response\");\n            return;\n        }\n\n        if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {\n            var tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;\n            var crs;\n            if (getCapResponseWMTS.Contents && Array.isArray(getCapResponseWMTS.Contents.TileMatrixSet)) {\n                var tileMatrixSets = getCapResponseWMTS.Contents.TileMatrixSet;\n                for (var i = 0; i < tileMatrixSets.length; i++) {\n                    if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {\n                        // on a trouvé le TMS correspondant\n                        var tileMatrixSet = tileMatrixSets[i];\n                        crs = tileMatrixSet.SupportedCRS;\n                        if (crs && typeof crs === \"string\") {\n                            if (olGetProj(crs) || olGetProj(crs.toUpperCase())) {\n                                projection = crs;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        };\n\n        return projection;\n    }\n\n    /**\n     * this method is called by this._addGetCapWMTSLayer\n     * and get ol.tileGrid.WMTS parameters using getCapabilities response\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @return {Object} tmsOptions - ol.tileGrid.WMTS options\n     * @private\n     */\n    _getTMSParams (layerInfo) {\n        var tmsOptions = {};\n\n        var matrixIds = [];\n        var resolutions = [];\n        var origin = [];\n        var tms;\n        var projCode;\n        var projection;\n\n        // TODO : recup TOUS les autres params d'un tileGrid ! (tileSize, width...)\n\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        // Récupération des informations de la pyramide (tileGrid information) : matrixIds, resolutions, origin\n        if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {\n            tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;\n\n            if (this._getCapResponseWMTS.Contents && Array.isArray(this._getCapResponseWMTS.Contents.TileMatrixSet)) {\n                var tileMatrixSets = this._getCapResponseWMTS.Contents.TileMatrixSet;\n                for (var i = 0; i < tileMatrixSets.length; i++) {\n                    if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {\n                        // on a trouvé le TMS correspondant\n                        var tileMatrixSet = tileMatrixSets[i];\n\n                        var tilematrix;\n                        var id;\n                        var scaledenominator;\n                        var resolution;\n                        var units;\n\n                        if (tileMatrixSet.SupportedCRS) {\n                            projCode = tileMatrixSet.SupportedCRS;\n                            projection = olGetProj(projCode);\n                        }\n                        if (projection && projection.getUnits) {\n                            units = projection.getUnits();\n                        }\n\n                        if (Array.isArray(tileMatrixSet.TileMatrix)) {\n                            for (var j = 0; j < tileMatrixSet.TileMatrix.length; j++) {\n                                // construction du tableau des matrixIds\n                                tilematrix = tileMatrixSet.TileMatrix[j];\n                                if (tilematrix.Identifier != null) {\n                                    id = parseInt(tilematrix.Identifier, 10);\n                                    matrixIds.push(id);\n                                }\n\n                                // construction du tableau des résolutions, calculées à partir des dénominateurs d'échelle (scaledenominator)\n                                scaledenominator = tilematrix.ScaleDenominator;\n                                // calcul des résolutions selon la projection du TMS : selon si on a des coordonnées planes ou géographiques\n                                if (units === \"degrees\") {\n                                    // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n                                    resolution = scaledenominator * 0.00028 * 180 / (Math.PI * 6378137);\n                                } else {\n                                    // info : 1 pixel = 0.00028 m\n                                    resolution = scaledenominator * 0.00028;\n                                }\n                                resolutions.push(resolution);\n\n                                origin = tilematrix.TopLeftCorner;\n                            }\n                        }\n\n                        // tri des résolutions par ordre décroissant\n                        if (resolutions.sort !== undefined) {\n                            resolutions.sort(\n                                function (x, y) {\n                                    return y - x;\n                                }\n                            );\n                        }\n                        // tri des identifiants des niveaux de pyramide (matrixIds) par ordre croissant\n                        if (matrixIds.sort !== undefined) {\n                            matrixIds.sort(\n                                function (x, y) {\n                                    return x - y;\n                                }\n                            );\n                        }\n                    }\n                }\n            } else {\n                logger.warn(\"[ol.control.LayerImport] TileMatrixSet data not found in getCapabilities response for layer \" + layerInfo.Identifier);\n            }\n        } else {\n            return;\n        }\n\n        tmsOptions.tms = tms;\n        tmsOptions.projCode = projCode;\n        tmsOptions.matrixIds = matrixIds;\n        tmsOptions.resolutions = resolutions;\n        tmsOptions.origin = origin;\n\n        return tmsOptions;\n    }\n\n    /**\n     * this method is called by this._addGetCapWMTSLayer\n     * and sets extent for WMTS layer in map projection (if available in getCapabilities response)\n     *\n     * @param {Object} layerInfo - layer information from getCapabilities response\n     * @return {Array} extent - layer extent\n     * @private\n     */\n    _getWMTSLayerExtent (layerInfo) {\n        var extent;\n        var mapProjCode = this._getMapProjectionCode();\n\n        // récupération de l'étendue (bbox)\n        if (layerInfo.WGS84BoundingBox && Array.isArray(layerInfo.WGS84BoundingBox)) {\n            extent = olTransformExtentProj(layerInfo.WGS84BoundingBox, \"EPSG:4326\", mapProjCode);\n        }\n\n        return extent;\n    }\n\n    // ################################################################### //\n    // ################################ utils ############################ //\n    // ################################################################### //\n\n    /**\n     * gets control map projection code\n     *\n     * @return {String} mapProjCode - control map projection code (e.g. \"EPSG:3857\")\n     * @private\n     */\n    _getMapProjectionCode () {\n        var map = this.getMap();\n        if (!map || !map.getView || !map.getView().getProjection) {\n            logger.warn(\"unable to get layerimport's map\");\n            return;\n        }\n        var mapProjCode = map.getView().getProjection().getCode();\n        return mapProjCode;\n    }\n\n    // ################################################################### //\n    // ################################ clean ############################ //\n    // ################################################################### //\n\n    /**\n     * this method displays waiting container and sets a timeout\n     *\n     * @private\n     */\n    _displayWaitingContainer () {\n        this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerVisible gpf-waiting gpf-waiting--visible\";\n        this._waiting = true;\n\n        // mise en place d'un timeout pour réinitialiser le panel (cacher la patience)\n        // si on est toujours en attente (si la requête est bloquée par exemple)\n        if (this._timer) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n        var context = this;\n        this._timer = setTimeout(function () {\n            if (context._waiting === true) {\n                context._hideWaitingContainer();\n            } else {\n                if (context._timer) {\n                    clearTimeout(context._timer);\n                }\n            }\n        }, 16000);\n    }\n\n    /**\n     * this method hides waiting container and clears timeout\n     *\n     * @private\n     */\n    _hideWaitingContainer () {\n        if (this._waiting) {\n            this._waitingContainer.className = \"GPwaitingContainer GPwaitingContainerHidden gpf-waiting gpf-waiting--hidden\";\n            this._waiting = false;\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n    }\n\n    _displayFormContainer () {\n        this._formContainer.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n        this._formContainer.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n        this._importPanelTitle.innerHTML = \"Import de données\";\n        // this._importPanelHeader.classList.replace(\"GPelementHidden\", \"GPelementVisible\");\n        // this._importPanelHeader.classList.replace(\"gpf-hidden\", \"gpf-visible\");\n    }\n    _hideFormContainer () {\n        this._formContainer.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n        this._formContainer.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n        // this._importPanelHeader.classList.replace(\"GPelementVisible\", \"GPelementHidden\");\n        // this._importPanelHeader.classList.replace(\"gpf-visible\", \"gpf-hidden\");\n    }\n    /**\n     * this method empties getCap results list (DOM element)\n     *\n     * @private\n     */\n    cleanGetCapResultsList () {\n        this._hasGetCapResults = false;\n        this._getCapRequestUrl = null;\n        this._getCapResponseWMS = null;\n        this._getCapResponseWMTS = null;\n        this._getCapResponseWMSLayers = null;\n        this._getCapResponseWMTSLayers = null;\n        if (this._getCapResultsListContainer) {\n            while (this._getCapResultsListContainer.firstChild) {\n                this._getCapResultsListContainer.removeChild(this._getCapResultsListContainer.firstChild);\n            }\n        }\n    }\n\n    /**\n     * this method empties MapBox results list (DOM element)\n     *\n     * @private\n     */\n    cleanMapBoxResultsList () {\n        this._hasMapBoxResults = false;\n        if (this._mapBoxResultsListContainer) {\n            while (this._mapBoxResultsListContainer.firstChild) {\n                this._mapBoxResultsListContainer.removeChild(this._mapBoxResultsListContainer.firstChild);\n            }\n        }\n    }\n\n    /**\n     * this method empties MapBox results list (DOM element)\n     *\n     * @param {*} id - DOM id\n     * @private\n     */\n    cleanMapBoxResults (id) {\n        this._hasMapBoxResults = false;\n        if (this._mapBoxResultsListContainer) {\n            var nodes = this._mapBoxResultsListContainer.childNodes;\n            for (let index = 0; index < nodes.length; index++) {\n                const element = nodes[index];\n                if (element.id === \"GPEditorMapBoxContainer_ID_\" + id) {\n                    element.remove();\n                }\n            }\n        }\n    }\n\n};\n\n// on récupère les méthodes de la classe commune LayerImport\nObject.assign(LayerImport.prototype, LayerImportDOM);\nObject.assign(LayerImport.prototype, Widget);\n\nexport default LayerImport;\n\n// Expose LayerImport as ol.control.LayerImport (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.LayerImport = LayerImport;\n}\n"],"names":["module","exports","ol","style","Icon","call","settings","logger","getLogger","trace","url","Error","method","format","options","data","timeOut","scope","this","proxy","content","headers","referer","__call","then","response","onResponse","catch","error","onFailure","__callJSON","__callXML","Promise","resolve","reject","corps","Object","keys","length","normalyzeUrl","hXHR","window","nodefetch","opts","Referer","body","ok","text","message","statusText","status","e","XMLHttpRequest","open","overrideMimeType","onTimeOutTrigger","setTimeout","setRequestHeader","onerror","console","log","ontimeout","onreadystatechange","readyState","clearTimeout","target","responseURL","data4xhr","send","XDomainRequest","timeout","onload","responseText","data4xdr","JSON","parse","xmlDoc","DOMParser","parseFromString","ActiveXObject","async","loadXML","ProcessIsoCurveParam","TypeError","id","resource","point","position","crs","srs","profile","graph","constraints","reverse","timeUnit","distanceUnit","costType","costValue","distance","time","CLASSNAME","prototype","constructor","getLocation","x","y","getDistanceUnit","getConstraints","constraintArray","k","push","stringify","join","getDirection","getParams","map","v","_Control","ControlExtended","_this","_classCallCheck","_callSuper","element","render","listable","description","_inherits","_createClass","key","value","pos","getMap","PositionFactory","set","update","Control","ANCHORS","_PositionFactory_brand","WeakSet","caller","_classPrivateMethodInitSpec","container","_assertClassBrand","_createContainer","includes","toLowerCase","_setAnchor","children","prepend","appendChild","_existContainer","name","getOverlayContainerStopEvent","div","document","createElement","className","self","sizeW","offsetWidth","sizeH","height","offsetHeight","index","clear","top","bottom","left","right","panels","Array","from","getElementsByClassName","offset","forEach","panel","nodeName","checkDsfr","CommonService","getMessage","opt","protocol","ssl","proxyURL","callbackSuffix","httpMethod","rawResponse","onSuccess","hasOwnProperty","toUpperCase","nocache","outputFormat","request","context","onBuildRequest","result","callService","onError","onCallService","analyzeResponse","onAnalyzeResponse","buildRequest","success","strUrlProxified","strData","bUrlProxified","requestMetaOptions","apiKey","serverUrl","wrap","contentType","http","type","TYPE_SRVERR","xml","onBeforeParse","newResponse","onTimeOut","layer","Vector","PARAM_MISSING","PARAM_EMPTY","PARAM_TYPE","PARAM_FORMAT","PARAM_NOT_SUPPORT","PARAM_NOT_SUPPORT_NODEJS","PARAM_UNKNOWN","SERVICE_REQUEST_BUILD","SERVICE_REQUEST_EMPTY","SERVICE_RESPONSE_EXCEPTION","SERVICE_RESPONSE_EXCEPTION_2","SERVICE_RESPONSE_ANALYSE","SERVICE_RESPONSE_ANALYSE_2","SERVICE_RESPONSE_EMPTY","SERVICE_RESPONSE_EMPTY_2","SERVICE_RESPONSE_FORMAT","SERVICE_RESPONSE_FORMAT_2","SERVICE_RESPONSE_FORMAT_3","CLASS_CONSTRUCTOR","clef","parametres","arguments","params","slice","shift","args","isArray","replace","GeocodeResponse","locations","Observable","ProcessIsoCurveResponse","location","geometry","onloaded","onclickvisibility","onclickclone","onclickremove","legend","onclickedition","onchangevalue","group","oncollapse","oneditjson","scale","onchangemin","onchangemax","filter","themes","onclickimage","onclicktitle","search","onsubmit","onautocomplete","Logger","Style","tools","title","obj","_initialize","_initContainer","_toolsDefault","edition","Utils","mergeParams","paint","layout","containerjson","jsonlabel","jsondisplay","containertoolsscale","scaletitle","containertoolsminscale","scalelabelmin","scaleinputmin","containertoolsmaxscale","scalelabelmax","scaleinputmax","containertoolsedit","_found","_obj","_style","info","visibility","json","strJson","_syntaxHighlight","divJson","label","innerHTML","pre","addEventListener","onEditJsonStyleMapBox","attachEvent","_createElementToolsScale","min","minzoom","max","maxzoom","_createElementToolsEdition","divToolsScale","divMin","labelMin","inputMin","disabled","onChangeStyleScaleMinMapBox","divMax","labelMax","inputMax","onChangeStyleScaleMaxMapBox","warn","divToolsEdit","match","cls","test","getElementById","documentElement","getElementsByTagName","display","editorID","EventBus","EventEditor","editor","Themes","thumbnails","button","visible","themesSummary","containertheme","containerthemeID","input","inputID","labelID","image","imageID","ID","generate","_lstThemes","i","_theme","divTheme","tabIndex","_url","_selected","selected","_type","_button","checked","onClickThemeTitleMapBox","thumbnail","_img","src","alt","onClickThemeImageMapBox","nodes","parentElement","childNodes","node","tagName","_label","htmlFor","_msg","targetIDX","previousSibling","substring","lastIndexOf","_inputs","el","Filter","_filter","labelJson","preJson","onEditJsonFilterMapBox","divEdit","Legend","sprites","editable","_editable","legendRender","values","width","stroke","color","opacity","rendercontainer","toolscontainer","containerlegendrender","legendrender","legendeditable","legendtitle","containerlegendtools","labels","assign","bFound","split","_getProperties","edit","_createElementIconLegend","_createElementEditionLegend","isTextValue","isIconValue","valuesSupported","val","PROPERTIES","prop","_getValue","svg","indexOf","Color","hexToRgba","size","w","h","lstrockedasharray","cstrockcolor","pattern","fstrokecolor","isNumber","_typeof","stops","sort","a","b","numA","numB","onEditionLegendMapBox","_renderThumbnail","span","linecolor","lLineColor","inputLineColor","setAttribute","onChangeValueLegendMapBox","linewidth","lLineWidth","inputLineWidth","step","defaultValue","lineopacity","lLineOpacity","inputLineOpacity","fillcolor","lFillColor","inputFillColor","fillopacity","lFillOpacity","inputFillOpacity","line","fill","background","circle","icon","Layer","anchor","pin","remove","clone","_objDefault","source","bSlotLegend","oFilter","oStyle","oLegend","DomVisibility","DomToggle","containerlegend","containertitle","imagelabelinput","imagelabel","typeimg","titleinput","titlelabel","containertools","visibilityinput","visibilitylabel","visibilityinputdisable","visibilitylabeldisable","divTitle","inputImage","labelImage","onClickLayerMapBox","_addTools","divTools","inputTools","onVisibilityLayerMapBox","labelTools","apply","imgType","divLegend","inputTitle","labelTitle","nodesLvl1","nodesLvl2","curnode","getRenderContainer","click","active","isEditable","Group","collapse","details","summary","Search","_search","layers","_addUID","_uid","Editor","events","_initEvents","groupAuto","sortBy","sortOrder","undefined","containerID","containerLayers","titleLayers","titleLayersID","titleThemes","titleThemesID","sep","mapbox","ctx","event","handler","_toolsThemes","add","sources","multisources","hr","_layers","order","_metadata","cmpB","cmpA","localeCompare","groupBy","_groups","_groupName","_field","_newGroupName","_idx","trim","divLayers","ii","metadata","grp","oGroup","getContainer","oLayer","addLegend","slotLegend","addStyle","addFilter","_target","Event","spritesImage","startsWith","all","fetch","credentials","blob","theImage","Image","decode","_getSprites","sprite","getLayer","l","getLayers","o","EditorDOM","Geocode","options_","patchOptionConvertor","newUrl","query","filters","maximumResponses","create","filterOptions","bbox","lon","lat","returnFreeForm","geocodeMethod","returnTrueGeometry","maxResp","build","Alti","positions","sampling","api","zonly","measures","lstUrlByDefault","urlFound","wps","idx","extension","A","Circle","detectSupport","isDesktop","userAgent","navigator","dest","param","process","VERBOSE","env","logname","_createMainContainerElement","_createLocationPointElement","cssText","_createLocationPointLabelElement","buttonOrigin","points","j","tag","onLocationClearPointClick","_createLocationAutoCompleteteInputElement","inputOrigin","placeholder","autocomplete","charCode","which","keyCode","classList","onAutoCompleteSearchText","curr","list","current","parseInt","next","prev","focus","_createLocationCoordinateInputElement","inputOriginCoord","_createLocationPointerShowInputElement","inputOriginPointer","_createLocationPointerInputElement","buttonOriginPointer","preventDefault","stopPropagation","onActivateMapPointClick","_createLocationRemovePointElement","buttonRm","ariaPressed","last","start","end","startID","endID","onLocationRemovePointClick","_createLocationAddPointElement","buttonAdd","innerText","lastStage","nbStages","onLocationAddPointClick","_createLocationAutoCompleteElement","_createLocationAutoCompleteResultElement","onAutoCompletedResultsItemClick","_createLocationAutoCompletedLocationElement","n","GeocodeUtils","getSuggestedLocationFreeform","GPdisplayCoordinate","id1","id2","LocationSelector","initialize","_container","_possibleConstructorReturn","groupId","addOption","removeOption","displayInfo","autocompleteOptions","SelectorID","_map","_inputsContainer","_buttonLabel","_inputAutoComplete","_inputShowPointerContainer","_inputShowPointer","_inputCoordinateContainer","_addPointElement","_removePointElement","_coordinate","_suggestedContainer","_suggestedList","_suggestedLocations","_currentLocation","_initMarker","_resources","listenerKey","_marker","_markerUrl","_markerOffset","markerOpts","Markers","defaultOffset","coordinate","proj","getView","getProjection","getCode","_setCoordinate","olTransformProj","_setMarker","clearResults","_hideSuggestedLocation","_clearSuggestedLocation","olObservableUnByKey","_this2","inputs","onAutoCompleteInputClick","_inputCoordinate","_inputPointer","_inputAddStage","_inputRemoveStage","resultsPanel","results","_displaySuggestedLocation","_this3","serviceOptions","_customOnSuccess","_customOnFailure","_requestAutoComplete","suggestedLocations","_fillAutoCompletedLocationListContainer","on","fields","_setLabel","mapProj","_setPosition","_this4","onMouseMapClick","_setCursor","cursor","getTargetElement","olCoordinate","toFixed","setCenter","information","removeOverlay","markerDiv","Overlay","stopEvent","addOverlay","firstChild","removeChild","resources","Gp","Services","autoComplete","childElementCount","LocationSelectorDOM","control","detectUnicodeSupport","RegExpImpl","RegExp","exec","UNICODE_SUPPORT","chars","regexp","chars_without","reg","part","isStr","regg","concat","Char","_SChar","SChar_s","S","S_OPT","NameStartChar","NameChar","Name","Nmtoken","EntityRef","CharRef","Reference","PEReference","EntityValue","AttValue","NCName","QName","QName_exact","QName_group","SystemLiteral","PI","PubidChar","PubidLiteral","COMMENT_START","Comment","PCDATA","Mixed","contentspec","elementdecl","NotationType","Enumeration","EnumeratedType","AttType","DefaultDecl","AttlistDecl","ABOUT_LEGACY_COMPAT","ABOUT_LEGACY_COMPAT_SystemLiteral","SYSTEM","PUBLIC","ExternalID","ExternalID_match","NDataDecl","ENTITY_DECL_START","GEDecl","PEDef","EntityDecl","PublicID","NotationDecl","Eq","VersionNum","VersionInfo","EncName","XMLDecl","CData","CDSect","CDATA_START","CDATA_END","COMMENT_END","DOCTYPE_DECL_START","UNICODE_REPLACEMENT_CHARACTER","RouteParamREST","startPoint","endPoint","intermediates","viaPoints","optimization","routePreference","getSteps","waysAttributes","getIntermediates","array","getWaysAttributes","getProfile","getOptimization","geom","Polygon","MultiPolygon","Feature","setPropertyFill","getStyle","getFill","colorFill","getColor","cf","isRGB","oColorFill","rgbaToHex","hex","setPropertyStroke","getStroke","colorStroke","cs","oColorStroke","getWidth","setPropertyLabel","isName","get","getText","getFont","Styling","DEFAULT_TEXT","font","getTextAlign","textAlign","setPropertyMarker","getImage","IconStyle","c","colorIcon","scaleIcon","getScale","Math","round","srcImage","getSrc","unset","fillImg","colorFillImg","cfi","oColorFillImg","strokeImg","colorStrokeImg","csi","oColorStrokeImg","radius","getRadius","APPLY_CONVERT_GEOM_GPX","DEFAULT_ICON","DEFAULT_CIRCLE","DEFAULT_STROKE","DEFAULT_FILL","opactity","getListTags","defineStyleFromProperties","feature","marker","symbolMarker","colorMarker","isHex","labelStroke","labelFill","isLabel","circleRadius","circleStroke","circleFill","getGeometry","getType","isCircle","optionsCircle","StrokeStyle","FillStyle","CircleStyle","optionsText","TextStyle","styleText","cloneStyleText","setText","initType","f","ClassPoly","setGeometry","getCoordinates","defineStyleFunctionByDefault","defaultStyle","resolution","optsc","optsCircle","styleTextCircle","optsp","optsl","definePropertiesFromStyleByType","definePropertiesFromStyle","getStyleFunction","styles","setStyle","defineTagFromStyle","extent","getComputedStyle","getPropertyValue","extendError","writableName","enumerable","writable","DOMExceptionName","freeze","IndexSizeError","DomstringSizeError","HierarchyRequestError","WrongDocumentError","InvalidCharacterError","NoDataAllowedError","NoModificationAllowedError","NotFoundError","NotSupportedError","InUseAttributeError","InvalidStateError","SyntaxError","InvalidModificationError","NamespaceError","InvalidAccessError","ValidationError","TypeMismatchError","SecurityError","NetworkError","AbortError","URLMismatchError","QuotaExceededError","TimeoutError","InvalidNodeTypeError","DataCloneError","EncodingError","NotReadableError","UnknownError","ConstraintError","DataError","TransactionInactiveError","ReadOnlyError","VersionError","OperationError","NotAllowedError","OptOutError","DOMExceptionNames","isValidDomExceptionCode","DOMException","messageOrCode","nameOrMessage","captureStackTrace","defineProperties","code","ExceptionCode","INDEX_SIZE_ERR","DOMSTRING_SIZE_ERR","HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","INVALID_CHARACTER_ERR","NO_DATA_ALLOWED_ERR","NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INUSE_ATTRIBUTE_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","NAMESPACE_ERR","INVALID_ACCESS_ERR","VALIDATION_ERR","TYPE_MISMATCH_ERR","SECURITY_ERR","NETWORK_ERR","ABORT_ERR","URL_MISMATCH_ERR","QUOTA_EXCEEDED_ERR","TIMEOUT_ERR","INVALID_NODE_TYPE_ERR","DATA_CLONE_ERR","entries","ParseError","locator","servicesVersion","servicesDate","Protocols","XHR","DefaultUrl","AltiResponse","Elevation","AutoCompleteResponse","AutoComplete","SuggestedLocation","Config","IsoCurveResponse","RouteResponse","Route","RouteInstruction","Helper","totalTime","totalDistance","routeGeometry","routeInstructions","z","noop","undefinedType","isIE","logMethods","_loggersByName","defaultLogger","bindMethod","methodName","bind","Function","traceForIE","realMethod","replaceLoggingMethods","level","getLevel","methodFactory","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","factory","inheritedLevel","defaultLevel","userLevel","storageKey","persistLevelIfPossible","levelNum","levelName","localStorage","ignore","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","clearPersistedLevel","removeItem","normalizeLevel","setLevel","persist","setDefaultLevel","resetLevel","enableAll","TRACE","disableAll","rebuild","childName","initialLevel","_log","noConflict","getLoggers","globalObject","g","getGlobal","Headers","Request","Response","EventBusClass","listeners","callback","numOfArgs","splice","removeEventListener","numOfCallbacks","newArray","listener","hasEventListener","dispatch","concatArgs","getEvents","str","getConfig","getAltitude","geocode","reverseGeocode","route","isoCurve","getGeocodedLocationFreeform","geocodedLocation","attributes","placeAttributes","resultToReturn","toponym","category","postcode","city","housenumber","street","suggestedLocation","fullText","postalCode","commune","poi","kind","onPanelOpen","PanelManager","AltiProfilRequest","_sampling","getData","getLon","getLat","indent","normalyzeParameters","myParams","tabParams","encode","myUrl","firstOccuranceIndex","msg","uuid","floor","Date","now","callbackId","urlHasCallbackKey","urlHasCallbackName","callbackName","HasCallbackName","_deleteScript","_createScript","scriptu","scripto","replaceChild","script","parentNode","elevations","_extensions","_options","clean","interactions","getInteractions","getArray","getActive","DrawInteraction","SelectInteraction","ModifyInteraction","getProperties","setActive","action","AltiResponseReader","READERS","root","altiResponse","hasChildNodes","child","elevation","textNode","nodeType","parseFloat","nodeValue","elevationObject","acc","source_name","measure","source_measure","measureChildren","exceptionreport","exceptionReport","exception","exceptionCode","getAttribute","read","JSONResponse","legs","legSteps","steps","duration","geometryInInstructions","legList","portions","instruction","modifier","exit","nom_1_droite","toponyme","GeocodeParamREST","searchGeometry","getFilters","getIndex","getSearchGeometry","number","Number","toString","num","hexa","arrayToRgba","red","green","blue","alpha","arrayToHex","elems","rgba","parsed","m","r","rgb","charAt","GeocodeRequestREST","requestString","processRequestString","MathUtils","modulo","decimalToDMS","degrees","hemispheres","numDigits","normalizedDegrees","abs","dflPrecision","precision","pow","deg","sec","ceil","d","s","direction","dmsToDecimal","minutes","seconds","dd","coordinateToDecimal","lng","unit","coordinateToDMS","coordinateToRad","coordinateToGon","coordinateToMeter","coordinateToKMeter","toInteger","base","isNaN","isFinite","isInteger","toFloat","convertSecondsToTime","hours","divisor4minutes","convertDistance","distanceKm","ImageWMS","configuration","isConfigLoaded","global","ownKeys","object","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread2","_defineProperty","getOwnPropertyDescriptors","defineProperty","Symbol","iterator","configurable","_extends","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","propertyIsEnumerable","IE11OrLess","Edge","FireFox","Safari","IOS","ChromeForAndroid","captureMode","capture","passive","fn","off","matches","selector","msMatchesSelector","webkitMatchesSelector","_","getParentOrHost","host","closest","includeCTX","_throttleTimeout","R_SPACE","toggleClass","state","css","defaultView","currentStyle","matrix","selfOnly","appliedTransforms","transform","matrixFn","DOMMatrix","WebKitCSSMatrix","CSSMatrix","MSCSSMatrix","find","getWindowScrollingElement","scrollingElement","getRect","relativeToContainingBlock","relativeToNonStaticParent","undoScale","getBoundingClientRect","elRect","innerHeight","innerWidth","containerRect","elMatrix","scaleX","scaleY","isScrolledPast","elSide","parentSide","parent","getParentAutoScrollElement","elSideVal","parentSideVal","getChild","childNum","includeDragEl","currentChild","Sortable","ghost","dragged","draggable","lastChild","lastElementChild","previousElementSibling","getRelativeScrollOffset","offsetLeft","offsetTop","winScroller","scrollLeft","scrollTop","includeSelf","elem","gotSelf","clientWidth","scrollWidth","clientHeight","scrollHeight","elemCSS","overflowX","overflowY","isRectEqual","rect1","rect2","throttle","ms","scrollBy","Polymer","$","jQuery","Zepto","dom","cloneNode","getChildContainingRectFromElement","ghostEl","rect","_rect$left","_rect$top","_rect$right","_rect$bottom","animated","childRect","Infinity","expando","getTime","AnimationStateManager","animationCallbackId","animationStates","captureAnimationState","animation","fromRect","thisAnimationDuration","childMatrix","addAnimationState","removeAnimationState","arr","indexOfObject","animateAll","animating","animationTime","toRect","prevFromRect","prevToRect","animatingRect","targetMatrix","sqrt","calculateRealTime","animate","animationResetTimer","currentRect","translateX","translateY","animatingX","animatingY","forRepaintDummy","repaint","easing","plugins","defaults","initializeByDefault","PluginManager","mount","plugin","option","p","pluginName","pluginEvent","eventName","sortable","evt","eventCanceled","cancel","eventNameGlobal","initializePlugins","initialized","modified","modifyOption","getEventProperties","eventProperties","modifiedValue","optionListeners","dispatchEvent","_ref","rootEl","targetEl","cloneEl","toEl","fromEl","oldIndex","newIndex","oldDraggableIndex","newDraggableIndex","originalEvent","putSortable","extraEventProperties","onName","substr","CustomEvent","createEvent","initEvent","bubbles","cancelable","to","item","pullMode","lastPutMode","allEventProperties","_excluded","dragEl","parentEl","nextEl","lastDownEl","cloneHidden","dragStarted","moved","activeSortable","hideGhostForTarget","_hideGhostForTarget","unhideGhostForTarget","_unhideGhostForTarget","cloneNowHidden","cloneNowShown","dispatchSortableEvent","_dispatchEvent","activeGroup","tapEvt","touchEvt","lastDx","lastDy","tapDistanceLeft","tapDistanceTop","lastTarget","lastDirection","targetMoveDistance","ghostRelativeParent","awaitingDragStarted","ignoreNextClick","sortables","pastFirstInvertThresh","isCircumstantialInvert","ghostRelativeParentInitialScroll","_silent","savedInputChecked","documentExists","PositionGhostAbsolutely","CSSFloatProperty","supportDraggable","supportCssPointerEvents","pointerEvents","_detectDirection","elCSS","elWidth","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","child1","child2","firstChildCSS","secondChildCSS","firstChildWidth","marginLeft","marginRight","secondChildWidth","flexDirection","gridTemplateColumns","touchingSideChild2","_prepareGroup","toFn","pull","sameGroup","otherGroup","originalGroup","checkPull","checkPut","put","revertClone","stopImmediatePropagation","nearestEmptyInsertDetectEvent","touches","nearest","clientX","clientY","some","threshold","emptyInsertThreshold","insideHorizontally","insideVertically","ret","_onDragOver","_checkOutsideTargetEl","_isOutsideThisEl","store","handle","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","ghostClass","chosenClass","dragClass","preventOnFilter","setData","dataTransfer","textContent","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","devicePixelRatio","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","nativeDraggable","_onTapStart","_onMove","dragRect","targetRect","willInsertAfter","retVal","onMoveFn","onMove","draggedRect","related","relatedRect","_disableDraggable","_unsilent","_generateId","href","sum","charCodeAt","_nextTick","_cancelNextTick","contains","_getDirection","touch","pointerType","originalTarget","shadowRoot","path","composedPath","_saveInputCheckedState","isContentEditable","criteria","_prepareDragStart","dragStartFn","ownerDocument","nextSibling","_lastX","_lastY","_onDrop","_disableDelayedDragEvents","_triggerDragStart","_disableDelayedDrag","_delayedDragTouchMoveHandler","_dragStartTimer","_onTouchMove","_onDragStart","selection","empty","getSelection","removeAllRanges","err","_dragStarted","fallback","_appendGhost","_nulling","_emulateDragOver","elementFromPoint","ghostMatrix","relativeScrollOffset","dx","dy","cssMatrix","removeAttribute","_hideClone","cloneId","insertBefore","_loopId","setInterval","effectAllowed","_dragStartId","revert","vertical","isOwner","canSort","fromSortable","completedFired","dragOverEvent","_ignoreWhileAnimating","completed","elLastChild","lastElRect","childContainingRect","spacer","_ghostIsLast","changed","firstElRect","_ghostIsFirst","targetBeforeFirstSwap","sibling","differentLevel","differentRowCol","dragElS1Opp","dragElS2Opp","dragElOppLength","targetS1Opp","targetS2Opp","targetOppLength","_dragElInRowColumn","side1","scrolledPastTop","scrollBefore","isLastTarget","mouseOnAxis","targetLength","targetS1","targetS2","invert","_getInsertDirection","_getSwapDirection","dragIndex","nextElementSibling","after","moveVector","extra","axis","insertion","_showClone","_offMoveEvents","_offUpEvents","clearInterval","save","handleEvent","dropEffect","_globalDragOver","toArray","useAnimation","items","destroy","querySelectorAll","utils","is","extend","dst","nextTick","cancelNextTick","detectDirection","_len","_key","version","scrollEl","scrollRootEl","lastAutoScrollX","lastAutoScrollY","touchEvt$1","pointerElemChangedInterval","autoScrolls","scrolling","clearAutoScrolls","autoScroll","pid","clearPointerElemChangedInterval","isFallback","scroll","scrollCustomFn","sens","scrollSensitivity","speed","scrollSpeed","scrollThisInstance","scrollFn","layersOut","currentParent","canScrollX","canScrollY","scrollPosX","scrollPosY","vx","vy","scrollOffsetY","scrollOffsetX","bubbleScroll","drop","toSortable","changedTouches","onSpill","Revert","Remove","startIndex","dragStart","_ref2","_ref3","_ref4","parentSortable","AutoScroll","forceAutoScrollFallback","_handleAutoScroll","_handleFallbackAutoScroll","dragOverCompleted","dragOverBubble","nulling","ogElemScroller","newElem","_createDraggableElement","elementDraggable","handleClass","onEnd","_onEndDragAndDropLayerClick","_createMainLayersShowElement","_createMainLayersElement","dialog","_createMainLayersDivElement","_createMainPictoElement","onShowLayerSwitcherClick","_createMainCounterLayersElement","_createMainInfoElement","divP","_createMainInfoDivElement","_createLayersPanelHeaderElement","_createLayersPanelIconElement","_createLayersPanelTitleElement","_createLayersPanelCloseElement","btnClose","_createContainerLayerElement","_createBasicToolElement","_createAdvancedToolShowElement","_createAdvancedToolElement","_createBasicToolNameElement","_createBasicToolVisibilityElement","_createBasicToolDragNDropElement","_onStartDragAndDropLayerClick","_onVisibilityLayerClick","_createAdvancedToolDeleteElement","_createAdvancedToolEditionElement","_createAdvancedToolInformationElement","_createAdvancedToolOpacityElement","_createAdvancedToolExtentElement","_createAdvancedToolGreyscaleElement","btn","contextual","layerId","_onDropLayerClick","_onEditLayerClick","btnInfo","_onOpenLayerInfoClick","btnGreyscale","_onToggleLayerGreyscaleClick","divO","dataset","frJsRange","setProperty","ariaLabel","_onChangeLayerOpacity","divC","_onZoomToExtentClick","_createContainerLayerInfoElement","header","onCloseClick","quicklookUrl","quick","refquick","desc","mtd","mtdtitle","urlmtd","mtdlink","refmtd","legends","lgd","lgdtitle","maxScale","maxScaleDenominator","minScale","minScaleDenominator","urllgd","lgdlink","reflgd","LayerSwitcher","_addMapLayers","collapsed","_showLayerSwitcherButton","_listeners","onMoveListener","_onMapMoveEnd","onAddListener","gpLayerId","_layerId","addLayer","onRemoveListener","removeLayer","_layersOrder","setPosition","gutter","config","isLayerInMap","lyr","nameDiv","infodiv","advancedTools","layerInfos","getLayerInfo","getOpacity","getVisible","isInRange","layerOptions","service","inRange","_title","_description","_legends","_quicklookUrl","layerDiv","_createLayerDiv","getZIndex","_forceNullzIndex","_updateLayersOrder","unshift","_lastZIndex","setZIndex","_layerListContainer","updateLayerOpacity","_updateLayerOpacity","updateLayerVisibility","_updateLayerVisibility","onZIndexChangeEvent","_updateLayerCounter","layerID","layerIndex","layerOrderTemp","isCollapsed","removable","removalDiv","counter","allowEdit","_layersIndex","conf","changeCollapsed","picto","_layerSwitcherCounter","divL","panelHeader","panelIcon","panelTitle","panelClose","divI","divD","zindex","querySelector","isLegends","isMetadata","isQuicklookUrl","displayInformationElement","VectorLayer","VectorTileLayer","opened","updatePosition","divId","opacityValue","setOpacity","layerOpacityInput","layerOpacitySpan","setVisible","layerVisibility","_this5","maxResolution","getMaxResolution","_maxScaleDenominator","infoLayer","_this6","matchesLayers","maxZIndex","updateSize","convertImagetoGreyScale","dataUrl","img","crossOrigin","canvas","getContext","drawImage","imageData","getImageData","avg","putImageData","toDataURL","getGreyScaledDataUrl","getSource","TileWMSSource","WMTSSource","toGreyScale","loadstartListenerKey","loadendListenerKey","tile","refresh","domIDShort","domIDLong","gpResultLayerId","layerName","layerService","getLayerId","globalConstraints","getGlobalConstraints","view","crsTarget","crsSource","olTransformExtentProj","fit","getSize","sourceExtent","getExtent","getTileGrid","_this7","olLayer","foundId","mapResolution","getResolution","getMinResolution","mapExtent","calculateExtent","layerExtent","olIntersects","layerInfo","layerProperties","LayerSwitcherDOM","Widget","customConfigFile","sync","listConfigUrls","__callServiceSync","__callService","listConfigResults","Fetch","fetchFactory","promises","ConfigJSON","objects","allLayersConfig","allKeysConfig","allTMSConfig","generalOptions","apiKeys","tileMatrixSets","mergeConfig","IConfig","property","DataObject","identifier","rqstWPS","conventions","errors","isHTMLEscapableRawTextElement","isHTMLMimeType","isHTMLRawTextElement","hasOwn","NAMESPACE","XMLReader","defaultNSMap","entityMap","domBuilder","startDocument","_copy","defaultNSMapCopy","errorHandler","isHTML","mimeType","warning","fixedFromCharCode","surrogate1","surrogate2","String","fromCharCode","entityReplacer","complete","appendText","xt","ENTITY_REG","characters","lineStart","lineEnd","linePattern","lineNumber","columnNumber","parseStack","currentNSMap","unclosedTags","tagStart","fatalError","doc","createTextNode","currentElement","fromSource","tagNameRaw","tagNameMatch","currentTagName","tagNameLower","pop","localNSMap","endElement","uri","localName","prefix","endPrefixMapping","parseProcessingInstruction","parseDoctypeCommentOrCData","ElementAttributes","len","parseElementStartPart","closed","isHTMLVoidElement","locator2","copyLocator","appendElement","parseHtmlSpecialContent","endDocument","t","addAttribute","qname","attributeNames","addValue","attrName","setTagName","qName","nsp","nsPrefix","XMLNS","startPrefixMapping","XML","ns","startElement","elStartEnd","isEscapableRaw","elEndStart","parseUtils","char","skip","substringFromIndex","getMatch","skipBlanks","blanks","substringStartsWith","substringStartsWithCaseInsensitive","comment","cdata","startCDATA","endCDATA","doctype","publicId","systemId","internalSubset","groups","SystemLiteralOnly","parsePI","intSubsetStart","parseDoctypeInternalSubset","startDTD","endDTD","processingInstruction","getLocalName","getLocator","getQName","getURI","getValue","oc","HTML_BOOLEAN_ATTRIBUTES","allowfullscreen","autofocus","autoplay","controls","default","defer","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","playsinline","readonly","required","reversed","HTML_VOID_ELEMENTS","area","br","col","embed","link","meta","track","wbr","HTML_RAW_TEXT_ELEMENTS","textarea","MIME_TYPE","HTML","XML_APPLICATION","XML_TEXT","XML_XHTML_APPLICATION","XML_SVG_IMAGE","_MIME_TYPES","SVG","predicate","ac","hasDefaultHTMLNamespace","isHTMLBooleanAttribute","isValidMimeType","TileWMS","PDC","checkSymbol","symbol","notEmptyString","orderedSetReducer","toOrderedSet","splitOnASCIIWhitespace","reduce","validateQualifiedName","qualifiedName","validateAndExtract","namespace","splitResult","copy","Class","Super","pt","NodeType","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","DocumentPosition","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","commonAncestor","docGUID","guid","random","NodeList","LiveNodeList","_node","_refresh","_updateLiveList","inc","_inc","ls","__set__","$$length","NamedNodeMap","_findNodeIndex","_addNamedNode","newAttr","oldAttr","ownerElement","_onRemoveAttribute","namespaceURI","_nsMap","_onAddAttribute","_removeNamedNode","attr","lastIndex","DOMImplementation","Node","_xmlEncoder","_visitNode","Document","_onUpdateChild","newChild","_removeChild","oldPreviousSibling","oldNextSibling","isDocTypeNode","isElementNode","isTextNode","isElementInsertionPossible","parentChildNodes","docTypeNode","isElementReplacementPossible","assertPreInsertionValidity1to5","hasValidParentNodeType","hasInsertableNodeType","assertPreInsertionValidityInDocument","nodeChildNodes","nodeChildElements","parentElementChild","assertPreReplacementValidityInDocument","hasDoctypeChildThatIsNotChild","_insertBefore","_inDocumentAssertion","cp","newFirst","newLast","Element","Attr","CharacterData","Text","CDATASection","DocumentType","Notation","Entity","EntityReference","DocumentFragment","ProcessingInstruction","XMLSerializer","nodeSerializeToString","nodeFilter","buf","refNode","lookupPrefix","visibleNamespaces","serializeToString","needNamespaceDefine","addSerializedAttribute","attrs","prefixedNodeName","defaultNS","ai","nsi","canCloseTag","pubid","sysid","importNode","deep","node2","attrs2","_ownerElement","setAttributeNode","me","done","return","getNamedItem","_isInHTMLDocumentAndNamespace","setNamedItem","getNamedItemNS","setNamedItemNS","removeNamedItem","removeNamedItemNS","hasFeature","createDocument","implementation","createElementNS","createDocumentType","createHTMLDocument","htmlNode","headNode","titleNode","baseURI","isConnected","rootNode","getRootNode","other","isEqualNode","otherNode","getAttributeNodeNS","isSameNode","refChild","oldChild","normalize","appendData","isSupported","lookupNamespaceURI","isDefaultNamespace","compareDocumentPosition","node1","attr1","attr2","chain1","ancestor1","chain2","ancestor2","ca","removed","importedNode","rtv","createDocumentFragment","createComment","createCDATASection","createProcessingInstruction","createAttribute","_createAttribute","specified","createEntityReference","validated","createAttributeNS","getQualifiedName","hasAttributes","hasAttribute","getAttributeNode","removeAttributeNode","setAttributeNodeNS","removeAttributeNS","old","hasAttributeNS","getAttributeNS","setAttributeNS","classNames","classNamesSet","nodeClassNames","nodeClassNamesSet","every","isHTMLDocument","lowerQualifiedName","getElementsByTagNameNS","substringData","count","insertData","replaceData","deleteData","splitText","newText","newNode","getTextContent","WPS","paramservice","paramversion","paramidentifier","paramrawdataoutput","rawdataoutput","paramrequest","template","post","namespaceByDefault","schemaLocationByDefault","__addDataInputs","tmpl","that","__addDataInput","tmp","setMethod","getMethod","country","poiType","fulltext","zipcode","classification","TYPE_UNKERR","xmlString","reader","__getXMLDOC","setReader","parser","errorMsg","parseError","errorCode","linepos","reason","parsererror","__readDefault","dataAttributes","nodeAttributes","attribute","__getAttributes","childData","getXMLString","setXMLString","getReader","getXMLDoc","setXMLDoc","parserOutput","__getRootNode","sphere","MeasureToolBoxDOM","_toolboxId","_buttonId","_widgetId","getToolBoxID","uid","getButtonID","getWidgetID","_createToolBoxContainerElement","blur","widget","MeasureToolBox","_toolbox","ctrl","gpShareMeasureToolBox","mapContainer","mapDocument","mapId","toolboxContainer","widgetContainer","setTarget","Measures","DEFAULT_POINTER_STYLE","Stroke","Fill","DEFAULT_DRAW_START_STYLE","lineDash","DEFAULT_DRAW_FINISH_STYLE","MeasureLength","MeasureArea","MeasureAzimuth","measureDraw","measureSource","measureVector","eventLayerRemove","sketch","measureTooltipElement","measureTooltip","helpTooltipElement","helpTooltip","_class","clearMeasure","clearMeasureToolTip","removeMeasureEvents","_pictoContainer","onPointerMoveHandler","dragging","tooltipCoord","output","getLastCoordinate","getInteriorPoint","onShowMeasureClick","currentMapId","gpShareMeasures","mySelf","instance","Interactions","addMeasureEvents","initMeasureInteraction","addMeasureInteraction","overlays","nodesToRemove","removeInteraction","createMeasureTooltip","positioning","createHelpTooltip","createStylingMeasureInteraction","startStyleOpts","pointer","finish","finishStyleOpts","condition","ctrlKey","removeLastPoint","setProperties","addInteraction","setOffset","VectorSource","getControls","layerDescription","ElevationPathDOM","_createShowElevationPathPictoElement","onShowElevationPathClick","_createElevationPathPanelElement","_createElevationPathPanelDivElement","_createDrawingButtonsPluginDiv","_createElevationPathPanelHeaderElement","divInfo","onOpenElevationPathInfoClick","buttonReduce","onReduceElevationPathPanelClick","buttonClose","_createElevationPathPanelProfilElement","wrapper","_createElevationPathWaitingElement","_createElevationPathInformationsElement","_addElevationPathInformationsItem","nameEl","valueEl","ProfileElevationPathDOM","_getCssProperty","_getTextWidth","measureText","_dataZToSvgY","pathHeight","minGraphZ","pxPerMZ","_dataDistToSvgX","dist","svgWidth","pathWidth","pxPerMX","_svgXToDataDist","svgX","_arrayBisect","displayProfileByDefault","fontFamily","strokeColor","fillColor","focusLineColor","margin","_displayProfileOptions","displayProfileOptions","_points","sortedElev","e1","e2","minZ","maxZ","distUnit","widgetDiv","widgetHeigth","widgetWidth","zLabelWidth","zGradWidth","toLocaleString","minXguideWidth","elevationSvg","gradZ","maxNumZguides","maxGraphZ","numZguides","axisZ","gradZtext","yTextTranslation","yStrokeTranslation","gradZstroke","gradZpath","gradZgrad","guidesZ","gradZyOffsetPx","axisZLegend","maxNumXguides","gradX","maxGraphX","numXguides","lastGradX","axisX","gradXtext","xTextTranslation","xStrokeTranslation","gradXstroke","gradXpath","gradXgrad","guidesX","xOffset","gradXxOffsetPx","axisXLegend","elevationPathG","factor","pointX","pointY","pathD","pathPath","pathFill","dynamicsG","pathRectangle","sortedDist","focusLineX","focusLineY","focusCircle","tooltipDiv","altiSpan","slopeSpan","coordsSpan","currentSlope","tooltipG","tooltipBubble","tooltipBubbleShadow","__createProfileMarker","__removeProfileMarker","mousePoint","createSVGPoint","svgMousePoint","matrixTransform","getScreenCTM","inverse","mouseDist","distIndex","d0","d1","focusX","focusY","__updateProfileMarker","altiSpanTxt","slopeSpanTxt","slope","coordsSpanTxt","toolTipBubbleD","tooltipTextWidth","displayProfileRaw","rows","cols","__customRawProfileMouseOverEvent","displayProfileLibD3","d3","linear","range","xAxis","orient","ticks","yAxis","interpolate","y0","y1","select","append","xDomain","domain","yDomain","datum","tickSize","tickFormat","selectAll","enter","bisectDist","bisector","transition","mouse","xc","yc","_message","html","pageX","pageY","displayProfileLibAmCharts","ballonText","AmCharts","addInitHandler","coeffArrond","pathToImages","categoryField","autoMarginOffset","marginTop","startDuration","fontSize","theme","thousandsSeparator","numberFormatter","decimalSeparator","categoryAxis","gridPosition","minHorizontalGap","tickPosition","titleColor","labelOffset","startOnAxis","chartCursor","animationDuration","bulletsEnabled","bulletSize","categoryBalloonEnabled","cursorColor","graphBulletAlpha","graphBulletSize","zoomable","trendLines","graphs","balloonColor","balloonText","bullet","bulletAlpha","bulletBorderColor","bulletBorderThickness","bulletColor","fillAlphas","fillColors","lineAlpha","lineColor","lineThickness","valueField","guides","valueAxes","minVerticalGap","balloon","borderColor","borderThickness","showBullet","titles","allLabels","dataProvider","_containerProfile","makeChart","addListener","chart","ElevationPath","_ElevationPath","_showContainer","_pictoButton","_panelContainer","_profileContainer","_waitingContainer","_infoContainer","_timerHdlr","_drawStyleStart","_drawStyleFinish","_markerStyle","_profile","_data","_measureSource","_measureVector","_measureDraw","_lastSketch","_currentSketch","_initializeContainer","_initMeasureInteraction","_addMeasureInteraction","ButtonExport","features","getFeatures","GeoJSONExtended","writeFeatures","dataProjection","featureProjection","_removeProfile","_removeMeasureInteraction","setLayer","_displayProfile","export","elevationOptions","greaterSlope","meanSlope","ascendingElevation","descendingElevation","stylesOptions","draw","displayFunction","DISPLAY_PROFILE_BY_DEFAULT","displayContainer","_styles","_createStylingDraw","_createStylingMarker","panelDiv","waiting","DEFAULT_STYLES","MARKER","userStyles","PROFILE","_defaultStyle","stopClick","removeFeature","_features","_requestService","projSrc","projDest","coordinates","xy","ll","c1","c2","olGetDistanceSphere","pointCoords","_getGeometry","bOnFailure","bOnSuccess","_computeElevationMeasure","_waiting","_getSketchCoords","oldlat","oldlon","_distanceMinus","_distancePlus","_ascendingElevation","_descendingElevation","_distance","_slopes","distances","distanceToPrevious","za","zb","_altMin","_altMax","_greaterSlope","ji","distancePlus","distanceMinus","altMin","altMax","_getLength","_updateInfoContainer","removeMeasure","_removeMeasure","_coordinateProj","getClosestPoint","_geometry","Point","addFeature","_pts","_proj","RESULTS","_image","imageRadius","imageStrokeColor","imageStrokeWidth","imageFillColor","snapToPixel","interaction","VectorTile","errorMess","entities","sax","normalizeLineEndings","domHandler","DOMHandler","xmlns","defaultNamespace","_toString","java","lang","XML_ENTITIES","HTML_ENTITIES","setDocumentLocator","impl","ins","ignorableWhitespace","ch","charNode","skippedEntity","comm","dt","reportError","_locator","__DOMHandler","onErrorStopParsing","onWarningStopParsing","KML","_olKML","extensions","kmlNode","firstNodeLevel","ik","stylesUrl","_v","types","poly","domStyles","hdlDomStyle","domExtendedData","domNameTag","_idStyle","fctExtend","extendedData","fctName","nameData","labelStyleDom","iconStyleDom","labelName","labelDescription","fctLabel","labelStyle","fctIcon","iconStyle","fctIconLabel","iconLabelStyle","fstyles","fctPoly","polygonStyle","fctLine","lineStringStyle","fctCircle","circleStyle","fctPoint","pointStyle","_superPropGet","_writeRootExtensions","kmlStringExtended","_writeExtendStylesFeatures","kmlStringFormatted","Parser","__convertRGBColorsToKML","strColor","__createExtendedStyleLabel","textStyle","_fontFamily","_fontSize","_font","splits","strokeTextStyle","_haloColor","colorHex","_haloRadius","labelExtended","fImageStyle","strokeWidth","cfs","strokeColorHex","cff","fillColorHex","iconExtended","__createExtendedStyleIcon","yunits","getAnchor","hotspot","_processKml","nodeIconStyle","nodeLabelStyle","fillColorImgHex","circleExtended","tags","removeNodes","extendDataElement","dataElement","_readExtendStylesFeatures","kmlDoc","kmlString","outerHTML","__convertKMLColorsToRGB","comp","__getExtendedStyleToFeatureLabel","_text","_color","_colorHalo","_radiusHalo","_circleType","_circleRadius","_circleFillColor","_circleStrokeColor","_circleStrokeWidth","bLabelStyleSimpleExtensionGroup","bObjectSimpleExtensionGroup","nodeStyles","attributs","attributsExt","fillColorValue","fillOpacity","fillColorHexa","strokeColorValue","strokeOpacity","strokeColorHexa","StyleInstance","anchorOrigin","anchorXUnits","anchorYUnits","__getExtendedStyleToFeatureIcon","_src","_scale","_bSizeIcon","_sizeW","_sizeH","_bHotSpot","_anchorX","_anchorXUnits","_anchorY","_anchorYUnits","bIconStyle","optionsIcon","featureStyleFunction","__getStyleToDefaultFeature","showPointNames_","props","_fname","_fdescription","_ftitle","childNodesLevel","childNodesExtended","olKML","KMLExtended","LoggerByDefault","Log","loggers","RouteRequestREST","AltiElevationRequest","_zonly","GeocodedLocation","matchType","accuracy","ReverseGeocode","bbox2Json","circle2Json","polygon","polygon2Json","jsonGeom","geoEPSG","WMTS","dragElement","dragStartMouseX","dragStartMouseY","diffX","diffY","positionX","positionY","dragMouseDown","viewport","viewPortRect","closeDragElement","elementDrag","currentMouseX","currentMouseY","oldDiffX","oldDiffY","newLeft","newTop","newX","newY","AltiRequest","delimiter","setPositions","lstPosition","getPositions","addPositions","lstLon","lstLat","amp","apos","gt","lt","quot","Aacute","aacute","Abreve","abreve","acd","acE","Acirc","acirc","acute","Acy","acy","AElig","aelig","af","Afr","afr","Agrave","agrave","alefsym","aleph","Alpha","Amacr","amacr","amalg","AMP","And","and","andand","andd","andslope","andv","ang","ange","angle","angmsd","angmsdaa","angmsdab","angmsdac","angmsdad","angmsdae","angmsdaf","angmsdag","angmsdah","angrt","angrtvb","angrtvbd","angsph","angst","angzarr","Aogon","aogon","Aopf","aopf","ap","apacir","apE","ape","apid","ApplyFunction","approx","approxeq","Aring","aring","Ascr","ascr","Assign","ast","asymp","asympeq","Atilde","atilde","Auml","auml","awconint","awint","backcong","backepsilon","backprime","backsim","backsimeq","Backslash","Barv","barvee","Barwed","barwed","barwedge","bbrk","bbrktbrk","bcong","Bcy","bcy","bdquo","becaus","Because","because","bemptyv","bepsi","bernou","Bernoullis","Beta","beta","beth","between","Bfr","bfr","bigcap","bigcirc","bigcup","bigodot","bigoplus","bigotimes","bigsqcup","bigstar","bigtriangledown","bigtriangleup","biguplus","bigvee","bigwedge","bkarow","blacklozenge","blacksquare","blacktriangle","blacktriangledown","blacktriangleleft","blacktriangleright","blank","blk12","blk14","blk34","block","bne","bnequiv","bNot","bnot","Bopf","bopf","bot","bowtie","boxbox","boxDL","boxDl","boxdL","boxdl","boxDR","boxDr","boxdR","boxdr","boxH","boxh","boxHD","boxHd","boxhD","boxhd","boxHU","boxHu","boxhU","boxhu","boxminus","boxplus","boxtimes","boxUL","boxUl","boxuL","boxul","boxUR","boxUr","boxuR","boxur","boxV","boxv","boxVH","boxVh","boxvH","boxvh","boxVL","boxVl","boxvL","boxvl","boxVR","boxVr","boxvR","boxvr","bprime","Breve","breve","brvbar","Bscr","bscr","bsemi","bsim","bsime","bsol","bsolb","bsolhsub","bull","bump","bumpE","bumpe","Bumpeq","bumpeq","Cacute","cacute","Cap","cap","capand","capbrcup","capcap","capcup","capdot","CapitalDifferentialD","caps","caret","caron","Cayleys","ccaps","Ccaron","ccaron","Ccedil","ccedil","Ccirc","ccirc","Cconint","ccups","ccupssm","Cdot","cdot","cedil","Cedilla","cemptyv","cent","CenterDot","centerdot","Cfr","cfr","CHcy","chcy","check","checkmark","Chi","chi","cir","circ","circeq","circlearrowleft","circlearrowright","circledast","circledcirc","circleddash","CircleDot","circledR","circledS","CircleMinus","CirclePlus","CircleTimes","cirE","cire","cirfnint","cirmid","cirscir","ClockwiseContourIntegral","CloseCurlyDoubleQuote","CloseCurlyQuote","clubs","clubsuit","Colon","colon","Colone","colone","coloneq","comma","commat","compfn","complement","complexes","cong","congdot","Congruent","Conint","conint","ContourIntegral","Copf","copf","coprod","Coproduct","COPY","copysr","CounterClockwiseContourIntegral","crarr","Cross","cross","Cscr","cscr","csub","csube","csup","csupe","ctdot","cudarrl","cudarrr","cuepr","cuesc","cularr","cularrp","Cup","cup","cupbrcap","CupCap","cupcap","cupcup","cupdot","cupor","cups","curarr","curarrm","curlyeqprec","curlyeqsucc","curlyvee","curlywedge","curren","curvearrowleft","curvearrowright","cuvee","cuwed","cwconint","cwint","cylcty","Dagger","dagger","daleth","Darr","dArr","darr","dash","Dashv","dashv","dbkarow","dblac","Dcaron","dcaron","Dcy","dcy","DD","ddagger","ddarr","DDotrahd","ddotseq","Del","Delta","delta","demptyv","dfisht","Dfr","dfr","dHar","dharl","dharr","DiacriticalAcute","DiacriticalDot","DiacriticalDoubleAcute","DiacriticalGrave","DiacriticalTilde","diam","Diamond","diamond","diamondsuit","diams","die","DifferentialD","digamma","disin","divide","divideontimes","divonx","DJcy","djcy","dlcorn","dlcrop","dollar","Dopf","dopf","Dot","dot","DotDot","doteq","doteqdot","DotEqual","dotminus","dotplus","dotsquare","doublebarwedge","DoubleContourIntegral","DoubleDot","DoubleDownArrow","DoubleLeftArrow","DoubleLeftRightArrow","DoubleLeftTee","DoubleLongLeftArrow","DoubleLongLeftRightArrow","DoubleLongRightArrow","DoubleRightArrow","DoubleRightTee","DoubleUpArrow","DoubleUpDownArrow","DoubleVerticalBar","DownArrow","Downarrow","downarrow","DownArrowBar","DownArrowUpArrow","DownBreve","downdownarrows","downharpoonleft","downharpoonright","DownLeftRightVector","DownLeftTeeVector","DownLeftVector","DownLeftVectorBar","DownRightTeeVector","DownRightVector","DownRightVectorBar","DownTee","DownTeeArrow","drbkarow","drcorn","drcrop","Dscr","dscr","DScy","dscy","dsol","Dstrok","dstrok","dtdot","dtri","dtrif","duarr","duhar","dwangle","DZcy","dzcy","dzigrarr","Eacute","eacute","easter","Ecaron","ecaron","ecir","Ecirc","ecirc","ecolon","Ecy","ecy","eDDot","Edot","eDot","edot","ee","efDot","Efr","efr","eg","Egrave","egrave","egs","egsdot","elinters","ell","els","elsdot","Emacr","emacr","emptyset","EmptySmallSquare","emptyv","EmptyVerySmallSquare","emsp","emsp13","emsp14","ENG","eng","ensp","Eogon","eogon","Eopf","eopf","epar","eparsl","eplus","epsi","Epsilon","epsilon","epsiv","eqcirc","eqcolon","eqsim","eqslantgtr","eqslantless","Equal","equals","EqualTilde","equest","Equilibrium","equiv","equivDD","eqvparsl","erarr","erDot","Escr","escr","esdot","Esim","esim","Eta","eta","ETH","eth","Euml","euml","euro","excl","exist","Exists","expectation","ExponentialE","exponentiale","fallingdotseq","Fcy","fcy","female","ffilig","fflig","ffllig","Ffr","ffr","filig","FilledSmallSquare","FilledVerySmallSquare","fjlig","flat","fllig","fltns","fnof","Fopf","fopf","ForAll","forall","fork","forkv","Fouriertrf","fpartint","frac12","frac13","frac14","frac15","frac16","frac18","frac23","frac25","frac34","frac35","frac38","frac45","frac56","frac58","frac78","frasl","frown","Fscr","fscr","gacute","Gamma","gamma","Gammad","gammad","gap","Gbreve","gbreve","Gcedil","Gcirc","gcirc","Gcy","gcy","Gdot","gdot","gE","ge","gEl","gel","geq","geqq","geqslant","ges","gescc","gesdot","gesdoto","gesdotol","gesl","gesles","Gfr","gfr","Gg","gg","ggg","gimel","GJcy","gjcy","gl","gla","glE","glj","gnap","gnapprox","gnE","gne","gneq","gneqq","gnsim","Gopf","gopf","grave","GreaterEqual","GreaterEqualLess","GreaterFullEqual","GreaterGreater","GreaterLess","GreaterSlantEqual","GreaterTilde","Gscr","gscr","gsim","gsime","gsiml","Gt","GT","gtcc","gtcir","gtdot","gtlPar","gtquest","gtrapprox","gtrarr","gtrdot","gtreqless","gtreqqless","gtrless","gtrsim","gvertneqq","gvnE","Hacek","hairsp","half","hamilt","HARDcy","hardcy","hArr","harr","harrcir","harrw","Hat","hbar","Hcirc","hcirc","hearts","heartsuit","hellip","hercon","Hfr","hfr","HilbertSpace","hksearow","hkswarow","hoarr","homtht","hookleftarrow","hookrightarrow","Hopf","hopf","horbar","HorizontalLine","Hscr","hscr","hslash","Hstrok","hstrok","HumpDownHump","HumpEqual","hybull","hyphen","Iacute","iacute","ic","Icirc","icirc","Icy","icy","Idot","IEcy","iecy","iexcl","iff","Ifr","ifr","Igrave","igrave","iiiint","iiint","iinfin","iiota","IJlig","ijlig","Im","Imacr","imacr","ImaginaryI","imagline","imagpart","imath","imof","imped","Implies","in","incare","infin","infintie","inodot","Int","int","intcal","integers","Integral","intercal","Intersection","intlarhk","intprod","InvisibleComma","InvisibleTimes","IOcy","iocy","Iogon","iogon","Iopf","iopf","Iota","iota","iprod","iquest","Iscr","iscr","isin","isindot","isinE","isins","isinsv","isinv","it","Itilde","itilde","Iukcy","iukcy","Iuml","iuml","Jcirc","jcirc","Jcy","jcy","Jfr","jfr","jmath","Jopf","jopf","Jscr","jscr","Jsercy","jsercy","Jukcy","jukcy","Kappa","kappa","kappav","Kcedil","kcedil","Kcy","kcy","Kfr","kfr","kgreen","KHcy","khcy","KJcy","kjcy","Kopf","kopf","Kscr","kscr","lAarr","Lacute","lacute","laemptyv","lagran","Lambda","lambda","Lang","langd","langle","lap","Laplacetrf","laquo","Larr","lArr","larr","larrb","larrbfs","larrfs","larrhk","larrlp","larrpl","larrsim","larrtl","lAtail","latail","late","lates","lBarr","lbarr","lbbrk","lbrace","lbrack","lbrke","lbrksld","lbrkslu","Lcaron","lcaron","Lcedil","lcedil","lceil","lcub","Lcy","lcy","ldca","ldquo","ldquor","ldrdhar","ldrushar","ldsh","lE","le","LeftAngleBracket","LeftArrow","Leftarrow","leftarrow","LeftArrowBar","LeftArrowRightArrow","leftarrowtail","LeftCeiling","LeftDoubleBracket","LeftDownTeeVector","LeftDownVector","LeftDownVectorBar","LeftFloor","leftharpoondown","leftharpoonup","leftleftarrows","LeftRightArrow","Leftrightarrow","leftrightarrow","leftrightarrows","leftrightharpoons","leftrightsquigarrow","LeftRightVector","LeftTee","LeftTeeArrow","LeftTeeVector","leftthreetimes","LeftTriangle","LeftTriangleBar","LeftTriangleEqual","LeftUpDownVector","LeftUpTeeVector","LeftUpVector","LeftUpVectorBar","LeftVector","LeftVectorBar","lEg","leg","leq","leqq","leqslant","les","lescc","lesdot","lesdoto","lesdotor","lesg","lesges","lessapprox","lessdot","lesseqgtr","lesseqqgtr","LessEqualGreater","LessFullEqual","LessGreater","lessgtr","LessLess","lesssim","LessSlantEqual","LessTilde","lfisht","lfloor","Lfr","lfr","lg","lgE","lHar","lhard","lharu","lharul","lhblk","LJcy","ljcy","Ll","llarr","llcorner","Lleftarrow","llhard","lltri","Lmidot","lmidot","lmoust","lmoustache","lnap","lnapprox","lnE","lne","lneq","lneqq","lnsim","loang","loarr","lobrk","LongLeftArrow","Longleftarrow","longleftarrow","LongLeftRightArrow","Longleftrightarrow","longleftrightarrow","longmapsto","LongRightArrow","Longrightarrow","longrightarrow","looparrowleft","looparrowright","lopar","Lopf","lopf","loplus","lotimes","lowast","lowbar","LowerLeftArrow","LowerRightArrow","loz","lozenge","lozf","lpar","lparlt","lrarr","lrcorner","lrhar","lrhard","lrm","lrtri","lsaquo","Lscr","lscr","Lsh","lsh","lsim","lsime","lsimg","lsqb","lsquo","lsquor","Lstrok","lstrok","Lt","LT","ltcc","ltcir","ltdot","lthree","ltimes","ltlarr","ltquest","ltri","ltrie","ltrif","ltrPar","lurdshar","luruhar","lvertneqq","lvnE","macr","male","malt","maltese","Map","mapsto","mapstodown","mapstoleft","mapstoup","mcomma","Mcy","mcy","mdash","mDDot","measuredangle","MediumSpace","Mellintrf","Mfr","mfr","mho","micro","mid","midast","midcir","middot","minus","minusb","minusd","minusdu","MinusPlus","mlcp","mldr","mnplus","models","Mopf","mopf","mp","Mscr","mscr","mstpos","Mu","mu","multimap","mumap","nabla","Nacute","nacute","nang","nap","napE","napid","napos","napprox","natur","natural","naturals","nbsp","nbump","nbumpe","ncap","Ncaron","ncaron","Ncedil","ncedil","ncong","ncongdot","ncup","Ncy","ncy","ndash","ne","nearhk","neArr","nearr","nearrow","nedot","NegativeMediumSpace","NegativeThickSpace","NegativeThinSpace","NegativeVeryThinSpace","nequiv","nesear","nesim","NestedGreaterGreater","NestedLessLess","NewLine","nexist","nexists","Nfr","nfr","ngE","nge","ngeq","ngeqq","ngeqslant","nges","nGg","ngsim","nGt","ngt","ngtr","nGtv","nhArr","nharr","nhpar","ni","nis","nisd","niv","NJcy","njcy","nlArr","nlarr","nldr","nlE","nle","nLeftarrow","nleftarrow","nLeftrightarrow","nleftrightarrow","nleq","nleqq","nleqslant","nles","nless","nLl","nlsim","nLt","nlt","nltri","nltrie","nLtv","nmid","NoBreak","NonBreakingSpace","Nopf","nopf","Not","not","NotCongruent","NotCupCap","NotDoubleVerticalBar","NotElement","NotEqual","NotEqualTilde","NotExists","NotGreater","NotGreaterEqual","NotGreaterFullEqual","NotGreaterGreater","NotGreaterLess","NotGreaterSlantEqual","NotGreaterTilde","NotHumpDownHump","NotHumpEqual","notin","notindot","notinE","notinva","notinvb","notinvc","NotLeftTriangle","NotLeftTriangleBar","NotLeftTriangleEqual","NotLess","NotLessEqual","NotLessGreater","NotLessLess","NotLessSlantEqual","NotLessTilde","NotNestedGreaterGreater","NotNestedLessLess","notni","notniva","notnivb","notnivc","NotPrecedes","NotPrecedesEqual","NotPrecedesSlantEqual","NotReverseElement","NotRightTriangle","NotRightTriangleBar","NotRightTriangleEqual","NotSquareSubset","NotSquareSubsetEqual","NotSquareSuperset","NotSquareSupersetEqual","NotSubset","NotSubsetEqual","NotSucceeds","NotSucceedsEqual","NotSucceedsSlantEqual","NotSucceedsTilde","NotSuperset","NotSupersetEqual","NotTilde","NotTildeEqual","NotTildeFullEqual","NotTildeTilde","NotVerticalBar","npar","nparallel","nparsl","npart","npolint","npr","nprcue","npre","nprec","npreceq","nrArr","nrarr","nrarrc","nrarrw","nRightarrow","nrightarrow","nrtri","nrtrie","nsc","nsccue","nsce","Nscr","nscr","nshortmid","nshortparallel","nsim","nsime","nsimeq","nsmid","nspar","nsqsube","nsqsupe","nsub","nsubE","nsube","nsubset","nsubseteq","nsubseteqq","nsucc","nsucceq","nsup","nsupE","nsupe","nsupset","nsupseteq","nsupseteqq","ntgl","Ntilde","ntilde","ntlg","ntriangleleft","ntrianglelefteq","ntriangleright","ntrianglerighteq","Nu","nu","numero","numsp","nvap","nVDash","nVdash","nvDash","nvdash","nvge","nvgt","nvHarr","nvinfin","nvlArr","nvle","nvlt","nvltrie","nvrArr","nvrtrie","nvsim","nwarhk","nwArr","nwarr","nwarrow","nwnear","Oacute","oacute","oast","ocir","Ocirc","ocirc","Ocy","ocy","odash","Odblac","odblac","odiv","odot","odsold","OElig","oelig","ofcir","Ofr","ofr","ogon","Ograve","ograve","ogt","ohbar","ohm","oint","olarr","olcir","olcross","oline","olt","Omacr","omacr","Omega","omega","Omicron","omicron","omid","ominus","Oopf","oopf","opar","OpenCurlyDoubleQuote","OpenCurlyQuote","operp","oplus","Or","or","orarr","ord","orderof","ordf","ordm","origof","oror","orslope","orv","oS","Oscr","oscr","Oslash","oslash","osol","Otilde","otilde","Otimes","otimes","otimesas","Ouml","ouml","ovbar","OverBar","OverBrace","OverBracket","OverParenthesis","par","para","parallel","parsim","parsl","PartialD","Pcy","pcy","percnt","period","permil","perp","pertenk","Pfr","pfr","Phi","phi","phiv","phmmat","phone","Pi","pi","pitchfork","piv","planck","planckh","plankv","plus","plusacir","plusb","pluscir","plusdo","plusdu","pluse","PlusMinus","plusmn","plussim","plustwo","pm","Poincareplane","pointint","Popf","popf","pound","Pr","pr","prap","prcue","prE","prec","precapprox","preccurlyeq","Precedes","PrecedesEqual","PrecedesSlantEqual","PrecedesTilde","preceq","precnapprox","precneqq","precnsim","precsim","Prime","prime","primes","prnap","prnE","prnsim","prod","Product","profalar","profline","profsurf","Proportion","Proportional","propto","prsim","prurel","Pscr","pscr","Psi","psi","puncsp","Qfr","qfr","qint","Qopf","qopf","qprime","Qscr","qscr","quaternions","quatint","quest","questeq","QUOT","rAarr","race","Racute","racute","radic","raemptyv","Rang","rang","rangd","rangle","raquo","Rarr","rArr","rarr","rarrap","rarrb","rarrbfs","rarrc","rarrfs","rarrhk","rarrlp","rarrpl","rarrsim","Rarrtl","rarrtl","rarrw","rAtail","ratail","ratio","rationals","RBarr","rBarr","rbarr","rbbrk","rbrace","rbrack","rbrke","rbrksld","rbrkslu","Rcaron","rcaron","Rcedil","rcedil","rceil","rcub","Rcy","rcy","rdca","rdldhar","rdquo","rdquor","rdsh","Re","real","realine","realpart","reals","REG","ReverseElement","ReverseEquilibrium","ReverseUpEquilibrium","rfisht","rfloor","Rfr","rfr","rHar","rhard","rharu","rharul","Rho","rho","rhov","RightAngleBracket","RightArrow","Rightarrow","rightarrow","RightArrowBar","RightArrowLeftArrow","rightarrowtail","RightCeiling","RightDoubleBracket","RightDownTeeVector","RightDownVector","RightDownVectorBar","RightFloor","rightharpoondown","rightharpoonup","rightleftarrows","rightleftharpoons","rightrightarrows","rightsquigarrow","RightTee","RightTeeArrow","RightTeeVector","rightthreetimes","RightTriangle","RightTriangleBar","RightTriangleEqual","RightUpDownVector","RightUpTeeVector","RightUpVector","RightUpVectorBar","RightVector","RightVectorBar","ring","risingdotseq","rlarr","rlhar","rlm","rmoust","rmoustache","rnmid","roang","roarr","robrk","ropar","Ropf","ropf","roplus","rotimes","RoundImplies","rpar","rpargt","rppolint","rrarr","Rrightarrow","rsaquo","Rscr","rscr","Rsh","rsh","rsqb","rsquo","rsquor","rthree","rtimes","rtri","rtrie","rtrif","rtriltri","RuleDelayed","ruluhar","rx","Sacute","sacute","sbquo","Sc","sc","scap","Scaron","scaron","sccue","scE","sce","Scedil","scedil","Scirc","scirc","scnap","scnE","scnsim","scpolint","scsim","Scy","scy","sdot","sdotb","sdote","searhk","seArr","searr","searrow","sect","semi","seswar","setminus","setmn","sext","Sfr","sfr","sfrown","sharp","SHCHcy","shchcy","SHcy","shcy","ShortDownArrow","ShortLeftArrow","shortmid","shortparallel","ShortRightArrow","ShortUpArrow","shy","Sigma","sigma","sigmaf","sigmav","sim","simdot","sime","simeq","simg","simgE","siml","simlE","simne","simplus","simrarr","slarr","SmallCircle","smallsetminus","smashp","smeparsl","smid","smile","smt","smte","smtes","SOFTcy","softcy","sol","solb","solbar","Sopf","sopf","spades","spadesuit","spar","sqcap","sqcaps","sqcup","sqcups","Sqrt","sqsub","sqsube","sqsubset","sqsubseteq","sqsup","sqsupe","sqsupset","sqsupseteq","squ","Square","square","SquareIntersection","SquareSubset","SquareSubsetEqual","SquareSuperset","SquareSupersetEqual","SquareUnion","squarf","squf","srarr","Sscr","sscr","ssetmn","ssmile","sstarf","Star","star","starf","straightepsilon","straightphi","strns","Sub","sub","subdot","subE","sube","subedot","submult","subnE","subne","subplus","subrarr","Subset","subset","subseteq","subseteqq","SubsetEqual","subsetneq","subsetneqq","subsim","subsub","subsup","succ","succapprox","succcurlyeq","Succeeds","SucceedsEqual","SucceedsSlantEqual","SucceedsTilde","succeq","succnapprox","succneqq","succnsim","succsim","SuchThat","Sum","sung","Sup","sup","sup1","sup2","sup3","supdot","supdsub","supE","supe","supedot","Superset","SupersetEqual","suphsol","suphsub","suplarr","supmult","supnE","supne","supplus","Supset","supset","supseteq","supseteqq","supsetneq","supsetneqq","supsim","supsub","supsup","swarhk","swArr","swarr","swarrow","swnwar","szlig","Tab","Tau","tau","tbrk","Tcaron","tcaron","Tcedil","tcedil","Tcy","tcy","tdot","telrec","Tfr","tfr","there4","Therefore","therefore","Theta","theta","thetasym","thetav","thickapprox","thicksim","ThickSpace","thinsp","ThinSpace","thkap","thksim","THORN","thorn","Tilde","tilde","TildeEqual","TildeFullEqual","TildeTilde","times","timesb","timesbar","timesd","tint","toea","topbot","topcir","Topf","topf","topfork","tosa","tprime","TRADE","trade","triangle","triangledown","triangleleft","trianglelefteq","triangleq","triangleright","trianglerighteq","tridot","trie","triminus","TripleDot","triplus","trisb","tritime","trpezium","Tscr","tscr","TScy","tscy","TSHcy","tshcy","Tstrok","tstrok","twixt","twoheadleftarrow","twoheadrightarrow","Uacute","uacute","Uarr","uArr","uarr","Uarrocir","Ubrcy","ubrcy","Ubreve","ubreve","Ucirc","ucirc","Ucy","ucy","udarr","Udblac","udblac","udhar","ufisht","Ufr","ufr","Ugrave","ugrave","uHar","uharl","uharr","uhblk","ulcorn","ulcorner","ulcrop","ultri","Umacr","umacr","uml","UnderBar","UnderBrace","UnderBracket","UnderParenthesis","Union","UnionPlus","Uogon","uogon","Uopf","uopf","UpArrow","Uparrow","uparrow","UpArrowBar","UpArrowDownArrow","UpDownArrow","Updownarrow","updownarrow","UpEquilibrium","upharpoonleft","upharpoonright","uplus","UpperLeftArrow","UpperRightArrow","Upsi","upsi","upsih","Upsilon","upsilon","UpTee","UpTeeArrow","upuparrows","urcorn","urcorner","urcrop","Uring","uring","urtri","Uscr","uscr","utdot","Utilde","utilde","utri","utrif","uuarr","Uuml","uuml","uwangle","vangrt","varepsilon","varkappa","varnothing","varphi","varpi","varpropto","vArr","varr","varrho","varsigma","varsubsetneq","varsubsetneqq","varsupsetneq","varsupsetneqq","vartheta","vartriangleleft","vartriangleright","Vbar","vBar","vBarv","Vcy","vcy","VDash","Vdash","vDash","vdash","Vdashl","Vee","vee","veebar","veeeq","vellip","Verbar","verbar","Vert","vert","VerticalBar","VerticalLine","VerticalSeparator","VerticalTilde","VeryThinSpace","Vfr","vfr","vltri","vnsub","vnsup","Vopf","vopf","vprop","vrtri","Vscr","vscr","vsubnE","vsubne","vsupnE","vsupne","Vvdash","vzigzag","Wcirc","wcirc","wedbar","Wedge","wedge","wedgeq","weierp","Wfr","wfr","Wopf","wopf","wp","wr","wreath","Wscr","wscr","xcap","xcirc","xcup","xdtri","Xfr","xfr","xhArr","xharr","Xi","xi","xlArr","xlarr","xmap","xnis","xodot","Xopf","xopf","xoplus","xotime","xrArr","xrarr","Xscr","xscr","xsqcup","xuplus","xutri","xvee","xwedge","Yacute","yacute","YAcy","yacy","Ycirc","ycirc","Ycy","ycy","yen","Yfr","yfr","YIcy","yicy","Yopf","yopf","Yscr","yscr","YUcy","yucy","Yuml","yuml","Zacute","zacute","Zcaron","zcaron","Zcy","zcy","Zdot","zdot","zeetrf","ZeroWidthSpace","Zeta","zeta","Zfr","zfr","ZHcy","zhcy","zigrarr","Zopf","zopf","Zscr","zscr","zwj","zwnj","_createShowRoutePictoElement","onShowRoutePanelClick","_createRoutePanelElement","_createRoutePanelDivElement","_createRoutePanelHeaderElement","divClose","_createRoutePanelFooterElement","_createRoutePanelFormPointLabel","classesToAdd","_createRoutePanelFormElement","form","_addRouteResultsStagesValuesElement","modeComputation","modeTransport","exclusions","exclusionsElement","onRouteComputationSubmit","computation","transport","_createRoutePanelResultsElement","_createRouteResultsStagesElement","_createRouteResultsElement","_createRouteShowResultsDetailsElement","_createRouteResultsDetailsElement","_createRouteWaitingElement","resultStage","resultStageLabel","resultStageValue","stageCoords","divValue","divMode","onRouteModeComputationChangeAndRun","computes","divNew","onShowRouteResultsNewClick","_addRouteResultsValuesElement","fconvert","containerDistance","labelDistance","distanceLabel","distanceArrondi","divDistance","containerDuration","labelDuration","divDuration","divBorderUp","labelShow","labelHide","divBorderDown","_addRouteResultsDetailsElement","instructions","distanceCumul","durationCumul","divNum","divIns","onRouteResultsDetailsMouseOver","onRouteResultsDetailsMouseOut","onRouteResultsDetailsClick","_createRoutePanelFormPointElement","labelOrigin","labelOriginPointer","onRouteMapPointClick","_createRoutePanelFormRemoveStageElement","divRm","onRouteRemovePointClick","_createRoutePanelFormAddStageElement","divAdd","onRouteAddPointClick","_createRoutePanelFormAutoCompleteListElement","_createRouteAutoCompletedLocationElement","_createRoutePanelFormModeChoiceTransportElement","transports","divContainer","divRadio","inputCar","onRouteModeTransportChange","labelCar","inputPedestrian","labelPedestrian","_createRoutePanelFormModeChoiceComputeElement","inputFastest","onRouteModeComputationChange","labelFastest","div2","inputShortest","labelShortest","_createShowRouteExclusionsPictoElement","onShowRouteExclusionsClick","_createRoutePanelFormExclusionsElement","_createRoutePanelFormExclusionOptionsElement","inputToll","onRouteExclusionsChange","labelToll","inputTunnel","labelTunnel","inputBridge","labelBridge","_createRouteSubmitFormElement","_createRouteFormResetElement","buttonReset","onRouteResetClick","Draggable","_panelRouteContainer","_panelHeaderRouteContainer","_showRouteButton","_geojsonSections","_defaultFeatureStyle","_geojsonObject","geojson","_currentPoints","getCoordinate","_currentTransport","_currentExclusions","_currentComputation","_currentRouteInformations","setCoordinate","transportdiv","computationdiv","tollInput","tunnelInput","bridgeInput","_simplifiedInstructions","_fillRouteResultsDetailsContainer","_formRouteContainer","_hideWaitingContainer","_resultsRouteContainer","_removeRouteStepLocations","_clearRouteInputOptions","_clearRouteResultsDetails","_checkInputOptions","toll","tunnel","bridge","routeOptions","defaultMarkersOpts","departure","stages","arrival","markersOpts","_showRouteExclusionsElement","_initTransport","_initComputation","_initExclusions","_timer","_geojsonRoute","_popupContent","_popupDiv","_initPopupDiv","_popupOverlay","_resultsSelectInteraction","_resultsHoverInteraction","_selectedFeatureStyle","routePanel","routePanelDiv","routeHeader","routeForm","_createRoutePanelFormPointsElement","exclusion","panelFooter","buttonSubmit","routeResults","_hideRouteSuggestedLocations","closer","onclick","setMap","_addFormPointsEventListeners","formPoint","onRouteOriginLabelClick","onRouteOriginPointerClick","startCoordinate","endCoordinate","iCoordinate","routeResource","_protocol","_timeout","_requestRouting","_fillRouteResultsDetails","locationSelector","_clear","_clearRouteResultsGeometry","_clearRouteResultsFeatureGeometry","iFound","currentPoints","tagid","getFeatureById","_displayWaitingContainer","_fillRouteResultsDetailsGeometry","_fillRouteResultsDetailsFeatureGeometry","bounds","_resultsRouteValuesContainer","_resultsRouteDetailsContainer","geojsonObject","properties","defaultDataProjection","readFeatures","coords","popupContent","geojsonformat","eventPointerMove","_onResultsFeatureMouseOver","_onResultsFeatureSelect","selectedInstruction","getId","deselected","deselectedFeature","deSelectedInstruction","mapBrowserEvent","goodPoints","detailsDiv","valuesDiv","pointId","newInstructions","RouteDOM","timestamp","bOnError","myReq","AltiRequestREST","profil","myTemplate","objectOrFunction","isFunction","vertxNext","customSchedulerFn","asap","arg","queue","flush","scheduleFlush","setScheduler","scheduleFn","setAsap","asapFn","browserWindow","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","isWorker","Uint8ClampedArray","importScripts","MessageChannel","useNextTick","useVertxTimer","useSetTimeout","useMutationObserver","iterations","observer","observe","characterData","useMessageChannel","channel","port1","onmessage","port2","postMessage","globalSetTimeout","attemptVertx","vertx","require","runOnLoop","runOnContext","onFulfillment","onRejection","PROMISE_ID","makePromise","_state","invokeCallback","_result","subscribe","resolve$1","Constructor","promise","PENDING","FULFILLED","REJECTED","selfFulfillment","cannotReturnOwn","tryThen","then$$1","fulfillmentHandler","rejectionHandler","handleForeignThenable","thenable","sealed","fulfill","handleOwnThenable","handleMaybeThenable","maybeThenable","publishRejection","_onerror","publish","_subscribers","subscribers","settled","detail","hasCallback","succeeded","initializePromise","resolver","nextId","validationError","Enumerator","_instanceConstructor","_remaining","_enumerate","_eachEntry","entry","resolve$$1","_then","didError","_settledAt","Promise$1","_willSettleAt","enumerator","reject$1","needsResolver","needsNew","finally","polyfill","local","P","promiseToString","cast","_setScheduler","_setAsap","_asap","ProcessIsoCurve","smoothing","holes","constraintTunnel","constraintPont","constraintAutoroute","constraintType","operator","oIsoCurve","GPX","MultiLineString","LineString","_olGPX","readExtensions","clbk","setId","styleFunction","fp","fm","orderBy","numeric","gpxNode","writeRootExtensions_","processExtensions_","writeExtensions_","gpxStringExtended","gpxStringFormatted","searchChildNodesMeta","nodeMeta","searchChildNodesExt","nodeExt","searchChildNodesData","nodeData","extensionsRoot","toDOM","extensionsNode","actions","fct","olGPX","GPXExtended","GeoJSON","provideBbox","expectedStartTime","UrlByDefault","DefaultUrlService","new_key","ErrorService","stack","TYPE_USEERR","menu","icons","EXPORT_ROUTE","EXPORT_ISOCHRON","EXPORT_PROFILE","buttonOptions","inputName","inputDesc","menuClassHidden","initOptions","initContainer","containerMain","containerPlug","download","menuOptions","above","outside","labelDesc","selectFormat","setFormat","setName","setDescription","setTitle","setKind","setMenu","stringToHTML","radios","radio","onChangeRadioFormat","onClickButtonToggleOptions","onChangeInputName","onFocusInputName","onChangeInputDesc","onFocusInputDesc","onClickButtonValidate","onClickButtonCancel","onClickButtonExport","support","ClassName","writeStyles","showPointNames","featProj","isPluggableControl","exportFeatures","disable","ariaExpanded","ExportDOM","Export","domParser","Measure","exceptions","openedPanelID","openedPanel","exceptionPanel","controlPanels","bottomLeft","topLeft","_toConsumableArray","bottomRight","topRight","panelID","isException","getSameSideOpenedPanel","_createShowIsoPictoElement","onShowIsoPanelClick","_createIsoPanelElement","_createIsoPanelDivElement","_createIsoPanelHeaderElement","_createIsoPanelFormElement","onIsoComputationSubmit","_createIsoPanelResultsElement","onShowIsoResultsNewClick","_addIsoResultsValuesElement","computeOptions","origin","mode","isoResultsValueDiv","containerType","labelType","divType","containerMode","labelMode","containerOrigin","divOrigin","containerExclusions","labelExclusions","divExclusions","_createIsoWaitingElement","_createIsoPanelFooterElement","_createIsoPanelFormPointLabel","_createIsoPanelFormTypeChoiceElement","_createIsoPanelFormTypeChoiceChronElement","onIsoTypeChoiceChange","_createIsoPanelFormTypeChoiceDistElement","_createIsoPanelFormLabelIsochronElement","_createIsoPanelFormValueIsochronElement","input1","onIsoValueChronTimeMinuteChange","onIsoValueChronTimeHourChange","label1","input2","label2","_createIsoPanelFormLabelIsodistanceElement","_createIsoPanelFormValueIsodistanceElement","onIsoValueDistChange","_createIsoPanelFormModeChoiceTransportElement","radioContainer","onIsoModeTransportChange","_createIsoPanelFormModeChoiceDirectionElement","directions","onIsoModeDirectionChange","departureOption","arrivalOption","_createShowIsoExclusionsPictoElement","onShowIsoSettingsClick","_createIsoPanelFormExclusionsElement","_createIsoPanelFormExclusionOptionsElement","onIsoExclusionsChange","_createIsoSubmitFormElement","_createIsoFormResetElement","onIsoResetClick","Isocurve","_IsoPanelContainer","_IsoPanelHeaderContainer","_pictoIsoButton","_geojsonLayer","_currentDirection","_originPoint","_currentIsoResults","inputCoordsDOM","_currentTimeHour","_currentTimeMinute","_currentDistance","selectedIndex","_resultsIsoContainer","_clearIsoInputs","methods","isocurveOptions","_initDirection","_formContainer","_createIsoPanelFormPointElement","isoChronChecked","isoDistChecked","typeChoice","footer","_submitContainer","isoResults","_hideIsoSuggestedLocations","_clearGeojsonLayer","un","positionCoordinates","timeHourInput","timeMinutesInput","distInput","isoRequestOptions","_fillIsoResultsDetails","_drawIsoResults","_requestIsoCurve","deepEqual","_fillIsoResultsDetailsContainer","_currentIsoInformations","_resultsIsoValuesContainer","directionSelect","IsocurveDOM","errorNode","formatted","lines","lastType","transitions","ln","single","Boolean","closing","opening","fromTo","padding","territory","terr","_olGeoJSON","geoJSONObject","writeFeaturesObject","olGeoJSON","ProcessIsoCurveRequest","postRequest","GeocodeResponseParser","_parseFeature","geocodeResponse","mess","ConfigInterface","defaultGMLGFIStyle","wgs84Resolutions","isKeyConfLoaded","getLayersId","parts","servicePartsLayer","getLayersConf","layersIdArray","lyrId","getLayerConf","getLayerParams","layerConf","getLayerKey","serviceParams","formats","projection","defaultProjection","globalConstraint","wmtsOptions","tileMatrixSetLimits","TMSLink","tileMatrixSetLink","tmsConf","getTMSConf","matrixIds","tileMatrices","nativeResolutions","layerKey","resourcesByKey","arrayLayerId","getTileMatrixSets","tmsID","lightOrange","darkOrange","turquoiseBlue","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","globalThis","Collection","tilegrid","MVT","WMSCapabilities","WMTSCapabilities","Tile","TileJSON","v8Spec","$version","$root","center","centerAltitude","zoom","bearing","units","pitch","roll","light","sky","terrain","glyphs","source_vector","vector","tiles","scheme","xyz","tms","attribution","promoteId","volatile","source_raster","raster","tileSize","source_raster_dem","encoding","terrarium","custom","redFactor","blueFactor","greenFactor","baseShift","source_geojson","buffer","maximum","minimum","tolerance","cluster","clusterRadius","clusterMaxZoom","clusterMinPoints","clusterProperties","lineMetrics","generateId","source_video","video","urls","source_image","heatmap","hillshade","layout_background","none","layout_fill","expression","interpolated","parameters","layout_circle","layout_heatmap","layout_line","butt","bevel","miter","requires","layout_symbol","auto","never","always","cooperative","both","tokens","horizontal","uppercase","lowercase","layout_raster","layout_hillshade","filter_operator","any","has","geometry_type","identity","exponential","interval","categorical","colorSpace","lab","hcl","function_stop","intensity","exaggeration","paint_fill","paint_line","paint_circle","paint_heatmap","paint_symbol","overridable","paint_raster","paint_hillshade","paint_background","constant","refProperties","deref","__line__","extendBy","ExpressionParsingError","super","Scope","bindings","NullType","NumberType","StringType","BooleanType","ColorType","ProjectionDefinitionType","ObjectType","ValueType","CollatorType","FormattedType","PaddingType","ResolvedImageType","VariableAnchorOffsetCollectionType","itemType","N","typeToString","valueMemberTypes","checkSubtype","expected","memberType","isValidType","provided","allowedTypes","isValidNativeType","verifyType","sample","Xn","Zn","t0","t1","t2","t3","deg2rad","rad2deg","constrainAngle","rgbToLab","xyz2lab","rgb2xyz","labToRgb","lab2xyz","xyz2rgb","parseCssColor","namedColorsMatch","namedColors","parseHex","rgbRegExp","rgbMatch","rp","f1","gp","f2","bp","f3","argFormat","valFormat","maxValue","parseAlpha","validateNumbers","hslMatch","hsla","hslToRgb","padEnd","asPercentage","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","interpolateNumber","interpolateArray","premultiplied","overwriteGetter","rgbColor","atan2","NaN","rgbToHcl","getterKey","lazyValue","spaceKey","hue0","chroma0","light0","alphaF","hue1","chroma1","light1","alphaT","hue","chroma","dh","cos","sin","hclToRgb","transparent","Collator","caseSensitive","diacriticSensitive","locale","sensitivity","collator","Intl","usage","compare","lhs","rhs","resolvedLocale","resolvedOptions","VERTICAL_ALIGN_OPTIONS","FormattedSection","fontStack","textColor","verticalAlign","Formatted","sections","fromString","unformatted","isEmpty","section","Padding","RuntimeError","toJSON","Set","VariableAnchorOffsetCollection","anchorValue","offsetValue","fromValues","toValues","fx","fy","tx","ty","ResolvedImage","available","ProjectionDefinition","validateRGBA","isValue","mixed","typeOf","valueToString","Literal","expectedType","evaluate","eachChild","outputDefined","types$1","string","boolean","Assertion","Coercion","parseColor","pad","coll","geometryTypes","EvaluationContext","globals","featureState","formattedSection","_parseColorCache","availableImages","canonical","geometryType","canonicalID","cached","ParsingContext","registry","isConstantFunc","_isConstant","expr","_parse","annotate","typeAnnotation","op","Expr","actual","ec","Let","binding","Var","boundExpression","At","In","needle","haystack","IndexOf","fromIndex","rawIndex","Match","inputType","outputType","cases","outputs","otherwise","labelContext","MAX_SAFE_INTEGER","out","Case","branches","Slice","beginIndex","endIndex","findStopLessThanOrEqualTo","currentValue","nextValue","lowerIndex","upperIndex","currentIndex","Step","labelKey","valueKey","stopCount","getDefaultExportFromCjs","unitbezier","hasRequiredUnitbezier","unitbezierExports","UnitBezier","p1x","p1y","p2x","p2y","cx","bx","ax","cy","by","ay","sampleCurveX","sampleCurveY","sampleCurveDerivativeX","solveCurveX","x2","d2","solve","requireUnitbezier","Interpolate","interpolation","interpolationFactor","lower","upper","exponentialInterpolation","controlPoints","rest","outputLower","outputUpper","lowerValue","upperValue","difference","progress","Coalesce","parsedArgs","needsAnnotation","requestedImageName","argCount","isComparableType","eqCollate","makeComparison","compareBasic","compareWithCollator","isOrderComparison","Comparison","hasUntypedArgument","rt","Equals","NotEquals","LessThan","GreaterThan","LessThanOrEqual","GreaterThanOrEqual","CollatorExpression","NumberFormat","currency","minFractionDigits","maxFractionDigits","minimumFractionDigits","maximumFractionDigits","FormatExpression","firstArg","nextTokenMayBeObject","lastExpression","evaluatedContent","ImageExpression","evaluatedImageName","Length","EXTENT","getTileCoordinates","tilesAtZoom","getLngLatFromTileCoord","coord","mercatorX","mercatorY","atan","exp","updateBBox","boxWithinBox","bbox1","bbox2","pointOnBoundary","p1","p2","x1","y2","segmentIntersectSegment","vectorP","vectorQ","v1","v2","twoSided","lineIntersectPolygon","pointWithinPolygon","rings","trueIfOnBoundary","inside","pointWithinPolygons","polygons","lineStringWithinPolygon","lineStringWithinPolygons","q1","q2","x3","y3","det1","det2","getTilePolygon","getTilePolygons","updatePoint","polyBBox","worldSize","halfWorldSize","getTilePoints","pointBBox","shifts","tilePoints","getTileLines","lineBBox","tileLines","tileLine","Within","geometries","polygonsCoords","polygonGeometry","tilePolygon","tilePolygons","pointsWithinPolygons","linesWithinPolygons","TinyQueue","_down","_up","peek","halfLength","bestChild","quickselect","defaultCompare","sd","swap","compareAreas","calculateSignedArea","FE","E2","RAD","CheapRuler","coslat","w2","kx","ky","pointOnLine","minX","minY","minI","minT","minDist","sqDist","compareDistPair","getRangeSize","isRangeSafe","splitRange","isLine","size1","getBBox","getPolygonBBox","isValidBBox","bboxToBBoxDistance","ruler","pointToLineDistance","nearestPoint","segmentToSegmentDistance","dist1","dist2","lineToLineDistance","line1","range1","line2","range2","pointsToPointsDistance","points1","points2","pointToPolygonDistance","front","back","lineToPolygonDistance","polygonIntersect","poly1","poly2","polygonToPolygonDistance","polygon1","polygon2","currentMiniDist","ring1","len1","ring2","len2","updateQueue","distQueue","miniDist","rangeA","tempDist","updateQueueTwoSets","pointSet1","pointSet2","pointsToPolygonDistance","distPair","newRangesA","pointSetToPointSetDistance","isLine1","isLine2","rangeB","threshold1","threshold2","sublibe","newRangesB","polygonToGeometryDistance","maxRings","ccw","classifyRings","toSimpleGeometry","lineString","Distance","pointPosition","pointToGeometryDistance","linePositions","lineStringToGeometryDistance","expressions$1","CompoundExpression","_evaluate","definitions","availableOverloads","overloads","signature","signatureContext","isExpressionConstant","argParseFailed","signatures","stringifySignature","actualTypes","register","varargs","isTypeAnnotation","childrenConstant","isFeatureConstant","isGlobalPropertyConstant","isStateConstant","supportsPropertyExpression","spec","supportsZoomExpression","supportsInterpolation","isFunction$1","heatmapDensity","lineProgress","accumulated","LN2","E","LN10","asin","acos","binarySearch","isSupportedScript","StyleExpression","propertySpec","_warningHistory","_evaluator","_defaultValue","_enumValues","evaluateWithoutErrorHandling","isExpression","createExpression","enum","projectionDefinition","resolvedImage","variableAnchorOffsetCollection","getExpectedType","ZoomConstantExpression","_styleExpression","isStateDependent","ZoomDependentExpression","zoomStops","interpolationType","createPropertyExpression","expressionInput","isFeatureConstantResult","isZoomConstant","zoomCurve","findZoomCurve","childResult","isExpressionFilter","filterSpec","featureFilter","needGeometry","convertFilter$1","compiled","globalProperties","geometryNeeded","convertComparisonOp$1","convertNegation","convertInOp$1","convertHasOp$1","convertLiteral","convertFunction","convertIdentityFunction","zoomAndFeatureDependent","featureDependent","zoomDependent","stop","convertTokenString","featureFunctionParameters","featureFunctionStops","functionType","getFunctionType","getInterpolateOperator","appendStopPair","convertPropertyFunction","fixupDegenerateStepCurve","convertZoomAndPropertyFunction","isStep","convertZoomFunction","getFallback","curve","re","literal","validateConstants","constants","unbundle","valueOf","deepUnbundle","unbundledValue","validateObject","elementSpecs","valueSpec","elementValidators","objectElementValidators","styleSpec","validateSpec","objectKey","elementSpecKey","elementSpec","validateElement","validateArray","arraySpec","validateArrayElement","arrayElementValidator","arrayElementSpec","function","arrayIndex","validateNumber","validateFunction","functionValueSpec","stopKeyType","previousStopDomainValue","previousStopDomainZoom","stopDomainValues","isZoomFunction","isPropertyFunction","isZoomAndPropertyFunction","validateFunctionStop","validateStopDomainValue","reportValue","validateExpression","expressionContext","expressionObj","propertyKey","propertyType","validateEnum","validateFilter","validateNonExpressionFilter","validateProperty","layerSpec","layerType","transitionMatch","tokenMatch","validatePaintProperty","validateLayoutProperty","validateLayer","ref","otherLayer","sourceType","validateString","validateSource","_a","sourceName","rasterDEM","rasterDEMSpec","rootType","isCustomEncoding","customEncodingKeys","encodingName","validateRasterDEMSource","mapExpr","reduceExpr","validateLight","lightSpec","validateSky","skySpec","validateTerrain","terrainSpec","validateSprite","allSpriteIds","allSpriteURLs","pairSpec","VALIDATORS","projectionSpec","isProjectionDefinitionValue","isPropertyValueSpecification","validate","validateGlyphsUrl","validateStyleMin","sortErrors","injectValidateSpec","validator","wrapCleanErrors","inner","paintProperty","layoutProperty","v8","fontWeights","thin","hairline","book","regular","normal","plain","roman","standard","medium","bold","heavy","fat","poster","sp","italicRE","fontCache","fonts","lineHeight","cssData","haveWeight","haveStyle","weight","fontFamilies","maybeWeight","previousPart","functions","ascending","createOrUpdate","maxX","maxY","createOrUpdateEmpty","createOrUpdateFromFlatCoordinates","flatCoordinates","stride","extendXY","extendFlatCoordinates","getHeight","linearRingContainsXY","wn","linearRingsContainsXY","ends","getInteriorPointOfArray","flatCenters","flatCentersOffset","intersections","rr","maxSegmentLength","segmentLength","squaredSegmentDistance","interpolatePoint","fraction","dimension","cumulativeLengths","comparator","cmp","low","high","found","linearRingIsClockwise","edge","douglasPeucker","squaredTolerance","simplifiedFlatCoordinates","simplifiedOffset","markers","first","maxSquaredDistance","squaredDistance","douglasPeuckerArray","simplifiedEnds","snap","quantize","dx1","dy1","dx2","dy2","quantizeArray","code_","units_","extent_","worldExtent_","worldExtent","axisOrientation_","axisOrientation","global_","canWrapX_","getPointResolutionFunc_","getPointResolution","defaultTileGrid_","metersPerUnit_","metersPerUnit","canWrapX","getUnits","getMetersPerUnit","getWorldExtent","getAxisOrientation","isGlobal","setGlobal","getDefaultTileGrid","setDefaultTileGrid","tileGrid","setExtent","setWorldExtent","setGetPointResolution","func","getPointResolutionFunc","RADIUS","HALF_SIZE","WORLD_EXTENT","MAX_SAFE_Y","EPSG3857Projection","cosh","PROJECTIONS","fromEPSG4326","toEPSG4326","EPSG4326Projection","cache","transforms","destination","transformFn","sourceCode","destinationCode","epsgRegExes","zoneFromCode","epsgId","north","projectionFactories","cloneTransform","addProjection","projectionLike","makeProjection","addEquivalentProjections","projections","addProjections","projections2","forwardTransform","inverseTransform","projection1","projection2","compose","sx","sy","tmpTransform","RenderFeature","id_","type_","flatCoordinates_","flatInteriorPoints_","flatMidpoints_","ends_","properties_","squaredTolerance_","stride_","simplifiedGeometry_","createOrUpdateFromCoordinate","getFlatInteriorPoint","flatCenter","getFlatInteriorPoints","endss","startOrientation","prevEndIndex","orientation","linearRingss","interiorPoints","getInteriorPointsOfMultiArray","getFlatMidpoint","getFlatMidpoints","midpoint","getOrientedFlatCoordinates","getSimplifiedGeometry","simplifyTransformed","getPropertiesInternal","getStride","pixelExtent","projectedExtent","destinationStride","transform2D","applyTransform","getEnds","enableSimplifyTransformed","lastResult","lastArgs","lastThis","nextArgs","arr1","arr2","memoizeOne","getFlatCoordinates","TileState","util","mapboxBaseUrl","getMapboxPath","token","mapboxPath","decodeURI","URL","mapboxSubdomains","normalizeSourceUrl","tokenParam","styleUrl","urlObject","searchParams","sizeFactor","functionCacheByStyleId","filterCacheByStyleId","styleId","getStyleId","glStyle","resolutions","res","createCanvas","WorkerGlobalScope","OffscreenCanvas","zoomFactor","pendingRequests","fetchResource","resourceType","transformedRequest","transformRequest","handleError","handleResponse","pendingRequest","toPromise","glStyleOrUrl","accessToken","tilejsonCache","drawIconHalo","spriteImage","spriteImageData","haloWidth","haloColor","imgSize","pixelRatio","imageCanvas","imageContext","globalCompositeOperation","fillStyle","jj","arc","smoothstep","drawSDF","hairSpacePool","applyLetterSpacing","letterSpacing","textWithLetterSpacing","joinSpaceString","measureContext","getMeasureContext","measureCache","wrapText","em","hardLines","wrappedText","words","maxWidth","word","testLine","prevWidth","nextWidth","lineWords","lastWord","fontFamilyRegEx","stripQuotesRegEx","loadedFontFamilies","hasFontFamily","family","styleSheets","styleSheet","cssRules","rules","cssRule","processedFontFamilies","emptyObj","zoomObj","renderFeatureCoordinates","renderFeature","layoutOrPaint","functionCache","isExpr","compiledExpression","rawExpression","expressionData","getDeclutterMode","evaluateFilter","filterCache","renderTransparentEnabled","colorWithOpacity","templateRegEx","fromTemplate","recordLayer","stylefunction","sourceOrLayers","spriteData","spriteImageUrl","getFonts","spriteImageSize","spriteImageUnSDFed","getUid","blobUrl","createObjectURL","load","revokeObjectURL","worker","allLayers","layersBySourceLayer","mapboxLayers","iconImageCache","patternCache","mapboxSource","sourceLayer","textHalo","onlyLayer","featureBelongsToLayer","stylesLength","layerData","fillIcon","icon_cache_key","globalAlpha","createPattern","setColor","setWidth","setLineCap","setLineJoin","setMiterLimit","setLineDash","iconImg","skipLabel","textLineHeight","textSize","maxTextWidth","hasImage","placementAngle","iconImage","styleGeom","imageElement","iconRotationAlignment","xM","dotProduct","iconSize","iconColor","iconCacheKey","declutterMode","displacement","iconOptions","rotateWithView","sdf","setRotation","setAnchor","setImage","circleStrokeColor","circleTranslate","circleColor","circleStrokeWidth","cache_key","fontArray","textField","chunk","chunkFont","textTransform","wrappedLabel","setFont","setKeepUpright","keepUpright","textAnchor","placement","setPlacement","setRepeat","symbolSpacing","setOverflow","textHaloWidth","textOffset","textTranslate","vOffset","hOffset","textRotationAlignment","setRotateWithView","setMaxAngle","setTextAlign","textBaseline","setTextBaseline","textJustify","setJustify","setOffsetX","setOffsetY","setFill","halfTextSize","setStroke","textPadding","getPadding","View","loadingstrategy","Units","Raster","Source","TileGrid","getTileResolutions","createXYZ","maxZoom","getResolutions","completeOptions","accessTokenParam","applyStyle","sourceOrLayersOrOptions","optionsOrPath","sourceId","updateSource","assignSource","setupVectorSource","targetSource","setTileUrlFunction","getTileUrlFunction","setUrls","getUrls","format_","getAttributions","setAttributions","getTileLoadFunction","defaultLoadFunction","setTileLoadFunction","equivalent","setSource","getMinZoom","setMaxResolution","glSource","setupGeoJSONSource","getFormat","url_","getUrl","spriteScale","onChange","METERS_PER_UNIT","templateUrl","webfonts","fontsKey","fontDescriptions","cssFont","registerFont","fontDescription","checkedFonts","fontUrl","markup","rel","head","normalizeSpriteUrl","spriteUrl","pathname","spritesJson","transformed","sourceOptionsFromTileJSON","tileJSON","tileJSONSource","tileJSONDoc","getTileJSON","fromLonLat","tr","extentFromTileJSON","projectionExtent","minZoom","sourceOptions","attributions","getTopLeft","getOrigin","getTileSize","cacheKey","tileLoadFunction","setLoader","arrayBuffer","setFeatures","setState","normalizedSourceUrl","tileJson","tileUrl","getBboxTemplate","geoJsonFormat","geoJsonUrl","extentUrl","bboxTemplate","loader","failure","addFeatures","removeLoadedExtent","strategy","getUserProjection","ProxyUtils","proxifyUrl","proxyOptions","proxyUrl","noProxyDomains","LayerImportDOM","_createLoadingElement","_createShowImportPictoElement","_onShowImportClick","_createImportPanelElement","_createImportPanelDivElement","_createImportPanelHeaderElement","_createImportPanelReturnPictoElement","returnDiv","returnSpan","_onReturnPictoClick","_createImportPanelTitleElement","_createImportPanelCloseElement","_createImportPanelFormElement","_onImportSubmit","_createImportTypeLineElement","importTypes","_onImportTypeChange","_createImportWaitingElement","_createImportStaticParamsContainer","currentType","_createStaticNameLabel","_createStaticModeChoiceDiv","_createStaticLocalChoiceDiv","_onStaticImportTypeChange","_createStaticUrlChoiceDiv","_createStaticLocalInputDiv","_createStaticLocalInputLabel","_createStaticLocalInput","_createStaticUrlInputDiv","_createStaticUrlInputLabel","_createStaticUrlInput","_createServiceParamsContainer","_createServiceUrlDiv","_createServiceUrlInputLabel","_createServiceUrlInput","_createImportSubmitFormElement","_createImportGetCapPanelElement","_createImportGetCapPanelHeaderElement","closeDiv","_onGetCapPanelClose","_createImportGetCapResultsContainer","_addImportGetCapResultListRubrique","ul","_addImportGetCapResultRubrique","li","_addImportGetCapResultListLayer","_addImportGetCapResultLayer","_onGetCapResponseLayerClick","_createImportMapBoxPanelElement","_createImportMapBoxPanelHeaderElement","_onMapBoxReturnPictoClick","_onMapBoxPanelClose","_createImportMapBoxResultsContainer","LayerImport","_LayerImport","gpEditorId","_mapBoxPanel","_importPanel","cleanMapBoxResults","_importPanelHeader","_showImportButton","_panelCloseButton","contentStatic","contentService","_name","layerTypes","webServicesOptions","vectorStyleOptions","extractStyles","MapBox","DefaultStyles","_initImportTypes","_initDefaultStyles","_importPanelTitle","_importPanelReturnPicto","_staticLocalImportInput","_staticUrlImportInput","_serviceUrlImportInput","_getCapPanel","_getCapPanelHeader","_getCapResultsListContainer","_mapBoxPanelHeader","_mapBoxResultsListContainer","_loadingContainer","_hasGetCapResults","_getCapRequestUrl","_getCapResponseWMS","_getCapResponseWMSLayers","_getCapResponseWMTS","_getCapResponseWMTSLayers","_hasMapBoxResults","_file","typesList","wrongTypesIndexes","kmlDefaultStyles","_defaultKMLStyle","gpxDefaultStyles","_defaultGPXStyle","geoJSONDefaultStyles","_defaultGeoJSONStyle","MapBoxDefaultStyles","_defaultMapBoxStyle","_currentImportType","_isCurrentImportTypeStatic","_currentStaticImportType","importPanel","importPanelPanelDiv","panelReturn","importForm","_initInputFormElement","getCapPanel","importGetCapResultsList","mapBoxPanel","importMapBoxResultsList","loading","importTypeChoiceDiv","importStaticParamsContainer","staticNameLabel","staticImportChoice","staticLocalImportChoice","staticUrlImportChoice","staticLocalInputDiv","staticUrlInputDiv","importServiceParamsContainer","importServiceUrlDiv","submit","_hideFormContainer","_displayFormContainer","cleanGetCapResultsList","cleanMapBoxResultsList","setCollapsed","_importStaticLayer","_importServiceLayers","staticImportNameInput","_importStaticLayerFromLocalFile","_importStaticLayerFromUrl","_addFeaturesFromImportStaticLayer","file","files","fReader","FileReader","onprogress","onloadstart","onabort","onloadend","readAsText","fileContent","vectorLayer","vectorSource","vectorFormat","vectorStyle","_glStyles","_glSources","_multiSources","_glSourceId","_originators","_keys","_glSource","_glType","_glUrl","_glTiles","_glSprite","_urlService","featureClass","VectorTileSource","declutter","vectorTileJson","TileJSONSource","getState","_tileJSONDoc","_glData","_glStyle","_glLayers","keySource","applyStyleOlms","projCode","setZoom","_onLoadedMapBox","_onChangeVisibilitySourceMapBox","_onChangeScaleMinSourceMapBox","_onChangeScaleMaxSourceMapBox","_onChangeLegendValueSourceMapBox","_onDisplayLayerSourceMapBox","setContext","elements","getID","once","originators","fileProj","readProjection","_getMapProjectionCode","configControl","readRootExtensions","authorizedControls","class","isocurve","elevationpath","typeControl","graphControl","nameControl","titleControl","classControl","init","forEachFeature","srcElement","idDOM","currentTarget","questionMarkIndex","_displayGetCapResponseLayers","xmlResponse","getCapResponseWMS","Capability","getCapLayer","_displayGetCapResponseWMSLayer","getCapResponseWMTS","Contents","_getWMTSLayerProjection","olGetProj","Title","Abstract","layerObj","parentLayersInfos","mapProjCode","addKeys","replaceKeys","_isRootLayer","bRubriqueExist","lstRubrique","_getWMSLayerProjection","_projection","_isGoodContainer","proposalId","_addGetCapWMSLayer","_addGetCapWMTSLayer","wmsSourceOptions","getMapUrl","_getWMSLayerGetMapUrl","LegendURL","OnlineResource","wmsSource","_getWMSLayerInfoForLayerSwitcher","layerTileOptions","_getWMSLayerMinMaxResolution","_getWMSLayerExtent","wmsLayer","TileLayer","queryable","gpGFIparams","GetFeatureInfo","Format","getmapurl","GetMap","getmap","DCPType","HTTP","Get","CRSList","CRS","layerCRS","mapUnits","MinScaleDenominator","minResolution","MaxScaleDenominator","cste","exGeographicBoundingBox","boundingBox","BoundingBox","olProj","reversedExtent","MetadataURL","Attribution","LogoURL","logo","Identifier","wmtsSourceOptions","_getWMTSLayerGetTileUrl","tmsOptions","_getTMSParams","matrixSet","WMTSTileGrid","isDefault","wmtsSource","wmtsLayer","_getWMTSLayerExtent","gettileurl","OperationsMetadata","GetTile","gettile","DCP","TileMatrixSetLink","TileMatrixSet","TileMatrix","SupportedCRS","tilematrix","scaledenominator","tileMatrixSet","ScaleDenominator","TopLeftCorner","WGS84BoundingBox"],"sourceRoot":""}