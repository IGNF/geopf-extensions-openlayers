{"version":3,"file":"GpfExtOlEditor.js","mappings":"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","sources":["webpack://geopf-extensions-openlayers/./src/packages/Utils/Helper.js","webpack://geopf-extensions-openlayers/./node_modules/loglevel/lib/loglevel.js","webpack://geopf-extensions-openlayers/./node_modules/eventbusjs/lib/eventbus.min.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/ColorUtils.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/LoggerByDefault.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/SelectorID.js","webpack://geopf-extensions-openlayers/webpack/bootstrap","webpack://geopf-extensions-openlayers/webpack/runtime/compat get default export","webpack://geopf-extensions-openlayers/webpack/runtime/define property getters","webpack://geopf-extensions-openlayers/webpack/runtime/hasOwnProperty shorthand","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Event.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Style.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Themes.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Filter.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Legend.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Layer.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Group.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Search.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/EditorDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Editor.js"],"sourcesContent":["let uidCounter_ = 0;\n\n/**\n* @module Helper\n* @alias module:~utils/HelperUtils\n* @description\n* ...\n*\n* @example\n* import HelperUtils from \"gpf-ext-ol/utils/HelperUtils\"\n* ou \n* import {HelperUtils} from \"gpf-ext-ol\n* \n* HelperUtils.detectSupport();\n* HelperUtils.assign();\n* HelperUtils.mergeParams();\n*/\nvar Helper = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @function detectSupport\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport : function () {\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @function assign\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign : function (dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @function mergeParams\n     * @param {Object} dest     - destination object where properties and method will be merge\n     * @param {Object} source   - source object from which properties and method will be merge\n     * @param {Boolean} replace - replace destination value by source if exists or not (true by default)\n     */\n    mergeParams : function (dest, source, replace) {\n        if (typeof dest === \"undefined\" || typeof source === \"undefined\") {\n            return;\n        }\n        if (typeof replace === \"undefined\") {\n            replace = true;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param], replace);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    if (dest.hasOwnProperty(param)) {\n                        if (replace) {\n                            dest[param] = source[param];\n                        }\n                    } else {\n                        dest[param] = source[param];\n                    }\n                }\n            }\n        }\n    },\n    /**\n     * Gets a unique ID for an object. This mutates the object so that further calls\n     * with the same object as a parameter returns the same value. Unique IDs are generated\n     * as a strictly increasing sequence. Adapted from goog.getUid.\n     *\n     * @param {String} prefix - prefix for the unique ID\n     * @param {Object} [obj] The object to get the unique ID for.\n     * @return {String} The unique ID for the object.\n     * @api\n     */\n    getUid : function (prefix, obj) {\n        if (obj) {\n            if (obj.id) {\n                return obj.id;\n            }\n        }\n        return prefix + (++uidCounter_);\n    }\n};\n\nexport default Helper;\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","(function(root,factory){if(typeof exports===\"object\"&&typeof module===\"object\")module.exports=factory();else if(typeof define===\"function\"&&define.amd)define(\"EventBus\",[],factory);else if(typeof exports===\"object\")exports[\"EventBus\"]=factory();else root[\"EventBus\"]=factory()})(this,function(){var EventBusClass={};EventBusClass=function(){this.listeners={}};EventBusClass.prototype={addEventListener:function(type,callback,scope){var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>3?args.splice(3,args.length-1):[];if(typeof this.listeners[type]!=\"undefined\"){this.listeners[type].push({scope:scope,callback:callback,args:args})}else{this.listeners[type]=[{scope:scope,callback:callback,args:args}]}},removeEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;var newArray=[];for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if(listener.scope==scope&&listener.callback==callback){}else{newArray.push(listener)}}this.listeners[type]=newArray}},hasEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;if(callback===undefined&&scope===undefined){return numOfCallbacks>0}for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if((scope?listener.scope==scope:true)&&listener.callback==callback){return true}}}return false},dispatch:function(type,target){var event={type:type,target:target};var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>2?args.splice(2,args.length-1):[];args=[event].concat(args);if(typeof this.listeners[type]!=\"undefined\"){var listeners=this.listeners[type].slice();var numOfCallbacks=listeners.length;for(var i=0;i<numOfCallbacks;i++){var listener=listeners[i];if(listener&&listener.callback){var concatArgs=args.concat(listener.args);listener.callback.apply(listener.scope,concatArgs)}}}},getEvents:function(){var str=\"\";for(var type in this.listeners){var numOfCallbacks=this.listeners[type].length;for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];str+=listener.scope&&listener.scope.className?listener.scope.className:\"anonymous\";str+=\" listen for '\"+type+\"'\\n\"}}return str}};var EventBus=new EventBusClass;return EventBus});","/**\n * @module ColorUtils\n * @alias module:~utils/ColorUtils\n * @description\n * ...\n *\n * @example\n * import ColorUtils from \"gpf-ext-ol/utils/ColorUtils\"\n * ou \n * import {ColorUtils} from \"gpf-ext-ol\n * \n * ColorUtils.hex();\n * ColorUtils.num();\n * ColorUtils.arrayTorgba();\n * ColorUtils.arrayToHex();\n * ColorUtils.rgbaToHex();\n * ColorUtils.hexToRgba();\n * ColorUtils.isHex();\n * ColorUtils.isRGB();\n */\nvar ColorUtils = {\n\n    /**\n     * Number to hex conversion\n     *\n     * @param {Number} number - 0-255\n     * @returns {String} hex value\n     */\n    hex : function (number) {\n        if (number > 255) {\n            throw new Error(\"'\" + number + \"'' is greater than 255(0xff);\");\n        }\n        var str = Number(number).toString(16);\n        return (\"0\" + str).slice(-2);\n    },\n\n    /**\n     * Hexa to number conversion\n     *\n     * @param {*} hexa 00-FF\n     * @returns {Number} number value\n     */\n    num : function (hexa) {\n        return parseInt(hexa, 16);\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to rgba string\n     *\n     * @function arrayToRgba\n     * @param {Array} values - array of values\n     * @returns {String} A color of RGB or RGBA format\n     */\n    arrayToRgba : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3] || 1;\n        var result = \"rgba(\" + red + \", \" + green + \", \" + blue + \", \" + parseFloat(alpha) + \")\";\n        return result;\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to #RRGGBBAA\n     *\n     * @function arrayToHex\n     * @param {Array} values - array of values\n     * @returns {Object}  hex and opacity formated values\n     */\n    arrayToHex : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts rgba string to #RRGGBBAA\n     * (Code adapted from : https://gist.github.com/mstssk/afda4ce9e5c335fd79cd)\n     *\n     * @function rgbaToHex\n     * @param {String} rgba - A color of RGB or RGBA format.\n     * @returns {Object} hex and opacity formated values\n     */\n    rgbaToHex : function (rgba) {\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(rgba);\n        if (!parsed) {\n            throw new Error(\"Invalid format: \" + rgba);\n        }\n        var red = parsed[1];\n        var green = parsed[2];\n        var blue = parsed[3];\n        var alpha = parsed[4];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts hex color and opacity value to rgba string.\n     * (Code adapted from : http://stackoverflow.com/a/5624139)\n     *\n     * @function hexToRgba\n     * @param {String} hex - A color value on RGB format (hexa).\n     * @param {Number} opacity - A opacity value.\n     * @returns {String} A color of RGB or RGBA format\n     */\n    hexToRgba : function (hex, opacity) {\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        if (!hex) {\n            throw new Error(\"Invalid format\");\n        }\n        hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        rgb = rgb ? {\n            r : parseInt(rgb[1], 16),\n            g : parseInt(rgb[2], 16),\n            b : parseInt(rgb[3], 16)\n        } : null;\n        var result = rgb ? \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + opacity + \")\" : null;\n        return result;\n    },\n\n    /**\n     * Determine if value is a correct hexa color.\n     * @param {*} value - hex color (#FFFFFF)\n     * @returns {Boolean} True if value is a hexa color\n     */\n    isHex : function (value) {\n        if (!value) {\n            return false;\n        }\n        if (value.charAt(0) !== \"#\") {\n            return false;\n        }\n        var regex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Determine if value is a correct rgba color.\n     * @param {*} value - rgba color (rgba(125,125,125,1))\n     * @returns {Boolean} True if value is a rgba color\n     */\n    isRGB : function (value) {\n        if (!value) {\n            return false;\n        }\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    }\n};\n\nexport default ColorUtils;\n","import * as Log from \"loglevel\";\n\n/**\n * @module LoggerByDefault\n * @alias module:~utils/Logger\n * @description\n * ...\n *\n * @example\n * import Logger from \"gpf-ext-ol/utils/LoggerByDefault\"\n * ou \n * import {Logger} from \"gpf-ext-ol\n * \n * Logger.getLogger();\n * Logger.disableAll();\n * Logger.enableAll();\n */\nvar LoggerByDefault = {\n    /**\n     * creation d'un logger statique\n     *\n     * @function getLogger\n     * @param {String} [name=\"default\"] - the logger name\n     * @returns {Object} logger\n     */\n    getLogger : function (name) {\n        // on dfinit process si non dfini dans l'environnement\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    },\n    /**\n     * desactive tous les loggers\n     * @function disableAll\n     */\n    disableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.disableAll();\n            }\n        }\n    },\n    /**\n     * active tous les loggers\n     * @function enableAll\n     */\n    enableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.enableAll();\n            }\n        }\n    }\n};\n\nexport default LoggerByDefault;\n\n// Expose Export as ol.control.Catalog (for a build bundle)\nif (window.Gp) {\n    window.Gp.Logger = LoggerByDefault;\n}\n","/**\n * @module SelectorID\n * @alias module:~utils/SelectorID\n * @private\n * @description\n * formalisme d'un tag ID :\n * -> NAME(_ORDER)-1460636385836\n *\n * @example\n * Ex.\n *   GProutePoints-1460636385836\n *   GProutePoint_10-1460636385836\n */\nvar SelectorID = {\n\n    /**\n     * Construction d'un identifiant statique bas sur le timestamp,\n     * et qui s'incremente de +1  chaque appel\n     * @function generate\n     */\n    generate : (function () {\n        var timestamp = Math.floor(Date.now());\n        return function () {\n            return timestamp++;\n        };\n    })(),\n\n    /**\n     * nom du tag\n     * @function name\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    name : function (id) {\n        var name = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i === -1) {\n            name = id;\n        } else {\n            name = id.substring(0, i);\n        }\n\n        return name;\n    },\n\n    /**\n     * numero d'identifiant du tag\n     *\n     * @function index\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    index : function (id) {\n        var index = null;\n\n        var name = this.name(id);\n        // if (name !== id) {\n        var i = name.lastIndexOf(\"_\");\n        if (i !== -1) {\n            index = name.substring(i + 1);\n        }\n        // }\n\n        return index;\n    },\n\n    /**\n     * uuid du tag\n     *\n     * @function uuid\n     * @param {String} id - the id\n     * @returns {String} uuid\n     */\n    uuid : function (id) {\n        var uuid = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i !== -1) {\n            uuid = parseInt(id.substring(i + 1), 10);\n        }\n\n        return uuid;\n    }\n\n};\n\nexport default SelectorID;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n* managing events\n*\n* See {@link http://krasimirtsonev.com/blog/article/javascript-managing-events-dispatch-listen}\n* See {@link https://github.com/krasimir/EventBus}\n*\n* @event \"editor:layer:onclickvisibility\" - event ...\n* @event \"editor:layer:onclickclone\" - event ...\n* @event \"editor:layer:onclickremove\" - event ...\n* @event \"editor:style:oneditjson\" - event ...\n* @event \"editor:style:scale:onchangemin\" - event ...\n* @event \"editor:style:scale:onchangemax\" - event ...\n* @event \"editor:legend:onclickedition\" - event ...\n* @event \"editor:legend:onchangevalue\" - event ...\n* @event \"editor:filter:oneditjson\" - event ...\n* @event \"editor:themes:onclickimage\" - event ...\n* @event \"editor:themes:onclicktitle\" - event ...\n* @event \"editor:search:onsubmit\" - event ...\n* @event \"editor:search:onautocomplete\" - event ...\n* @event \"editor:group:oncollapse\" - event ...\n* @event \"editor:onloaded\" - event ...\n*\n* @mixin\n*\n* @example\n* // dispatch event\n* EventBus.dispatch(EventEditor.layer.visibility, e);\n* // listener\n* EventBus.addEventListener(EventEditor.layer.visibility, function (e) {...}, this);\n*/\nvar EventEditor = {\n    /** evenement sur la fin de chargement de l'editeur */\n    onloaded : \"editor:onloaded\",\n    layer : {\n        /** evenement sur la visibilit : clic sur le bouton 'oeil' */\n        onclickvisibility : \"editor:layer:onclickvisibility\",\n        /** evenement sur la duplication : clic sur le bouton\n        (not yet implemented !) */\n        onclickclone : \"editor:layer:onclickclone\",\n        /** evenement sur la suppression : clic sur le bouton\n        (not yet implemented !) */\n        onclickremove : \"editor:layer:onclickremove\"\n    },\n    legend : {\n        /** evenement sur l'affichage du mode edition */\n        onclickedition : \"editor:legend:onclickedition\",\n        /** evenement sur la modification d'une valeur */\n        onchangevalue : \"editor:legend:onchangevalue\"\n    },\n    group : {\n        /**  evenement pour deplier/plier le groupe\n        (not yet implemented !) */\n        oncollapse : \"editor:group:oncollapse\"\n    },\n    style : {\n        /** evenement sur l'dition du style\n        (not yet implemented !) */\n        oneditjson : \"editor:style:oneditjson\",\n        /** evenement sur la modification de l'echelle d'affichage */\n        scale : {\n            onchangemin : \"editor:style:scale:onchangemin\",\n            onchangemax : \"editor:style:scale:onchangemax\"\n        }\n    },\n    filter : {\n        /** evenement sur l'dition du filtre\n        (not yet implemented !) */\n        oneditjson : \"editor:filter:oneditjson\"\n    },\n    themes : {\n        /** evenement sur le clic de l'image */\n        onclickimage : \"editor:themes:onclickimage\",\n        /** evenement sur le clic du titre */\n        onclicktitle : \"editor:themes:onclicktitle\"\n    },\n    search : {\n        /** evenement sur la recherche */\n        onsubmit : \"editor:search:onsubmit\",\n        onautocomplete : \"editor:search:onautocomplete\"\n    }\n};\n\nexport default EventEditor;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-style\");\n\n/**\n * @classdesc\n *\n * MapBox styles management\n *\n * @constructor\n * @alias ol.style.editor.Style\n * @param {Object} options - options for function call.\n * @example\n *   var style = new Style ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false,\n *          scale : true\n *      },\n *      title : \"Styles (JSON)\",\n *      obj : {\n *          paint : {},\n *          layout : {}\n *      }\n *   });\n *  style.add();\n *  style.display(true);\n *  style.getContainer();\n */\nclass Style {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Style\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Style)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            scale : true,\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                paint : {},\n                layout : {}\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Styles :\";\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxStyleTarget\",\n            container : \"GPEditorMapBoxStyleContainer\",\n            containerjson : \"GPEditorMapBoxStyleJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxStyleJsonTitle\",\n            jsondisplay : \"GPEditorMapBoxStyleJsonDisplay\",\n            containertoolsscale : \"GPEditorMapBoxStyleToolsScaleContainer\",\n            scaletitle : \"GPEditorMapBoxStyleScaleTitle\",\n            containertoolsminscale : \"GPEditorMapBoxStyleToolsScaleMinContainer\",\n            scalelabelmin : \"GPEditorMapBoxStyleScaleLabelMin\",\n            scaleinputmin : \"GPEditorMapBoxStyleScaleInputMin\",\n            containertoolsmaxscale : \"GPEditorMapBoxStyleToolsScaleMaxContainer\",\n            scalelabelmax : \"GPEditorMapBoxStyleScaleLabelMax\",\n            scaleinputmax : \"GPEditorMapBoxStyleScaleInputMax\",\n            containertoolsedit : \"GPEditorMapBoxStyleToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * ie. this.container\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxStyleContainer\">\n     *   <div class =\"GPEditorMapBoxStyleJsonContainer\">\n     *      <label class=\"GPEditorMapBoxStyleJsonTitle\">JSON Styles :</label>\n     *      <pre class=\"GPEditorMapBoxStyleJsonDisplay\">...</pre>\n     *   </div>\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     *   <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _obj = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n        var _style = {};\n\n        // styles into tag 'paint' ?\n        if (_obj.paint) {\n            _found = true;\n            _style.paint = _obj.paint;\n            if (Object.keys(_obj.paint).length === 0) {\n                logger.info(\"tag 'paint' is empty !\");\n            }\n        }\n\n        // if not, search into tag 'layout' !\n        if (_obj.layout) {\n            _found = true;\n            _style.layout = _obj.layout;\n            // FIXME delete visibility from display ?\n            if (_obj.layout.visibility) {\n                delete _style.visibility;\n            }\n            if (Object.keys(_obj.layout).length === 0) {\n                logger.info(\"tag 'layout' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            var strJson = JSON.stringify(_style, null, 4);\n            json = this._syntaxHighlight(strJson);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var label = document.createElement(\"label\");\n        label.className = this.name.jsonlabel;\n        label.innerHTML = this.options.title;\n        divJson.appendChild(label);\n\n        var pre = document.createElement(\"pre\");\n        pre.className = this.name.jsondisplay;\n        pre.innerHTML = json;\n        if (pre.addEventListener) {\n            pre.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        } else if (pre.attachEvent) {\n            pre.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(pre);\n        div.appendChild(divJson);\n\n        // scale\n        if (this.options.tools.scale) {\n            div.appendChild(this._createElementToolsScale({\n                min : (_style.layout) ? _style.layout.minzoom : 0,\n                max : (_style.layout) ? _style.layout.maxzoom : 21\n            }));\n        }\n\n        // TODO menu d'edition\n        if (this.options.tools.edition) {\n            div.appendChild(this._createElementToolsEdition());\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    /**\n     * Graphical rendering of the scale tools\n     *\n     * @param {Object} scale - {min,max} or 0|21\n     * @returns {HTMLElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsScale (scale) {\n        logger.trace(\"_createElementToolsScale\");\n\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var divToolsScale = document.createElement(\"div\");\n        divToolsScale.className = this.name.containertoolsscale;\n\n        // FIXME Titre ?\n        // var label = document.createElement(\"label\");\n        // label.className = this.name.scaletitle;\n        // label.innerHTML = \"Scale :\";\n        // divToolsScale.appendChild(label);\n        var divMin = document.createElement(\"div\");\n        divMin.className = this.name.containertoolsminscale;\n\n        var labelMin = document.createElement(\"label\");\n        labelMin.className = this.name.scalelabelmin;\n        labelMin.innerHTML = \"min :\";\n        divMin.appendChild(labelMin);\n\n        var inputMin = document.createElement(\"input\");\n        inputMin.className = this.name.scaleinputmin;\n        inputMin.type = \"range\";\n        inputMin.value = scale.min || 0;\n        inputMin.title = scale.min || 0;\n        inputMin.disabled = false;\n        inputMin.min = 0;\n        inputMin.max = 21;\n        inputMin.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMin.addEventListener) {\n            inputMin.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        } else if (inputMin.appendChild) {\n            inputMin.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        }\n        divMin.appendChild(inputMin);\n\n        divToolsScale.appendChild(divMin);\n\n        var divMax = document.createElement(\"div\");\n        divMax.className = this.name.containertoolsmaxscale;\n\n        var labelMax = document.createElement(\"label\");\n        labelMax.className = this.name.scalelabelmax;\n        labelMax.innerHTML = \"max :\";\n        divMax.appendChild(labelMax);\n\n        var inputMax = document.createElement(\"input\");\n        inputMax.className = this.name.scaleinputmin;\n        inputMax.type = \"range\";\n        inputMax.value = scale.max || 21;\n        inputMax.title = scale.max || 21;\n        inputMax.disabled = false;\n        inputMax.min = 0;\n        inputMax.max = 21;\n        inputMax.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMax.addEventListener) {\n            inputMax.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        } else if (inputMax.appendChild) {\n            inputMax.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        }\n        divMax.appendChild(inputMax);\n\n        divToolsScale.appendChild(divMax);\n\n        return divToolsScale;\n    }\n\n    /**\n     * Graphical rendering of the edition tools\n     *\n     * @returns {HTMLElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsEdition () {\n        logger.warn(\"_createElementToolsEdition, it's not yet implemented !\");\n\n        var divToolsEdit = document.createElement(\"div\");\n        divToolsEdit.className = this.name.containertoolsedit;\n\n        return divToolsEdit;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Transform a JSON into a DOM with a syntax in color\n     *\n     * @private\n     * @param {Object} json - json.\n     * @returns {HTMLElement} dom element\n     */\n    _syntaxHighlight (json) {\n        json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n        return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function (match) {\n            var cls = \"gp-json-number\";\n            if (/^\"/.test(match)) {\n                if (/:$/.test(match)) {\n                    cls = \"gp-json-key\";\n                } else {\n                    cls = \"gp-json-string\";\n                }\n            } else if (/true|false/.test(match)) {\n                cls = \"gp-json-boolean\";\n            } else if (/null/.test(match)) {\n                cls = \"gp-json-null\";\n            }\n            return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n        });\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:oneditjson\n     */\n    onEditJsonStyleMapBox (e) {\n        logger.trace(\"onEditJsonStyleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.oneditjson, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemin\n     */\n    onChangeStyleScaleMinMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMinMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemin, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemax\n     */\n    onChangeStyleScaleMaxMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMaxMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemax, e);\n    }\n\n};\n\nexport default Style;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Style = Style;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-themes\");\n\n/**\n * @classdesc\n *\n * Mapbox Themes management\n *\n * @constructor\n * @alias ol.style.editor.Theme\n * @param {Object} options - options for function call.\n * @example\n *   var theme = new Themes ({\n *        \"target\": \"\",\n *        \"tools\": {\n *          \"thumbnails\": true,\n *          \"button\" : {\n *              \"visible\" : true,\n *              \"type\" : \"radio\" (par defaut) | \"checkbox\"\n *          }\n *        },\n *        \"obj\": {\n *          \"themesSummary\": \"\", // Titre du composant (non graphique !)\n *          \"themes\": [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *        }\n *   });\n *  theme.add();\n *  theme.display(true);\n *  theme.getContainer();\n */\nclass Themes {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Themes\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Themes)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {\n            thumbnails : true,\n            button : {\n                visible : true,\n                type : \"radio\"\n            }\n        };\n\n        if (!this.options.tools || Object.keys(this.options.tools).length === 0) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (typeof this.options.obj === \"undefined\" ||\n            this.options.obj === null ||\n            !this.options.obj) {\n            // vide par defaut ?\n            this.options.obj = {\n                themesSummary : \"\",\n                themes : []\n            };\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxThemeTarget\",\n            container : \"GPEditorMapBoxThemesContainer\",\n            containertheme : \"GPEditorMapBoxThemeContainer\",\n            containerthemeID : \"GPEditorMapBoxThemeContainer_ID_\",\n            input : \"GPEditorMapBoxThemeInput\",\n            inputID : \"GPEditorMapBoxThemeInput_ID_\",\n            label : \"GPEditorMapBoxThemeTitle\",\n            labelID : \"GPEditorMapBoxThemeTitle_ID_\",\n            image : \"GPEditorMapBoxThemeImage\",\n            imageID : \"GPEditorMapBoxThemeImage_ID_\",\n            message : \"GPEditorMapBoxThemeMessage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     *  <div class=\"GPEditorMapBoxThemesContainer\">\n     *      <div id=\"GPEditorMapBoxThemeContainer-1\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176933\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image1.png\" alt=\"Description1\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeTitle\">Titre1</label>\n     *      </div>\n     *      <div id=\"GPEditorMapBoxThemeContainer-2\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176934\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image2.png\" alt=\"Description2\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeTitle\">Titre2</label>\n     *      </div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var id = this.id || ID.generate();\n\n        // div principale\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n        div.title = obj.themesSummary || \"\";\n\n        var _lstThemes = obj.themes;\n        if (_lstThemes) {\n            for (var i = 0; i < _lstThemes.length; i++) {\n                var _theme = _lstThemes[i];\n\n                // div pour chaque theme\n                var divTheme = document.createElement(\"div\");\n                divTheme.id = this.name.containerthemeID + i + \"_\" + id;\n                divTheme.className = this.name.containertheme;\n                divTheme.tabIndex = i;\n\n                // url du style est obligatoire !\n                var _url = _theme.url;\n                // style selectionn par defaut (uniquement en mode radio-button !?)\n                var _selected = _theme.selected || false;\n                if (_url) {\n                    // bouton\n                    var button = this.options.tools.button;\n                    if (button.visible) {\n                        var _type = (button.type === \"checkbox\") ? \"checkbox\" : \"radio\";\n                        var _button = document.createElement(\"input\");\n                        _button.type = _type;\n                        _button.id = this.name.inputID + i + \"_\" + id;\n                        _button.className = this.name.input;\n                        _button.name = id;\n                        _button.checked = _selected;\n                        _button.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (_button.addEventListener) {\n                            _button.addEventListener(\"click\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        } else if (_button.attachEvent) {\n                            _button.attachEvent(\"onclick\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        }\n                        divTheme.appendChild(_button);\n                    }\n                    // vignette\n                    if (this.options.tools.thumbnails) {\n                        if (_theme.thumbnail) {\n                            var _img = document.createElement(\"img\");\n                            _img.id = this.name.imageID + i + \"_\" + id;\n                            _img.className = this.name.image;\n                            _img.src = _theme.thumbnail;\n                            _img.alt = _theme.thumbnail;\n                            _img.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                            _img.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                            if (_img.addEventListener) {\n                                _img.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    // maj du radio button\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            } else if (_img.attachEvent) {\n                                _img.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            }\n                            divTheme.appendChild(_img);\n                        }\n                    }\n                    // label\n                    if (_theme.name) {\n                        var _label = document.createElement(\"label\");\n                        _label.id = this.name.labelID + i + \"_\" + id;\n                        if (this.options.tools.button.visible) {\n                            _label.htmlFor = _button.id;\n                        }\n                        _label.className = this.name.label;\n                        _label.innerHTML = _theme.name;\n                        _label.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                        _label.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (!this.options.tools.button.visible) {\n                            if (_label.addEventListener) {\n                                _label.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            } else if (_label.attachEvent) {\n                                _label.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            }\n                        }\n                        divTheme.appendChild(_label);\n                    }\n                } else {\n                    var _msg = document.createElement(\"label\");\n                    _msg.className = this.name.message;\n                    _msg.innerHTML = \"Thme non disponible...\";\n                    divTheme.appendChild(_msg);\n                }\n\n                div.appendChild(divTheme);\n            }\n        }\n\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:image\n     */\n    onClickThemeImageMapBox (e) {\n        logger.trace(\"onClickThemeImageMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.previousSibling.id.substring(\n                e.target.previousSibling.id.lastIndexOf(\"_\") + 1\n            );\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.previousSibling.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclickimage, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:title\n     */\n    onClickThemeTitleMapBox (e) {\n        logger.trace(\"onClickThemeTitleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.id.substring(e.target.id.lastIndexOf(\"_\") + 1);\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclicktitle, e);\n    }\n\n};\n\nexport default Themes;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Themes = Themes;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-filter\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Filter\n * @param {Object} options - options for function call.\n * @example\n *   var filter = new Filter ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false\n *      },\n *      title : \"Filtres (JSON)\",\n *      obj : {\n *          filter : []\n *      }\n *   });\n *  filter.add();\n *  filter.display(true);\n *  filter.getContainer();\n */\nclass Filter {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Filter\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Filter)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                filter : []\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Filtres :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxFilterTarget\",\n            container : \"GPEditorMapBoxFilterContainer\",\n            containerjson : \"GPEditorMapBoxFilterJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxFilterTitleJson\",\n            jsondisplay : \"GPEditorMapBoxFilterDisplayJson\",\n            containertoolsedit : \"GPEditorMapBoxFilterToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxFilterContainer\">\n     *  <div class =\"GPEditorMapBoxFilterJsonontainer\">\n     *     <label class=\"GPEditorMapBoxFilterTitleJson\">JSON Filtres :</label>\n     *     <pre class=\"GPEditorMapBoxFilterDisplayJson\">...</pre>\n     *  </div>\n     *  <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _filter = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        // FIXME tag filter est obselete !\n        // on doit utiliser les expressions dans \"paint\" ou \"layout\" !\n        if (_filter.filter) {\n            _found = true;\n            if (_filter.filter.length === 0) {\n                logger.info(\"tag 'filter' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            json = JSON.stringify(_filter.filter, null, 4);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var labelJson = document.createElement(\"label\");\n        labelJson.className = this.name.jsonlabel;\n        labelJson.innerHTML = this.options.title;\n        divJson.appendChild(labelJson);\n\n        var preJson = document.createElement(\"pre\");\n        preJson.className = this.name.jsondisplay;\n        preJson.innerHTML = json;\n        if (preJson.addEventListener) {\n            preJson.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        } else if (preJson.attachEvent) {\n            preJson.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(preJson);\n        div.appendChild(divJson);\n\n        if (this.options.tools.edition) {\n            var divEdit = document.createElement(\"div\");\n            divEdit.className = this.name.containertoolsedit;\n            div.appendChild(divEdit);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Filter#editor:style:oneditjson\n     */\n    onEditJsonFilterMapBox (e) {\n        logger.trace(\"onEditJsonFilterMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.filter.oneditjson, e);\n    }\n\n};\n\nexport default Filter;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Filter = Filter;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Color from \"../../Utils/ColorUtils\";\n\nvar logger = Logger.getLogger(\"editor-legend\");\n\n/**\n * @classdesc\n *\n * MapBox Legend management\n *\n * @constructor\n * @alias ol.style.editor.Legend\n * @param {Object} options - options for function call.\n * @param {Object} [options.target = null] - ...\n * @param {Number} [options.position = 0] -  ...\n * @param {Number} [options.id = null] - (internal) ...\n * @param {Object} [options.sprites = null] - ...\n * @param {String} [options.sprites.url] - ...\n * @param {Object} [options.sprites.size] - {h:, w:} ...\n * @param {Object} [options.sprites.json] - ...\n * @param {Object} options.obj - ...\n * @param {String} [options.obj.title] - ...\n * @param {Boolean} [options.obj.editable = true] - ...\n * @param {Object} options.obj.paint - ...\n * @param {Object} options.obj.layout - ...\n * @example\n *   var legend = new Legend ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      sprites : {\n *          url : \"http://localhost/sprites.png\",\n *          size : { w : 450, h : 550 },\n *          json : {\n *              icon-1 : {x:,y:,height:,width:,pixelRatio:},\n *              icon-2 : {x:,y:,height:,width:,pixelRatio:}\n *          }\n *      },\n *      obj : {\n *          title : \"\",\n *          editable : true, // tag non standard issue du style json ddi  l'edition\n *          paint : {\"fill-color\": \"#2BB3E1\"},\n *          layout : {visibility:\"none\"}\n *      }\n *   });\n *  legend.add();\n *  legend.display(true);\n *  legend.isEditable();\n *  legend.getRenderContainer();\n *  legend.getToolsContainer();\n *  legend.getContainer();\n */\nclass Legend {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Legend\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            sprites : null,\n            obj : null\n        };\n\n        if (!(this instanceof Legend)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ########################## init methods ########################### //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        // permet d'avoir un identifiant de position dans la liste des layers\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition...\n            this.options.obj = {\n                title : \"vide...\",\n                editable : true,\n                paint : {\n                    \"fill-color\" : \"#FFFFFF\"\n                }\n            };\n        }\n\n        // la legende est elle editable ?\n        // le tag 'editable' est  placer dans le fichier de style (dans le layer)...\n        var _editable = this.options.obj.editable;\n        this.editable = (typeof _editable !== \"undefined\") ? _editable : false;\n\n        // liste des caractristiques de la legende par defaut\n        this.legendRender = {\n            type : \"fill\",\n            values : {\n                width : 1,\n                stroke : \"#FFFFFF\",\n                color : \"#000000\",\n                opacity : 1\n            }\n        };\n\n        // DOM : pointer\n        this.container = null;\n        this.rendercontainer = null;\n        this.toolscontainer = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLegendTarget\",\n            container : \"GPEditorMapBoxLegendContainer\",\n            containerlegendrender : \"GPEditorMapBoxLegendRenderContainer\",\n            legendrender : \"GPEditorMapBoxLegendRender\",\n            legendeditable : \"GPEditorMapBoxLegendEditable\",\n            legendtitle : \"GPEditorMapBoxLegendTitle\",\n            containerlegendtools : \"GPEditorMapBoxLegendToolsContainer\"\n        };\n\n        // DOM : Label menu Edition\n        this.labels = {\n            \"line-color\" : \"Couleur du trait\",\n            \"line-width\" : \"Epaisseur du trait\",\n            \"line-opacity\" : \"Opacit du trait\",\n            \"fill-color\" : \"Couleur de remplissage\",\n            \"fill-opacity\" : \"Opacit du remplissage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxLegendContainer\">\n     *  <div class=\"GPEditorMapBoxLegendRenderContainer\">\n     *      <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-circle\" style=\"...\"></div>\n     *      <span class=\"GPEditorMapBoxLegendTitle\">test circle editable...</span>\n     *  </div>\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     * </div>\n     */\n    _initContainer () {\n        var _obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // INFO\n        // on recherche les informations dans le tag 'paint' en priorit, mais pour\n        // les icones ou textes, les informations peuvent se trouver aussi dans le tag 'layout'...\n        // on fusionnne paint et layout par facilit\n        var style = Object.assign({}, _obj.paint, _obj.layout);\n\n        // liste des properties mapbox\n        // ex. fill-color\n        var keys = Object.keys(style);\n        if (keys.length === 0) {\n            logger.info(\"tag 'paint' or 'layout' is empty !\");\n            return;\n        }\n\n        // FIXME\n        // - gestion de type plus complexe : texte avec/sans symbole ou symbole !\n        // - pour les textes ou icones, les info peuvent tre aussi dans le tag 'layout' !\n        var params = {};\n        var bFound = false;\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            // recherche du type\n            // ex. fill\n            if (/fill-/.test(key) ||\n                /line-/.test(key) ||\n                /circle-/.test(key) ||\n                /background-/.test(key) ||\n                /text-/.test(key) ||\n                /icon-/.test(key)) {\n                // style ger & trouv\n                bFound = true;\n\n                var title = _obj.title || \"\";\n\n                // INFO\n                // le type texte ou icone est difficile  trouver car les 2 types cohabitent,\n                // on le gre en symbole...\n                var type = key.split(\"-\")[0];\n                if (type === \"text\" || type === \"icon\") {\n                    type = \"symbol\";\n                }\n\n                this.legendRender = this._getProperties(type, style);\n                params = {\n                    edit : this.editable,\n                    title : title,\n                    type : this.legendRender.type,\n                    values : this.legendRender.values\n                };\n                div.appendChild(this._createElementIconLegend(params));\n\n                // on stoppe la recherche\n                break;\n            }\n        }\n\n        // legende avec un style indetermin ou non gr !?\n        if (!bFound) {\n            // on prend la legende par defaut\n            params = {\n                edit : this.editable,\n                title : \"\",\n                type : this.legendRender.type,\n                values : this.legendRender.values\n            };\n            div.appendChild(this._createElementIconLegend(params));\n            logger.warn(\"legend type unknown, default legend used...\");\n        }\n\n        // ajout mode edition graphique de la legende\n        this.toolscontainer = this._createElementEditionLegend(params);\n        div.appendChild(this.toolscontainer);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n    * Get properties supported\n    *\n    * @param {Object} type - fill, line, circle, text, icon...\n    * @param {Object} values - raw values from the JSON file\n    * @returns {Object} - { type : (fill | line | circle | symbol), values : valuesSupported }\n    *\n    * @private\n    * @example\n    *\n    * // TODO\n    * // symbol with text (1) / symbol without text (2) / text (3)\n    * // \"layout\":{\n    * //      \"icon-image\":\"{maki}-11\",          <!--- IT'S A SYMBOL (1) (2)-->\n    * //      \"text-font\":[\n    * //           \"Open Sans Semibold\",\n    * //           \"Arial Unicode MS Bold\"\n    * //       ],\n    * //       \"text-field\":\"{name_en}\",         <!--- IT'S A TEXT (1) (3)-->\n    * //       \"text-max-width\":9,\n    * //       \"text-padding\":2,\n    * //       \"text-offset\":[\n    * //            0,\n    * //            0.6\n    * //       ],\n    * //       \"text-anchor\":\"top\",\n    * //       \"text-size\":12\n    * // },\n    * // \"paint\":{\n    * //     \"text-color\":\"#666\",\n    * //     \"text-halo-color\":\"#ffffff\",\n    * //     \"text-halo-width\":1,\n    * //     \"text-halo-blur\":0.5\n    * // },\n    *\n    */\n    _getProperties (type, values) {\n        // cas particulier du symbole complexe\n        // il existe plusieurs types pour un symbole :\n        // - text\n        // - icon\n        // - icon with text\n        if (type === \"symbol\") {\n            var isTextValue = values[\"text-field\"];\n            var isIconValue = values[\"icon-image\"];\n            type = (isTextValue && isIconValue) ? \"icon\" : (isTextValue) ? \"text\" : (isIconValue) ? \"icon\" : \"unknow\";\n            if (type === \"unknow\") {\n                logger.warn(\"type unknow !?\");\n                return;\n            }\n        }\n\n        var valuesSupported = {};\n        for (const key in values) {\n            if (Object.hasOwnProperty.call(values, key)) {\n                const val = values[key];\n                if (Legend.PROPERTIES[type].includes(key)) {\n                    var prop = key.replace(type, \"\").slice(1);\n                    var value = this._getValue(val);\n                    if (value) {\n                        // cas particulier des sprites\n                        if (prop === \"pattern\" || prop === \"image\") {\n                            if (!this.options.sprites ||\n                                !this.options.sprites.json ||\n                                !this.options.sprites.json[value]) {\n                                var k = type + \":\" + prop;\n                                logger.warn(\"sprites mandatory for key \", k);\n                                break;\n                            }\n                        }\n                        valuesSupported[prop] = value;\n                    }\n                } else {\n                    logger.warn(\"property not supported : \", key);\n                }\n            }\n        }\n\n        return {\n            type : type,\n            values : valuesSupported\n        };\n    }\n\n    /**\n    * Render thumbnail (SVG)\n    *\n    * @param {Object} type - fill, line, circle, text, ...\n    * @param {Object} values - {\"color\":..., \"width\":..., \"stroke\":...., \"opacity\":...}\n    * @returns {Boolean} true/false\n    *\n    * @private\n    * @example\n    * (...)\n    */\n    _renderThumbnail (type, values) {\n        // div de rendu de la legende\n        var div = this.rendercontainer;\n\n        if (!div) {\n            return false;\n        }\n\n        // SVG\n        var svg = null;\n        // facteur grossissement (x10) pour le trait\n        var factor = 3;\n\n        // valeur par defaut\n        if (!values.color) {\n            values.color = \"#FFFFFF\";\n        }\n        // en fonction du type, on y ajoute le style\n        switch (type) {\n            case \"text\":\n                var styleText = \"font-size: 5em;font-weight: bold;\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%style%\", styleText);\n                break;\n            case \"icon\":\n                if (values.image) {\n                    // FIXME on reste dans le paradigme d'utilisation du SVG...,\n                    // mais probleme de ratio de l'image !?\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.image].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.image].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.image].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.image].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var styleTextIcon = \"fill: transparent;stroke-width: 10;\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%style%\", styleTextIcon);\n                }\n                break;\n            case \"line\":\n                var lstrockedasharray = (Array.isArray(values[\"dasharray\"])) ? values[\"dasharray\"].join(\" \") : 0;\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>\\\")\";\n                // svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M0 99 L99 0 L100 1 L1 100' stroke='%color%' stroke-width='%width%' stroke-opacity='%opacity%' stroke-dasharray='%dasharray%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%stroke-opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-dasharray%\", lstrockedasharray)\n                    .replace(\"%stroke-width%\", (values.width || 0) * factor);\n                break;\n            case \"circle\":\n                var cstrockcolor = values[\"stroke-color\"] || \"#FFFFFF\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-color%\", (cstrockcolor.indexOf(\"rgb\") === 0) ? cstrockcolor : Color.hexToRgba(cstrockcolor, 1))\n                    .replace(\"%stroke-opacity%\", values[\"stroke-opacity\"] || 1)\n                    .replace(\"%stroke-width%\", (values[\"stroke-width\"] || 0) * factor);\n                break;\n            case \"background\":\n            case \"fill\":\n                if (values.pattern) {\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.pattern].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.pattern].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.pattern].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.pattern].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var fstrokecolor = values[\"outline-color\"] || \"#FFFFFF\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%opacity%\", values.opacity || 1)\n                        .replace(\"%stroke-color%\", (fstrokecolor.indexOf(\"rgb\") === 0) ? fstrokecolor : Color.hexToRgba(fstrokecolor, 1));\n                }\n                break;\n            default:\n                logger.warn(\"type not found, no thumbnail...\");\n                return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Get value\n     *\n     * @param {*} value - value of a property (ex. \"#2BB3E1\")\n     * @returns {*} return a verified value (ex. color\": \"#2BB3E1\")\n     *\n     * @private\n     * @example\n     * // type simple for fill, line or circle type with string :\n     * // \"paint\": {\n     * //     \"fill-color\": \"#2BB3E1\"\n     * // }\n     *\n     * // type simple for fill, line or circle type with array :\n     * // \"paint\": {\n     * //     \"line-dasharray\": [2,10]\n     * // }\n     *\n     * // TODO type complexe : not yet implemented !\n     * // \"paint\": {\n     * //     \"fill-color\": [\n     * //          \"match\",\n     * //          [\"get\",\"symbo\"],\n     * //          \"ZONE_BOISEE\",\"#A7DA81\",\n     * //          \"ZONE_MANGROVE\",\"#7E8AB5\",\n     * //          \"#A7DA81\"\n     * //      ]\n     * // }\n     *\n     * // other type complexe :\n     * // \"paint\": {\n     * //     \"fill-color\": {\n     * //        \"base\": 1,\n     * //        \"stops\": [\n     * //        [\n     * //          15.5,\n     * //         \"#f2eae2\"\n     * //        ],\n     * //        [\n     * //          16,\n     * //          \"#dfdbd7\"\n     * //        ]\n     * //        ]\n     * //     }\n     * // }\n     */\n    _getValue (value) {\n        var result = null;\n        if (typeof value === \"string\") {\n            result = value;\n        } else if (typeof value === \"number\") {\n            result = value;\n        } else if (Array.isArray(value)) {\n            // cas d'un tableau de valeurs numriques : [1,2,3]\n            var isNumber = true;\n            value.forEach(v => {\n                if (typeof v !== \"number\") {\n                    isNumber = false;\n                }\n            });\n            if (isNumber) {\n                result = value;\n            }\n        } else if (typeof value === \"object\") {\n            result = null;\n            if (\"stops\" in value) {\n                // on realise un ordre invers sur les zooms\n                value.stops.sort((a, b) => {\n                    var numA = a[0];\n                    var numB = b[0];\n                    if (numA > numB) {\n                        return -1;\n                    }\n                    if (numA < numB) {\n                        return 1;\n                    }\n                    return 0;\n                });\n                // et, on prend le plus petit zoom\n                var lastStopsValue = value.stops.slice(-1);\n                result = lastStopsValue[0][1];\n            }\n        } else {\n            logger.warn(\"value not supported !\");\n        }\n        return result;\n    }\n\n    // ################################################################### //\n    // ######################### DOM methods ############################# //\n    // ################################################################### //\n    /**\n    * Create a Graphical Legend Icon\n    *\n    * @param {Object} params - param\n    * @param {String} params.title - title\n    * @param {String} params.type - fill, line, circle, text, icon, ...\n    * @param {String} params.values - {\"color\": \"#2BB3E1\", \"width\": 10, \"opacity\": 0.5, \"stroke\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line, fill and circle legend !\n    * @returns {HTMLElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendRenderContainer\">\n    *       <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-fill\"\n    *           style=\"background: url(&quot;data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' fill='rgba(255, 255, 255, 1)' fill-opacity='1' /></svg>&quot;);\">\n    *       </div>\n    *       <span class=\"GPEditorMapBoxLegendTitle\">vide...</span>\n    * </div>\n    */\n    _createElementIconLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendrender;\n\n        var div = this.rendercontainer = document.createElement(\"div\");\n        div.className = this.name.legendrender;\n        if (params.edit) {\n            div.className += \" \";\n            div.className += this.name.legendeditable;\n            if (div.addEventListener) {\n                div.addEventListener(\"click\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            } else if (div.attachEvent) {\n                div.attachEvent(\"onclick\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            }\n        }\n\n        // type de legende\n        var type = params.type;\n\n        // TODO className\n        // div.className += \" legend-not-implemented\";\n        // ajout du style sur la div de rendu\n        if (this._renderThumbnail(type, params.values)) {\n            // className possibles :\n            // \" legend-text\"\n            // \" legend-icon\"\n            // \" legend-background\"\n            // \" legend-line\"\n            // \" legend-line-not-editable\"\n            // \" legend-circle\"\n            // \" legend-circle-not-editable\"\n            // \" legend-fill\"\n            // \" legend-fill-not-editable\"\n            div.className += (params.edit) ? \" legend-\" + type : \" legend-\" + type + \"-not-editable\";\n        } else {\n            div.className += \" legend-unknow\";\n        }\n\n        container.appendChild(div);\n\n        var span = document.createElement(\"span\");\n        span.className = this.name.legendtitle;\n        span.innerHTML = params.title || \"\";\n        container.appendChild(span);\n\n        return container;\n    }\n\n    /**\n    * Create a Graphical Legend Edition\n    *\n    * @param {Object} params - param\n    * @param {String} params.type - fill, line, (TODO : circle, icon or text)\n    * @param {String} params.values - {\"fill-color\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line and fill legend !\n    * @returns {HTMLElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendToolsContainer\">\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-color\">Couleur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-width\">Epaisseur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-width\" title=\"\" type=\"range\" min=\"0\" max=\"10\" step=\"1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-opacity\">Opacit du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-color\">Couleur de remplissage</label>\n    *        <input class=\"legend-styling\" id=\"fill-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-opacity\">Opacit du remplissage</label>\n    *           <input class=\"legend-styling\" id=\"fill-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *   </div>\n    */\n    _createElementEditionLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendtools;\n\n        // uniquement les elements editables !\n        if (!params.edit) {\n            return container;\n        }\n\n        // on ne traite que l'edition du mode 'traits' ou 'surfaciques'\n        // mode 'line'\n        switch (params.type) {\n            case \"line\":\n                createLineColor.call(self);\n                createLineWidth.call(self);\n                createLineOpacity.call(self);\n                break;\n            case \"background\":\n            case \"fill\":\n                createFillColor.call(self);\n                createFillOpacity.call(self);\n                break;\n            default:\n                break;\n        }\n\n        // couleur du trait\n        function createLineColor () {\n            var linecolor = document.createElement(\"div\");\n            linecolor.className = \"legend-styling-div\";\n            var lLineColor = document.createElement(\"label\");\n            lLineColor.className = \"legend-line\";\n            lLineColor.htmlFor = this.id ? \"line-color-\" + this.id : \"line-color\";\n            lLineColor.innerHTML = this.labels[\"line-color\"];\n            var inputLineColor = document.createElement(\"input\");\n            inputLineColor.className = \"legend-styling\";\n            inputLineColor.id = this.id ? \"line-color-\" + this.id : \"line-color\";\n            inputLineColor.title = \"Selectionner une couleur de trait\";\n            inputLineColor.type = \"color\";\n            inputLineColor.value = params.values.color;\n            inputLineColor.setAttribute(\"data-id\", \"line-color\");\n            if (inputLineColor.addEventListener) {\n                inputLineColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineColor.attachEvent) {\n                inputLineColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linecolor.appendChild(lLineColor);\n            linecolor.appendChild(inputLineColor);\n            container.appendChild(linecolor);\n        }\n\n        // epaisseur du trait\n        function createLineWidth () {\n            var linewidth = document.createElement(\"div\");\n            linewidth.className = \"legend-styling-div\";\n            var lLineWidth = document.createElement(\"label\");\n            lLineWidth.className = \"legend-line\";\n            lLineWidth.htmlFor = this.id ? \"line-width-\" + this.id : \"line-width\";\n            lLineWidth.innerHTML = this.labels[\"line-width\"];\n            var inputLineWidth = document.createElement(\"input\");\n            inputLineWidth.className = \"legend-styling\";\n            inputLineWidth.id = this.id ? \"line-width-\" + this.id : \"line-width\";\n            inputLineWidth.title = params.values.width;\n            inputLineWidth.type = \"range\";\n            inputLineWidth.min = \"0\";\n            inputLineWidth.max = \"10\";\n            inputLineWidth.step = \"1\";\n            inputLineWidth.defaultValue = params.values.width;\n            inputLineWidth.setAttribute(\"data-id\", \"line-width\");\n            if (inputLineWidth.addEventListener) {\n                inputLineWidth.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineWidth.attachEvent) {\n                inputLineWidth.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linewidth.appendChild(lLineWidth);\n            linewidth.appendChild(inputLineWidth);\n            container.appendChild(linewidth);\n        }\n\n        // opacit du trait\n        function createLineOpacity () {\n            var lineopacity = document.createElement(\"div\");\n            lineopacity.className = \"legend-styling-div\";\n            var lLineOpacity = document.createElement(\"label\");\n            lLineOpacity.className = \"legend-line\";\n            lLineOpacity.htmlFor = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            lLineOpacity.innerHTML = this.labels[\"line-opacity\"];\n            var inputLineOpacity = document.createElement(\"input\");\n            inputLineOpacity.className = \"legend-styling\";\n            inputLineOpacity.id = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            inputLineOpacity.title = params.values.opacity;\n            inputLineOpacity.type = \"range\";\n            inputLineOpacity.min = \"0\";\n            inputLineOpacity.max = \"1\";\n            inputLineOpacity.step = \"0.1\";\n            inputLineOpacity.defaultValue = params.values.opacity;\n            inputLineOpacity.setAttribute(\"data-id\", \"line-opacity\");\n            if (inputLineOpacity.addEventListener) {\n                inputLineOpacity.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineOpacity.attachEvent) {\n                inputLineOpacity.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            lineopacity.appendChild(lLineOpacity);\n            lineopacity.appendChild(inputLineOpacity);\n            container.appendChild(lineopacity);\n        }\n\n        // couleur de remplissage\n        function createFillColor () {\n            var fillcolor = document.createElement(\"div\");\n            fillcolor.className = \"legend-styling-div\";\n            var lFillColor = document.createElement(\"label\");\n            lFillColor.className = \"legend-fill\";\n            lFillColor.htmlFor = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            lFillColor.innerHTML = this.labels[\"fill-color\"];\n            var inputFillColor = document.createElement(\"input\");\n            inputFillColor.className = \"legend-styling\";\n            inputFillColor.id = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            inputFillColor.title = \"Selectionner une couleur de remplissage\";\n            inputFillColor.type = \"color\";\n            inputFillColor.value = params.values.color;\n            inputFillColor.setAttribute(\"data-id\", \"fill-color\");\n            if (inputFillColor.addEventListener) {\n                inputFillColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillColor.attachEvent) {\n                inputFillColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillcolor.appendChild(lFillColor);\n            fillcolor.appendChild(inputFillColor);\n            container.appendChild(fillcolor);\n        }\n\n        // opacit du remplissage\n        function createFillOpacity () {\n            var fillopacity = document.createElement(\"div\");\n            fillopacity.className = \"legend-styling-div\";\n            var lFillOpacity = document.createElement(\"label\");\n            lFillOpacity.className = \"legend-fill\";\n            lFillOpacity.htmlFor = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            lFillOpacity.innerHTML = this.labels[\"fill-opacity\"];\n            var inputFillOpacity = document.createElement(\"input\");\n            inputFillOpacity.className = \"legend-styling\";\n            inputFillOpacity.id = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            inputFillOpacity.title = params.values.opacity;\n            inputFillOpacity.type = \"range\";\n            inputFillOpacity.min = \"0\";\n            inputFillOpacity.max = \"1\";\n            inputFillOpacity.step = \"0.1\";\n            inputFillOpacity.defaultValue = params.values.opacity;\n            inputFillOpacity.setAttribute(\"data-id\", \"fill-opacity\");\n            if (inputFillOpacity.addEventListener) {\n                inputFillOpacity.addEventListener(\"change\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillOpacity.attachEvent) {\n                inputFillOpacity.attachEvent(\"onchange\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillopacity.appendChild(lFillOpacity);\n            fillopacity.appendChild(inputFillOpacity);\n            container.appendChild(fillopacity);\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     *\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Is editable\n     *\n     * @returns {Boolean} - true/false\n     */\n    isEditable () {\n        return this.editable;\n    }\n\n    /**\n     * Get container Legend Render (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendRender legend-(line|fill|background|text|icon|circle|unknow)\" style=\"...\"></div>\n     */\n    getRenderContainer () {\n        return this.rendercontainer;\n    }\n\n    /**\n     * Get container Legend Tools (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     */\n    getToolsContainer () {\n        return this.toolscontainer;\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onclickedition\n     */\n    onEditionLegendMapBox (e) {\n        logger.trace(\"onEditionLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onclickedition, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onchangevalue\n     */\n    onChangeValueLegendMapBox (e) {\n        logger.trace(\"onChangeValueLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onchangevalue, e);\n    }\n\n};\n\n// ################################################################### //\n// ########################## CONSTANTES ############################# //\n// ################################################################### //\n\n/**\n * List of supported properties\n */\nLegend.PROPERTIES = {\n    line : [\n        \"line-color\",\n        \"line-dasharray\",\n        \"line-opacity\",\n        \"line-width\"\n    ],\n    fill : [\n        \"fill-color\",\n        \"fill-opacity\",\n        \"fill-outline-color\",\n        \"fill-pattern\"\n    ],\n    background : [\n        \"background-color\",\n        \"background-opacity\",\n        \"background-pattern\"\n    ],\n    circle : [\n        \"circle-color\",\n        \"circle-opacity\",\n        \"circle-stroke-color\",\n        \"circle-stroke-opacity\",\n        \"circle-stroke-width\"\n    ],\n    icon : [\n        \"icon-color\",\n        \"icon-image\",\n        \"icon-opacity\",\n        \"__icon-size\"\n    ],\n    text : [\n        \"__text-anchor\",\n        \"text-color\",\n        \"text-field\",\n        \"__text-font\",\n        \"__text-opacity\",\n        \"__text-size\"\n    ]\n};\n\nexport default Legend;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Legend = Legend;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Style from \"./Style\";\nimport Legend from \"./Legend\";\nimport Filter from \"./Filter\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-layer\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Layer\n * @param {Object} options - options for function call.\n * @example\n *   var layers = new Layer ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          \"visibility\" : true, // afficher l'icone de visibilit\n *          \"icon\" : {\n *              \"image\" : true, // afficher l'icone \"oeil\" (defaut) ou une checkbox\n *              \"anchor\" : \"start\" | \"end\"  // afficher l'icone au debut ou  la fin (defaut)\n *          },\n *          \"type\" : true,       // afficher l'icone du type de geometrie\n *          \"pin\" : true,        // afficher l'icone de puce\n *          \"remove\" : false,    // TODO afficher l'icone de suppression\n *          \"clone\" : false      // TODO afficher l'icone de duplication\n *      },\n *      obj : {\n *          \"id\": \"ocs - vegetation\", // MANDATORY\n *          \"type\": \"fill\", // OPTIONAL\n *          \"source\": \"pyramide_proto\", // OPTIONAL\n *          \"source-layer\": \"ocs_vegetation_surf\" // OPTIONAL\n *      }\n *   });\n *  layers.addLegend(oLegend);\n *  layers.slotLegend();\n *  layers.addStyle(oStyle);\n *  layers.addFilter(oFilter);\n *  layers.add();\n *  layers.active(false);\n *  layers.visibility(false);\n *  layers.display(false);\n *  layers.collapse();\n *  EventBus.addEventListener(\"editor:layer:onclickvisibility\", function (e) {\n *     // e.target.data : options !\n *     // e.target.editorID : id or null\n *   }, this);\n */\nclass Layer {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Layer\", options);\n\n        // options\n        this.options = options || {};\n\n        if (!(this instanceof Layer)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null; // null si le layer n'appartient pas  un editeur !\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            type : true,\n            pin : true,\n            remove : false, // TODO\n            clone : false // TODO\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        var _objDefault = {\n            id : \"\",\n            type : \"\", // icone sur le type de geometrie\n            source : \"\",\n            \"source-layer\" : \"\"\n        };\n\n        if (!this.options.obj) {\n            this.options.obj = _objDefault;\n        }\n\n        Utils.mergeParams(this.options.obj, _objDefault, false);\n\n        // legende intgre\n        this.bSlotLegend = false;\n\n        // obj\n        this.oFilter = null;\n        this.oStyle = null;\n        this.oLegend = null;\n\n        // dom\n        this.container = null;\n        this.DomVisibility = null;\n        this.DomToggle = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLayerTarget\",\n            container : \"GPEditorMapBoxLayerContainer\",\n            containerlegend : \"GPEditorMapBoxLayerLegendContainer\",\n            containertitle : \"GPEditorMapBoxLayerTitleContainer\",\n            imagelabelinput : \"GPEditorMapBoxLayerImageInput\",\n            imagelabel : \"GPEditorMapBoxLayerImageLabel\",\n            typeimg : \"GPEditorMapBoxLayerTypeImage\",\n            titleinput : \"GPEditorMapBoxLayerTitleInput\",\n            titlelabel : \"GPEditorMapBoxLayerTitleLabel\",\n            containertools : \"GPEditorMapBoxToolsContainer\",\n            visibilityinput : \"GPEditorMapBoxToolsVisibilityInput\",\n            visibilitylabel : \"GPEditorMapBoxToolsVisibilityLabel\",\n            visibilityinputdisable : \"GPEditorMapBoxToolsVisibilityInputDisable\",\n            visibilitylabeldisable : \"GPEditorMapBoxToolsVisibilityLabelDisable\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * // >> Titre 1          |OOO| <- menu tools : visibility, clone, remove\n     * // >> Titre 2          |OXX| <- affichage configurable (cf. options.tools)\n     * // Event : clic sur le titre -> ex. affiche le menu des styles / filtres\n     * //       : clic visibility, clone, remove\n     * // DOM :\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-45\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <input id=\"GPEditorMapBoxLayerImageInput-45\" class=\"GPEditorMapBoxLayerImageInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\" for=\"GPEditorMapBoxLayerImageInput-45\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-45\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-45\" title=\"...\">...</label>\n     *          </div>\n     *          <div id=\"GPEditorMapBoxToolsContainer-45\" class=\"GPEditorMapBoxToolsContainer\">\n     *              <input id=\"GPEditorMapBoxToolsVisibilityInput-45\" type=\"checkbox\" class=\"GPEditorMapBoxToolsVisibilityInput\">\n     *              <label for=\"GPEditorMapBoxToolsVisibilityInput-45\" id=\"GPEditorMapBoxToolsVisibilityLabel-45\" class=\"GPEditorMapBoxToolsVisibilityLabel\" title=\"Afficher/masquer la couche\"></label>\n     *          </div>\n     *      </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // title\n        var divTitle = document.createElement(\"div\");\n        divTitle.id = this.name.containertitle + \"-\" + this.options.position;\n        divTitle.className = this.name.containertitle;\n\n        // puce\n        if (this.options.tools.pin) { // Optionnel !\n            // input\n            var inputImage = document.createElement(\"input\");\n            inputImage.id = this.name.imagelabelinput + \"-\" + this.options.position;\n            inputImage.className = this.name.imagelabelinput;\n            inputImage.type = \"checkbox\";\n            divTitle.appendChild(inputImage);\n            // puce\n            var labelImage = document.createElement(\"label\");\n            labelImage.className = this.name.imagelabel;\n            labelImage.htmlFor = inputImage.id;\n            if (labelImage.addEventListener) {\n                labelImage.addEventListener(\"click\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            } else if (labelImage.attachEvent) {\n                labelImage.attachEvent(\"onclick\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            }\n            divTitle.appendChild(labelImage);\n        }\n\n        // tools :\n        // visibility, (remove, clone)\n        var _addTools = function () {\n            var divTools = document.createElement(\"div\");\n            divTools.id = this.name.containertools + \"-\" + this.options.position;\n            divTools.className = this.name.containertools;\n\n            // visibility\n            if (this.options.tools.visibility) {\n                var inputTools = document.createElement(\"input\");\n                inputTools.id = this.name.visibilityinput + \"-\" + this.options.position;\n                inputTools.className = (this.options.tools.icon.image) ? this.name.visibilityinput : this.name.visibilityinputdisable;\n                inputTools.type = \"checkbox\";\n                inputTools.checked = \"checked\"; // par dfaut,  modifier via visibility(true|false) !\n\n                // event for visibility change\n                if (inputTools.addEventListener) {\n                    inputTools.addEventListener(\"click\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                } else if (inputTools.attachEvent) {\n                    // internet explorer\n                    inputTools.attachEvent(\"onclick\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                }\n                divTools.appendChild(inputTools);\n                // enregistrement utile pour la mthode : visibility()\n                this.DomVisibility = inputTools;\n\n                var labelTools = document.createElement(\"label\");\n                labelTools.htmlFor = this.name.visibilityinput + \"-\" + this.options.position;\n                labelTools.id = this.name.visibilitylabel + \"-\" + this.options.position;\n                labelTools.className = (this.options.tools.icon.image) ? this.name.visibilitylabel : this.name.visibilitylabeldisable;\n                labelTools.title = \"Afficher/masquer la couche\";\n                divTools.appendChild(labelTools);\n\n                div.appendChild(divTools);\n            }\n\n            // clone\n            if (this.options.tools.clone) {\n                // TODO...\n                logger.warn(\"Dom for tools clone, it's not yet implemented !\");\n            }\n\n            // remove\n            if (this.options.tools.remove) {\n                // TODO...\n                logger.warn(\"Dom for tools remove, it's not yet implemented !\");\n            }\n        };\n\n        // ajout des outils au debut du composant\n        if (this.options.tools.icon.anchor === \"start\") {\n            _addTools.apply(this);\n        }\n\n        // type\n        if (this.options.tools.type && obj.type) { // Optionnel !\n            var imgType = document.createElement(\"img\");\n            imgType.className = this.name.typeimg;\n            // FIXME il faudrait faire la difference entre :\n            // - icone uniquement : SYMBOL-ICON\n            // - texte uniquement : SYMBOL-TEXT\n            // - les 2 : SYMBOL\n            // Mais il nous faut les styles complets (paint & layout)\n            // pour determiner les 3 types !\n            switch (obj.type.toUpperCase()) {\n                case \"SYMBOL-ICON\": // not used !\n                    imgType.style[\"background-position\"] = \"0px 0\";\n                    break;\n                case \"SYMBOL-TEXT\": // not used !\n                    imgType.style[\"background-position\"] = \"-194px 0\";\n                    break;\n                case \"SYMBOL\":\n                    imgType.style[\"background-position\"] = \"-84px 0\";\n                    break;\n                case \"LINE\":\n                    imgType.style[\"background-position\"] = \"-28px 0\";\n                    break;\n                case \"FILL\":\n                    imgType.style[\"background-position\"] = \"-56px 0\";\n                    break;\n                case \"BACKGROUND\":\n                    imgType.style[\"background-position\"] = \"-140px 0\";\n                    break;\n                case \"CIRCLE\":\n                    imgType.style[\"background-position\"] = \"-168px 0\";\n                    break;\n                default:\n                    // type inconnu ou non pris en charge ou par defaut\n                    imgType.style[\"background-position\"] = \"-112px 0\";\n            }\n            divTitle.appendChild(imgType);\n        }\n\n        // container legend (empty)\n        var divLegend = document.createElement(\"div\");\n        divLegend.id = this.name.containerlegend + \"-\" + this.options.position;\n        divLegend.className = this.name.containerlegend;\n        divTitle.appendChild(divLegend);\n\n        // input\n        var inputTitle = document.createElement(\"input\");\n        inputTitle.id = this.name.titleinput + \"-\" + this.options.position;\n        inputTitle.className = this.name.titleinput;\n        inputTitle.type = \"checkbox\";\n        divTitle.appendChild(inputTitle);\n\n        // label for\n        var labelTitle = document.createElement(\"label\");\n        labelTitle.className = this.name.titlelabel;\n        labelTitle.htmlFor = inputTitle.id;\n        labelTitle.innerHTML = obj[\"id\"] || obj[\"source-layer\"] || obj[\"source\"];\n        labelTitle.title = obj[\"source-layer\"] || obj[\"source\"] || obj[\"id\"];\n        if (labelTitle.addEventListener) {\n            labelTitle.addEventListener(\"click\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        } else if (labelTitle.attachEvent) {\n            labelTitle.attachEvent(\"onclick\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        }\n        divTitle.appendChild(labelTitle);\n        // enregistrement utile pour la mthode : collapse()\n        this.DomToggle = labelTitle;\n\n        div.appendChild(divTitle);\n\n        // ajout des outils au fin du composant\n        if (this.options.tools.icon.anchor === \"end\") {\n            _addTools.apply(this);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Layer instance\n     */\n    add () {\n        logger.trace(\"add()\");\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Add style in the submenu\n     *\n     * @param {Object} style - style object\n     */\n    addStyle (style) {\n        logger.trace(\"addStyle()\", style);\n        if (style && typeof style === \"object\" && style instanceof Style) {\n            this.oStyle = style;\n            this.oStyle.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add filter in the submenu\n     *\n     * @param {Object} filter - filter object\n     */\n    addFilter (filter) {\n        logger.trace(\"addFilter()\", filter);\n        if (filter && typeof filter === \"object\" && filter instanceof Filter) {\n            this.oFilter = filter;\n            this.oFilter.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add Legend in the submenu\n     *\n     * @param {Object} legend - legend object\n     */\n    addLegend (legend) {\n        logger.trace(\"addLegend()\", legend);\n        if (legend && typeof legend === \"object\" && legend instanceof Legend) {\n            this.oLegend = legend;\n            this.oLegend.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Integrate Legend to the layer container\n     */\n    slotLegend () {\n        // cas particulier :\n        // on souhaite intgrer une partie de la legende dans le container du layer.\n        var legend = this.oLegend;\n        if (legend) {\n            // FIXME c'est pourri...\n            var node = null;\n            var nodesLvl1 = this.container.childNodes;\n            if (nodesLvl1.length) {\n                // selon o se situe l'icone de visibilit : au debut ou  la fin...\n                var idx = (this.options.tools.icon.anchor === \"start\") ? 1 : 0;\n                var nodesLvl2 = nodesLvl1[idx].childNodes;\n                // on recherche le container de la legende\n                for (var i = 0; i < nodesLvl2.length; i++) {\n                    var curnode = nodesLvl2[i];\n                    if (curnode.id.indexOf(this.name.containerlegend) !== -1) {\n                        node = curnode;\n                    }\n                }\n            }\n            if (node) {\n                var render = legend.getRenderContainer();\n                if (render) {\n                    node.appendChild(render);\n                    // legende intgre\n                    this.bSlotLegend = true;\n                }\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Set visibility or get\n     *\n     * @param {Boolean} display - set visibility or undefined to get status\n     * @returns {Boolean} - true/false\n     */\n    visibility (display) {\n        logger.trace(\"visibility()\", display);\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        if (typeof display !== \"undefined\") {\n            this.DomVisibility.checked = (display) ? \"checked\" : \"\";\n        }\n        return this.DomVisibility.checked;\n    }\n\n    /**\n    * Collapse a layer panel (event)\n    */\n    collapse () {\n        logger.trace(\"collapse()\");\n        this.DomToggle.click();\n    }\n\n    /**\n    * Click on visibility icon (event)\n    */\n    visible () {\n        logger.trace(\"visible()\");\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        this.DomVisibility.click();\n    }\n\n    /**\n     * Set collapse or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        var checked = document.getElementById(this.DomToggle.htmlFor).checked;\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"inline-flex\" : \"none\";\n            if (this.oStyle) {\n                this.oStyle.display(display && checked);\n            }\n            if (this.oFilter) {\n                this.oFilter.display(display && checked);\n            }\n            if (this.oLegend) {\n                this.oLegend.display(display && checked);\n            }\n        }\n        return checked;\n    }\n\n    /**\n     * Set disabled/enabled status or get\n     *\n     * @param {Boolean} active - disable/enable layer interaction or get status\n     * @returns {Boolean} - true/false\n     */\n    active (active) {\n        logger.trace(\"active()\", active);\n        if (typeof active !== \"undefined\") {\n            this.container.className = (active)\n                ? this.name.container\n                : this.name.container + \" disabled\";\n        }\n        return (this.container.className === this.name.container);\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onClickLayerMapBox (e) {\n        logger.trace(\"onClickLayerMapBox\", e);\n\n        var id = e.target.htmlFor.substring(e.target.htmlFor.indexOf(\"-\"));\n        var checked = document.getElementById(e.target.htmlFor).checked;\n\n        // gestion des inputs\n        if (e.target.htmlFor === this.name.imagelabelinput + id) {\n            document.getElementById(this.name.titleinput + id).checked = !checked;\n        }\n        if (e.target.htmlFor === this.name.titleinput + id) {\n            // si options.pin:false, ce DOM n'existe pas !\n            if (document.getElementById(this.name.imagelabelinput + id)) {\n                document.getElementById(this.name.imagelabelinput + id).checked = !checked;\n            }\n        }\n\n        // ouverture du panneau des styles / filtres\n        if (this.oStyle) {\n            this.oStyle.display(!checked);\n        }\n        if (this.oFilter) {\n            this.oFilter.display(!checked);\n        }\n        // attention,\n        // si la legende est non editable, elle ne se trouve pas dans le sous menu !\n        if (this.oLegend && this.oLegend.isEditable()) {\n            this.oLegend.display(!checked);\n        }\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickvisibility\n     */\n    onVisibilityLayerMapBox (e) {\n        logger.trace(\"onVisibilityLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickvisibility, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickclone\n     */\n    onCloneLayerMapBox (e) {\n        logger.trace(\"onCloneLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickclone, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickremove\n     */\n    onRemoveLayerMapBox (e) {\n        logger.trace(\"onRemoveLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickremove, e);\n    }\n\n};\n\nexport default Layer;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Layer = Layer;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-group\");\n\n/**\n * @classdesc\n *\n * MapBox group management\n *\n * @constructor\n * @alias ol.style.editor.Group\n * @param {Object} options - options for function call.\n * @example\n *   var group = new Group ({\n *      title : \"MyGroup\",\n *      collapse : true, // plier/deplier\n *      target : ...\n *   });\n *   group.add();\n *   group.add();\n */\nclass Group {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Group\", options);\n\n        // options\n        this.options = options || {\n            // default...\n        };\n\n        if (!(this instanceof Group)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.title) {\n            // cf. summary\n            this.options.title = \"Dtails du groupe...\";\n        }\n\n        // plier par defaut\n        if (typeof this.options.collapse === \"undefined\") {\n            this.options.collapse = true;\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxGroupTarget\",\n            container : \"GPEditorMapBoxGroupContainer\",\n            details : \"GPEditorMapBoxGroupDetails\",\n            summary : \"GPEditorMapBoxGroupSummary\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxGroupContainer\">...</div>\n     */\n    _initContainer () {\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // FIXME pas compatible IE !\n        // https://caniuse.com/#search=details\n        // cf. https://css-tricks.com/quick-reminder-that-details-summary-is-the-easiest-way-ever-to-make-an-accordion/\n        var details = document.createElement(\"details\");\n        details.className = this.name.details;\n        details.open = !this.options.collapse;\n        div.appendChild(details);\n\n        var summary = document.createElement(\"summary\");\n        summary.className = this.name.summary;\n        summary.innerHTML = this.options.title;\n        details.appendChild(summary);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"flex\" : \"none\";\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        var nodes = this.container.childNodes;\n        if (nodes.length) {\n            // retourne le noeud \"details\" !\n            return nodes[0];\n        }\n        // sinon le container principal\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * NOT USED !\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Group#editor:group:oncollapse\n     */\n    onCollapseGroupMapBox (e) {\n        logger.trace(\"onCollapseGroupMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.group.oncollapse, e);\n    }\n\n};\n\nexport default Group;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-search\");\n\n/**\n * @classdesc\n *\n * TODO MapBox search management\n *\n * @constructor\n * @alias ol.style.editor.Search\n * @param {Object} options - options for function call.\n * @todo\n * @example\n *   var Search = new Search ({\n *      target : ...,\n *      tools : {\n *          // ...\n *      }\n *      title : \"Filtres de recherche :\",\n *      obj : {}\n *   });\n *  Search.add();\n *  Search.display(true);\n *  Search.getContainer();\n */\nclass Search {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Search\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Search)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {};\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {};\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"Recherche de couches :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxSearchTarget\",\n            container : \"GPEditorMapBoxSearchContainer\"\n            // TODO ...\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxSearchContainer\">\n     *  // ...\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        // var self = this;\n        var _search = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        if (_search.layers) {\n            if (_search.layers.length === 0) {\n                logger.info(\"tag 'layers' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // TODO...\n        // outil de recherche des couches mapbox.\n        // 2 modes de recherches : exact ou par autocompletion\n        // affichage des resultats directement dans la liste des couches\n        // la recherche porte sur les champs suiavnts (options):\n        // * id (par defaut)\n        // * source-layer (par defaut)\n        // * type (ex. Symbol)\n        // * field (ex. HOPITAL_PONC) > recherche dans le champs filtre\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Search instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onsubmit\n     */\n    onSubmitSearchLayersMapBox (e) {\n        logger.trace(\"onSubmitSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onsubmit, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onautocomplete\n     */\n    onAutocompleteSearchLayersMapBox (e) {\n        logger.trace(\"onAutocompleteSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onautocomplete, e);\n    }\n\n};\n\nexport default Search;\n","var EditorDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    }\n};\n\nexport default EditorDOM;\n","// import CSS\nimport \"../../CSS/Controls/Editor/GPFeditor.css\";\n// import \"../../CSS/Controls/Editor/GPFeditorStyle.css\";\n// import library\nimport EventBus from \"eventbusjs\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Style from \"./Style\";\nimport Themes from \"./Themes\";\nimport Filter from \"./Filter\";\nimport Legend from \"./Legend\";\nimport Layer from \"./Layer\";\nimport Group from \"./Group\";\nimport Event from \"./Event\";\nimport Search from \"./Search\";\n\n// DOM\nimport EditorDOM from \"./EditorDOM\";\n\nvar logger = Logger.getLogger(\"editor\");\n\n/**\n * @typedef {Object} EditorOptions\n * @property {string|HTMLElement} [target] - Slecteur ou lment DOM cible pour linsertion de lditeur.\n * @property {string|Object} style - URL du style MapBox ou objet JSON du style.\n * @property {Object} [themes] - Liste des thmes MapBox (voir exemple).\n * @property {Object} [scope] - Contexte dexcution pour les handlers dvnements.\n * @property {Object} [events] - Dictionnaire des handlers dvnements personnaliss.\n * @property {Object} [tools] - Configuration des outils et options daffichage (voir ci-dessous).\n * @property {string|number} [id] - Identifiant unique du widget.\n *\n * @property {boolean|Object} [tools.themes=false] - Afficher/cacher les thmes ou config avance.\n * @property {boolean} [tools.layers=true] - Afficher la liste des couches.\n * @property {boolean} [tools.search=false] - Afficher loutil de recherche de couches.\n * @property {boolean} [tools.style=false] - Afficher ldition des styles.\n * @property {boolean} [tools.filter=false] - Afficher ldition des filtres.\n * @property {boolean} [tools.legend=false] - Afficher ldition des lgendes.\n * @property {boolean} [tools.group=false] - Grouper les couches.\n * @property {boolean} [tools.groupAuto=false] - Construction automatique des groupes.\n * @property {boolean} [tools.sort=true] - Activer le tri des couches.\n * @property {string} [tools.sortBy=\"id\"] - Critre de tri (\"id\", \"class\", \"geom\").\n * @property {string} [tools.sortOrder=\"asc\"] - Ordre de tri (\"asc\", \"desc\").\n * @property {boolean} [tools.title=true] - Afficher les titres des rubriques.\n * @property {boolean|undefined} [tools.collapse] - Afficher/plie les groupes de couches.\n * @property {boolean} [tools.type=true] - Afficher le type de gomtrie.\n * @property {boolean} [tools.pin=true] - Afficher la puce pour chaque couche.\n * @property {boolean} [tools.visibility=true] - Afficher licne de visibilit.\n * @property {Object} [tools.icon] - Configuration de licne de visibilit.\n * @property {boolean} [tools.icon.image=true] - Afficher licne image.\n * @property {string} [tools.icon.anchor=\"end\"] - Position de licne (\"start\" ou \"end\").\n * @property {boolean} [tools.editable=true] - Activer ldition des lgendes.\n */\n\n/**\n * @classdesc\n *\n * Editor Styles MapBox...\n *\n * @alias ol.style.Editor\n * @module Editor\n */\nclass Editor {\n\n    /**\n     * @constructor\n    * @param {EditorOptions} options - options for function call.\n    * @fires editor:layer:onclickvisibility\n    * @fires editor:layer:onclickclone\n    * @fires editor:layer:onclickremove\n    * @fires editor:style:oneditjson\n    * @fires editor:style:scale:onchangemin\n    * @fires editor:style:scale:onchangemax\n    * @fires editor:legend:onclickedition\n    * @fires editor:legend:onchangevalue\n    * @fires editor:filter:oneditjson\n    * @fires editor:themes:onclickimage\n    * @fires editor:themes:onclicktitle\n    * @fires editor:group:oncollapse\n    * @fires editor:onloaded\n    * @example\n    *   var editor = new Editor ({\n    *      target : \"\",\n    *      style : \"data/styles/layer.json\",\n    *      themes: {\n    *          themesSummary : \"\",\n    *          themes : [{\n    *             \"thumbnail\": \"data/images/layer0.png\",\n    *             \"name\": \"standard0\",\n    *             \"url\": \"data/styles/layer0.json\",\n    *             \"description\": \"\",\n    *             \"selected\" : true\n    *          },{\n    *             \"thumbnail\": \"data/images/layer1.png\",\n    *             \"name\": \"standard1\",\n    *             \"url\": \"data/styles/layer1.json\",\n    *             \"description\": \"\"\n    *          }]\n    *      },\n    *      scope : this,\n    *      events : {\n    *          \"editor:layer:onclickvisibility\" : ...,\n    *          \"editor:layer:onclickclone\" : ...,\n    *          \"editor:layer:onclickremove\" : ...,\n    *          \"editor:style:oneditjson\" : ...,\n    *          \"editor:style:scale:onchangemin\" : ...,\n    *          \"editor:style:scale:onchangemax\" : ...,\n    *          \"editor:filter:oneditjson\" : ...,\n    *          \"editor:themes:onclickimage\" : this._onClickEventImageTheme(),\n    *          \"editor:themes:onclicktitle\" : function(e) {...}\n    *      },\n    *      tools : {\n    *          // afficher/cacher les themes (par defaut) ou utiliser les options\n    *          themes : true | false | {\n    *              target : \"...\",\n    *              tools : {\n    *                  \"thumbnails\": true,\n    *                  \"button\": { visible : true, type : \"checkbox\" }\n    *              },\n    *          },\n    *          layers : true | false,     // afficher les couches (layers)\n    *          search : true | false,     // TODO : afficher l'outil de recheche de couches\n    *          style : true | false,      // afficher les styles (sous menu layers)\n    *          filter : true | false,     // afficher les filtres (sous menu layers)\n    *          legend : true | false,     // afficher les legendes (layers)\n    *          group : true | false,      // grouper les couches, l'option 'sort' doit tre active (layers)\n    *          groupAuto : true | false,  // definir la construction automatiques des groupes\n    *          sort : true | false,       // trier les couches (layers)\n    *          sortBy : \"id|class|geom\",  // definir le type de tri (layers)\n    *          sortOrder : \"asc, desc\",   // definir l'ordre de tri (layers)\n    *          title : true | false       // afficher les titres des rubriques,\n    *          collapse : true | false | undefined // afficher et/ou plier les couches ou ne pas afficher l'option,\n    *          type : true | false,       // afficher le type de geometrie (layers)\n    *          pin : true | false,        // afficher la puce pour chaque couche (layers)\n    *          visibility : true | false, // afficher l'icone de visibilit (layers),\n    *          icon : {                   // afficher l'icone \"oeil\" ou \"checkbox\" (layers),\n    *              \"image\" : true,\n    *              \"anchor\" : \"start\" // afficher l'icone au debut ou  la fin de la ligne\n    *          },\n    *          editable : true | false    // active l'edition de la legende (legendes)\n    *      }\n    *   });\n    *   // options par defaut\n    *   {\n    *      themes : false,\n    *      layers : true,\n    *      search : false,\n    *      style : false,\n    *      filter : false,\n    *      legend : false,\n    *      group : false,\n    *      groupAuto : false,\n    *      sort : true,\n    *      sortBy : \"id\",\n    *      sortOrder : \"asc\",\n    *      title : true,\n    *      collapse : undefined,\n    *      type : true,\n    *      pin : true,\n    *      visibility : true,\n    *      icon : {\n    *          image : true,\n    *          anchor : \"end\"\n    *      },\n    *      editable : true\n    *   }\n    *   // Context\n    *   editor.setContext(\"map\", map);\n    *   editor.setContext(\"layer\", layer);\n    *   // create DOM\n    *   editor.createElement()\n    *     .then(() => {\n    *       console.warn(editor.getID());\n    *       console.log(this.getContext(\"map\"));\n    *       console.log(this.getContext(\"layer\"));\n    *     })\n    *     .catch(error => {});\n    *   // possibility to add listeners with globale variable : eventbus\n    *   eventbus.addEventListener(\"editor:style:scale:onchangemin\", function (e) {...});\n     */\n    constructor (options) {\n        logger.trace(\"[constructor] Editor\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Editor)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // gestion des options\n        if (!this.options.target) {\n            logger.info(\"La 'target' n'est pas renseigne (options.target).\");\n        }\n\n        if (!this.options.style) {\n            logger.error(\"Le 'style' MapBox n'est pas renseign (options.style) !\");\n            return;\n        }\n\n        if (this.options.events) {\n            this._initEvents();\n        } else {\n            logger.warn(\"Les 'handlers' ne sont pas renseigns (options.events) !\");\n        }\n\n        if (!this.options.themes) {\n            logger.info(\"Les 'themes' MapBox ne sont pas renseigns (options.themes).\");\n        }\n\n        // options par defaut\n        var _toolsDefault = {\n            themes : false,\n            layers : true,\n            search : false,\n            style : false,\n            filter : false,\n            legend : false,\n            group : false,\n            groupAuto : false,\n            sort : true,\n            sortBy : \"id\",\n            sortOrder : \"asc\",\n            title : true,\n            collapse : undefined,\n            type : true,\n            pin : true,\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            editable : true\n        };\n\n        if (!this.options.tools) {\n            logger.trace(\"Utilisation des outils MapBox par dfaut (options.tools).\");\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        // id unique\n        this.id = this.options.id || ID.generate();\n\n        // context\n        this.context = {};\n        // property layers\n        this.layers = [];\n        // dom container\n        this.container = null;\n        // dom name\n        this.name = {\n            target : \"GPEditorMapBoxTarget\",\n            container : \"GPEditorMapBoxContainer\",\n            containerID : \"GPEditorMapBoxContainer_ID_\",\n            containerLayers : \"GPEditorMapBoxLayersContainer\",\n            titleLayers : \"GPEditorMapBoxLayersTitle\",\n            titleLayersID : \"GPEditorMapBoxLayersTitle_ID_\",\n            titleThemes : \"GPEditorMapBoxThemesTitle\",\n            titleThemesID : \"GPEditorMapBoxThemesTitle_ID_\",\n            sep : \"GPEditorMapBoxSep\"\n        };\n        // style json\n        this.mapbox = {};\n        // INFO\n        // sprites :\n        // {\n        //     url : null,\n        //     size : {\n        //         h : null,\n        //         w : null\n        //     },\n        //     json : {}\n        // }\n        this.sprites = {};\n    }\n\n    /**\n    * Initialize events with handlers\n    * (called by constructor)\n    *\n    * List Events :\n    *          \"editor:layer:visibility\"\n    *          \"editor:layer:clone\"\n    *          \"editor:layer:remove\"\n    *          \"editor:style:edit\"\n    *          \"editor:style:minScale\"\n    *          \"editor:style:maxScale\"\n    *          \"editor:filter:edit\"\n    *          \"editor:themes:image\",\n    *          \"editor:themes:title\"\n    * @private\n    */\n    _initEvents () {\n        var ctx = this.options.scope || this;\n        var events = this.options.events;\n        if (events) {\n            for (var event in events) {\n                if (events.hasOwnProperty(event)) {\n                    var handler = events[event];\n                    // test sur les events disponibles !\n                    if (handler) {\n                        if (!EventBus.hasEventListener(event, handler, ctx)) {\n                            EventBus.addEventListener(event, handler, ctx);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @example\n     *  <div class=\"GPEditorMapBoxContainer\" id=\"GPEditorMapBoxContainer_ID_0\">\n     *    <div id=\"GPEditorMapBoxThemesTitle\" class=\"GPEditorMapBoxThemesTitle\">Liste des 'thmes'</div>\n     *    <div class=\"GPEditorMapBoxThemesContainer\">\n     *      ...\n     *    </div>\n     *    <div id=\"GPEditorMapBoxLayersTitle\" class=\"GPEditorMapBoxLayersTitle\">Liste des 'couches'</div>\n     *    <div class=\"GPEditorMapBoxLayersContainer\">\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-0_1\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-0_1\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-0_1\" title=\"states\">population_lt_2m</label>\n     *          </div>\n     *      </div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *    </div>\n     *  </div>\n     * @private\n     */\n    _initContainer () {\n        logger.trace(this.mapbox);\n\n        // existance d'un autre container (editeur) ?\n        // var _idx = 0;\n        // var elements = document.querySelectorAll(\"div[id^=\" + this.name.containerID + \"]\");\n        // for (var j = 0; j < elements.length; j++) {\n        //     var element = elements[j];\n        //     var num = parseInt(element.id.substring(element.id.lastIndexOf(\"_\") + 1), 10);\n        //     if (num > _idx) {\n        //         _idx = num;\n        //     }\n        // }\n        // if (elements.length) {\n        //     _idx += 1;\n        // }\n        // container principal de l'editeur\n        var div = document.createElement(\"div\");\n        div.id = this.name.containerID + this.id;\n        div.className = this.name.container;\n\n        // Themes\n        var _toolsThemes = this.options.tools.themes;\n        if (_toolsThemes && this.options.themes) {\n            // title\n            if (this.options.tools.title) {\n                var titleThemes = document.createElement(\"div\");\n                titleThemes.id = this.name.titleThemesID + this.id;\n                titleThemes.className = this.name.titleThemes;\n                titleThemes.innerHTML = \"Liste des 'thmes'\";\n                div.appendChild(titleThemes);\n            }\n\n            // lien vers les styles\n            var themes = new Themes({\n                id : this.id,\n                target : div,\n                tools : (typeof _toolsThemes === \"object\") ? _toolsThemes : {},\n                obj : this.options.themes\n            });\n            themes.add();\n        }\n\n        // TODO : Recheche / filtre de couches\n        if (this.options.tools.search) {\n            var search = new Search({\n                id : this.id,\n                target : div,\n                tools : {},\n                obj : this.mapbox.layers // liste des objets layers\n            });\n            search.add();\n        }\n\n        for (var source in this.mapbox.sources) {\n            if (this.mapbox.sources.hasOwnProperty(source)) {\n                if (this.options.tools.layers) {\n                    // multisources ? Si oui, on renseigne un titre...\n                    var multisources = (Object.keys(this.mapbox.sources).length > 1) ? 1 : 0;\n                    if (multisources) {\n                        var hr = document.createElement(\"hr\");\n                        hr.className = this.name.sep;\n                        div.appendChild(hr);\n                    }\n                    // title\n                    if (this.options.tools.title) {\n                        var titleLayers = document.createElement(\"div\");\n                        titleLayers.id = this.name.titleLayersID + this.id;\n                        titleLayers.className = this.name.titleLayers;\n                        titleLayers.innerHTML = (multisources) ? \"Liste des 'couches' (\" + source + \")\" : \"Liste des 'couches'\";\n                        div.appendChild(titleLayers);\n                    }\n                }\n\n                // gestion de l'ordre avant tri avec la metadata 'order'\n                var _layers = this.mapbox.layers.slice(); // clone\n\n                // une fois les layers tris, la metadata:geoportail:order permet\n                // de savoir l'emplacement du layers dans le fichier de style.\n                _layers.forEach(function (layer, order) {\n                    // on carte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // ajout de la metadata d'ordre\n                    var _metadata = layer[\"metadata\"];\n                    if (_metadata) {\n                        _metadata[\"geoportail:order\"] = order;\n                    } else {\n                        layer[\"metadata\"] = {\n                            \"geoportail:order\" : order\n                        };\n                    }\n                });\n                // tri des layers\n                if (this.options.tools.sort) {\n                    var sortBy = this.options.tools.sortBy;\n                    var sortOrder = this.options.tools.sortOrder;\n                    var sortFct = function (a, b) {\n                        // si on utilise les groupements utilisateurs, ils doivent\n                        // tous tre renseigns sinon..., a va coincer !\n                        var result = 0;\n                        if (a[\"metadata\"] &&\n                            a[\"metadata\"][\"geoportail:group\"] &&\n                            b[\"metadata\"] &&\n                            b[\"metadata\"][\"geoportail:group\"]) {\n                            var cmpA = null;\n                            var cmpB = null;\n                            cmpA = a[\"metadata\"][\"geoportail:group\"];\n                            cmpB = b[\"metadata\"][\"geoportail:group\"];\n                            result = cmpA.localeCompare(cmpB);\n                        } else {\n                            switch (sortBy) {\n                                case \"geom\":\n                                    result = sortOrder === \"asc\" ? a.type.localeCompare(b.type) || a.id.localeCompare(b.id)\n                                        : b.type.localeCompare(a.type) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"class\":\n                                    result = sortOrder === \"asc\" ? a[\"source-layer\"].localeCompare(b[\"source-layer\"]) || a.id.localeCompare(b.id)\n                                        : b[\"source-layer\"].localeCompare(a[\"source-layer\"]) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"id\":\n                                default:\n                                    // tri sur l'id par defaut\n                                    result = sortOrder === \"asc\" ? a.id.localeCompare(b.id) : b.id.localeCompare(a.id);\n                                    break;\n                            }\n                        }\n                        return result;\n                    };\n\n                    _layers.sort(sortFct);\n                }\n\n                logger.trace(\"Layers : \", _layers);\n\n                // gestion des groupes avec la metadata de groupe\n                var groupBy = this.options.tools.sortBy; // le mme type de tri que les couches !\n                var groupAuto = this.options.tools.groupAuto;\n                var _groups = {}; // liste et comptage des layers dans chaque groupes\n                _layers.forEach(function (layer) {\n                    // on carte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // balise metadata\n                    var _metadata = layer[\"metadata\"];\n                    // s'il existe dj une meta de groupe, on l'utilise...\n                    // sinon, on la met en place.\n                    if (_metadata && _metadata[\"geoportail:group\"]) {\n                        var _groupName = _metadata[\"geoportail:group\"];\n                        _groups[_groupName] = (_groups[_groupName])\n                            ? _groups[_groupName] + 1 : 1;\n                    } else {\n                        var _field = null;\n                        switch (groupBy) {\n                            case \"class\":\n                                _field = layer[\"source-layer\"];\n                                break;\n                            case \"geom\":\n                                _field = layer.type;\n                                break;\n                            case \"id\":\n                            default:\n                                _field = layer.id;\n                                break;\n                        }\n                        var _newGroupName = _field;\n                        if (groupAuto) {\n                            // separateur\n                            var _regex = /_|-|:|=/; // TODO  definir via une option !\n\n                            // index\n                            var _idx = _field.search(_regex);\n                            // y'a t il un separateur ?\n                            _newGroupName = (_idx !== -1) ? _field.substring(0, _idx).trim() : _field;\n                        }\n                        // on compte le nombre d'entre dans un groupe\n                        _groups[_newGroupName] = (_groups[_newGroupName])\n                            ? _groups[_newGroupName] + 1 : 1;\n\n                        // ajout de la metadata de groupe\n                        if (_metadata) {\n                            _metadata[\"geoportail:group\"] = _newGroupName;\n                        } else {\n                            layer[\"metadata\"] = {\n                                \"geoportail:group\" : _newGroupName\n                            };\n                        }\n                    }\n                });\n\n                logger.trace(\"Groups : \", _groups);\n\n                // container principal des couches\n                var divLayers = document.createElement(\"div\");\n                divLayers.className = this.name.containerLayers;\n                div.appendChild(divLayers);\n\n                var details;\n                if (this.options.tools.collapse !== undefined) {\n                    details = document.createElement(\"details\");\n                    details.className = \"\";\n                    details.open = !this.options.tools.collapse;\n                    divLayers.appendChild(details);\n\n                    var summary = document.createElement(\"summary\");\n                    summary.className = \"\";\n                    summary.innerHTML = \"\";\n                    details.appendChild(summary);\n                }\n\n                // container courant (cf. groupe) pour l'ajout des elements\n                var target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n\n                // Ex. Layers, Styles, Groups et Filtres\n                //  \"id\": \"ocs - vegetation\",\n                //  \"type\": \"fill\",\n                //  \"source\": \"pyramide_proto\",\n                //  \"source-layer\": \"ocs_vegetation_surf\",\n                //  \"metadata\" : {\n                //      \"geoportail:group\": \"ocs\"\n                //  },\n                //  \"layout\": {\n                //    \"visibility\": \"visible\"\n                //  },\n                //  \"filter\": [\"in\",\"symbo\",\n                //      \"SURFACE_D_EAU\",\n                //      \"BASSIN\",\n                //      \"ZONE_MARINE\"\n                //  ],\n                //  \"paint\": {\n                //    \"fill-color\": \"#2BB3E1\"\n                //  }\n                var index = -1;\n                for (var ii = 0; ii < _layers.length; ii++) {\n                    var data = _layers[ii];\n                    index++;\n\n                    // traitement dans l'ordre des sources\n                    if (data.source === source) {\n                        // Groups\n                        // INFO la gestion des groupes est base sur la balise metadata::geoportail:group\n                        // ainsi que sur l'ordre des couches.\n                        // il n'y a pas de regroupement sans tri des couches !\n                        if (this.options.tools.group && this.options.tools.sort) {\n                            var mtd = data.metadata;\n                            // creation du container de groupe\n                            // si le tag metadata existe\n                            if (mtd) {\n                                var grp = data.metadata[\"geoportail:group\"];\n                                if (grp) {\n                                    // le groupe doit contenir plus d'un element\n                                    if (_groups[grp] > 1) {\n                                        // le groupe est dj cr, on en veut plus par la suite...\n                                        _groups[grp] = -1;\n                                        // creation du groupe\n                                        var oGroup = new Group({\n                                            id : this.id,\n                                            target : (this.options.tools.collapse !== undefined) ? details : divLayers,\n                                            title : grp,\n                                            collapse : true\n                                        });\n                                        oGroup.add();\n                                        // le nouveau container pour les elements suivants\n                                        target = oGroup.getContainer();\n                                    } else if (_groups[grp] === 1) {\n                                        // l'element est seul, donc pas d'ajout dans le\n                                        // groupe en cours\n                                        target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                    } else {\n                                        // on ajoute l'element dans le groupe courant...\n                                    }\n                                } else {\n                                    target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                }\n                            } else {\n                                target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                            }\n                        }\n                        // Layers\n                        if (this.options.tools.layers) {\n                            var oLayer = new Layer({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !\n                                tools : {\n                                    visibility : this.options.tools.visibility,\n                                    icon : this.options.tools.icon,\n                                    type : this.options.tools.type,\n                                    pin : this.options.tools.pin\n                                },\n                                obj : {\n                                    id : data.id,\n                                    type : data.type,\n                                    source : data.source,\n                                    \"source-layer\" : data[\"source-layer\"]\n                                }\n                            });\n                            oLayer.add();\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                            // sauvegarde des layers\n                            this.layers.push(oLayer);\n                        }\n                        // Legende\n                        if (this.options.tools.legend) {\n                            // gestion de l'edition de la legende :\n                            // l'option \"editable\" est prioritaire sur le tag \"editable\" du fichier de style !\n                            var isEditable = this.options.tools.editable;\n                            if (typeof isEditable === \"undefined\") {\n                                isEditable = data.editable;\n                            }\n                            var oLegend = new Legend({\n                                id : this.id,\n                                target : target,\n                                sprites : this.sprites,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    title : data.id,\n                                    editable : (typeof isEditable !== \"undefined\") ? isEditable : false,\n                                    paint : data.paint,\n                                    layout : data.layout\n                                }\n                            });\n                            oLegend.add();\n                            oLegend.display(false);\n                            if (oLayer) {\n                                oLayer.addLegend(oLegend);\n                                oLayer.slotLegend(); // integration de la legende dans le container du layers !\n                            }\n                        }\n                        // Style\n                        if (this.options.tools.style) {\n                            var oStyle = new Style({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    layout : data.layout,\n                                    paint : data.paint\n                                }\n                            });\n                            oStyle.add();\n                            oStyle.display(false);\n                            if (oLayer) {\n                                oLayer.addStyle(oStyle);\n                            }\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                        }\n                        // Filter\n                        if (this.options.tools.filter) {\n                            var oFilter = new Filter({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    filter : data.Filter\n                                }\n                            });\n                            oFilter.add();\n                            oFilter.display(false);\n                            if (oLayer) {\n                                oLayer.addFilter(oFilter);\n                            }\n                        }\n                    } else {\n                        // on ecarte un layer car il n'est pas reconnu dans la source\n                        // on decremente la position du layer\n                        if (index >= 0) {\n                            index--;\n                        }\n                    }\n                }\n            }\n        }\n\n        // sauvegarde\n        this.container = div;\n\n        // container principal\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var _target = document.createElement(\"div\");\n                _target.id = this.name.target;\n                var node = document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0] ||\n                    document.documentElement;\n                node.appendChild(_target);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        // dispatch event\n        EventBus.dispatch(Event.onloaded, this);\n    }\n\n    /**\n     * Getting Sprites informations\n     * (called by _initialize)\n     *\n     * @param {String} sprites - url des sprites\n     * @returns {Promise} - promise\n     * @private\n     */\n    _getSprites (sprites) {\n        var self = this;\n\n        // on ne doit pas mettre de promise en chec...\n        // car on souhaite continuer le traitement mme si on n'a pas de sprites !\n        // si le protocole est mapbox://\n        if (sprites && sprites.startsWith(\"mapbox://\")) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Protocole mapbox:// non gr !\");\n                resolve(self);\n            });\n        }\n        // si pas de sprites\n        if (!sprites) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Auncun sprites disponibles !\");\n                resolve(self);\n            });\n        }\n\n        var fetchSpritesImage = function () {\n            var spritesImage = sprites + \".png\";\n            return fetch(spritesImage, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.blob()\n                            .then(function (blob) {\n                                self.sprites.url = spritesImage;\n                                // decode de l'image\n                                var theImage = new Image();\n                                theImage.src = spritesImage;\n                                return theImage.decode()\n                                    .then(function () {\n                                        self.sprites.size = {};\n                                        self.sprites.size.h = theImage.height;\n                                        self.sprites.size.w = theImage.width;\n                                    });\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch image sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch image sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n        var fetchSpritesJson = function () {\n            var spritesJson = sprites + \".json\";\n            return fetch(spritesJson, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.json()\n                            .then(function (json) {\n                                self.sprites.json = json;\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch json sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch json sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n\n        // promise\n        return Promise.all([\n            fetchSpritesImage(),\n            fetchSpritesJson()\n        ]);\n    }\n\n    // ################################################################### //\n    // ########################## INTERFACE ############################## //\n    // ################################################################### //\n    /**\n     * Create Editor\n     *\n     * @returns {Promise} - promise\n     */\n    createElement () {\n        var self = this;\n        // objet json\n        if (typeof this.options.style === \"object\") {\n            this.mapbox = this.options.style;\n            // les sprites sont utiles que si on veut une legende !\n            if (this.options.tools.legend) {\n                return this._getSprites(this.mapbox.sprite)\n                    .then(function () {\n                        // init du DOM\n                        self._initContainer();\n                        return self;\n                    })\n                    .catch(error => {\n                        logger.warn(\"fetch sprites exception :\", error);\n                    });\n            } else {\n                return new Promise((resolve, reject) => {\n                    self._initContainer();\n                    resolve(self);\n                });\n            }\n        }\n\n        // url\n        if (typeof this.options.style === \"string\") {\n            return fetch(this.options.style, {\n                credentials : \"same-origin\"\n            })\n                .then(response => {\n                    // sauvegarde du json\n                    return response.json()\n                        .then(style => {\n                            self.mapbox = style;\n                        })\n                        .then(function () {\n                            // les sprites sont utiles que si on veut une legende !\n                            if (self.options.tools.legend) {\n                                return self._getSprites(self.mapbox.sprite)\n                                    .then(function () {\n                                        // init du DOM\n                                        self._initContainer();\n                                        return self;\n                                    })\n                                    .catch(error => {\n                                        logger.warn(\"fetch sprites exception :\", error);\n                                    });\n                            } else {\n                                return new Promise((resolve, reject) => {\n                                    self._initContainer();\n                                    resolve(self);\n                                });\n                            }\n                        })\n                        .catch(error => {\n                            logger.error(\"json exception :\", error);\n                        });\n                })\n                .catch(error => {\n                    logger.error(\"fetch exception :\", error);\n                });\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"block\" : \"none\";\n    }\n\n    setContext (key, value) {\n        this.context[key] = value;\n    }\n\n    getContext (key) {\n        return this.context[key];\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Get id editor\n     * @returns {Number} id\n     */\n    getID () {\n        return this.id;\n    }\n\n    /**\n     * Get container (DOM)\n     * @returns {HTMLElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    /**\n     * Get Style (json)\n     * @returns {Object} Style MapBox\n     */\n    getStyle () {\n        return this.mapbox;\n    }\n\n    /**\n     * Get layer style (json)\n     * @param {Number} i - index\n     * @returns {Object} Style MapBox of a layers\n     */\n    getStyleLayer (i) {\n        var layer = null;\n        var o = this.getLayer(i);\n        var id = o.options.obj.id;\n        for (var k = 0; k < this.mapbox.layers.length; k++) {\n            var l = this.mapbox.layers[k];\n            if (l.id === id) {\n                layer = l;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get layer object from json style\n     * @param {Number} i - index into style json\n     * @returns {Object} Style MapBox of a layers\n     */\n    getLayerFromStyle (i) {\n        var layer = null;\n        var l = this.mapbox.layers[i];\n        for (var k = 0; k < this.getLayers().length; k++) {\n            var o = this.getLayer(k);\n            if (l.id === o.options.obj.id) {\n                layer = o;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get a list of layer object sorted or not (see options.tools.sort)\n     * @returns {Array} - List of layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayers () {\n        return this.layers;\n    }\n\n    /**\n     * Get the layer object from a list sorted or not (see options.tools.sort)\n     * @param {Number} i - index\n     * @returns {Object} - layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayer (i) {\n        return this.layers[i];\n    }\n\n};\n\n// on rcupre les mthodes de la classe DOM\nUtils.assign(Editor.prototype, EditorDOM);\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\nexport default Editor;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    window.ol.style.Editor = Editor;\n}\n"],"names":["uidCounter_","detectSupport","isDesktop","userAgent","window","navigator","toLowerCase","indexOf","assign","dest","source","prop","hasOwnProperty","mergeParams","replace","param","_typeof","this","getUid","prefix","obj","id","noop","undefinedType","isIE","test","logMethods","_loggersByName","defaultLogger","bindMethod","methodName","method","bind","Function","prototype","call","e","apply","arguments","traceForIE","console","log","trace","realMethod","undefined","replaceLoggingMethods","level","getLevel","i","length","methodFactory","name","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","Logger","factory","inheritedLevel","defaultLevel","userLevel","self","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","location","exec","slice","clearPersistedLevel","removeItem","normalizeLevel","input","TypeError","setLevel","persist","setDefaultLevel","resetLevel","enableAll","TRACE","disableAll","rebuild","childName","initialLevel","getLogger","logger","_log","noConflict","getLoggers","EventBusClass","module","exports","listeners","addEventListener","type","callback","scope","args","numOfArgs","push","splice","removeEventListener","numOfCallbacks","newArray","listener","hasEventListener","dispatch","target","event","concat","concatArgs","getEvents","str","className","hex","number","Error","Number","toString","num","hexa","parseInt","arrayToRgba","values","Array","isArray","red","green","blue","alpha","parseFloat","arrayToHex","elems","result","join","opacity","rgbaToHex","rgba","parsed","hexToRgba","m","r","g","b","rgb","isHex","value","charAt","isRGB","LoggerByDefault","process","VERBOSE","env","Log","logname","loggers","key","Object","Gp","timestamp","generate","Math","floor","Date","now","lastIndexOf","substring","index","uuid","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","onloaded","layer","onclickvisibility","onclickclone","onclickremove","legend","onclickedition","onchangevalue","group","oncollapse","style","oneditjson","scale","onchangemin","onchangemax","filter","themes","onclickimage","onclicktitle","search","onsubmit","onautocomplete","Style","options","_classCallCheck","position","tools","title","_initialize","_initContainer","_toolsDefault","edition","Utils","paint","layout","container","containerjson","jsonlabel","jsondisplay","containertoolsscale","scaletitle","containertoolsminscale","scalelabelmin","scaleinputmin","containertoolsmaxscale","scalelabelmax","scaleinputmax","containertoolsedit","_found","_obj","JSON","parse","stringify","_style","keys","info","visibility","div","createElement","json","strJson","_syntaxHighlight","divJson","label","innerHTML","appendChild","pre","onEditJsonStyleMapBox","attachEvent","_createElementToolsScale","min","minzoom","max","maxzoom","_createElementToolsEdition","divToolsScale","divMin","labelMin","inputMin","disabled","data","onChangeStyleScaleMinMapBox","divMax","labelMax","inputMax","onChangeStyleScaleMaxMapBox","warn","divToolsEdit","match","cls","getElementById","documentElement","getElementsByTagName","display","editorID","EventBus","EventEditor","ol","editor","Themes","thumbnails","button","visible","themesSummary","containertheme","containerthemeID","inputID","labelID","image","imageID","message","ID","_lstThemes","_theme","divTheme","tabIndex","_url","url","_selected","selected","_type","_button","checked","onClickThemeTitleMapBox","thumbnail","_img","src","alt","description","onClickThemeImageMapBox","nodes","parentElement","childNodes","node","tagName","_label","htmlFor","_msg","targetIDX","previousSibling","_inputs","getElementsByClassName","el","Filter","_filter","labelJson","preJson","onEditJsonFilterMapBox","divEdit","Legend","sprites","editable","_editable","legendRender","width","stroke","color","rendercontainer","toolscontainer","containerlegendrender","legendrender","legendeditable","legendtitle","containerlegendtools","labels","params","bFound","split","_getProperties","edit","_createElementIconLegend","_createElementEditionLegend","isTextValue","isIconValue","valuesSupported","val","PROPERTIES","includes","_getValue","k","svg","Color","x","y","height","size","w","h","lstrockedasharray","cstrockcolor","pattern","fstrokecolor","isNumber","forEach","v","stops","sort","numA","numB","onEditionLegendMapBox","_renderThumbnail","span","linecolor","lLineColor","inputLineColor","setAttribute","onChangeValueLegendMapBox","linewidth","lLineWidth","inputLineWidth","step","defaultValue","lineopacity","lLineOpacity","inputLineOpacity","fillcolor","lFillColor","inputFillColor","fillopacity","lFillOpacity","inputFillOpacity","line","fill","background","circle","icon","text","Layer","anchor","pin","remove","clone","_objDefault","bSlotLegend","oFilter","oStyle","oLegend","DomVisibility","DomToggle","containerlegend","containertitle","imagelabelinput","imagelabel","typeimg","titleinput","titlelabel","containertools","visibilityinput","visibilitylabel","visibilityinputdisable","visibilitylabeldisable","divTitle","inputImage","labelImage","onClickLayerMapBox","_addTools","divTools","inputTools","onVisibilityLayerMapBox","labelTools","imgType","divLegend","inputTitle","labelTitle","nodesLvl1","nodesLvl2","curnode","render","getRenderContainer","click","active","isEditable","Group","collapse","details","summary","open","Search","_search","layers","_addUID","_uid","Editor","events","_initEvents","groupAuto","sortBy","sortOrder","context","containerID","containerLayers","titleLayers","titleLayersID","titleThemes","titleThemesID","sep","mapbox","error","ctx","handler","_toolsThemes","add","sources","multisources","hr","_layers","order","_metadata","sortFct","cmpB","cmpA","localeCompare","groupBy","_groups","_groupName","_field","_newGroupName","_idx","trim","divLayers","ii","metadata","grp","oGroup","getContainer","oLayer","addLegend","slotLegend","addStyle","addFilter","_target","Event","spritesImage","startsWith","Promise","resolve","reject","all","fetch","credentials","then","response","ok","blob","theImage","Image","decode","status","_getSprites","sprite","getLayer","l","getLayers","EditorDOM"],"ignoreList":[],"sourceRoot":""}