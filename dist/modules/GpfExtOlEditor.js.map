{"version":3,"file":"GpfExtOlEditor.js","mappings":"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","sources":["webpack://geopf-extensions-openlayers/./src/packages/Utils/ColorUtils.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/Helper.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/LoggerByDefault.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/SelectorID.js","webpack://geopf-extensions-openlayers/./node_modules/eventbusjs/lib/eventbus.min.js","webpack://geopf-extensions-openlayers/./node_modules/loglevel/lib/loglevel.js","webpack://geopf-extensions-openlayers/webpack/bootstrap","webpack://geopf-extensions-openlayers/webpack/runtime/compat get default export","webpack://geopf-extensions-openlayers/webpack/runtime/define property getters","webpack://geopf-extensions-openlayers/webpack/runtime/hasOwnProperty shorthand","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Event.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Style.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Themes.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Filter.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Legend.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Layer.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Group.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Search.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/EditorDOM.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Editor/Editor.js"],"sourcesContent":["/**\n * @module ColorUtils\n * @alias module:~utils/ColorUtils\n * @description\n * ...\n *\n * @example\n * import ColorUtils from \"gpf-ext-ol/utils/ColorUtils\"\n * ou \n * import {ColorUtils} from \"gpf-ext-ol\n * \n * ColorUtils.hex();\n * ColorUtils.num();\n * ColorUtils.arrayTorgba();\n * ColorUtils.arrayToHex();\n * ColorUtils.rgbaToHex();\n * ColorUtils.hexToRgba();\n * ColorUtils.isHex();\n * ColorUtils.isRGB();\n */\nvar ColorUtils = {\n\n    /**\n     * Number to hex conversion\n     *\n     * @param {Number} number - 0-255\n     * @returns {String} hex value\n     */\n    hex : function (number) {\n        if (number > 255) {\n            throw new Error(\"'\" + number + \"'' is greater than 255(0xff);\");\n        }\n        var str = Number(number).toString(16);\n        return (\"0\" + str).slice(-2);\n    },\n\n    /**\n     * Hexa to number conversion\n     *\n     * @param {*} hexa 00-FF\n     * @returns {Number} number value\n     */\n    num : function (hexa) {\n        return parseInt(hexa, 16);\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to rgba string\n     *\n     * @function arrayToRgba\n     * @param {Array} values - array of values\n     * @returns {String} A color of RGB or RGBA format\n     */\n    arrayToRgba : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3] || 1;\n        var result = \"rgba(\" + red + \", \" + green + \", \" + blue + \", \" + parseFloat(alpha) + \")\";\n        return result;\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to #RRGGBBAA\n     *\n     * @function arrayToHex\n     * @param {Array} values - array of values\n     * @returns {Object}  hex and opacity formated values\n     */\n    arrayToHex : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts rgba string to #RRGGBBAA\n     * (Code adapted from : https://gist.github.com/mstssk/afda4ce9e5c335fd79cd)\n     *\n     * @function rgbaToHex\n     * @param {String} rgba - A color of RGB or RGBA format.\n     * @returns {Object} hex and opacity formated values\n     */\n    rgbaToHex : function (rgba) {\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(rgba);\n        if (!parsed) {\n            throw new Error(\"Invalid format: \" + rgba);\n        }\n        var red = parsed[1];\n        var green = parsed[2];\n        var blue = parsed[3];\n        var alpha = parsed[4];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts hex color and opacity value to rgba string.\n     * (Code adapted from : http://stackoverflow.com/a/5624139)\n     *\n     * @function hexToRgba\n     * @param {String} hex - A color value on RGB format (hexa).\n     * @param {Number} opacity - A opacity value.\n     * @returns {String} A color of RGB or RGBA format\n     */\n    hexToRgba : function (hex, opacity) {\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        if (!hex) {\n            throw new Error(\"Invalid format\");\n        }\n        hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        rgb = rgb ? {\n            r : parseInt(rgb[1], 16),\n            g : parseInt(rgb[2], 16),\n            b : parseInt(rgb[3], 16)\n        } : null;\n        var result = rgb ? \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + opacity + \")\" : null;\n        return result;\n    },\n\n    /**\n     * Determine if value is a correct hexa color.\n     * @param {*} value - hex color (#FFFFFF)\n     * @returns {Boolean} True if value is a hexa color\n     */\n    isHex : function (value) {\n        if (!value) {\n            return false;\n        }\n        if (value.charAt(0) !== \"#\") {\n            return false;\n        }\n        var regex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Determine if value is a correct rgba color.\n     * @param {*} value - rgba color (rgba(125,125,125,1))\n     * @returns {Boolean} True if value is a rgba color\n     */\n    isRGB : function (value) {\n        if (!value) {\n            return false;\n        }\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    }\n};\n\nexport default ColorUtils;\n","/**\n* @module Helper\n* @alias module:~utils/HelperUtils\n* @description\n* ...\n*\n* @example\n* import HelperUtils from \"gpf-ext-ol/utils/HelperUtils\"\n* ou \n* import {HelperUtils} from \"gpf-ext-ol\n* \n* HelperUtils.detectSupport();\n* HelperUtils.assign();\n* HelperUtils.mergeParams();\n*/\nvar Helper = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @function detectSupport\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport : function () {\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @function assign\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign : function (dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @function mergeParams\n     * @param {Object} dest     - destination object where properties and method will be merge\n     * @param {Object} source   - source object from which properties and method will be merge\n     * @param {Boolean} replace - replace destination value by source if exists or not (true by default)\n     */\n    mergeParams : function (dest, source, replace) {\n        if (typeof dest === \"undefined\" || typeof source === \"undefined\") {\n            return;\n        }\n        if (typeof replace === \"undefined\") {\n            replace = true;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param], replace);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    if (dest.hasOwnProperty(param)) {\n                        if (replace) {\n                            dest[param] = source[param];\n                        }\n                    } else {\n                        dest[param] = source[param];\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport default Helper;\n","import * as Log from \"loglevel\";\n\n/**\n * @module LoggerByDefault\n * @alias module:~utils/Logger\n * @description\n * ...\n *\n * @example\n * import Logger from \"gpf-ext-ol/utils/LoggerByDefault\"\n * ou \n * import {Logger} from \"gpf-ext-ol\n * \n * Logger.getLogger();\n * Logger.disableAll();\n * Logger.enableAll();\n */\nvar LoggerByDefault = {\n    /**\n     * creation d'un logger statique\n     *\n     * @function getLogger\n     * @param {String} [name=\"default\"] - the logger name\n     * @returns {Object} logger\n     */\n    getLogger : function (name) {\n        // on définit process si non défini dans l'environnement\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    },\n    /**\n     * desactive tous les loggers\n     * @function disableAll\n     */\n    disableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.disableAll();\n            }\n        }\n    },\n    /**\n     * active tous les loggers\n     * @function enableAll\n     */\n    enableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.enableAll();\n            }\n        }\n    }\n};\n\nexport default LoggerByDefault;\n","/**\n * @module SelectorID\n * @alias module:~utils/SelectorID\n * @private\n * @description\n * formalisme d'un tag ID :\n * -> NAME(_ORDER)-1460636385836\n *\n * @example\n * Ex.\n *   GProutePoints-1460636385836\n *   GProutePoint_10-1460636385836\n */\nvar SelectorID = {\n\n    /**\n     * Construction d'un identifiant statique basé sur le timestamp,\n     * et qui s'incremente de +1 à chaque appel\n     * @function generate\n     */\n    generate : (function () {\n        var timestamp = Math.floor(Date.now());\n        return function () {\n            return timestamp++;\n        };\n    })(),\n\n    /**\n     * nom du tag\n     * @function name\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    name : function (id) {\n        var name = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i === -1) {\n            name = id;\n        } else {\n            name = id.substring(0, i);\n        }\n\n        return name;\n    },\n\n    /**\n     * numero d'identifiant du tag\n     *\n     * @function index\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    index : function (id) {\n        var index = null;\n\n        var name = this.name(id);\n        // if (name !== id) {\n        var i = name.lastIndexOf(\"_\");\n        if (i !== -1) {\n            index = name.substring(i + 1);\n        }\n        // }\n\n        return index;\n    },\n\n    /**\n     * uuid du tag\n     *\n     * @function uuid\n     * @param {String} id - the id\n     * @returns {String} uuid\n     */\n    uuid : function (id) {\n        var uuid = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i !== -1) {\n            uuid = parseInt(id.substring(i + 1), 10);\n        }\n\n        return uuid;\n    }\n\n};\n\nexport default SelectorID;\n","(function(root,factory){if(typeof exports===\"object\"&&typeof module===\"object\")module.exports=factory();else if(typeof define===\"function\"&&define.amd)define(\"EventBus\",[],factory);else if(typeof exports===\"object\")exports[\"EventBus\"]=factory();else root[\"EventBus\"]=factory()})(this,function(){var EventBusClass={};EventBusClass=function(){this.listeners={}};EventBusClass.prototype={addEventListener:function(type,callback,scope){var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>3?args.splice(3,args.length-1):[];if(typeof this.listeners[type]!=\"undefined\"){this.listeners[type].push({scope:scope,callback:callback,args:args})}else{this.listeners[type]=[{scope:scope,callback:callback,args:args}]}},removeEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;var newArray=[];for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if(listener.scope==scope&&listener.callback==callback){}else{newArray.push(listener)}}this.listeners[type]=newArray}},hasEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;if(callback===undefined&&scope===undefined){return numOfCallbacks>0}for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if((scope?listener.scope==scope:true)&&listener.callback==callback){return true}}}return false},dispatch:function(type,target){var event={type:type,target:target};var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>2?args.splice(2,args.length-1):[];args=[event].concat(args);if(typeof this.listeners[type]!=\"undefined\"){var listeners=this.listeners[type].slice();var numOfCallbacks=listeners.length;for(var i=0;i<numOfCallbacks;i++){var listener=listeners[i];if(listener&&listener.callback){var concatArgs=args.concat(listener.args);listener.callback.apply(listener.scope,concatArgs)}}}},getEvents:function(){var str=\"\";for(var type in this.listeners){var numOfCallbacks=this.listeners[type].length;for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];str+=listener.scope&&listener.scope.className?listener.scope.className:\"anonymous\";str+=\" listen for '\"+type+\"'\\n\"}}return str}};var EventBus=new EventBusClass;return EventBus});","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n* managing events\n*\n* See {@link http://krasimirtsonev.com/blog/article/javascript-managing-events-dispatch-listen}\n* See {@link https://github.com/krasimir/EventBus}\n*\n* @property {Event} \"editor:layer:onclickvisibility\" - event ...\n* @property {Event} \"editor:layer:onclickclone\" - event ...\n* @property {Event} \"editor:layer:onclickremove\" - event ...\n* @property {Event} \"editor:style:oneditjson\" - event ...\n* @property {Event} \"editor:style:scale:onchangemin\" - event ...\n* @property {Event} \"editor:style:scale:onchangemax\" - event ...\n* @property {Event} \"editor:legend:onclickedition\" - event ...\n* @property {Event} \"editor:legend:onchangevalue\" - event ...\n* @property {Event} \"editor:filter:oneditjson\" - event ...\n* @property {Event} \"editor:themes:onclickimage\" - event ...\n* @property {Event} \"editor:themes:onclicktitle\" - event ...\n* @property {Event} \"editor:search:onsubmit\" - event ...\n* @property {Event} \"editor:search:onautocomplete\" - event ...\n* @property {Event} \"editor:group:oncollapse\" - event ...\n* @property {Event} \"editor:onloaded\" - event ...\n*\n* @mixin\n*\n* @example\n* // dispatch event\n* EventBus.dispatch(EventEditor.layer.visibility, e);\n* // listener\n* EventBus.addEventListener(EventEditor.layer.visibility, function (e) {...}, this);\n*/\nvar EventEditor = {\n    /** evenement sur la fin de chargement de l'editeur */\n    onloaded : \"editor:onloaded\",\n    layer : {\n        /** evenement sur la visibilité : clic sur le bouton 'oeil' */\n        onclickvisibility : \"editor:layer:onclickvisibility\",\n        /** evenement sur la duplication : clic sur le bouton\n        (not yet implemented !) */\n        onclickclone : \"editor:layer:onclickclone\",\n        /** evenement sur la suppression : clic sur le bouton\n        (not yet implemented !) */\n        onclickremove : \"editor:layer:onclickremove\"\n    },\n    legend : {\n        /** evenement sur l'affichage du mode edition */\n        onclickedition : \"editor:legend:onclickedition\",\n        /** evenement sur la modification d'une valeur */\n        onchangevalue : \"editor:legend:onchangevalue\"\n    },\n    group : {\n        /**  evenement pour deplier/plier le groupe\n        (not yet implemented !) */\n        oncollapse : \"editor:group:oncollapse\"\n    },\n    style : {\n        /** evenement sur l'édition du style\n        (not yet implemented !) */\n        oneditjson : \"editor:style:oneditjson\",\n        /** evenement sur la modification de l'echelle d'affichage */\n        scale : {\n            onchangemin : \"editor:style:scale:onchangemin\",\n            onchangemax : \"editor:style:scale:onchangemax\"\n        }\n    },\n    filter : {\n        /** evenement sur l'édition du filtre\n        (not yet implemented !) */\n        oneditjson : \"editor:filter:oneditjson\"\n    },\n    themes : {\n        /** evenement sur le clic de l'image */\n        onclickimage : \"editor:themes:onclickimage\",\n        /** evenement sur le clic du titre */\n        onclicktitle : \"editor:themes:onclicktitle\"\n    },\n    search : {\n        /** evenement sur la recherche */\n        onsubmit : \"editor:search:onsubmit\",\n        onautocomplete : \"editor:search:onautocomplete\"\n    }\n};\n\nexport default EventEditor;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-style\");\n\n/**\n * @classdesc\n *\n * MapBox styles management\n *\n * @constructor\n * @alias ol.style.editor.Style\n * @param {Object} options - options for function call.\n * @example\n *   var style = new Style ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false,\n *          scale : true\n *      },\n *      title : \"Styles (JSON)\",\n *      obj : {\n *          paint : {},\n *          layout : {}\n *      }\n *   });\n *  style.add();\n *  style.display(true);\n *  style.getContainer();\n */\nclass Style {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Style\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Style)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            scale : true,\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                paint : {},\n                layout : {}\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Styles :\";\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxStyleTarget\",\n            container : \"GPEditorMapBoxStyleContainer\",\n            containerjson : \"GPEditorMapBoxStyleJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxStyleJsonTitle\",\n            jsondisplay : \"GPEditorMapBoxStyleJsonDisplay\",\n            containertoolsscale : \"GPEditorMapBoxStyleToolsScaleContainer\",\n            scaletitle : \"GPEditorMapBoxStyleScaleTitle\",\n            containertoolsminscale : \"GPEditorMapBoxStyleToolsScaleMinContainer\",\n            scalelabelmin : \"GPEditorMapBoxStyleScaleLabelMin\",\n            scaleinputmin : \"GPEditorMapBoxStyleScaleInputMin\",\n            containertoolsmaxscale : \"GPEditorMapBoxStyleToolsScaleMaxContainer\",\n            scalelabelmax : \"GPEditorMapBoxStyleScaleLabelMax\",\n            scaleinputmax : \"GPEditorMapBoxStyleScaleInputMax\",\n            containertoolsedit : \"GPEditorMapBoxStyleToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * ie. this.container\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxStyleContainer\">\n     *   <div class =\"GPEditorMapBoxStyleJsonContainer\">\n     *      <label class=\"GPEditorMapBoxStyleJsonTitle\">JSON Styles :</label>\n     *      <pre class=\"GPEditorMapBoxStyleJsonDisplay\">...</pre>\n     *   </div>\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     *   <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _obj = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n        var _style = {};\n\n        // styles into tag 'paint' ?\n        if (_obj.paint) {\n            _found = true;\n            _style.paint = _obj.paint;\n            if (Object.keys(_obj.paint).length === 0) {\n                logger.info(\"tag 'paint' is empty !\");\n            }\n        }\n\n        // if not, search into tag 'layout' !\n        if (_obj.layout) {\n            _found = true;\n            _style.layout = _obj.layout;\n            // FIXME delete visibility from display ?\n            if (_obj.layout.visibility) {\n                delete _style.visibility;\n            }\n            if (Object.keys(_obj.layout).length === 0) {\n                logger.info(\"tag 'layout' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            var strJson = JSON.stringify(_style, null, 4);\n            json = this._syntaxHighlight(strJson);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var label = document.createElement(\"label\");\n        label.className = this.name.jsonlabel;\n        label.innerHTML = this.options.title;\n        divJson.appendChild(label);\n\n        var pre = document.createElement(\"pre\");\n        pre.className = this.name.jsondisplay;\n        pre.innerHTML = json;\n        if (pre.addEventListener) {\n            pre.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        } else if (pre.attachEvent) {\n            pre.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(pre);\n        div.appendChild(divJson);\n\n        // scale\n        if (this.options.tools.scale) {\n            div.appendChild(this._createElementToolsScale({\n                min : (_style.layout) ? _style.layout.minzoom : 0,\n                max : (_style.layout) ? _style.layout.maxzoom : 21\n            }));\n        }\n\n        // TODO menu d'edition\n        if (this.options.tools.edition) {\n            div.appendChild(this._createElementToolsEdition());\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    /**\n     * Graphical rendering of the scale tools\n     *\n     * @param {Object} scale - {min,max} or 0|21\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsScale (scale) {\n        logger.trace(\"_createElementToolsScale\");\n\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var divToolsScale = document.createElement(\"div\");\n        divToolsScale.className = this.name.containertoolsscale;\n\n        // FIXME Titre ?\n        // var label = document.createElement(\"label\");\n        // label.className = this.name.scaletitle;\n        // label.innerHTML = \"Scale :\";\n        // divToolsScale.appendChild(label);\n        var divMin = document.createElement(\"div\");\n        divMin.className = this.name.containertoolsminscale;\n\n        var labelMin = document.createElement(\"label\");\n        labelMin.className = this.name.scalelabelmin;\n        labelMin.innerHTML = \"min :\";\n        divMin.appendChild(labelMin);\n\n        var inputMin = document.createElement(\"input\");\n        inputMin.className = this.name.scaleinputmin;\n        inputMin.type = \"range\";\n        inputMin.value = scale.min || 0;\n        inputMin.title = scale.min || 0;\n        inputMin.disabled = false;\n        inputMin.min = 0;\n        inputMin.max = 21;\n        inputMin.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMin.addEventListener) {\n            inputMin.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        } else if (inputMin.appendChild) {\n            inputMin.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        }\n        divMin.appendChild(inputMin);\n\n        divToolsScale.appendChild(divMin);\n\n        var divMax = document.createElement(\"div\");\n        divMax.className = this.name.containertoolsmaxscale;\n\n        var labelMax = document.createElement(\"label\");\n        labelMax.className = this.name.scalelabelmax;\n        labelMax.innerHTML = \"max :\";\n        divMax.appendChild(labelMax);\n\n        var inputMax = document.createElement(\"input\");\n        inputMax.className = this.name.scaleinputmin;\n        inputMax.type = \"range\";\n        inputMax.value = scale.max || 21;\n        inputMax.title = scale.max || 21;\n        inputMax.disabled = false;\n        inputMax.min = 0;\n        inputMax.max = 21;\n        inputMax.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMax.addEventListener) {\n            inputMax.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        } else if (inputMax.appendChild) {\n            inputMax.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        }\n        divMax.appendChild(inputMax);\n\n        divToolsScale.appendChild(divMax);\n\n        return divToolsScale;\n    }\n\n    /**\n     * Graphical rendering of the edition tools\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsEdition () {\n        logger.warn(\"_createElementToolsEdition, it's not yet implemented !\");\n\n        var divToolsEdit = document.createElement(\"div\");\n        divToolsEdit.className = this.name.containertoolsedit;\n\n        return divToolsEdit;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Transform a JSON into a DOM with a syntax in color\n     *\n     * @private\n     * @param {Object} json - json.\n     * @returns {DOMElement} dom element\n     */\n    _syntaxHighlight (json) {\n        json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n        return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function (match) {\n            var cls = \"gp-json-number\";\n            if (/^\"/.test(match)) {\n                if (/:$/.test(match)) {\n                    cls = \"gp-json-key\";\n                } else {\n                    cls = \"gp-json-string\";\n                }\n            } else if (/true|false/.test(match)) {\n                cls = \"gp-json-boolean\";\n            } else if (/null/.test(match)) {\n                cls = \"gp-json-null\";\n            }\n            return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n        });\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:oneditjson\n     */\n    onEditJsonStyleMapBox (e) {\n        logger.trace(\"onEditJsonStyleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.oneditjson, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemin\n     */\n    onChangeStyleScaleMinMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMinMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemin, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemax\n     */\n    onChangeStyleScaleMaxMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMaxMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemax, e);\n    }\n\n};\n\nexport default Style;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Style = Style;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-themes\");\n\n/**\n * @classdesc\n *\n * Mapbox Themes management\n *\n * @constructor\n * @alias ol.style.editor.Theme\n * @param {Object} options - options for function call.\n * @example\n *   var theme = new Themes ({\n *        \"target\": \"\",\n *        \"tools\": {\n *          \"thumbnails\": true,\n *          \"button\" : {\n *              \"visible\" : true,\n *              \"type\" : \"radio\" (par defaut) | \"checkbox\"\n *          }\n *        },\n *        \"obj\": {\n *          \"themesSummary\": \"\", // Titre du composant (non graphique !)\n *          \"themes\": [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *        }\n *   });\n *  theme.add();\n *  theme.display(true);\n *  theme.getContainer();\n */\nclass Themes {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Themes\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Themes)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {\n            thumbnails : true,\n            button : {\n                visible : true,\n                type : \"radio\"\n            }\n        };\n\n        if (!this.options.tools || Object.keys(this.options.tools).length === 0) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (typeof this.options.obj === \"undefined\" ||\n            this.options.obj === null ||\n            !this.options.obj) {\n            // vide par defaut ?\n            this.options.obj = {\n                themesSummary : \"\",\n                themes : []\n            };\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxThemeTarget\",\n            container : \"GPEditorMapBoxThemesContainer\",\n            containertheme : \"GPEditorMapBoxThemeContainer\",\n            containerthemeID : \"GPEditorMapBoxThemeContainer_ID_\",\n            input : \"GPEditorMapBoxThemeInput\",\n            inputID : \"GPEditorMapBoxThemeInput_ID_\",\n            label : \"GPEditorMapBoxThemeTitle\",\n            labelID : \"GPEditorMapBoxThemeTitle_ID_\",\n            image : \"GPEditorMapBoxThemeImage\",\n            imageID : \"GPEditorMapBoxThemeImage_ID_\",\n            message : \"GPEditorMapBoxThemeMessage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     *  <div class=\"GPEditorMapBoxThemesContainer\">\n     *      <div id=\"GPEditorMapBoxThemeContainer-1\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176933\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image1.png\" alt=\"Description1\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeTitle\">Titre1</label>\n     *      </div>\n     *      <div id=\"GPEditorMapBoxThemeContainer-2\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176934\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image2.png\" alt=\"Description2\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeTitle\">Titre2</label>\n     *      </div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var id = this.id || ID.generate();\n\n        // div principale\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n        div.title = obj.themesSummary || \"\";\n\n        var _lstThemes = obj.themes;\n        if (_lstThemes) {\n            for (var i = 0; i < _lstThemes.length; i++) {\n                var _theme = _lstThemes[i];\n\n                // div pour chaque theme\n                var divTheme = document.createElement(\"div\");\n                divTheme.id = this.name.containerthemeID + i + \"_\" + id;\n                divTheme.className = this.name.containertheme;\n                divTheme.tabIndex = i;\n\n                // url du style est obligatoire !\n                var _url = _theme.url;\n                // style selectionné par defaut (uniquement en mode radio-button !?)\n                var _selected = _theme.selected || false;\n                if (_url) {\n                    // bouton\n                    var button = this.options.tools.button;\n                    if (button.visible) {\n                        var _type = (button.type === \"checkbox\") ? \"checkbox\" : \"radio\";\n                        var _button = document.createElement(\"input\");\n                        _button.type = _type;\n                        _button.id = this.name.inputID + i + \"_\" + id;\n                        _button.className = this.name.input;\n                        _button.name = id;\n                        _button.checked = _selected;\n                        _button.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (_button.addEventListener) {\n                            _button.addEventListener(\"click\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        } else if (_button.attachEvent) {\n                            _button.attachEvent(\"onclick\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        }\n                        divTheme.appendChild(_button);\n                    }\n                    // vignette\n                    if (this.options.tools.thumbnails) {\n                        if (_theme.thumbnail) {\n                            var _img = document.createElement(\"img\");\n                            _img.id = this.name.imageID + i + \"_\" + id;\n                            _img.className = this.name.image;\n                            _img.src = _theme.thumbnail;\n                            _img.alt = _theme.thumbnail;\n                            _img.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                            _img.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                            if (_img.addEventListener) {\n                                _img.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    // maj du radio button\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            } else if (_img.attachEvent) {\n                                _img.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            }\n                            divTheme.appendChild(_img);\n                        }\n                    }\n                    // label\n                    if (_theme.name) {\n                        var _label = document.createElement(\"label\");\n                        _label.id = this.name.labelID + i + \"_\" + id;\n                        if (this.options.tools.button.visible) {\n                            _label.htmlFor = _button.id;\n                        }\n                        _label.className = this.name.label;\n                        _label.innerHTML = _theme.name;\n                        _label.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                        _label.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (!this.options.tools.button.visible) {\n                            if (_label.addEventListener) {\n                                _label.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            } else if (_label.attachEvent) {\n                                _label.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            }\n                        }\n                        divTheme.appendChild(_label);\n                    }\n                } else {\n                    var _msg = document.createElement(\"label\");\n                    _msg.className = this.name.message;\n                    _msg.innerHTML = \"Thème non disponible...\";\n                    divTheme.appendChild(_msg);\n                }\n\n                div.appendChild(divTheme);\n            }\n        }\n\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:image\n     */\n    onClickThemeImageMapBox (e) {\n        logger.trace(\"onClickThemeImageMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.previousSibling.id.substring(\n                e.target.previousSibling.id.lastIndexOf(\"_\") + 1\n            );\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.previousSibling.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclickimage, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:title\n     */\n    onClickThemeTitleMapBox (e) {\n        logger.trace(\"onClickThemeTitleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.id.substring(e.target.id.lastIndexOf(\"_\") + 1);\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclicktitle, e);\n    }\n\n};\n\nexport default Themes;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Themes = Themes;\n}\n\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-filter\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Filter\n * @param {Object} options - options for function call.\n * @example\n *   var filter = new Filter ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false\n *      },\n *      title : \"Filtres (JSON)\",\n *      obj : {\n *          filter : []\n *      }\n *   });\n *  filter.add();\n *  filter.display(true);\n *  filter.getContainer();\n */\nclass Filter {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Filter\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Filter)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                filter : []\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Filtres :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxFilterTarget\",\n            container : \"GPEditorMapBoxFilterContainer\",\n            containerjson : \"GPEditorMapBoxFilterJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxFilterTitleJson\",\n            jsondisplay : \"GPEditorMapBoxFilterDisplayJson\",\n            containertoolsedit : \"GPEditorMapBoxFilterToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxFilterContainer\">\n     *  <div class =\"GPEditorMapBoxFilterJsonontainer\">\n     *     <label class=\"GPEditorMapBoxFilterTitleJson\">JSON Filtres :</label>\n     *     <pre class=\"GPEditorMapBoxFilterDisplayJson\">...</pre>\n     *  </div>\n     *  <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _filter = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        // FIXME tag filter est obselete !\n        // on doit utiliser les expressions dans \"paint\" ou \"layout\" !\n        if (_filter.filter) {\n            _found = true;\n            if (_filter.filter.length === 0) {\n                logger.info(\"tag 'filter' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            json = JSON.stringify(_filter.filter, null, 4);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var labelJson = document.createElement(\"label\");\n        labelJson.className = this.name.jsonlabel;\n        labelJson.innerHTML = this.options.title;\n        divJson.appendChild(labelJson);\n\n        var preJson = document.createElement(\"pre\");\n        preJson.className = this.name.jsondisplay;\n        preJson.innerHTML = json;\n        if (preJson.addEventListener) {\n            preJson.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        } else if (preJson.attachEvent) {\n            preJson.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(preJson);\n        div.appendChild(divJson);\n\n        if (this.options.tools.edition) {\n            var divEdit = document.createElement(\"div\");\n            divEdit.className = this.name.containertoolsedit;\n            div.appendChild(divEdit);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Filter#editor:style:oneditjson\n     */\n    onEditJsonFilterMapBox (e) {\n        logger.trace(\"onEditJsonFilterMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.filter.oneditjson, e);\n    }\n\n};\n\nexport default Filter;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Filter = Filter;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Color from \"../../Utils/ColorUtils\";\n\nvar logger = Logger.getLogger(\"editor-legend\");\n\n/**\n * @classdesc\n *\n * MapBox Legend management\n *\n * @constructor\n * @alias ol.style.editor.Legend\n * @param {Object} options - options for function call.\n * @param {Object} [options.target = null] - ...\n * @param {Number} [options.position = 0] -  ...\n * @param {Number} [options.id = null] - (internal) ...\n * @param {Object} [options.sprites = null] - ...\n * @param {String} [options.sprites.url] - ...\n * @param {Object} [options.sprites.size] - {h:, w:} ...\n * @param {Object} [options.sprites.json] - ...\n * @param {Object} options.obj - ...\n * @param {String} [options.obj.title] - ...\n * @param {Boolean} [options.obj.editable = true] - ...\n * @param {Object} options.obj.paint - ...\n * @param {Object} options.obj.layout - ...\n * @example\n *   var legend = new Legend ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      sprites : {\n *          url : \"http://localhost/sprites.png\",\n *          size : { w : 450, h : 550 },\n *          json : {\n *              icon-1 : {x:,y:,height:,width:,pixelRatio:},\n *              icon-2 : {x:,y:,height:,width:,pixelRatio:}\n *          }\n *      },\n *      obj : {\n *          title : \"\",\n *          editable : true, // tag non standard issue du style json dédié à l'edition\n *          paint : {\"fill-color\": \"#2BB3E1\"},\n *          layout : {visibility:\"none\"}\n *      }\n *   });\n *  legend.add();\n *  legend.display(true);\n *  legend.isEditable();\n *  legend.getRenderContainer();\n *  legend.getToolsContainer();\n *  legend.getContainer();\n */\nclass Legend {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Legend\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            sprites : null,\n            obj : null\n        };\n\n        if (!(this instanceof Legend)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ########################## init methods ########################### //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        // permet d'avoir un identifiant de position dans la liste des layers\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition...\n            this.options.obj = {\n                title : \"vide...\",\n                editable : true,\n                paint : {\n                    \"fill-color\" : \"#FFFFFF\"\n                }\n            };\n        }\n\n        // la legende est elle editable ?\n        // le tag 'editable' est à placer dans le fichier de style (dans le layer)...\n        var _editable = this.options.obj.editable;\n        this.editable = (typeof _editable !== \"undefined\") ? _editable : false;\n\n        // liste des caractéristiques de la legende par defaut\n        this.legendRender = {\n            type : \"fill\",\n            values : {\n                width : 1,\n                stroke : \"#FFFFFF\",\n                color : \"#000000\",\n                opacity : 1\n            }\n        };\n\n        // DOM : pointer\n        this.container = null;\n        this.rendercontainer = null;\n        this.toolscontainer = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLegendTarget\",\n            container : \"GPEditorMapBoxLegendContainer\",\n            containerlegendrender : \"GPEditorMapBoxLegendRenderContainer\",\n            legendrender : \"GPEditorMapBoxLegendRender\",\n            legendeditable : \"GPEditorMapBoxLegendEditable\",\n            legendtitle : \"GPEditorMapBoxLegendTitle\",\n            containerlegendtools : \"GPEditorMapBoxLegendToolsContainer\"\n        };\n\n        // DOM : Label menu Edition\n        this.labels = {\n            \"line-color\" : \"Couleur du trait\",\n            \"line-width\" : \"Epaisseur du trait\",\n            \"line-opacity\" : \"Opacité du trait\",\n            \"fill-color\" : \"Couleur de remplissage\",\n            \"fill-opacity\" : \"Opacité du remplissage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxLegendContainer\">\n     *  <div class=\"GPEditorMapBoxLegendRenderContainer\">\n     *      <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-circle\" style=\"...\"></div>\n     *      <span class=\"GPEditorMapBoxLegendTitle\">test circle editable...</span>\n     *  </div>\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     * </div>\n     */\n    _initContainer () {\n        var _obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // INFO\n        // on recherche les informations dans le tag 'paint' en priorité, mais pour\n        // les icones ou textes, les informations peuvent se trouver aussi dans le tag 'layout'...\n        // on fusionnne paint et layout par facilité\n        var style = Object.assign({}, _obj.paint, _obj.layout);\n\n        // liste des properties mapbox\n        // ex. fill-color\n        var keys = Object.keys(style);\n        if (keys.length === 0) {\n            logger.info(\"tag 'paint' or 'layout' is empty !\");\n            return;\n        }\n\n        // FIXME\n        // - gestion de type plus complexe : texte avec/sans symbole ou symbole !\n        // - pour les textes ou icones, les info peuvent être aussi dans le tag 'layout' !\n        var params = {};\n        var bFound = false;\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            // recherche du type\n            // ex. fill\n            if (/fill-/.test(key) ||\n                /line-/.test(key) ||\n                /circle-/.test(key) ||\n                /background-/.test(key) ||\n                /text-/.test(key) ||\n                /icon-/.test(key)) {\n                // style geré & trouvé\n                bFound = true;\n\n                var title = _obj.title || \"\";\n\n                // INFO\n                // le type texte ou icone est difficile à trouver car les 2 types cohabitent,\n                // on le gère en symbole...\n                var type = key.split(\"-\")[0];\n                if (type === \"text\" || type === \"icon\") {\n                    type = \"symbol\";\n                }\n\n                this.legendRender = this._getProperties(type, style);\n                params = {\n                    edit : this.editable,\n                    title : title,\n                    type : this.legendRender.type,\n                    values : this.legendRender.values\n                };\n                div.appendChild(this._createElementIconLegend(params));\n\n                // on stoppe la recherche\n                break;\n            }\n        }\n\n        // legende avec un style indeterminé ou non géré !?\n        if (!bFound) {\n            // on prend la legende par defaut\n            params = {\n                edit : this.editable,\n                title : \"\",\n                type : this.legendRender.type,\n                values : this.legendRender.values\n            };\n            div.appendChild(this._createElementIconLegend(params));\n            logger.warn(\"legend type unknown, default legend used...\");\n        }\n\n        // ajout mode edition graphique de la legende\n        this.toolscontainer = this._createElementEditionLegend(params);\n        div.appendChild(this.toolscontainer);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n    * Get properties supported\n    *\n    * @param {Object} type - fill, line, circle, text, icon...\n    * @param {Object} values - raw values from the JSON file\n    * @returns {Object} - { type : (fill | line | circle | symbol), values : valuesSupported }\n    *\n    * @private\n    * @example\n    *\n    * // TODO\n    * // symbol with text (1) / symbol without text (2) / text (3)\n    * // \"layout\":{\n    * //      \"icon-image\":\"{maki}-11\",          <!--- IT'S A SYMBOL (1) (2)-->\n    * //      \"text-font\":[\n    * //           \"Open Sans Semibold\",\n    * //           \"Arial Unicode MS Bold\"\n    * //       ],\n    * //       \"text-field\":\"{name_en}\",         <!--- IT'S A TEXT (1) (3)-->\n    * //       \"text-max-width\":9,\n    * //       \"text-padding\":2,\n    * //       \"text-offset\":[\n    * //            0,\n    * //            0.6\n    * //       ],\n    * //       \"text-anchor\":\"top\",\n    * //       \"text-size\":12\n    * // },\n    * // \"paint\":{\n    * //     \"text-color\":\"#666\",\n    * //     \"text-halo-color\":\"#ffffff\",\n    * //     \"text-halo-width\":1,\n    * //     \"text-halo-blur\":0.5\n    * // },\n    *\n    */\n    _getProperties (type, values) {\n        // cas particulier du symbole complexe\n        // il existe plusieurs types pour un symbole :\n        // - text\n        // - icon\n        // - icon with text\n        if (type === \"symbol\") {\n            var isTextValue = values[\"text-field\"];\n            var isIconValue = values[\"icon-image\"];\n            type = (isTextValue && isIconValue) ? \"icon\" : (isTextValue) ? \"text\" : (isIconValue) ? \"icon\" : \"unknow\";\n            if (type === \"unknow\") {\n                logger.warn(\"type unknow !?\");\n                return;\n            }\n        }\n\n        var valuesSupported = {};\n        for (const key in values) {\n            if (Object.hasOwnProperty.call(values, key)) {\n                const val = values[key];\n                if (Legend.PROPERTIES[type].includes(key)) {\n                    var prop = key.replace(type, \"\").slice(1);\n                    var value = this._getValue(val);\n                    if (value) {\n                        // cas particulier des sprites\n                        if (prop === \"pattern\" || prop === \"image\") {\n                            if (!this.options.sprites ||\n                                !this.options.sprites.json ||\n                                !this.options.sprites.json[value]) {\n                                var k = type + \":\" + prop;\n                                logger.warn(\"sprites mandatory for key \", k);\n                                break;\n                            }\n                        }\n                        valuesSupported[prop] = value;\n                    }\n                } else {\n                    logger.warn(\"property not supported : \", key);\n                }\n            }\n        }\n\n        return {\n            type : type,\n            values : valuesSupported\n        };\n    }\n\n    /**\n    * Render thumbnail (SVG)\n    *\n    * @param {Object} type - fill, line, circle, text, ...\n    * @param {Object} values - {\"color\":..., \"width\":..., \"stroke\":...., \"opacity\":...}\n    * @returns {Boolean} true/false\n    *\n    * @private\n    * @example\n    * (...)\n    */\n    _renderThumbnail (type, values) {\n        // div de rendu de la legende\n        var div = this.rendercontainer;\n\n        if (!div) {\n            return false;\n        }\n\n        // SVG\n        var svg = null;\n        // facteur grossissement (x10) pour le trait\n        var factor = 3;\n\n        // valeur par defaut\n        if (!values.color) {\n            values.color = \"#FFFFFF\";\n        }\n        // en fonction du type, on y ajoute le style\n        switch (type) {\n            case \"text\":\n                var styleText = \"font-size: 5em;font-weight: bold;\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%style%\", styleText);\n                break;\n            case \"icon\":\n                if (values.image) {\n                    // FIXME on reste dans le paradigme d'utilisation du SVG...,\n                    // mais probleme de ratio de l'image !?\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.image].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.image].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.image].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.image].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var styleTextIcon = \"fill: transparent;stroke-width: 10;\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%style%\", styleTextIcon);\n                }\n                break;\n            case \"line\":\n                var lstrockedasharray = (Array.isArray(values[\"dasharray\"])) ? values[\"dasharray\"].join(\" \") : 0;\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>\\\")\";\n                // svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M0 99 L99 0 L100 1 L1 100' stroke='%color%' stroke-width='%width%' stroke-opacity='%opacity%' stroke-dasharray='%dasharray%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%stroke-opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-dasharray%\", lstrockedasharray)\n                    .replace(\"%stroke-width%\", (values.width || 0) * factor);\n                break;\n            case \"circle\":\n                var cstrockcolor = values[\"stroke-color\"] || \"#FFFFFF\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-color%\", (cstrockcolor.indexOf(\"rgb\") === 0) ? cstrockcolor : Color.hexToRgba(cstrockcolor, 1))\n                    .replace(\"%stroke-opacity%\", values[\"stroke-opacity\"] || 1)\n                    .replace(\"%stroke-width%\", (values[\"stroke-width\"] || 0) * factor);\n                break;\n            case \"background\":\n            case \"fill\":\n                if (values.pattern) {\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.pattern].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.pattern].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.pattern].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.pattern].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var fstrokecolor = values[\"outline-color\"] || \"#FFFFFF\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%opacity%\", values.opacity || 1)\n                        .replace(\"%stroke-color%\", (fstrokecolor.indexOf(\"rgb\") === 0) ? fstrokecolor : Color.hexToRgba(fstrokecolor, 1));\n                }\n                break;\n            default:\n                logger.warn(\"type not found, no thumbnail...\");\n                return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Get value\n     *\n     * @param {*} value - value of a property (ex. \"#2BB3E1\")\n     * @returns {*} return a verified value (ex. color\": \"#2BB3E1\")\n     *\n     * @private\n     * @example\n     * // type simple for fill, line or circle type with string :\n     * // \"paint\": {\n     * //     \"fill-color\": \"#2BB3E1\"\n     * // }\n     *\n     * // type simple for fill, line or circle type with array :\n     * // \"paint\": {\n     * //     \"line-dasharray\": [2,10]\n     * // }\n     *\n     * // TODO type complexe : not yet implemented !\n     * // \"paint\": {\n     * //     \"fill-color\": [\n     * //          \"match\",\n     * //          [\"get\",\"symbo\"],\n     * //          \"ZONE_BOISEE\",\"#A7DA81\",\n     * //          \"ZONE_MANGROVE\",\"#7E8AB5\",\n     * //          \"#A7DA81\"\n     * //      ]\n     * // }\n     *\n     * // other type complexe :\n     * // \"paint\": {\n     * //     \"fill-color\": {\n     * //        \"base\": 1,\n     * //        \"stops\": [\n     * //        [\n     * //          15.5,\n     * //         \"#f2eae2\"\n     * //        ],\n     * //        [\n     * //          16,\n     * //          \"#dfdbd7\"\n     * //        ]\n     * //        ]\n     * //     }\n     * // }\n     */\n    _getValue (value) {\n        var result = null;\n        if (typeof value === \"string\") {\n            result = value;\n        } else if (typeof value === \"number\") {\n            result = value;\n        } else if (Array.isArray(value)) {\n            // cas d'un tableau de valeurs numériques : [1,2,3]\n            var isNumber = true;\n            value.forEach(v => {\n                if (typeof v !== \"number\") {\n                    isNumber = false;\n                }\n            });\n            if (isNumber) {\n                result = value;\n            }\n        } else if (typeof value === \"object\") {\n            result = null;\n            if (\"stops\" in value) {\n                // on realise un ordre inversé sur les zooms\n                value.stops.sort((a, b) => {\n                    var numA = a[0];\n                    var numB = b[0];\n                    if (numA > numB) {\n                        return -1;\n                    }\n                    if (numA < numB) {\n                        return 1;\n                    }\n                    return 0;\n                });\n                // et, on prend le plus petit zoom\n                var lastStopsValue = value.stops.slice(-1);\n                result = lastStopsValue[0][1];\n            }\n        } else {\n            logger.warn(\"value not supported !\");\n        }\n        return result;\n    }\n\n    // ################################################################### //\n    // ######################### DOM methods ############################# //\n    // ################################################################### //\n    /**\n    * Create a Graphical Legend Icon\n    *\n    * @param {Object} params - param\n    * @param {String} params.title - title\n    * @param {String} params.type - fill, line, circle, text, icon, ...\n    * @param {String} params.values - {\"color\": \"#2BB3E1\", \"width\": 10, \"opacity\": 0.5, \"stroke\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line, fill and circle legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendRenderContainer\">\n    *       <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-fill\"\n    *           style=\"background: url(&quot;data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' fill='rgba(255, 255, 255, 1)' fill-opacity='1' /></svg>&quot;);\">\n    *       </div>\n    *       <span class=\"GPEditorMapBoxLegendTitle\">vide...</span>\n    * </div>\n    */\n    _createElementIconLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendrender;\n\n        var div = this.rendercontainer = document.createElement(\"div\");\n        div.className = this.name.legendrender;\n        if (params.edit) {\n            div.className += \" \";\n            div.className += this.name.legendeditable;\n            if (div.addEventListener) {\n                div.addEventListener(\"click\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            } else if (div.attachEvent) {\n                div.attachEvent(\"onclick\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            }\n        }\n\n        // type de legende\n        var type = params.type;\n\n        // TODO className\n        // div.className += \" legend-not-implemented\";\n        // ajout du style sur la div de rendu\n        if (this._renderThumbnail(type, params.values)) {\n            // className possibles :\n            // \" legend-text\"\n            // \" legend-icon\"\n            // \" legend-background\"\n            // \" legend-line\"\n            // \" legend-line-not-editable\"\n            // \" legend-circle\"\n            // \" legend-circle-not-editable\"\n            // \" legend-fill\"\n            // \" legend-fill-not-editable\"\n            div.className += (params.edit) ? \" legend-\" + type : \" legend-\" + type + \"-not-editable\";\n        } else {\n            div.className += \" legend-unknow\";\n        }\n\n        container.appendChild(div);\n\n        var span = document.createElement(\"span\");\n        span.className = this.name.legendtitle;\n        span.innerHTML = params.title || \"\";\n        container.appendChild(span);\n\n        return container;\n    }\n\n    /**\n    * Create a Graphical Legend Edition\n    *\n    * @param {Object} params - param\n    * @param {String} params.type - fill, line, (TODO : circle, icon or text)\n    * @param {String} params.values - {\"fill-color\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line and fill legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendToolsContainer\">\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-color\">Couleur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-width\">Epaisseur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-width\" title=\"\" type=\"range\" min=\"0\" max=\"10\" step=\"1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-opacity\">Opacité du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-color\">Couleur de remplissage</label>\n    *        <input class=\"legend-styling\" id=\"fill-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-opacity\">Opacité du remplissage</label>\n    *           <input class=\"legend-styling\" id=\"fill-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *   </div>\n    */\n    _createElementEditionLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendtools;\n\n        // uniquement les elements editables !\n        if (!params.edit) {\n            return container;\n        }\n\n        // on ne traite que l'edition du mode 'traits' ou 'surfaciques'\n        // mode 'line'\n        switch (params.type) {\n            case \"line\":\n                createLineColor.call(self);\n                createLineWidth.call(self);\n                createLineOpacity.call(self);\n                break;\n            case \"background\":\n            case \"fill\":\n                createFillColor.call(self);\n                createFillOpacity.call(self);\n                break;\n            default:\n                break;\n        }\n\n        // couleur du trait\n        function createLineColor () {\n            var linecolor = document.createElement(\"div\");\n            linecolor.className = \"legend-styling-div\";\n            var lLineColor = document.createElement(\"label\");\n            lLineColor.className = \"legend-line\";\n            lLineColor.htmlFor = this.id ? \"line-color-\" + this.id : \"line-color\";\n            lLineColor.innerHTML = this.labels[\"line-color\"];\n            var inputLineColor = document.createElement(\"input\");\n            inputLineColor.className = \"legend-styling\";\n            inputLineColor.id = this.id ? \"line-color-\" + this.id : \"line-color\";\n            inputLineColor.title = \"Selectionner une couleur de trait\";\n            inputLineColor.type = \"color\";\n            inputLineColor.value = params.values.color;\n            inputLineColor.setAttribute(\"data-id\", \"line-color\");\n            if (inputLineColor.addEventListener) {\n                inputLineColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineColor.attachEvent) {\n                inputLineColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linecolor.appendChild(lLineColor);\n            linecolor.appendChild(inputLineColor);\n            container.appendChild(linecolor);\n        }\n\n        // epaisseur du trait\n        function createLineWidth () {\n            var linewidth = document.createElement(\"div\");\n            linewidth.className = \"legend-styling-div\";\n            var lLineWidth = document.createElement(\"label\");\n            lLineWidth.className = \"legend-line\";\n            lLineWidth.htmlFor = this.id ? \"line-width-\" + this.id : \"line-width\";\n            lLineWidth.innerHTML = this.labels[\"line-width\"];\n            var inputLineWidth = document.createElement(\"input\");\n            inputLineWidth.className = \"legend-styling\";\n            inputLineWidth.id = this.id ? \"line-width-\" + this.id : \"line-width\";\n            inputLineWidth.title = params.values.width;\n            inputLineWidth.type = \"range\";\n            inputLineWidth.min = \"0\";\n            inputLineWidth.max = \"10\";\n            inputLineWidth.step = \"1\";\n            inputLineWidth.defaultValue = params.values.width;\n            inputLineWidth.setAttribute(\"data-id\", \"line-width\");\n            if (inputLineWidth.addEventListener) {\n                inputLineWidth.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineWidth.attachEvent) {\n                inputLineWidth.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linewidth.appendChild(lLineWidth);\n            linewidth.appendChild(inputLineWidth);\n            container.appendChild(linewidth);\n        }\n\n        // opacité du trait\n        function createLineOpacity () {\n            var lineopacity = document.createElement(\"div\");\n            lineopacity.className = \"legend-styling-div\";\n            var lLineOpacity = document.createElement(\"label\");\n            lLineOpacity.className = \"legend-line\";\n            lLineOpacity.htmlFor = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            lLineOpacity.innerHTML = this.labels[\"line-opacity\"];\n            var inputLineOpacity = document.createElement(\"input\");\n            inputLineOpacity.className = \"legend-styling\";\n            inputLineOpacity.id = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            inputLineOpacity.title = params.values.opacity;\n            inputLineOpacity.type = \"range\";\n            inputLineOpacity.min = \"0\";\n            inputLineOpacity.max = \"1\";\n            inputLineOpacity.step = \"0.1\";\n            inputLineOpacity.defaultValue = params.values.opacity;\n            inputLineOpacity.setAttribute(\"data-id\", \"line-opacity\");\n            if (inputLineOpacity.addEventListener) {\n                inputLineOpacity.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineOpacity.attachEvent) {\n                inputLineOpacity.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            lineopacity.appendChild(lLineOpacity);\n            lineopacity.appendChild(inputLineOpacity);\n            container.appendChild(lineopacity);\n        }\n\n        // couleur de remplissage\n        function createFillColor () {\n            var fillcolor = document.createElement(\"div\");\n            fillcolor.className = \"legend-styling-div\";\n            var lFillColor = document.createElement(\"label\");\n            lFillColor.className = \"legend-fill\";\n            lFillColor.htmlFor = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            lFillColor.innerHTML = this.labels[\"fill-color\"];\n            var inputFillColor = document.createElement(\"input\");\n            inputFillColor.className = \"legend-styling\";\n            inputFillColor.id = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            inputFillColor.title = \"Selectionner une couleur de remplissage\";\n            inputFillColor.type = \"color\";\n            inputFillColor.value = params.values.color;\n            inputFillColor.setAttribute(\"data-id\", \"fill-color\");\n            if (inputFillColor.addEventListener) {\n                inputFillColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillColor.attachEvent) {\n                inputFillColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillcolor.appendChild(lFillColor);\n            fillcolor.appendChild(inputFillColor);\n            container.appendChild(fillcolor);\n        }\n\n        // opacité du remplissage\n        function createFillOpacity () {\n            var fillopacity = document.createElement(\"div\");\n            fillopacity.className = \"legend-styling-div\";\n            var lFillOpacity = document.createElement(\"label\");\n            lFillOpacity.className = \"legend-fill\";\n            lFillOpacity.htmlFor = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            lFillOpacity.innerHTML = this.labels[\"fill-opacity\"];\n            var inputFillOpacity = document.createElement(\"input\");\n            inputFillOpacity.className = \"legend-styling\";\n            inputFillOpacity.id = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            inputFillOpacity.title = params.values.opacity;\n            inputFillOpacity.type = \"range\";\n            inputFillOpacity.min = \"0\";\n            inputFillOpacity.max = \"1\";\n            inputFillOpacity.step = \"0.1\";\n            inputFillOpacity.defaultValue = params.values.opacity;\n            inputFillOpacity.setAttribute(\"data-id\", \"fill-opacity\");\n            if (inputFillOpacity.addEventListener) {\n                inputFillOpacity.addEventListener(\"change\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillOpacity.attachEvent) {\n                inputFillOpacity.attachEvent(\"onchange\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillopacity.appendChild(lFillOpacity);\n            fillopacity.appendChild(inputFillOpacity);\n            container.appendChild(fillopacity);\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     *\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Is editable\n     *\n     * @returns {Boolean} - true/false\n     */\n    isEditable () {\n        return this.editable;\n    }\n\n    /**\n     * Get container Legend Render (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendRender legend-(line|fill|background|text|icon|circle|unknow)\" style=\"...\"></div>\n     */\n    getRenderContainer () {\n        return this.rendercontainer;\n    }\n\n    /**\n     * Get container Legend Tools (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     */\n    getToolsContainer () {\n        return this.toolscontainer;\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onclickedition\n     */\n    onEditionLegendMapBox (e) {\n        logger.trace(\"onEditionLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onclickedition, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onchangevalue\n     */\n    onChangeValueLegendMapBox (e) {\n        logger.trace(\"onChangeValueLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onchangevalue, e);\n    }\n\n};\n\n// ################################################################### //\n// ########################## CONSTANTES ############################# //\n// ################################################################### //\n\n/**\n * List of supported properties\n */\nLegend.PROPERTIES = {\n    line : [\n        \"line-color\",\n        \"line-dasharray\",\n        \"line-opacity\",\n        \"line-width\"\n    ],\n    fill : [\n        \"fill-color\",\n        \"fill-opacity\",\n        \"fill-outline-color\",\n        \"fill-pattern\"\n    ],\n    background : [\n        \"background-color\",\n        \"background-opacity\",\n        \"background-pattern\"\n    ],\n    circle : [\n        \"circle-color\",\n        \"circle-opacity\",\n        \"circle-stroke-color\",\n        \"circle-stroke-opacity\",\n        \"circle-stroke-width\"\n    ],\n    icon : [\n        \"icon-color\",\n        \"icon-image\",\n        \"icon-opacity\",\n        \"__icon-size\"\n    ],\n    text : [\n        \"__text-anchor\",\n        \"text-color\",\n        \"text-field\",\n        \"__text-font\",\n        \"__text-opacity\",\n        \"__text-size\"\n    ]\n};\n\nexport default Legend;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Legend = Legend;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Style from \"./Style\";\nimport Legend from \"./Legend\";\nimport Filter from \"./Filter\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-layer\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Layer\n * @param {Object} options - options for function call.\n * @example\n *   var layers = new Layer ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          \"visibility\" : true, // afficher l'icone de visibilité\n *          \"icon\" : {\n *              \"image\" : true, // afficher l'icone \"oeil\" (defaut) ou une checkbox\n *              \"anchor\" : \"start\" | \"end\"  // afficher l'icone au debut ou à la fin (defaut)\n *          },\n *          \"type\" : true,       // afficher l'icone du type de geometrie\n *          \"pin\" : true,        // afficher l'icone de puce\n *          \"remove\" : false,    // TODO afficher l'icone de suppression\n *          \"clone\" : false      // TODO afficher l'icone de duplication\n *      },\n *      obj : {\n *          \"id\": \"ocs - vegetation\", // MANDATORY\n *          \"type\": \"fill\", // OPTIONAL\n *          \"source\": \"pyramide_proto\", // OPTIONAL\n *          \"source-layer\": \"ocs_vegetation_surf\" // OPTIONAL\n *      }\n *   });\n *  layers.addLegend(oLegend);\n *  layers.slotLegend();\n *  layers.addStyle(oStyle);\n *  layers.addFilter(oFilter);\n *  layers.add();\n *  layers.active(false);\n *  layers.visibility(false);\n *  layers.display(false);\n *  layers.collapse();\n *  EventBus.addEventListener(\"editor:layer:onclickvisibility\", function (e) {\n *     // e.target.data : options !\n *     // e.target.editorID : id or null\n *   }, this);\n */\nclass Layer {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Layer\", options);\n\n        // options\n        this.options = options || {};\n\n        if (!(this instanceof Layer)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null; // null si le layer n'appartient pas à un editeur !\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            type : true,\n            pin : true,\n            remove : false, // TODO\n            clone : false // TODO\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        var _objDefault = {\n            id : \"\",\n            type : \"\", // icone sur le type de geometrie\n            source : \"\",\n            \"source-layer\" : \"\"\n        };\n\n        if (!this.options.obj) {\n            this.options.obj = _objDefault;\n        }\n\n        Utils.mergeParams(this.options.obj, _objDefault, false);\n\n        // legende intégrée\n        this.bSlotLegend = false;\n\n        // obj\n        this.oFilter = null;\n        this.oStyle = null;\n        this.oLegend = null;\n\n        // dom\n        this.container = null;\n        this.DomVisibility = null;\n        this.DomToggle = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLayerTarget\",\n            container : \"GPEditorMapBoxLayerContainer\",\n            containerlegend : \"GPEditorMapBoxLayerLegendContainer\",\n            containertitle : \"GPEditorMapBoxLayerTitleContainer\",\n            imagelabelinput : \"GPEditorMapBoxLayerImageInput\",\n            imagelabel : \"GPEditorMapBoxLayerImageLabel\",\n            typeimg : \"GPEditorMapBoxLayerTypeImage\",\n            titleinput : \"GPEditorMapBoxLayerTitleInput\",\n            titlelabel : \"GPEditorMapBoxLayerTitleLabel\",\n            containertools : \"GPEditorMapBoxToolsContainer\",\n            visibilityinput : \"GPEditorMapBoxToolsVisibilityInput\",\n            visibilitylabel : \"GPEditorMapBoxToolsVisibilityLabel\",\n            visibilityinputdisable : \"GPEditorMapBoxToolsVisibilityInputDisable\",\n            visibilitylabeldisable : \"GPEditorMapBoxToolsVisibilityLabelDisable\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * // >> Titre 1          |OOO| <- menu tools : visibility, clone, remove\n     * // >> Titre 2          |OXX| <- affichage configurable (cf. options.tools)\n     * // Event : clic sur le titre -> ex. affiche le menu des styles / filtres\n     * //       : clic visibility, clone, remove\n     * // DOM :\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-45\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <input id=\"GPEditorMapBoxLayerImageInput-45\" class=\"GPEditorMapBoxLayerImageInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\" for=\"GPEditorMapBoxLayerImageInput-45\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-45\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-45\" title=\"...\">...</label>\n     *          </div>\n     *          <div id=\"GPEditorMapBoxToolsContainer-45\" class=\"GPEditorMapBoxToolsContainer\">\n     *              <input id=\"GPEditorMapBoxToolsVisibilityInput-45\" type=\"checkbox\" class=\"GPEditorMapBoxToolsVisibilityInput\">\n     *              <label for=\"GPEditorMapBoxToolsVisibilityInput-45\" id=\"GPEditorMapBoxToolsVisibilityLabel-45\" class=\"GPEditorMapBoxToolsVisibilityLabel\" title=\"Afficher/masquer la couche\"></label>\n     *          </div>\n     *      </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // title\n        var divTitle = document.createElement(\"div\");\n        divTitle.id = this.name.containertitle + \"-\" + this.options.position;\n        divTitle.className = this.name.containertitle;\n\n        // puce\n        if (this.options.tools.pin) { // Optionnel !\n            // input\n            var inputImage = document.createElement(\"input\");\n            inputImage.id = this.name.imagelabelinput + \"-\" + this.options.position;\n            inputImage.className = this.name.imagelabelinput;\n            inputImage.type = \"checkbox\";\n            divTitle.appendChild(inputImage);\n            // puce\n            var labelImage = document.createElement(\"label\");\n            labelImage.className = this.name.imagelabel;\n            labelImage.htmlFor = inputImage.id;\n            if (labelImage.addEventListener) {\n                labelImage.addEventListener(\"click\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            } else if (labelImage.attachEvent) {\n                labelImage.attachEvent(\"onclick\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            }\n            divTitle.appendChild(labelImage);\n        }\n\n        // tools :\n        // visibility, (remove, clone)\n        var _addTools = function () {\n            var divTools = document.createElement(\"div\");\n            divTools.id = this.name.containertools + \"-\" + this.options.position;\n            divTools.className = this.name.containertools;\n\n            // visibility\n            if (this.options.tools.visibility) {\n                var inputTools = document.createElement(\"input\");\n                inputTools.id = this.name.visibilityinput + \"-\" + this.options.position;\n                inputTools.className = (this.options.tools.icon.image) ? this.name.visibilityinput : this.name.visibilityinputdisable;\n                inputTools.type = \"checkbox\";\n                inputTools.checked = \"checked\"; // par défaut, à modifier via visibility(true|false) !\n\n                // event for visibility change\n                if (inputTools.addEventListener) {\n                    inputTools.addEventListener(\"click\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                } else if (inputTools.attachEvent) {\n                    // internet explorer\n                    inputTools.attachEvent(\"onclick\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                }\n                divTools.appendChild(inputTools);\n                // enregistrement utile pour la méthode : visibility()\n                this.DomVisibility = inputTools;\n\n                var labelTools = document.createElement(\"label\");\n                labelTools.htmlFor = this.name.visibilityinput + \"-\" + this.options.position;\n                labelTools.id = this.name.visibilitylabel + \"-\" + this.options.position;\n                labelTools.className = (this.options.tools.icon.image) ? this.name.visibilitylabel : this.name.visibilitylabeldisable;\n                labelTools.title = \"Afficher/masquer la couche\";\n                divTools.appendChild(labelTools);\n\n                div.appendChild(divTools);\n            }\n\n            // clone\n            if (this.options.tools.clone) {\n                // TODO...\n                logger.warn(\"Dom for tools clone, it's not yet implemented !\");\n            }\n\n            // remove\n            if (this.options.tools.remove) {\n                // TODO...\n                logger.warn(\"Dom for tools remove, it's not yet implemented !\");\n            }\n        };\n\n        // ajout des outils au debut du composant\n        if (this.options.tools.icon.anchor === \"start\") {\n            _addTools.apply(this);\n        }\n\n        // type\n        if (this.options.tools.type && obj.type) { // Optionnel !\n            var imgType = document.createElement(\"img\");\n            imgType.className = this.name.typeimg;\n            // FIXME il faudrait faire la difference entre :\n            // - icone uniquement : SYMBOL-ICON\n            // - texte uniquement : SYMBOL-TEXT\n            // - les 2 : SYMBOL\n            // Mais il nous faut les styles complets (paint & layout)\n            // pour determiner les 3 types !\n            switch (obj.type.toUpperCase()) {\n                case \"SYMBOL-ICON\": // not used !\n                    imgType.style[\"background-position\"] = \"0px 0\";\n                    break;\n                case \"SYMBOL-TEXT\": // not used !\n                    imgType.style[\"background-position\"] = \"-194px 0\";\n                    break;\n                case \"SYMBOL\":\n                    imgType.style[\"background-position\"] = \"-84px 0\";\n                    break;\n                case \"LINE\":\n                    imgType.style[\"background-position\"] = \"-28px 0\";\n                    break;\n                case \"FILL\":\n                    imgType.style[\"background-position\"] = \"-56px 0\";\n                    break;\n                case \"BACKGROUND\":\n                    imgType.style[\"background-position\"] = \"-140px 0\";\n                    break;\n                case \"CIRCLE\":\n                    imgType.style[\"background-position\"] = \"-168px 0\";\n                    break;\n                default:\n                    // type inconnu ou non pris en charge ou par defaut\n                    imgType.style[\"background-position\"] = \"-112px 0\";\n            }\n            divTitle.appendChild(imgType);\n        }\n\n        // container legend (empty)\n        var divLegend = document.createElement(\"div\");\n        divLegend.id = this.name.containerlegend + \"-\" + this.options.position;\n        divLegend.className = this.name.containerlegend;\n        divTitle.appendChild(divLegend);\n\n        // input\n        var inputTitle = document.createElement(\"input\");\n        inputTitle.id = this.name.titleinput + \"-\" + this.options.position;\n        inputTitle.className = this.name.titleinput;\n        inputTitle.type = \"checkbox\";\n        divTitle.appendChild(inputTitle);\n\n        // label for\n        var labelTitle = document.createElement(\"label\");\n        labelTitle.className = this.name.titlelabel;\n        labelTitle.htmlFor = inputTitle.id;\n        labelTitle.innerHTML = obj[\"id\"] || obj[\"source-layer\"] || obj[\"source\"];\n        labelTitle.title = obj[\"source-layer\"] || obj[\"source\"] || obj[\"id\"];\n        if (labelTitle.addEventListener) {\n            labelTitle.addEventListener(\"click\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        } else if (labelTitle.attachEvent) {\n            labelTitle.attachEvent(\"onclick\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        }\n        divTitle.appendChild(labelTitle);\n        // enregistrement utile pour la méthode : collapse()\n        this.DomToggle = labelTitle;\n\n        div.appendChild(divTitle);\n\n        // ajout des outils au fin du composant\n        if (this.options.tools.icon.anchor === \"end\") {\n            _addTools.apply(this);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Layer instance\n     */\n    add () {\n        logger.trace(\"add()\");\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Add style in the submenu\n     *\n     * @param {Object} style - style object\n     */\n    addStyle (style) {\n        logger.trace(\"addStyle()\", style);\n        if (style && typeof style === \"object\" && style instanceof Style) {\n            this.oStyle = style;\n            this.oStyle.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add filter in the submenu\n     *\n     * @param {Object} filter - filter object\n     */\n    addFilter (filter) {\n        logger.trace(\"addFilter()\", filter);\n        if (filter && typeof filter === \"object\" && filter instanceof Filter) {\n            this.oFilter = filter;\n            this.oFilter.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add Legend in the submenu\n     *\n     * @param {Object} legend - legend object\n     */\n    addLegend (legend) {\n        logger.trace(\"addLegend()\", legend);\n        if (legend && typeof legend === \"object\" && legend instanceof Legend) {\n            this.oLegend = legend;\n            this.oLegend.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Integrate Legend to the layer container\n     */\n    slotLegend () {\n        // cas particulier :\n        // on souhaite intégrer une partie de la legende dans le container du layer.\n        var legend = this.oLegend;\n        if (legend) {\n            // FIXME c'est pourri...\n            var node = null;\n            var nodesLvl1 = this.container.childNodes;\n            if (nodesLvl1.length) {\n                // selon où se situe l'icone de visibilité : au debut ou à la fin...\n                var idx = (this.options.tools.icon.anchor === \"start\") ? 1 : 0;\n                var nodesLvl2 = nodesLvl1[idx].childNodes;\n                // on recherche le container de la legende\n                for (var i = 0; i < nodesLvl2.length; i++) {\n                    var curnode = nodesLvl2[i];\n                    if (curnode.id.indexOf(this.name.containerlegend) !== -1) {\n                        node = curnode;\n                    }\n                }\n            }\n            if (node) {\n                var render = legend.getRenderContainer();\n                if (render) {\n                    node.appendChild(render);\n                    // legende intégrée\n                    this.bSlotLegend = true;\n                }\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Set visibility or get\n     *\n     * @param {Boolean} display - set visibility or undefined to get status\n     * @returns {Boolean} - true/false\n     */\n    visibility (display) {\n        logger.trace(\"visibility()\", display);\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        if (typeof display !== \"undefined\") {\n            this.DomVisibility.checked = (display) ? \"checked\" : \"\";\n        }\n        return this.DomVisibility.checked;\n    }\n\n    /**\n    * Collapse a layer panel (event)\n    */\n    collapse () {\n        logger.trace(\"collapse()\");\n        this.DomToggle.click();\n    }\n\n    /**\n    * Click on visibility icon (event)\n    */\n    visible () {\n        logger.trace(\"visible()\");\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        this.DomVisibility.click();\n    }\n\n    /**\n     * Set collapse or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        var checked = document.getElementById(this.DomToggle.htmlFor).checked;\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"inline-flex\" : \"none\";\n            if (this.oStyle) {\n                this.oStyle.display(display && checked);\n            }\n            if (this.oFilter) {\n                this.oFilter.display(display && checked);\n            }\n            if (this.oLegend) {\n                this.oLegend.display(display && checked);\n            }\n        }\n        return checked;\n    }\n\n    /**\n     * Set disabled/enabled status or get\n     *\n     * @param {Boolean} active - disable/enable layer interaction or get status\n     * @returns {Boolean} - true/false\n     */\n    active (active) {\n        logger.trace(\"active()\", active);\n        if (typeof active !== \"undefined\") {\n            this.container.className = (active)\n                ? this.name.container\n                : this.name.container + \" disabled\";\n        }\n        return (this.container.className === this.name.container);\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onClickLayerMapBox (e) {\n        logger.trace(\"onClickLayerMapBox\", e);\n\n        var id = e.target.htmlFor.substring(e.target.htmlFor.indexOf(\"-\"));\n        var checked = document.getElementById(e.target.htmlFor).checked;\n\n        // gestion des inputs\n        if (e.target.htmlFor === this.name.imagelabelinput + id) {\n            document.getElementById(this.name.titleinput + id).checked = !checked;\n        }\n        if (e.target.htmlFor === this.name.titleinput + id) {\n            // si options.pin:false, ce DOM n'existe pas !\n            if (document.getElementById(this.name.imagelabelinput + id)) {\n                document.getElementById(this.name.imagelabelinput + id).checked = !checked;\n            }\n        }\n\n        // ouverture du panneau des styles / filtres\n        if (this.oStyle) {\n            this.oStyle.display(!checked);\n        }\n        if (this.oFilter) {\n            this.oFilter.display(!checked);\n        }\n        // attention,\n        // si la legende est non editable, elle ne se trouve pas dans le sous menu !\n        if (this.oLegend && this.oLegend.isEditable()) {\n            this.oLegend.display(!checked);\n        }\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickvisibility\n     */\n    onVisibilityLayerMapBox (e) {\n        logger.trace(\"onVisibilityLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickvisibility, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickclone\n     */\n    onCloneLayerMapBox (e) {\n        logger.trace(\"onCloneLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickclone, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickremove\n     */\n    onRemoveLayerMapBox (e) {\n        logger.trace(\"onRemoveLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickremove, e);\n    }\n\n};\n\nexport default Layer;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    if (!window.ol.style.editor) {\n        window.ol.style.editor = {};\n    } \n    window.ol.style.editor.Layer = Layer;\n}\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-group\");\n\n/**\n * @classdesc\n *\n * MapBox group management\n *\n * @constructor\n * @alias ol.style.editor.Group\n * @param {Object} options - options for function call.\n * @example\n *   var group = new Group ({\n *      title : \"MyGroup\",\n *      collapse : true, // plier/deplier\n *      target : ...\n *   });\n *   group.add();\n *   group.add();\n */\nclass Group {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Group\", options);\n\n        // options\n        this.options = options || {\n            // default...\n        };\n\n        if (!(this instanceof Group)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.title) {\n            // cf. summary\n            this.options.title = \"Détails du groupe...\";\n        }\n\n        // plier par defaut\n        if (typeof this.options.collapse === \"undefined\") {\n            this.options.collapse = true;\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxGroupTarget\",\n            container : \"GPEditorMapBoxGroupContainer\",\n            details : \"GPEditorMapBoxGroupDetails\",\n            summary : \"GPEditorMapBoxGroupSummary\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxGroupContainer\">...</div>\n     */\n    _initContainer () {\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // FIXME pas compatible IE !\n        // https://caniuse.com/#search=details\n        // cf. https://css-tricks.com/quick-reminder-that-details-summary-is-the-easiest-way-ever-to-make-an-accordion/\n        var details = document.createElement(\"details\");\n        details.className = this.name.details;\n        details.open = !this.options.collapse;\n        div.appendChild(details);\n\n        var summary = document.createElement(\"summary\");\n        summary.className = this.name.summary;\n        summary.innerHTML = this.options.title;\n        details.appendChild(summary);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"flex\" : \"none\";\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        var nodes = this.container.childNodes;\n        if (nodes.length) {\n            // retourne le noeud \"details\" !\n            return nodes[0];\n        }\n        // sinon le container principal\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * NOT USED !\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Group#editor:group:oncollapse\n     */\n    onCollapseGroupMapBox (e) {\n        logger.trace(\"onCollapseGroupMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.group.oncollapse, e);\n    }\n\n};\n\nexport default Group;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-search\");\n\n/**\n * @classdesc\n *\n * TODO MapBox search management\n *\n * @constructor\n * @alias ol.style.editor.Search\n * @param {Object} options - options for function call.\n * @todo\n * @example\n *   var Search = new Search ({\n *      target : ...,\n *      tools : {\n *          // ...\n *      }\n *      title : \"Filtres de recherche :\",\n *      obj : {}\n *   });\n *  Search.add();\n *  Search.display(true);\n *  Search.getContainer();\n */\nclass Search {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Search\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Search)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {};\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {};\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"Recherche de couches :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxSearchTarget\",\n            container : \"GPEditorMapBoxSearchContainer\"\n            // TODO ...\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxSearchContainer\">\n     *  // ...\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        // var self = this;\n        var _search = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        if (_search.layers) {\n            if (_search.layers.length === 0) {\n                logger.info(\"tag 'layers' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // TODO...\n        // outil de recherche des couches mapbox.\n        // 2 modes de recherches : exact ou par autocompletion\n        // affichage des resultats directement dans la liste des couches\n        // la recherche porte sur les champs suiavnts (options):\n        // * id (par defaut)\n        // * source-layer (par defaut)\n        // * type (ex. Symbol)\n        // * field (ex. HOPITAL_PONC) > recherche dans le champs filtre\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Search instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onsubmit\n     */\n    onSubmitSearchLayersMapBox (e) {\n        logger.trace(\"onSubmitSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onsubmit, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onautocomplete\n     */\n    onAutocompleteSearchLayersMapBox (e) {\n        logger.trace(\"onAutocompleteSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onautocomplete, e);\n    }\n\n};\n\nexport default Search;\n","var EditorDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    }\n};\n\nexport default EditorDOM;\n","// import CSS\nimport \"../../CSS/Controls/Editor/GPFeditor.css\";\n// import \"../../CSS/Controls/Editor/GPFeditorStyle.css\";\n// import library\nimport EventBus from \"eventbusjs\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Style from \"./Style\";\nimport Themes from \"./Themes\";\nimport Filter from \"./Filter\";\nimport Legend from \"./Legend\";\nimport Layer from \"./Layer\";\nimport Group from \"./Group\";\nimport Event from \"./Event\";\nimport Search from \"./Search\";\n\n// DOM\nimport EditorDOM from \"./EditorDOM\";\n\nvar logger = Logger.getLogger(\"editor\");\n\n/**\n * @classdesc\n *\n * Editor Styles MapBox...\n *\n * @constructor\n * @alias ol.style.Editor\n * @param {Object} options - options for function call.\n * @fires editor:layer:onclickvisibility\n * @fires editor:layer:onclickclone\n * @fires editor:layer:onclickremove\n * @fires editor:style:oneditjson\n * @fires editor:style:scale:onchangemin\n * @fires editor:style:scale:onchangemax\n * @fires editor:legend:onclickedition\n * @fires editor:legend:onchangevalue\n * @fires editor:filter:oneditjson\n * @fires editor:themes:onclickimage\n * @fires editor:themes:onclicktitle\n * @fires editor:group:oncollapse\n * @fires editor:onloaded\n * @example\n *   var editor = new Editor ({\n *      target : \"\",\n *      style : \"data/styles/layer.json\",\n *      themes: {\n *          themesSummary : \"\",\n *          themes : [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *      },\n *      scope : this,\n *      events : {\n *          \"editor:layer:onclickvisibility\" : ...,\n *          \"editor:layer:onclickclone\" : ...,\n *          \"editor:layer:onclickremove\" : ...,\n *          \"editor:style:oneditjson\" : ...,\n *          \"editor:style:scale:onchangemin\" : ...,\n *          \"editor:style:scale:onchangemax\" : ...,\n *          \"editor:filter:oneditjson\" : ...,\n *          \"editor:themes:onclickimage\" : this._onClickEventImageTheme(),\n *          \"editor:themes:onclicktitle\" : function(e) {...}\n *      },\n *      tools : {\n *          // afficher/cacher les themes (par defaut) ou utiliser les options\n *          themes : true | false | {\n *              target : \"...\",\n *              tools : {\n *                  \"thumbnails\": true,\n *                  \"button\": { visible : true, type : \"checkbox\" }\n *              },\n *          },\n *          layers : true | false,     // afficher les couches (layers)\n *          search : true | false,     // TODO : afficher l'outil de recheche de couches\n *          style : true | false,      // afficher les styles (sous menu layers)\n *          filter : true | false,     // afficher les filtres (sous menu layers)\n *          legend : true | false,     // afficher les legendes (layers)\n *          group : true | false,      // grouper les couches, l'option 'sort' doit être activée (layers)\n *          groupAuto : true | false,  // definir la construction automatiques des groupes\n *          sort : true | false,       // trier les couches (layers)\n *          sortBy : \"id|class|geom\",  // definir le type de tri (layers)\n *          sortOrder : \"asc, desc\",   // definir l'ordre de tri (layers)\n *          title : true | false       // afficher les titres des rubriques,\n *          collapse : true | false | undefined // afficher et/ou plier les couches ou ne pas afficher l'option,\n *          type : true | false,       // afficher le type de geometrie (layers)\n *          pin : true | false,        // afficher la puce pour chaque couche (layers)\n *          visibility : true | false, // afficher l'icone de visibilité (layers),\n *          icon : {                   // afficher l'icone \"oeil\" ou \"checkbox\" (layers),\n *              \"image\" : true,\n *              \"anchor\" : \"start\" // afficher l'icone au debut ou à la fin de la ligne\n *          },\n *          editable : true | false    // active l'edition de la legende (legendes)\n *      }\n *   });\n *   // options par defaut\n *   {\n *      themes : false,\n *      layers : true,\n *      search : false,\n *      style : false,\n *      filter : false,\n *      legend : false,\n *      group : false,\n *      groupAuto : false,\n *      sort : true,\n *      sortBy : \"id\",\n *      sortOrder : \"asc\",\n *      title : true,\n *      collapse : undefined,\n *      type : true,\n *      pin : true,\n *      visibility : true,\n *      icon : {\n *          image : true,\n *          anchor : \"end\"\n *      },\n *      editable : true\n *   }\n *   // Context\n *   editor.setContext(\"map\", map);\n *   editor.setContext(\"layer\", layer);\n *   // create DOM\n *   editor.createElement()\n *     .then(() => {\n *       console.warn(editor.getID());\n *       console.log(this.getContext(\"map\"));\n *       console.log(this.getContext(\"layer\"));\n *     })\n *     .catch(error => {});\n *   // possibility to add listeners with globale variable : eventbus\n *   eventbus.addEventListener(\"editor:style:scale:onchangemin\", function (e) {...});\n */\nclass Editor {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Editor\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Editor)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // gestion des options\n        if (!this.options.target) {\n            logger.info(\"La 'target' n'est pas renseignée (options.target).\");\n        }\n\n        if (!this.options.style) {\n            logger.error(\"Le 'style' MapBox n'est pas renseigné (options.style) !\");\n            return;\n        }\n\n        if (this.options.events) {\n            this._initEvents();\n        } else {\n            logger.warn(\"Les 'handlers' ne sont pas renseignés (options.events) !\");\n        }\n\n        if (!this.options.themes) {\n            logger.info(\"Les 'themes' MapBox ne sont pas renseignés (options.themes).\");\n        }\n\n        // options par defaut\n        var _toolsDefault = {\n            themes : false,\n            layers : true,\n            search : false,\n            style : false,\n            filter : false,\n            legend : false,\n            group : false,\n            groupAuto : false,\n            sort : true,\n            sortBy : \"id\",\n            sortOrder : \"asc\",\n            title : true,\n            collapse : undefined,\n            type : true,\n            pin : true,\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            editable : true\n        };\n\n        if (!this.options.tools) {\n            logger.trace(\"Utilisation des outils MapBox par défaut (options.tools).\");\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        // id unique\n        this.id = this.options.id || ID.generate();\n\n        // context\n        this.context = {};\n        // property layers\n        this.layers = [];\n        // dom container\n        this.container = null;\n        // dom name\n        this.name = {\n            target : \"GPEditorMapBoxTarget\",\n            container : \"GPEditorMapBoxContainer\",\n            containerID : \"GPEditorMapBoxContainer_ID_\",\n            containerLayers : \"GPEditorMapBoxLayersContainer\",\n            titleLayers : \"GPEditorMapBoxLayersTitle\",\n            titleLayersID : \"GPEditorMapBoxLayersTitle_ID_\",\n            titleThemes : \"GPEditorMapBoxThemesTitle\",\n            titleThemesID : \"GPEditorMapBoxThemesTitle_ID_\",\n            sep : \"GPEditorMapBoxSep\"\n        };\n        // style json\n        this.mapbox = {};\n        // INFO\n        // sprites :\n        // {\n        //     url : null,\n        //     size : {\n        //         h : null,\n        //         w : null\n        //     },\n        //     json : {}\n        // }\n        this.sprites = {};\n    }\n\n    /**\n    * Initialize events with handlers\n    * (called by constructor)\n    *\n    * List Events :\n    *          \"editor:layer:visibility\"\n    *          \"editor:layer:clone\"\n    *          \"editor:layer:remove\"\n    *          \"editor:style:edit\"\n    *          \"editor:style:minScale\"\n    *          \"editor:style:maxScale\"\n    *          \"editor:filter:edit\"\n    *          \"editor:themes:image\",\n    *          \"editor:themes:title\"\n    * @private\n    */\n    _initEvents () {\n        var ctx = this.options.scope || this;\n        var events = this.options.events;\n        if (events) {\n            for (var event in events) {\n                if (events.hasOwnProperty(event)) {\n                    var handler = events[event];\n                    // test sur les events disponibles !\n                    if (handler) {\n                        if (!EventBus.hasEventListener(event, handler, ctx)) {\n                            EventBus.addEventListener(event, handler, ctx);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @example\n     *  <div class=\"GPEditorMapBoxContainer\" id=\"GPEditorMapBoxContainer_ID_0\">\n     *    <div id=\"GPEditorMapBoxThemesTitle\" class=\"GPEditorMapBoxThemesTitle\">Liste des 'thèmes'</div>\n     *    <div class=\"GPEditorMapBoxThemesContainer\">\n     *      ...\n     *    </div>\n     *    <div id=\"GPEditorMapBoxLayersTitle\" class=\"GPEditorMapBoxLayersTitle\">Liste des 'couches'</div>\n     *    <div class=\"GPEditorMapBoxLayersContainer\">\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-0_1\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-0_1\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-0_1\" title=\"states\">population_lt_2m</label>\n     *          </div>\n     *      </div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *    </div>\n     *  </div>\n     * @private\n     */\n    _initContainer () {\n        logger.trace(this.mapbox);\n\n        // existance d'un autre container (editeur) ?\n        // var _idx = 0;\n        // var elements = document.querySelectorAll(\"div[id^=\" + this.name.containerID + \"]\");\n        // for (var j = 0; j < elements.length; j++) {\n        //     var element = elements[j];\n        //     var num = parseInt(element.id.substring(element.id.lastIndexOf(\"_\") + 1), 10);\n        //     if (num > _idx) {\n        //         _idx = num;\n        //     }\n        // }\n        // if (elements.length) {\n        //     _idx += 1;\n        // }\n        // container principal de l'editeur\n        var div = document.createElement(\"div\");\n        div.id = this.name.containerID + this.id;\n        div.className = this.name.container;\n\n        // Themes\n        var _toolsThemes = this.options.tools.themes;\n        if (_toolsThemes && this.options.themes) {\n            // title\n            if (this.options.tools.title) {\n                var titleThemes = document.createElement(\"div\");\n                titleThemes.id = this.name.titleThemesID + this.id;\n                titleThemes.className = this.name.titleThemes;\n                titleThemes.innerHTML = \"Liste des 'thèmes'\";\n                div.appendChild(titleThemes);\n            }\n\n            // lien vers les styles\n            var themes = new Themes({\n                id : this.id,\n                target : div,\n                tools : (typeof _toolsThemes === \"object\") ? _toolsThemes : {},\n                obj : this.options.themes\n            });\n            themes.add();\n        }\n\n        // TODO : Recheche / filtre de couches\n        if (this.options.tools.search) {\n            var search = new Search({\n                id : this.id,\n                target : div,\n                tools : {},\n                obj : this.mapbox.layers // liste des objets layers\n            });\n            search.add();\n        }\n\n        for (var source in this.mapbox.sources) {\n            if (this.mapbox.sources.hasOwnProperty(source)) {\n                if (this.options.tools.layers) {\n                    // multisources ? Si oui, on renseigne un titre...\n                    var multisources = (Object.keys(this.mapbox.sources).length > 1) ? 1 : 0;\n                    if (multisources) {\n                        var hr = document.createElement(\"hr\");\n                        hr.className = this.name.sep;\n                        div.appendChild(hr);\n                    }\n                    // title\n                    if (this.options.tools.title) {\n                        var titleLayers = document.createElement(\"div\");\n                        titleLayers.id = this.name.titleLayersID + this.id;\n                        titleLayers.className = this.name.titleLayers;\n                        titleLayers.innerHTML = (multisources) ? \"Liste des 'couches' (\" + source + \")\" : \"Liste des 'couches'\";\n                        div.appendChild(titleLayers);\n                    }\n                }\n\n                // gestion de l'ordre avant tri avec la metadata 'order'\n                var _layers = this.mapbox.layers.slice(); // clone\n\n                // une fois les layers triés, la metadata:geoportail:order permet\n                // de savoir l'emplacement du layers dans le fichier de style.\n                _layers.forEach(function (layer, order) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // ajout de la metadata d'ordre\n                    var _metadata = layer[\"metadata\"];\n                    if (_metadata) {\n                        _metadata[\"geoportail:order\"] = order;\n                    } else {\n                        layer[\"metadata\"] = {\n                            \"geoportail:order\" : order\n                        };\n                    }\n                });\n                // tri des layers\n                if (this.options.tools.sort) {\n                    var sortBy = this.options.tools.sortBy;\n                    var sortOrder = this.options.tools.sortOrder;\n                    var sortFct = function (a, b) {\n                        // si on utilise les groupements utilisateurs, ils doivent\n                        // tous être renseignés sinon..., ça va coincer !\n                        var result = 0;\n                        if (a[\"metadata\"] &&\n                            a[\"metadata\"][\"geoportail:group\"] &&\n                            b[\"metadata\"] &&\n                            b[\"metadata\"][\"geoportail:group\"]) {\n                            var cmpA = null;\n                            var cmpB = null;\n                            cmpA = a[\"metadata\"][\"geoportail:group\"];\n                            cmpB = b[\"metadata\"][\"geoportail:group\"];\n                            result = cmpA.localeCompare(cmpB);\n                        } else {\n                            switch (sortBy) {\n                                case \"geom\":\n                                    result = sortOrder === \"asc\" ? a.type.localeCompare(b.type) || a.id.localeCompare(b.id)\n                                        : b.type.localeCompare(a.type) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"class\":\n                                    result = sortOrder === \"asc\" ? a[\"source-layer\"].localeCompare(b[\"source-layer\"]) || a.id.localeCompare(b.id)\n                                        : b[\"source-layer\"].localeCompare(a[\"source-layer\"]) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"id\":\n                                default:\n                                    // tri sur l'id par defaut\n                                    result = sortOrder === \"asc\" ? a.id.localeCompare(b.id) : b.id.localeCompare(a.id);\n                                    break;\n                            }\n                        }\n                        return result;\n                    };\n\n                    _layers.sort(sortFct);\n                }\n\n                logger.trace(\"Layers : \", _layers);\n\n                // gestion des groupes avec la metadata de groupe\n                var groupBy = this.options.tools.sortBy; // le même type de tri que les couches !\n                var groupAuto = this.options.tools.groupAuto;\n                var _groups = {}; // liste et comptage des layers dans chaque groupes\n                _layers.forEach(function (layer) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // balise metadata\n                    var _metadata = layer[\"metadata\"];\n                    // s'il existe déjà une meta de groupe, on l'utilise...\n                    // sinon, on la met en place.\n                    if (_metadata && _metadata[\"geoportail:group\"]) {\n                        var _groupName = _metadata[\"geoportail:group\"];\n                        _groups[_groupName] = (_groups[_groupName])\n                            ? _groups[_groupName] + 1 : 1;\n                    } else {\n                        var _field = null;\n                        switch (groupBy) {\n                            case \"class\":\n                                _field = layer[\"source-layer\"];\n                                break;\n                            case \"geom\":\n                                _field = layer.type;\n                                break;\n                            case \"id\":\n                            default:\n                                _field = layer.id;\n                                break;\n                        }\n                        var _newGroupName = _field;\n                        if (groupAuto) {\n                            // separateur\n                            var _regex = /_|-|:|=/; // TODO à definir via une option !\n\n                            // index\n                            var _idx = _field.search(_regex);\n                            // y'a t il un separateur ?\n                            _newGroupName = (_idx !== -1) ? _field.substring(0, _idx).trim() : _field;\n                        }\n                        // on compte le nombre d'entrée dans un groupe\n                        _groups[_newGroupName] = (_groups[_newGroupName])\n                            ? _groups[_newGroupName] + 1 : 1;\n\n                        // ajout de la metadata de groupe\n                        if (_metadata) {\n                            _metadata[\"geoportail:group\"] = _newGroupName;\n                        } else {\n                            layer[\"metadata\"] = {\n                                \"geoportail:group\" : _newGroupName\n                            };\n                        }\n                    }\n                });\n\n                logger.trace(\"Groups : \", _groups);\n\n                // container principal des couches\n                var divLayers = document.createElement(\"div\");\n                divLayers.className = this.name.containerLayers;\n                div.appendChild(divLayers);\n\n                var details;\n                if (this.options.tools.collapse !== undefined) {\n                    details = document.createElement(\"details\");\n                    details.className = \"\";\n                    details.open = !this.options.tools.collapse;\n                    divLayers.appendChild(details);\n\n                    var summary = document.createElement(\"summary\");\n                    summary.className = \"\";\n                    summary.innerHTML = \"\";\n                    details.appendChild(summary);\n                }\n\n                // container courant (cf. groupe) pour l'ajout des elements\n                var target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n\n                // Ex. Layers, Styles, Groups et Filtres\n                //  \"id\": \"ocs - vegetation\",\n                //  \"type\": \"fill\",\n                //  \"source\": \"pyramide_proto\",\n                //  \"source-layer\": \"ocs_vegetation_surf\",\n                //  \"metadata\" : {\n                //      \"geoportail:group\": \"ocs\"\n                //  },\n                //  \"layout\": {\n                //    \"visibility\": \"visible\"\n                //  },\n                //  \"filter\": [\"in\",\"symbo\",\n                //      \"SURFACE_D_EAU\",\n                //      \"BASSIN\",\n                //      \"ZONE_MARINE\"\n                //  ],\n                //  \"paint\": {\n                //    \"fill-color\": \"#2BB3E1\"\n                //  }\n                var index = -1;\n                for (var ii = 0; ii < _layers.length; ii++) {\n                    var data = _layers[ii];\n                    index++;\n\n                    // traitement dans l'ordre des sources\n                    if (data.source === source) {\n                        // Groups\n                        // INFO la gestion des groupes est basée sur la balise metadata::geoportail:group\n                        // ainsi que sur l'ordre des couches.\n                        // il n'y a pas de regroupement sans tri des couches !\n                        if (this.options.tools.group && this.options.tools.sort) {\n                            var mtd = data.metadata;\n                            // creation du container de groupe\n                            // si le tag metadata existe\n                            if (mtd) {\n                                var grp = data.metadata[\"geoportail:group\"];\n                                if (grp) {\n                                    // le groupe doit contenir plus d'un element\n                                    if (_groups[grp] > 1) {\n                                        // le groupe est déjà créé, on en veut plus par la suite...\n                                        _groups[grp] = -1;\n                                        // creation du groupe\n                                        var oGroup = new Group({\n                                            id : this.id,\n                                            target : (this.options.tools.collapse !== undefined) ? details : divLayers,\n                                            title : grp,\n                                            collapse : true\n                                        });\n                                        oGroup.add();\n                                        // le nouveau container pour les elements suivants\n                                        target = oGroup.getContainer();\n                                    } else if (_groups[grp] === 1) {\n                                        // l'element est seul, donc pas d'ajout dans le\n                                        // groupe en cours\n                                        target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                    } else {\n                                        // on ajoute l'element dans le groupe courant...\n                                    }\n                                } else {\n                                    target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                }\n                            } else {\n                                target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                            }\n                        }\n                        // Layers\n                        if (this.options.tools.layers) {\n                            var oLayer = new Layer({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !\n                                tools : {\n                                    visibility : this.options.tools.visibility,\n                                    icon : this.options.tools.icon,\n                                    type : this.options.tools.type,\n                                    pin : this.options.tools.pin\n                                },\n                                obj : {\n                                    id : data.id,\n                                    type : data.type,\n                                    source : data.source,\n                                    \"source-layer\" : data[\"source-layer\"]\n                                }\n                            });\n                            oLayer.add();\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                            // sauvegarde des layers\n                            this.layers.push(oLayer);\n                        }\n                        // Legende\n                        if (this.options.tools.legend) {\n                            // gestion de l'edition de la legende :\n                            // l'option \"editable\" est prioritaire sur le tag \"editable\" du fichier de style !\n                            var isEditable = this.options.tools.editable;\n                            if (typeof isEditable === \"undefined\") {\n                                isEditable = data.editable;\n                            }\n                            var oLegend = new Legend({\n                                id : this.id,\n                                target : target,\n                                sprites : this.sprites,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    title : data.id,\n                                    editable : (typeof isEditable !== \"undefined\") ? isEditable : false,\n                                    paint : data.paint,\n                                    layout : data.layout\n                                }\n                            });\n                            oLegend.add();\n                            oLegend.display(false);\n                            if (oLayer) {\n                                oLayer.addLegend(oLegend);\n                                oLayer.slotLegend(); // integration de la legende dans le container du layers !\n                            }\n                        }\n                        // Style\n                        if (this.options.tools.style) {\n                            var oStyle = new Style({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    layout : data.layout,\n                                    paint : data.paint\n                                }\n                            });\n                            oStyle.add();\n                            oStyle.display(false);\n                            if (oLayer) {\n                                oLayer.addStyle(oStyle);\n                            }\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                        }\n                        // Filter\n                        if (this.options.tools.filter) {\n                            var oFilter = new Filter({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    filter : data.Filter\n                                }\n                            });\n                            oFilter.add();\n                            oFilter.display(false);\n                            if (oLayer) {\n                                oLayer.addFilter(oFilter);\n                            }\n                        }\n                    } else {\n                        // on ecarte un layer car il n'est pas reconnu dans la source\n                        // on decremente la position du layer\n                        if (index >= 0) {\n                            index--;\n                        }\n                    }\n                }\n            }\n        }\n\n        // sauvegarde\n        this.container = div;\n\n        // container principal\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var _target = document.createElement(\"div\");\n                _target.id = this.name.target;\n                var node = document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0] ||\n                    document.documentElement;\n                node.appendChild(_target);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        // dispatch event\n        EventBus.dispatch(Event.onloaded, this);\n    }\n\n    /**\n     * Getting Sprites informations\n     * (called by _initialize)\n     *\n     * @param {String} sprites - url des sprites\n     * @returns {Promise} - promise\n     * @private\n     */\n    _getSprites (sprites) {\n        var self = this;\n\n        // on ne doit pas mettre de promise en échec...\n        // car on souhaite continuer le traitement même si on n'a pas de sprites !\n        // si le protocole est mapbox://\n        if (sprites && sprites.startsWith(\"mapbox://\")) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Protocole mapbox:// non géré !\");\n                resolve(self);\n            });\n        }\n        // si pas de sprites\n        if (!sprites) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Auncun sprites disponibles !\");\n                resolve(self);\n            });\n        }\n\n        var fetchSpritesImage = function () {\n            var spritesImage = sprites + \".png\";\n            return fetch(spritesImage, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.blob()\n                            .then(function (blob) {\n                                self.sprites.url = spritesImage;\n                                // decode de l'image\n                                var theImage = new Image();\n                                theImage.src = spritesImage;\n                                return theImage.decode()\n                                    .then(function () {\n                                        self.sprites.size = {};\n                                        self.sprites.size.h = theImage.height;\n                                        self.sprites.size.w = theImage.width;\n                                    });\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch image sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch image sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n        var fetchSpritesJson = function () {\n            var spritesJson = sprites + \".json\";\n            return fetch(spritesJson, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.json()\n                            .then(function (json) {\n                                self.sprites.json = json;\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch json sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch json sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n\n        // promise\n        return Promise.all([\n            fetchSpritesImage(),\n            fetchSpritesJson()\n        ]);\n    }\n\n    // ################################################################### //\n    // ########################## INTERFACE ############################## //\n    // ################################################################### //\n    /**\n     * Create Editor\n     *\n     * @returns {Promise} - promise\n     */\n    createElement () {\n        var self = this;\n        // objet json\n        if (typeof this.options.style === \"object\") {\n            this.mapbox = this.options.style;\n            // les sprites sont utiles que si on veut une legende !\n            if (this.options.tools.legend) {\n                return this._getSprites(this.mapbox.sprite)\n                    .then(function () {\n                        // init du DOM\n                        self._initContainer();\n                        return self;\n                    })\n                    .catch(error => {\n                        logger.warn(\"fetch sprites exception :\", error);\n                    });\n            } else {\n                return new Promise((resolve, reject) => {\n                    self._initContainer();\n                    resolve(self);\n                });\n            }\n        }\n\n        // url\n        if (typeof this.options.style === \"string\") {\n            return fetch(this.options.style, {\n                credentials : \"same-origin\"\n            })\n                .then(response => {\n                    // sauvegarde du json\n                    return response.json()\n                        .then(style => {\n                            self.mapbox = style;\n                        })\n                        .then(function () {\n                            // les sprites sont utiles que si on veut une legende !\n                            if (self.options.tools.legend) {\n                                return self._getSprites(self.mapbox.sprite)\n                                    .then(function () {\n                                        // init du DOM\n                                        self._initContainer();\n                                        return self;\n                                    })\n                                    .catch(error => {\n                                        logger.warn(\"fetch sprites exception :\", error);\n                                    });\n                            } else {\n                                return new Promise((resolve, reject) => {\n                                    self._initContainer();\n                                    resolve(self);\n                                });\n                            }\n                        })\n                        .catch(error => {\n                            logger.error(\"json exception :\", error);\n                        });\n                })\n                .catch(error => {\n                    logger.error(\"fetch exception :\", error);\n                });\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"block\" : \"none\";\n    }\n\n    setContext (key, value) {\n        this.context[key] = value;\n    }\n\n    getContext (key) {\n        return this.context[key];\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Get id editor\n     * @returns {Number} id\n     */\n    getID () {\n        return this.id;\n    }\n\n    /**\n     * Get container (DOM)\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    /**\n     * Get Style (json)\n     * @returns {Object} Style MapBox\n     */\n    getStyle () {\n        return this.mapbox;\n    }\n\n    /**\n     * Get layer style (json)\n     * @param {Number} i - index\n     * @returns {Object} Style MapBox of a layers\n     */\n    getStyleLayer (i) {\n        var layer = null;\n        var o = this.getLayer(i);\n        var id = o.options.obj.id;\n        for (var k = 0; k < this.mapbox.layers.length; k++) {\n            var l = this.mapbox.layers[k];\n            if (l.id === id) {\n                layer = l;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get layer object from json style\n     * @param {Number} i - index into style json\n     * @returns {Object} Style MapBox of a layers\n     */\n    getLayerFromStyle (i) {\n        var layer = null;\n        var l = this.mapbox.layers[i];\n        for (var k = 0; k < this.getLayers().length; k++) {\n            var o = this.getLayer(k);\n            if (l.id === o.options.obj.id) {\n                layer = o;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get a list of layer object sorted or not (see options.tools.sort)\n     * @returns {Array} - List of layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayers () {\n        return this.layers;\n    }\n\n    /**\n     * Get the layer object from a list sorted or not (see options.tools.sort)\n     * @param {Number} i - index\n     * @returns {Object} - layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayer (i) {\n        return this.layers[i];\n    }\n\n};\n\n// on récupère les méthodes de la classe DOM\nUtils.assign(Editor.prototype, EditorDOM);\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\nexport default Editor;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    window.ol.style.Editor = Editor;\n}\n"],"names":["hex","number","Error","Number","toString","slice","num","hexa","parseInt","arrayToRgba","values","Array","isArray","red","green","blue","alpha","parseFloat","arrayToHex","elems","this","result","join","opacity","rgbaToHex","rgba","parsed","exec","hexToRgba","replace","m","r","g","b","rgb","isHex","value","charAt","isRGB","detectSupport","isDesktop","userAgent","window","navigator","toLowerCase","indexOf","assign","dest","source","prop","hasOwnProperty","mergeParams","param","_typeof","getLogger","name","process","VERBOSE","env","Log","logname","disableAll","loggers","key","Object","call","enableAll","timestamp","generate","Math","floor","Date","now","id","i","lastIndexOf","substring","index","uuid","EventBusClass","module","exports","listeners","prototype","addEventListener","type","callback","scope","args","numOfArgs","arguments","length","push","splice","removeEventListener","numOfCallbacks","newArray","listener","hasEventListener","undefined","dispatch","target","event","concat","concatArgs","apply","getEvents","str","className","noop","undefinedType","isIE","test","logMethods","_loggersByName","defaultLogger","bindMethod","obj","methodName","method","bind","Function","e","traceForIE","console","log","trace","realMethod","replaceLoggingMethods","level","getLevel","methodFactory","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","Logger","factory","inheritedLevel","defaultLevel","userLevel","self","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","location","clearPersistedLevel","removeItem","normalizeLevel","input","TypeError","setLevel","persist","setDefaultLevel","resetLevel","TRACE","rebuild","childName","initialLevel","logger","_log","noConflict","getLoggers","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","onloaded","layer","onclickvisibility","onclickclone","onclickremove","legend","onclickedition","onchangevalue","group","oncollapse","style","oneditjson","scale","onchangemin","onchangemax","filter","themes","onclickimage","onclicktitle","search","onsubmit","onautocomplete","Style","options","_classCallCheck","position","tools","title","_initialize","_initContainer","_toolsDefault","edition","Utils","paint","layout","container","containerjson","jsonlabel","jsondisplay","containertoolsscale","scaletitle","containertoolsminscale","scalelabelmin","scaleinputmin","containertoolsmaxscale","scalelabelmax","scaleinputmax","containertoolsedit","_found","_obj","JSON","parse","stringify","_style","keys","info","visibility","div","createElement","json","strJson","_syntaxHighlight","divJson","label","innerHTML","appendChild","pre","onEditJsonStyleMapBox","attachEvent","_createElementToolsScale","min","minzoom","max","maxzoom","_createElementToolsEdition","divToolsScale","divMin","labelMin","inputMin","disabled","data","onChangeStyleScaleMinMapBox","divMax","labelMax","inputMax","onChangeStyleScaleMaxMapBox","warn","divToolsEdit","match","cls","getElementById","documentElement","getElementsByTagName","display","editorID","EventBus","EventEditor","ol","editor","Themes","thumbnails","button","visible","themesSummary","containertheme","containerthemeID","inputID","labelID","image","imageID","message","ID","_lstThemes","_theme","divTheme","tabIndex","_url","url","_selected","selected","_type","_button","checked","onClickThemeTitleMapBox","thumbnail","_img","src","alt","description","onClickThemeImageMapBox","nodes","parentElement","childNodes","node","tagName","_label","htmlFor","_msg","targetIDX","previousSibling","_inputs","getElementsByClassName","el","Filter","_filter","labelJson","preJson","onEditJsonFilterMapBox","divEdit","Legend","sprites","editable","_editable","legendRender","width","stroke","color","rendercontainer","toolscontainer","containerlegendrender","legendrender","legendeditable","legendtitle","containerlegendtools","labels","params","bFound","split","_getProperties","edit","_createElementIconLegend","_createElementEditionLegend","isTextValue","isIconValue","valuesSupported","val","PROPERTIES","includes","_getValue","k","svg","Color","x","y","height","size","w","h","lstrockedasharray","cstrockcolor","pattern","fstrokecolor","isNumber","forEach","v","stops","sort","numA","numB","onEditionLegendMapBox","_renderThumbnail","span","linecolor","lLineColor","inputLineColor","setAttribute","onChangeValueLegendMapBox","linewidth","lLineWidth","inputLineWidth","step","defaultValue","lineopacity","lLineOpacity","inputLineOpacity","fillcolor","lFillColor","inputFillColor","fillopacity","lFillOpacity","inputFillOpacity","line","fill","background","circle","icon","text","Layer","anchor","pin","remove","clone","_objDefault","bSlotLegend","oFilter","oStyle","oLegend","DomVisibility","DomToggle","containerlegend","containertitle","imagelabelinput","imagelabel","typeimg","titleinput","titlelabel","containertools","visibilityinput","visibilitylabel","visibilityinputdisable","visibilitylabeldisable","divTitle","inputImage","labelImage","onClickLayerMapBox","_addTools","divTools","inputTools","onVisibilityLayerMapBox","labelTools","imgType","divLegend","inputTitle","labelTitle","nodesLvl1","nodesLvl2","curnode","render","getRenderContainer","click","active","isEditable","Group","collapse","details","summary","open","Search","_search","layers","_addUID","_uid","Editor","events","_initEvents","groupAuto","sortBy","sortOrder","context","containerID","containerLayers","titleLayers","titleLayersID","titleThemes","titleThemesID","sep","mapbox","error","ctx","handler","_toolsThemes","add","sources","multisources","hr","_layers","order","_metadata","cmpB","cmpA","localeCompare","groupBy","_groups","_groupName","_field","_newGroupName","_idx","trim","divLayers","ii","metadata","grp","oGroup","getContainer","oLayer","addLegend","slotLegend","addStyle","addFilter","_target","Event","spritesImage","startsWith","Promise","resolve","reject","all","fetch","credentials","then","response","ok","blob","theImage","Image","decode","status","_getSprites","sprite","getLayer","l","getLayers","EditorDOM"],"sourceRoot":""}