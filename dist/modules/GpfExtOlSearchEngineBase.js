/*!
 * @brief geopf-extensions-openlayers
 *
 * This software is released under the licence AGPL-3.0
 * @see https://www.gnu.org/licenses/agpl-3.0.html#license-text
 * @see https://www.gnu.org/licenses/agpl-3.0.en.html#license-text
 *
 * @copyright copyright (c) IGN 
 * @license AGPL-3.0
 * @author IGN
 * @version 1.0.0-beta.6-471
 * @date 05/12/2025
 *
 */(()=>{var e={148:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(5844),r=n(7285),o=n.n(r);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,s(i.key),i)}}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function l(e,t){if(t&&("object"==a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(u=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}i.A.getLogger("searchengine");var h=function(e){function t(e){var n,i,r,o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,o=[e=e||{}],r=p(r=t),(n=l(i,u()?Reflect.construct(r,o||[],p(i).constructor):r.apply(i,o))).constructor==t)throw new TypeError("AbstractSearchService cannot be instantiate");return n.CLASSNAME="AbstractSearchService",n.initialize(e),l(n,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),n=t,(i=[{key:"initialize",value:function(e){this.AUTOCOMPLETE_EVENT="autocomplete",this.SEARCH_EVENT="search",this.ERROR_EVENT="error",this._autocompleteLocations=[],this._locations=[],!1===e.autocomplete&&this.set("autocomplete",!1),this.set("index",e.index||"address,poi"),this.set("limit","number"==typeof e.limit?e.limit:1),this.set("returnTrueGeometry",!!e.returnTrueGeometry)}},{key:"getAutocompleteLocations",value:function(e){return void 0===e?this._autocompleteLocations:this._autocompleteLocations[e]}},{key:"getResult",value:function(e){return void 0===e?this._locations:this._locations[e]}},{key:"autocomplete",value:function(e){}},{key:"search",value:function(e){}},{key:"getItemTitle",value:function(e){return e}}])&&c(n.prototype,i),r&&c(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,r}(o());const d=h;window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.AbstractSearchService=h)},562:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(7392),r=n.n(i),o=n(2940);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function s(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,f(i.key),i)}}function p(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function h(e,t,n){return t=m(t),function(e,t){if(t&&("object"==a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,d()?Reflect.construct(t,n||[],m(e).constructor):t.apply(e,n))}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(d=function(){return!!e})()}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}const y=function(e){function t(e){var n;return l(this,t),n=h(this,t,[{element:(e=e||{}).element,target:e.target,render:e.render}]),e&&e.listable?n.listable=!0:n.listable=!1,e&&e.description?n.description=e.description:n.description="",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),p(t,[{key:"setPosition",value:function(e){this.getMap()&&new w(this).set(e)}},{key:"updatePosition",value:function(e){this.getMap()&&new w(this).update(e)}}])}(r());var b=["top-left","top-right","bottom-left","bottom-right"],g=new WeakSet,w=function(){return p(function e(t){return l(this,e),c(this,g),this.caller=t,this.container=null,s(g,this,O).call(this,"top-left"),s(g,this,O).call(this,"top-right"),s(g,this,O).call(this,"bottom-left"),s(g,this,O).call(this,"bottom-right"),this},[{key:"set",value:function(e){b.includes(e.toLowerCase())&&(s(g,this,S).call(this,e,!1),e.includes("bottom")?this.container.children["position-container-"+e].prepend(this.caller.element):this.container.children["position-container-"+e].appendChild(this.caller.element))}},{key:"update",value:function(e){b.includes(e.toLowerCase())&&s(g,this,S).call(this,e,!0)}}])}();function E(e){return!!this.container.children["position-container-"+e]}function O(e){if(this.container=this.caller.getMap().getOverlayContainerStopEvent(),!s(g,this,E).call(this,e)){var t=document.createElement("div");t.id="position-container-"+e,t.className="position position-container-"+e,this.container.appendChild(t)}}function S(e,t){var n=this,i=function(e){return n.container.children["position-container-"+e].children.length},r=function(e){return n.container.children["position-container-"+e].offsetWidth},a=function(e){var i=n.container.children["position-container-"+e],r=i.offsetHeight;if(t){e.includes("top")&&(r=0);for(var o=0;o<i.children.length;o++){if(i.children[o].id===n.caller.element.id){r=e.includes("bottom")?r-n.caller.element.offsetHeight:-1*r;break}r-=i.children[o].offsetHeight}}return r},c=function(e){e.style.top="unset",e.style.bottom="unset",e.style.left="unset",e.style.right="unset"};c(this.caller.element),this.caller.element.style.position="unset";var s=Array.from(this.caller.element.getElementsByClassName("GPpanel"));if(0!==s.length){var l=0;s.forEach(function(t){if("dialog"===t.nodeName.toLowerCase()){switch(c(t),e.toLowerCase()){case"top-left":(0,o.A)()?t.style.top="0px":t.style.top=i(e)?a(e)+"px":"0px",t.style.left=r(e)+l+"px";break;case"bottom-left":(0,o.A)()?t.style.top="0px":t.style.bottom=i(e)?a(e)+"px":"0px",t.style.left=r(e)+l+"px";break;case"top-right":(0,o.A)()?t.style.top="0px":t.style.top=i(e)?a(e)+"px":"0px",t.style.right=r(e)+l+"px";break;case"bottom-right":(0,o.A)()?t.style.top="0px":t.style.bottom=i(e)?a(e)+"px":"0px",t.style.right=r(e)+l+"px"}l+=t.offsetWidth}})}}},2536:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}n.d(t,{A:()=>o});var r=0;const o={detectSupport:function(){var e=!0,t=window.navigator.userAgent.toLowerCase();return-1===t.indexOf("iphone")&&-1===t.indexOf("ipod")&&-1===t.indexOf("ipad")&&-1===t.indexOf("android")&&-1===t.indexOf("mobile")&&-1===t.indexOf("blackberry")&&-1===t.indexOf("tablet")&&-1===t.indexOf("phone")&&-1===t.indexOf("touch")||(e=!1),-1===t.indexOf("msie")&&-1===t.indexOf("trident")||(e=!0),e},assign:function(e,t){for(var n in e=e||{},t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},mergeParams:function(e,t,n){if(void 0!==e&&void 0!==t)for(var r in void 0===n&&(n=!0),t)t.hasOwnProperty(r)&&("object"===i(t[r])?e.hasOwnProperty(r)?this.mergeParams(e[r],t[r],n):e[r]=t[r]:e.hasOwnProperty(r)?n&&(e[r]=t[r]):e[r]=t[r])},getUid:function(e,t){return t&&t.id?t.id:e+ ++r}}},2940:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(){return""!==getComputedStyle(document.documentElement).getPropertyValue("--blue-france-sun-113-625")}},3065:function(e,t,n){var i,r;!function(){"use strict";i=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?c:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}function l(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function p(e,t,n){return s(e)||u.apply(this,arguments)}function f(e,n){var a,c,s,u=this,f="loglevel";function h(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&f){try{return void(window.localStorage[f]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+n+";"}catch(e){}}}function d(){var e;if(typeof window!==t&&f){try{e=window.localStorage[f]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(f),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}function m(){if(typeof window!==t&&f){try{window.localStorage.removeItem(f)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function v(e){var t=e;if("string"==typeof t&&void 0!==u.levels[t.toUpperCase()]&&(t=u.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=u.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?f+=":"+e:"symbol"==typeof e&&(f=void 0),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=n||p,u.getLevel=function(){return null!=s?s:null!=c?c:a},u.setLevel=function(e,t){return s=v(e),!1!==t&&h(s),l.call(u)},u.setDefaultLevel=function(e){c=v(e),d()||u.setLevel(e,!1)},u.resetLevel=function(){s=null,m(),l.call(u)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)},u.rebuild=function(){if(o!==u&&(a=v(o.getLevel())),l.call(u),o===u)for(var e in r)r[e].rebuild()},a=v(o?o.getLevel():"WARN");var y=d();null!=y&&(s=v(y)),l.call(u)}(o=new f).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new f(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o},void 0===(r="function"==typeof i?i.call(t,n,t,e):i)||(e.exports=r)}()},5844:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(3065),r={getLogger:function(e){if(void 0===t)var t={env:{VERBOSE:!1}};t.env.VERBOSE?i.enableAll():i.disableAll();var n=e||"default";return i.getLogger(n)},disableAll:function(){var e=i.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=i.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}};const o=r;window.Gp&&(window.Gp.Logger=r)},7285:e=>{"use strict";e.exports=ol.Object},7392:e=>{"use strict";e.exports=ol.control.Control}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var i={};(()=>{"use strict";n.d(i,{default:()=>P});var e=n(562),t=n(5844),r=n(148);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}function c(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function s(e,t,n){return t=u(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}t.A.getLogger("searchengine");var f=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=s(this,t,[e=e||{}])).CLASSNAME="DefaultSearchService",e.searchTab&&(n._searchTab=e.searchTab||[]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),n=t,(i=[{key:"autocomplete",value:function(e){var t=this;this._autocompleteLocations=[];var n=new RegExp(e,"i");(this._searchTab||[]).forEach(function(e){n.test(e.toLowerCase())&&t._autocompleteLocations.push(e)}),this.dispatchEvent({type:this.AUTOCOMPLETE_EVENT,result:this._autocompleteLocations})}},{key:"search",value:function(e){this.dispatchEvent({type:this.SEARCH_EVENT,result:e})}}])&&a(n.prototype,i),r&&a(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,r}(r.A);const h=f;window.ol&&(window.ol.service||(window.ol.service={}),window.ol.service.DefaultSearchService=f);var d=n(2536);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,y(i.key),i)}}function y(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=m(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}function b(e,t,n){return t=w(t),function(e,t){if(t&&("object"==m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],w(e).constructor):t.apply(e,n))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}var O={StreetAddress:"fr-icon-map-pin-2-line",PositionOfInterest:{administratif:"fr-icon-france-line",hydrographie:"fr-icon-ign-mer",transport:{"télécabine, téléphérique transport par câble":"fr-icon-subway-line","gare voyageurs uniquement":"fr-icon-subway-line","voyageurs et fret":"fr-icon-subway-line","station de métro":"fr-icon-subway-line","gare fret uniquement":"fr-icon-subway-line","gare routière":"fr-icon-subway-line","station de tramway":"fr-icon-subway-line","arrêt voyageurs":"fr-icon-subway-line",aérodrome:"fr-icon-plane-line",héliport:"fr-icon-plane-line",altiport:"fr-icon-plane-line",aérogare:"fr-icon-plane-line",port:"fr-icon-ship-2-line","gare maritime":"fr-icon-ship-2-line",parking:"fr-icon-parking-box-line","aire de repos ou de service":"fr-icon-parking-box-line","service dédié aux vélos":"fr-icon-bike-line"}}},S=(t.A.getLogger("searchengine"),function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=b(this,t,[e=e||{}])).CLASSNAME="SearchEngineBase",n.initialize(e),n.searchService=e.searchService,!1!==n.searchService.get("autocomplete")&&n.searchService.on("autocomplete",function(e){this.onAutocomplete(e)}.bind(n)),n.searchService.on("search",function(e){this.onSearch(e)}.bind(n)),n._initContainer(e),n._initEvents(e),n._historic=!1,n._historicName="GPsearch-"+e.historic,!1!==e.historic&&!1!==n.searchService.get("autocomplete")){n._historic=[];try{var i=window.localStorage.getItem(n._historicName);i&&(n._historic=JSON.parse(i))}catch(e){}}return n.showHistoric(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(t,e),n=t,i=[{key:"initialize",value:function(e){e.minChars=e.minChars?e.minChars:3,e.maximumEntries="number"==typeof e.maximumEntries?e.maximumEntries:5,e.historic="string"==typeof e.historic?e.historic:this.CLASSNAME,e.title=e.title?e.title:"Rechercher",e.ariaLabel=e.ariaLabel?e.ariaLabel:"Rechercher",e.placeholder=e.placeholder?e.placeholder:"",e.searchService=e.searchService?e.searchService:new h,e.label=e.label?e.label:"",e.hint=e.hint?e.hint:"",e.search=!0===e.search,e.searchButton=!0===e.searchButton,e.collapsible=!0===e.collapsible,this.set("maximumEntries",e.maximumEntries)}},{key:"_initEvents",value:function(e){!1!==this.searchService.get("autocomplete")&&(this.input.addEventListener("input",function(e){e.target.value.length>0?e.target.dataset.erase=!0:delete e.target.dataset.erase,console.log("input",e,e.target.value),e.target.value||this.showHistoric()}.bind(this)),this.input.addEventListener("keydown",function(e){/ArrowDown|ArrowUp/.test(e.key)&&e.preventDefault()}.bind(this)),this.input.addEventListener("keyup",function(t){var n=Array.from(this.autocompleteList.querySelectorAll("li")),i=n.findIndex(function(e){return e.classList.contains("active")});switch(-1===i&&(this._previousValue=t.target.value),t.key){case"ArrowDown":case"ArrowUp":if(t.preventDefault(),0===n.length)return;if(n.forEach(function(e){return e.classList.remove("active")}),"ArrowDown"===t.key?++i>=n.length&&(i=-1):"ArrowUp"===t.key&&--i<-1&&(i=n.length-1),-1!==i){var r=n[i];r.classList.add("active"),this.input.value=r.innerText,this.input.setAttribute("aria-activedescendant",r.id),this.input.setAttribute("data-active-option",r.id)}else t.target.value=this._previousValue;this.input.dispatchEvent(new Event("input"));break;default:t.target.value.length&&t.target.value.length>=e.minChars&&t.target.value!==this._currentValue&&this.autocomplete(t.target.value)}this._currentValue=t.target.value}.bind(this),!1)),this.container.addEventListener("submit",function(t){t.preventDefault();var n=Array.from(this.autocompleteList.querySelectorAll("li"));if(t&&t.submitter&&"submit"===t.submitter.type&&t.target.querySelector("input").value.length<e.minChars)return!1;var i=n.findIndex(function(e){return e.classList.contains("active")}),r=n[i];i<0&&(r=n[0]),r&&r.click()}.bind(this))}},{key:"_initContainer",value:function(e){var t=this.element=document.createElement("div");t.className="GPwidget gpf-widget",t.id=d.A.getUid("GPsearchEngine-");var n=this.container=document.createElement("form");n.className=e.search?"GPSearchBar":"",n.id=d.A.getUid("GPsearchInput-Base-"),!e.target&&e.collapsible&&(this.button=document.createElement("button"),this.button.id=d.A.getUid("GPshowSearchEnginePicto-"),this.button.className="GPshowOpen GPshowAdvancedToolPicto GPshowSearchEnginePicto gpf-btn fr-icon-search-line fr-btn fr-btn--lg",this.button.setAttribute("aria-pressed","true"),e.title&&this.button.setAttribute("title",e.title),e.collapsible&&this.button.addEventListener("click",function(){t.classList.toggle("ol-collapsed");var e="true"===this.button.getAttribute("aria-pressed");this.button.setAttribute("aria-pressed",!e),e?r.blur():r.focus()}.bind(this)),t.appendChild(this.button)),t.appendChild(n);var i=document.createElement("div");i.className="GPInputGroup",i.classList.add(e.search?"fr-input":"fr-input-group"),n.appendChild(i);var r=this.input=document.createElement("input");if(r.type="text",r.className="GPsearchInputText fr-input",r.id=d.A.getUid("GPsearchInputText-"),r.placeholder=e.placeholder,r.autocomplete="off",r.setAttribute("aria-label",e.ariaLabel),e.label){var o=document.createElement("label");if(o.className="GPLabel fr-label",o.textContent=e.label,o.htmlFor=r.id,e.hint){var a=document.createElement("span");a.className="GPLabelHint fr-hint-text",a.textContent=e.hint,o.appendChild(a)}i.appendChild(o)}i.appendChild(r);var c=document.createElement("div");if(c.className="GPMessagesGroup fr-messages-group",c.ariaLive="polite",c.id=d.A.getUid("GPMessagesGroup-"),r.setAttribute("aria-describedby",c.id),i.appendChild(c),this.optionscontainer=document.createElement("div"),this.optionscontainer.className="GPOptionsContainer",i.appendChild(this.optionscontainer),e.searchButton){var s=this.subimtBt=document.createElement("button");s.className="GPsearchInputSubmit gpf-btn fr-icon-search-line fr-btn",s.id=d.A.getUid("GPshowSearchEnginePicto-"),s.type="submit",e.title&&s.setAttribute("title",e.title),n.appendChild(s)}var l=this.acContainer=document.createElement("div");l.id=d.A.getUid("GPautoCompleteContainer-"),l.className="GPautoCompleteContainer GPelementHidden gpf-hidden",t.appendChild(l);var u=this.autocompleteHeader=document.createElement("div");u.className="GPautoCompleteHeader",l.appendChild(u);var p=this.autocompleteList=document.createElement("ul");p.className="GPautoCompleteList",p.id=d.A.getUid("GPautoCompleteList-"),p.setAttribute("role","listbox"),p.setAttribute("tabindex","-1"),p.setAttribute("aria-label","Propositions"),l.appendChild(p);var f=this.autocompleteFooter=document.createElement("div");f.className="GPautoCompleteFooter",l.appendChild(f),r.setAttribute("role","combobox"),r.setAttribute("aria-controls",l.id),r.setAttribute("aria-expanded","false"),r.setAttribute("aria-autocomplete","list"),r.setAttribute("aria-haspopup","listbox"),!1!==this.searchService.get("autocomplete")&&(r.addEventListener("focus",function(){r.setAttribute("aria-expanded","true"),l.classList.add("gpf-visible"),l.classList.remove("gpf-hidden"),l.classList.add("GPelementVisible"),l.classList.remove("GPelementHidden")}),r.addEventListener("blur",function(e){e.relatedTarget&&l.contains(e.relatedTarget)?"BUTTON"!==e.relatedTarget.tagName?r.focus():e.relatedTarget.addEventListener("blur",function(e){var t;e.relatedTarget&&l.contains(e.relatedTarget)||e.relatedTarget===r?r.focus():(0===r.value.length&&(delete r.dataset.erase,null===(t=e.relatedTarget.parentNode.querySelector("button"))||void 0===t||t.focus()),setTimeout(function(){r.setAttribute("aria-expanded","false"),l.classList.remove("gpf-visible"),l.classList.add("gpf-hidden"),l.classList.remove("GPelementVisible"),l.classList.add("GPelementHidden")},50))},{once:!0}):(0===r.value.length&&delete r.dataset.erase,setTimeout(function(){r.setAttribute("aria-expanded","false"),l.classList.remove("gpf-visible"),l.classList.add("gpf-hidden"),l.classList.remove("GPelementVisible"),l.classList.add("GPelementHidden")},50))}))}},{key:"setActive",value:function(e){this.input.disabled=!!e,this.subimtBt.disabled=!!e}},{key:"autocomplete",value:function(e){clearTimeout(this._completeDelay),this._completeDelay=setTimeout(function(){this.searchService.autocomplete(e)}.bind(this),this.get("triggerDelay")||100)}},{key:"onAutocomplete",value:function(e){clearTimeout(this._completeDelay),this._updateList(e.result),this.dispatchEvent(e)}},{key:"search",value:function(e){clearTimeout(this._completeDelay),this._completeDelay=setTimeout(function(){this.searchService.search(e)}.bind(this),this.get("triggerDelay")||100)}},{key:"onSearch",value:function(e){clearTimeout(this._completeDelay),this.dispatchEvent(e)}},{key:"select",value:function(e){clearTimeout(this._completeDelay);var t=this.getItemTitle(e);this.input.value=t,this.input.dispatchEvent(new Event("input")),this._currentValue=t,this._updateHistoric(e),this._updateList(),this.dispatchEvent({type:"select",title:this.getItemTitle(e),item:e})}},{key:"showHistoric",value:function(){clearTimeout(this._completeDelay),this._historic&&this._updateList(this._historic.length?this._historic:[],"history")}},{key:"_updateList",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"search";this.autocompleteList.parentNode.dataset.type=n,e=(e||[]).slice(0,this.get("maximumEntries")),this.autocompleteList.querySelectorAll("li").forEach(function(e){return e.classList.remove("active")}),this.input.setAttribute("aria-activedescendant",""),this.input.setAttribute("data-active-option",""),this.autocompleteList.innerHTML="",e.forEach(function(i,r){var o=document.createElement("li"),a=t.getIconClass(i,n);if(o.id=d.A.getUid("GPsearchResult-"),o.className="GPsearchResult gpf-panel__item gpf-panel__item-searchengine ".concat(a," fr-icon--sm"),o.setAttribute("role","option"),o.setAttribute("data-idx",r),o.innerHTML=o.title=t.getItemTitle(i),"history"===n){o.classList.add("GPsearchHistoric");var c=document.createElement("span");c.ariaHidden="true",c.className="".concat("fr-icon-history-line"," fr-icon--sm"),o.append(c)}t.autocompleteList.appendChild(o),o.addEventListener("click",function(t){var n=Number(t.target.getAttribute("data-idx"));this.select(e[n]),this.search({location:e[n]})}.bind(t))})}},{key:"getIconClass",value:function(e,t){var n=O[e.type];if("object"===m(n)){for(var i=0;i<e.poiType.length;i++){var r=e.poiType[i];if(Object.hasOwn(n,r)){n=n[r];break}}if("object"===m(n))for(var o=0;o<e.poiType.length;o++){var a=e.poiType[o];if(Object.hasOwn(n,a)){n=n[a];break}}n="object"===m(n)?"fr-icon-map-pin-2-line":n}return n}},{key:"getItemTitle",value:function(e){return this.searchService.getItemTitle(e)}},{key:"_updateHistoric",value:function(e){if(this._historic){for(var t=-1,n=0;n<this._historic.length;n++){var i=this._historic[n];if(this._isEqual(i,e)){t=n;break}}-1!==t&&this._historic.splice(t,1),this._historic.unshift(e)>this.get("maximumEntries")&&this._historic.pop(),localStorage.setItem(this._historicName,JSON.stringify(this._historic))}}},{key:"_isEqual",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=this.input.ariaDescribedByElements[0];if(n){var i,r=document.createElement("p"),o="error"===t?"error":"valid";r.className="GPMessage GPMessage--".concat(o," fr-message fr-message--").concat(o),r.id=d.A.getUid("GPMessage-"),r.textContent=e,null===(i=n.parentElement)||void 0===i||i.classList.forEach(function(e){var t;/^fr-.*-group$/.test(e)&&(null===(t=n.parentElement)||void 0===t||t.classList.add("".concat(e,"--").concat(o)))}),n.replaceChildren(r)}}},{key:"removeMessages",value:function(){var e,t=this.input.ariaDescribedByElements[0];t&&(t.replaceChildren(),null===(e=t.parentElement)||void 0===e||e.classList.forEach(function(e){var n;/^fr-.*-group--/.test(e)&&(null===(n=t.parentElement)||void 0===n||n.classList.remove(e))}))}}],i&&v(n.prototype,i),r&&v(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,r}(e.A));const P=S;window.ol&&window.ol.control&&(window.ol.control.SearchEngineBase=S)})(),GpfExtOlSearchEngineBase=i.default})();
//# sourceMappingURL=GpfExtOlSearchEngineBase.js.map