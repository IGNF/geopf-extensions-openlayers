/*!
 * @brief geopf-extensions-openlayers
 *
 * This software is released under the licence AGPL-3.0
 * @see https://www.gnu.org/licenses/agpl-3.0.html#license-text
 * @see https://www.gnu.org/licenses/agpl-3.0.en.html#license-text
 *
 * @copyright copyright (c) IGN 
 * @license AGPL-3.0
 * @author IGN
 * @version 1.0.0-beta.7-473
 * @date 10/12/2025
 *
 */(()=>{var e={3065(e,t,n){var r,i;!function(){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],i={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?s:void 0!==console[r]?a(console,r):void 0!==console.log?a(console,"log"):e)}function c(){for(var n=this.getLevel(),i=0;i<r.length;i++){var o=r[i];this[o]=i<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function d(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(e,t,n){return l(e)||d.apply(this,arguments)}function f(e,n){var a,s,l,d=this,f="loglevel";function p(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&f){try{return void(window.localStorage[f]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+n+";"}catch(e){}}}function h(){var e;if(typeof window!==t&&f){try{e=window.localStorage[f]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(f),i=n.indexOf(r+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i+r.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function g(){if(typeof window!==t&&f){try{window.localStorage.removeItem(f)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function v(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?f+=":"+e:"symbol"==typeof e&&(f=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=l?l:null!=s?s:a},d.setLevel=function(e,t){return l=v(e),!1!==t&&p(l),c.call(d)},d.setDefaultLevel=function(e){s=v(e),h()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,g(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=v(o.getLevel())),c.call(d),o===d)for(var e in i)i[e].rebuild()},a=v(o?o.getLevel():"WARN");var m=h();null!=m&&(l=v(m)),c.call(d)}(o=new f).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new f(e,o.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return i},o.default=o,o},void 0===(i="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=i)}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};(()=>{"use strict";n.d(r,{default:()=>an});const e=ol.control.Control;const t=function(){return""!==getComputedStyle(document.documentElement).getPropertyValue("--blue-france-sun-113-625")};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function a(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function u(e,t,n){return t=p(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,n||[],p(e).constructor):t.apply(e,n))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}const g=function(e){function t(e){var n;return s(this,t),n=u(this,t,[{element:(e=e||{}).element,target:e.target,render:e.render}]),e&&e.listable?n.listable=!0:n.listable=!1,e&&e.description?n.description=e.description:n.description="",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(t,e),c(t,[{key:"setPosition",value:function(e){this.getMap()&&new b(this).set(e)}},{key:"updatePosition",value:function(e){this.getMap()&&new b(this).update(e)}}])}(n.n(e)());var v=["top-left","top-right","bottom-left","bottom-right"],m=new WeakSet,b=function(){return c(function e(t){return s(this,e),o(this,m),this.caller=t,this.container=null,a(m,this,w).call(this,"top-left"),a(m,this,w).call(this,"top-right"),a(m,this,w).call(this,"bottom-left"),a(m,this,w).call(this,"bottom-right"),this},[{key:"set",value:function(e){v.includes(e.toLowerCase())&&(a(m,this,E).call(this,e,!1),e.includes("bottom")?this.container.children["position-container-"+e].prepend(this.caller.element):this.container.children["position-container-"+e].appendChild(this.caller.element))}},{key:"update",value:function(e){v.includes(e.toLowerCase())&&a(m,this,E).call(this,e,!0)}}])}();function y(e){return!!this.container.children["position-container-"+e]}function w(e){if(this.container=this.caller.getMap().getOverlayContainerStopEvent(),!a(m,this,y).call(this,e)){var t=document.createElement("div");t.id="position-container-"+e,t.className="position position-container-"+e,this.container.appendChild(t)}}function E(e,n){var r=this,i=function(e){return r.container.children["position-container-"+e].children.length},o=function(e){return r.container.children["position-container-"+e].offsetWidth},a=function(e){var t=r.container.children["position-container-"+e],i=t.offsetHeight;if(n){e.includes("top")&&(i=0);for(var o=0;o<t.children.length;o++){if(t.children[o].id===r.caller.element.id){i=e.includes("bottom")?i-r.caller.element.offsetHeight:-1*i;break}i-=t.children[o].offsetHeight}}return i},s=function(e){e.style.top="unset",e.style.bottom="unset",e.style.left="unset",e.style.right="unset"};s(this.caller.element),this.caller.element.style.position="unset";var l=Array.from(this.caller.element.getElementsByClassName("GPpanel"));if(0!==l.length){var c=0;l.forEach(function(n){if("dialog"===n.nodeName.toLowerCase()){switch(s(n),e.toLowerCase()){case"top-left":t()?n.style.top="0px":n.style.top=i(e)?a(e)+"px":"0px",n.style.left=o(e)+c+"px";break;case"bottom-left":t()?n.style.top="0px":n.style.bottom=i(e)?a(e)+"px":"0px",n.style.left=o(e)+c+"px";break;case"top-right":t()?n.style.top="0px":n.style.top=i(e)?a(e)+"px":"0px",n.style.right=o(e)+c+"px";break;case"bottom-right":t()?n.style.top="0px":n.style.bottom=i(e)?a(e)+"px":"0px",n.style.right=o(e)+c+"px"}c+=n.offsetWidth}})}}function T(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=["GPoverviewMap","GPfullScreen"];const S=function(e,t){var n=function(e,t){var n=[].concat(_,[t]),r=[];if(e&&e.includes("left")){var i=document.getElementById("position-container-bottom-left"),o=document.getElementById("position-container-top-left");r=[].concat(T(i.children),T(o.children))}if(e&&e.includes("right")){var a=document.getElementById("position-container-bottom-right"),s=document.getElementById("position-container-top-right");r=[].concat(T(a.children),T(s.children))}return r.filter(function(e){var t=e.id.match(/(\w+)-[0-9]+/)[1],r=n.includes(t);if("true"===e.getElementsByTagName("button")[0].getAttribute("aria-pressed")&&!r)return e})}(e,t);n.length>0&&n[0].getElementsByTagName("button")[0].click()};const x={onPanelOpen:function(){S(this.options.position,this.element.id.match(/(\w+)-[0-9]+/)[1])}},A=(ol.Map,ol.proj);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}var O=0,D={detectSupport:function(){var e=!0,t=window.navigator.userAgent.toLowerCase();return-1===t.indexOf("iphone")&&-1===t.indexOf("ipod")&&-1===t.indexOf("ipad")&&-1===t.indexOf("android")&&-1===t.indexOf("mobile")&&-1===t.indexOf("blackberry")&&-1===t.indexOf("tablet")&&-1===t.indexOf("phone")&&-1===t.indexOf("touch")||(e=!1),-1===t.indexOf("msie")&&-1===t.indexOf("trident")||(e=!0),e},assign:function(e,t){for(var n in e=e||{},t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},mergeParams:function(e,t,n){if(void 0!==e&&void 0!==t)for(var r in void 0===n&&(n=!0),t)t.hasOwnProperty(r)&&("object"===P(t[r])?e.hasOwnProperty(r)?this.mergeParams(e[r],t[r],n):e[r]=t[r]:e.hasOwnProperty(r)?n&&(e[r]=t[r]):e[r]=t[r])},getUid:function(e,t){return t&&t.id?t.id:e+ ++O}};const L=D;var k,I={generate:(k=Math.floor(Date.now()),function(){return k++}),name:function(e){var t=null,n=e.lastIndexOf("-");return t=-1===n?e:e.substring(0,n),t},index:function(e){var t=null,n=this.name(e),r=n.lastIndexOf("_");return-1!==r&&(t=n.substring(r+1)),t},uuid:function(e){var t=null,n=e.lastIndexOf("-");return-1!==n&&(t=parseInt(e.substring(n+1),10)),t}};const M=I;var N=n(3065),R={getLogger:function(e){if(void 0===t)var t={env:{VERBOSE:!1}};t.env.VERBOSE?N.enableAll():N.disableAll();var n=e||"default";return N.getLogger(n)},disableAll:function(){var e=N.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=N.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}};const B=R;window.Gp&&(window.Gp.Logger=R);B.getLogger("draggable");const j={dragElement:function(e,t,n){var r,i=0,o=0,a=0,s=0,l=0,c=0;t?t.addEventListener("mousedown",u,!0):e.addEventListener("mousedown",u,!0);var d={bottom:0,left:0,right:0,top:0};function u(t){(t=t||window.event).preventDefault(),i=t.clientX,o=t.clientY,r=e.getBoundingClientRect();var a=n.getBoundingClientRect();d={bottom:a.bottom,left:a.left,right:a.right,top:a.top},document.addEventListener("mouseup",f,!0),document.addEventListener("mousemove",p,!0)}function f(){l-=a,c-=s,document.removeEventListener("mouseup",f,!0),document.removeEventListener("mousemove",p,!0)}function p(t){var n=(t=t||window.event).clientX,u=t.clientY,f=a,p=s;a=i-n,s=o-u;var h=r.left-a,g=r.top-s;if(h<d.left||g<d.top||h+r.width>d.right||g+r.height>d.bottom)a=f,s=p;else{var v=l-a,m=c-s;e.style.transform="translate("+v+"px,"+m+"px)"}}}},V=JSON.parse('[{"id":"FXX","title":"France métropolitaine","description":"","zoom":null,"bbox":[-9.86,41.15,10.38,51.56],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/fxx.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/fxx.svg"},{"id":"IDF","title":"Paris petite couronne","description":"","zoom":null,"bbox":[2.18,48.77,2.52,48.95],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/idf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/idf.svg"},{"id":"MTQ","title":"Martinique","description":"","zoom":null,"bbox":[-61.4,14.25,-60.67,15.04],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/mtq.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/mtq.svg"},{"id":"GUF","title":"Guyane","description":"","zoom":null,"bbox":[-55.65,1.49,-51.2,6.21],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/guf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/guf.svg"},{"id":"MYT","title":"Mayotte","description":"","zoom":null,"bbox":[44.95,-13.049,45.32,-12.57],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/myt.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/myt.svg"},{"id":"GLP","title":"Guadeloupe","description":"","zoom":null,"bbox":[-61.97,15.72,-60.93,16.66],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/glp.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/glp.svg"},{"id":"REU","title":"Réunion","description":"","zoom":null,"bbox":[55.07,-21.46,55.86,-20.79],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/reu.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/reu.svg"},{"id":"SPM","title":"Saint-Pierre-et-Miquelon","description":"","zoom":null,"bbox":[-56.48,46.69,-56.07,47.19],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/spm.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/spm.svg"},{"id":"BLM","title":"Saint-Barthélemy","description":"","zoom":null,"bbox":[-62.95,17.85,-62.75,17.95],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/blm.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/blm.svg"},{"id":"MAF","title":"Saint-Martin","description":"","zoom":null,"bbox":[-63.2,18,-62.9,18.2],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/maf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/maf.svg"},{"id":"WLF","title":"Wallis-et-Futuna","description":"","zoom":null,"bbox":[180.3,-15.2,185.3,-12.25],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/wlf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/wlf.svg"},{"id":"PYF","title":"Polynésie française","description":"","zoom":null,"bbox":[-154.83,-27.6,-134.32,-7.25],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/pyf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/pyf.svg"},{"id":"NCL","title":"Nouvelle Calédonie","description":"","zoom":null,"bbox":[163.02,-23.08,167.86,-19.5],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/ncl.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/ncl.svg"},{"id":"ATF","title":"Terres australes et antarctiques françaises","description":"","zoom":null,"bbox":[50,-60,90,-45],"thumbnail":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/thumbnails/atf.png","icon":"https://data.geopf.fr/annexes/cartes.gouv.fr-config/public/resources/territories/atf.svg"}]');
/**!
 * Sortable 1.15.3
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach(function(t){U(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(){return H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}function z(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function G(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var W=G(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),q=G(/Edge/i),Q=G(/firefox/i),K=G(/safari/i)&&!G(/chrome/i)&&!G(/android/i),Z=G(/iP(ad|od|hone)/i),J=G(/chrome/i)&&G(/android/i),$={capture:!1,passive:!1};function ee(e,t,n){e.addEventListener(t,n,!W&&$)}function te(e,t,n){e.removeEventListener(t,n,!W&&$)}function ne(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function re(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ie(e,t,n,r){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&ne(e,t):ne(e,t))||r&&e===n)return e;if(e===n)break}while(e=re(e))}return null}var oe,ae=/\s+/g;function se(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(ae," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(ae," ")}}function le(e,t,n){var r=e&&e.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=n+("string"==typeof n?"":"px")}}function ce(e,t){var n="";if("string"==typeof e)n=e;else do{var r=le(e,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function de(e,t,n){if(e){var r=e.getElementsByTagName(t),i=0,o=r.length;if(n)for(;i<o;i++)n(r[i],i);return r}return[]}function ue(){var e=document.scrollingElement;return e||document.documentElement}function fe(e,t,n,r,i){if(e.getBoundingClientRect||e===window){var o,a,s,l,c,d,u;if(e!==window&&e.parentNode&&e!==ue()?(a=(o=e.getBoundingClientRect()).top,s=o.left,l=o.bottom,c=o.right,d=o.height,u=o.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!W))do{if(i&&i.getBoundingClientRect&&("none"!==le(i,"transform")||n&&"static"!==le(i,"position"))){var f=i.getBoundingClientRect();a-=f.top+parseInt(le(i,"border-top-width")),s-=f.left+parseInt(le(i,"border-left-width")),l=a+o.height,c=s+o.width;break}}while(i=i.parentNode);if(r&&e!==window){var p=ce(i||e),h=p&&p.a,g=p&&p.d;p&&(l=(a/=g)+(d/=g),c=(s/=h)+(u/=h))}return{top:a,left:s,bottom:l,right:c,width:u,height:d}}}function pe(e,t,n){for(var r=be(e,!0),i=fe(e)[t];r;){var o=fe(r)[n];if(!("top"===n||"left"===n?i>=o:i<=o))return r;if(r===ue())break;r=be(r,!1)}return!1}function he(e,t,n,r){for(var i=0,o=0,a=e.children;o<a.length;){if("none"!==a[o].style.display&&a[o]!==Ct.ghost&&(r||a[o]!==Ct.dragged)&&ie(a[o],n.draggable,e,!1)){if(i===t)return a[o];i++}o++}return null}function ge(e,t){for(var n=e.lastElementChild;n&&(n===Ct.ghost||"none"===le(n,"display")||t&&!ne(n,t));)n=n.previousElementSibling;return n||null}function ve(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ct.clone||t&&!ne(e,t)||n++;return n}function me(e){var t=0,n=0,r=ue();if(e)do{var i=ce(e),o=i.a,a=i.d;t+=e.scrollLeft*o,n+=e.scrollTop*a}while(e!==r&&(e=e.parentNode));return[t,n]}function be(e,t){if(!e||!e.getBoundingClientRect)return ue();var n=e,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=le(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return ue();if(r||t)return n;r=!0}}}while(n=n.parentNode);return ue()}function ye(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function we(e,t){return function(){if(!oe){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),oe=setTimeout(function(){oe=void 0},t)}}}function Ee(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function Te(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function Ce(e,t,n){var r={};return Array.from(e.children).forEach(function(i){var o,a,s,l;if(ie(i,t.draggable,e,!1)&&!i.animated&&i!==n){var c=fe(i);r.left=Math.min(null!==(o=r.left)&&void 0!==o?o:1/0,c.left),r.top=Math.min(null!==(a=r.top)&&void 0!==a?a:1/0,c.top),r.right=Math.max(null!==(s=r.right)&&void 0!==s?s:-1/0,c.right),r.bottom=Math.max(null!==(l=r.bottom)&&void 0!==l?l:-1/0,c.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var _e="Sortable"+(new Date).getTime();function Se(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach(function(e){if("none"!==le(e,"display")&&e!==Ct.ghost){t.push({target:e,rect:fe(e)});var n=Y({},t[t.length-1].rect);if(e.thisAnimationDuration){var r=ce(e,!0);r&&(n.top-=r.f,n.left-=r.e)}e.fromRect=n}})},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[n][r])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var i=!1,o=0;t.forEach(function(e){var t=0,n=e.target,a=n.fromRect,s=fe(n),l=n.prevFromRect,c=n.prevToRect,d=e.rect,u=ce(n,!0);u&&(s.top-=u.f,s.left-=u.e),n.toRect=s,n.thisAnimationDuration&&ye(l,s)&&!ye(a,s)&&(d.top-s.top)/(d.left-s.left)===(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,n,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*r.animation}(d,l,c,r.options)),ye(s,a)||(n.prevFromRect=a,n.prevToRect=s,t||(t=r.options.animation),r.animate(n,d,s,t)),t&&(i=!0,o=Math.max(o,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},t),n.thisAnimationDuration=t)}),clearTimeout(e),i?e=setTimeout(function(){"function"==typeof n&&n()},o):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,r){if(r){le(e,"transition",""),le(e,"transform","");var i=ce(this.el),o=i&&i.a,a=i&&i.d,s=(t.left-n.left)/(o||1),l=(t.top-n.top)/(a||1);e.animatingX=!!s,e.animatingY=!!l,le(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),le(e,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),le(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){le(e,"transition",""),le(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},r)}}}}var xe=[],Ae={initializeByDefault:!0},Pe={mount:function(e){for(var t in Ae)Ae.hasOwnProperty(t)&&!(t in e)&&(e[t]=Ae[t]);xe.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),xe.push(e)},pluginEvent:function(e,t,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var i=e+"Global";xe.forEach(function(r){t[r.pluginName]&&(t[r.pluginName][i]&&t[r.pluginName][i](Y({sortable:t},n)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](Y({sortable:t},n)))})},initializePlugins:function(e,t,n,r){for(var i in xe.forEach(function(r){var i=r.pluginName;if(e.options[i]||r.initializeByDefault){var o=new r(e,t,e.options);o.sortable=e,o.options=e.options,e[i]=o,H(n,o.defaults)}}),e.options)if(e.options.hasOwnProperty(i)){var o=this.modifyOption(e,i,e.options[i]);void 0!==o&&(e.options[i]=o)}},getEventProperties:function(e,t){var n={};return xe.forEach(function(r){"function"==typeof r.eventProperties&&H(n,r.eventProperties.call(t[r.pluginName],e))}),n},modifyOption:function(e,t,n){var r;return xe.forEach(function(i){e[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[t]&&(r=i.optionListeners[t].call(e[i.pluginName],n))}),r}};function Oe(e){var t=e.sortable,n=e.rootEl,r=e.name,i=e.targetEl,o=e.cloneEl,a=e.toEl,s=e.fromEl,l=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,f=e.originalEvent,p=e.putSortable,h=e.extraEventProperties;if(t=t||n&&n[_e]){var g,v=t.options,m="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||W||q?(g=document.createEvent("Event")).initEvent(r,!0,!0):g=new CustomEvent(r,{bubbles:!0,cancelable:!0}),g.to=a||n,g.from=s||n,g.item=i||n,g.clone=o,g.oldIndex=l,g.newIndex=c,g.oldDraggableIndex=d,g.newDraggableIndex=u,g.originalEvent=f,g.pullMode=p?p.lastPutMode:void 0;var b=Y(Y({},h),Pe.getEventProperties(r,t));for(var y in b)g[y]=b[y];n&&n.dispatchEvent(g),v[m]&&v[m].call(t,g)}}var De=["evt"],Le=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,i=z(n,De);Pe.pluginEvent.bind(Ct)(e,t,Y({dragEl:Ie,parentEl:Me,ghostEl:Ne,rootEl:Re,nextEl:Be,lastDownEl:je,cloneEl:Ve,cloneHidden:Fe,dragStarted:$e,putSortable:Ge,activeSortable:Ct.active,originalEvent:r,oldIndex:Ye,oldDraggableIndex:Ue,newIndex:Xe,newDraggableIndex:He,hideGhostForTarget:yt,unhideGhostForTarget:wt,cloneNowHidden:function(){Fe=!0},cloneNowShown:function(){Fe=!1},dispatchSortableEvent:function(e){ke({sortable:t,name:e,originalEvent:r})}},i))};function ke(e){Oe(Y({putSortable:Ge,cloneEl:Ve,targetEl:Ie,rootEl:Re,oldIndex:Ye,oldDraggableIndex:Ue,newIndex:Xe,newDraggableIndex:He},e))}var Ie,Me,Ne,Re,Be,je,Ve,Fe,Ye,Xe,Ue,He,ze,Ge,We,qe,Qe,Ke,Ze,Je,$e,et,tt,nt,rt,it=!1,ot=!1,at=[],st=!1,lt=!1,ct=[],dt=!1,ut=[],ft="undefined"!=typeof document,pt=Z,ht=q||W?"cssFloat":"float",gt=ft&&!J&&!Z&&"draggable"in document.createElement("div"),vt=function(){if(ft){if(W)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),mt=function(e,t){var n=le(e),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=he(e,0,t),o=he(e,1,t),a=i&&le(i),s=o&&le(o),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+fe(i).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+fe(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!o||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=r&&"none"===n[ht]||o&&"none"===n[ht]&&l+c>r)?"vertical":"horizontal"},bt=function(e){function t(e,n){return function(r,i,o,a){var s=r.options.group.name&&i.options.group.name&&r.options.group.name===i.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(r,i,o,a),n)(r,i,o,a);var l=(n?r:i).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},r=e.group;r&&"object"==X(r)||(r={name:r}),n.name=r.name,n.checkPull=t(r.pull,!0),n.checkPut=t(r.put),n.revertClone=r.revertClone,e.group=n},yt=function(){!vt&&Ne&&le(Ne,"display","none")},wt=function(){!vt&&Ne&&le(Ne,"display","")};ft&&!J&&document.addEventListener("click",function(e){if(ot)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ot=!1,!1},!0);var Et=function(e){if(Ie){e=e.touches?e.touches[0]:e;var t=(i=e.clientX,o=e.clientY,at.some(function(e){var t=e[_e].options.emptyInsertThreshold;if(t&&!ge(e)){var n=fe(e),r=i>=n.left-t&&i<=n.right+t,s=o>=n.top-t&&o<=n.bottom+t;return r&&s?a=e:void 0}}),a);if(t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[_e]._onDragOver(n)}}var i,o,a},Tt=function(e){Ie&&Ie.parentNode[_e]._isOutsideThisEl(e.target)};function Ct(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=H({},t),e[_e]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return mt(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ct.supportPointer&&"PointerEvent"in window&&!K,emptyInsertThreshold:5};for(var r in Pe.initializePlugins(this,e,n),n)!(r in t)&&(t[r]=n[r]);for(var i in bt(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&gt,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?ee(e,"pointerdown",this._onTapStart):(ee(e,"mousedown",this._onTapStart),ee(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(ee(e,"dragover",this),ee(e,"dragenter",this)),at.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),H(this,Se())}function _t(e,t,n,r,i,o,a,s){var l,c,d=e[_e],u=d.options.onMove;return!window.CustomEvent||W||q?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=r,l.related=i||t,l.relatedRect=o||fe(t),l.willInsertAfter=s,l.originalEvent=a,e.dispatchEvent(l),u&&(c=u.call(d,l,a)),c}function St(e){e.draggable=!1}function xt(){dt=!1}function At(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function Pt(e){return setTimeout(e,0)}function Ot(e){return clearTimeout(e)}Ct.prototype={constructor:Ct,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(et=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Ie):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,r=this.options,i=r.preventOnFilter,o=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=r.filter;if(function(e){ut.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var r=t[n];r.checked&&ut.push(r)}}(n),!Ie&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||r.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!K||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=ie(s,r.draggable,n,!1))&&s.animated||je===s)){if(Ye=ve(s),Ue=ve(s,r.draggable),"function"==typeof c){if(c.call(this,e,s,this))return ke({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),Le("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some(function(r){if(r=ie(l,r.trim(),n,!1))return ke({sortable:t,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),Le("filter",t,{evt:e}),!0})))return void(i&&e.cancelable&&e.preventDefault());r.handle&&!ie(l,r.handle,n,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,n){var r,i=this,o=i.el,a=i.options,s=o.ownerDocument;if(n&&!Ie&&n.parentNode===o){var l=fe(n);if(Re=o,Me=(Ie=n).parentNode,Be=Ie.nextSibling,je=n,ze=a.group,Ct.dragged=Ie,We={target:Ie,clientX:(t||e).clientX,clientY:(t||e).clientY},Ze=We.clientX-l.left,Je=We.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Ie.style["will-change"]="all",r=function(){Le("delayEnded",i,{evt:e}),Ct.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!Q&&i.nativeDraggable&&(Ie.draggable=!0),i._triggerDragStart(e,t),ke({sortable:i,name:"choose",originalEvent:e}),se(Ie,a.chosenClass,!0))},a.ignore.split(",").forEach(function(e){de(Ie,e.trim(),St)}),ee(s,"dragover",Et),ee(s,"mousemove",Et),ee(s,"touchmove",Et),ee(s,"mouseup",i._onDrop),ee(s,"touchend",i._onDrop),ee(s,"touchcancel",i._onDrop),Q&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Ie.draggable=!0),Le("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(q||W))r();else{if(Ct.eventCanceled)return void this._onDrop();ee(s,"mouseup",i._disableDelayedDrag),ee(s,"touchend",i._disableDelayedDrag),ee(s,"touchcancel",i._disableDelayedDrag),ee(s,"mousemove",i._delayedDragTouchMoveHandler),ee(s,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&ee(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(r,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Ie&&St(Ie),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;te(e,"mouseup",this._disableDelayedDrag),te(e,"touchend",this._disableDelayedDrag),te(e,"touchcancel",this._disableDelayedDrag),te(e,"mousemove",this._delayedDragTouchMoveHandler),te(e,"touchmove",this._delayedDragTouchMoveHandler),te(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?ee(document,"pointermove",this._onTouchMove):ee(document,t?"touchmove":"mousemove",this._onTouchMove):(ee(Ie,"dragend",this),ee(Re,"dragstart",this._onDragStart));try{document.selection?Pt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(it=!1,Re&&Ie){Le("dragStarted",this,{evt:t}),this.nativeDraggable&&ee(document,"dragover",Tt);var n=this.options;!e&&se(Ie,n.dragClass,!1),se(Ie,n.ghostClass,!0),Ct.active=this,e&&this._appendGhost(),ke({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(qe){this._lastX=qe.clientX,this._lastY=qe.clientY,yt();for(var e=document.elementFromPoint(qe.clientX,qe.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(qe.clientX,qe.clientY))!==t;)t=e;if(Ie.parentNode[_e]._isOutsideThisEl(e),t)do{if(t[_e]){if(t[_e]._onDragOver({clientX:qe.clientX,clientY:qe.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=re(t));wt()}},_onTouchMove:function(e){if(We){var t=this.options,n=t.fallbackTolerance,r=t.fallbackOffset,i=e.touches?e.touches[0]:e,o=Ne&&ce(Ne,!0),a=Ne&&o&&o.a,s=Ne&&o&&o.d,l=pt&&rt&&me(rt),c=(i.clientX-We.clientX+r.x)/(a||1)+(l?l[0]-ct[0]:0)/(a||1),d=(i.clientY-We.clientY+r.y)/(s||1)+(l?l[1]-ct[1]:0)/(s||1);if(!Ct.active&&!it){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Ne){o?(o.e+=c-(Qe||0),o.f+=d-(Ke||0)):o={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");le(Ne,"webkitTransform",u),le(Ne,"mozTransform",u),le(Ne,"msTransform",u),le(Ne,"transform",u),Qe=c,Ke=d,qe=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Ne){var e=this.options.fallbackOnBody?document.body:Re,t=fe(Ie,!0,pt,!0,e),n=this.options;if(pt){for(rt=e;"static"===le(rt,"position")&&"none"===le(rt,"transform")&&rt!==document;)rt=rt.parentNode;rt!==document.body&&rt!==document.documentElement?(rt===document&&(rt=ue()),t.top+=rt.scrollTop,t.left+=rt.scrollLeft):rt=ue(),ct=me(rt)}se(Ne=Ie.cloneNode(!0),n.ghostClass,!1),se(Ne,n.fallbackClass,!0),se(Ne,n.dragClass,!0),le(Ne,"transition",""),le(Ne,"transform",""),le(Ne,"box-sizing","border-box"),le(Ne,"margin",0),le(Ne,"top",t.top),le(Ne,"left",t.left),le(Ne,"width",t.width),le(Ne,"height",t.height),le(Ne,"opacity","0.8"),le(Ne,"position",pt?"absolute":"fixed"),le(Ne,"zIndex","100000"),le(Ne,"pointerEvents","none"),Ct.ghost=Ne,e.appendChild(Ne),le(Ne,"transform-origin",Ze/parseInt(Ne.style.width)*100+"% "+Je/parseInt(Ne.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,r=e.dataTransfer,i=n.options;Le("dragStart",this,{evt:e}),Ct.eventCanceled?this._onDrop():(Le("setupClone",this),Ct.eventCanceled||((Ve=Te(Ie)).removeAttribute("id"),Ve.draggable=!1,Ve.style["will-change"]="",this._hideClone(),se(Ve,this.options.chosenClass,!1),Ct.clone=Ve),n.cloneId=Pt(function(){Le("clone",n),Ct.eventCanceled||(n.options.removeCloneOnHide||Re.insertBefore(Ve,Ie),n._hideClone(),ke({sortable:n,name:"clone"}))}),!t&&se(Ie,i.dragClass,!0),t?(ot=!0,n._loopId=setInterval(n._emulateDragOver,50)):(te(document,"mouseup",n._onDrop),te(document,"touchend",n._onDrop),te(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(n,r,Ie)),ee(document,"drop",n),le(Ie,"transform","translateZ(0)")),it=!0,n._dragStartId=Pt(n._dragStarted.bind(n,t,e)),ee(document,"selectstart",n),$e=!0,K&&le(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,r,i,o=this.el,a=e.target,s=this.options,l=s.group,c=Ct.active,d=ze===l,u=s.sort,f=Ge||c,p=this,h=!1;if(!dt){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),a=ie(a,s.draggable,o,!0),O("dragOver"),Ct.eventCanceled)return h;if(Ie.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||p._ignoreWhileAnimating===a)return L(!1);if(ot=!1,c&&!s.disabled&&(d?u||(r=Me!==Re):Ge===this||(this.lastPutMode=ze.checkPull(this,c,Ie,e))&&l.checkPut(this,c,Ie,e))){if(i="vertical"===this._getDirection(e,a),t=fe(Ie),O("dragOverValid"),Ct.eventCanceled)return h;if(r)return Me=Re,D(),this._hideClone(),O("revert"),Ct.eventCanceled||(Be?Re.insertBefore(Ie,Be):Re.appendChild(Ie)),L(!0);var g=ge(o,s.draggable);if(!g||function(e,t,n){var r=fe(ge(n.el,n.options.draggable)),i=Ce(n.el,n.options,Ne),o=10;return t?e.clientX>i.right+o||e.clientY>r.bottom&&e.clientX>r.left:e.clientY>i.bottom+o||e.clientX>r.right&&e.clientY>r.top}(e,i,this)&&!g.animated){if(g===Ie)return L(!1);if(g&&o===e.target&&(a=g),a&&(n=fe(a)),!1!==_t(Re,o,Ie,t,a,n,e,!!a))return D(),g&&g.nextSibling?o.insertBefore(Ie,g.nextSibling):o.appendChild(Ie),Me=o,k(),L(!0)}else if(g&&function(e,t,n){var r=fe(he(n.el,0,n.options,!0)),i=Ce(n.el,n.options,Ne),o=10;return t?e.clientX<i.left-o||e.clientY<r.top&&e.clientX<r.right:e.clientY<i.top-o||e.clientY<r.bottom&&e.clientX<r.left}(e,i,this)){var v=he(o,0,s,!0);if(v===Ie)return L(!1);if(n=fe(a=v),!1!==_t(Re,o,Ie,t,a,n,e,!1))return D(),o.insertBefore(Ie,v),Me=o,k(),L(!0)}else if(a.parentNode===o){n=fe(a);var m,b,y,w=Ie.parentNode!==o,E=!function(e,t,n){var r=n?e.left:e.top,i=n?e.right:e.bottom,o=n?e.width:e.height,a=n?t.left:t.top,s=n?t.right:t.bottom,l=n?t.width:t.height;return r===a||i===s||r+o/2===a+l/2}(Ie.animated&&Ie.toRect||t,a.animated&&a.toRect||n,i),T=i?"top":"left",C=pe(a,"top","top")||pe(Ie,"top","top"),_=C?C.scrollTop:void 0;if(et!==a&&(b=n[T],st=!1,lt=!E&&s.invertSwap||w),m=function(e,t,n,r,i,o,a,s){var l=r?e.clientY:e.clientX,c=r?n.height:n.width,d=r?n.top:n.left,u=r?n.bottom:n.right,f=!1;if(!a)if(s&&nt<c*i){if(!st&&(1===tt?l>d+c*o/2:l<u-c*o/2)&&(st=!0),st)f=!0;else if(1===tt?l<d+nt:l>u-nt)return-tt}else if(l>d+c*(1-i)/2&&l<u-c*(1-i)/2)return function(e){return ve(Ie)<ve(e)?1:-1}(t);if((f=f||a)&&(l<d+c*o/2||l>u-c*o/2))return l>d+c/2?1:-1;return 0}(e,a,n,i,E?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,lt,et===a),0!==m){var S=ve(Ie);do{S-=m,y=Me.children[S]}while(y&&("none"===le(y,"display")||y===Ne))}if(0===m||y===a)return L(!1);et=a,tt=m;var x=a.nextElementSibling,A=!1,P=_t(Re,o,Ie,t,a,n,e,A=1===m);if(!1!==P)return 1!==P&&-1!==P||(A=1===P),dt=!0,setTimeout(xt,30),D(),A&&!x?o.appendChild(Ie):a.parentNode.insertBefore(Ie,A?x:a),C&&Ee(C,0,_-C.scrollTop),Me=Ie.parentNode,void 0===b||lt||(nt=Math.abs(b-fe(a)[T])),k(),L(!0)}if(o.contains(Ie))return L(!1)}return!1}function O(s,l){Le(s,p,Y({evt:e,isOwner:d,axis:i?"vertical":"horizontal",revert:r,dragRect:t,targetRect:n,canSort:u,fromSortable:f,target:a,completed:L,onMove:function(n,r){return _t(Re,o,Ie,t,n,fe(n),e,r)},changed:k},l))}function D(){O("dragOverAnimationCapture"),p.captureAnimationState(),p!==f&&f.captureAnimationState()}function L(t){return O("dragOverCompleted",{insertion:t}),t&&(d?c._hideClone():c._showClone(p),p!==f&&(se(Ie,Ge?Ge.options.ghostClass:c.options.ghostClass,!1),se(Ie,s.ghostClass,!0)),Ge!==p&&p!==Ct.active?Ge=p:p===Ct.active&&Ge&&(Ge=null),f===p&&(p._ignoreWhileAnimating=a),p.animateAll(function(){O("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(a===Ie&&!Ie.animated||a===o&&!a.animated)&&(et=null),s.dragoverBubble||e.rootEl||a===document||(Ie.parentNode[_e]._isOutsideThisEl(e.target),!t&&Et(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),h=!0}function k(){Xe=ve(Ie),He=ve(Ie,s.draggable),ke({sortable:p,name:"change",toEl:o,newIndex:Xe,newDraggableIndex:He,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){te(document,"mousemove",this._onTouchMove),te(document,"touchmove",this._onTouchMove),te(document,"pointermove",this._onTouchMove),te(document,"dragover",Et),te(document,"mousemove",Et),te(document,"touchmove",Et)},_offUpEvents:function(){var e=this.el.ownerDocument;te(e,"mouseup",this._onDrop),te(e,"touchend",this._onDrop),te(e,"pointerup",this._onDrop),te(e,"touchcancel",this._onDrop),te(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;Xe=ve(Ie),He=ve(Ie,n.draggable),Le("drop",this,{evt:e}),Me=Ie&&Ie.parentNode,Xe=ve(Ie),He=ve(Ie,n.draggable),Ct.eventCanceled||(it=!1,lt=!1,st=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ot(this.cloneId),Ot(this._dragStartId),this.nativeDraggable&&(te(document,"drop",this),te(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),K&&le(document.body,"user-select",""),le(Ie,"transform",""),e&&($e&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Ne&&Ne.parentNode&&Ne.parentNode.removeChild(Ne),(Re===Me||Ge&&"clone"!==Ge.lastPutMode)&&Ve&&Ve.parentNode&&Ve.parentNode.removeChild(Ve),Ie&&(this.nativeDraggable&&te(Ie,"dragend",this),St(Ie),Ie.style["will-change"]="",$e&&!it&&se(Ie,Ge?Ge.options.ghostClass:this.options.ghostClass,!1),se(Ie,this.options.chosenClass,!1),ke({sortable:this,name:"unchoose",toEl:Me,newIndex:null,newDraggableIndex:null,originalEvent:e}),Re!==Me?(Xe>=0&&(ke({rootEl:Me,name:"add",toEl:Me,fromEl:Re,originalEvent:e}),ke({sortable:this,name:"remove",toEl:Me,originalEvent:e}),ke({rootEl:Me,name:"sort",toEl:Me,fromEl:Re,originalEvent:e}),ke({sortable:this,name:"sort",toEl:Me,originalEvent:e})),Ge&&Ge.save()):Xe!==Ye&&Xe>=0&&(ke({sortable:this,name:"update",toEl:Me,originalEvent:e}),ke({sortable:this,name:"sort",toEl:Me,originalEvent:e})),Ct.active&&(null!=Xe&&-1!==Xe||(Xe=Ye,He=Ue),ke({sortable:this,name:"end",toEl:Me,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Le("nulling",this),Re=Ie=Me=Ne=Be=Ve=je=Fe=We=qe=$e=Xe=He=Ye=Ue=et=tt=Ge=ze=Ct.dragged=Ct.ghost=Ct.clone=Ct.active=null,ut.forEach(function(e){e.checked=!0}),ut.length=Qe=Ke=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Ie&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,r=0,i=n.length,o=this.options;r<i;r++)ie(e=n[r],o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||At(e));return t},sort:function(e,t){var n={},r=this.el;this.toArray().forEach(function(e,t){var i=r.children[t];ie(i,this.options.draggable,r,!1)&&(n[e]=i)},this),t&&this.captureAnimationState(),e.forEach(function(e){n[e]&&(r.removeChild(n[e]),r.appendChild(n[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ie(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var r=Pe.modifyOption(this,e,t);n[e]=void 0!==r?r:t,"group"===e&&bt(n)},destroy:function(){Le("destroy",this);var e=this.el;e[_e]=null,te(e,"mousedown",this._onTapStart),te(e,"touchstart",this._onTapStart),te(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(te(e,"dragover",this),te(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),at.splice(at.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Fe){if(Le("hideClone",this),Ct.eventCanceled)return;le(Ve,"display","none"),this.options.removeCloneOnHide&&Ve.parentNode&&Ve.parentNode.removeChild(Ve),Fe=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Fe){if(Le("showClone",this),Ct.eventCanceled)return;Ie.parentNode!=Re||this.options.group.revertClone?Be?Re.insertBefore(Ve,Be):Re.appendChild(Ve):Re.insertBefore(Ve,Ie),this.options.group.revertClone&&this.animate(Ie,Ve),le(Ve,"display",""),Fe=!1}}else this._hideClone()}},ft&&ee(document,"touchmove",function(e){(Ct.active||it)&&e.cancelable&&e.preventDefault()}),Ct.utils={on:ee,off:te,css:le,find:de,is:function(e,t){return!!ie(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:we,closest:ie,toggleClass:se,clone:Te,index:ve,nextTick:Pt,cancelNextTick:Ot,detectDirection:mt,getChild:he,expando:_e},Ct.get=function(e){return e[_e]},Ct.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ct.utils=Y(Y({},Ct.utils),e.utils)),Pe.mount(e)})},Ct.create=function(e,t){return new Ct(e,t)},Ct.version="1.15.3";var Dt,Lt,kt,It,Mt,Nt,Rt=[],Bt=!1;function jt(){Rt.forEach(function(e){clearInterval(e.pid)}),Rt=[]}function Vt(){clearInterval(Nt)}var Ft=we(function(e,t,n,r){if(t.scroll){var i,o=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=ue(),d=!1;Lt!==n&&(Lt=n,jt(),Dt=t.scroll,i=t.scrollFn,!0===Dt&&(Dt=be(n,!0)));var u=0,f=Dt;do{var p=f,h=fe(p),g=h.top,v=h.bottom,m=h.left,b=h.right,y=h.width,w=h.height,E=void 0,T=void 0,C=p.scrollWidth,_=p.scrollHeight,S=le(p),x=p.scrollLeft,A=p.scrollTop;p===c?(E=y<C&&("auto"===S.overflowX||"scroll"===S.overflowX||"visible"===S.overflowX),T=w<_&&("auto"===S.overflowY||"scroll"===S.overflowY||"visible"===S.overflowY)):(E=y<C&&("auto"===S.overflowX||"scroll"===S.overflowX),T=w<_&&("auto"===S.overflowY||"scroll"===S.overflowY));var P=E&&(Math.abs(b-o)<=s&&x+y<C)-(Math.abs(m-o)<=s&&!!x),O=T&&(Math.abs(v-a)<=s&&A+w<_)-(Math.abs(g-a)<=s&&!!A);if(!Rt[u])for(var D=0;D<=u;D++)Rt[D]||(Rt[D]={});Rt[u].vx==P&&Rt[u].vy==O&&Rt[u].el===p||(Rt[u].el=p,Rt[u].vx=P,Rt[u].vy=O,clearInterval(Rt[u].pid),0==P&&0==O||(d=!0,Rt[u].pid=setInterval(function(){r&&0===this.layer&&Ct.active._onTouchMove(Mt);var t=Rt[this.layer].vy?Rt[this.layer].vy*l:0,n=Rt[this.layer].vx?Rt[this.layer].vx*l:0;"function"==typeof i&&"continue"!==i.call(Ct.dragged.parentNode[_e],n,t,e,Mt,Rt[this.layer].el)||Ee(Rt[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&f!==c&&(f=be(f,!1)));Bt=d}},30),Yt=function(e){var t=e.originalEvent,n=e.putSortable,r=e.dragEl,i=e.activeSortable,o=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=n||i;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(o("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function Xt(){}function Ut(){}Xt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=he(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:Yt},H(Xt,{pluginName:"revertOnSpill"}),Ut.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:Yt},H(Ut,{pluginName:"removeOnSpill"});Ct.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?ee(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ee(document,"pointermove",this._handleFallbackAutoScroll):t.touches?ee(document,"touchmove",this._handleFallbackAutoScroll):ee(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?te(document,"dragover",this._handleAutoScroll):(te(document,"pointermove",this._handleFallbackAutoScroll),te(document,"touchmove",this._handleFallbackAutoScroll),te(document,"mousemove",this._handleFallbackAutoScroll)),Vt(),jt(),clearTimeout(oe),oe=void 0},nulling:function(){Mt=Lt=Dt=Bt=Nt=kt=It=null,Rt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,r=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(r,i);if(Mt=e,t||this.options.forceAutoScrollFallback||q||W||K){Ft(e,this.options,o,t);var a=be(o,!0);!Bt||Nt&&r===kt&&i===It||(Nt&&Vt(),Nt=setInterval(function(){var o=be(document.elementFromPoint(r,i),!0);o!==a&&(a=o,jt()),Ft(e,n.options,o,t)},10),kt=r,It=i)}else{if(!this.options.bubbleScroll||be(o,!0)===ue())return void jt();Ft(e,this.options,be(o,!1),!1)}}},H(e,{pluginName:"scroll",initializeByDefault:!0})}),Ct.mount(Ut,Xt);const Ht=Ct;var zt=function(e){if(function(){if(!window.DOMParser)return!1;var e=new DOMParser;try{e.parseFromString("x","text/html")}catch(e){return!1}return!0}())return(new DOMParser).parseFromString(e,"text/html").body;var t=document.createElement("div");return t.innerHTML=e,t};const Gt={_addUID:function(e){return this.uid?e+"-"+this.uid:e},createDraggableElement:function(e,t){return Ht.create(e,{animation:150,handle:".gpf-btn-icon-territories-draggable",draggable:".draggable-territories-view",ghostClass:"gpf-territories-view-ghost",onEnd:function(e){t.onReorderTerritoriesViews(e)}})},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPterritories"),e.className="GPwidget gpf-widget gpf-widget-button gpf-mobile-fullscreen",e},_createShowTerritoriesPictoElement:function(){var e=this,t=document.createElement("button"),n=document.createElement("span");return t.appendChild(n),t.id=this._addUID("GPshowTerritoriesPicto"),t.classList.add("GPshowOpen","GPshowAdvancedToolPicto","GPshowTerritoriesPicto"),t.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon","gpf-btn-icon-territories"),t.classList.add("fr-icon-france-line"),t.classList.add("fr-btn","fr-btn--tertiary"),t.setAttribute("aria-label","Sélectionner un territoire"),t.setAttribute("tabindex","0"),t.setAttribute("aria-pressed",!1),t.setAttribute("type","button"),t.addEventListener?t.addEventListener("click",function(t){var n="true"===t.target.ariaPressed;t.target.setAttribute("aria-pressed",!n),e.onShowTerritoriesClick(t)}):t.attachEvent&&t.attachEvent("onclick",function(t){var n="true"===t.target.ariaPressed;t.target.setAttribute("aria-pressed",!n),e.onShowTerritoriesClick(t)}),t},_createTerritoriesPanelElement:function(){var e=document.createElement("dialog");return e.id=this._addUID("GPterritoriesPanel"),e.className="GPpanel gpf-panel fr-modal",e},_createTerritoriesPanelDivElement:function(){var e=document.createElement("div");return e.className="gpf-panel__territories",e},_createTerritoriesPanelHeaderElement:function(){var e=document.createElement("div");return e.className="gpf-panel__header_territories",e},_createTerritoriesPanelIconElement:function(){var e=document.createElement("label");return e.className="gpf-btn-header-territories gpf-btn-icon-header-territories",e.title="Selecteur de territoires",e},_createTerritoriesPanelTitleElement:function(e){var t=document.createElement("div");return t.className="gpf-panel__title_territories",t.innerHTML=e,t},_createTerritoriesPanelCloseElement:function(){var e=this,t=document.createElement("button");t.id="GPterritoriesPanelClose",t.className="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",t.title="Fermer le panneau";var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",t.appendChild(n),t.addEventListener?t.addEventListener("click",function(){document.getElementById(e._addUID("GPshowTerritoriesPicto")).click(),e.onCloseTerritoriesClick()},!1):t.attachEvent&&t.attachEvent("onclick",function(){document.getElementById(e._addUID("GPshowTerritoriesPicto")).click(),e.onCloseTerritoriesClick()}),t},_createTerritoriesPanelOptionsElement:function(e,t){var n=this,r="gpf-territories-button-option-id",i="gpf-territories-upload-id",o="gpf-territories-upload-close-id",a="gpf-territories-toggle-messages",s="gpf-territories-apply-id",l='\n        <div>\n            <button type="button" \n                id="'.concat(r,'"\n                class="fr-btn fr-btn--tertiary-no-outline" \n                role="territories-button-options" \n                aria-expanded="false" \n                aria-controls="gpf-territories-upload-container-id">\n                ').concat("&#x2630",'\n            </button>\n            <dialog id="gpf-territories-upload-container-id" class="fr-modal__body fr-upload-group gpf-hidden">\n                <div class="gpf-territories-header-upload">\n                    <button \n                        id="').concat(o,'"\n                        type="button" \n                        class="gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w"\n                        aria-expanded="false"\n                        title="Fermer le panneau">\n                        <span>Fermer</span>\n                    </button>\n                </div>\n                <label class="fr-label">\n                    ').concat(e,'\n                    <span class="fr-hint-text">').concat(t,'</span>\n                </label>\n                <fieldset class="fr-fieldset">\n                    <div class="fr-fieldset__element">\n                        <div class="fr-toggle fr-m-2v">\n                            <input \n                                id="').concat(a,'" \n                                class="fr-toggle__input" \n                                type="checkbox" \n                                aria-describedby="gpf-territories-toggle-messages">\n                            <label class="fr-toggle__label" for="').concat(a,'">Compléter la liste</label>\n                            <div class="fr-messages-group" id="gpf-territories-toggle-messages" aria-live="polite"></div>\n                        </div>\n                    </div>\n                    <div class="fr-fieldset__element">\n                        <input \n                            id="').concat(i,'" \n                            class="fr-upload" \n                            aria-describedby="gpf-territories-upload-id-messages" \n                            type="file" \n                            name="upload">\n                        <div class="fr-messages-group" id="gpf-territories-upload-id-messages" aria-live="polite"></div>\n                    </div>\n                </fieldset>\n                <fieldset class="fr-fieldset">\n                    <button \n                        id="').concat(s,'" \n                        class="gpf-button gpf-button fr-btn fr-btn--tertiary" \n                        aria-describedby="gpf-territories-apply-id-messages">Appliquer</button>\n                    <div class="fr-messages-group" id="gpf-territories-apply-id-messages" aria-live="polite"></div>\n                </fieldset>\n            </dialog>\n        </div>\n        '),c=zt(l).attachShadow({mode:"open"});c.innerHTML=l.trim();var d=c.getElementById(r);d&&d.addEventListener("click",function(e){e.target.ariaExpanded=!("true"===e.target.ariaExpanded);var t=document.getElementById(e.target.getAttribute("aria-controls"));t&&("true"===e.target.ariaExpanded?(t.classList.add("gpf-visible"),t.classList.remove("gpf-hidden")):(t.classList.remove("gpf-visible"),t.classList.add("gpf-hidden")))},!1);var u=c.getElementById(o);u&&u.addEventListener("click",function(e){e.target.ariaExpanded=!("true"===e.target.ariaExpanded),document.getElementById(r).click()});var f=c.getElementById(i);f&&f.addEventListener("change",function(e){n.onUploadFileClick(e)},!1);var p=c.getElementById(a);a&&p.addEventListener("click",function(e){console.log(e.target.checked),n.onUploadToggleClick(e)});var h=c.getElementById(s);return h&&h.addEventListener("click",function(e){n.onApplyTerritoriesClick(e)},!1),c.firstChild},_createTerritoriesPanelMenuViewsDivElement:function(e,t){var n=document.createElement("div");return n.className="territories-views gpf-panel__menuviews_territories",n.appendChild(this._createTerritoriesButtonOpenMenuViewsElement(e,t)),n.appendChild(this._createTerritoriesPanelMenuViewsElement(e)),n},_createTerritoriesButtonOpenMenuViewsElement:function(e,t){var n=this,r=document.createElement("button"),i=document.createElement("span");return r.appendChild(i),r.id="gpf-territories-button-open-views-id",r.classList.add("gpf-btn","gpf-btn--tertiary","gpf-btn-icon"),r.classList.add("fr-btn","fr-btn--tertiary"),r.setAttribute("aria-label",e),r.setAttribute("title",t),r.setAttribute("tabindex","0"),r.setAttribute("aria-pressed",!1),r.setAttribute("aria-controls","gpf-territories-views-container-id"),r.setAttribute("type","button"),r.innerHTML=e,r.addEventListener?r.addEventListener("click",function(e){var t="true"===e.target.ariaPressed;e.target.setAttribute("aria-pressed",!t);var r=document.getElementById(e.target.getAttribute("aria-controls"));r&&(t?(r.classList.remove("gpf-visible"),r.classList.add("gpf-hidden")):(r.classList.add("gpf-visible"),r.classList.remove("gpf-hidden")),n.onShowTerritoriesViewsClick(e))}):r.attachEvent&&r.attachEvent("onclick",function(e){var t="true"===e.target.ariaPressed;e.target.setAttribute("aria-pressed",!t);var r=document.getElementById(e.target.getAttribute("aria-controls"));r&&(t?(r.classList.remove("gpf-visible"),r.classList.add("gpf-hidden")):(r.classList.add("gpf-visible"),r.classList.remove("gpf-hidden")),n.onShowTerritoriesViewsClick(e))}),r},_createTerritoriesPanelMenuViewsElement:function(e){var t=document.createElement("dialog");return t.id="gpf-territories-views-container-id",t.className="fr-modal__body gpf-panel__views_territories-menu gpf-hidden",t.appendChild(this._createTerritoriesMenuAddViewElement(e)),t.appendChild(this._createTerritoriesMenuListViewElement()),t},_createTerritoriesMenuAddViewElement:function(e){var t=this,n="gpf-territories-views-back-button-id",r="gpf-territories-views-input-id",i="gpf-territories-views-form-id",o="gpf-territories-views-submit-id",a='\n        <div>\n            <button \n                id="'.concat(n,'" \n                class="fr-btn fr-icon-arrow-left-line fr-btn--icon-left fr-btn--tertiary-no-outline"\n                aria-pressed="false" \n                aria-controls="gpf-territories-views-container-id gpf-territories-button-open-views-id"\n                title="Retour au sélecteur de territoires" \n                type="button">\n                ').concat(e,'\n            </button>\n            <form id="').concat(i,'">\n                <fieldset \n                    class="fr-fieldset" \n                    id="add-view-form-fieldset" \n                    aria-labelledby="add-view-form-fieldset-legend add-view-form-fieldset-messages">\n                    <legend \n                        class="fr-fieldset__legend" \n                        id="add-view-form-fieldset-legend"> \n                        Ajouter la vue actuelle \n                    </legend>\n                    <div class="fr-fieldset__element">\n                        <div class="fr-input-group" id="').concat(r,'-input-group-view">\n                            <label class="fr-label" for="').concat(r,'"> Nom </label>\n                            <input class="fr-input" aria-describedby="').concat(r,'-messages" id="').concat(r,'" type="text">\n                            <div class="fr-messages-group" id="').concat(r,'-messages" aria-live="polite"></div>\n                        </div>\n                    </div>\n                    <div class="fr-messages-group" id="add-view-form-fieldset-messages" aria-live="polite">\n                        <p class="fr-message fr-message--error gpf-hidden" id="').concat(r,'-message-error-duplicate-id">Ce nom est déjà utilisé</p>\n                        <p class="fr-message fr-message--error gpf-hidden" id="').concat(r,'-message-error-empty-id">Le nom est vide</p>\n                    </div>\n                </fieldset>\n            </form>\n            <input type="submit" id="').concat(o,'" value="Ajouter" class="fr-btn">\n            <hr class="fr-m-1v"/>\n        </div>\n        '),s=zt(a).attachShadow({mode:"open"});s.innerHTML=a.trim();var l=s.getElementById(n);l&&l.addEventListener("click",function(e){var n="true"===e.target.ariaPressed;e.target.setAttribute("aria-pressed",!n);var i=e.target.getAttribute("aria-controls").split(" "),o=document.getElementById(i[0]);if(o){o.classList.remove("gpf-visible"),o.classList.add("gpf-hidden");var a=document.getElementById(i[1]);if(a){a.setAttribute("aria-pressed","false");var s=document.getElementById(r);if(s){s.value="";var l=document.getElementById(r+"-message-error-empty-id"),c=document.getElementById(r+"-message-error-duplicate-id");l&&l.classList.add("gpf-hidden"),c&&c.classList.add("gpf-hidden")}t.onCloseTerritoriesViewsClick(e)}}},!1);var c=s.getElementById(i);c&&c.addEventListener("submit",function(e){e.preventDefault();var n=document.getElementById(r);n&&t.onAddTerritoriesViewClick(e,n.value)},!1);var d=s.getElementById(o);return d&&d.addEventListener("click",function(e){e.preventDefault();var n=document.getElementById(r);if(n){var i=t.territories.find(function(e){return e.data.title===n.value}),o=document.getElementById(r+"-message-error-empty-id"),a=document.getElementById(r+"-message-error-duplicate-id");if(""===n.value)return o&&o.classList.remove("gpf-hidden"),void(a&&a.classList.add("gpf-hidden"));if(i)return a&&a.classList.remove("gpf-hidden"),void(o&&o.classList.add("gpf-hidden"));o&&o.classList.add("gpf-hidden"),a&&a.classList.add("gpf-hidden"),t.onAddTerritoriesViewClick(e,n.value)}},!1),s.firstChild},_createTerritoriesMenuListViewElement:function(){var e=this,t="gpf-territories-views-reset-button-id",n='\n        <div class="gpf-panel__views_territories-listview">\n            \x3c!-- Menu de la liste des vues --\x3e\n            <div class="gpf-panel__views_territories-listview-header">\n                <div class="gpf-panel__views_territories-listview-count">\n                    <span class="fr-label" style="padding-right: 10px; font-weight: bolder;"> Territoires </span>\n                    <span \n                        class="fr-badge fr-badge--sm fr-badge--info fr-badge--no-icon" \n                        id="'.concat("gpf-territories-views-count-id",'"> 0 </span>\n                </div>\n                <button \n                    id="').concat(t,'" \n                    class="fr-btn fr-btn--sm fr-btn--tertiary-no-outline"\n                    title="Réinitialiser la liste des territoires" \n                    type="button">\n                    Réinitialiser\n                </button>\n            </div>\n            \x3c!-- Liste des vues --\x3e\n            <div \n                id="gpf-territories-views-listview-entries-id"\n                class="gpf-panel__views_territories-listview-entries">\n            </div>\n        </div>\n        '),r=zt(n).attachShadow({mode:"open"});r.innerHTML=n.trim();var i=r.getElementById(t);return i&&i.addEventListener("click",function(t){e.onResetTerritoriesViewClick(t)},!1),r.firstChild},_createTerritoriesElement:function(){var e=document.createElement("div");return e.className="territories-entries gpf-panel__body_territories fr-modal__body",e},_createTerritoryEntry:function(e){var t=this;if(e){var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFvSURBVHgB7ZfBisIwEIb/aIWKHsXH8OCT+lBevHgRjwp6EBEREdRqTbKZLN3FXT20yRyK80FIqJR8mf4drDqfjUWNaKBmiDA3IsyNCHMjwtyIMDcizI0Ic/O5wsYA7bZCkjxfb7UQlWjCnY7CaJRhNtM/0nSAyUQjTRViEU3Yug+t8Tj3ws2mcpVVWCw0Gm4Hmv9Wvioq1jcdRaLbVX6+XCyUK+p0ql2VgevVYjhM/LVQolSYqni7AVlm/aB4UKXT9LvyFI35PE40goVJ9nSiYb0cPfrVyvh1Aa21BjYb4+KCIIKFiwhQNzgcSFphvTb/ugMdZLnULhbq6TBlCcowSex2v7dTRvd74+PxLq90kMEg8dGpQuUKF1GgR01VpvF4AP1+A3lu/frVOB4ttltT+QWsXGHakN7+V5mkQ9zv7++l33s95efS+4ZEIqRNVc1xUDu3UTp4OeTfGjcizI0IcyPC3IgwNyLMjQhzUzvhL49qosB5TImnAAAAAElFTkSuQmCC",r=e.thumbnail||n,i="",o=e.icon||n;i=o.startsWith("fr-icon-")?'\n                <button \n                    type="button" \n                    class="fr-btn fr-btn--lg '.concat(o,' fr-btn--tertiary-no-outline">\n                </button>'):'\n                <svg>       \n                    <image id="icon-'.concat(e.id,'" xlink:href="').concat(o,'" style="width:100%;"/>    \n                </svg>');var a=e.id.toLowerCase(),s=zt('\n            <div class="gpf-tile fr-tile fr-tile--sm">\n                <div class="fr-tile__body">\n                    <div class="fr-tile__content">\n                        <p class="fr-tile__title">\n                            <label class="gpf-label fr-label" title="'.concat(e.description,'">').concat(e.title,'</label>\n                        </p>\n                    </div>\n                </div>\n                <div class="gpf-tile__header fr-tile__header">\n                    <div class="fr-tile__pictogram fr-tile__thumbnail">\n                        <img id="thumbnail-').concat(e.id,'" src="').concat(r,'" width="100%" height="100%" title="').concat(e.description,'"/>\n                    </div>\n                    <div class="fr-tile__pictogram fr-tile__icon fr-tile__icon--').concat(a,'">\n                        ').concat(i,"\n                    </div>\n                </div>\n            </div>\n            ")),l=s.firstChild;return l&&l.addEventListener("click",function(n){t.onImageTerritoriesClick(n,e.id)}),s.firstChild}},_createTerritoryView:function(e){var t=this,n="gpf-territories-view-entry-button-id-"+e.id;if(e){var r=zt('\n            <div class="gpf-panel__views_territories-listview-entry draggable-territories-view">\n                \x3c!-- '.concat(e.title,' --\x3e\n                <div style="display: flex;flex-direction: row;align-items: center;">    \n                    <span class="gpf-btn gpf-btn-icon-territories-draggable gpf-btn--tertiary"></span>\n                    <label class="gpf-label fr-label" title="').concat(e.description,'">').concat(e.title,'</label>\n                </div>\n                <button \n                    id="').concat(n,'" \n                    type="button" \n                    class="fr-btn fr-btn--sm fr-btn--icon-left fr-btn--tertiary-no-outline gpf-btn gpf-btn-icon-territories-remove gpf-btn--tertiary"></button>\n            </div>\n            ')),i=r.firstChild;if(i){i.addEventListener("click",function(n){t.onViewTerritoryClick(n,e.id)});var o=r.querySelector("#"+n);o&&o.addEventListener("click",function(n){n.stopPropagation(),t.onViewTerritoryRemoveClick(n,e.id)})}return r.firstChild}}};function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zt(r.key),r)}}function Zt(e){var t=function(e,t){if("object"!=Wt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wt(t)?t:t+""}function Jt(e,t){if(t&&("object"==Wt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return($t=function(){return!!e})()}function en(){return en="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=tn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},en.apply(null,arguments)}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tn(e)}function nn(e,t){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nn(e,t)}var rn=B.getLogger("territories"),on=function(e){function t(e){var n,r,i,o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=[e=e||{}],i=tn(i=t),!((n=Jt(r,$t()?Reflect.construct(i,o||[],tn(r).constructor):i.apply(r,o)))instanceof t))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return n.CLASSNAME="Territories",n.initialize(e),n.container=n.initContainer(),n.element?n.element.appendChild(n.container):n.element=n.container,Jt(n,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nn(e,t)}(t,e),n=t,r=[{key:"setMap",value:function(e){if(e){this.draggable&&j.dragElement(this.panelTerritoriesContainer,this.panelTerritoriesHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonTerritoriesShow.setAttribute("aria-pressed",!0);for(var n=this.auto?V:this.options.territories,r=0;r<n.length;r++){var i=n[r];this.setTerritory(i)}}var o,a,s,l,c;(o=t,a="setMap",s=this,c=en(tn(1&(l=3)?o.prototype:o),a,s),2&l&&"function"==typeof c?function(e){return c.apply(s,e)}:c)([e]),this.options.position&&this.setPosition(this.options.position),!1===this.options.gutter&&this.getContainer().classList.add("gpf-button-no-gutter"),this.createDraggableElement(this.element.querySelector("#gpf-territories-views-listview-entries-id"),this),this.dispatchEvent({type:"territories:loaded"})}},{key:"setTerritory",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.territories.some(function(t){return t.data.id===e.id});if(e&&!n){var r=this._createTerritoryEntry(e),i=this._createTerritoryView(e);if(r&&i){this.panelTerritoriesEntriesContainer.appendChild(r),this.panelTerritoriesViewsContainer.appendChild(i);var o=this.element.querySelector("#gpf-territories-views-count-id");if(o){var a=this.territories.filter(function(e){return!e.isRemoved}).length+1;o.innerText=a}return this.territories.push({isRemoved:!1,isAdded:t,data:e,initialIndex:this.territories.length,domEntry:r,domView:i}),!0}}return!1}},{key:"setTerritories",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.setTerritory(n)}}},{key:"removeTerritory",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;if(e)for(var r=0;r<this.territories.length;r++)if(this.territories[r].data.id===e.data.id){t?(this.territories[r].domEntry.remove(),this.territories[r].domView.remove(),this.territories.splice(r,1)):(this.territories[r].isRemoved=!0,this.territories[r].domEntry.classList.add("gpf-hidden"),this.territories[r].domView.style.display="none"),n=!0;var i=this.element.querySelector("#gpf-territories-views-count-id");if(i){var o=this.territories.filter(function(e){return!e.isRemoved}).length;i.innerText=o}break}return n}},{key:"removeTerritories",value:function(){for(var e=0;e<this.territories.length;e++){var t=this.territories[e];t.domEntry.remove(),t.domView.remove()}this.territories=[]}},{key:"setCollapse",value:function(e){void 0!==e?e&&this.collapsed||!e&&!this.collapsed||(e?document.getElementById("GPterritoriesPanelClose").click():this.buttonTerritoriesShow.click(),this.collapsed=e):rn.log("[ERROR] Territory:setCollapsed - missing collapsed parameter")}},{key:"setReduce",value:function(e){e?this.panelTerritoriesEntriesContainer.classList.add("tiles-reduce"):this.panelTerritoriesEntriesContainer.classList.remove("tiles-reduce")}},{key:"getContainer",value:function(){return this.container}},{key:"initialize",value:function(e){this.uid=e.id||M.generate(),this.options={collapsed:!0,draggable:!1,panel:!0,upload:{active:!1,title:"Ajouter un fichier de configuration",description:""},view:{active:!1,title:"Modifier les territoires",description:""},title:"Sélectionner un territoire",auto:!1,thumbnail:!1,reduce:!1,tiles:3,territories:[]};var t=L.assign(this.options.upload,e.upload);L.assign(this.options,e),L.assign(this.options.upload,t),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.territories=[],this.uploadConfig=null,this.append=!1,this.buttonTerritoriesShow=null,this.panelTerritoriesContainer=null,this.panelTerritoriesHeaderContainer=null,this.buttonTerritoriesClose=null,this.containerTerritoriesOptions=null,this.panelTerritoriesEntriesContainer=null,this.panelTerritoriesViewsContainer=null}},{key:"initContainer",value:function(){var e=this._createMainContainerElement(),t=this.buttonTerritoriesShow=this._createShowTerritoriesPictoElement();e.appendChild(t);var n=this.panelTerritoriesContainer=this._createTerritoriesPanelElement();n.classList.add("tiles-direction"),n.classList.add("tiles-"+this.options.tiles);var r=this._createTerritoriesPanelDivElement();n.appendChild(r);var i=this._createTerritoriesPanelMenuViewsDivElement(this.options.view.title,this.options.view.description);n.appendChild(i),this.panelTerritoriesViewsContainer=i.querySelector("#gpf-territories-views-listview-entries-id"),this.options.view&&!this.options.view.active&&(i.style.display="none");var o=this.panelTerritoriesEntriesContainer=this._createTerritoriesElement();if(o.classList.add("tiles-direction"),o.classList.add("tiles-"+this.options.tiles),this.options.reduce&&o.classList.add("tiles-reduce"),this.options.thumbnail?o.classList.add("tiles-thumbnail"):o.classList.add("tiles-icon"),n.appendChild(o),this.options.panel){var a=this.panelTerritoriesHeaderContainer=this._createTerritoriesPanelHeaderElement(),s=this._createTerritoriesPanelIconElement();a.appendChild(s);var l=this._createTerritoriesPanelTitleElement(this.options.title);if(a.appendChild(l),this.options.upload&&this.options.upload.active){var c=this.containerTerritoriesOptions=this._createTerritoriesPanelOptionsElement(this.options.upload.title,this.options.upload.description);a.appendChild(c)}var d=this.buttonTerritoriesClose=this._createTerritoriesPanelCloseElement();a.appendChild(d),r.appendChild(a)}return e.appendChild(n),rn.log(e),e}},{key:"closePanelUpLoad",value:function(){var e=this.containerTerritoriesOptions.children[0];e&&e.setAttribute("aria-expanded","false");var t=this.containerTerritoriesOptions.children[1];t&&(t.classList.add("gpf-hidden"),t.classList.remove("gpf-visible"))}},{key:"onShowTerritoriesClick",value:function(e){"true"===e.target.ariaPressed&&this.onPanelOpen(),rn.trace(e),this.collapsed=!this.collapsed}},{key:"onCloseTerritoriesClick",value:function(e){rn.trace(e)}},{key:"onImageTerritoriesClick",value:function(e,t){rn.trace(e,t);var n=this.territories.find(function(e){return e.data.id===t});if(n){var r=n.data.zoom,i=n.data.bbox,o=n.data.point;if(i&&!i.length)return;if(!o&&!i)return;var a=this.getMap(),s=a.getView().getProjection().getCode();if(i){var l=(0,A.transformExtent)(i,"EPSG:4326",s);a.getView().fit(l,{size:a.getSize()})}if(o){var c=(0,A.transform)(o,"EPSG:4326",s);a.getView().setCenter(c)}r&&a.getView().setZoom(r),this.setCollapse(!0),this.dispatchEvent({type:"territories:change",territory:n.data})}}},{key:"onUploadFileClick",value:function(e){var t=e.target.files[0];if(e.target,t){var n=new FileReader,r=this;n.onerror=function(e){rn.log("onerror")},n.onprogress=function(e){rn.log("onprogress")},n.onloadstart=function(e){rn.log("onloadstart")},n.onabort=function(e){rn.log("onabort")},n.onloadend=function(e){rn.log("onloadend : ",e)},n.onload=function(e){rn.log("file content : ",e.target.result);try{if(r.uploadConfig=JSON.parse(e.target.result),!r.uploadConfig)return void console.error("Invalid configuration file !")}catch(e){return void console.error("Error parsing configuration file : ",e)}},n.readAsText(t)}else rn.warn("Missing file to upload !")}},{key:"onUploadToggleClick",value:function(e){this.append=e.target.checked}},{key:"onApplyTerritoriesClick",value:function(e){rn.trace(e),this.closePanelUpLoad(),this.uploadConfig?(this.append||this.removeTerritories(),this.setTerritories(this.uploadConfig)):rn.error("No configuration to apply !")}},{key:"onShowTerritoriesViewsClick",value:function(e){rn.trace(e)}},{key:"onCloseTerritoriesViewsClick",value:function(e){rn.trace(e),this.closePanelUpLoad()}},{key:"onAddTerritoriesViewClick",value:function(e,t){rn.trace(e,t);var n=Math.abs(Array.from(t).reduce(function(e,t){return Math.imul(31,e)+t.charCodeAt(0)|0},0)),r=this.getMap().getView(),i=r.getProjection().getCode(),o=(0,A.transform)(r.getCenter(),i,"EPSG:4326"),a=r.getZoom(),s={id:n.toString(),title:t,description:"Vue personnalisée",point:o,zoom:a,thumbnail:"",icon:"fr-icon-map-pin-2-line"};this.setTerritory(s,!0),this.dispatchEvent({type:"territories:add",territory:s})}},{key:"onResetTerritoriesViewClick",value:function(e){var t=this;rn.trace(e);var n,r=qt(this.territories.slice());try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isAdded?this.removeTerritory(i,!0):i.isRemoved&&(i.domEntry.classList.remove("gpf-hidden"),i.domView.style.display="",i.isRemoved=!1)}}catch(e){r.e(e)}finally{r.f()}this.territories.sort(function(e,t){return e.initialIndex-t.initialIndex}),this.panelTerritoriesEntriesContainer.innerHTML="",this.territories.forEach(function(e){t.panelTerritoriesEntriesContainer.appendChild(e.domEntry)}),this.panelTerritoriesViewsContainer.innerHTML="",this.territories.forEach(function(e){t.panelTerritoriesViewsContainer.appendChild(e.domView)});var o=this.element.querySelector("#gpf-territories-views-count-id");if(o){var a=this.territories.filter(function(e){return!e.isRemoved}).length;o.innerText=a}}},{key:"onViewTerritoryClick",value:function(e,t){rn.trace(e,t)}},{key:"onViewTerritoryRemoveClick",value:function(e,t){rn.trace(e,t);var n=this.territories.find(function(e){return e.data.id===t});n&&(this.removeTerritory(n,n.isAdded),this.dispatchEvent({type:"territories:remove",territory:n.data}))}},{key:"onReorderTerritoriesViews",value:function(e){var t=this;rn.trace(e);var n=Array.from(this.panelTerritoriesViewsContainer.children),r=[];n.forEach(function(e){var n=t.territories.find(function(t){return t.domView===e});n&&r.push(n)}),this.territories=r,this.panelTerritoriesEntriesContainer.innerHTML="",this.territories.forEach(function(e){t.panelTerritoriesEntriesContainer.appendChild(e.domEntry)})}}],r&&Kt(n.prototype,r),i&&Kt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(g);Object.assign(on.prototype,Gt),Object.assign(on.prototype,x);const an=on;window.ol&&window.ol.control&&(window.ol.control.Territories=on)})(),GpfExtOlTerritories=r.default})();
//# sourceMappingURL=GpfExtOlTerritories.js.map