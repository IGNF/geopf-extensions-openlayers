{"version":3,"file":"GpfExtOlSearchEngineBase.js","mappings":"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","sources":["webpack://geopf-extensions-openlayers/./src/packages/Services/AbstractSearchService.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Control.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/Helper.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/Utils/CheckDsfr.js","webpack://geopf-extensions-openlayers/./node_modules/loglevel/lib/loglevel.js","webpack://geopf-extensions-openlayers/./src/packages/Utils/LoggerByDefault.js","webpack://geopf-extensions-openlayers/external assign \"ol.Object\"","webpack://geopf-extensions-openlayers/external assign \"ol.control.Control\"","webpack://geopf-extensions-openlayers/webpack/bootstrap","webpack://geopf-extensions-openlayers/webpack/runtime/compat get default export","webpack://geopf-extensions-openlayers/webpack/runtime/define property getters","webpack://geopf-extensions-openlayers/webpack/runtime/hasOwnProperty shorthand","webpack://geopf-extensions-openlayers/./src/packages/Services/DefaultSearchService.js","webpack://geopf-extensions-openlayers/./src/packages/Controls/SearchEngine/SearchEngineBase.js"],"sourcesContent":["import Logger from \"../Utils/LoggerByDefault\";\nimport BaseObject from \"ol/Object\";\n\nvar logger = Logger.getLogger(\"searchengine\");\n\n/**\n * @classdesc\n * Service de recherche abstrait : base commune pour les services d'autocomplétion et de géocodage.\n * À surcharger pour chaque type de service (IGN, INSEE, etc.).\n *\n * @alias ol.service.AbstractSearchService\n * @abstract\n * @module SearchService\n */\nclass AbstractSearchService extends BaseObject {\n\n    /**\n     * Constructeur du service abstrait.\n     * @constructor\n     * @param {AbstractSearchServiceOptions} options Options du service\n     */\n    constructor (options) {\n        options = options || {};\n\n        // call ol.control.Control constructor\n        super(options);\n\n        if ((this.constructor == AbstractSearchService)) {\n            throw new TypeError(\"AbstractSearchService cannot be instantiate\");\n        }\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"AbstractSearchService\";\n\n        // initialisation du composant\n        this.initialize(options);\n\n        return this;\n    }\n\n    /**\n     * Initialise le service avec les options fournies.\n     * @protected\n     * @param {AbstractSearchServiceOptions} options Options de configuration du service\n     */\n    initialize (options) {\n        this.AUTOCOMPLETE_EVENT = \"autocomplete\";\n        this.SEARCH_EVENT = \"search\";\n        this.ERROR_EVENT = \"error\";\n\n        this._autocompleteLocations = [];\n        this._locations = [];\n\n        if (options.autocomplete === false) {\n            this.set(\"autocomplete\", false);\n        }\n        this.set(\"index\", options.index || \"address,poi\");\n        this.set(\"limit\", typeof options.limit === \"number\" ? options.limit : 1);\n        this.set(\"returnTrueGeometry\", !!options.returnTrueGeometry);\n    }\n\n    /**\n     * Récupère la liste des résultats d'autocomplétion.\n     * @param {Number} [index] Index du résultat (optionnel). Si non fourni, retourne tous les résultats.\n     * @returns {Array<AutocompleteResult>|AutocompleteResult} Un tableau de résultats ou un résultat unique\n     */\n    getAutocompleteLocations (index) {\n        if (index === undefined) {\n            return this._autocompleteLocations;\n        } else {\n            return this._autocompleteLocations[index];\n        }\n    }\n\n    /**\n     * Récupère la liste des résultats de recherche finale.\n     * @param {Number} [index] Index du résultat (optionnel). Si non fourni, retourne tous les résultats.\n     * @returns {Array<SearchResult>|SearchResult} Un tableau de résultats ou un résultat unique\n     */\n    getResult (index) {\n        if (index === undefined) {\n            return this._locations;\n        } else {\n            return this._locations[index];\n        }\n    }\n\n    /**\n     * Lance une autocomplétion.\n     * Méthode à surcharger dans les services concrets.\n     * @param {String} text Texte d'autocomplétion\n     * @abstract\n     */\n    autocomplete (text) { }\n\n\n    /**\n     * Lance une recherche.\n     * Méthode à surcharger dans les services concrets.\n     * @param {Object} obj Options de recherche (dépend du service)\n     * @abstract\n     */\n    search (obj) { }\n\n\n    /**\n     * Retourne le titre à afficher pour un résultat.\n     * Méthode à surcharger dans les services concrets.\n     * @param {AutocompleteResult} obj Objet dont le titre dérive\n     * @abstract\n     * @returns {String} Titre du résultat\n     */\n    getItemTitle (obj) { \n        return obj;\n    }\n\n}\n\nexport default AbstractSearchService;\n\n// Expose SearchEngine as ol.control.SearchEngine (for a build bundle)\nif (window.ol) {\n    if (!window.ol.service) {\n        window.ol.service = {};\n    }\n    window.ol.service.AbstractSearchService = AbstractSearchService;\n}\n","import Control from \"ol/control/Control\";\nimport checkDsfr from \"./Utils/CheckDsfr\";\n\nclass ControlExtended extends Control {\n\n    constructor (options) {\n        options = options || {};\n        super({\n            element : options.element,\n            target : options.target,\n            render : options.render\n        });\n        // Can the control appear in the ControlList control\n        if (options && options.listable) {\n            this.listable = true;\n        } else {\n            this.listable = false;\n        }\n        // Set the control desctiption\n        if (options && options.description) {\n            this.description = options.description;\n        } else {\n            this.description = \"\";\n        }\n    }\n\n    setPosition (pos) {\n        if (this.getMap()) {\n            var instance = new PositionFactory(this);\n            instance.set(pos);\n        }\n    }\n\n    updatePosition (pos) {\n        if (this.getMap()) {\n            var instance = new PositionFactory(this);\n            instance.update(pos);\n        }\n    }\n\n};\n\nexport default ControlExtended;\n\n/**\n * gestion des anchors\n */\nconst ANCHORS = [\n    \"top-left\",\n    \"top-right\",\n    \"bottom-left\",\n    \"bottom-right\"\n];\n\n/**\n * Position\n * @private\n */\nclass PositionFactory {\n\n    /**\n     * constructor\n     * @param {*} caller - ...\n     */\n    constructor (caller) {\n        this.caller = caller;\n        this.container = null;\n\n        this.#createContainer(\"top-left\");\n        this.#createContainer(\"top-right\");\n        this.#createContainer(\"bottom-left\");\n        this.#createContainer(\"bottom-right\");\n\n        return this;\n    }\n\n    /**\n     * ...\n     * @param {*} name  - ...\n     * @returns {Boolean} ...\n     */\n    #existContainer (name) {\n        var div = this.container.children[\"position-container-\" + name];\n        if (div) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * ...\n     * @param {*} name - ...\n     * @private\n     */\n    #createContainer (name) {\n        this.container = this.caller.getMap().getOverlayContainerStopEvent();\n\n        if (this.#existContainer(name)) {\n            return;\n        }\n        // INFO\n        // positionner les classes position-container-[left|right|top|bottom]\n        // ex. { position:relative; height:50px; width:100%; }\n        var div = document.createElement(\"div\");\n        div.id = \"position-container-\" + name;\n        div.className = \"position position-container-\" + name ;\n\n        this.container.appendChild(div);\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @param {*} update - ...\n     * @todo fonctionnement à tester !\n     */\n    #setAnchor (pos, update) {\n        var self = this;\n        const position = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            return element.children.length;\n        };\n        const sizeW = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            var width = element.offsetWidth;\n            return width;\n        };\n        const sizeH = (pos) => {\n            var element = self.container.children[\"position-container-\" + pos];\n            var height = element.offsetHeight;\n            if (update) {\n                if (pos.includes(\"top\")) {\n                    height = 0;\n                }\n                // on recalcule la position en hauteur\n                for (let index = 0; index < element.children.length; index++) {\n                    const id = element.children[index].id;\n                    if (id === self.caller.element.id) {\n                        height = (pos.includes(\"bottom\")) ? height - self.caller.element.offsetHeight : height * (-1);\n                        break;\n                    }\n                    height -= element.children[index].offsetHeight;\n                }\n            }\n            return height;\n        };\n        const clear = (element) => {\n            element.style.top = \"unset\";\n            element.style.bottom = \"unset\";\n            element.style.left = \"unset\";\n            element.style.right = \"unset\";\n        };\n\n        // on supprime le style de positionnement (top, left...)\n        // car on souhaite une nouvelle position\n        clear(this.caller.element);\n        this.caller.element.style.position = \"unset\"; // div.GPwidget\n\n        // on recherche les panneaux (panel) :\n        // * panel de formulaire\n        // * panel de resultats (?)\n        var panels = Array.from(this.caller.element.getElementsByClassName(\"GPpanel\"));\n        if (panels.length === 0) {\n            return;\n        }\n        var offset = 0;\n        panels.forEach((panel) => {\n            // INFO\n            // on va eviter de modifier les panneaux de resultats\n            // car leurs positions sont souvent relative aux panneaux\n            // des formulaires\n            if (panel.nodeName.toLowerCase() !== \"dialog\") {\n                return;\n            }\n            clear(panel);\n            // on modifie le positionnement du menu (dialog ou div : panel)\n            // en fonction du bouton\n            // ex. bouton : bottom-left, menu : bottom:0px; left:50px\n            switch (pos.toLowerCase()) {\n                case \"top-left\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.top = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.left = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"bottom-left\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.bottom = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.left = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"top-right\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.top = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.right = sizeW(pos) + offset + \"px\";\n                    break;\n                case \"bottom-right\":\n                    if (checkDsfr()) {\n                        panel.style.top = \"0px\";\n                    } else {\n                        panel.style.bottom = position(pos) ? sizeH(pos) + \"px\" : \"0px\";\n                    }\n                    panel.style.right = sizeW(pos) + offset + \"px\";\n                    break;\n                default:\n                    break;\n            }\n            offset += panel.offsetWidth;\n        });\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @public\n     */\n    set (pos) {\n        if (!ANCHORS.includes(pos.toLowerCase())) {\n            return;\n        }\n        // positionnement de l'element\n        this.#setAnchor(pos, false);\n\n        if (pos.includes(\"bottom\")) {\n            this.container.children[\"position-container-\" + pos].prepend(this.caller.element);\n        } else {\n            this.container.children[\"position-container-\" + pos].appendChild(this.caller.element);\n        }\n    }\n\n    /**\n     * ...\n     * @param {*} pos - ...\n     * @public\n     */\n    update (pos) {\n        if (!ANCHORS.includes(pos.toLowerCase())) {\n            return;\n        }\n        // positionnement de l'element\n        // mais, il faut prendre en compte la position !\n        this.#setAnchor(pos, true);\n    }\n\n};\n","let uidCounter_ = 0;\n\n/**\n* @module Helper\n* @alias module:~utils/HelperUtils\n* @description\n* ...\n*\n* @example\n* import HelperUtils from \"gpf-ext-ol/utils/HelperUtils\"\n* ou \n* import {HelperUtils} from \"gpf-ext-ol\n* \n* HelperUtils.detectSupport();\n* HelperUtils.assign();\n* HelperUtils.mergeParams();\n*/\nvar Helper = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @function detectSupport\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport : function () {\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @function assign\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign : function (dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @function mergeParams\n     * @param {Object} dest     - destination object where properties and method will be merge\n     * @param {Object} source   - source object from which properties and method will be merge\n     * @param {Boolean} replace - replace destination value by source if exists or not (true by default)\n     */\n    mergeParams : function (dest, source, replace) {\n        if (typeof dest === \"undefined\" || typeof source === \"undefined\") {\n            return;\n        }\n        if (typeof replace === \"undefined\") {\n            replace = true;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param], replace);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    if (dest.hasOwnProperty(param)) {\n                        if (replace) {\n                            dest[param] = source[param];\n                        }\n                    } else {\n                        dest[param] = source[param];\n                    }\n                }\n            }\n        }\n    },\n    /**\n     * Gets a unique ID for an object. This mutates the object so that further calls\n     * with the same object as a parameter returns the same value. Unique IDs are generated\n     * as a strictly increasing sequence. Adapted from goog.getUid.\n     *\n     * @param {String} prefix - prefix for the unique ID\n     * @param {Object} [obj] The object to get the unique ID for.\n     * @return {String} The unique ID for the object.\n     * @api\n     */\n    getUid : function (prefix, obj) {\n        if (obj) {\n            if (obj.id) {\n                return obj.id;\n            }\n        }\n        return prefix + (++uidCounter_);\n    }\n};\n\nexport default Helper;\n","var checkDsfr = function () {\n    // HACK: check si le styl dsfr est chargé via la variable blue-france-sun-113-625\n    var style = getComputedStyle(document.documentElement);\n    var color = style.getPropertyValue(\"--blue-france-sun-113-625\");\n    if (color === \"\") {\n        return false;\n    }\n    return true;\n};\n\nexport default checkDsfr;\n\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","import * as Log from \"loglevel\";\n\n/**\n * @module LoggerByDefault\n * @alias module:~utils/Logger\n * @description\n * ...\n *\n * @example\n * import Logger from \"gpf-ext-ol/utils/LoggerByDefault\"\n * ou \n * import {Logger} from \"gpf-ext-ol\n * \n * Logger.getLogger();\n * Logger.disableAll();\n * Logger.enableAll();\n */\nvar LoggerByDefault = {\n    /**\n     * creation d'un logger statique\n     *\n     * @function getLogger\n     * @param {String} [name=\"default\"] - the logger name\n     * @returns {Object} logger\n     */\n    getLogger : function (name) {\n        // on définit process si non défini dans l'environnement\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    },\n    /**\n     * desactive tous les loggers\n     * @function disableAll\n     */\n    disableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.disableAll();\n            }\n        }\n    },\n    /**\n     * active tous les loggers\n     * @function enableAll\n     */\n    enableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.enableAll();\n            }\n        }\n    }\n};\n\nexport default LoggerByDefault;\n\n// Expose Export as ol.control.Catalog (for a build bundle)\nif (window.Gp) {\n    window.Gp.Logger = LoggerByDefault;\n}\n","module.exports = ol.Object;","module.exports = ol.control.Control;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import Logger from \"../Utils/LoggerByDefault\";\nimport AbstractSearchService from \"./AbstractSearchService\";\n\nvar logger = Logger.getLogger(\"searchengine\");\n\n/**\n * @classdesc\n * Service de recherche par défaut (implémentation simple pour tests ou données locales).\n *\n * @alias ol.service.DefaultSearchService\n * @module SearchService\n * @extends AbstractSearchService\n */\nclass DefaultSearchService extends AbstractSearchService {\n\n    /**\n     * Constructeur du service par défaut.\n     * @constructor\n     * @param {AbstractSearchServiceOptions} options Options du service (ex: {searchTab: [...]})\n     * @param {Array<Object|String>} options.searchTab Tableau d'élément dans lequel rechercher\n     */\n    constructor (options) {\n        options = options || {};\n        super(options);\n        /**\n         * Nom de la classe (héritage)\n         * @private\n         */\n        this.CLASSNAME = \"DefaultSearchService\";\n        if (options.searchTab) {\n            this._searchTab = options.searchTab || [];\n        }\n    }\n\n    /**\n     * Lance une autocomplétion sur la liste locale.\n     * @override\n     * @param {String} value Valeur à compléter\n     */\n    autocomplete (value) {\n        // Simulate asynchronous behavior\n        this._autocompleteLocations = [];\n        const rex = new RegExp(value, \"i\");\n        (this._searchTab || []).forEach((city) => {\n            if (rex.test(city.toLowerCase())) {\n                this._autocompleteLocations.push(city);\n            }\n        });\n        // When search is finished\n        this.dispatchEvent({ \n            type : this.AUTOCOMPLETE_EVENT,\n            result : this._autocompleteLocations\n        });\n    }\n\n    /**\n     * Lance une recherche (simulée).\n     * @override\n     * @param {Object} obj Options de recherche\n     */\n    search (obj) {\n        this.dispatchEvent({ \n            type : this.SEARCH_EVENT, \n            result : obj\n        });\n    }\n\n}\n\nexport default DefaultSearchService;\n\n// Expose DefaultSearchService as ol.service.DefaultSearchService (for a build bundle)\nif (window.ol) {\n    if (!window.ol.service) {\n        window.ol.service = {};\n    }\n    window.ol.service.DefaultSearchService = DefaultSearchService;\n}\n","// import CSS\nimport \"../../CSS/Controls/SearchEngine/GPFsearchEngine.css\";\nimport Control from \"../Control\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport DefaultSearchService from \"../../Services/DefaultSearchService\";\nimport Helper from \"../../Utils/Helper\";\n\n// Voir les typedefs partagés dans ./typedefs.js (SearchEngineBaseOptions, SearchServiceOptions, ...)\n\nconst history = \"fr-icon-history-line\";\nconst defaultIcon = \"fr-icon-map-pin-2-line\";\nconst typeClasses = {\n    \"StreetAddress\" : \"fr-icon-map-pin-2-line\",\n    \"PositionOfInterest\" : {\n        \"administratif\" : \"fr-icon-france-line\",\n        \"hydrographie\" : \"fr-icon-ign-mer\",\n        \"transport\" : {\n            \"télécabine, téléphérique transport par câble\" : \"fr-icon-subway-line\",\n            \"gare voyageurs uniquement\" : \"fr-icon-subway-line\",\n            \"voyageurs et fret\" : \"fr-icon-subway-line\",\n            \"station de métro\" : \"fr-icon-subway-line\",\n            \"gare fret uniquement\" : \"fr-icon-subway-line\",\n            \"gare routière\" : \"fr-icon-subway-line\",\n            \"station de tramway\" : \"fr-icon-subway-line\",\n            \"arrêt voyageurs\" : \"fr-icon-subway-line\",\n\n            \"aérodrome\" : \"fr-icon-plane-line\",\n            \"héliport\" : \"fr-icon-plane-line\",\n            \"altiport\" : \"fr-icon-plane-line\",\n            \"aérogare\" : \"fr-icon-plane-line\",\n\n            \"port\" : \"fr-icon-ship-2-line\",\n            \"gare maritime\" : \"fr-icon-ship-2-line\",\n\n            \"parking\" : \"fr-icon-parking-box-line\",\n            \"aire de repos ou de service\" : \"fr-icon-parking-box-line\",\n\n            \"service dédié aux vélos\" : \"fr-icon-bike-line\",\n        }\n    }\n};\n\nvar logger = Logger.getLogger(\"searchengine\");\n\n/**\n * @classdesc\n * Contrôle de base pour la recherche (barre de recherche, autocomplétion, historique).\n *\n * @alias ol.control.SearchEngineBase\n * @module SearchEngine\n */\nclass SearchEngineBase extends Control {\n\n    /**\n     * Constructeur du contrôle SearchEngineBase.\n     * @constructor\n     * @param {SearchEngineBaseOptions} options Options du constructeur\n     * @fires autocomplete\n     * @fires search\n     * @fires select\n     * @example\n     * const search = new ol.control.SearchEngineBase({\n     *   placeholder: \"Rechercher une adresse...\",\n     *   minChars: 3,\n     *   maximumEntries: 10,\n     *   historic: \"mesRecherches\",\n     *   searchService: new CustomSearchService()\n     * });\n     * map.addControl(search)\n     */\n    constructor (options) {\n        options = options || {};\n        // call ol.control.Control constructor\n        super(options);\n\n        /**\n         * Nom de la classe (heritage)\n         * @private\n         */\n        this.CLASSNAME = \"SearchEngineBase\";\n\n        // initialisation du composant\n        this.initialize(options);\n\n        this.searchService = options.searchService;\n        // Permet l'autocomplétion\n        if (this.searchService.get(\"autocomplete\") !== false) {\n            this.searchService.on(\"autocomplete\", function (e) {\n                this.onAutocomplete(e);\n            }.bind(this));\n        }\n\n        this.searchService.on(\"search\", function (e) {\n            this.onSearch(e);\n        }.bind(this));\n\n        // Widget main DOM container\n        this._initContainer(options);\n\n        this._initEvents(options);\n\n        // Get historic in localStorage\n        this._historic = false;\n        this._historicName = \"GPsearch-\" + options.historic;\n        if (options.historic !== false && this.searchService.get(\"autocomplete\") !== false) {\n            this._historic = [];\n            try {\n                const stor = window.localStorage.getItem(this._historicName);\n                if (stor) {\n                    this._historic = JSON.parse(stor);\n                }\n            } catch (e) {\n                // logger.warn(\"LocalStorage not available\");\n            }\n        }\n        this.showHistoric();\n    }\n    /**\n     * Initialise le contrôle SearchEngineBase (appelé par le constructeur).\n     * @protected\n     * @param {SearchEngineBaseOptions} options Options du constructeur\n     */\n    initialize (options) {\n        // Valeurs par défaut des options\n        options.minChars = options.minChars ? options.minChars : 3;\n        options.maximumEntries = (typeof options.maximumEntries === \"number\") ? options.maximumEntries : 5;\n        options.historic = (typeof options.historic === \"string\" ? options.historic : this.CLASSNAME);\n        options.title = options.title ? options.title : \"Rechercher\";\n        options.ariaLabel = options.ariaLabel ? options.ariaLabel : \"Rechercher\";\n        options.placeholder = options.placeholder ? options.placeholder : \"\";\n        options.searchService = options.searchService ? options.searchService : new DefaultSearchService();\n        options.label = options.label ? options.label : \"\";\n        options.hint = options.hint ? options.hint : \"\";\n        options.search = options.search === true ? true : false;\n        options.searchButton = options.searchButton === true ? true : false;\n        options.collapsible = options.collapsible === true ? true : false;\n\n        this.set(\"maximumEntries\", options.maximumEntries);\n    }\n\n    /**\n     * Ajoute les écouteurs d'événements sur les éléments du contrôle.\n     * @protected\n     * @param {SearchEngineBaseOptions} options Options du constructeur\n     */\n    _initEvents (options) {\n        if (this.searchService.get(\"autocomplete\") !== false) {\n            // Empty input\n            this.input.addEventListener(\"input\", function (e) {\n                if (e.target.value.length > 0) {\n                    e.target.dataset.erase = true;\n                } else {\n                    delete e.target.dataset.erase;\n                }\n                console.log(\"input\", e, e.target.value);\n                if (!e.target.value) {\n                    this.showHistoric();\n                }\n            }.bind(this));\n            // Prevent cursor to go to the end of input on keydown\n            this.input.addEventListener(\"keydown\", function (e) {\n                if (/ArrowDown|ArrowUp/.test(e.key)) {\n                    e.preventDefault();\n                }\n            }.bind(this));\n            // Keyboard navigation\n            this.input.addEventListener(\"keyup\", function (e) {\n                // autocomplete list\n                const list = Array.from(this.autocompleteList.querySelectorAll(\"li\"));\n                let idx = list.findIndex(li => li.classList.contains(\"active\"));\n                if (idx === -1) {\n                    // Ancienne valeur\n                    this._previousValue = e.target.value;\n                }\n                switch (e.key) {\n                    case \"ArrowDown\":\n                    case \"ArrowUp\":\n                        e.preventDefault();\n                        // Navigation in autocomplete list\n                        if (list.length === 0) {\n                            return;\n                        }\n                        list.forEach(li => li.classList.remove(\"active\"));\n                        if (e.key === \"ArrowDown\") {\n                            idx++;\n                            if (idx >= list.length) {\n                                idx = -1;\n                            }\n                        } else if (e.key === \"ArrowUp\") {\n                            idx--;\n                            if (idx < -1) {\n                                idx = list.length - 1;\n                            }\n                        }\n                        if (idx !== -1) {\n                            // Set active\n                            const current = list[idx];\n                            current.classList.add(\"active\");\n                            this.input.value = current.innerText;\n                            this.input.setAttribute(\"aria-activedescendant\", current.id);\n                            this.input.setAttribute(\"data-active-option\", current.id);\n                        } else {\n                            // Réaffiche la valeur précédente de l'utilisateur\n                            e.target.value = this._previousValue;\n                        }\n                        // Envoie un événement de type input pour notifier le changement\n                        this.input.dispatchEvent(new Event(\"input\"));\n\n                        break;\n                    default:\n                        if (e.target.value.length && e.target.value.length >= options.minChars && e.target.value !== this._currentValue) {\n                            this.autocomplete(e.target.value);\n                        }\n                        break;\n                }\n                this._currentValue = e.target.value;\n            }.bind(this), false);\n        }\n\n        // Événement d'envoi du formulaire\n        this.container.addEventListener(\"submit\", function (e) {\n            e.preventDefault();\n            const list = Array.from(this.autocompleteList.querySelectorAll(\"li\"));\n\n            if (e && e.submitter && e.submitter.type === \"submit\") {\n                // Si on appuie sur le bouton, on vérifie que l'input ne soit pas vide\n                let input = e.target.querySelector(\"input\");\n                const value = input.value;\n                if (value.length < options.minChars) {\n                    return false;\n                }\n            }\n            let idx = list.findIndex(li => li.classList.contains(\"active\"));\n            let item = list[idx];\n            if (idx < 0) {\n                // Pas d'item sélectionné : on prend le premier de la liste\n                item = list[0];\n            }\n            if (item) {\n                item.click();\n            }\n        }.bind(this));\n    }\n    /**\n     * Initialise le conteneur DOM principal du contrôle.\n     * @private\n     * @param {SearchEngineBaseOptions} options Options du constructeur\n     * @returns {void}\n     */\n    _initContainer (options) {\n        const element = this.element = document.createElement(\"div\");\n        element.className = \"GPwidget gpf-widget\";\n        element.id = Helper.getUid(\"GPsearchEngine-\");\n        // Main container\n        const container = this.container = document.createElement(\"form\");\n        // container.className = options.search ? \"GPSearchBar fr-search-bar\" : \"\";\n        container.className = options.search ? \"GPSearchBar\" : \"\";\n        // container.className = \"fr-search-bar\";\n        container.id = Helper.getUid(\"GPsearchInput-Base-\");\n\n        // Création du bouton\n        if (!options.target && options.collapsible) {\n            this.button = document.createElement(\"button\");\n            this.button.id = Helper.getUid(\"GPshowSearchEnginePicto-\");\n            this.button.className = \"GPshowOpen GPshowAdvancedToolPicto GPshowSearchEnginePicto gpf-btn fr-icon-search-line fr-btn fr-btn--lg\";\n            this.button.setAttribute(\"aria-pressed\", \"true\");\n            // this.button.setAttribute(\"type\", \"submit\");\n            // this.button.setAttribute(\"form\", container.id);\n            if (options.title) {\n                this.button.setAttribute(\"title\", options.title);\n            }\n            if (options.collapsible) {\n                this.button.addEventListener(\"click\", function () {\n                    element.classList.toggle(\"ol-collapsed\");\n                    const pressed = this.button.getAttribute(\"aria-pressed\") === \"true\";\n                    this.button.setAttribute(\"aria-pressed\", !pressed);\n                    if (!pressed) {\n                        input.focus();\n                    } else {\n                        input.blur();\n                    }\n                }.bind(this));\n            }\n            element.appendChild(this.button);\n        }\n\n        element.appendChild(container);\n\n        const search = document.createElement(\"div\");\n        // search.className = \"GPInputGroup fr-input\";\n        search.className = \"GPInputGroup\";\n        search.classList.add(options.search ? \"fr-input\" : \"fr-input-group\");\n        container.appendChild(search);\n\n        // Input\n        const input = this.input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.className = \"GPsearchInputText fr-input\";\n        input.id = Helper.getUid(\"GPsearchInputText-\");\n        input.placeholder = options.placeholder;\n        input.autocomplete = \"off\";\n        input.setAttribute(\"aria-label\", options.ariaLabel);\n\n        if (options.label) {\n            const label = document.createElement(\"label\");\n            label.className = \"GPLabel fr-label\";\n            label.textContent = options.label;\n            label.htmlFor = input.id;\n            if (options.hint) {\n                const hint = document.createElement(\"span\");\n                hint.className = \"GPLabelHint fr-hint-text\";\n                hint.textContent = options.hint;\n                label.appendChild(hint);\n            }\n            search.appendChild(label);\n        }\n        search.appendChild(input);\n\n        const messages = document.createElement(\"div\");\n        messages.className = \"GPMessagesGroup fr-messages-group\";\n        messages.ariaLive = \"polite\";\n        messages.id = Helper.getUid(\"GPMessagesGroup-\");\n        input.setAttribute(\"aria-describedby\", messages.id);\n        search.appendChild(messages);\n\n        // Options container\n        this.optionscontainer = document.createElement(\"div\");\n        this.optionscontainer.className = \"GPOptionsContainer\";\n        search.appendChild(this.optionscontainer);\n\n        // Submit button\n        if (options.searchButton) {\n            const submit = this.subimtBt = document.createElement(\"button\");\n            submit.className = \"GPsearchInputSubmit gpf-btn fr-icon-search-line fr-btn\";\n            submit.id = Helper.getUid(\"GPshowSearchEnginePicto-\");\n            submit.type = \"submit\";\n            if (options.title) {\n                submit.setAttribute(\"title\", options.title);\n            }\n            container.appendChild(submit);\n        }\n\n        // Autocomplete container\n        const acContainer = this.acContainer = document.createElement(\"div\");\n        acContainer.id = Helper.getUid(\"GPautoCompleteContainer-\");\n        acContainer.className = \"GPautoCompleteContainer GPelementHidden gpf-hidden\";\n        element.appendChild(acContainer);\n        // element.appendChild(acContainer);\n\n        // Autocomplete list\n        const autocompleteHeader = this.autocompleteHeader = document.createElement(\"div\");\n        autocompleteHeader.className = \"GPautoCompleteHeader\";\n        acContainer.appendChild(autocompleteHeader);\n\n        const autocompleteList = this.autocompleteList = document.createElement(\"ul\");\n        autocompleteList.className = \"GPautoCompleteList\";\n        autocompleteList.id = Helper.getUid(\"GPautoCompleteList-\");\n        autocompleteList.setAttribute(\"role\", \"listbox\");\n        autocompleteList.setAttribute(\"tabindex\", \"-1\");\n        autocompleteList.setAttribute(\"aria-label\", \"Propositions\");\n        acContainer.appendChild(autocompleteList);\n\n        const autocompleteFooter = this.autocompleteFooter = document.createElement(\"div\");\n        autocompleteFooter.className = \"GPautoCompleteFooter\";\n        acContainer.appendChild(autocompleteFooter);\n\n        // Input controller for accessibility\n        input.setAttribute(\"role\", \"combobox\");\n        input.setAttribute(\"aria-controls\", acContainer.id);\n        input.setAttribute(\"aria-expanded\", \"false\");\n        input.setAttribute(\"aria-autocomplete\", \"list\");\n        input.setAttribute(\"aria-haspopup\", \"listbox\");\n\n        if (this.searchService.get(\"autocomplete\") !== false) {\n            input.addEventListener(\"focus\", () => {\n                input.setAttribute(\"aria-expanded\", \"true\");\n                acContainer.classList.add(\"gpf-visible\");\n                acContainer.classList.remove(\"gpf-hidden\");\n                acContainer.classList.add(\"GPelementVisible\");\n                acContainer.classList.remove(\"GPelementHidden\");\n            });\n\n            // Gère le focus pour la sélection d'éléments dans la liste\n            input.addEventListener(\"blur\", (e) => {\n                // N'agit que si le focus est hors de l'élément\n                if (e.relatedTarget && acContainer.contains(e.relatedTarget)) {\n                    // N'empêche pas le focus sur un bouton\n                    if (!(e.relatedTarget.tagName === \"BUTTON\")) {\n                        input.focus();\n                    } else {\n                        // Ajout d'un event listener pour retourner sur l'input en cas de besoin\n                        e.relatedTarget.addEventListener(\"blur\", (/** @type {FocusEvent}*/ e) => {\n                            if (e.relatedTarget && acContainer.contains(e.relatedTarget) || e.relatedTarget === input) {\n                                input.focus();\n                            } else {\n                                // On doit aller sur le bouton recherche avancée\n                                if (input.value.length === 0) {\n                                    delete input.dataset.erase;\n                                    e.relatedTarget.parentNode.querySelector(\"button\")?.focus();\n                                }\n                                setTimeout(() => {\n                                    input.setAttribute(\"aria-expanded\", \"false\");\n                                    acContainer.classList.remove(\"gpf-visible\");\n                                    acContainer.classList.add(\"gpf-hidden\");\n                                    acContainer.classList.remove(\"GPelementVisible\");\n                                    acContainer.classList.add(\"GPelementHidden\");\n                                }, 50);\n                            }\n                        }, { once : true });\n                    }\n                } else {\n                    input.value.length === 0 && delete input.dataset.erase;\n                    setTimeout(() => {\n                        input.setAttribute(\"aria-expanded\", \"false\");\n                        acContainer.classList.remove(\"gpf-visible\");\n                        acContainer.classList.add(\"gpf-hidden\");\n                        acContainer.classList.remove(\"GPelementVisible\");\n                        acContainer.classList.add(\"GPelementHidden\");\n                    }, 50);\n                }\n            });\n        }\n    }\n\n    /**\n     * Active ou désactive le contrôle (désactive l'input / bouton).\n     * @param {Boolean} active Indique si le contrôle doit être désactivé\n     * @returns {void}\n     */\n    setActive (active) {\n        this.input.disabled = !!active;\n        this.subimtBt.disabled = !!active;\n    }\n\n    /**\n     * Lance l'autocomplétion et met à jour la liste.\n     * @param {String} [value] Valeur de l'input\n     * @api\n     */\n    autocomplete (value) {\n        clearTimeout(this._completeDelay);\n        this._completeDelay = setTimeout(function () {\n            this.searchService.autocomplete(value);\n        }.bind(this), this.get(\"triggerDelay\") || 100);\n    }\n\n    /**\n     * Callback sur événement d'autocomplétion.\n     * @param {Object} e Événement d'autocomplétion\n     * @private\n     */\n    onAutocomplete (e) {\n        clearTimeout(this._completeDelay);\n        // Update list}\n        this._updateList(e.result);\n        this.dispatchEvent(e);\n    }\n\n    /**\n     * Lance la recherche de géocodage.\n     * @param {IGNSearchObject} item Valeur ou objet à rechercher\n     * @api\n     */\n    search (item) {\n        clearTimeout(this._completeDelay);\n        this._completeDelay = setTimeout(function () {\n            this.searchService.search(item);\n        }.bind(this), this.get(\"triggerDelay\") || 100);\n    }\n\n    /**\n     * Callback sur événement de recherche.\n     * @param {Object} e Événement de recherche\n     * @api\n     */\n    onSearch (e) {\n        clearTimeout(this._completeDelay);\n        // Update list}\n        this.dispatchEvent(e);\n    }\n\n    /**\n     * Callback sur sélection d'un item.\n     * @param {Object} item Élément sélectionné\n     * @api\n     */\n    select (item) {\n        clearTimeout(this._completeDelay);\n        const title = this.getItemTitle(item);\n        this.input.value = title;\n        this.input.dispatchEvent(new Event(\"input\"));\n        this._currentValue = title;\n        this._updateHistoric(item);\n        this._updateList();\n        this.dispatchEvent({\n            type : \"select\",\n            title : this.getItemTitle(item),\n            item : item\n        });\n    }\n\n    /**\n     * Affiche la liste de l'historique.\n     * @api\n     */\n    showHistoric () {\n        clearTimeout(this._completeDelay);\n        if (this._historic) {\n            this._updateList(this._historic.length ? this._historic : [], \"history\");\n        }\n    }\n\n    /**\n     * Met à jour la liste d'autocomplétion.\n     * @private\n     * @param {Array<Object>} tab Liste des items d'autocomplétion\n     * @param {String} [type=\"search\"] Type d'affichage (\"history\" ou \"search\")\n     */\n    _updateList (tab, type = \"search\") {\n        this.autocompleteList.parentNode.dataset.type = type;\n        //\n        tab = (tab || []).slice(0, this.get(\"maximumEntries\"));\n        // Accessibility\n        this.autocompleteList.querySelectorAll(\"li\").forEach(li => li.classList.remove(\"active\"));\n        this.input.setAttribute(\"aria-activedescendant\", \"\");\n        this.input.setAttribute(\"data-active-option\", \"\");\n        // Update list\n        this.autocompleteList.innerHTML = \"\";\n        tab.forEach((item, idx) => {\n            const li = document.createElement(\"li\");\n            const iconClass = this.getIconClass(item, type);\n\n            li.id = Helper.getUid(\"GPsearchResult-\");\n            li.className = `GPsearchResult gpf-panel__item gpf-panel__item-searchengine ${iconClass} fr-icon--sm`;\n            li.setAttribute(\"role\", \"option\");\n            li.setAttribute(\"data-idx\", idx);\n            li.innerHTML = li.title = this.getItemTitle(item);\n            if (type === \"history\") {\n                li.classList.add(\"GPsearchHistoric\");\n                const span = document.createElement(\"span\");\n                span.ariaHidden = \"true\";\n                span.className = `${history} fr-icon--sm`;\n                li.append(span);\n            }\n            this.autocompleteList.appendChild(li);\n            li.addEventListener(\"click\", function (/** @type {PointerEvent} */ e) {\n                const idx = Number(e.target.getAttribute(\"data-idx\"));\n                // Sélectionne l'item\n                this.select(tab[idx]);\n                // Lance la recherche pour cet item\n                this.search({\n                    location : tab[idx]\n                });\n            }.bind(this));\n        });\n    }\n\n    /**\n     * Retourne la classe à ajouter pour un résultat d'autocomplétion\n     * @param {AutocompleteResult} item Résultat de l'autocomplétion (ou historique)\n     * @param {String} type Type de la recherche (\"history\" ou \"search\")\n     * @returns {String} classe à ajouter\n     */\n    getIconClass (item, type) {\n        // let iconClass = typeClasses[type];\n        let iconClass = typeClasses[item.type];\n        // Cas où l'on a d'autres éléments\n        if (typeof iconClass === \"object\") {\n            // Cherche les types de POI\n            for (let i = 0; i < item.poiType.length; i++) {\n                const poiType = item.poiType[i];\n                if (Object.hasOwn(iconClass, poiType)) {\n                    iconClass = iconClass[poiType];\n                    break;\n                }\n            }\n            \n            // TODO : améliorer la fonction (faire récursif ?)\n            if (typeof iconClass === \"object\") {\n                // Cherche les types de POI\n                for (let i = 0; i < item.poiType.length; i++) {\n                    const poiType = item.poiType[i];\n                    if (Object.hasOwn(iconClass, poiType)) {\n                        iconClass = iconClass[poiType];\n                        break;\n                    }\n                }\n            }\n            iconClass = typeof iconClass === \"object\" ? defaultIcon : iconClass;\n        }\n        return iconClass;\n    }\n\n    /**\n     * Retourne le titre à afficher pour un item.\n     * @param {Object} item Élément à afficher\n     * @returns {String} Titre\n     * @api\n     */\n    getItemTitle (item) {\n        return this.searchService.getItemTitle(item);\n    }\n\n    /**\n     * Ajoute ou remplace une valeur dans l'historique.\n     * @private\n     * @param {Object} value Valeur à ajouter\n     */\n    _updateHistoric (value) {\n        if (this._historic) {\n            let index = -1;\n            for (let i = 0; i < this._historic.length; i++) {\n                const elem = this._historic[i];\n                if (this._isEqual(elem, value)) {\n                    // L'élément est déjà dans l'historique\n                    index = i;\n                    break;\n                }\n            }\n            if (index !== -1) {\n                // Enlève de l'historique pour le remettre en première position;\n                this._historic.splice(index, 1);\n            }\n\n            const length = this._historic.unshift(value);\n            // Retire le dernier élément si le nombre maximal est atteint\n            if (length > (this.get(\"maximumEntries\"))) {\n                this._historic.pop();\n            }\n\n            // Enregistre dans le localStorage\n            localStorage.setItem(this._historicName, JSON.stringify(this._historic));\n        }\n    }\n\n    /**\n     * Vérifie si deux éléments (objets) sont égaux.\n     * @private\n     * @param {Object} a Premier objet\n     * @param {Object} b Objet de comparaison\n     * @returns {Boolean} true si égal, false sinon\n     */\n    _isEqual (a, b) {\n        // TODO : Améliorer comparaison ?\n        const jsonA = JSON.stringify(a);\n        const jsonB = JSON.stringify(b);\n\n        return jsonA === jsonB;\n    }\n\n    /**\n     * Ajoute un message à un champ de saisie.\n     * @param {String} message Message à afficher\n     * @param {String} [type=\"error\"] Type du message (\"error\" ou \"valid\")\n     * @api\n     */\n    addMessage (message, type = \"error\") {\n        let messageElement = this.input.ariaDescribedByElements[0];\n        if (messageElement) {\n            const p = document.createElement(\"p\");\n            const messageType = type === \"error\" ? \"error\" : \"valid\";\n            p.className = `GPMessage GPMessage--${messageType} fr-message fr-message--${messageType}`;\n            p.id = Helper.getUid(\"GPMessage-\");\n            p.textContent = message;\n\n            // Enlève la classe du type de message à l'élément parent\n            messageElement.parentElement?.classList.forEach(c => {\n                if (/^fr-.*-group$/.test(c)) {\n                    messageElement.parentElement?.classList.add(`${c}--${messageType}`);\n                }\n            });\n\n            messageElement.replaceChildren(p);\n        }\n    }\n\n    /**\n     * Enlève les messages d'erreur du champ de saisie.\n     * @param {HTMLInputElement|HTMLSelectElement} input Champ de saisie\n     * @api\n     */\n    removeMessages () {\n        let messageElement = this.input.ariaDescribedByElements[0];\n        if (messageElement) {\n            messageElement.replaceChildren();\n\n            // Enlève la classe du type de message à l'élément parent\n            messageElement.parentElement?.classList.forEach(c => {\n                if (/^fr-.*-group--/.test(c)) {\n                    messageElement.parentElement?.classList.remove(c);\n                }\n            });\n        }\n    }\n\n}\n\nexport default SearchEngineBase;\n\n// Expose SearchEngine as ol.control.SearchEngine (for a build bundle)\nif (window.ol && window.ol.control) {\n    window.ol.control.SearchEngineBase = SearchEngineBase;\n}\n"],"names":["Logger","getLogger","AbstractSearchService","_BaseObject","options","_this","_classCallCheck","_callSuper","constructor","TypeError","CLASSNAME","initialize","_possibleConstructorReturn","_inherits","key","value","this","AUTOCOMPLETE_EVENT","SEARCH_EVENT","ERROR_EVENT","_autocompleteLocations","_locations","autocomplete","set","index","limit","returnTrueGeometry","undefined","text","obj","BaseObject","window","ol","service","_Control","ControlExtended","element","target","render","listable","description","_createClass","pos","getMap","PositionFactory","update","Control","ANCHORS","_PositionFactory_brand","WeakSet","caller","_classPrivateMethodInitSpec","container","_assertClassBrand","_createContainer","call","includes","toLowerCase","_setAnchor","children","prepend","appendChild","_existContainer","name","getOverlayContainerStopEvent","div","document","createElement","id","className","self","position","length","sizeW","offsetWidth","sizeH","height","offsetHeight","clear","style","top","bottom","left","right","panels","Array","from","getElementsByClassName","offset","forEach","panel","nodeName","checkDsfr","uidCounter_","detectSupport","isDesktop","userAgent","navigator","indexOf","assign","dest","source","prop","hasOwnProperty","mergeParams","replace","param","_typeof","getUid","prefix","getComputedStyle","documentElement","getPropertyValue","noop","undefinedType","isIE","test","logMethods","_loggersByName","defaultLogger","bindMethod","methodName","method","bind","Function","prototype","e","apply","arguments","traceForIE","console","log","trace","realMethod","replaceLoggingMethods","level","getLevel","i","methodFactory","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","factory","inheritedLevel","defaultLevel","userLevel","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","location","exec","slice","clearPersistedLevel","removeItem","normalizeLevel","input","setLevel","persist","setDefaultLevel","resetLevel","enableAll","TRACE","disableAll","rebuild","childName","initialLevel","logger","_log","noConflict","getLoggers","LoggerByDefault","process","VERBOSE","env","Log","logname","loggers","Object","Gp","module","exports","control","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","DefaultSearchService","_AbstractSearchServic","searchTab","_searchTab","_this2","rex","RegExp","city","push","dispatchEvent","type","result","typeClasses","SearchEngineBase","searchService","on","onAutocomplete","onSearch","_initContainer","_initEvents","_historic","_historicName","historic","stor","getItem","JSON","parse","showHistoric","minChars","maximumEntries","title","ariaLabel","placeholder","label","hint","search","searchButton","collapsible","addEventListener","dataset","erase","preventDefault","list","autocompleteList","querySelectorAll","idx","findIndex","li","classList","contains","_previousValue","remove","current","add","innerText","setAttribute","Event","_currentValue","submitter","querySelector","item","click","Helper","button","toggle","pressed","getAttribute","blur","focus","textContent","htmlFor","messages","ariaLive","optionscontainer","submit","subimtBt","acContainer","autocompleteHeader","autocompleteFooter","relatedTarget","tagName","_e$relatedTarget$pare","parentNode","setTimeout","once","active","disabled","clearTimeout","_completeDelay","_updateList","getItemTitle","_updateHistoric","tab","innerHTML","iconClass","getIconClass","concat","span","ariaHidden","append","Number","select","poiType","hasOwn","elem","_isEqual","splice","unshift","pop","setItem","stringify","b","message","messageElement","ariaDescribedByElements","_messageElement$paren","p","messageType","parentElement","c","_messageElement$paren2","replaceChildren","_messageElement$paren3","_messageElement$paren4"],"ignoreList":[],"sourceRoot":""}