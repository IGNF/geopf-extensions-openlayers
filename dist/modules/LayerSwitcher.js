(()=>{var e={562:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var o=n(7392);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function a(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,d(o.key),o)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function u(e,t,n){return t=f(t),function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],f(e).constructor):t.apply(e,n))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}const v=function(e){function t(e){return l(this,t),u(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),c(t,[{key:"setPosition",value:function(e){new m(this).set(e)}}])}(n.n(o)());var g=["top-left","top-right","bottom-left","bottom-right"],y=new WeakSet,m=function(){return c((function e(t){return l(this,e),i(this,y),this.caller=t,a(y,this,_).call(this,"top-left"),a(y,this,_).call(this,"top-right"),a(y,this,_).call(this,"bottom-left"),a(y,this,_).call(this,"bottom-right"),this}),[{key:"set",value:function(e){g.includes(e.toLowerCase())&&(a(y,this,I).call(this,e),document.getElementById("position-container-"+e).appendChild(this.caller.element))}}])}();function b(e){return!!document.getElementById("position-container-"+e)}function _(e){if(!a(y,this,b).call(this,e)){var t=document.createElement("div");t.id="position-container-"+e,t.className="position-container-"+e,this.caller.getMap().getOverlayContainerStopEvent().appendChild(t)}}function I(e){var t=function(e){return document.getElementById("position-container-"+e).offsetWidth},n=function(e){e.style.top="unset",e.style.bottom="unset",e.style.left="unset",e.style.right="unset"};n(this.caller.element),this.caller.element.style.position="unset";var o=Array.from(this.caller.element.getElementsByClassName("GPpanel"));if(0!==o.length){o.forEach((function(e){n(e)}));var r=o[0];switch(e.toLowerCase()){case"top-left":r.style.top="0px",r.style.left=t(e)+"px";break;case"bottom-left":r.style.bottom="0px",r.style.left=t(e)+"px";break;case"top-right":r.style.top="0px",r.style.right=t(e)+"px";break;case"bottom-right":r.style.bottom="0px",r.style.right=t(e)+"px"}}}},5844:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var o=n(3065);const r={getLogger:function(e){if(void 0===t)var t={env:{VERBOSE:!1}};t.env.VERBOSE?o.enableAll():o.disableAll();var n=e||"default";return o.getLogger(n)},disableAll:function(){var e=o.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=o.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}}},6736:(e,t,n)=>{"use strict";var o;n.d(t,{A:()=>r});const r={generate:(o=Math.floor(Date.now()),function(){return o++}),name:function(e){var t=null,n=e.lastIndexOf("-");return t=-1===n?e:e.substring(0,n),t},index:function(e){var t=null,n=this.name(e),o=n.lastIndexOf("_");return-1!==o&&(t=n.substring(o+1)),t},uuid:function(e){var t=null,n=e.lastIndexOf("-");return-1!==n&&(t=parseInt(e.substring(n+1),10)),t}}},3065:function(e,t,n){var o,r;!function(i,a){"use strict";o=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],r={},i=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(o){return"debug"===o&&(o="log"),typeof console!==t&&("trace"===o&&n?l:void 0!==console[o]?a(console,o):void 0!==console.log?a(console,"log"):e)}function c(){for(var n=this.getLevel(),r=0;r<o.length;r++){var i=o[r];this[i]=r<n?e:this.methodFactory(i,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function d(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(e,t,n){return s(e)||d.apply(this,arguments)}function h(e,n){var a,l,s,d=this,h="loglevel";function f(e){var n=(o[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(e){}}}function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,o=encodeURIComponent(h),r=n.indexOf(o+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+o.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function v(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function g(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=s?s:null!=l?l:a},d.setLevel=function(e,t){return s=g(e),!1!==t&&f(s),c.call(d)},d.setDefaultLevel=function(e){l=g(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){s=null,v(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(i!==d&&(a=g(i.getLevel())),c.call(d),i===d)for(var e in r)r[e].rebuild()},a=g(i?i.getLevel():"WARN");var y=p();null!=y&&(s=g(y)),c.call(d)}(i=new h).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new h(e,i.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=f),i},i.getLoggers=function(){return r},i.default=i,i},void 0===(r="function"==typeof o?o.call(t,n,t,e):o)||(e.exports=r)}()},1363:e=>{"use strict";e.exports=ol.Observable},7392:e=>{"use strict";e.exports=ol.control.Control},2938:e=>{"use strict";e.exports=ol.extent}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};(()=>{"use strict";n.d(o,{default:()=>Dt});var e=n(562),t=n(1363),r=n(2938),i=n(6736),a=n(5844);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u.apply(this,arguments)}function h(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var p=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),v=f(/Edge/i),g=f(/firefox/i),y=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),m=f(/iP(ad|od|hone)/i),b=f(/chrome/i)&&f(/android/i),_={capture:!1,passive:!1};function I(e,t,n){e.addEventListener(t,n,!p&&_)}function E(e,t,n){e.removeEventListener(t,n,!p&&_)}function w(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function D(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function P(e,t,n,o){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&w(e,t):w(e,t))||o&&e===n)return e;if(e===n)break}while(e=D(e))}return null}var L,C=/\s+/g;function O(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(C," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(C," ")}}function S(e,t,n){var o=e&&e.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=n+("string"==typeof n?"":"px")}}function x(e,t){var n="";if("string"==typeof e)n=e;else do{var o=S(e,"transform");o&&"none"!==o&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function T(e,t,n){if(e){var o=e.getElementsByTagName(t),r=0,i=o.length;if(n)for(;r<i;r++)n(o[r],r);return o}return[]}function k(){var e=document.scrollingElement;return e||document.documentElement}function N(e,t,n,o,r){if(e.getBoundingClientRect||e===window){var i,a,l,s,c,d,u;if(e!==window&&e.parentNode&&e!==k()?(a=(i=e.getBoundingClientRect()).top,l=i.left,s=i.bottom,c=i.right,d=i.height,u=i.width):(a=0,l=0,s=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(r=r||e.parentNode,!p))do{if(r&&r.getBoundingClientRect&&("none"!==S(r,"transform")||n&&"static"!==S(r,"position"))){var h=r.getBoundingClientRect();a-=h.top+parseInt(S(r,"border-top-width")),l-=h.left+parseInt(S(r,"border-left-width")),s=a+i.height,c=l+i.width;break}}while(r=r.parentNode);if(o&&e!==window){var f=x(r||e),v=f&&f.a,g=f&&f.d;f&&(s=(a/=g)+(d/=g),c=(l/=v)+(u/=v))}return{top:a,left:l,bottom:s,right:c,width:u,height:d}}}function A(e,t,n){for(var o=U(e,!0),r=N(e)[t];o;){var i=N(o)[n];if(!("top"===n||"left"===n?r>=i:r<=i))return o;if(o===k())break;o=U(o,!1)}return!1}function G(e,t,n,o){for(var r=0,i=0,a=e.children;i<a.length;){if("none"!==a[i].style.display&&a[i]!==Ze.ghost&&(o||a[i]!==Ze.dragged)&&P(a[i],n.draggable,e,!1)){if(r===t)return a[i];r++}i++}return null}function M(e,t){for(var n=e.lastElementChild;n&&(n===Ze.ghost||"none"===S(n,"display")||t&&!w(n,t));)n=n.previousElementSibling;return n||null}function R(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ze.clone||t&&!w(e,t)||n++;return n}function B(e){var t=0,n=0,o=k();if(e)do{var r=x(e),i=r.a,a=r.d;t+=e.scrollLeft*i,n+=e.scrollTop*a}while(e!==o&&(e=e.parentNode));return[t,n]}function U(e,t){if(!e||!e.getBoundingClientRect)return k();var n=e,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=S(n);if(n.clientWidth<n.scrollWidth&&("auto"==r.overflowX||"scroll"==r.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==r.overflowY||"scroll"==r.overflowY)){if(!n.getBoundingClientRect||n===document.body)return k();if(o||t)return n;o=!0}}}while(n=n.parentNode);return k()}function j(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function Y(e,t){return function(){if(!L){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),L=setTimeout((function(){L=void 0}),t)}}}function F(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function X(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function Z(e,t,n){var o={};return Array.from(e.children).forEach((function(r){var i,a,l,s;if(P(r,t.draggable,e,!1)&&!r.animated&&r!==n){var c=N(r);o.left=Math.min(null!==(i=o.left)&&void 0!==i?i:1/0,c.left),o.top=Math.min(null!==(a=o.top)&&void 0!==a?a:1/0,c.top),o.right=Math.max(null!==(l=o.right)&&void 0!==l?l:-1/0,c.right),o.bottom=Math.max(null!==(s=o.bottom)&&void 0!==s?s:-1/0,c.bottom)}})),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var V="Sortable"+(new Date).getTime();function H(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==S(e,"display")&&e!==Ze.ghost){t.push({target:e,rect:N(e)});var n=s({},t[t.length-1].rect);if(e.thisAnimationDuration){var o=x(e,!0);o&&(n.top-=o.f,n.left-=o.e)}e.fromRect=n}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var o=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var r=!1,i=0;t.forEach((function(e){var t=0,n=e.target,a=n.fromRect,l=N(n),s=n.prevFromRect,c=n.prevToRect,d=e.rect,u=x(n,!0);u&&(l.top-=u.f,l.left-=u.e),n.toRect=l,n.thisAnimationDuration&&j(s,l)&&!j(a,l)&&(d.top-l.top)/(d.left-l.left)==(a.top-l.top)/(a.left-l.left)&&(t=function(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}(d,s,c,o.options)),j(l,a)||(n.prevFromRect=a,n.prevToRect=l,t||(t=o.options.animation),o.animate(n,d,l,t)),t&&(r=!0,i=Math.max(i,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),r?e=setTimeout((function(){"function"==typeof n&&n()}),i):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,o){if(o){S(e,"transition",""),S(e,"transform","");var r=x(this.el),i=r&&r.a,a=r&&r.d,l=(t.left-n.left)/(i||1),s=(t.top-n.top)/(a||1);e.animatingX=!!l,e.animatingY=!!s,S(e,"transform","translate3d("+l+"px,"+s+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),S(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),S(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){S(e,"transition",""),S(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),o)}}}}var W=[],z={initializeByDefault:!0},q={mount:function(e){for(var t in z)z.hasOwnProperty(t)&&!(t in e)&&(e[t]=z[t]);W.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),W.push(e)},pluginEvent:function(e,t,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var r=e+"Global";W.forEach((function(o){t[o.pluginName]&&(t[o.pluginName][r]&&t[o.pluginName][r](s({sortable:t},n)),t.options[o.pluginName]&&t[o.pluginName][e]&&t[o.pluginName][e](s({sortable:t},n)))}))},initializePlugins:function(e,t,n,o){for(var r in W.forEach((function(o){var r=o.pluginName;if(e.options[r]||o.initializeByDefault){var i=new o(e,t,e.options);i.sortable=e,i.options=e.options,e[r]=i,u(n,i.defaults)}})),e.options)if(e.options.hasOwnProperty(r)){var i=this.modifyOption(e,r,e.options[r]);void 0!==i&&(e.options[r]=i)}},getEventProperties:function(e,t){var n={};return W.forEach((function(o){"function"==typeof o.eventProperties&&u(n,o.eventProperties.call(t[o.pluginName],e))})),n},modifyOption:function(e,t,n){var o;return W.forEach((function(r){e[r.pluginName]&&r.optionListeners&&"function"==typeof r.optionListeners[t]&&(o=r.optionListeners[t].call(e[r.pluginName],n))})),o}};function K(e){var t=e.sortable,n=e.rootEl,o=e.name,r=e.targetEl,i=e.cloneEl,a=e.toEl,l=e.fromEl,c=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,h=e.newDraggableIndex,f=e.originalEvent,g=e.putSortable,y=e.extraEventProperties;if(t=t||n&&n[V]){var m,b=t.options,_="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||p||v?(m=document.createEvent("Event")).initEvent(o,!0,!0):m=new CustomEvent(o,{bubbles:!0,cancelable:!0}),m.to=a||n,m.from=l||n,m.item=r||n,m.clone=i,m.oldIndex=c,m.newIndex=d,m.oldDraggableIndex=u,m.newDraggableIndex=h,m.originalEvent=f,m.pullMode=g?g.lastPutMode:void 0;var I=s(s({},y),q.getEventProperties(o,t));for(var E in I)m[E]=I[E];n&&n.dispatchEvent(m),b[_]&&b[_].call(t,m)}}var Q=["evt"],J=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.evt,r=h(n,Q);q.pluginEvent.bind(Ze)(e,t,s({dragEl:ee,parentEl:te,ghostEl:ne,rootEl:oe,nextEl:re,lastDownEl:ie,cloneEl:ae,cloneHidden:le,dragStarted:_e,putSortable:fe,activeSortable:Ze.active,originalEvent:o,oldIndex:se,oldDraggableIndex:de,newIndex:ce,newDraggableIndex:ue,hideGhostForTarget:je,unhideGhostForTarget:Ye,cloneNowHidden:function(){le=!0},cloneNowShown:function(){le=!1},dispatchSortableEvent:function(e){$({sortable:t,name:e,originalEvent:o})}},r))};function $(e){K(s({putSortable:fe,cloneEl:ae,targetEl:ee,rootEl:oe,oldIndex:se,oldDraggableIndex:de,newIndex:ce,newDraggableIndex:ue},e))}var ee,te,ne,oe,re,ie,ae,le,se,ce,de,ue,he,fe,pe,ve,ge,ye,me,be,_e,Ie,Ee,we,De,Pe=!1,Le=!1,Ce=[],Oe=!1,Se=!1,xe=[],Te=!1,ke=[],Ne="undefined"!=typeof document,Ae=m,Ge=v||p?"cssFloat":"float",Me=Ne&&!b&&!m&&"draggable"in document.createElement("div"),Re=function(){if(Ne){if(p)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Be=function(e,t){var n=S(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=G(e,0,t),i=G(e,1,t),a=r&&S(r),l=i&&S(i),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+N(r).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+N(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!i||"both"!==l.clear&&l.clear!==d?"horizontal":"vertical"}return r&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||s>=o&&"none"===n[Ge]||i&&"none"===n[Ge]&&s+c>o)?"vertical":"horizontal"},Ue=function(e){function t(e,n){return function(o,r,i,a){var l=o.options.group.name&&r.options.group.name&&o.options.group.name===r.options.group.name;if(null==e&&(n||l))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(o,r,i,a),n)(o,r,i,a);var s=(n?o:r).options.group.name;return!0===e||"string"==typeof e&&e===s||e.join&&e.indexOf(s)>-1}}var n={},o=e.group;o&&"object"==c(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},je=function(){!Re&&ne&&S(ne,"display","none")},Ye=function(){!Re&&ne&&S(ne,"display","")};Ne&&!b&&document.addEventListener("click",(function(e){if(Le)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Le=!1,!1}),!0);var Fe=function(e){if(ee){e=e.touches?e.touches[0]:e;var t=(r=e.clientX,i=e.clientY,Ce.some((function(e){var t=e[V].options.emptyInsertThreshold;if(t&&!M(e)){var n=N(e),o=r>=n.left-t&&r<=n.right+t,l=i>=n.top-t&&i<=n.bottom+t;return o&&l?a=e:void 0}})),a);if(t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[V]._onDragOver(n)}}var r,i,a},Xe=function(e){ee&&ee.parentNode[V]._isOutsideThisEl(e.target)};function Ze(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=u({},t),e[V]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Be(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ze.supportPointer&&"PointerEvent"in window&&!y,emptyInsertThreshold:5};for(var o in q.initializePlugins(this,e,n),n)!(o in t)&&(t[o]=n[o]);for(var r in Ue(t),this)"_"===r.charAt(0)&&"function"==typeof this[r]&&(this[r]=this[r].bind(this));this.nativeDraggable=!t.forceFallback&&Me,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?I(e,"pointerdown",this._onTapStart):(I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),Ce.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),u(this,H())}function Ve(e,t,n,o,r,i,a,l){var s,c,d=e[V],u=d.options.onMove;return!window.CustomEvent||p||v?(s=document.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=n,s.draggedRect=o,s.related=r||t,s.relatedRect=i||N(t),s.willInsertAfter=l,s.originalEvent=a,e.dispatchEvent(s),u&&(c=u.call(d,s,a)),c}function He(e){e.draggable=!1}function We(){Te=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function qe(e){return setTimeout(e,0)}function Ke(e){return clearTimeout(e)}Ze.prototype={constructor:Ze,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Ie=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,ee):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,o=this.options,r=o.preventOnFilter,i=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(a||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=o.filter;if(function(e){ke.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var o=t[n];o.checked&&ke.push(o)}}(n),!ee&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||o.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!y||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=P(l,o.draggable,n,!1))&&l.animated||ie===l)){if(se=R(l),de=R(l,o.draggable),"function"==typeof c){if(c.call(this,e,l,this))return $({sortable:t,rootEl:s,name:"filter",targetEl:l,toEl:n,fromEl:n}),J("filter",t,{evt:e}),void(r&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(o){if(o=P(s,o.trim(),n,!1))return $({sortable:t,rootEl:o,name:"filter",targetEl:l,fromEl:n,toEl:n}),J("filter",t,{evt:e}),!0}))))return void(r&&e.cancelable&&e.preventDefault());o.handle&&!P(s,o.handle,n,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,n){var o,r=this,i=r.el,a=r.options,l=i.ownerDocument;if(n&&!ee&&n.parentNode===i){var s=N(n);if(oe=i,te=(ee=n).parentNode,re=ee.nextSibling,ie=n,he=a.group,Ze.dragged=ee,pe={target:ee,clientX:(t||e).clientX,clientY:(t||e).clientY},me=pe.clientX-s.left,be=pe.clientY-s.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ee.style["will-change"]="all",o=function(){J("delayEnded",r,{evt:e}),Ze.eventCanceled?r._onDrop():(r._disableDelayedDragEvents(),!g&&r.nativeDraggable&&(ee.draggable=!0),r._triggerDragStart(e,t),$({sortable:r,name:"choose",originalEvent:e}),O(ee,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){T(ee,e.trim(),He)})),I(l,"dragover",Fe),I(l,"mousemove",Fe),I(l,"touchmove",Fe),I(l,"mouseup",r._onDrop),I(l,"touchend",r._onDrop),I(l,"touchcancel",r._onDrop),g&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ee.draggable=!0),J("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(v||p))o();else{if(Ze.eventCanceled)return void this._onDrop();I(l,"mouseup",r._disableDelayedDrag),I(l,"touchend",r._disableDelayedDrag),I(l,"touchcancel",r._disableDelayedDrag),I(l,"mousemove",r._delayedDragTouchMoveHandler),I(l,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&I(l,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(o,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ee&&He(ee),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._disableDelayedDrag),E(e,"touchend",this._disableDelayedDrag),E(e,"touchcancel",this._disableDelayedDrag),E(e,"mousemove",this._delayedDragTouchMoveHandler),E(e,"touchmove",this._delayedDragTouchMoveHandler),E(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?I(document,"pointermove",this._onTouchMove):I(document,t?"touchmove":"mousemove",this._onTouchMove):(I(ee,"dragend",this),I(oe,"dragstart",this._onDragStart));try{document.selection?qe((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(Pe=!1,oe&&ee){J("dragStarted",this,{evt:t}),this.nativeDraggable&&I(document,"dragover",Xe);var n=this.options;!e&&O(ee,n.dragClass,!1),O(ee,n.ghostClass,!0),Ze.active=this,e&&this._appendGhost(),$({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,je();for(var e=document.elementFromPoint(ve.clientX,ve.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ve.clientX,ve.clientY))!==t;)t=e;if(ee.parentNode[V]._isOutsideThisEl(e),t)do{if(t[V]){if(t[V]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Ye()}},_onTouchMove:function(e){if(pe){var t=this.options,n=t.fallbackTolerance,o=t.fallbackOffset,r=e.touches?e.touches[0]:e,i=ne&&x(ne,!0),a=ne&&i&&i.a,l=ne&&i&&i.d,s=Ae&&De&&B(De),c=(r.clientX-pe.clientX+o.x)/(a||1)+(s?s[0]-xe[0]:0)/(a||1),d=(r.clientY-pe.clientY+o.y)/(l||1)+(s?s[1]-xe[1]:0)/(l||1);if(!Ze.active&&!Pe){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ne){i?(i.e+=c-(ge||0),i.f+=d-(ye||0)):i={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");S(ne,"webkitTransform",u),S(ne,"mozTransform",u),S(ne,"msTransform",u),S(ne,"transform",u),ge=c,ye=d,ve=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ne){var e=this.options.fallbackOnBody?document.body:oe,t=N(ee,!0,Ae,!0,e),n=this.options;if(Ae){for(De=e;"static"===S(De,"position")&&"none"===S(De,"transform")&&De!==document;)De=De.parentNode;De!==document.body&&De!==document.documentElement?(De===document&&(De=k()),t.top+=De.scrollTop,t.left+=De.scrollLeft):De=k(),xe=B(De)}O(ne=ee.cloneNode(!0),n.ghostClass,!1),O(ne,n.fallbackClass,!0),O(ne,n.dragClass,!0),S(ne,"transition",""),S(ne,"transform",""),S(ne,"box-sizing","border-box"),S(ne,"margin",0),S(ne,"top",t.top),S(ne,"left",t.left),S(ne,"width",t.width),S(ne,"height",t.height),S(ne,"opacity","0.8"),S(ne,"position",Ae?"absolute":"fixed"),S(ne,"zIndex","100000"),S(ne,"pointerEvents","none"),Ze.ghost=ne,e.appendChild(ne),S(ne,"transform-origin",me/parseInt(ne.style.width)*100+"% "+be/parseInt(ne.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,o=e.dataTransfer,r=n.options;J("dragStart",this,{evt:e}),Ze.eventCanceled?this._onDrop():(J("setupClone",this),Ze.eventCanceled||((ae=X(ee)).removeAttribute("id"),ae.draggable=!1,ae.style["will-change"]="",this._hideClone(),O(ae,this.options.chosenClass,!1),Ze.clone=ae),n.cloneId=qe((function(){J("clone",n),Ze.eventCanceled||(n.options.removeCloneOnHide||oe.insertBefore(ae,ee),n._hideClone(),$({sortable:n,name:"clone"}))})),!t&&O(ee,r.dragClass,!0),t?(Le=!0,n._loopId=setInterval(n._emulateDragOver,50)):(E(document,"mouseup",n._onDrop),E(document,"touchend",n._onDrop),E(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(n,o,ee)),I(document,"drop",n),S(ee,"transform","translateZ(0)")),Pe=!0,n._dragStartId=qe(n._dragStarted.bind(n,t,e)),I(document,"selectstart",n),_e=!0,y&&S(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,o,r,i=this.el,a=e.target,l=this.options,c=l.group,d=Ze.active,u=he===c,h=l.sort,f=fe||d,p=this,v=!1;if(!Te){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),a=P(a,l.draggable,i,!0),B("dragOver"),Ze.eventCanceled)return v;if(ee.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||p._ignoreWhileAnimating===a)return j(!1);if(Le=!1,d&&!l.disabled&&(u?h||(o=te!==oe):fe===this||(this.lastPutMode=he.checkPull(this,d,ee,e))&&c.checkPut(this,d,ee,e))){if(r="vertical"===this._getDirection(e,a),t=N(ee),B("dragOverValid"),Ze.eventCanceled)return v;if(o)return te=oe,U(),this._hideClone(),B("revert"),Ze.eventCanceled||(re?oe.insertBefore(ee,re):oe.appendChild(ee)),j(!0);var g=M(i,l.draggable);if(!g||function(e,t,n){var o=N(M(n.el,n.options.draggable)),r=Z(n.el,n.options,ne),i=10;return t?e.clientX>r.right+i||e.clientY>o.bottom&&e.clientX>o.left:e.clientY>r.bottom+i||e.clientX>o.right&&e.clientY>o.top}(e,r,this)&&!g.animated){if(g===ee)return j(!1);if(g&&i===e.target&&(a=g),a&&(n=N(a)),!1!==Ve(oe,i,ee,t,a,n,e,!!a))return U(),g&&g.nextSibling?i.insertBefore(ee,g.nextSibling):i.appendChild(ee),te=i,Y(),j(!0)}else if(g&&function(e,t,n){var o=N(G(n.el,0,n.options,!0)),r=Z(n.el,n.options,ne),i=10;return t?e.clientX<r.left-i||e.clientY<o.top&&e.clientX<o.right:e.clientY<r.top-i||e.clientY<o.bottom&&e.clientX<o.left}(e,r,this)){var y=G(i,0,l,!0);if(y===ee)return j(!1);if(n=N(a=y),!1!==Ve(oe,i,ee,t,a,n,e,!1))return U(),i.insertBefore(ee,y),te=i,Y(),j(!0)}else if(a.parentNode===i){n=N(a);var m,b,_,I=ee.parentNode!==i,E=!function(e,t,n){var o=n?e.left:e.top,r=n?e.right:e.bottom,i=n?e.width:e.height,a=n?t.left:t.top,l=n?t.right:t.bottom,s=n?t.width:t.height;return o===a||r===l||o+i/2===a+s/2}(ee.animated&&ee.toRect||t,a.animated&&a.toRect||n,r),w=r?"top":"left",D=A(a,"top","top")||A(ee,"top","top"),L=D?D.scrollTop:void 0;if(Ie!==a&&(b=n[w],Oe=!1,Se=!E&&l.invertSwap||I),m=function(e,t,n,o,r,i,a,l){var s=o?e.clientY:e.clientX,c=o?n.height:n.width,d=o?n.top:n.left,u=o?n.bottom:n.right,h=!1;if(!a)if(l&&we<c*r){if(!Oe&&(1===Ee?s>d+c*i/2:s<u-c*i/2)&&(Oe=!0),Oe)h=!0;else if(1===Ee?s<d+we:s>u-we)return-Ee}else if(s>d+c*(1-r)/2&&s<u-c*(1-r)/2)return function(e){return R(ee)<R(e)?1:-1}(t);if((h=h||a)&&(s<d+c*i/2||s>u-c*i/2))return s>d+c/2?1:-1;return 0}(e,a,n,r,E?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Se,Ie===a),0!==m){var C=R(ee);do{C-=m,_=te.children[C]}while(_&&("none"===S(_,"display")||_===ne))}if(0===m||_===a)return j(!1);Ie=a,Ee=m;var x=a.nextElementSibling,T=!1,k=Ve(oe,i,ee,t,a,n,e,T=1===m);if(!1!==k)return 1!==k&&-1!==k||(T=1===k),Te=!0,setTimeout(We,30),U(),T&&!x?i.appendChild(ee):a.parentNode.insertBefore(ee,T?x:a),D&&F(D,0,L-D.scrollTop),te=ee.parentNode,void 0===b||Se||(we=Math.abs(b-N(a)[w])),Y(),j(!0)}if(i.contains(ee))return j(!1)}return!1}function B(l,c){J(l,p,s({evt:e,isOwner:u,axis:r?"vertical":"horizontal",revert:o,dragRect:t,targetRect:n,canSort:h,fromSortable:f,target:a,completed:j,onMove:function(n,o){return Ve(oe,i,ee,t,n,N(n),e,o)},changed:Y},c))}function U(){B("dragOverAnimationCapture"),p.captureAnimationState(),p!==f&&f.captureAnimationState()}function j(t){return B("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(p),p!==f&&(O(ee,fe?fe.options.ghostClass:d.options.ghostClass,!1),O(ee,l.ghostClass,!0)),fe!==p&&p!==Ze.active?fe=p:p===Ze.active&&fe&&(fe=null),f===p&&(p._ignoreWhileAnimating=a),p.animateAll((function(){B("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(a===ee&&!ee.animated||a===i&&!a.animated)&&(Ie=null),l.dragoverBubble||e.rootEl||a===document||(ee.parentNode[V]._isOutsideThisEl(e.target),!t&&Fe(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function Y(){ce=R(ee),ue=R(ee,l.draggable),$({sortable:p,name:"change",toEl:i,newIndex:ce,newDraggableIndex:ue,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){E(document,"mousemove",this._onTouchMove),E(document,"touchmove",this._onTouchMove),E(document,"pointermove",this._onTouchMove),E(document,"dragover",Fe),E(document,"mousemove",Fe),E(document,"touchmove",Fe)},_offUpEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._onDrop),E(e,"touchend",this._onDrop),E(e,"pointerup",this._onDrop),E(e,"touchcancel",this._onDrop),E(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ce=R(ee),ue=R(ee,n.draggable),J("drop",this,{evt:e}),te=ee&&ee.parentNode,ce=R(ee),ue=R(ee,n.draggable),Ze.eventCanceled||(Pe=!1,Se=!1,Oe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ke(this.cloneId),Ke(this._dragStartId),this.nativeDraggable&&(E(document,"drop",this),E(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),y&&S(document.body,"user-select",""),S(ee,"transform",""),e&&(_e&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),ne&&ne.parentNode&&ne.parentNode.removeChild(ne),(oe===te||fe&&"clone"!==fe.lastPutMode)&&ae&&ae.parentNode&&ae.parentNode.removeChild(ae),ee&&(this.nativeDraggable&&E(ee,"dragend",this),He(ee),ee.style["will-change"]="",_e&&!Pe&&O(ee,fe?fe.options.ghostClass:this.options.ghostClass,!1),O(ee,this.options.chosenClass,!1),$({sortable:this,name:"unchoose",toEl:te,newIndex:null,newDraggableIndex:null,originalEvent:e}),oe!==te?(ce>=0&&($({rootEl:te,name:"add",toEl:te,fromEl:oe,originalEvent:e}),$({sortable:this,name:"remove",toEl:te,originalEvent:e}),$({rootEl:te,name:"sort",toEl:te,fromEl:oe,originalEvent:e}),$({sortable:this,name:"sort",toEl:te,originalEvent:e})),fe&&fe.save()):ce!==se&&ce>=0&&($({sortable:this,name:"update",toEl:te,originalEvent:e}),$({sortable:this,name:"sort",toEl:te,originalEvent:e})),Ze.active&&(null!=ce&&-1!==ce||(ce=se,ue=de),$({sortable:this,name:"end",toEl:te,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){J("nulling",this),oe=ee=te=ne=re=ae=ie=le=pe=ve=_e=ce=ue=se=de=Ie=Ee=fe=he=Ze.dragged=Ze.ghost=Ze.clone=Ze.active=null,ke.forEach((function(e){e.checked=!0})),ke.length=ge=ye=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ee&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,o=0,r=n.length,i=this.options;o<r;o++)P(e=n[o],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||ze(e));return t},sort:function(e,t){var n={},o=this.el;this.toArray().forEach((function(e,t){var r=o.children[t];P(r,this.options.draggable,o,!1)&&(n[e]=r)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(o.removeChild(n[e]),o.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return P(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var o=q.modifyOption(this,e,t);n[e]=void 0!==o?o:t,"group"===e&&Ue(n)},destroy:function(){J("destroy",this);var e=this.el;e[V]=null,E(e,"mousedown",this._onTapStart),E(e,"touchstart",this._onTapStart),E(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(E(e,"dragover",this),E(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Ce.splice(Ce.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!le){if(J("hideClone",this),Ze.eventCanceled)return;S(ae,"display","none"),this.options.removeCloneOnHide&&ae.parentNode&&ae.parentNode.removeChild(ae),le=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(le){if(J("showClone",this),Ze.eventCanceled)return;ee.parentNode!=oe||this.options.group.revertClone?re?oe.insertBefore(ae,re):oe.appendChild(ae):oe.insertBefore(ae,ee),this.options.group.revertClone&&this.animate(ee,ae),S(ae,"display",""),le=!1}}else this._hideClone()}},Ne&&I(document,"touchmove",(function(e){(Ze.active||Pe)&&e.cancelable&&e.preventDefault()})),Ze.utils={on:I,off:E,css:S,find:T,is:function(e,t){return!!P(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:Y,closest:P,toggleClass:O,clone:X,index:R,nextTick:qe,cancelNextTick:Ke,detectDirection:Be,getChild:G},Ze.get=function(e){return e[V]},Ze.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ze.utils=s(s({},Ze.utils),e.utils)),q.mount(e)}))},Ze.create=function(e,t){return new Ze(e,t)},Ze.version="1.15.2";var Qe,Je,$e,et,tt,nt,ot=[],rt=!1;function it(){ot.forEach((function(e){clearInterval(e.pid)})),ot=[]}function at(){clearInterval(nt)}var lt=Y((function(e,t,n,o){if(t.scroll){var r,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=k(),d=!1;Je!==n&&(Je=n,it(),Qe=t.scroll,r=t.scrollFn,!0===Qe&&(Qe=U(n,!0)));var u=0,h=Qe;do{var f=h,p=N(f),v=p.top,g=p.bottom,y=p.left,m=p.right,b=p.width,_=p.height,I=void 0,E=void 0,w=f.scrollWidth,D=f.scrollHeight,P=S(f),L=f.scrollLeft,C=f.scrollTop;f===c?(I=b<w&&("auto"===P.overflowX||"scroll"===P.overflowX||"visible"===P.overflowX),E=_<D&&("auto"===P.overflowY||"scroll"===P.overflowY||"visible"===P.overflowY)):(I=b<w&&("auto"===P.overflowX||"scroll"===P.overflowX),E=_<D&&("auto"===P.overflowY||"scroll"===P.overflowY));var O=I&&(Math.abs(m-i)<=l&&L+b<w)-(Math.abs(y-i)<=l&&!!L),x=E&&(Math.abs(g-a)<=l&&C+_<D)-(Math.abs(v-a)<=l&&!!C);if(!ot[u])for(var T=0;T<=u;T++)ot[T]||(ot[T]={});ot[u].vx==O&&ot[u].vy==x&&ot[u].el===f||(ot[u].el=f,ot[u].vx=O,ot[u].vy=x,clearInterval(ot[u].pid),0==O&&0==x||(d=!0,ot[u].pid=setInterval(function(){o&&0===this.layer&&Ze.active._onTouchMove(tt);var t=ot[this.layer].vy?ot[this.layer].vy*s:0,n=ot[this.layer].vx?ot[this.layer].vx*s:0;"function"==typeof r&&"continue"!==r.call(Ze.dragged.parentNode[V],n,t,e,tt,ot[this.layer].el)||F(ot[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=U(h,!1)));rt=d}}),30),st=function(e){var t=e.originalEvent,n=e.putSortable,o=e.dragEl,r=e.activeSortable,i=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var s=n||r;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);l(),s&&!s.el.contains(d)&&(i("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function ct(){}function dt(){}ct.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=G(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:st},u(ct,{pluginName:"revertOnSpill"}),dt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:st},u(dt,{pluginName:"removeOnSpill"});Ze.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):this.options.supportPointer?I(document,"pointermove",this._handleFallbackAutoScroll):t.touches?I(document,"touchmove",this._handleFallbackAutoScroll):I(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):(E(document,"pointermove",this._handleFallbackAutoScroll),E(document,"touchmove",this._handleFallbackAutoScroll),E(document,"mousemove",this._handleFallbackAutoScroll)),at(),it(),clearTimeout(L),L=void 0},nulling:function(){tt=Je=Qe=rt=nt=$e=et=null,ot.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,o=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(o,r);if(tt=e,t||this.options.forceAutoScrollFallback||v||p||y){lt(e,this.options,i,t);var a=U(i,!0);!rt||nt&&o===$e&&r===et||(nt&&at(),nt=setInterval((function(){var i=U(document.elementFromPoint(o,r),!0);i!==a&&(a=i,it()),lt(e,n.options,i,t)}),10),$e=o,et=r)}else{if(!this.options.bubbleScroll||U(i,!0)===k())return void it();lt(e,this.options,U(i,!1),!1)}}},u(e,{pluginName:"scroll",initializeByDefault:!0})}),Ze.mount(dt,ct);const ut=Ze;const ht={_createDraggableElement:function(e,t){navigator.userAgent.match(/chrome|chromium|crios/i)?ut.create(e,{handle:".GPlayerName",draggable:".draggable-layer",ghostClass:"GPghostLayer",animation:200,forceFallback:!0,onEnd:function(e){t._onDragAndDropLayerClick(e)}}):ut.create(e,{handle:".GPlayerName",draggable:".draggable-layer",ghostClass:"GPghostLayer",animation:200,onEnd:function(e){t._onDragAndDropLayerClick(e)}})},_addUID:function(e){return this._uid?e+"-"+this._uid:e},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPlayerSwitcher"),e.className="GPwidget gpf-widget gpf-widget-button",e},_createMainLayersShowElement:function(){var e=document.createElement("input");return e.id=this._addUID("GPshowLayersList"),e.type="checkbox",e},_createMainLayersElement:function(){var e=document.createElement("dialog");return e.id=this._addUID("GPlayersList"),e.className="GPpanel gpf-panel fr-modal",e},_createMainLayersDivElement:function(){var e=document.createElement("div");return e.className="gpf-panel__body fr-modal__body",e},_createMainPictoElement:function(){var e=this,t=document.createElement("button");return t.id=this._addUID("GPshowLayersListPicto"),t.className="GPshowOpen GPshowAdvancedToolPicto gpf-btn gpf-btn-icon-layerswitcher fr-btn",t.htmlFor=this._addUID("GPshowLayersList"),t.title="Afficher/masquer le gestionnaire de couches",t.setAttribute("tabindex","0"),t.setAttribute("aria-pressed",!1),t.addEventListener?t.addEventListener("click",(function(t){var n="true"===t.target.ariaPressed;if(t.target.setAttribute("aria-pressed",!n),document.getElementById(e._addUID("GPshowLayersList")).checked=n,document.getElementById(e._addUID("GPshowLayersList")).checked){for(var o=document.getElementsByClassName("GPlayerInfoOpened"),r=0;r<o.length;r++)o[r].className="GPlayerInfo";document.getElementById(e._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}})):t.attachEvent&&t.attachEvent("onclick",(function(t){var n="true"===t.target.ariaPressed;if(t.target.setAttribute("aria-pressed",!n),document.getElementById(e._addUID("GPshowLayersList")).checked){for(var o=document.getElementsByClassName("GPlayerInfoOpened"),r=0;r<o.length;r++)o[r].className="GPlayerInfo";document.getElementById(e._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}})),t},_createMainInfoElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPlayerInfoPanel"),e.className="GPpanel GPlayerInfoPanelClosed gpf-panel fr-modal",e},_createContainerLayerElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPlayerSwitcher_ID_"+e.id),t.className="GPlayerSwitcher_layer gpf-panel__content fr-modal__content draggable-layer",t.appendChild(this._createBasicToolElement(e));for(var n=this._createAdvancedToolShowElement(e),o=0;o<n.length;o++)t.appendChild(n[o]);return t.appendChild(this._createAdvancedToolElement(e)),t},_createBasicToolElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPbasicTools_ID_"+e.id),t.className="GPlayerBasicTools",t.appendChild(this._createBasicToolNameElement(e));for(var n=this._createBasicToolVisibilityElement(e),o=0;o<n.length;o++)t.appendChild(n[o]);return t},_createBasicToolNameElement:function(e){var t=document.createElement("label");return t.id=this._addUID("GPname_ID_"+e.id),t.className="GPlayerName gpf-label fr-label",t.title=e.description||e.title,t.innerHTML=e.title,t},_createBasicToolVisibilityElement:function(e){var t=[],n=void 0===e.visibility||e.visibility,o=this._addUID("GPvisibility_ID_"+e.id),r=document.createElement("input");r.id=o,r.type="checkbox",r.checked=n;var i=document.createElement("label");i.htmlFor=o,i.id=this._addUID("GPvisibilityPicto_ID_"+e.id),i.className="GPlayerVisibility gpf-label fr-label",i.title="Afficher/masquer la couche";var a=this;return r.addEventListener?r.addEventListener("click",(function(e){a._onVisibilityLayerClick(e)})):r.attachEvent&&r.attachEvent("onclick",(function(e){a._onVisibilityLayerClick(e)})),t.push(r),t.push(i),t},_createAdvancedToolShowElement:function(e){var t=[],n=document.createElement("label");n.id=this._addUID("GPshowAdvancedToolsPicto_ID_"+e.id),n.htmlFor=this._addUID("GPshowAdvancedTools_ID_"+e.id),n.title="Plus d'outils",n.className="GPshowMoreOptions GPshowLayerAdvancedTools gpf-label fr-label";var o=document.createElement("input");return o.type="checkbox",o.id=this._addUID("GPshowAdvancedTools_ID_"+e.id),t.push(o),t.push(n),t},_createAdvancedToolElement:function(e){var t=document.createElement("div");if(t.id=this._addUID("GPadvancedTools_ID_"+e.id),t.className="GPlayerAdvancedTools",t.appendChild(this._createAdvancedToolDeleteElement(e)),e.title&&e.description&&t.appendChild(this._createAdvancedToolInformationElement(e)),"feature"!==e.type)for(var n=this._createAdvancedToolOpacityElement(e),o=0;o<n.length;o++)t.appendChild(n[o]);return t},_createAdvancedToolDeleteElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPremove_ID_"+e.id),t.className="GPlayerRemove",t.title="Supprimer la couche",t.layerId=e.id;var n=this;return t.addEventListener?t.addEventListener("click",(function(e){n._onDropLayerClick(e)})):t.attachEvent&&t.attachEvent("onclick",(function(e){n._onDropLayerClick(e)})),t},_createAdvancedToolInformationElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPinfo_ID_"+e.id),t.className="GPlayerInfo",t.title="Informations/légende",t.layerId=e.id;var n=this;return t.addEventListener?t.addEventListener("click",(function(e){n._onOpenLayerInfoClick(e)})):t.attachEvent&&t.attachEvent("onclick",(function(e){n._onOpenLayerInfoClick(e)})),t},_createAdvancedToolOpacityElement:function(e){var t=[],n=document.createElement("div");n.id=this._addUID("GPopacity_ID_"+e.id),n.className="GPlayerOpacity",n.title="Opacité";var o=void 0!==e.opacity?e.opacity:1;o=Math.round(100*o);var r=document.createElement("input");r.id=this._addUID("GPopacityValueDiv_ID_"+e.id),r.type="range",r.value=o,r.ariaLabel="Opacité";var i=this;r.addEventListener?r.addEventListener("change",(function(e){i._onChangeLayerOpacity(e)})):r.attachEvent&&r.attachEvent("onchange",(function(e){i._onChangeLayerOpacity(e)})),r.addEventListener?r.addEventListener("input",(function(e){i._onChangeLayerOpacity(e)})):r.attachEvent&&r.attachEvent("oninput",(function(e){i._onChangeLayerOpacity(e)})),n.appendChild(r);var a=document.createElement("div");a.id=this._addUID("GPopacityValueDiv_ID_"+e.id),a.className="GPlayerOpacityValue";var l=document.createElement("span");return l.id=this._addUID("GPopacityValue_ID_"+e.id),l.innerHTML=o+"%",a.appendChild(l),t.push(n),t.push(a),t},_createContainerLayerInfoElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPlayerInfoContent");var n=document.createElement("div");if(n.id=this._addUID("GPlayerInfoTitle"),n.innerHTML=e.title,t.appendChild(n),e.quicklookUrl){var o=document.createElement("div");o.id=this._addUID("GPlayerInfoQuicklook"),o.title="Afficher un aperçu de la couche";var r=document.createElement("a");r.href=e.quicklookUrl,r.appendChild(o),t.appendChild(r)}var i=document.createElement("div");i.id=this._addUID("GPlayerInfoClose"),i.title="Fermer la fenêtre";var a=this,l=function(){document.getElementById(a._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed";for(var e=document.getElementsByClassName("GPlayerInfoOpened"),t=0;t<e.length;t++)e[t].className="GPlayerInfo"};i.addEventListener?i.addEventListener("click",l):i.attachEvent&&i.attachEvent("onclick",l),t.appendChild(i);var s=document.createElement("div");if(s.id=this._addUID("GPlayerInfoDescription"),s.innerHTML=e.description,t.appendChild(s),e.metadata){var c=document.createElement("div");c.id=this._addUID("GPlayerInfoMetadata");var d=document.createElement("div");d.className="GPlayerInfoSubtitle",d.innerHTML="Métadonnées",c.appendChild(d);for(var u=0;u<e.metadata.length;u++){var h=e.metadata[u].url,f=document.createElement("div");f.className="GPlayerInfoLink";var p=document.createElement("a");p.href=h,p.innerHTML=h,f.appendChild(p),c.appendChild(f)}0!==e.metadata.length&&t.appendChild(c)}if(e.legends){var v=document.createElement("div");v.id=this._addUID("GPlayerInfoLegend");var g=document.createElement("div");g.className="GPlayerInfoSubtitle",g.innerHTML="Légende",v.appendChild(g);for(var y={},m=e.maxScaleDenominator||56e7,b=0;b<e.legends.length;b++){var _=e.legends[b].minScaleDenominator;if(_){var I=_.toString();_=Math.round(parseInt(I.substring(0,3),10)/10)*Math.pow(10,I.length-2)}else _=270;y[_]=e.legends[b]}for(var E in y)if(y.hasOwnProperty(E)){var w=y[E].url;if("string"==typeof w&&-1===w.toLowerCase().indexOf("nolegend.jpg")){var D=document.createElement("div");D.className="GPlayerInfoLink",m=y[E].maxScaleDenominator||m;var P=document.createElement("a");P.href=w,P.innerHTML="Du 1/"+E+" au 1/"+m,D.appendChild(P),v.appendChild(D)}else delete y[E]}0!==Object.keys(y).length&&t.appendChild(v)}return t}};function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function pt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,vt(o.key),o)}}function vt(e){var t=function(e,t){if("object"!=ft(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ft(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ft(t)?t:t+""}function gt(e,t,n){return t=_t(t),yt(e,mt()?Reflect.construct(t,n||[],_t(e).constructor):t.apply(e,n))}function yt(e,t){if(t&&("object"===ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mt=function(){return!!e})()}function bt(){return bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_t(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},bt.apply(this,arguments)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}function It(e,t){return It=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},It(e,t)}var Et=a.A.getLogger("layerswitcher"),wt=function(e){function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var o=(e=e||{}).options||{},r=e.layers||[];if(!((t=gt(this,n,[{element:o.element,target:o.target,render:o.render}]))instanceof n))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!Array.isArray(r))throw new Error("ERROR WRONG_TYPE : layers should be an array");if("object"!==ft(o))throw new Error("ERROR WRONG_TYPE : options should be an object");return t._initialize(o,r),t.container=t._initContainer(o),t.element?t.element.appendChild(t.container):t.element=t.container,yt(t,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&It(e,t)}(n,e),o=n,(a=[{key:"setMap",value:function(e){var o=this;if(e)this._addMapLayers(e),this._listeners.onMoveListener=e.on("moveend",(function(){return o._onMapMoveEnd(e)})),this._listeners.onAddListener=e.getLayers().on("add",(function(e){var t,n=e.element;n.hasOwnProperty("gpLayerId")?t=n.gpLayerId:(t=o._layerId,n.gpLayerId=t,o._layerId++),o._layers[t]||o.addLayer(n)})),this._listeners.onRemoveListener=e.getLayers().on("remove",(function(e){var t=e.element,n=t.gpLayerId;o._layers[n]&&o.removeLayer(t)}));else{(0,t.unByKey)(this._listeners.onMoveListener),(0,t.unByKey)(this._listeners.onAddListener),(0,t.unByKey)(this._listeners.onRemoveListener);for(var r=this._layersOrder.length-1;r>=0;r--)this._layersOrder[r].layer.setZIndex(0)}bt(_t(n.prototype),"setMap",this).call(this,e),this.options.position&&this.setPosition(this.options.position)}},{key:"addLayer",value:function(e,t){var n=this,o=this.getMap();if(t=t||{},e){var r=e.gpLayerId;if(void 0!==r){var i=!1;if(o.getLayers().forEach((function(e){e.gpLayerId===r&&(i=!0)})),i)if(this._layers[r]){for(var a in t)t.hasOwnProperty(a)&&(this._layers[r][a]=t[a]);if(t.title){var l=document.getElementById(this._addUID("GPname_ID_"+r));l&&(l.innerHTML=t.title,l.title=t.description||t.title)}var s=document.getElementById(this._addUID("GPinfo_ID_"+r));if(!document.getElementById(this._addUID("GPinfo_ID_"+r))&&t.description){var c=document.getElementById(this._addUID("GPadvancedTools_ID_"+r));c&&c.appendChild(this._createAdvancedToolInformationElement({id:r}))}s&&"GPlayerInfoOpened"===s.className&&(document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed",s.className="GPlayerInfo")}else{var d=this.getLayerInfo(e)||{},u=e.getOpacity(),h=e.getVisible(),f=this.isInRange(e,o),p={layer:e,id:r,opacity:null!=u?u:1,visibility:null==h||h,inRange:null==f||f,title:null!=t.title?t.title:d._title||r,description:t.description||d._description||null,legends:t.legends||d._legends||[],metadata:t.metadata||d._metadata||[],quicklookUrl:t.quicklookUrl||d._quicklookUrl||null};this._layers[r]=p;var v=this._createLayerDiv(p);this._layers[r].div=v,e.getZIndex&&0!==e.getZIndex()&&void 0!==e.getZIndex()||e._forceNullzIndex?this._updateLayersOrder():(this._layersOrder.unshift(p),this._lastZIndex++,e.setZIndex(this._lastZIndex),this._layerListContainer.insertBefore(v,this._layerListContainer.firstChild)),this._listeners.updateLayerOpacity=e.on("change:opacity",(function(e){return n._updateLayerOpacity(e)})),this._listeners.updateLayerVisibility=e.on("change:visible",(function(e){return n._updateLayerVisibility(e)})),null==this._layers[r].onZIndexChangeEvent&&(this._layers[r].onZIndexChangeEvent=e.on("change:zIndex",(function(){return n._updateLayersOrder()})))}else Et.log("[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ",e," layer (layer is not in map.getLayers() )")}else Et.trace("[WARN] LayerSwitcher:addLayer - configuration cannot be set for this layer (layer id not found)",e)}else Et.log("[ERROR] LayerSwitcher:addLayer - missing layer parameter")}},{key:"removeLayer",value:function(e){if(e){(0,t.unByKey)(this._listeners.updateLayerOpacity),(0,t.unByKey)(this._listeners.updateLayerVisibility),Et.trace(e);var n=e.gpLayerId,o=document.getElementById(this._addUID("GPlayersList")).firstChild,r=document.getElementById(this._addUID("GPinfo_ID_"+n));r&&"GPlayerInfoOpened"===r.className&&(document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed",r.className="GPlayerInfo");var i=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+n));i&&o.removeChild(i);var a=Math.abs(e.getZIndex()-this._lastZIndex);this._layersOrder.splice(a,1),this._lastZIndex--;for(var l=this._layersOrder,s=0;s<l.length;s++)l[s].layer.setZIndex(this._lastZIndex-s);delete this._layers[n]}}},{key:"setCollapsed",value:function(e){if(void 0!==e){var t=!document.getElementById(this._addUID("GPshowLayersList")).checked;if(!(e&&t||!e&&!t)){if(!t){for(var n=document.getElementsByClassName("GPlayerInfoOpened"),o=0;o<n.length;o++)n[o].className="GPlayerInfo";document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}document.getElementById(this._addUID("GPshowLayersList")).checked=!e}}else Et.log("[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter")}},{key:"getCollapsed",value:function(){return this.collapsed}},{key:"setRemovable",value:function(e,t){if(e){var n=e.gpLayerId;if(null!=n){var o=document.getElementById(this._addUID("GPremove_ID_"+n));o&&(!1===t?o.style.display="none":!0===t&&(o.style.display="block"))}else Et.log("[LayerSwitcher:setRemovable] layer should be added to map before calling setRemovable method")}}},{key:"_initialize",value:function(e,t){this._uid=i.A.generate(),this.options=e,this.options.layers=t,this._layers={},this._layersOrder=[],this._layersIndex={},this._lastZIndex=0,this._layerId=0,this.collapsed=void 0===e.collapsed||e.collapsed,this._layerListContainer=null,this._listeners={};for(var n=0;n<t.length;n++){var o=t[n].layer;if(o){var r;o.hasOwnProperty("gpLayerId")?r=o.gpLayerId:(r=this._layerId,o.gpLayerId=r,this._layerId++);var a=t[n].config||{},l=o.getOpacity(),s=o.getVisible(),c={layer:o,id:r,opacity:null!=l?l:1,visibility:null==s||s,title:null!=a.title?a.title:a.id?a.id:r,description:a.description||null,legends:a.legends||[],metadata:a.metadata||[],quicklookUrl:a.quicklookUrl||null};this._layers[r]=c}}}},{key:"_initContainer",value:function(){var e=this._createMainContainerElement(),t=this._createMainLayersShowElement();e.appendChild(t),this.collapsed?this.collapsed=!0:(t.checked="checked",this.collapsed=!1);var n=this,o=function(e){this.collapsed=!e.target.checked,this.dispatchEvent("change:collapsed")};t.addEventListener("click",(function(e){o.call(n,e)}));var r=this._createMainPictoElement();e.appendChild(r);var i=this._createMainLayersElement();e.appendChild(i);var a=this._layerListContainer=this._createMainLayersDivElement();i.appendChild(a),this._createDraggableElement(a,this);var l=this._createMainInfoElement();return e.appendChild(l),e}},{key:"_addMapLayers",value:function(e){var t=this;for(var n in this._layersIndex={},e.getLayers().forEach((function(n){var o;n.hasOwnProperty("gpLayerId")?o=n.gpLayerId:(o=t._layerId,n.gpLayerId=o,t._layerId++);var r=t.getLayerInfo(n)||{};if(t._layers[o])t._layers[o].opacity=n.getOpacity(),t._layers[o].visibility=n.getVisible(),t._layers[o].inRange=t.isInRange(n,e);else{var i=n.getOpacity(),a=n.getVisible(),l=t.isInRange(n,e),s={layer:n,id:o,opacity:null!=i?i:1,visibility:null==a||a,inRange:null==l||l,title:r._title||o,description:r._description||null,legends:r._legends||[],metadata:r._metadata||[],quicklookUrl:r._quicklookUrl||null};t._layers[o]=s}if(t._listeners.updateLayerOpacity=n.on("change:opacity",(function(e){return t._updateLayerOpacity(e)})),t._listeners._updateLayerVisibility=n.on("change:visible",(function(e){return t._updateLayerVisibility(e)})),void 0!==n.getZIndex){var c=n.getZIndex()||0;t._layersIndex[c]&&Array.isArray(t._layersIndex[c])||(t._layersIndex[c]=[]),t._layersIndex[c].push(t._layers[o])}})),this._layersIndex)if(this._layersIndex.hasOwnProperty(n))for(var o=this._layersIndex[n],r=0;r<o.length;r++)this._layersOrder.unshift(o[r]),this._lastZIndex++,o[r].layer.setZIndex(this._lastZIndex),null==this._layers[o[r].layer.gpLayerId].onZIndexChangeEvent&&(this._layers[o[r].layer.gpLayerId].onZIndexChangeEvent=o[r].layer.on("change:zIndex",(function(){return t._updateLayersOrder()})));for(var i=0;i<this._layersOrder.length;i++){var a=this._layersOrder[i],l=this._createLayerDiv(a);this._layerListContainer.appendChild(l),this._layers[a.id].div=l}}},{key:"_createLayerDiv",value:function(e){var t=e.legends&&0!==e.legends.length,n=e.metadata&&0!==e.metadata.length,o=e.quicklookUrl;(t||n||o)&&(e.displayInformationElement=!0);var r=this._createContainerLayerElement(e);return e.inRange||r.classList.add("outOfRange"),r}},{key:"_onChangeLayerOpacity",value:function(e){var t=e.target.id,n=i.A.index(t),o=this._layers[n].layer,r=e.target.value;document.getElementById(this._addUID("GPopacityValue_ID_"+n)).innerHTML=r+"%",o.setOpacity(r/100)}},{key:"_updateLayerOpacity",value:function(e){var t=e.target.getOpacity();t>1&&(t=1),t<0&&(t=0);var n=e.target.gpLayerId,o=document.getElementById(this._addUID("GPopacityValueDiv_ID_"+n));o&&(o.value=Math.round(100*t));var r=document.getElementById(this._addUID("GPopacityValue_ID_"+n));r&&(r.innerHTML=Math.round(100*t)+"%")}},{key:"_onVisibilityLayerClick",value:function(e){var t=e.target.id,n=i.A.index(t);this._layers[n].layer.setVisible(e.target.checked)}},{key:"_updateLayerVisibility",value:function(e){var t=e.target.getVisible(),n=e.target.gpLayerId,o=document.getElementById(this._addUID("GPvisibility_ID_"+n));o&&(o.checked=t)}},{key:"_updateLayersOrder",value:function(){var e=this,n=this.getMap();if(n){var o,r;for(var i in this._layersIndex={},n.getLayers().forEach((function(n){r=n.gpLayerId,(0,t.unByKey)(e._layers[r].onZIndexChangeEvent),e._layers[r].onZIndexChangeEvent=null,o=null,void 0!==n.getZIndex&&(o=n.getZIndex(),e._layersIndex[o]&&Array.isArray(e._layersIndex[o])||(e._layersIndex[o]=[]),e._layersIndex[o].push(e._layers[r]))})),this._lastZIndex=0,this._layersOrder=[],this._layersIndex)if(this._layersIndex.hasOwnProperty(i))for(var a=this._layersIndex[i],l=0;l<a.length;l++)this._layersOrder.unshift(a[l]),this._lastZIndex++,null==this._layers[a[l].layer.gpLayerId].onZIndexChangeEvent&&(this._layers[a[l].layer.gpLayerId].onZIndexChangeEvent=a[l].layer.on("change:zIndex",(function(){return e._updateLayersOrder()})));if(this._layerListContainer){for(;this._layerListContainer.firstChild;)this._layerListContainer.removeChild(this._layerListContainer.firstChild);for(var s=0;s<this._layersOrder.length;s++){var c=this._layersOrder[s];this._layerListContainer.appendChild(c.div)}}else Et.log("[ol.control.LayerSwitcher] _updateLayersOrder : layer list container not found to update layers order ?!")}}},{key:"_onOpenLayerInfoClick",value:function(e){var t,n,o=e.target.id,r=i.A.index(o),a=this._layers[r];if("GPlayerInfoOpened"===(o=document.getElementById(e.target.id)).className)return void 0!==o.classList&&(o.classList.remove("GPlayerInfoOpened"),o.classList.add("GPlayerInfo")),void 0!==(t=document.getElementById(this._addUID("GPlayerInfoPanel"))).classList&&(t.classList.remove("GPpanel"),t.classList.remove("GPlayerInfoPanelOpened"),t.classList.add("GPlayerInfoPanelClosed")),n=document.getElementById(this._addUID("GPlayerInfoContent")),void t.removeChild(n);for(var l=document.getElementsByClassName("GPlayerInfoOpened"),s=0;s<l.length;s++)l[s].className="GPlayerInfo";void 0!==o.classList&&(o.classList.remove("GPlayerInfo"),o.classList.add("GPlayerInfoOpened")),void 0!==(t=document.getElementById(this._addUID("GPlayerInfoPanel"))).classList&&(t.classList.add("GPpanel"),t.classList.remove("GPlayerInfoPanelClosed"),t.classList.add("GPlayerInfoPanelOpened")),(n=document.getElementById(this._addUID("GPlayerInfoContent")))&&t.removeChild(n);var c={title:a.title,description:a.description,quicklookUrl:a.quicklookUrl,metadata:a.metadata,legends:a.legends},d=a.layer.getMaxResolution();c._maxScaleDenominator=d===1/0?56e7:Math.round(d/28e-5);var u=this._createContainerLayerInfoElement(c);t.appendChild(u)}},{key:"_onDropLayerClick",value:function(e){var t=e.target.id,n=i.A.index(t),o=this._layers[n].layer;this.getMap().getLayers().remove(o)}},{key:"_onDragAndDropLayerClick",value:function(){var e=this,n=this.getMap(),o=document.querySelectorAll("div.GPlayerSwitcher_layer"),r=o.length;this._layersOrder=[];for(var a=0;a<o.length;a++){var l=o[a].id,s=i.A.index(l),c=this._layers[s].layer;(0,t.unByKey)(this._layers[s].onZIndexChangeEvent),this._layers[s].onZIndexChangeEvent=null,c.setZIndex&&(c.setZIndex(r),this._layersOrder.push(this._layers[s]),r--),null==this._layers[s].onZIndexChangeEvent&&(this._layers[s].onZIndexChangeEvent=c.on("change:zIndex",(function(){return e._updateLayersOrder()})))}n.updateSize()}},{key:"_onMapMoveEnd",value:function(e){var t=this;e.getLayers().forEach((function(n){var o=n.gpLayerId;if(t._layers[o]){var r=t._layers[o];t.isInRange(n,e)&&!r.inRange?(r.inRange=!0,document.getElementById(t._addUID("GPlayerSwitcher_ID_"+o)).classList.remove("outOfRange")):!t.isInRange(n,e)&&r.inRange&&(r.inRange=!1,document.getElementById(t._addUID("GPlayerSwitcher_ID_"+o)).classList.add("outOfRange"))}}))}},{key:"getLayerDOMId",value:function(e){var t=null;return this.getMap().getLayers().forEach((function(n){n===e&&(t=n.hasOwnProperty("gpLayerId")?n.gpLayerId:null)})),null!==t?this._addUID("GPlayerSwitcher_ID_"+t):null}},{key:"isInRange",value:function(e,t){if(t){var n=t.getView().getResolution();if(n>e.getMaxResolution()||n<e.getMinResolution())return!1;var o=t.getView().calculateExtent(t.getSize()),i=e.getExtent();return!(i&&!(0,r.intersects)(o,i))}}},{key:"getLayerInfo",value:function(e){var t={};if(void 0!==e.getProperties&&void 0!==e.getSource){var n=e.getProperties(),o=n.source;o&&(t._title=o._title||n.id||"",t._description=o._description||"",t._quicklookUrl=o._quicklookUrl||"",t._metadata=o._metadata||[],t._legends=o._legends||[])}return t}}])&&pt(o.prototype,a),l&&pt(o,l),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,a,l}(e.A);Object.assign(wt.prototype,ht);const Dt=wt;window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=wt)})(),LayerSwitcher=o.default})();
//# sourceMappingURL=LayerSwitcher.js.map