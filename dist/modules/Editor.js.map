{"version":3,"file":"Editor.js","mappings":"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","sources":["webpack://geoportal-extensions-openlayers/./src/packages/Utils/ColorUtils.js","webpack://geoportal-extensions-openlayers/./src/packages/Utils/Helper.js","webpack://geoportal-extensions-openlayers/./src/packages/Utils/LoggerByDefault.js","webpack://geoportal-extensions-openlayers/./src/packages/Utils/SelectorID.js","webpack://geoportal-extensions-openlayers/./node_modules/eventbusjs/lib/eventbus.min.js","webpack://geoportal-extensions-openlayers/./node_modules/eventbusjs/lib/eventbus.min-exposed.js","webpack://geoportal-extensions-openlayers/./node_modules/expose-loader/dist/runtime/getGlobalThis.js","webpack://geoportal-extensions-openlayers/./node_modules/loglevel/lib/loglevel.js","webpack://geoportal-extensions-openlayers/webpack/bootstrap","webpack://geoportal-extensions-openlayers/webpack/runtime/compat get default export","webpack://geoportal-extensions-openlayers/webpack/runtime/define property getters","webpack://geoportal-extensions-openlayers/webpack/runtime/global","webpack://geoportal-extensions-openlayers/webpack/runtime/hasOwnProperty shorthand","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Event.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Style.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Themes.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Filter.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Legend.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Layer.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Group.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Search.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/EditorDOM.js","webpack://geoportal-extensions-openlayers/./src/packages/Controls/Editor/Editor.js"],"sourcesContent":["/**\n * @module ColorUtils\n * @alias module:~utils/ColorUtils\n * @description\n * ...\n *\n * @example\n * import ColorUtils from \"gpf-ext-ol/utils/ColorUtils\"\n * ou \n * import {ColorUtils} from \"gpf-ext-ol\n * \n * ColorUtils.hex();\n * ColorUtils.num();\n * ColorUtils.arrayTorgba();\n * ColorUtils.arrayToHex();\n * ColorUtils.rgbaToHex();\n * ColorUtils.hexToRgba();\n * ColorUtils.isHex();\n * ColorUtils.isRGB();\n */\nvar ColorUtils = {\n\n    /**\n     * Number to hex conversion\n     *\n     * @param {Number} number - 0-255\n     * @returns {String} hex value\n     */\n    hex : function (number) {\n        if (number > 255) {\n            throw new Error(\"'\" + number + \"'' is greater than 255(0xff);\");\n        }\n        var str = Number(number).toString(16);\n        return (\"0\" + str).slice(-2);\n    },\n\n    /**\n     * Hexa to number conversion\n     *\n     * @param {*} hexa 00-FF\n     * @returns {Number} number value\n     */\n    num : function (hexa) {\n        return parseInt(hexa, 16);\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to rgba string\n     *\n     * @function arrayToRgba\n     * @param {Array} values - array of values\n     * @returns {String} A color of RGB or RGBA format\n     */\n    arrayToRgba : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3] || 1;\n        var result = \"rgba(\" + red + \", \" + green + \", \" + blue + \", \" + parseFloat(alpha) + \")\";\n        return result;\n    },\n\n    /**\n     * Converts an array ([255,255,255,1]) to #RRGGBBAA\n     *\n     * @function arrayToHex\n     * @param {Array} values - array of values\n     * @returns {Object}  hex and opacity formated values\n     */\n    arrayToHex : function (values) {\n        if (!Array.isArray(values)) {\n            throw new Error(\"Not an array !\");\n        }\n        var red = values[0];\n        var green = values[1];\n        var blue = values[2];\n        var alpha = values[3];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts rgba string to #RRGGBBAA\n     * (Code adapted from : https://gist.github.com/mstssk/afda4ce9e5c335fd79cd)\n     *\n     * @function rgbaToHex\n     * @param {String} rgba - A color of RGB or RGBA format.\n     * @returns {Object} hex and opacity formated values\n     */\n    rgbaToHex : function (rgba) {\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(rgba);\n        if (!parsed) {\n            throw new Error(\"Invalid format: \" + rgba);\n        }\n        var red = parsed[1];\n        var green = parsed[2];\n        var blue = parsed[3];\n        var alpha = parsed[4];\n        var elems = [this.hex(red), this.hex(green), this.hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts hex color and opacity value to rgba string.\n     * (Code adapted from : http://stackoverflow.com/a/5624139)\n     *\n     * @function hexToRgba\n     * @param {String} hex - A color value on RGB format (hexa).\n     * @param {Number} opacity - A opacity value.\n     * @returns {String} A color of RGB or RGBA format\n     */\n    hexToRgba : function (hex, opacity) {\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        if (!hex) {\n            throw new Error(\"Invalid format\");\n        }\n        hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        rgb = rgb ? {\n            r : parseInt(rgb[1], 16),\n            g : parseInt(rgb[2], 16),\n            b : parseInt(rgb[3], 16)\n        } : null;\n        var result = rgb ? \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + opacity + \")\" : null;\n        return result;\n    },\n\n    /**\n     * Determine if value is a correct hexa color.\n     * @param {*} value - hex color (#FFFFFF)\n     * @returns {Boolean} True if value is a hexa color\n     */\n    isHex : function (value) {\n        if (!value) {\n            return false;\n        }\n        if (value.charAt(0) !== \"#\") {\n            return false;\n        }\n        var regex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Determine if value is a correct rgba color.\n     * @param {*} value - rgba color (rgba(125,125,125,1))\n     * @returns {Boolean} True if value is a rgba color\n     */\n    isRGB : function (value) {\n        if (!value) {\n            return false;\n        }\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(value);\n        if (!parsed) {\n            return false;\n        }\n        return true;\n    }\n};\n\nexport default ColorUtils;\n","/**\n* @module Helper\n* @alias module:~utils/HelperUtils\n* @description\n* ...\n*\n* @example\n* import HelperUtils from \"gpf-ext-ol/utils/HelperUtils\"\n* ou \n* import {HelperUtils} from \"gpf-ext-ol\n* \n* HelperUtils.detectSupport();\n* HelperUtils.assign();\n* HelperUtils.mergeParams();\n*/\nvar Helper = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @function detectSupport\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport : function () {\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @function assign\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign : function (dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @function mergeParams\n     * @param {Object} dest     - destination object where properties and method will be merge\n     * @param {Object} source   - source object from which properties and method will be merge\n     * @param {Boolean} replace - replace destination value by source if exists or not (true by default)\n     */\n    mergeParams : function (dest, source, replace) {\n        if (!dest || !source) {\n            return;\n        }\n        if (typeof replace === \"undefined\") {\n            replace = true;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param], replace);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    if (dest.hasOwnProperty(param)) {\n                        if (replace) {\n                            dest[param] = source[param];\n                        }\n                    } else {\n                        dest[param] = source[param];\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport default Helper;\n","import * as Log from \"loglevel\";\n\n/**\n * @module LoggerByDefault\n * @alias module:~utils/Logger\n * @description\n * ...\n *\n * @example\n * import Logger from \"gpf-ext-ol/utils/LoggerByDefault\"\n * ou \n * import {Logger} from \"gpf-ext-ol\n * \n * Logger.getLogger();\n * Logger.disableAll();\n * Logger.enableAll();\n */\nvar LoggerByDefault = {\n    /**\n     * creation d'un logger statique\n     *\n     * @function getLogger\n     * @param {String} [name=\"default\"] - the logger name\n     * @returns {Object} logger\n     */\n    getLogger : function (name) {\n        // on définit process si non défini dans l'environnement\n        if (typeof process === \"undefined\") {\n            var process = {};\n            process.env = {\n                VERBOSE : false\n            };\n        }\n        (process.env.VERBOSE) ? Log.enableAll() : Log.disableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    },\n    /**\n     * desactive tous les loggers\n     * @function disableAll\n     */\n    disableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.disableAll();\n            }\n        }\n    },\n    /**\n     * active tous les loggers\n     * @function enableAll\n     */\n    enableAll : function () {\n        var loggers = Log.getLoggers();\n        for (const key in loggers) {\n            if (Object.hasOwnProperty.call(loggers, key)) {\n                const logger = loggers[key];\n                logger.enableAll();\n            }\n        }\n    }\n};\n\nexport default LoggerByDefault;\n","/**\n * @module SelectorID\n * @alias module:~utils/SelectorID\n * @private\n * @description\n * formalisme d'un tag ID :\n * -> NAME(_ORDER)-1460636385836\n *\n * @example\n * Ex.\n *   GProutePoints-1460636385836\n *   GProutePoint_10-1460636385836\n */\nvar SelectorID = {\n\n    /**\n     * Construction d'un identifiant statique basé sur le timestamp,\n     * et qui s'incremente de +1 à chaque appel\n     * @function generate\n     */\n    generate : (function () {\n        var timestamp = Math.floor(Date.now());\n        return function () {\n            return timestamp++;\n        };\n    })(),\n\n    /**\n     * nom du tag\n     * @function name\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    name : function (id) {\n        var name = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i === -1) {\n            name = id;\n        } else {\n            name = id.substring(0, i);\n        }\n\n        return name;\n    },\n\n    /**\n     * numero d'identifiant du tag\n     *\n     * @function index\n     * @param {String} id - the id\n     * @returns {String} index\n     */\n    index : function (id) {\n        var index = null;\n\n        var name = this.name(id);\n        // if (name !== id) {\n        var i = name.lastIndexOf(\"_\");\n        if (i !== -1) {\n            index = name.substring(i + 1);\n        }\n        // }\n\n        return index;\n    },\n\n    /**\n     * uuid du tag\n     *\n     * @function uuid\n     * @param {String} id - the id\n     * @returns {String} uuid\n     */\n    uuid : function (id) {\n        var uuid = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i !== -1) {\n            uuid = parseInt(id.substring(i + 1), 10);\n        }\n\n        return uuid;\n    }\n\n};\n\nexport default SelectorID;\n","(function(root,factory){if(typeof exports===\"object\"&&typeof module===\"object\")module.exports=factory();else if(typeof define===\"function\"&&define.amd)define(\"EventBus\",[],factory);else if(typeof exports===\"object\")exports[\"EventBus\"]=factory();else root[\"EventBus\"]=factory()})(this,function(){var EventBusClass={};EventBusClass=function(){this.listeners={}};EventBusClass.prototype={addEventListener:function(type,callback,scope){var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>3?args.splice(3,args.length-1):[];if(typeof this.listeners[type]!=\"undefined\"){this.listeners[type].push({scope:scope,callback:callback,args:args})}else{this.listeners[type]=[{scope:scope,callback:callback,args:args}]}},removeEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;var newArray=[];for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if(listener.scope==scope&&listener.callback==callback){}else{newArray.push(listener)}}this.listeners[type]=newArray}},hasEventListener:function(type,callback,scope){if(typeof this.listeners[type]!=\"undefined\"){var numOfCallbacks=this.listeners[type].length;if(callback===undefined&&scope===undefined){return numOfCallbacks>0}for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];if((scope?listener.scope==scope:true)&&listener.callback==callback){return true}}}return false},dispatch:function(type,target){var event={type:type,target:target};var args=[];var numOfArgs=arguments.length;for(var i=0;i<numOfArgs;i++){args.push(arguments[i])}args=args.length>2?args.splice(2,args.length-1):[];args=[event].concat(args);if(typeof this.listeners[type]!=\"undefined\"){var listeners=this.listeners[type].slice();var numOfCallbacks=listeners.length;for(var i=0;i<numOfCallbacks;i++){var listener=listeners[i];if(listener&&listener.callback){var concatArgs=args.concat(listener.args);listener.callback.apply(listener.scope,concatArgs)}}}},getEvents:function(){var str=\"\";for(var type in this.listeners){var numOfCallbacks=this.listeners[type].length;for(var i=0;i<numOfCallbacks;i++){var listener=this.listeners[type][i];str+=listener.scope&&listener.scope.className?listener.scope.className:\"anonymous\";str+=\" listen for '\"+type+\"'\\n\"}}return str}};var EventBus=new EventBusClass;return EventBus});","var ___EXPOSE_LOADER_IMPORT___ = require(\"-!./eventbus.min.js\");\nvar ___EXPOSE_LOADER_GET_GLOBAL_THIS___ = require(\"../../expose-loader/dist/runtime/getGlobalThis.js\");\nvar ___EXPOSE_LOADER_GLOBAL_THIS___ = ___EXPOSE_LOADER_GET_GLOBAL_THIS___;\nif (typeof ___EXPOSE_LOADER_GLOBAL_THIS___[\"eventbus\"] === 'undefined') ___EXPOSE_LOADER_GLOBAL_THIS___[\"eventbus\"] = ___EXPOSE_LOADER_IMPORT___;\nmodule.exports = ___EXPOSE_LOADER_IMPORT___;\n","\"use strict\";\n\n// eslint-disable-next-line func-names\nmodule.exports = function () {\n  if (typeof globalThis === \"object\") {\n    return globalThis;\n  }\n  var g;\n  try {\n    // This works if eval is allowed (see CSP)\n    // eslint-disable-next-line no-new-func\n    g = this || new Function(\"return this\")();\n  } catch (e) {\n    // This works if the window reference is available\n    if (typeof window === \"object\") {\n      return window;\n    }\n\n    // This works if the self reference is available\n    if (typeof self === \"object\") {\n      return self;\n    }\n\n    // This works if the global reference is available\n    if (typeof global !== \"undefined\") {\n      return global;\n    }\n  }\n  return g;\n}();","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n* managing events\n*\n* See {@link http://krasimirtsonev.com/blog/article/javascript-managing-events-dispatch-listen}\n* See {@link https://github.com/krasimir/EventBus}\n*\n* @property {Event} \"editor:layer:onclickvisibility\" - event ...\n* @property {Event} \"editor:layer:onclickclone\" - event ...\n* @property {Event} \"editor:layer:onclickremove\" - event ...\n* @property {Event} \"editor:style:oneditjson\" - event ...\n* @property {Event} \"editor:style:scale:onchangemin\" - event ...\n* @property {Event} \"editor:style:scale:onchangemax\" - event ...\n* @property {Event} \"editor:legend:onclickedition\" - event ...\n* @property {Event} \"editor:legend:onchangevalue\" - event ...\n* @property {Event} \"editor:filter:oneditjson\" - event ...\n* @property {Event} \"editor:themes:onclickimage\" - event ...\n* @property {Event} \"editor:themes:onclicktitle\" - event ...\n* @property {Event} \"editor:search:onsubmit\" - event ...\n* @property {Event} \"editor:search:onautocomplete\" - event ...\n* @property {Event} \"editor:group:oncollapse\" - event ...\n* @property {Event} \"editor:onloaded\" - event ...\n*\n* @mixin\n*\n* @example\n* // dispatch event\n* EventBus.dispatch(EventEditor.layer.visibility, e);\n* // listener\n* EventBus.addEventListener(EventEditor.layer.visibility, function (e) {...}, this);\n*/\nvar EventEditor = {\n    /** evenement sur la fin de chargement de l'editeur */\n    onloaded : \"editor:onloaded\",\n    layer : {\n        /** evenement sur la visibilité : clic sur le bouton 'oeil' */\n        onclickvisibility : \"editor:layer:onclickvisibility\",\n        /** evenement sur la duplication : clic sur le bouton\n        (not yet implemented !) */\n        onclickclone : \"editor:layer:onclickclone\",\n        /** evenement sur la suppression : clic sur le bouton\n        (not yet implemented !) */\n        onclickremove : \"editor:layer:onclickremove\"\n    },\n    legend : {\n        /** evenement sur l'affichage du mode edition */\n        onclickedition : \"editor:legend:onclickedition\",\n        /** evenement sur la modification d'une valeur */\n        onchangevalue : \"editor:legend:onchangevalue\"\n    },\n    group : {\n        /**  evenement pour deplier/plier le groupe\n        (not yet implemented !) */\n        oncollapse : \"editor:group:oncollapse\"\n    },\n    style : {\n        /** evenement sur l'édition du style\n        (not yet implemented !) */\n        oneditjson : \"editor:style:oneditjson\",\n        /** evenement sur la modification de l'echelle d'affichage */\n        scale : {\n            onchangemin : \"editor:style:scale:onchangemin\",\n            onchangemax : \"editor:style:scale:onchangemax\"\n        }\n    },\n    filter : {\n        /** evenement sur l'édition du filtre\n        (not yet implemented !) */\n        oneditjson : \"editor:filter:oneditjson\"\n    },\n    themes : {\n        /** evenement sur le clic de l'image */\n        onclickimage : \"editor:themes:onclickimage\",\n        /** evenement sur le clic du titre */\n        onclicktitle : \"editor:themes:onclicktitle\"\n    },\n    search : {\n        /** evenement sur la recherche */\n        onsubmit : \"editor:search:onsubmit\",\n        onautocomplete : \"editor:search:onautocomplete\"\n    }\n};\n\nexport default EventEditor;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-style\");\n\n/**\n * @classdesc\n *\n * MapBox styles management\n *\n * @constructor\n * @alias ol.style.editor.Style\n * @param {Object} options - options for function call.\n * @example\n *   var style = new Style ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false,\n *          scale : true\n *      },\n *      title : \"Styles (JSON)\",\n *      obj : {\n *          paint : {},\n *          layout : {}\n *      }\n *   });\n *  style.add();\n *  style.display(true);\n *  style.getContainer();\n */\nclass Style {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Style\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Style)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            scale : true,\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                paint : {},\n                layout : {}\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Styles :\";\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxStyleTarget\",\n            container : \"GPEditorMapBoxStyleContainer\",\n            containerjson : \"GPEditorMapBoxStyleJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxStyleJsonTitle\",\n            jsondisplay : \"GPEditorMapBoxStyleJsonDisplay\",\n            containertoolsscale : \"GPEditorMapBoxStyleToolsScaleContainer\",\n            scaletitle : \"GPEditorMapBoxStyleScaleTitle\",\n            containertoolsminscale : \"GPEditorMapBoxStyleToolsScaleMinContainer\",\n            scalelabelmin : \"GPEditorMapBoxStyleScaleLabelMin\",\n            scaleinputmin : \"GPEditorMapBoxStyleScaleInputMin\",\n            containertoolsmaxscale : \"GPEditorMapBoxStyleToolsScaleMaxContainer\",\n            scalelabelmax : \"GPEditorMapBoxStyleScaleLabelMax\",\n            scaleinputmax : \"GPEditorMapBoxStyleScaleInputMax\",\n            containertoolsedit : \"GPEditorMapBoxStyleToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * ie. this.container\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxStyleContainer\">\n     *   <div class =\"GPEditorMapBoxStyleJsonContainer\">\n     *      <label class=\"GPEditorMapBoxStyleJsonTitle\">JSON Styles :</label>\n     *      <pre class=\"GPEditorMapBoxStyleJsonDisplay\">...</pre>\n     *   </div>\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     *   <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _obj = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n        var _style = {};\n\n        // styles into tag 'paint' ?\n        if (_obj.paint) {\n            _found = true;\n            _style.paint = _obj.paint;\n            if (Object.keys(_obj.paint).length === 0) {\n                logger.info(\"tag 'paint' is empty !\");\n            }\n        }\n\n        // if not, search into tag 'layout' !\n        if (_obj.layout) {\n            _found = true;\n            _style.layout = _obj.layout;\n            // FIXME delete visibility from display ?\n            if (_obj.layout.visibility) {\n                delete _style.visibility;\n            }\n            if (Object.keys(_obj.layout).length === 0) {\n                logger.info(\"tag 'layout' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            var strJson = JSON.stringify(_style, null, 4);\n            json = this._syntaxHighlight(strJson);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var label = document.createElement(\"label\");\n        label.className = this.name.jsonlabel;\n        label.innerHTML = this.options.title;\n        divJson.appendChild(label);\n\n        var pre = document.createElement(\"pre\");\n        pre.className = this.name.jsondisplay;\n        pre.innerHTML = json;\n        if (pre.addEventListener) {\n            pre.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        } else if (pre.attachEvent) {\n            pre.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonStyleMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(pre);\n        div.appendChild(divJson);\n\n        // scale\n        if (this.options.tools.scale) {\n            div.appendChild(this._createElementToolsScale({\n                min : (_style.layout) ? _style.layout.minzoom : 0,\n                max : (_style.layout) ? _style.layout.maxzoom : 21\n            }));\n        }\n\n        // TODO menu d'edition\n        if (this.options.tools.edition) {\n            div.appendChild(this._createElementToolsEdition());\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    /**\n     * Graphical rendering of the scale tools\n     *\n     * @param {Object} scale - {min,max} or 0|21\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsScale (scale) {\n        logger.trace(\"_createElementToolsScale\");\n\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var divToolsScale = document.createElement(\"div\");\n        divToolsScale.className = this.name.containertoolsscale;\n\n        // FIXME Titre ?\n        // var label = document.createElement(\"label\");\n        // label.className = this.name.scaletitle;\n        // label.innerHTML = \"Scale :\";\n        // divToolsScale.appendChild(label);\n        var divMin = document.createElement(\"div\");\n        divMin.className = this.name.containertoolsminscale;\n\n        var labelMin = document.createElement(\"label\");\n        labelMin.className = this.name.scalelabelmin;\n        labelMin.innerHTML = \"min :\";\n        divMin.appendChild(labelMin);\n\n        var inputMin = document.createElement(\"input\");\n        inputMin.className = this.name.scaleinputmin;\n        inputMin.type = \"range\";\n        inputMin.value = scale.min || 0;\n        inputMin.title = scale.min || 0;\n        inputMin.disabled = false;\n        inputMin.min = 0;\n        inputMin.max = 21;\n        inputMin.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMin.addEventListener) {\n            inputMin.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        } else if (inputMin.appendChild) {\n            inputMin.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMinMapBox(e);\n            });\n        }\n        divMin.appendChild(inputMin);\n\n        divToolsScale.appendChild(divMin);\n\n        var divMax = document.createElement(\"div\");\n        divMax.className = this.name.containertoolsmaxscale;\n\n        var labelMax = document.createElement(\"label\");\n        labelMax.className = this.name.scalelabelmax;\n        labelMax.innerHTML = \"max :\";\n        divMax.appendChild(labelMax);\n\n        var inputMax = document.createElement(\"input\");\n        inputMax.className = this.name.scaleinputmin;\n        inputMax.type = \"range\";\n        inputMax.value = scale.max || 21;\n        inputMax.title = scale.max || 21;\n        inputMax.disabled = false;\n        inputMax.min = 0;\n        inputMax.max = 21;\n        inputMax.data = obj; // on lie le DOM et la couche, utile lors d'evenement !\n        if (inputMax.addEventListener) {\n            inputMax.addEventListener(\"change\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        } else if (inputMax.appendChild) {\n            inputMax.appendChild(\"onchange\", function (e) {\n                self.onChangeStyleScaleMaxMapBox(e);\n            });\n        }\n        divMax.appendChild(inputMax);\n\n        divToolsScale.appendChild(divMax);\n\n        return divToolsScale;\n    }\n\n    /**\n     * Graphical rendering of the edition tools\n     *\n     * @returns {DOMElement} DOM element\n     *\n     * @private\n     * @example\n     *   <div class =\"GPEditorMapBoxStyleToolsScaleContainer\"></div>\n     */\n    _createElementToolsEdition () {\n        logger.warn(\"_createElementToolsEdition, it's not yet implemented !\");\n\n        var divToolsEdit = document.createElement(\"div\");\n        divToolsEdit.className = this.name.containertoolsedit;\n\n        return divToolsEdit;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Transform a JSON into a DOM with a syntax in color\n     *\n     * @private\n     * @param {Object} json - json.\n     * @returns {DOMElement} dom element\n     */\n    _syntaxHighlight (json) {\n        json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n        return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function (match) {\n            var cls = \"gp-json-number\";\n            if (/^\"/.test(match)) {\n                if (/:$/.test(match)) {\n                    cls = \"gp-json-key\";\n                } else {\n                    cls = \"gp-json-string\";\n                }\n            } else if (/true|false/.test(match)) {\n                cls = \"gp-json-boolean\";\n            } else if (/null/.test(match)) {\n                cls = \"gp-json-null\";\n            }\n            return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n        });\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:oneditjson\n     */\n    onEditJsonStyleMapBox (e) {\n        logger.trace(\"onEditJsonStyleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.oneditjson, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemin\n     */\n    onChangeStyleScaleMinMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMinMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemin, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Style#editor:style:scale:onchangemax\n     */\n    onChangeStyleScaleMaxMapBox (e) {\n        logger.trace(\"onChangeStyleScaleMaxMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.style.scale.onchangemax, e);\n    }\n\n};\n\nexport default Style;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-themes\");\n\n/**\n * @classdesc\n *\n * Mapbox Themes management\n *\n * @constructor\n * @alias ol.style.editor.Theme\n * @param {Object} options - options for function call.\n * @example\n *   var theme = new Themes ({\n *        \"target\": \"\",\n *        \"tools\": {\n *          \"thumbnails\": true,\n *          \"button\" : {\n *              \"visible\" : true,\n *              \"type\" : \"radio\" (par defaut) | \"checkbox\"\n *          }\n *        },\n *        \"obj\": {\n *          \"themesSummary\": \"\", // Titre du composant (non graphique !)\n *          \"themes\": [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *        }\n *   });\n *  theme.add();\n *  theme.display(true);\n *  theme.getContainer();\n */\nclass Themes {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Themes\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Themes)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {\n            thumbnails : true,\n            button : {\n                visible : true,\n                type : \"radio\"\n            }\n        };\n\n        if (!this.options.tools || Object.keys(this.options.tools).length === 0) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (typeof this.options.obj === \"undefined\" ||\n            this.options.obj === null ||\n            !this.options.obj) {\n            // vide par defaut ?\n            this.options.obj = {\n                themesSummary : \"\",\n                themes : []\n            };\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxThemeTarget\",\n            container : \"GPEditorMapBoxThemesContainer\",\n            containertheme : \"GPEditorMapBoxThemeContainer\",\n            containerthemeID : \"GPEditorMapBoxThemeContainer_ID_\",\n            input : \"GPEditorMapBoxThemeInput\",\n            inputID : \"GPEditorMapBoxThemeInput_ID_\",\n            label : \"GPEditorMapBoxThemeTitle\",\n            labelID : \"GPEditorMapBoxThemeTitle_ID_\",\n            image : \"GPEditorMapBoxThemeImage\",\n            imageID : \"GPEditorMapBoxThemeImage_ID_\",\n            message : \"GPEditorMapBoxThemeMessage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     *  <div class=\"GPEditorMapBoxThemesContainer\">\n     *      <div id=\"GPEditorMapBoxThemeContainer-1\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176933\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image1.png\" alt=\"Description1\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-1\" class=\"GPEditorMapBoxThemeTitle\">Titre1</label>\n     *      </div>\n     *      <div id=\"GPEditorMapBoxThemeContainer-2\" class=\"GPEditorMapBoxThemeContainer\">\n     *          <input type=\"radio\" id=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeInput\" name=\"1552920176934\">\n     *          <img class=\"GPEditorMapBoxThemeImage\" src=\"http://image2.png\" alt=\"Description2\"></img>\n     *          <label for=\"GPEditorMapBoxThemeInput-2\" class=\"GPEditorMapBoxThemeTitle\">Titre2</label>\n     *      </div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var id = this.id || ID.generate();\n\n        // div principale\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n        div.title = obj.themesSummary || \"\";\n\n        var _lstThemes = obj.themes;\n        if (_lstThemes) {\n            for (var i = 0; i < _lstThemes.length; i++) {\n                var _theme = _lstThemes[i];\n\n                // div pour chaque theme\n                var divTheme = document.createElement(\"div\");\n                divTheme.id = this.name.containerthemeID + i + \"_\" + id;\n                divTheme.className = this.name.containertheme;\n                divTheme.tabIndex = i;\n\n                // url du style est obligatoire !\n                var _url = _theme.url;\n                // style selectionné par defaut (uniquement en mode radio-button !?)\n                var _selected = _theme.selected || false;\n                if (_url) {\n                    // bouton\n                    var button = this.options.tools.button;\n                    if (button.visible) {\n                        var _type = (button.type === \"checkbox\") ? \"checkbox\" : \"radio\";\n                        var _button = document.createElement(\"input\");\n                        _button.type = _type;\n                        _button.id = this.name.inputID + i + \"_\" + id;\n                        _button.className = this.name.input;\n                        _button.name = id;\n                        _button.checked = _selected;\n                        _button.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (_button.addEventListener) {\n                            _button.addEventListener(\"click\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        } else if (_button.attachEvent) {\n                            _button.attachEvent(\"onclick\", function (e) {\n                                self.onClickThemeTitleMapBox(e);\n                            });\n                        }\n                        divTheme.appendChild(_button);\n                    }\n                    // vignette\n                    if (this.options.tools.thumbnails) {\n                        if (_theme.thumbnail) {\n                            var _img = document.createElement(\"img\");\n                            _img.id = this.name.imageID + i + \"_\" + id;\n                            _img.className = this.name.image;\n                            _img.src = _theme.thumbnail;\n                            _img.alt = _theme.thumbnail;\n                            _img.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                            _img.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                            if (_img.addEventListener) {\n                                _img.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    // maj du radio button\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            } else if (_img.attachEvent) {\n                                _img.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeImageMapBox(e);\n                                    var nodes = e.target.parentElement.childNodes;\n                                    if (nodes) {\n                                        var node = nodes[0];\n                                        if (node.tagName.toLowerCase() === \"input\") {\n                                            node.checked = !node.checked;\n                                        }\n                                    }\n                                });\n                            }\n                            divTheme.appendChild(_img);\n                        }\n                    }\n                    // label\n                    if (_theme.name) {\n                        var _label = document.createElement(\"label\");\n                        _label.id = this.name.labelID + i + \"_\" + id;\n                        if (this.options.tools.button.visible) {\n                            _label.htmlFor = _button.id;\n                        }\n                        _label.className = this.name.label;\n                        _label.innerHTML = _theme.name;\n                        _label.title = _theme.description || \"\"; // une description au survol de l'image ou titre...\n                        _label.data = _url; // on lie le DOM et la couche, utile lors d'evenement !\n                        if (!this.options.tools.button.visible) {\n                            if (_label.addEventListener) {\n                                _label.addEventListener(\"click\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            } else if (_label.attachEvent) {\n                                _label.attachEvent(\"onclick\", function (e) {\n                                    self.onClickThemeTitleMapBox(e);\n                                });\n                            }\n                        }\n                        divTheme.appendChild(_label);\n                    }\n                } else {\n                    var _msg = document.createElement(\"label\");\n                    _msg.className = this.name.message;\n                    _msg.innerHTML = \"Thème non disponible...\";\n                    divTheme.appendChild(_msg);\n                }\n\n                div.appendChild(divTheme);\n            }\n        }\n\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:image\n     */\n    onClickThemeImageMapBox (e) {\n        logger.trace(\"onClickThemeImageMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.previousSibling.id.substring(\n                e.target.previousSibling.id.lastIndexOf(\"_\") + 1\n            );\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.previousSibling.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclickimage, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Themes#editor:themes:title\n     */\n    onClickThemeTitleMapBox (e) {\n        logger.trace(\"onClickThemeTitleMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        if (this.options.tools.button.type === \"checkbox\") {\n            // GPEditorMapBoxThemeInput_ID_0_1571317605868\n            var targetIDX = e.target.id.substring(e.target.id.lastIndexOf(\"_\") + 1);\n            var _inputs = document.getElementsByClassName(this.name.input);\n            for (var i = 0; i < _inputs.length; i++) {\n                var el = _inputs[i];\n                if (el.id === e.target.id) {\n                    continue;\n                }\n                var elIDX = el.id.substring(el.id.lastIndexOf(\"_\") + 1);\n                if (elIDX !== targetIDX) {\n                    continue;\n                }\n                el.checked = false;\n            }\n        }\n        EventBus.dispatch(EventEditor.themes.onclicktitle, e);\n    }\n\n};\n\nexport default Themes;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-filter\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Filter\n * @param {Object} options - options for function call.\n * @example\n *   var filter = new Filter ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          edition : false\n *      },\n *      title : \"Filtres (JSON)\",\n *      obj : {\n *          filter : []\n *      }\n *   });\n *  filter.add();\n *  filter.display(true);\n *  filter.getContainer();\n */\nclass Filter {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Filter\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Filter)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            edition : false\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {\n                filter : []\n            };\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"JSON Filtres :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxFilterTarget\",\n            container : \"GPEditorMapBoxFilterContainer\",\n            containerjson : \"GPEditorMapBoxFilterJsonContainer\",\n            jsonlabel : \"GPEditorMapBoxFilterTitleJson\",\n            jsondisplay : \"GPEditorMapBoxFilterDisplayJson\",\n            containertoolsedit : \"GPEditorMapBoxFilterToolsEditionContainer\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxFilterContainer\">\n     *  <div class =\"GPEditorMapBoxFilterJsonontainer\">\n     *     <label class=\"GPEditorMapBoxFilterTitleJson\">JSON Filtres :</label>\n     *     <pre class=\"GPEditorMapBoxFilterDisplayJson\">...</pre>\n     *  </div>\n     *  <div class =\"GPEditorMapBoxStyleToolsEditionContainer\"></div>\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var _found = false;\n        var _filter = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        // FIXME tag filter est obselete !\n        // on doit utiliser les expressions dans \"paint\" ou \"layout\" !\n        if (_filter.filter) {\n            _found = true;\n            if (_filter.filter.length === 0) {\n                logger.info(\"tag 'filter' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        var json = null;\n        if (_found) {\n            json = JSON.stringify(_filter.filter, null, 4);\n        }\n\n        var divJson = document.createElement(\"div\");\n        divJson.className = this.name.containerjson;\n\n        var labelJson = document.createElement(\"label\");\n        labelJson.className = this.name.jsonlabel;\n        labelJson.innerHTML = this.options.title;\n        divJson.appendChild(labelJson);\n\n        var preJson = document.createElement(\"pre\");\n        preJson.className = this.name.jsondisplay;\n        preJson.innerHTML = json;\n        if (preJson.addEventListener) {\n            preJson.addEventListener(\"click\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        } else if (preJson.attachEvent) {\n            preJson.attachEvent(\"onclick\", function (e) {\n                if (self.options.tools.edition) {\n                    self.onEditJsonFilterMapBox(e);\n                }\n            });\n        }\n        divJson.appendChild(preJson);\n        div.appendChild(divJson);\n\n        if (this.options.tools.edition) {\n            var divEdit = document.createElement(\"div\");\n            divEdit.className = this.name.containertoolsedit;\n            div.appendChild(divEdit);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Filter#editor:style:oneditjson\n     */\n    onEditJsonFilterMapBox (e) {\n        logger.trace(\"onEditJsonFilterMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.filter.oneditjson, e);\n    }\n\n};\n\nexport default Filter;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Color from \"../../Utils/ColorUtils\";\n\nvar logger = Logger.getLogger(\"editor-legend\");\n\n/**\n * @classdesc\n *\n * MapBox Legend management\n *\n * @constructor\n * @alias ol.style.editor.Legend\n * @param {Object} options - options for function call.\n * @param {Object} [options.target = null] - ...\n * @param {Number} [options.position = 0] -  ...\n * @param {Number} [options.id = null] - (internal) ...\n * @param {Object} [options.sprites = null] - ...\n * @param {String} [options.sprites.url] - ...\n * @param {Object} [options.sprites.size] - {h:, w:} ...\n * @param {Object} [options.sprites.json] - ...\n * @param {Object} options.obj - ...\n * @param {String} [options.obj.title] - ...\n * @param {Boolean} [options.obj.editable = true] - ...\n * @param {Object} options.obj.paint - ...\n * @param {Object} options.obj.layout - ...\n * @example\n *   var legend = new Legend ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      sprites : {\n *          url : \"http://localhost/sprites.png\",\n *          size : { w : 450, h : 550 },\n *          json : {\n *              icon-1 : {x:,y:,height:,width:,pixelRatio:},\n *              icon-2 : {x:,y:,height:,width:,pixelRatio:}\n *          }\n *      },\n *      obj : {\n *          title : \"\",\n *          editable : true, // tag non standard issue du style json dédié à l'edition\n *          paint : {\"fill-color\": \"#2BB3E1\"},\n *          layout : {visibility:\"none\"}\n *      }\n *   });\n *  legend.add();\n *  legend.display(true);\n *  legend.isEditable();\n *  legend.getRenderContainer();\n *  legend.getToolsContainer();\n *  legend.getContainer();\n */\nclass Legend {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Legend\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            position : 0,\n            sprites : null,\n            obj : null\n        };\n\n        if (!(this instanceof Legend)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ########################## init methods ########################### //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        // permet d'avoir un identifiant de position dans la liste des layers\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition...\n            this.options.obj = {\n                title : \"vide...\",\n                editable : true,\n                paint : {\n                    \"fill-color\" : \"#FFFFFF\"\n                }\n            };\n        }\n\n        // la legende est elle editable ?\n        // le tag 'editable' est à placer dans le fichier de style (dans le layer)...\n        var _editable = this.options.obj.editable;\n        this.editable = (typeof _editable !== \"undefined\") ? _editable : false;\n\n        // liste des caractéristiques de la legende par defaut\n        this.legendRender = {\n            type : \"fill\",\n            values : {\n                width : 1,\n                stroke : \"#FFFFFF\",\n                color : \"#000000\",\n                opacity : 1\n            }\n        };\n\n        // DOM : pointer\n        this.container = null;\n        this.rendercontainer = null;\n        this.toolscontainer = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLegendTarget\",\n            container : \"GPEditorMapBoxLegendContainer\",\n            containerlegendrender : \"GPEditorMapBoxLegendRenderContainer\",\n            legendrender : \"GPEditorMapBoxLegendRender\",\n            legendeditable : \"GPEditorMapBoxLegendEditable\",\n            legendtitle : \"GPEditorMapBoxLegendTitle\",\n            containerlegendtools : \"GPEditorMapBoxLegendToolsContainer\"\n        };\n\n        // DOM : Label menu Edition\n        this.labels = {\n            \"line-color\" : \"Couleur du trait\",\n            \"line-width\" : \"Epaisseur du trait\",\n            \"line-opacity\" : \"Opacité du trait\",\n            \"fill-color\" : \"Couleur de remplissage\",\n            \"fill-opacity\" : \"Opacité du remplissage\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxLegendContainer\">\n     *  <div class=\"GPEditorMapBoxLegendRenderContainer\">\n     *      <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-circle\" style=\"...\"></div>\n     *      <span class=\"GPEditorMapBoxLegendTitle\">test circle editable...</span>\n     *  </div>\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     * </div>\n     */\n    _initContainer () {\n        var _obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // INFO\n        // on recherche les informations dans le tag 'paint' en priorité, mais pour\n        // les icones ou textes, les informations peuvent se trouver aussi dans le tag 'layout'...\n        // on fusionnne paint et layout par facilité\n        var style = Object.assign({}, _obj.paint, _obj.layout);\n\n        // liste des properties mapbox\n        // ex. fill-color\n        var keys = Object.keys(style);\n        if (keys.length === 0) {\n            logger.info(\"tag 'paint' or 'layout' is empty !\");\n            return;\n        }\n\n        // FIXME\n        // - gestion de type plus complexe : texte avec/sans symbole ou symbole !\n        // - pour les textes ou icones, les info peuvent être aussi dans le tag 'layout' !\n        var params = {};\n        var bFound = false;\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            // recherche du type\n            // ex. fill\n            if (/fill-/.test(key) ||\n                /line-/.test(key) ||\n                /circle-/.test(key) ||\n                /background-/.test(key) ||\n                /text-/.test(key) ||\n                /icon-/.test(key)) {\n                // style geré & trouvé\n                bFound = true;\n\n                var title = _obj.title || \"\";\n\n                // INFO\n                // le type texte ou icone est difficile à trouver car les 2 types cohabitent,\n                // on le gère en symbole...\n                var type = key.split(\"-\")[0];\n                if (type === \"text\" || type === \"icon\") {\n                    type = \"symbol\";\n                }\n\n                this.legendRender = this._getProperties(type, style);\n                params = {\n                    edit : this.editable,\n                    title : title,\n                    type : this.legendRender.type,\n                    values : this.legendRender.values\n                };\n                div.appendChild(this._createElementIconLegend(params));\n\n                // on stoppe la recherche\n                break;\n            }\n        }\n\n        // legende avec un style indeterminé ou non géré !?\n        if (!bFound) {\n            // on prend la legende par defaut\n            params = {\n                edit : this.editable,\n                title : \"\",\n                type : this.legendRender.type,\n                values : this.legendRender.values\n            };\n            div.appendChild(this._createElementIconLegend(params));\n            logger.warn(\"legend type unknown, default legend used...\");\n        }\n\n        // ajout mode edition graphique de la legende\n        this.toolscontainer = this._createElementEditionLegend(params);\n        div.appendChild(this.toolscontainer);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n    * Get properties supported\n    *\n    * @param {Object} type - fill, line, circle, text, icon...\n    * @param {Object} values - raw values from the JSON file\n    * @returns {Object} - { type : (fill | line | circle | symbol), values : valuesSupported }\n    *\n    * @private\n    * @example\n    *\n    * // TODO\n    * // symbol with text (1) / symbol without text (2) / text (3)\n    * // \"layout\":{\n    * //      \"icon-image\":\"{maki}-11\",          <!--- IT'S A SYMBOL (1) (2)-->\n    * //      \"text-font\":[\n    * //           \"Open Sans Semibold\",\n    * //           \"Arial Unicode MS Bold\"\n    * //       ],\n    * //       \"text-field\":\"{name_en}\",         <!--- IT'S A TEXT (1) (3)-->\n    * //       \"text-max-width\":9,\n    * //       \"text-padding\":2,\n    * //       \"text-offset\":[\n    * //            0,\n    * //            0.6\n    * //       ],\n    * //       \"text-anchor\":\"top\",\n    * //       \"text-size\":12\n    * // },\n    * // \"paint\":{\n    * //     \"text-color\":\"#666\",\n    * //     \"text-halo-color\":\"#ffffff\",\n    * //     \"text-halo-width\":1,\n    * //     \"text-halo-blur\":0.5\n    * // },\n    *\n    */\n    _getProperties (type, values) {\n        // cas particulier du symbole complexe\n        // il existe plusieurs types pour un symbole :\n        // - text\n        // - icon\n        // - icon with text\n        if (type === \"symbol\") {\n            var isTextValue = values[\"text-field\"];\n            var isIconValue = values[\"icon-image\"];\n            type = (isTextValue && isIconValue) ? \"icon\" : (isTextValue) ? \"text\" : (isIconValue) ? \"icon\" : \"unknow\";\n            if (type === \"unknow\") {\n                logger.warn(\"type unknow !?\");\n                return;\n            }\n        }\n\n        var valuesSupported = {};\n        for (const key in values) {\n            if (Object.hasOwnProperty.call(values, key)) {\n                const val = values[key];\n                if (Legend.PROPERTIES[type].includes(key)) {\n                    var prop = key.replace(type, \"\").slice(1);\n                    var value = this._getValue(val);\n                    if (value) {\n                        // cas particulier des sprites\n                        if (prop === \"pattern\" || prop === \"image\") {\n                            if (!this.options.sprites ||\n                                !this.options.sprites.json ||\n                                !this.options.sprites.json[value]) {\n                                var k = type + \":\" + prop;\n                                logger.warn(\"sprites mandatory for key \", k);\n                                break;\n                            }\n                        }\n                        valuesSupported[prop] = value;\n                    }\n                } else {\n                    logger.warn(\"property not supported : \", key);\n                }\n            }\n        }\n\n        return {\n            type : type,\n            values : valuesSupported\n        };\n    }\n\n    /**\n    * Render thumbnail (SVG)\n    *\n    * @param {Object} type - fill, line, circle, text, ...\n    * @param {Object} values - {\"color\":..., \"width\":..., \"stroke\":...., \"opacity\":...}\n    * @returns {Boolean} true/false\n    *\n    * @private\n    * @example\n    * (...)\n    */\n    _renderThumbnail (type, values) {\n        // div de rendu de la legende\n        var div = this.rendercontainer;\n\n        if (!div) {\n            return false;\n        }\n\n        // SVG\n        var svg = null;\n        // facteur grossissement (x10) pour le trait\n        var factor = 3;\n\n        // valeur par defaut\n        if (!values.color) {\n            values.color = \"#FFFFFF\";\n        }\n        // en fonction du type, on y ajoute le style\n        switch (type) {\n            case \"text\":\n                var styleText = \"font-size: 5em;font-weight: bold;\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><text x='50' y='50' fill='%color%' fill-opacity='%opacity%'  text-anchor='middle' dominant-baseline='central' style='%style%'> T </text></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%style%\", styleText);\n                break;\n            case \"icon\":\n                if (values.image) {\n                    // FIXME on reste dans le paradigme d'utilisation du SVG...,\n                    // mais probleme de ratio de l'image !?\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.image].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.image].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.image].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.image].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var styleTextIcon = \"fill: transparent;stroke-width: 10;\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M 50,20 80,82.5 20,82.5 z' stroke='%color%' style='%style%'/></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%style%\", styleTextIcon);\n                }\n                break;\n            case \"line\":\n                var lstrockedasharray = (Array.isArray(values[\"dasharray\"])) ? values[\"dasharray\"].join(\" \") : 0;\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><line x1='0' y1='100' x2='100' y2='0' stroke='%color%' stroke-width='%stroke-width%' stroke-opacity='%stroke-opacity%' stroke-dasharray='%stroke-dasharray%' /></svg>\\\")\";\n                // svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M0 99 L99 0 L100 1 L1 100' stroke='%color%' stroke-width='%width%' stroke-opacity='%opacity%' stroke-dasharray='%dasharray%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%stroke-opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-dasharray%\", lstrockedasharray)\n                    .replace(\"%stroke-width%\", (values.width || 0) * factor);\n                break;\n            case \"circle\":\n                var cstrockcolor = values[\"stroke-color\"] || \"#FFFFFF\";\n                svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' stroke='%stroke-color%' stroke-width='%stroke-width%' stroke-opacity='%strock-opacity%' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                div.style[\"background\"] = svg\n                    .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                    .replace(\"%opacity%\", values.opacity || 1)\n                    .replace(\"%stroke-color%\", (cstrockcolor.indexOf(\"rgb\") === 0) ? cstrockcolor : Color.hexToRgba(cstrockcolor, 1))\n                    .replace(\"%stroke-opacity%\", values[\"stroke-opacity\"] || 1)\n                    .replace(\"%stroke-width%\", (values[\"stroke-width\"] || 0) * factor);\n                break;\n            case \"background\":\n            case \"fill\":\n                if (values.pattern) {\n                    svg = \"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' width='27px' height='27px' x='0' y='0' viewBox='%x% %y% %w% %h%'><image width='%W%px' height='%H%px' href='%URL%'/></svg>\"\n                        .replace(\"%x%\", this.options.sprites.json[values.pattern].x)\n                        .replace(\"%y%\", this.options.sprites.json[values.pattern].y)\n                        .replace(/%w%/g, this.options.sprites.json[values.pattern].width)\n                        .replace(/%h%/g, this.options.sprites.json[values.pattern].height)\n                        .replace(\"%W%\", this.options.sprites.size.w)\n                        .replace(\"%H%\", this.options.sprites.size.h)\n                        .replace(\"%URL%\", this.options.sprites.url);\n                    div.innerHTML = svg;\n                } else {\n                    var fstrokecolor = values[\"outline-color\"] || \"#FFFFFF\";\n                    svg = \"url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' stroke='%stroke-color%' stroke-width='3' fill='%color%' fill-opacity='%opacity%' /></svg>\\\")\";\n                    div.style[\"background\"] = svg\n                        .replace(\"%color%\", (values.color.indexOf(\"rgb\") === 0) ? values.color : Color.hexToRgba(values.color, 1))\n                        .replace(\"%opacity%\", values.opacity || 1)\n                        .replace(\"%stroke-color%\", (fstrokecolor.indexOf(\"rgb\") === 0) ? fstrokecolor : Color.hexToRgba(fstrokecolor, 1));\n                }\n                break;\n            default:\n                logger.warn(\"type not found, no thumbnail...\");\n                return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Get value\n     *\n     * @param {*} value - value of a property (ex. \"#2BB3E1\")\n     * @returns {*} return a verified value (ex. color\": \"#2BB3E1\")\n     *\n     * @private\n     * @example\n     * // type simple for fill, line or circle type with string :\n     * // \"paint\": {\n     * //     \"fill-color\": \"#2BB3E1\"\n     * // }\n     *\n     * // type simple for fill, line or circle type with array :\n     * // \"paint\": {\n     * //     \"line-dasharray\": [2,10]\n     * // }\n     *\n     * // TODO type complexe : not yet implemented !\n     * // \"paint\": {\n     * //     \"fill-color\": [\n     * //          \"match\",\n     * //          [\"get\",\"symbo\"],\n     * //          \"ZONE_BOISEE\",\"#A7DA81\",\n     * //          \"ZONE_MANGROVE\",\"#7E8AB5\",\n     * //          \"#A7DA81\"\n     * //      ]\n     * // }\n     *\n     * // other type complexe :\n     * // \"paint\": {\n     * //     \"fill-color\": {\n     * //        \"base\": 1,\n     * //        \"stops\": [\n     * //        [\n     * //          15.5,\n     * //         \"#f2eae2\"\n     * //        ],\n     * //        [\n     * //          16,\n     * //          \"#dfdbd7\"\n     * //        ]\n     * //        ]\n     * //     }\n     * // }\n     */\n    _getValue (value) {\n        var result = null;\n        if (typeof value === \"string\") {\n            result = value;\n        } else if (typeof value === \"number\") {\n            result = value;\n        } else if (Array.isArray(value)) {\n            // cas d'un tableau de valeurs numériques : [1,2,3]\n            var isNumber = true;\n            value.forEach(v => {\n                if (typeof v !== \"number\") {\n                    isNumber = false;\n                }\n            });\n            if (isNumber) {\n                result = value;\n            }\n        } else if (typeof value === \"object\") {\n            result = null;\n            if (\"stops\" in value) {\n                // on realise un ordre inversé sur les zooms\n                value.stops.sort((a, b) => {\n                    var numA = a[0];\n                    var numB = b[0];\n                    if (numA > numB) {\n                        return -1;\n                    }\n                    if (numA < numB) {\n                        return 1;\n                    }\n                    return 0;\n                });\n                // et, on prend le plus petit zoom\n                var lastStopsValue = value.stops.slice(-1);\n                result = lastStopsValue[0][1];\n            }\n        } else {\n            logger.warn(\"value not supported !\");\n        }\n        return result;\n    }\n\n    // ################################################################### //\n    // ######################### DOM methods ############################# //\n    // ################################################################### //\n    /**\n    * Create a Graphical Legend Icon\n    *\n    * @param {Object} params - param\n    * @param {String} params.title - title\n    * @param {String} params.type - fill, line, circle, text, icon, ...\n    * @param {String} params.values - {\"color\": \"#2BB3E1\", \"width\": 10, \"opacity\": 0.5, \"stroke\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line, fill and circle legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendRenderContainer\">\n    *       <div class=\"GPEditorMapBoxLegendRender GPEditorMapBoxLegendEditable legend-fill\"\n    *           style=\"background: url(&quot;data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><rect x='0' y='0' width='100' height='100' rx='5' ry='5' fill='rgba(255, 255, 255, 1)' fill-opacity='1' /></svg>&quot;);\">\n    *       </div>\n    *       <span class=\"GPEditorMapBoxLegendTitle\">vide...</span>\n    * </div>\n    */\n    _createElementIconLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendrender;\n\n        var div = this.rendercontainer = document.createElement(\"div\");\n        div.className = this.name.legendrender;\n        if (params.edit) {\n            div.className += \" \";\n            div.className += this.name.legendeditable;\n            if (div.addEventListener) {\n                div.addEventListener(\"click\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            } else if (div.attachEvent) {\n                div.attachEvent(\"onclick\", function (e) {\n                    self.onEditionLegendMapBox(e);\n                });\n            }\n        }\n\n        // type de legende\n        var type = params.type;\n\n        // TODO className\n        // div.className += \" legend-not-implemented\";\n        // ajout du style sur la div de rendu\n        if (this._renderThumbnail(type, params.values)) {\n            // className possibles :\n            // \" legend-text\"\n            // \" legend-icon\"\n            // \" legend-background\"\n            // \" legend-line\"\n            // \" legend-line-not-editable\"\n            // \" legend-circle\"\n            // \" legend-circle-not-editable\"\n            // \" legend-fill\"\n            // \" legend-fill-not-editable\"\n            div.className += (params.edit) ? \" legend-\" + type : \" legend-\" + type + \"-not-editable\";\n        } else {\n            div.className += \" legend-unknow\";\n        }\n\n        container.appendChild(div);\n\n        var span = document.createElement(\"span\");\n        span.className = this.name.legendtitle;\n        span.innerHTML = params.title || \"\";\n        container.appendChild(span);\n\n        return container;\n    }\n\n    /**\n    * Create a Graphical Legend Edition\n    *\n    * @param {Object} params - param\n    * @param {String} params.type - fill, line, (TODO : circle, icon or text)\n    * @param {String} params.values - {\"fill-color\": \"#2BB3E1\"}\n    * @param {Boolean} params.edit - editable with a colorPicker for only line and fill legend !\n    * @returns {DOMElement} DOM element\n    *\n    * @private\n    * @example\n    *   <div class=\"GPEditorMapBoxLegendToolsContainer\">\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-color\">Couleur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-width\">Epaisseur du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-width\" title=\"\" type=\"range\" min=\"0\" max=\"10\" step=\"1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"stroke-opacity\">Opacité du trait</label>\n    *           <input class=\"legend-styling\" id=\"stroke-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-color\">Couleur de remplissage</label>\n    *        <input class=\"legend-styling\" id=\"fill-color\" title=\"\" type=\"color\">\n    *       </div>\n    *       <div class=\"legend-styling-div\">\n    *           <label for=\"fill-opacity\">Opacité du remplissage</label>\n    *           <input class=\"legend-styling\" id=\"fill-opacity\" title=\"\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\">\n    *       </div>\n    *   </div>\n    */\n    _createElementEditionLegend (params) {\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = this.name.containerlegendtools;\n\n        // uniquement les elements editables !\n        if (!params.edit) {\n            return container;\n        }\n\n        // on ne traite que l'edition du mode 'traits' ou 'surfaciques'\n        // mode 'line'\n        switch (params.type) {\n            case \"line\":\n                createLineColor.call(self);\n                createLineWidth.call(self);\n                createLineOpacity.call(self);\n                break;\n            case \"background\":\n            case \"fill\":\n                createFillColor.call(self);\n                createFillOpacity.call(self);\n                break;\n            default:\n                break;\n        }\n\n        // couleur du trait\n        function createLineColor () {\n            var linecolor = document.createElement(\"div\");\n            linecolor.className = \"legend-styling-div\";\n            var lLineColor = document.createElement(\"label\");\n            lLineColor.className = \"legend-line\";\n            lLineColor.htmlFor = this.id ? \"line-color-\" + this.id : \"line-color\";\n            lLineColor.innerHTML = this.labels[\"line-color\"];\n            var inputLineColor = document.createElement(\"input\");\n            inputLineColor.className = \"legend-styling\";\n            inputLineColor.id = this.id ? \"line-color-\" + this.id : \"line-color\";\n            inputLineColor.title = \"Selectionner une couleur de trait\";\n            inputLineColor.type = \"color\";\n            inputLineColor.value = params.values.color;\n            inputLineColor.setAttribute(\"data-id\", \"line-color\");\n            if (inputLineColor.addEventListener) {\n                inputLineColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineColor.attachEvent) {\n                inputLineColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linecolor.appendChild(lLineColor);\n            linecolor.appendChild(inputLineColor);\n            container.appendChild(linecolor);\n        }\n\n        // epaisseur du trait\n        function createLineWidth () {\n            var linewidth = document.createElement(\"div\");\n            linewidth.className = \"legend-styling-div\";\n            var lLineWidth = document.createElement(\"label\");\n            lLineWidth.className = \"legend-line\";\n            lLineWidth.htmlFor = this.id ? \"line-width-\" + this.id : \"line-width\";\n            lLineWidth.innerHTML = this.labels[\"line-width\"];\n            var inputLineWidth = document.createElement(\"input\");\n            inputLineWidth.className = \"legend-styling\";\n            inputLineWidth.id = this.id ? \"line-width-\" + this.id : \"line-width\";\n            inputLineWidth.title = params.values.width;\n            inputLineWidth.type = \"range\";\n            inputLineWidth.min = \"0\";\n            inputLineWidth.max = \"10\";\n            inputLineWidth.step = \"1\";\n            inputLineWidth.defaultValue = params.values.width;\n            inputLineWidth.setAttribute(\"data-id\", \"line-width\");\n            if (inputLineWidth.addEventListener) {\n                inputLineWidth.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineWidth.attachEvent) {\n                inputLineWidth.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        width : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            linewidth.appendChild(lLineWidth);\n            linewidth.appendChild(inputLineWidth);\n            container.appendChild(linewidth);\n        }\n\n        // opacité du trait\n        function createLineOpacity () {\n            var lineopacity = document.createElement(\"div\");\n            lineopacity.className = \"legend-styling-div\";\n            var lLineOpacity = document.createElement(\"label\");\n            lLineOpacity.className = \"legend-line\";\n            lLineOpacity.htmlFor = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            lLineOpacity.innerHTML = this.labels[\"line-opacity\"];\n            var inputLineOpacity = document.createElement(\"input\");\n            inputLineOpacity.className = \"legend-styling\";\n            inputLineOpacity.id = this.id ? \"line-opacity-\" + this.id : \"line-opacity\";\n            inputLineOpacity.title = params.values.opacity;\n            inputLineOpacity.type = \"range\";\n            inputLineOpacity.min = \"0\";\n            inputLineOpacity.max = \"1\";\n            inputLineOpacity.step = \"0.1\";\n            inputLineOpacity.defaultValue = params.values.opacity;\n            inputLineOpacity.setAttribute(\"data-id\", \"line-opacity\");\n            if (inputLineOpacity.addEventListener) {\n                inputLineOpacity.addEventListener(\"change\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputLineOpacity.attachEvent) {\n                inputLineOpacity.attachEvent(\"onchange\", function (e) {\n                    logger.trace(e);\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            lineopacity.appendChild(lLineOpacity);\n            lineopacity.appendChild(inputLineOpacity);\n            container.appendChild(lineopacity);\n        }\n\n        // couleur de remplissage\n        function createFillColor () {\n            var fillcolor = document.createElement(\"div\");\n            fillcolor.className = \"legend-styling-div\";\n            var lFillColor = document.createElement(\"label\");\n            lFillColor.className = \"legend-fill\";\n            lFillColor.htmlFor = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            lFillColor.innerHTML = this.labels[\"fill-color\"];\n            var inputFillColor = document.createElement(\"input\");\n            inputFillColor.className = \"legend-styling\";\n            inputFillColor.id = this.id ? \"fill-color-\" + this.id : \"fill-color\";\n            inputFillColor.title = \"Selectionner une couleur de remplissage\";\n            inputFillColor.type = \"color\";\n            inputFillColor.value = params.values.color;\n            inputFillColor.setAttribute(\"data-id\", \"fill-color\");\n            if (inputFillColor.addEventListener) {\n                inputFillColor.addEventListener(\"change\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillColor.attachEvent) {\n                inputFillColor.attachEvent(\"onchange\", function (e) {\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        color : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillcolor.appendChild(lFillColor);\n            fillcolor.appendChild(inputFillColor);\n            container.appendChild(fillcolor);\n        }\n\n        // opacité du remplissage\n        function createFillOpacity () {\n            var fillopacity = document.createElement(\"div\");\n            fillopacity.className = \"legend-styling-div\";\n            var lFillOpacity = document.createElement(\"label\");\n            lFillOpacity.className = \"legend-fill\";\n            lFillOpacity.htmlFor = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            lFillOpacity.innerHTML = this.labels[\"fill-opacity\"];\n            var inputFillOpacity = document.createElement(\"input\");\n            inputFillOpacity.className = \"legend-styling\";\n            inputFillOpacity.id = this.id ? \"fill-opacity-\" + this.id : \"fill-opacity\";\n            inputFillOpacity.title = params.values.opacity;\n            inputFillOpacity.type = \"range\";\n            inputFillOpacity.min = \"0\";\n            inputFillOpacity.max = \"1\";\n            inputFillOpacity.step = \"0.1\";\n            inputFillOpacity.defaultValue = params.values.opacity;\n            inputFillOpacity.setAttribute(\"data-id\", \"fill-opacity\");\n            if (inputFillOpacity.addEventListener) {\n                inputFillOpacity.addEventListener(\"change\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            } else if (inputFillOpacity.attachEvent) {\n                inputFillOpacity.attachEvent(\"onchange\", function (e) {\n                    e.target.title = e.target.value;\n                    self._renderThumbnail(params.type, Object.assign(params.values, {\n                        opacity : e.target.value\n                    }));\n                    self.onChangeValueLegendMapBox(e);\n                });\n            }\n            fillopacity.appendChild(lFillOpacity);\n            fillopacity.appendChild(inputFillOpacity);\n            container.appendChild(fillopacity);\n        }\n\n        return container;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     *\n     * @returns {Object} - Legend instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Is editable\n     *\n     * @returns {Boolean} - true/false\n     */\n    isEditable () {\n        return this.editable;\n    }\n\n    /**\n     * Get container Legend Render (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendRender legend-(line|fill|background|text|icon|circle|unknow)\" style=\"...\"></div>\n     */\n    getRenderContainer () {\n        return this.rendercontainer;\n    }\n\n    /**\n     * Get container Legend Tools (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     * @see Layer.prototype.slotLegend()\n     * @example\n     *  <div class=\"GPEditorMapBoxLegendToolsContainer\">...</div>\n     */\n    getToolsContainer () {\n        return this.toolscontainer;\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onclickedition\n     */\n    onEditionLegendMapBox (e) {\n        logger.trace(\"onEditionLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onclickedition, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Legend#editor:legend:onchangevalue\n     */\n    onChangeValueLegendMapBox (e) {\n        logger.trace(\"onChangeValueLegendMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.legend.onchangevalue, e);\n    }\n\n};\n\n// ################################################################### //\n// ########################## CONSTANTES ############################# //\n// ################################################################### //\n\n/**\n * List of supported properties\n */\nLegend.PROPERTIES = {\n    line : [\n        \"line-color\",\n        \"line-dasharray\",\n        \"line-opacity\",\n        \"line-width\"\n    ],\n    fill : [\n        \"fill-color\",\n        \"fill-opacity\",\n        \"fill-outline-color\",\n        \"fill-pattern\"\n    ],\n    background : [\n        \"background-color\",\n        \"background-opacity\",\n        \"background-pattern\"\n    ],\n    circle : [\n        \"circle-color\",\n        \"circle-opacity\",\n        \"circle-stroke-color\",\n        \"circle-stroke-opacity\",\n        \"circle-stroke-width\"\n    ],\n    icon : [\n        \"icon-color\",\n        \"icon-image\",\n        \"icon-opacity\",\n        \"__icon-size\"\n    ],\n    text : [\n        \"__text-anchor\",\n        \"text-color\",\n        \"text-field\",\n        \"__text-font\",\n        \"__text-opacity\",\n        \"__text-size\"\n    ]\n};\n\nexport default Legend;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Style from \"./Style\";\nimport Legend from \"./Legend\";\nimport Filter from \"./Filter\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-layer\");\n\n/**\n * @classdesc\n *\n * MapBox filter management\n *\n * @constructor\n * @alias ol.style.editor.Layer\n * @param {Object} options - options for function call.\n * @example\n *   var layers = new Layer ({\n *      target : ...,\n *      position : 1, // identifiant de position (unique !)\n *      tools : {\n *          \"visibility\" : true, // afficher l'icone de visibilité\n *          \"icon\" : {\n *              \"image\" : true, // afficher l'icone \"oeil\" (defaut) ou une checkbox\n *              \"anchor\" : \"start\" | \"end\"  // afficher l'icone au debut ou à la fin (defaut)\n *          },\n *          \"type\" : true,       // afficher l'icone du type de geometrie\n *          \"pin\" : true,        // afficher l'icone de puce\n *          \"remove\" : false,    // TODO afficher l'icone de suppression\n *          \"clone\" : false      // TODO afficher l'icone de duplication\n *      },\n *      obj : {\n *          \"id\": \"ocs - vegetation\", // MANDATORY\n *          \"type\": \"fill\", // OPTIONAL\n *          \"source\": \"pyramide_proto\", // OPTIONAL\n *          \"source-layer\": \"ocs_vegetation_surf\" // OPTIONAL\n *      }\n *   });\n *  layers.addLegend(oLegend);\n *  layers.slotLegend();\n *  layers.addStyle(oStyle);\n *  layers.addFilter(oFilter);\n *  layers.add();\n *  layers.active(false);\n *  layers.visibility(false);\n *  layers.display(false);\n *  layers.collapse();\n *  EventBus.addEventListener(\"editor:layer:onclickvisibility\", function (e) {\n *     // e.target.data : options !\n *     // e.target.editorID : id or null\n *   }, this);\n */\nclass Layer {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Layer\", options);\n\n        // options\n        this.options = options || {};\n\n        if (!(this instanceof Layer)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    // ################################################################### //\n    // ##################### private methods ############################# //\n    // ################################################################### //\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null; // null si le layer n'appartient pas à un editeur !\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.position) {\n            this.options.position = 0;\n        }\n\n        var _toolsDefault = {\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            type : true,\n            pin : true,\n            remove : false, // TODO\n            clone : false // TODO\n        };\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        var _objDefault = {\n            id : \"\",\n            type : \"\", // icone sur le type de geometrie\n            source : \"\",\n            \"source-layer\" : \"\"\n        };\n\n        if (!this.options.obj) {\n            this.options.obj = _objDefault;\n        }\n\n        Utils.mergeParams(this.options.obj, _objDefault, false);\n\n        // legende intégrée\n        this.bSlotLegend = false;\n\n        // obj\n        this.oFilter = null;\n        this.oStyle = null;\n        this.oLegend = null;\n\n        // dom\n        this.container = null;\n        this.DomVisibility = null;\n        this.DomToggle = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxLayerTarget\",\n            container : \"GPEditorMapBoxLayerContainer\",\n            containerlegend : \"GPEditorMapBoxLayerLegendContainer\",\n            containertitle : \"GPEditorMapBoxLayerTitleContainer\",\n            imagelabelinput : \"GPEditorMapBoxLayerImageInput\",\n            imagelabel : \"GPEditorMapBoxLayerImageLabel\",\n            typeimg : \"GPEditorMapBoxLayerTypeImage\",\n            titleinput : \"GPEditorMapBoxLayerTitleInput\",\n            titlelabel : \"GPEditorMapBoxLayerTitleLabel\",\n            containertools : \"GPEditorMapBoxToolsContainer\",\n            visibilityinput : \"GPEditorMapBoxToolsVisibilityInput\",\n            visibilitylabel : \"GPEditorMapBoxToolsVisibilityLabel\",\n            visibilityinputdisable : \"GPEditorMapBoxToolsVisibilityInputDisable\",\n            visibilitylabeldisable : \"GPEditorMapBoxToolsVisibilityLabelDisable\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * // >> Titre 1          |OOO| <- menu tools : visibility, clone, remove\n     * // >> Titre 2          |OXX| <- affichage configurable (cf. options.tools)\n     * // Event : clic sur le titre -> ex. affiche le menu des styles / filtres\n     * //       : clic visibility, clone, remove\n     * // DOM :\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-45\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <input id=\"GPEditorMapBoxLayerImageInput-45\" class=\"GPEditorMapBoxLayerImageInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\" for=\"GPEditorMapBoxLayerImageInput-45\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-45\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-45\" title=\"...\">...</label>\n     *          </div>\n     *          <div id=\"GPEditorMapBoxToolsContainer-45\" class=\"GPEditorMapBoxToolsContainer\">\n     *              <input id=\"GPEditorMapBoxToolsVisibilityInput-45\" type=\"checkbox\" class=\"GPEditorMapBoxToolsVisibilityInput\">\n     *              <label for=\"GPEditorMapBoxToolsVisibilityInput-45\" id=\"GPEditorMapBoxToolsVisibilityLabel-45\" class=\"GPEditorMapBoxToolsVisibilityLabel\" title=\"Afficher/masquer la couche\"></label>\n     *          </div>\n     *      </div>\n     */\n    _initContainer () {\n        // contexte\n        var self = this;\n\n        var obj = this.options.obj;\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // title\n        var divTitle = document.createElement(\"div\");\n        divTitle.id = this.name.containertitle + \"-\" + this.options.position;\n        divTitle.className = this.name.containertitle;\n\n        // puce\n        if (this.options.tools.pin) { // Optionnel !\n            // input\n            var inputImage = document.createElement(\"input\");\n            inputImage.id = this.name.imagelabelinput + \"-\" + this.options.position;\n            inputImage.className = this.name.imagelabelinput;\n            inputImage.type = \"checkbox\";\n            divTitle.appendChild(inputImage);\n            // puce\n            var labelImage = document.createElement(\"label\");\n            labelImage.className = this.name.imagelabel;\n            labelImage.htmlFor = inputImage.id;\n            if (labelImage.addEventListener) {\n                labelImage.addEventListener(\"click\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            } else if (labelImage.attachEvent) {\n                labelImage.attachEvent(\"onclick\", function (e) {\n                    self.onClickLayerMapBox(e);\n                });\n            }\n            divTitle.appendChild(labelImage);\n        }\n\n        // tools :\n        // visibility, (remove, clone)\n        var _addTools = function () {\n            var divTools = document.createElement(\"div\");\n            divTools.id = this.name.containertools + \"-\" + this.options.position;\n            divTools.className = this.name.containertools;\n\n            // visibility\n            if (this.options.tools.visibility) {\n                var inputTools = document.createElement(\"input\");\n                inputTools.id = this.name.visibilityinput + \"-\" + this.options.position;\n                inputTools.className = (this.options.tools.icon.image) ? this.name.visibilityinput : this.name.visibilityinputdisable;\n                inputTools.type = \"checkbox\";\n                inputTools.checked = \"checked\"; // par défaut, à modifier via visibility(true|false) !\n\n                // event for visibility change\n                if (inputTools.addEventListener) {\n                    inputTools.addEventListener(\"click\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                } else if (inputTools.attachEvent) {\n                    // internet explorer\n                    inputTools.attachEvent(\"onclick\", function (e) {\n                        self.onVisibilityLayerMapBox(e);\n                    });\n                }\n                divTools.appendChild(inputTools);\n                // enregistrement utile pour la méthode : visibility()\n                this.DomVisibility = inputTools;\n\n                var labelTools = document.createElement(\"label\");\n                labelTools.htmlFor = this.name.visibilityinput + \"-\" + this.options.position;\n                labelTools.id = this.name.visibilitylabel + \"-\" + this.options.position;\n                labelTools.className = (this.options.tools.icon.image) ? this.name.visibilitylabel : this.name.visibilitylabeldisable;\n                labelTools.title = \"Afficher/masquer la couche\";\n                divTools.appendChild(labelTools);\n\n                div.appendChild(divTools);\n            }\n\n            // clone\n            if (this.options.tools.clone) {\n                // TODO...\n                logger.warn(\"Dom for tools clone, it's not yet implemented !\");\n            }\n\n            // remove\n            if (this.options.tools.remove) {\n                // TODO...\n                logger.warn(\"Dom for tools remove, it's not yet implemented !\");\n            }\n        };\n\n        // ajout des outils au debut du composant\n        if (this.options.tools.icon.anchor === \"start\") {\n            _addTools.apply(this);\n        }\n\n        // type\n        if (this.options.tools.type && obj.type) { // Optionnel !\n            var imgType = document.createElement(\"img\");\n            imgType.className = this.name.typeimg;\n            // FIXME il faudrait faire la difference entre :\n            // - icone uniquement : SYMBOL-ICON\n            // - texte uniquement : SYMBOL-TEXT\n            // - les 2 : SYMBOL\n            // Mais il nous faut les styles complets (paint & layout)\n            // pour determiner les 3 types !\n            switch (obj.type.toUpperCase()) {\n                case \"SYMBOL-ICON\": // not used !\n                    imgType.style[\"background-position\"] = \"0px 0\";\n                    break;\n                case \"SYMBOL-TEXT\": // not used !\n                    imgType.style[\"background-position\"] = \"-194px 0\";\n                    break;\n                case \"SYMBOL\":\n                    imgType.style[\"background-position\"] = \"-84px 0\";\n                    break;\n                case \"LINE\":\n                    imgType.style[\"background-position\"] = \"-28px 0\";\n                    break;\n                case \"FILL\":\n                    imgType.style[\"background-position\"] = \"-56px 0\";\n                    break;\n                case \"BACKGROUND\":\n                    imgType.style[\"background-position\"] = \"-140px 0\";\n                    break;\n                case \"CIRCLE\":\n                    imgType.style[\"background-position\"] = \"-168px 0\";\n                    break;\n                default:\n                    // type inconnu ou non pris en charge ou par defaut\n                    imgType.style[\"background-position\"] = \"-112px 0\";\n            }\n            divTitle.appendChild(imgType);\n        }\n\n        // container legend (empty)\n        var divLegend = document.createElement(\"div\");\n        divLegend.id = this.name.containerlegend + \"-\" + this.options.position;\n        divLegend.className = this.name.containerlegend;\n        divTitle.appendChild(divLegend);\n\n        // input\n        var inputTitle = document.createElement(\"input\");\n        inputTitle.id = this.name.titleinput + \"-\" + this.options.position;\n        inputTitle.className = this.name.titleinput;\n        inputTitle.type = \"checkbox\";\n        divTitle.appendChild(inputTitle);\n\n        // label for\n        var labelTitle = document.createElement(\"label\");\n        labelTitle.className = this.name.titlelabel;\n        labelTitle.htmlFor = inputTitle.id;\n        labelTitle.innerHTML = obj[\"id\"] || obj[\"source-layer\"] || obj[\"source\"];\n        labelTitle.title = obj[\"source-layer\"] || obj[\"source\"] || obj[\"id\"];\n        if (labelTitle.addEventListener) {\n            labelTitle.addEventListener(\"click\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        } else if (labelTitle.attachEvent) {\n            labelTitle.attachEvent(\"onclick\", function (e) {\n                self.onClickLayerMapBox(e);\n            });\n        }\n        divTitle.appendChild(labelTitle);\n        // enregistrement utile pour la méthode : collapse()\n        this.DomToggle = labelTitle;\n\n        div.appendChild(divTitle);\n\n        // ajout des outils au fin du composant\n        if (this.options.tools.icon.anchor === \"end\") {\n            _addTools.apply(this);\n        }\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Layer instance\n     */\n    add () {\n        logger.trace(\"add()\");\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Add style in the submenu\n     *\n     * @param {Object} style - style object\n     */\n    addStyle (style) {\n        logger.trace(\"addStyle()\", style);\n        if (style && typeof style === \"object\" && style instanceof Style) {\n            this.oStyle = style;\n            this.oStyle.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add filter in the submenu\n     *\n     * @param {Object} filter - filter object\n     */\n    addFilter (filter) {\n        logger.trace(\"addFilter()\", filter);\n        if (filter && typeof filter === \"object\" && filter instanceof Filter) {\n            this.oFilter = filter;\n            this.oFilter.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Add Legend in the submenu\n     *\n     * @param {Object} legend - legend object\n     */\n    addLegend (legend) {\n        logger.trace(\"addLegend()\", legend);\n        if (legend && typeof legend === \"object\" && legend instanceof Legend) {\n            this.oLegend = legend;\n            this.oLegend.display(false); // par defaut !\n        }\n    }\n\n    /**\n     * Integrate Legend to the layer container\n     */\n    slotLegend () {\n        // cas particulier :\n        // on souhaite intégrer une partie de la legende dans le container du layer.\n        var legend = this.oLegend;\n        if (legend) {\n            // FIXME c'est pourri...\n            var node = null;\n            var nodesLvl1 = this.container.childNodes;\n            if (nodesLvl1.length) {\n                // selon où se situe l'icone de visibilité : au debut ou à la fin...\n                var idx = (this.options.tools.icon.anchor === \"start\") ? 1 : 0;\n                var nodesLvl2 = nodesLvl1[idx].childNodes;\n                // on recherche le container de la legende\n                for (var i = 0; i < nodesLvl2.length; i++) {\n                    var curnode = nodesLvl2[i];\n                    if (curnode.id.indexOf(this.name.containerlegend) !== -1) {\n                        node = curnode;\n                    }\n                }\n            }\n            if (node) {\n                var render = legend.getRenderContainer();\n                if (render) {\n                    node.appendChild(render);\n                    // legende intégrée\n                    this.bSlotLegend = true;\n                }\n            }\n        }\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Set visibility or get\n     *\n     * @param {Boolean} display - set visibility or undefined to get status\n     * @returns {Boolean} - true/false\n     */\n    visibility (display) {\n        logger.trace(\"visibility()\", display);\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        if (typeof display !== \"undefined\") {\n            this.DomVisibility.checked = (display) ? \"checked\" : \"\";\n        }\n        return this.DomVisibility.checked;\n    }\n\n    /**\n    * Collapse a layer panel (event)\n    */\n    collapse () {\n        logger.trace(\"collapse()\");\n        this.DomToggle.click();\n    }\n\n    /**\n    * Click on visibility icon (event)\n    */\n    visible () {\n        logger.trace(\"visible()\");\n        if (!this.options.tools.visibility) {\n            return;\n        }\n        this.DomVisibility.click();\n    }\n\n    /**\n     * Set collapse or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        var checked = document.getElementById(this.DomToggle.htmlFor).checked;\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"inline-flex\" : \"none\";\n            if (this.oStyle) {\n                this.oStyle.display(display && checked);\n            }\n            if (this.oFilter) {\n                this.oFilter.display(display && checked);\n            }\n            if (this.oLegend) {\n                this.oLegend.display(display && checked);\n            }\n        }\n        return checked;\n    }\n\n    /**\n     * Set disabled/enabled status or get\n     *\n     * @param {Boolean} active - disable/enable layer interaction or get status\n     * @returns {Boolean} - true/false\n     */\n    active (active) {\n        logger.trace(\"active()\", active);\n        if (typeof active !== \"undefined\") {\n            this.container.className = (active)\n                ? this.name.container\n                : this.name.container + \" disabled\";\n        }\n        return (this.container.className === this.name.container);\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     */\n    onClickLayerMapBox (e) {\n        logger.trace(\"onClickLayerMapBox\", e);\n\n        var id = e.target.htmlFor.substring(e.target.htmlFor.indexOf(\"-\"));\n        var checked = document.getElementById(e.target.htmlFor).checked;\n\n        // gestion des inputs\n        if (e.target.htmlFor === this.name.imagelabelinput + id) {\n            document.getElementById(this.name.titleinput + id).checked = !checked;\n        }\n        if (e.target.htmlFor === this.name.titleinput + id) {\n            // si options.pin:false, ce DOM n'existe pas !\n            if (document.getElementById(this.name.imagelabelinput + id)) {\n                document.getElementById(this.name.imagelabelinput + id).checked = !checked;\n            }\n        }\n\n        // ouverture du panneau des styles / filtres\n        if (this.oStyle) {\n            this.oStyle.display(!checked);\n        }\n        if (this.oFilter) {\n            this.oFilter.display(!checked);\n        }\n        // attention,\n        // si la legende est non editable, elle ne se trouve pas dans le sous menu !\n        if (this.oLegend && this.oLegend.isEditable()) {\n            this.oLegend.display(!checked);\n        }\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickvisibility\n     */\n    onVisibilityLayerMapBox (e) {\n        logger.trace(\"onVisibilityLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickvisibility, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickclone\n     */\n    onCloneLayerMapBox (e) {\n        logger.trace(\"onCloneLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickclone, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Layer#editor:layer:onclickremove\n     */\n    onRemoveLayerMapBox (e) {\n        logger.trace(\"onRemoveLayerMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.layer.onclickremove, e);\n    }\n\n};\n\nexport default Layer;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-group\");\n\n/**\n * @classdesc\n *\n * MapBox group management\n *\n * @constructor\n * @alias ol.style.editor.Group\n * @param {Object} options - options for function call.\n * @example\n *   var group = new Group ({\n *      title : \"MyGroup\",\n *      collapse : true, // plier/deplier\n *      target : ...\n *   });\n *   group.add();\n *   group.add();\n */\nclass Group {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Group\", options);\n\n        // options\n        this.options = options || {\n            // default...\n        };\n\n        if (!(this instanceof Group)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        if (!this.options.title) {\n            // cf. summary\n            this.options.title = \"Détails du groupe...\";\n        }\n\n        // plier par defaut\n        if (typeof this.options.collapse === \"undefined\") {\n            this.options.collapse = true;\n        }\n\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxGroupTarget\",\n            container : \"GPEditorMapBoxGroupContainer\",\n            details : \"GPEditorMapBoxGroupDetails\",\n            summary : \"GPEditorMapBoxGroupSummary\"\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxGroupContainer\">...</div>\n     */\n    _initContainer () {\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // FIXME pas compatible IE !\n        // https://caniuse.com/#search=details\n        // cf. https://css-tricks.com/quick-reminder-that-details-summary-is-the-easiest-way-ever-to-make-an-accordion/\n        var details = document.createElement(\"details\");\n        details.className = this.name.details;\n        details.open = !this.options.collapse;\n        div.appendChild(details);\n\n        var summary = document.createElement(\"summary\");\n        summary.className = this.name.summary;\n        summary.innerHTML = this.options.title;\n        details.appendChild(summary);\n\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"flex\" : \"none\";\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        var nodes = this.container.childNodes;\n        if (nodes.length) {\n            // retourne le noeud \"details\" !\n            return nodes[0];\n        }\n        // sinon le container principal\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form\n     *\n     * NOT USED !\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Group#editor:group:oncollapse\n     */\n    onCollapseGroupMapBox (e) {\n        logger.trace(\"onCollapseGroupMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.group.oncollapse, e);\n    }\n\n};\n\nexport default Group;\n","import EventBus from \"eventbusjs\";\nimport EventEditor from \"./Event\";\nimport Utils from \"../../Utils/Helper\";\nimport Logger from \"../../Utils/LoggerByDefault\";\n\nvar logger = Logger.getLogger(\"editor-search\");\n\n/**\n * @classdesc\n *\n * TODO MapBox search management\n *\n * @constructor\n * @alias ol.style.editor.Search\n * @param {Object} options - options for function call.\n * @todo\n * @example\n *   var Search = new Search ({\n *      target : ...,\n *      tools : {\n *          // ...\n *      }\n *      title : \"Filtres de recherche :\",\n *      obj : {}\n *   });\n *  Search.add();\n *  Search.display(true);\n *  Search.getContainer();\n */\nclass Search {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Search\", options);\n\n        // options\n        this.options = options || {\n            // default...\n            target : null,\n            tools : null,\n            title : null,\n            obj : null\n        };\n\n        if (!(this instanceof Search)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n\n        this._initContainer();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // unique editor id (optional!)\n        this.id = this.options.id || null;\n\n        if (!this.options.target) {\n            // cf. add()\n        }\n\n        var _toolsDefault = {};\n\n        if (!this.options.tools) {\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        if (!this.options.obj) {\n            // choix d'avoir un objet vide pour une edition futur...\n            this.options.obj = {};\n        }\n\n        if (!this.options.title) {\n            this.options.title = \"Recherche de couches :\";\n        }\n        this.container = null;\n\n        // DOM : className or id\n        this.name = {\n            target : \"GPEditorMapBoxSearchTarget\",\n            container : \"GPEditorMapBoxSearchContainer\"\n            // TODO ...\n        };\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @private\n     * @example\n     * <div class=\"GPEditorMapBoxSearchContainer\">\n     *  // ...\n     * </div>\n     */\n    _initContainer () {\n        // contexte\n        // var self = this;\n        var _search = JSON.parse(JSON.stringify(this.options.obj)); // on manipule une copie  !\n\n        if (_search.layers) {\n            if (_search.layers.length === 0) {\n                logger.info(\"tag 'layers' is empty !\");\n            }\n        }\n\n        var div = document.createElement(\"div\");\n        div.className = this.name.container;\n\n        // TODO...\n        // outil de recherche des couches mapbox.\n        // 2 modes de recherches : exact ou par autocompletion\n        // affichage des resultats directement dans la liste des couches\n        // la recherche porte sur les champs suiavnts (options):\n        // * id (par defaut)\n        // * source-layer (par defaut)\n        // * type (ex. Symbol)\n        // * field (ex. HOPITAL_PONC) > recherche dans le champs filtre\n        // main container\n        this.container = div;\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Add element into target DOM\n     * @returns {Object} - Search instance\n     */\n    add () {\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var div = document.createElement(\"div\");\n                div.id = this.name.target;\n                var node = document.documentElement ||\n                    document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0];\n                node.appendChild(div);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        return this;\n    }\n\n    /**\n     * Set display container or get\n     *\n     * @param {Boolean} display - show/hidden container or get status\n     * @returns {Boolean} - true/false\n     */\n    display (display) {\n        logger.trace(\"display()\", display);\n        if (typeof display !== \"undefined\") {\n            this.container.style.display = (display) ? \"flex\" : \"none\";\n        }\n        return (this.container.style.display === \"flex\");\n    }\n\n    /**\n     * Get container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    // ################################################################### //\n    // ####################### handlers events to dom #################### //\n    // ################################################################### //\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onsubmit\n     */\n    onSubmitSearchLayersMapBox (e) {\n        logger.trace(\"onSubmitSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onsubmit, e);\n    }\n\n    /**\n     * this method is called by event '' on '' tag form...\n     *\n     * 'e' contains the option object into 'e.target.data' !\n     * 'e' contains the id editor into 'e.target.editorID' !\n     *\n     * @param {Object} e - HTMLElement\n     * @private\n     * @fires Search#editor:search:onautocomplete\n     */\n    onAutocompleteSearchLayersMapBox (e) {\n        logger.trace(\"onAutocompleteSearchLayersMapBox\", e);\n        e.editorID = this.id;\n        e.data = this.options;\n        EventBus.dispatch(EventEditor.search.onautocomplete, e);\n    }\n\n};\n\nexport default Search;\n","var EditorDOM = {\n\n    /**\n    * Add uuid to the tag ID\n    * @param {String} id - id selector\n    * @returns {String} uid - id selector with an unique id\n    */\n    _addUID : function (id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    }\n};\n\nexport default EditorDOM;\n","// import CSS\nimport \"../../CSS/Controls/Editor/GPFeditor.css\";\n// import \"../../CSS/Controls/Editor/GPFeditorStyle.css\";\n// import library\nimport EventBus from \"eventbusjs\";\n// import local\nimport Utils from \"../../Utils/Helper\";\nimport ID from \"../../Utils/SelectorID\";\nimport Logger from \"../../Utils/LoggerByDefault\";\nimport Style from \"./Style\";\nimport Themes from \"./Themes\";\nimport Filter from \"./Filter\";\nimport Legend from \"./Legend\";\nimport Layer from \"./Layer\";\nimport Group from \"./Group\";\nimport Event from \"./Event\";\nimport Search from \"./Search\";\n\n// DOM\nimport EditorDOM from \"./EditorDOM\";\n\nvar logger = Logger.getLogger(\"editor\");\n\n/**\n * @classdesc\n *\n * Editor Styles MapBox...\n *\n * @constructor\n * @alias ol.style.Editor\n * @param {Object} options - options for function call.\n * @fires editor:layer:onclickvisibility\n * @fires editor:layer:onclickclone\n * @fires editor:layer:onclickremove\n * @fires editor:style:oneditjson\n * @fires editor:style:scale:onchangemin\n * @fires editor:style:scale:onchangemax\n * @fires editor:legend:onclickedition\n * @fires editor:legend:onchangevalue\n * @fires editor:filter:oneditjson\n * @fires editor:themes:onclickimage\n * @fires editor:themes:onclicktitle\n * @fires editor:group:oncollapse\n * @fires editor:onloaded\n * @example\n *   var editor = new Editor ({\n *      target : \"\",\n *      style : \"data/styles/layer.json\",\n *      themes: {\n *          themesSummary : \"\",\n *          themes : [{\n *             \"thumbnail\": \"data/images/layer0.png\",\n *             \"name\": \"standard0\",\n *             \"url\": \"data/styles/layer0.json\",\n *             \"description\": \"\",\n *             \"selected\" : true\n *          },{\n *             \"thumbnail\": \"data/images/layer1.png\",\n *             \"name\": \"standard1\",\n *             \"url\": \"data/styles/layer1.json\",\n *             \"description\": \"\"\n *          }]\n *      },\n *      scope : this,\n *      events : {\n *          \"editor:layer:onclickvisibility\" : ...,\n *          \"editor:layer:onclickclone\" : ...,\n *          \"editor:layer:onclickremove\" : ...,\n *          \"editor:style:oneditjson\" : ...,\n *          \"editor:style:scale:onchangemin\" : ...,\n *          \"editor:style:scale:onchangemax\" : ...,\n *          \"editor:filter:oneditjson\" : ...,\n *          \"editor:themes:onclickimage\" : this._onClickEventImageTheme(),\n *          \"editor:themes:onclicktitle\" : function(e) {...}\n *      },\n *      tools : {\n *          // afficher/cacher les themes (par defaut) ou utiliser les options\n *          themes : true | false | {\n *              target : \"...\",\n *              tools : {\n *                  \"thumbnails\": true,\n *                  \"button\": { visible : true, type : \"checkbox\" }\n *              },\n *          },\n *          layers : true | false,     // afficher les couches (layers)\n *          search : true | false,     // TODO : afficher l'outil de recheche de couches\n *          style : true | false,      // afficher les styles (sous menu layers)\n *          filter : true | false,     // afficher les filtres (sous menu layers)\n *          legend : true | false,     // afficher les legendes (layers)\n *          group : true | false,      // grouper les couches, l'option 'sort' doit être activée (layers)\n *          groupAuto : true | false,  // definir la construction automatiques des groupes\n *          sort : true | false,       // trier les couches (layers)\n *          sortBy : \"id|class|geom\",  // definir le type de tri (layers)\n *          sortOrder : \"asc, desc\",   // definir l'ordre de tri (layers)\n *          title : true | false       // afficher les titres des rubriques,\n *          collapse : true | false | undefined // afficher et/ou plier les couches ou ne pas afficher l'option,\n *          type : true | false,       // afficher le type de geometrie (layers)\n *          pin : true | false,        // afficher la puce pour chaque couche (layers)\n *          visibility : true | false, // afficher l'icone de visibilité (layers),\n *          icon : {                   // afficher l'icone \"oeil\" ou \"checkbox\" (layers),\n *              \"image\" : true,\n *              \"anchor\" : \"start\" // afficher l'icone au debut ou à la fin de la ligne\n *          },\n *          editable : true | false    // active l'edition de la legende (legendes)\n *      }\n *   });\n *   // options par defaut\n *   {\n *      themes : false,\n *      layers : true,\n *      search : false,\n *      style : false,\n *      filter : false,\n *      legend : false,\n *      group : false,\n *      groupAuto : false,\n *      sort : true,\n *      sortBy : \"id\",\n *      sortOrder : \"asc\",\n *      title : true,\n *      collapse : undefined,\n *      type : true,\n *      pin : true,\n *      visibility : true,\n *      icon : {\n *          image : true,\n *          anchor : \"end\"\n *      },\n *      editable : true\n *   }\n *   // Context\n *   editor.setContext(\"map\", map);\n *   editor.setContext(\"layer\", layer);\n *   // create DOM\n *   editor.createElement()\n *     .then(() => {\n *       console.warn(editor.getID());\n *       console.log(this.getContext(\"map\"));\n *       console.log(this.getContext(\"layer\"));\n *     })\n *     .catch(error => {});\n *   // possibility to add listeners with globale variable : eventbus\n *   eventbus.addEventListener(\"editor:style:scale:onchangemin\", function (e) {...});\n */\nclass Editor {\n\n    constructor (options) {\n        logger.trace(\"[constructor] Editor\", options);\n\n        // options\n        this.options = options || {\n            // TODO default...\n        };\n\n        if (!(this instanceof Editor)) {\n            throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n        }\n\n        this._initialize();\n    }\n\n    /**\n     * Initialize component\n     * (called by constructor)\n     *\n     * @private\n     */\n    _initialize () {\n        // gestion des options\n        if (!this.options.target) {\n            logger.info(\"La 'target' n'est pas renseignée (options.target).\");\n        }\n\n        if (!this.options.style) {\n            logger.error(\"Le 'style' MapBox n'est pas renseigné (options.style) !\");\n            return;\n        }\n\n        if (this.options.events) {\n            this._initEvents();\n        } else {\n            logger.warn(\"Les 'handlers' ne sont pas renseignés (options.events) !\");\n        }\n\n        if (!this.options.themes) {\n            logger.info(\"Les 'themes' MapBox ne sont pas renseignés (options.themes).\");\n        }\n\n        // options par defaut\n        var _toolsDefault = {\n            themes : false,\n            layers : true,\n            search : false,\n            style : false,\n            filter : false,\n            legend : false,\n            group : false,\n            groupAuto : false,\n            sort : true,\n            sortBy : \"id\",\n            sortOrder : \"asc\",\n            title : true,\n            collapse : undefined,\n            type : true,\n            pin : true,\n            visibility : true,\n            icon : {\n                image : true,\n                anchor : \"end\"\n            },\n            editable : true\n        };\n\n        if (!this.options.tools) {\n            logger.trace(\"Utilisation des outils MapBox par défaut (options.tools).\");\n            this.options.tools = _toolsDefault;\n        }\n\n        Utils.mergeParams(this.options.tools, _toolsDefault, false);\n\n        // id unique\n        this.id = this.options.id || ID.generate();\n\n        // context\n        this.context = {};\n        // property layers\n        this.layers = [];\n        // dom container\n        this.container = null;\n        // dom name\n        this.name = {\n            target : \"GPEditorMapBoxTarget\",\n            container : \"GPEditorMapBoxContainer\",\n            containerID : \"GPEditorMapBoxContainer_ID_\",\n            containerLayers : \"GPEditorMapBoxLayersContainer\",\n            titleLayers : \"GPEditorMapBoxLayersTitle\",\n            titleLayersID : \"GPEditorMapBoxLayersTitle_ID_\",\n            titleThemes : \"GPEditorMapBoxThemesTitle\",\n            titleThemesID : \"GPEditorMapBoxThemesTitle_ID_\",\n            sep : \"GPEditorMapBoxSep\"\n        };\n        // style json\n        this.mapbox = {};\n        // INFO\n        // sprites :\n        // {\n        //     url : null,\n        //     size : {\n        //         h : null,\n        //         w : null\n        //     },\n        //     json : {}\n        // }\n        this.sprites = {};\n    }\n\n    /**\n    * Initialize events with handlers\n    * (called by constructor)\n    *\n    * List Events :\n    *          \"editor:layer:visibility\"\n    *          \"editor:layer:clone\"\n    *          \"editor:layer:remove\"\n    *          \"editor:style:edit\"\n    *          \"editor:style:minScale\"\n    *          \"editor:style:maxScale\"\n    *          \"editor:filter:edit\"\n    *          \"editor:themes:image\",\n    *          \"editor:themes:title\"\n    * @private\n    */\n    _initEvents () {\n        var ctx = this.options.scope || this;\n        var events = this.options.events;\n        if (events) {\n            for (var event in events) {\n                if (events.hasOwnProperty(event)) {\n                    var handler = events[event];\n                    // test sur les events disponibles !\n                    if (handler) {\n                        if (!EventBus.hasEventListener(event, handler, ctx)) {\n                            EventBus.addEventListener(event, handler, ctx);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Graphical rendering of the component\n     * (called by constructor)\n     *\n     * @example\n     *  <div class=\"GPEditorMapBoxContainer\" id=\"GPEditorMapBoxContainer_ID_0\">\n     *    <div id=\"GPEditorMapBoxThemesTitle\" class=\"GPEditorMapBoxThemesTitle\">Liste des 'thèmes'</div>\n     *    <div class=\"GPEditorMapBoxThemesContainer\">\n     *      ...\n     *    </div>\n     *    <div id=\"GPEditorMapBoxLayersTitle\" class=\"GPEditorMapBoxLayersTitle\">Liste des 'couches'</div>\n     *    <div class=\"GPEditorMapBoxLayersContainer\">\n     *      <div class=\"GPEditorMapBoxLayerContainer\">\n     *          <div id=\"GPEditorMapBoxLayerTitleContainer-0_1\" class=\"GPEditorMapBoxLayerTitleContainer\">\n     *              <label class=\"GPEditorMapBoxLayerImageLabel\"></label>\n     *              <input id=\"GPEditorMapBoxLayerTitleInput-0_1\" class=\"GPEditorMapBoxLayerTitleInput\" type=\"checkbox\">\n     *              <label class=\"GPEditorMapBoxLayerTitleLabel\" for=\"GPEditorMapBoxLayerTitleInput-0_1\" title=\"states\">population_lt_2m</label>\n     *          </div>\n     *      </div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *      <div class=\"GPEditorMapBoxLayerContainer\">...</div>\n     *    </div>\n     *  </div>\n     * @private\n     */\n    _initContainer () {\n        logger.trace(this.mapbox);\n\n        // existance d'un autre container (editeur) ?\n        // var _idx = 0;\n        // var elements = document.querySelectorAll(\"div[id^=\" + this.name.containerID + \"]\");\n        // for (var j = 0; j < elements.length; j++) {\n        //     var element = elements[j];\n        //     var num = parseInt(element.id.substring(element.id.lastIndexOf(\"_\") + 1), 10);\n        //     if (num > _idx) {\n        //         _idx = num;\n        //     }\n        // }\n        // if (elements.length) {\n        //     _idx += 1;\n        // }\n        // container principal de l'editeur\n        var div = document.createElement(\"div\");\n        div.id = this.name.containerID + this.id;\n        div.className = this.name.container;\n\n        // Themes\n        var _toolsThemes = this.options.tools.themes;\n        if (_toolsThemes && this.options.themes) {\n            // title\n            if (this.options.tools.title) {\n                var titleThemes = document.createElement(\"div\");\n                titleThemes.id = this.name.titleThemesID + this.id;\n                titleThemes.className = this.name.titleThemes;\n                titleThemes.innerHTML = \"Liste des 'thèmes'\";\n                div.appendChild(titleThemes);\n            }\n\n            // lien vers les styles\n            var themes = new Themes({\n                id : this.id,\n                target : div,\n                tools : (typeof _toolsThemes === \"object\") ? _toolsThemes : {},\n                obj : this.options.themes\n            });\n            themes.add();\n        }\n\n        // TODO : Recheche / filtre de couches\n        if (this.options.tools.search) {\n            var search = new Search({\n                id : this.id,\n                target : div,\n                tools : {},\n                obj : this.mapbox.layers // liste des objets layers\n            });\n            search.add();\n        }\n\n        for (var source in this.mapbox.sources) {\n            if (this.mapbox.sources.hasOwnProperty(source)) {\n                if (this.options.tools.layers) {\n                    // multisources ? Si oui, on renseigne un titre...\n                    var multisources = (Object.keys(this.mapbox.sources).length > 1) ? 1 : 0;\n                    if (multisources) {\n                        var hr = document.createElement(\"hr\");\n                        hr.className = this.name.sep;\n                        div.appendChild(hr);\n                    }\n                    // title\n                    if (this.options.tools.title) {\n                        var titleLayers = document.createElement(\"div\");\n                        titleLayers.id = this.name.titleLayersID + this.id;\n                        titleLayers.className = this.name.titleLayers;\n                        titleLayers.innerHTML = (multisources) ? \"Liste des 'couches' (\" + source + \")\" : \"Liste des 'couches'\";\n                        div.appendChild(titleLayers);\n                    }\n                }\n\n                // gestion de l'ordre avant tri avec la metadata 'order'\n                var _layers = this.mapbox.layers.slice(); // clone\n\n                // une fois les layers triés, la metadata:geoportail:order permet\n                // de savoir l'emplacement du layers dans le fichier de style.\n                _layers.forEach(function (layer, order) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // ajout de la metadata d'ordre\n                    var _metadata = layer[\"metadata\"];\n                    if (_metadata) {\n                        _metadata[\"geoportail:order\"] = order;\n                    } else {\n                        layer[\"metadata\"] = {\n                            \"geoportail:order\" : order\n                        };\n                    }\n                });\n                // tri des layers\n                if (this.options.tools.sort) {\n                    var sortBy = this.options.tools.sortBy;\n                    var sortOrder = this.options.tools.sortOrder;\n                    var sortFct = function (a, b) {\n                        // si on utilise les groupements utilisateurs, ils doivent\n                        // tous être renseignés sinon..., ça va coincer !\n                        var result = 0;\n                        if (a[\"metadata\"] &&\n                            a[\"metadata\"][\"geoportail:group\"] &&\n                            b[\"metadata\"] &&\n                            b[\"metadata\"][\"geoportail:group\"]) {\n                            var cmpA = null;\n                            var cmpB = null;\n                            cmpA = a[\"metadata\"][\"geoportail:group\"];\n                            cmpB = b[\"metadata\"][\"geoportail:group\"];\n                            result = cmpA.localeCompare(cmpB);\n                        } else {\n                            switch (sortBy) {\n                                case \"geom\":\n                                    result = sortOrder === \"asc\" ? a.type.localeCompare(b.type) || a.id.localeCompare(b.id)\n                                        : b.type.localeCompare(a.type) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"class\":\n                                    result = sortOrder === \"asc\" ? a[\"source-layer\"].localeCompare(b[\"source-layer\"]) || a.id.localeCompare(b.id)\n                                        : b[\"source-layer\"].localeCompare(a[\"source-layer\"]) || b.id.localeCompare(a.id);\n                                    break;\n                                case \"id\":\n                                default:\n                                    // tri sur l'id par defaut\n                                    result = sortOrder === \"asc\" ? a.id.localeCompare(b.id) : b.id.localeCompare(a.id);\n                                    break;\n                            }\n                        }\n                        return result;\n                    };\n\n                    _layers.sort(sortFct);\n                }\n\n                logger.trace(\"Layers : \", _layers);\n\n                // gestion des groupes avec la metadata de groupe\n                var groupBy = this.options.tools.sortBy; // le même type de tri que les couches !\n                var groupAuto = this.options.tools.groupAuto;\n                var _groups = {}; // liste et comptage des layers dans chaque groupes\n                _layers.forEach(function (layer) {\n                    // on écarte les layers sans source: ex. \"background\"\n                    // if (!layer.source) {\n                    //     return;\n                    // }\n                    // balise metadata\n                    var _metadata = layer[\"metadata\"];\n                    // s'il existe déjà une meta de groupe, on l'utilise...\n                    // sinon, on la met en place.\n                    if (_metadata && _metadata[\"geoportail:group\"]) {\n                        var _groupName = _metadata[\"geoportail:group\"];\n                        _groups[_groupName] = (_groups[_groupName])\n                            ? _groups[_groupName] + 1 : 1;\n                    } else {\n                        var _field = null;\n                        switch (groupBy) {\n                            case \"class\":\n                                _field = layer[\"source-layer\"];\n                                break;\n                            case \"geom\":\n                                _field = layer.type;\n                                break;\n                            case \"id\":\n                            default:\n                                _field = layer.id;\n                                break;\n                        }\n                        var _newGroupName = _field;\n                        if (groupAuto) {\n                            // separateur\n                            var _regex = /_|-|:|=/; // TODO à definir via une option !\n\n                            // index\n                            var _idx = _field.search(_regex);\n                            // y'a t il un separateur ?\n                            _newGroupName = (_idx !== -1) ? _field.substring(0, _idx).trim() : _field;\n                        }\n                        // on compte le nombre d'entrée dans un groupe\n                        _groups[_newGroupName] = (_groups[_newGroupName])\n                            ? _groups[_newGroupName] + 1 : 1;\n\n                        // ajout de la metadata de groupe\n                        if (_metadata) {\n                            _metadata[\"geoportail:group\"] = _newGroupName;\n                        } else {\n                            layer[\"metadata\"] = {\n                                \"geoportail:group\" : _newGroupName\n                            };\n                        }\n                    }\n                });\n\n                logger.trace(\"Groups : \", _groups);\n\n                // container principal des couches\n                var divLayers = document.createElement(\"div\");\n                divLayers.className = this.name.containerLayers;\n                div.appendChild(divLayers);\n\n                var details;\n                if (this.options.tools.collapse !== undefined) {\n                    details = document.createElement(\"details\");\n                    details.className = \"\";\n                    details.open = !this.options.tools.collapse;\n                    divLayers.appendChild(details);\n\n                    var summary = document.createElement(\"summary\");\n                    summary.className = \"\";\n                    summary.innerHTML = \"\";\n                    details.appendChild(summary);\n                }\n\n                // container courant (cf. groupe) pour l'ajout des elements\n                var target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n\n                // Ex. Layers, Styles, Groups et Filtres\n                //  \"id\": \"ocs - vegetation\",\n                //  \"type\": \"fill\",\n                //  \"source\": \"pyramide_proto\",\n                //  \"source-layer\": \"ocs_vegetation_surf\",\n                //  \"metadata\" : {\n                //      \"geoportail:group\": \"ocs\"\n                //  },\n                //  \"layout\": {\n                //    \"visibility\": \"visible\"\n                //  },\n                //  \"filter\": [\"in\",\"symbo\",\n                //      \"SURFACE_D_EAU\",\n                //      \"BASSIN\",\n                //      \"ZONE_MARINE\"\n                //  ],\n                //  \"paint\": {\n                //    \"fill-color\": \"#2BB3E1\"\n                //  }\n                var index = -1;\n                for (var ii = 0; ii < _layers.length; ii++) {\n                    var data = _layers[ii];\n                    index++;\n\n                    // traitement dans l'ordre des sources\n                    if (data.source === source) {\n                        // Groups\n                        // INFO la gestion des groupes est basée sur la balise metadata::geoportail:group\n                        // ainsi que sur l'ordre des couches.\n                        // il n'y a pas de regroupement sans tri des couches !\n                        if (this.options.tools.group && this.options.tools.sort) {\n                            var mtd = data.metadata;\n                            // creation du container de groupe\n                            // si le tag metadata existe\n                            if (mtd) {\n                                var grp = data.metadata[\"geoportail:group\"];\n                                if (grp) {\n                                    // le groupe doit contenir plus d'un element\n                                    if (_groups[grp] > 1) {\n                                        // le groupe est déjà créé, on en veut plus par la suite...\n                                        _groups[grp] = -1;\n                                        // creation du groupe\n                                        var oGroup = new Group({\n                                            id : this.id,\n                                            target : (this.options.tools.collapse !== undefined) ? details : divLayers,\n                                            title : grp,\n                                            collapse : true\n                                        });\n                                        oGroup.add();\n                                        // le nouveau container pour les elements suivants\n                                        target = oGroup.getContainer();\n                                    } else if (_groups[grp] === 1) {\n                                        // l'element est seul, donc pas d'ajout dans le\n                                        // groupe en cours\n                                        target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                    } else {\n                                        // on ajoute l'element dans le groupe courant...\n                                    }\n                                } else {\n                                    target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                                }\n                            } else {\n                                target = (this.options.tools.collapse !== undefined) ? details : divLayers;\n                            }\n                        }\n                        // Layers\n                        if (this.options.tools.layers) {\n                            var oLayer = new Layer({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !\n                                tools : {\n                                    visibility : this.options.tools.visibility,\n                                    icon : this.options.tools.icon,\n                                    type : this.options.tools.type,\n                                    pin : this.options.tools.pin\n                                },\n                                obj : {\n                                    id : data.id,\n                                    type : data.type,\n                                    source : data.source,\n                                    \"source-layer\" : data[\"source-layer\"]\n                                }\n                            });\n                            oLayer.add();\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                            // sauvegarde des layers\n                            this.layers.push(oLayer);\n                        }\n                        // Legende\n                        if (this.options.tools.legend) {\n                            // gestion de l'edition de la legende :\n                            // l'option \"editable\" est prioritaire sur le tag \"editable\" du fichier de style !\n                            var isEditable = this.options.tools.editable;\n                            if (typeof isEditable === \"undefined\") {\n                                isEditable = data.editable;\n                            }\n                            var oLegend = new Legend({\n                                id : this.id,\n                                target : target,\n                                sprites : this.sprites,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    title : data.id,\n                                    editable : (typeof isEditable !== \"undefined\") ? isEditable : false,\n                                    paint : data.paint,\n                                    layout : data.layout\n                                }\n                            });\n                            oLegend.add();\n                            oLegend.display(false);\n                            if (oLayer) {\n                                oLayer.addLegend(oLegend);\n                                oLayer.slotLegend(); // integration de la legende dans le container du layers !\n                            }\n                        }\n                        // Style\n                        if (this.options.tools.style) {\n                            var oStyle = new Style({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    layout : data.layout,\n                                    paint : data.paint\n                                }\n                            });\n                            oStyle.add();\n                            oStyle.display(false);\n                            if (oLayer) {\n                                oLayer.addStyle(oStyle);\n                            }\n                            // update visibility layer\n                            if (data.layout && data.layout.visibility && data.layout.visibility === \"none\") {\n                                oLayer.visibility(false);\n                            }\n                        }\n                        // Filter\n                        if (this.options.tools.filter) {\n                            var oFilter = new Filter({\n                                id : this.id,\n                                target : target,\n                                position : index + \"_\" + this.id, // unique !,\n                                obj : {\n                                    id : data.id,\n                                    source : data.source,\n                                    filter : data.Filter\n                                }\n                            });\n                            oFilter.add();\n                            oFilter.display(false);\n                            if (oLayer) {\n                                oLayer.addFilter(oFilter);\n                            }\n                        }\n                    } else {\n                        // on ecarte un layer car il n'est pas reconnu dans la source\n                        // on decremente la position du layer\n                        if (index >= 0) {\n                            index--;\n                        }\n                    }\n                }\n            }\n        }\n\n        // sauvegarde\n        this.container = div;\n\n        // container principal\n        if (!this.options.target) {\n            if (!document.getElementById(this.name.target)) {\n                var _target = document.createElement(\"div\");\n                _target.id = this.name.target;\n                var node = document.getElementsByTagName(\"body\")[0] ||\n                    document.getElementsByTagName(\"head\")[0] ||\n                    document.documentElement;\n                node.appendChild(_target);\n            }\n            this.options.target = document.getElementById(this.name.target);\n        }\n        if (this.container) {\n            this.options.target.appendChild(this.container);\n        }\n        // dispatch event\n        EventBus.dispatch(Event.onloaded, this);\n    }\n\n    /**\n     * Getting Sprites informations\n     * (called by _initialize)\n     *\n     * @param {String} sprites - url des sprites\n     * @returns {Promise} - promise\n     * @private\n     */\n    _getSprites (sprites) {\n        var self = this;\n\n        // on ne doit pas mettre de promise en échec...\n        // car on souhaite continuer le traitement même si on n'a pas de sprites !\n        // si le protocole est mapbox://\n        if (sprites && sprites.startsWith(\"mapbox://\")) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Protocole mapbox:// non géré !\");\n                resolve(self);\n            });\n        }\n        // si pas de sprites\n        if (!sprites) {\n            return new Promise((resolve, reject) => {\n                logger.error(\"Auncun sprites disponibles !\");\n                resolve(self);\n            });\n        }\n\n        var fetchSpritesImage = function () {\n            var spritesImage = sprites + \".png\";\n            return fetch(spritesImage, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.blob()\n                            .then(function (blob) {\n                                self.sprites.url = spritesImage;\n                                // decode de l'image\n                                var theImage = new Image();\n                                theImage.src = spritesImage;\n                                return theImage.decode()\n                                    .then(function () {\n                                        self.sprites.size = {};\n                                        self.sprites.size.h = theImage.height;\n                                        self.sprites.size.w = theImage.width;\n                                    });\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch image sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch image sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n        var fetchSpritesJson = function () {\n            var spritesJson = sprites + \".json\";\n            return fetch(spritesJson, {\n                credentials : \"same-origin\"\n            })\n                .then(function (response) {\n                    if (response.ok) {\n                        return response.json()\n                            .then(function (json) {\n                                self.sprites.json = json;\n                            })\n                            .catch(error => {\n                                logger.warn(\"fetch json sprites exception :\", error);\n                            });\n                    } else {\n                        var err = new Error(\"HTTP status code: \" + response.status);\n                        throw err;\n                    }\n                })\n                .catch(error => {\n                    return new Promise((resolve, reject) => {\n                        logger.error(\"fetch json sprites exception :\", error);\n                        reject(error);\n                    });\n                });\n        };\n\n        // promise\n        return Promise.all([\n            fetchSpritesImage(),\n            fetchSpritesJson()\n        ]);\n    }\n\n    // ################################################################### //\n    // ########################## INTERFACE ############################## //\n    // ################################################################### //\n    /**\n     * Create Editor\n     *\n     * @returns {Promise} - promise\n     */\n    createElement () {\n        var self = this;\n        // objet json\n        if (typeof this.options.style === \"object\") {\n            this.mapbox = this.options.style;\n            // les sprites sont utiles que si on veut une legende !\n            if (this.options.tools.legend) {\n                return this._getSprites(this.mapbox.sprite)\n                    .then(function () {\n                        // init du DOM\n                        self._initContainer();\n                        return self;\n                    })\n                    .catch(error => {\n                        logger.warn(\"fetch sprites exception :\", error);\n                    });\n            } else {\n                return new Promise((resolve, reject) => {\n                    self._initContainer();\n                    resolve(self);\n                });\n            }\n        }\n\n        // url\n        if (typeof this.options.style === \"string\") {\n            return fetch(this.options.style, {\n                credentials : \"same-origin\"\n            })\n                .then(response => {\n                    // sauvegarde du json\n                    return response.json()\n                        .then(style => {\n                            self.mapbox = style;\n                        })\n                        .then(function () {\n                            // les sprites sont utiles que si on veut une legende !\n                            if (self.options.tools.legend) {\n                                return self._getSprites(self.mapbox.sprite)\n                                    .then(function () {\n                                        // init du DOM\n                                        self._initContainer();\n                                        return self;\n                                    })\n                                    .catch(error => {\n                                        logger.warn(\"fetch sprites exception :\", error);\n                                    });\n                            } else {\n                                return new Promise((resolve, reject) => {\n                                    self._initContainer();\n                                    resolve(self);\n                                });\n                            }\n                        })\n                        .catch(error => {\n                            logger.error(\"json exception :\", error);\n                        });\n                })\n                .catch(error => {\n                    logger.error(\"fetch exception :\", error);\n                });\n        }\n    }\n\n    /**\n     * Set display container (DOM)\n     *\n     * @param {Boolean} display - show/hidden container\n     */\n    display (display) {\n        this.container.style.display = (display) ? \"block\" : \"none\";\n    }\n\n    setContext (key, value) {\n        this.context[key] = value;\n    }\n\n    getContext (key) {\n        return this.context[key];\n    }\n\n    // ################################################################### //\n    // ##################### public methods ############################## //\n    // ################################################################### //\n    /**\n     * Get id editor\n     * @returns {Number} id\n     */\n    getID () {\n        return this.id;\n    }\n\n    /**\n     * Get container (DOM)\n     * @returns {DOMElement} DOM element\n     */\n    getContainer () {\n        return this.container;\n    }\n\n    /**\n     * Get Style (json)\n     * @returns {Object} Style MapBox\n     */\n    getStyle () {\n        return this.mapbox;\n    }\n\n    /**\n     * Get layer style (json)\n     * @param {Number} i - index\n     * @returns {Object} Style MapBox of a layers\n     */\n    getStyleLayer (i) {\n        var layer = null;\n        var o = this.getLayer(i);\n        var id = o.options.obj.id;\n        for (var k = 0; k < this.mapbox.layers.length; k++) {\n            var l = this.mapbox.layers[k];\n            if (l.id === id) {\n                layer = l;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get layer object from json style\n     * @param {Number} i - index into style json\n     * @returns {Object} Style MapBox of a layers\n     */\n    getLayerFromStyle (i) {\n        var layer = null;\n        var l = this.mapbox.layers[i];\n        for (var k = 0; k < this.getLayers().length; k++) {\n            var o = this.getLayer(k);\n            if (l.id === o.options.obj.id) {\n                layer = o;\n                break;\n            }\n        }\n        return layer;\n    }\n\n    /**\n     * Get a list of layer object sorted or not (see options.tools.sort)\n     * @returns {Array} - List of layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayers () {\n        return this.layers;\n    }\n\n    /**\n     * Get the layer object from a list sorted or not (see options.tools.sort)\n     * @param {Number} i - index\n     * @returns {Object} - layer object\n     * @see {ol.style.editor.Layer}\n     */\n    getLayer (i) {\n        return this.layers[i];\n    }\n\n};\n\n// on récupère les méthodes de la classe DOM\nUtils.assign(Editor.prototype, EditorDOM);\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\nexport default Editor;\n\n// Expose Editor as ol.editor.View (for a build bundle)\nif (window.ol && window.ol.style) {\n    window.ol.style.Editor = Editor;\n}\n"],"names":["hex","number","Error","Number","toString","slice","num","hexa","parseInt","arrayToRgba","values","Array","isArray","red","green","blue","alpha","parseFloat","arrayToHex","elems","this","result","join","opacity","rgbaToHex","rgba","parsed","exec","hexToRgba","replace","m","r","g","b","rgb","isHex","value","charAt","isRGB","detectSupport","isDesktop","userAgent","window","navigator","toLowerCase","indexOf","assign","dest","source","prop","hasOwnProperty","mergeParams","param","_typeof","getLogger","name","process","VERBOSE","env","Log","logname","disableAll","loggers","key","Object","call","enableAll","timestamp","generate","Math","floor","Date","now","id","i","lastIndexOf","substring","index","uuid","EventBusClass","module","exports","listeners","prototype","addEventListener","type","callback","scope","args","numOfArgs","arguments","length","push","splice","removeEventListener","numOfCallbacks","newArray","listener","hasEventListener","undefined","dispatch","target","event","concat","concatArgs","apply","getEvents","str","className","___EXPOSE_LOADER_IMPORT___","___EXPOSE_LOADER_GLOBAL_THIS___","globalThis","Function","e","self","root","definition","noop","undefinedType","isIE","test","logMethods","_loggersByName","defaultLogger","bindMethod","obj","methodName","method","bind","traceForIE","console","log","trace","realMethod","replaceLoggingMethods","level","getLevel","methodFactory","debug","levels","SILENT","enableLoggingWhenConsoleArrives","defaultMethodFactory","_level","_loggerName","Logger","factory","inheritedLevel","defaultLevel","userLevel","storageKey","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","cookieName","location","clearPersistedLevel","removeItem","normalizeLevel","input","TypeError","setLevel","persist","setDefaultLevel","resetLevel","TRACE","rebuild","childName","initialLevel","logger","_log","noConflict","getLoggers","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","o","defineProperty","enumerable","get","onloaded","layer","onclickvisibility","onclickclone","onclickremove","legend","onclickedition","onchangevalue","group","oncollapse","style","oneditjson","scale","onchangemin","onchangemax","filter","themes","onclickimage","onclicktitle","search","onsubmit","onautocomplete","Style","options","_classCallCheck","position","tools","title","_initialize","_initContainer","_toolsDefault","edition","Utils","paint","layout","container","containerjson","jsonlabel","jsondisplay","containertoolsscale","scaletitle","containertoolsminscale","scalelabelmin","scaleinputmin","containertoolsmaxscale","scalelabelmax","scaleinputmax","containertoolsedit","_found","_obj","JSON","parse","stringify","_style","keys","info","visibility","div","createElement","json","strJson","_syntaxHighlight","divJson","label","innerHTML","appendChild","pre","onEditJsonStyleMapBox","attachEvent","_createElementToolsScale","min","minzoom","max","maxzoom","_createElementToolsEdition","divToolsScale","divMin","labelMin","inputMin","disabled","data","onChangeStyleScaleMinMapBox","divMax","labelMax","inputMax","onChangeStyleScaleMaxMapBox","warn","divToolsEdit","match","cls","getElementById","documentElement","getElementsByTagName","display","editorID","EventBus","EventEditor","Themes","thumbnails","button","visible","themesSummary","containertheme","containerthemeID","inputID","labelID","image","imageID","message","ID","_lstThemes","_theme","divTheme","tabIndex","_url","url","_selected","selected","_type","_button","checked","onClickThemeTitleMapBox","thumbnail","_img","src","alt","description","onClickThemeImageMapBox","nodes","parentElement","childNodes","node","tagName","_label","htmlFor","_msg","targetIDX","previousSibling","_inputs","getElementsByClassName","el","Filter","_filter","labelJson","preJson","onEditJsonFilterMapBox","divEdit","Legend","sprites","editable","_editable","legendRender","width","stroke","color","rendercontainer","toolscontainer","containerlegendrender","legendrender","legendeditable","legendtitle","containerlegendtools","labels","params","bFound","split","_getProperties","edit","_createElementIconLegend","_createElementEditionLegend","isTextValue","isIconValue","valuesSupported","val","PROPERTIES","includes","_getValue","k","svg","Color","x","y","height","size","w","h","lstrockedasharray","cstrockcolor","pattern","fstrokecolor","isNumber","forEach","v","stops","sort","numA","numB","onEditionLegendMapBox","_renderThumbnail","span","linecolor","lLineColor","inputLineColor","setAttribute","onChangeValueLegendMapBox","linewidth","lLineWidth","inputLineWidth","step","defaultValue","lineopacity","lLineOpacity","inputLineOpacity","fillcolor","lFillColor","inputFillColor","fillopacity","lFillOpacity","inputFillOpacity","line","fill","background","circle","icon","text","Layer","anchor","pin","remove","clone","_objDefault","bSlotLegend","oFilter","oStyle","oLegend","DomVisibility","DomToggle","containerlegend","containertitle","imagelabelinput","imagelabel","typeimg","titleinput","titlelabel","containertools","visibilityinput","visibilitylabel","visibilityinputdisable","visibilitylabeldisable","divTitle","inputImage","labelImage","onClickLayerMapBox","_addTools","divTools","inputTools","onVisibilityLayerMapBox","labelTools","imgType","divLegend","inputTitle","labelTitle","nodesLvl1","nodesLvl2","curnode","render","getRenderContainer","click","active","isEditable","Group","collapse","details","summary","open","Search","_search","layers","_addUID","_uid","Editor","events","_initEvents","groupAuto","sortBy","sortOrder","context","containerID","containerLayers","titleLayers","titleLayersID","titleThemes","titleThemesID","sep","mapbox","error","ctx","handler","_toolsThemes","add","sources","multisources","hr","_layers","order","_metadata","cmpB","cmpA","localeCompare","groupBy","_groups","_groupName","_field","_newGroupName","_idx","trim","divLayers","ii","metadata","grp","oGroup","getContainer","oLayer","addLegend","slotLegend","addStyle","addFilter","_target","Event","spritesImage","startsWith","Promise","resolve","reject","all","fetch","credentials","then","response","ok","blob","theImage","Image","decode","status","_getSprites","sprite","getLayer","l","getLayers","EditorDOM","ol"],"sourceRoot":""}