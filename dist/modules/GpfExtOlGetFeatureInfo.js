/*!
 * @brief geopf-extensions-openlayers
 *
 * This software is released under the licence AGPL-3.0
 * @see https://www.gnu.org/licenses/agpl-3.0.html#license-text
 * @see https://www.gnu.org/licenses/agpl-3.0.en.html#license-text
 *
 * @copyright copyright (c) IGN 
 * @license AGPL-3.0
 * @author IGN
 * @version 1.0.0-beta.5-407
 * @date 16/07/2025
 *
 */(()=>{var e={3065:function(e,t,n){var r,o;!function(){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?c:void 0!==console[r]?a(console,r):void 0!==console.log?a(console,"log"):e)}function u(){for(var n=this.getLevel(),o=0;o<r.length;o++){var i=r[o];this[i]=o<n?e:this.methodFactory(i,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function s(e){return function(){typeof console!==t&&(u.call(this),this[e].apply(this,arguments))}}function f(e,t,n){return l(e)||s.apply(this,arguments)}function p(e,n){var a,c,l,s=this,p="loglevel";function d(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&p){try{return void(window.localStorage[p]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"="+n+";"}catch(e){}}}function h(){var e;if(typeof window!==t&&p){try{e=window.localStorage[p]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(p),o=n.indexOf(r+"=");-1!==o&&(e=/^([^;]+)/.exec(n.slice(o+r.length+1))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}function v(){if(typeof window!==t&&p){try{window.localStorage.removeItem(p)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function y(e){var t=e;if("string"==typeof t&&void 0!==s.levels[t.toUpperCase()]&&(t=s.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=s.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?p+=":"+e:"symbol"==typeof e&&(p=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=n||f,s.getLevel=function(){return null!=l?l:null!=c?c:a},s.setLevel=function(e,t){return l=y(e),!1!==t&&d(l),u.call(s)},s.setDefaultLevel=function(e){c=y(e),h()||s.setLevel(e,!1)},s.resetLevel=function(){l=null,v(),u.call(s)},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)},s.rebuild=function(){if(i!==s&&(a=y(i.getLevel())),u.call(s),i===s)for(var e in o)o[e].rebuild()},a=y(i?i.getLevel():"WARN");var g=h();null!=g&&(l=y(g)),u.call(s)}(i=new p).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new p(e,i.methodFactory)),t};var d=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=d),i},i.getLoggers=function(){return o},i.default=i,i},void 0===(o="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=o)}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};(()=>{"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(r,{default:()=>ye});var o=["GPoverviewMap","GPfullScreen"];const i=function(t,n){var r=function(t,n){var r=[].concat(o,[n]),i=[];if(t&&t.includes("left")){var a=document.getElementById("position-container-bottom-left"),c=document.getElementById("position-container-top-left");i=[].concat(e(a.children),e(c.children))}if(t&&t.includes("right")){var l=document.getElementById("position-container-bottom-right"),u=document.getElementById("position-container-top-right");i=[].concat(e(l.children),e(u.children))}return i.filter(function(e){var t=e.id.match(/(\w+)-[0-9]+/)[1],n=r.includes(t);if("true"===e.getElementsByTagName("button")[0].getAttribute("aria-pressed")&&!n)return e})}(t,n);r.length>0&&r[0].getElementsByTagName("button")[0].click()};const a={onPanelOpen:function(){i(this.options.position,this.element.id.match(/(\w+)-[0-9]+/)[1])}},c=ol.control.Control;const l=function(){return""!==getComputedStyle(document.documentElement).getPropertyValue("--blue-france-sun-113-625")};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function f(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}function y(e,t,n){return t=m(t),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],m(e).constructor):t.apply(e,n))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}const w=function(e){function t(e){var n;return p(this,t),n=y(this,t,[{element:(e=e||{}).element,target:e.target,render:e.render}]),e&&e.listable?n.listable=!0:n.listable=!1,e&&e.description?n.description=e.description:n.description="",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(t,e),h(t,[{key:"setPosition",value:function(e){this.getMap()&&new P(this).set(e)}},{key:"updatePosition",value:function(e){this.getMap()&&new P(this).update(e)}}])}(n.n(c)());var O=["top-left","top-right","bottom-left","bottom-right"],E=new WeakSet,P=function(){return h(function e(t){return p(this,e),s(this,E),this.caller=t,this.container=null,f(E,this,G).call(this,"top-left"),f(E,this,G).call(this,"top-right"),f(E,this,G).call(this,"bottom-left"),f(E,this,G).call(this,"bottom-right"),this},[{key:"set",value:function(e){O.includes(e.toLowerCase())&&(f(E,this,F).call(this,e,!1),e.includes("bottom")?this.container.children["position-container-"+e].prepend(this.caller.element):this.container.children["position-container-"+e].appendChild(this.caller.element))}},{key:"update",value:function(e){O.includes(e.toLowerCase())&&f(E,this,F).call(this,e,!0)}}])}();function I(e){return!!this.container.children["position-container-"+e]}function G(e){if(this.container=this.caller.getMap().getOverlayContainerStopEvent(),!f(E,this,I).call(this,e)){var t=document.createElement("div");t.id="position-container-"+e,t.className="position position-container-"+e,this.container.appendChild(t)}}function F(e,t){var n=this,r=function(e){return n.container.children["position-container-"+e].children.length},o=function(e){return n.container.children["position-container-"+e].offsetWidth},i=function(e){var r=n.container.children["position-container-"+e],o=r.offsetHeight;if(t){e.includes("top")&&(o=0);for(var i=0;i<r.children.length;i++){if(r.children[i].id===n.caller.element.id){o=e.includes("bottom")?o-n.caller.element.offsetHeight:-1*o;break}o-=r.children[i].offsetHeight}}return o},a=function(e){e.style.top="unset",e.style.bottom="unset",e.style.left="unset",e.style.right="unset"};a(this.caller.element),this.caller.element.style.position="unset";var c=Array.from(this.caller.element.getElementsByClassName("GPpanel"));if(0!==c.length){var u=0;c.forEach(function(t){if("dialog"===t.nodeName.toLowerCase()){switch(a(t),e.toLowerCase()){case"top-left":l()?t.style.top="0px":t.style.top=r(e)?i(e)+"px":"0px",t.style.left=o(e)+u+"px";break;case"bottom-left":l()?t.style.top="0px":t.style.bottom=r(e)?i(e)+"px":"0px",t.style.left=o(e)+u+"px";break;case"top-right":l()?t.style.top="0px":t.style.top=r(e)?i(e)+"px":"0px",t.style.right=o(e)+u+"px";break;case"bottom-right":l()?t.style.top="0px":t.style.bottom=r(e)?i(e)+"px":"0px",t.style.right=o(e)+u+"px"}u+=t.offsetWidth}})}}const C=ol.source.VectorTile;var S=n.n(C);const x=ol.source.Vector;var L=n.n(x);const T=ol.source.TileWMS;var _=n.n(T);const j=ol.source.WMTS;var k=n.n(j);const A=ol.source.ImageWMS;var N=n.n(A);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}const R={detectSupport:function(){var e=!0,t=window.navigator.userAgent.toLowerCase();return-1===t.indexOf("iphone")&&-1===t.indexOf("ipod")&&-1===t.indexOf("ipad")&&-1===t.indexOf("android")&&-1===t.indexOf("mobile")&&-1===t.indexOf("blackberry")&&-1===t.indexOf("tablet")&&-1===t.indexOf("phone")&&-1===t.indexOf("touch")||(e=!1),-1===t.indexOf("msie")&&-1===t.indexOf("trident")||(e=!0),e},assign:function(e,t){for(var n in e=e||{},t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},mergeParams:function(e,t,n){if(void 0!==e&&void 0!==t)for(var r in void 0===n&&(n=!0),t)t.hasOwnProperty(r)&&("object"===M(t[r])?e.hasOwnProperty(r)?this.mergeParams(e[r],t[r],n):e[r]=t[r]:e.hasOwnProperty(r)?n&&(e[r]=t[r]):e[r]=t[r])}};var D;const H={generate:(D=Math.floor(Date.now()),function(){return D++}),name:function(e){var t=null,n=e.lastIndexOf("-");return t=-1===n?e:e.substring(0,n),t},index:function(e){var t=null,n=this.name(e),r=n.lastIndexOf("_");return-1!==r&&(t=n.substring(r+1)),t},uuid:function(e){var t=null,n=e.lastIndexOf("-");return-1!==n&&(t=parseInt(e.substring(n+1),10)),t}};var B=n(3065),U={getLogger:function(e){if(void 0===t)var t={env:{VERBOSE:!1}};t.env.VERBOSE?B.enableAll():B.disableAll();var n=e||"default";return B.getLogger(n)},disableAll:function(){var e=B.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=B.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}};const V=U;window.Gp&&(window.Gp.Logger=U);V.getLogger("draggable");const W={dragElement:function(e,t,n){var r,o=0,i=0,a=0,c=0,l=0,u=0;t?t.addEventListener("mousedown",f,!0):e.addEventListener("mousedown",f,!0);var s={bottom:0,left:0,right:0,top:0};function f(t){(t=t||window.event).preventDefault(),o=t.clientX,i=t.clientY,r=e.getBoundingClientRect();var a=n.getBoundingClientRect();s={bottom:a.bottom,left:a.left,right:a.right,top:a.top},document.addEventListener("mouseup",p,!0),document.addEventListener("mousemove",d,!0)}function p(){l-=a,u-=c,document.removeEventListener("mouseup",p,!0),document.removeEventListener("mousemove",d,!0)}function d(t){var n=(t=t||window.event).clientX,f=t.clientY,p=a,d=c;a=o-n,c=i-f;var h=r.left-a,v=r.top-c;if(h<s.left||v<s.top||h+r.width>s.right||v+r.height>s.bottom)a=p,c=d;else{var y=l-a,g=u-c;e.style.transform="translate("+y+"px,"+g+"px)"}}}};function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function z(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return q(u,"_invoke",function(n,r,o){var i,c,l,u=0,s=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,l=e,p.n=n,a}};function d(n,r){for(c=n,l=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,i=s[t],d=p.p,h=i[2];n>3?(o=h===r)&&(l=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,h),c=s,l=h;(t=c<2?e:l)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,l)):p.n=l:p.v=l);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?l:n.call(r,p))!==a)break}catch(t){i=e,c=1,l=t}finally{u=1}}return{value:t,done:f}}}(n,o,i),!0),u}var a={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(q(t={},r,function(){return this}),t),f=u.prototype=c.prototype=Object.create(s);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,q(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=u,q(f,"constructor",u),q(u,"constructor",l),l.displayName="GeneratorFunction",q(u,o,"GeneratorFunction"),q(f),q(f,o,"Generator"),q(f,r,function(){return this}),q(f,"toString",function(){return"[object Generator]"}),(z=function(){return{w:i,m:p}})()}function q(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}q=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){q(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},q(e,t,n,r)}function X(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function Z(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){X(i,r,o,a,c,"next",e)}function c(e){X(i,r,o,a,c,"throw",e)}a(void 0)})}}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$(r.key),r)}}function $(e){var t=function(e,t){if("object"!=Y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Y(t)?t:t+""}var K=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.subscribers=[]},t=[{key:"subscribe",value:function(e){if("function"!=typeof e)throw new Error("Callback must be a function");this.subscribers.push(e)}},{key:"set",value:(r=Z(z().m(function e(t,n){var r;return z().w(function(e){for(;;)switch(e.n){case 0:return this.data[t]=n,r=this.subscribers.map(function(){var e=Z(z().m(function e(r){return z().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r(t,n);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),e.n=1,Promise.allSettled(r);case 1:return e.a(2)}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"get",value:function(e){return this.data[e]}}],t&&J(e.prototype,t),n&&J(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();const Q={_addUID:function(e){return this.uid?e+"-"+this.uid:e},stringToHTML:function(e){if(function(){if(!window.DOMParser)return!1;var e=new DOMParser;try{e.parseFromString("x","text/html")}catch(e){return!1}return!0}())return(new DOMParser).parseFromString(e,"text/html").body;var t=document.createElement("div");return t.innerHTML=e,t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPgetFeatureInfo"),e.className="GPgetFeatureInfo gpf-widget gpf-widget-button gpf-mobile-fullscreen",e},_createShowGetFeatureInfoPictoElement:function(){var e=this,t=document.createElement("button"),n=document.createElement("span");return t.appendChild(n),t.id=this._addUID("GPgetFeatureInfoPicto"),t.className="GPshowOpen GPshowAdvancedToolPicto GPgetFeatureInfoPicto gpf-btn gpf-btn--tertiary gpf-btn-icon gpf-btn-icon-getfeatureinfo fr-btn fr-btn--tertiary",t.setAttribute("aria-label","Activer/désactiver l'interrogation des couches"),t.setAttribute("tabindex","0"),t.setAttribute("aria-pressed",!1),t.setAttribute("type","button"),t.addEventListener?t.addEventListener("click",function(t){var n="true"===t.target.ariaPressed;t.target.setAttribute("aria-pressed",!n),e.onShowGetFeatureInfoClick(t)}):t.attachEvent&&t.attachEvent("onclick",function(t){var n="true"===t.target.ariaPressed;t.target.setAttribute("aria-pressed",!n),e.onShowGetFeatureInfoClick(t)}),t},_createGetFeatureInfoPanelElement:function(){var e=document.createElement("dialog");return e.id=this._addUID("GPgetFeatureInfoPanel"),e.className="GPpanel gpf-panel fr-modal",e},_createGetFeatureInfoPanelDivElement:function(){var e=document.createElement("div");return e.className="GPpanelBody gpf-panel__body fr-modal__body",e},_createGetFeatureInfoPanelHeaderElement:function(){var e=document.createElement("div");return e.className="GPpanelHeader gpf-panel__header fr-modal__header",e},_createGetFeatureInfoPanelTitleElement:function(){var e=document.createElement("div");return e.className="GPpanelTitle gpf-panel__title fr-modal__title fr-pt-4w",e.innerHTML="GetFeatureInfo",e},_createGetFeatureInfoPanelCloseElement:function(){var e=this,t=document.createElement("button");t.className="GPpanelClose GPcloseGetFeatureInfo gpf-btn gpf-btn-icon-close fr-btn--close fr-btn fr-btn--tertiary-no-outline fr-m-1w",t.title="Fermer le panneau",t.addEventListener?t.addEventListener("click",function(n){t.setAttribute("aria-pressed",!1),e.onCloseGetFeatureInfoClick()},!1):t.attachEvent&&t.attachEvent("onclick",function(n){t.setAttribute("aria-pressed",!1),e.onCloseGetFeatureInfoClick()});var n=document.createElement("span");return n.className="GPelementHidden gpf-visible",n.innerText="Fermer",t.appendChild(n),t},_createGetFeatureInfoWaitingDiv:function(){return'\n        <div class="waiting-div-container"><div class="lds-ring"><div></div><div></div><div></div><div></div></div><div>\n        '},_createGetFeatureInfoAccordionGroup:function(){var e=document.createElement("div");return e.id=this._addUID("GPgetFeatureInfoAccordionGroup"),e.className="GPgetFeatureInfoAccordionGroup fr-accordions-group",e},_createGetFeatureInfoLayerAccordion:function(e){var t=this.stringToHTML('\n            <section class="fr-accordion">\n                <h3 class="fr-accordion__title">\n                    <button class="GPgfiLayerButton fr-accordion__btn" aria-expanded="false" aria-controls="accordion-'.concat(e,'">\n                        <span class="GPshowGfiLayerFeature"></span>\n                        <span id="gfiLayerName">').concat(e,'</span>\n                    </button>\n                </h3>\n                <div class="fr-collapse GPgetFeatureInfoAccordionContent GPelementHidden" id="accordion-').concat(e,'" style="margin:unset;">\n                    ').concat(this._createGetFeatureInfoWaitingDiv(),"\n                </div>\n            </section>\n        ")).firstChild;return t.querySelector("button, button.fr-accordion__btn").addEventListener("click",function(e){e.currentTarget.ariaExpanded=!("true"===e.currentTarget.ariaExpanded);var t=document.getElementById(e.currentTarget.getAttribute("aria-controls"));"true"===e.currentTarget.ariaExpanded?(t.classList.add("fr-collapse--expanded"),t.classList.remove("GPelementHidden")):(t.classList.remove("fr-collapse--expanded"),t.classList.add("GPelementHidden"))}),t}};function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return ne(u,"_invoke",function(n,r,o){var i,c,l,u=0,s=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,l=e,p.n=n,a}};function d(n,r){for(c=n,l=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,i=s[t],d=p.p,h=i[2];n>3?(o=h===r)&&(l=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,h),c=s,l=h;(t=c<2?e:l)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,l)):p.n=l:p.v=l);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?l:n.call(r,p))!==a)break}catch(t){i=e,c=1,l=t}finally{u=1}}return{value:t,done:f}}}(n,o,i),!0),u}var a={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(ne(t={},r,function(){return this}),t),f=u.prototype=c.prototype=Object.create(s);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,ne(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=u,ne(f,"constructor",u),ne(u,"constructor",l),l.displayName="GeneratorFunction",ne(u,o,"GeneratorFunction"),ne(f),ne(f,o,"Generator"),ne(f,r,function(){return this}),ne(f,"toString",function(){return"[object Generator]"}),(te=function(){return{w:i,m:p}})()}function ne(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ne=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ne(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},ne(e,t,n,r)}function re(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach(function(t){ae(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ae(e,t,n){return(t=le(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,le(r.key),r)}}function le(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}function ue(e,t){if(t&&("object"==ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(se=function(){return!!e})()}function fe(){return fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=pe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},fe.apply(null,arguments)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function de(e,t){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},de(e,t)}var he=V.getLogger("getFeatureInfo"),ve=function(e){function t(e){var n,r,o,i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=[e=e||{}],o=pe(o=t),!((n=ue(r,se()?Reflect.construct(o,i||[],pe(r).constructor):o.apply(r,i)))instanceof t))throw new TypeError("ERROR CLASS_CONSTRUCTOR");return n.CLASSNAME="GetFeatureInfo",n.initialize(e),n.container=n.initContainer(),n.element?n.element.appendChild(n.container):n.element=n.container,ue(n,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}(t,e),n=t,r=[{key:"setMap",value:function(e){var n,r,o,i,a;e?(this.draggable&&W.dragElement(this.panelGetFeatureInfoContainer,this.panelGetFeatureInfoHeaderContainer,e.getTargetElement()),this.collapsed||this.buttonGetFeatureInfoShow.setAttribute("aria-pressed",!0),this.auto&&this.addEventsListeners(e)):this.auto&&this.removeEventsListeners(),(n=t,r="setMap",o=this,a=fe(pe(1&(i=3)?n.prototype:n),r,o),2&i&&"function"==typeof a?function(e){return a.apply(o,e)}:a)([e]),this.options.position&&this.setPosition(this.options.position),!1===this.options.gutter&&this.element.classList.add("gpf-button-no-gutter")}},{key:"initialize",value:function(e){this.uid=e.id||H.generate(),this.options={collapsed:!0,draggable:!1,auto:!0},R.assign(this.options,e),this.collapsed=this.options.collapsed,this.draggable=this.options.draggable,this.auto=this.options.auto,this.buttonGetFeatureInfoShow=null,this.panelGetFeatureInfoContainer=null,this.getFeatureInfoPanelDiv=null,this.panelGetFeatureInfoHeaderContainer=null,this.buttonGetFeatureInfoClose=null,this.getFeatureInfoAccordionGroup=null,this.panelGetFeatureInfoEntriesContainer=null,this.eventsListeners=[],this.pixel=[],this.coordinates=[],this.layers=[],this.res=null}},{key:"initContainer",value:function(){var e=this._createMainContainerElement(),t=this.buttonGetFeatureInfoShow=this._createShowGetFeatureInfoPictoElement();e.appendChild(t);var n=this.panelGetFeatureInfoContainer=this._createGetFeatureInfoPanelElement(),r=this.getFeatureInfoPanelDiv=this._createGetFeatureInfoPanelDivElement();n.appendChild(r);var o=this.panelGetFeatureInfoHeaderContainer=this._createGetFeatureInfoPanelHeaderElement(),i=this._createGetFeatureInfoPanelTitleElement();o.appendChild(i);var a=this.buttonGetFeatureInfoClose=this._createGetFeatureInfoPanelCloseElement();o.appendChild(a),r.appendChild(o);var c=this.getFeatureInfoAccordionGroup=this._createGetFeatureInfoAccordionGroup();return r.appendChild(c),e.appendChild(n),he.log(e),e}},{key:"addEventsListeners",value:function(e){var t=this;this.eventsListeners.singleclick=function(e){he.trace(e),t.onMapClick(e)},e.on("singleclick",this.eventsListeners.singleclick)}},{key:"removeEventsListeners",value:function(){this.getMap().getLayers().un("singleclick",this.eventsListeners.singleclick),delete this.eventsListeners.singleclick}},{key:"getFeatureInfoIsActive",value:function(){return this.buttonGetFeatureInfoShow.getAttribute("aria-pressed")}},{key:"onMapClick",value:function(e){if("true"===this.getFeatureInfoIsActive()){if(this.getFeatureInfoAccordionGroup.remove(),this.layers=e.map.getLayers().getArray().filter(function(t){if(t.isVisible(e.map.getView())&&t.getOpacity()>0)return t}).sort(function(e,t){return t.getZIndex()-e.getZIndex()}),!(this.layers.length>0))return;var t=this.getFeatureInfoAccordionGroup=this._createGetFeatureInfoAccordionGroup();this.getFeatureInfoPanelDiv.appendChild(t),this.map=e.map,this.pixel=e.pixel,this.coordinates=e.coordinate,this.res=e.map.getView().getResolution(),this.displayGetFeatureInfo()}}},{key:"getGetFeatureInfoLayer",value:function(e){var t={},n=this.getLayerFormat(e);if(t={format:n,layer:e},"wmts"===n){var r=e.getSource().getFeatureInfoUrl(this.coordinates,this.res,this.map.getView().getProjection(),{INFOFORMAT:"text/html",STYLES:""});t=ie(ie({},t),{url:r})}if("wms"===n){var o=e.getSource().getFeatureInfoUrl(this.coordinates,this.res,this.map.getView().getProjection(),{INFO_FORMAT:"text/html",STYLES:""});t=ie(ie({},t),{url:o})}return t}},{key:"getFeaturesAtClick",value:function(e){var t=[];return this.getMap().forEachFeatureAtPixel(this.pixel,function(n,r){e==r&&t.push(n)}),t}},{key:"getGetFeatureInfoContent",value:(i=te().m(function e(t){var n,r,o=this;return te().w(function(e){for(;;)switch(e.n){case 0:if(n=null,"vector"!==t.format){e.n=1;break}return(r=this.getFeaturesAtClick(t.layer))&&(n=this.features2html(r)),e.a(2,n);case 1:return e.a(2,fetch(t.url).then(function(e){return e.text()}).then(function(e){var t=!1;if(0!==e.trim().length&&-1===e.indexOf("ServiceExceptionReport")&&-1===e.indexOf("java.lang.NullPointerException")&&-1===e.indexOf("java.lang.OutOfMemoryError")&&-1===e.indexOf("not queryable")&&-1===e.indexOf("No data")&&-1===e.indexOf("non interrogeable")||(t=!0),t)return null;var n=o.stringToHTML(e);return n&&n.innerHTML&&n.innerHTML.trim().length>0?e:null}).catch(function(e){return he.log(e),e}));case 2:return e.a(2)}},e,this)}),a=function(){var e=this,t=arguments;return new Promise(function(n,r){var o=i.apply(e,t);function a(e){re(o,n,r,a,c,"next",e)}function c(e){re(o,n,r,a,c,"throw",e)}a(void 0)})},function(e){return a.apply(this,arguments)})},{key:"getLayerTitle",value:function(e){if(void 0!==e.layer.getProperties&&void 0!==e.layer.getSource){var t=e.layer.getProperties(),n=t.source,r="";n&&(r=n._title||n.name||t.title||t.name||n.url_||"Couche de données")}return r}},{key:"displayGetFeatureInfo",value:function(){for(var e=this,t=this.layers.map(function(t){return e.getGetFeatureInfoLayer(t)}).map(function(t){var n=e.getLayerTitle(t),r=e._createGetFeatureInfoLayerAccordion(n);return r.style.display="none",new K(ie(ie({},t),{layername:n,content:null,contentDiv:r,pending:!0}))}),n=0;n<t.length;n++)this.getFeatureInfoAccordionGroup.append(t[n].data.contentDiv);t.forEach(function(n){n.subscribe(function(r,o){"content"==r&&(n.set("pending",!1),n.get("content")?(n.get("contentDiv").querySelector("div.fr-collapse").innerHTML=n.get("content"),e.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!0),n.get("contentDiv").style.display="block"):n.get("contentDiv").remove(),0==t.filter(function(e){return!0===e.get("pending")}).length&&0==t.filter(function(e){return e.get("content")}).length&&e.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!1))})}),t.forEach(function(t){e.getGetFeatureInfoContent(t.data).then(function(e){t.set("content",e)})})}},{key:"getLayerFormat",value:function(e){var t="function"==typeof e.getType?e.getType():null,n=e.getSource();if(t){if("VECTOR"===t||"VECTOR_TILE"===t)return"vector";if("TILE"===t)return n.tileGrid?"wmts":"wms";if("IMAGE"===t)return"wms"}else{if(n instanceof _()||n instanceof N())return"wms";if(n instanceof k())return"wmts";if(n instanceof L()||n instanceof S())return"vector"}return"unknown"}},{key:"features2html",value:function(e){var t=document.createElement("div");return e.forEach(function(e){var n=e.getProperties();if(n.hasOwnProperty("render"))t.insertAdjacentHTML("beforeend",n.render);else{if(n.hasOwnProperty("name")){var r=document.createElement("div");r.className="gp-att-name-div",r.insertAdjacentHTML("afterbegin",n.name),t.appendChild(r)}if(n.hasOwnProperty("description")){var o=document.createElement("div");o.className="gp-att-description-div",o.insertAdjacentHTML("afterbegin",n.description),t.appendChild(o)}var i=null,a=!1,c=null,l=null,u=null,s=["fill","fill-opacity","label-fill","label-fill-opacity","label-stroke","label-stroke-opacity","label-stroke-width","label-font","label-textAlign","stroke","stroke-opacity","stroke-width","marker-symbol","marker-color","marker-size","geometry","value","name","description","styleUrl","extensionsNode_","icon"];for(i in n)if(void 0!==n[i]&&-1===s.indexOf(i)){a||((c=document.createElement("div")).className="gp-att-others-div",l=document.createElement("ul"),a=!0),u=document.createElement("li");var f=document.createElement("span");f.className="gp-attname-others-span",f.appendChild(document.createTextNode(i+" : ")),u.appendChild(f),u.appendChild(document.createTextNode(n[i])),l.appendChild(u)}l&&(c.appendChild(l),t.appendChild(c))}}),t=t.hasChildNodes()?t.innerHTML:""}},{key:"onShowGetFeatureInfoClick",value:function(e){"true"===e.target.ariaPressed&&this.onPanelOpen(),"false"===e.target.ariaPressed&&this.buttonGetFeatureInfoClose.setAttribute("aria-pressed",!1),he.trace(e)}},{key:"onCloseGetFeatureInfoClick",value:function(e){he.trace(e)}},{key:"onGetFeatureInfoComputationSubmit",value:function(e){he.trace(e)}}],r&&ce(n.prototype,r),o&&ce(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(w);Object.assign(ve.prototype,Q),Object.assign(ve.prototype,a);const ye=ve;window.ol&&window.ol.control&&(window.ol.control.GetFeatureInfo=ve)})(),GpfExtOlGetFeatureInfo=r.default})();
//# sourceMappingURL=GpfExtOlGetFeatureInfo.js.map